(self.webpackChunkhomework=self.webpackChunkhomework||[]).push([[179],{2011:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{Dh:()=>ze,GT:()=>Ht,cc:()=>ft,hO:()=>fn,on:()=>qe,pX:()=>Ct,xv:()=>ht});var pe=Ee(4650),o=Ee(9260),xe=Ee(263);bt=Ee.hmd(bt);const ct=["ngOnDestroy"],Ct=(dt,Ot,Jt,st={})=>new Proxy(dt,{get:(Zt,nn)=>Jt.runOutsideAngular(()=>{var yn;if(dt[nn])return!(null===(yn=st?.spy)||void 0===yn)&&yn.get&&st.spy.get(nn,dt[nn]),dt[nn];if(ct.indexOf(nn)>-1)return()=>{};const it=Ot.toPromise().then(zt=>{const en=zt&&zt[nn];return"function"==typeof en?en.bind(zt):en&&en.then?en.then(gt=>Jt.run(()=>gt)):Jt.run(()=>en)});return new Proxy(()=>{},{get:(zt,en)=>it[en],apply:(zt,en,gt)=>it.then(xt=>{var Lt;const It=xt&&xt(...gt);return!(null===(Lt=st?.spy)||void 0===Lt)&&Lt.apply&&st.spy.apply(nn,gt,It),It})})})}),Ht=(dt,Ot)=>{Ot.forEach(Jt=>{Object.getOwnPropertyNames(Jt.prototype||Jt).forEach(st=>{Object.defineProperty(dt.prototype,st,Object.getOwnPropertyDescriptor(Jt.prototype||Jt,st))})})};class y{constructor(Ot){return Ot}}const ze=new pe.OlP("angularfire2.app.options"),ht=new pe.OlP("angularfire2.app.name");function qe(dt,Ot,Jt){const Zt="object"==typeof Jt&&Jt||{};Zt.name=Zt.name||"string"==typeof Jt&&Jt||"[DEFAULT]";const yn=o.Z.apps.filter(it=>it&&it.name===Zt.name)[0]||Ot.runOutsideAngular(()=>o.Z.initializeApp(dt,Zt));try{JSON.stringify(dt)!==JSON.stringify(yn.options)&&Ne("error",`${yn.name} Firebase App already initialized with different options${bt.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new y(yn)}const Ne=(dt,...Ot)=>{(0,pe.X6Q)()&&typeof console<"u"&&console[dt](...Ot)},nt={provide:y,useFactory:qe,deps:[ze,pe.R0b,[new pe.FiY,ht]]};let fn=(()=>{class dt{constructor(Jt){o.Z.registerVersion("angularfire",xe.q4.full,"core"),o.Z.registerVersion("angularfire",xe.q4.full,"app-compat"),o.Z.registerVersion("angular",pe.q4F.full,Jt.toString())}static initializeApp(Jt,st){return{ngModule:dt,providers:[{provide:ze,useValue:Jt},{provide:ht,useValue:st}]}}}return dt.\u0275fac=function(Jt){return new(Jt||dt)(pe.LFG(pe.Lbi))},dt.\u0275mod=pe.oAB({type:dt}),dt.\u0275inj=pe.cJS({providers:[nt]}),dt})();function ft(dt,Ot,Jt,st,Zt){const[,nn,yn]=globalThis.\u0275AngularfireInstanceCache.find(it=>it[0]===dt)||[];if(nn)return function ln(dt,Ot){try{return dt.toString()===Ot.toString()}catch{return dt===Ot}}(Zt,yn)||(Je("error",`${Ot} was already initialized on the ${Jt} Firebase App with different settings.${Ze?" You may need to reload as Firebase is not HMR aware.":""}`),Je("warn",{is:Zt,was:yn})),nn;{const it=st();return globalThis.\u0275AngularfireInstanceCache.push([dt,it,Zt]),it}}const Ze=!!bt.hot,Je=(dt,...Ot)=>{(0,pe.X6Q)()&&typeof console<"u"&&console[dt](...Ot)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},263:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{q4:()=>Af,iC:()=>_,HU:()=>Xd,vb:()=>zp,JM:()=>kf,u3:()=>P});var pe=Ee(4650),o=Ee(259),xe=Ee(5861),ct=Ee(9681),Ct=Ee(2090),Ht=Ee(4859),y=Ee(1877),ze=Ee(8766);const ht="@firebase/installations",qe="0.6.3",nt=`w:${qe}`,fn="FIS_v2",Ot=new Ct.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Jt(I){return I instanceof Ct.ZR&&I.code.includes("request-failed")}function st({projectId:I}){return`https://firebaseinstallations.googleapis.com/v1/projects/${I}/installations`}function Zt(I){return{token:I.token,requestStatus:2,expiresIn:xt(I.expiresIn),creationTime:Date.now()}}function nn(I,M){return yn.apply(this,arguments)}function yn(){return(yn=(0,xe.Z)(function*(I,M){const G=(yield M.json()).error;return Ot.create("request-failed",{requestName:I,serverCode:G.code,serverMessage:G.message,serverStatus:G.status})})).apply(this,arguments)}function it({apiKey:I}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":I})}function zt(I,{refreshToken:M}){const z=it(I);return z.append("Authorization",function Lt(I){return`${fn} ${I}`}(M)),z}function en(I){return gt.apply(this,arguments)}function gt(){return(gt=(0,xe.Z)(function*(I){const M=yield I();return M.status>=500&&M.status<600?I():M})).apply(this,arguments)}function xt(I){return Number(I.replace("s","000"))}function It(I,M){return Vt.apply(this,arguments)}function Vt(){return(Vt=(0,xe.Z)(function*({appConfig:I,heartbeatServiceProvider:M},{fid:z}){const G=st(I),$=it(I),te=M.getImmediate({optional:!0});if(te){const ye=yield te.getHeartbeatsHeader();ye&&$.append("x-firebase-client",ye)}const fe={method:"POST",headers:$,body:JSON.stringify({fid:z,authVersion:fn,appId:I.appId,sdkVersion:nt})},_e=yield en(()=>fetch(G,fe));if(_e.ok){const ye=yield _e.json();return{fid:ye.fid||z,registrationStatus:2,refreshToken:ye.refreshToken,authToken:Zt(ye.authToken)}}throw yield nn("Create Installation",_e)})).apply(this,arguments)}function wn(I){return new Promise(M=>{setTimeout(M,I)})}const ir=/^[cdef][\w-]{21}$/;function vi(){try{const I=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(I),I[0]=112+I[0]%16;const z=function zi(I){return function ai(I){return btoa(String.fromCharCode(...I)).replace(/\+/g,"-").replace(/\//g,"_")}(I).substr(0,22)}(I);return ir.test(z)?z:""}catch{return""}}function ri(I){return`${I.appName}!${I.appId}`}const or=new Map;function Bo(I,M){const z=ri(I);Gr(z,M),function Vo(I,M){const z=function fo(){return!$r&&"BroadcastChannel"in self&&($r=new BroadcastChannel("[Firebase] FID Change"),$r.onmessage=I=>{Gr(I.data.key,I.data.fid)}),$r}();z&&z.postMessage({key:I,fid:M}),function Ar(){0===or.size&&$r&&($r.close(),$r=null)}()}(z,M)}function Gr(I,M){const z=or.get(I);if(z)for(const G of z)G(M)}let $r=null;const Rr="firebase-installations-store";let Xo=null;function Gs(){return Xo||(Xo=(0,ze.X3)("firebase-installations-database",1,{upgrade:(I,M)=>{0===M&&I.createObjectStore(Rr)}})),Xo}function Ao(I,M){return Pr.apply(this,arguments)}function Pr(){return(Pr=(0,xe.Z)(function*(I,M){const z=ri(I),$=(yield Gs()).transaction(Rr,"readwrite"),te=$.objectStore(Rr),ue=yield te.get(z);return yield te.put(M,z),yield $.done,(!ue||ue.fid!==M.fid)&&Bo(I,M.fid),M})).apply(this,arguments)}function jn(I){return Uo.apply(this,arguments)}function Uo(){return(Uo=(0,xe.Z)(function*(I){const M=ri(I),G=(yield Gs()).transaction(Rr,"readwrite");yield G.objectStore(Rr).delete(M),yield G.done})).apply(this,arguments)}function lo(I,M){return Wr.apply(this,arguments)}function Wr(){return(Wr=(0,xe.Z)(function*(I,M){const z=ri(I),$=(yield Gs()).transaction(Rr,"readwrite"),te=$.objectStore(Rr),ue=yield te.get(z),fe=M(ue);return void 0===fe?yield te.delete(z):yield te.put(fe,z),yield $.done,fe&&(!ue||ue.fid!==fe.fid)&&Bo(I,fe.fid),fe})).apply(this,arguments)}function es(I){return Mo.apply(this,arguments)}function Mo(){return(Mo=(0,xe.Z)(function*(I){let M;const z=yield lo(I.appConfig,G=>{const $=wr(G),te=yr(I,$);return M=te.registrationPromise,te.installationEntry});return""===z.fid?{installationEntry:yield M}:{installationEntry:z,registrationPromise:M}})).apply(this,arguments)}function wr(I){return vs(I||{fid:vi(),registrationStatus:0})}function yr(I,M){if(0===M.registrationStatus){if(!navigator.onLine)return{installationEntry:M,registrationPromise:Promise.reject(Ot.create("app-offline"))};const z={fid:M.fid,registrationStatus:1,registrationTime:Date.now()},G=function ui(I,M){return Wn.apply(this,arguments)}(I,z);return{installationEntry:z,registrationPromise:G}}return 1===M.registrationStatus?{installationEntry:M,registrationPromise:ts(I)}:{installationEntry:M}}function Wn(){return(Wn=(0,xe.Z)(function*(I,M){try{const z=yield It(I,M);return Ao(I.appConfig,z)}catch(z){throw Jt(z)&&409===z.customData.serverCode?yield jn(I.appConfig):yield Ao(I.appConfig,{fid:M.fid,registrationStatus:0}),z}})).apply(this,arguments)}function ts(I){return Ur.apply(this,arguments)}function Ur(){return(Ur=(0,xe.Z)(function*(I){let M=yield Ho(I.appConfig);for(;1===M.registrationStatus;)yield wn(100),M=yield Ho(I.appConfig);if(0===M.registrationStatus){const{installationEntry:z,registrationPromise:G}=yield es(I);return G||z}return M})).apply(this,arguments)}function Ho(I){return lo(I,M=>{if(!M)throw Ot.create("installation-not-found");return vs(M)})}function vs(I){return function Jr(I){return 1===I.registrationStatus&&I.registrationTime+1e4<Date.now()}(I)?{fid:I.fid,registrationStatus:0}:I}function co(I,M){return mr.apply(this,arguments)}function mr(){return(mr=(0,xe.Z)(function*({appConfig:I,heartbeatServiceProvider:M},z){const G=cs(I,z),$=zt(I,z),te=M.getImmediate({optional:!0});if(te){const ye=yield te.getHeartbeatsHeader();ye&&$.append("x-firebase-client",ye)}const fe={method:"POST",headers:$,body:JSON.stringify({installation:{sdkVersion:nt,appId:I.appId}})},_e=yield en(()=>fetch(G,fe));if(_e.ok)return Zt(yield _e.json());throw yield nn("Generate Auth Token",_e)})).apply(this,arguments)}function cs(I,{fid:M}){return`${st(I)}/${M}/authTokens:generate`}function Bi(I){return qo.apply(this,arguments)}function qo(){return(qo=(0,xe.Z)(function*(I,M=!1){let z;const G=yield lo(I.appConfig,te=>{if(!er(te))throw Ot.create("not-registered");const ue=te.authToken;if(!M&&Qe(ue))return te;if(1===ue.requestStatus)return z=En(I,M),te;{if(!navigator.onLine)throw Ot.create("app-offline");const fe=at(te);return z=wi(I,fe),fe}});return z?yield z:G.authToken})).apply(this,arguments)}function En(I,M){return rn.apply(this,arguments)}function rn(){return(rn=(0,xe.Z)(function*(I,M){let z=yield zn(I.appConfig);for(;1===z.authToken.requestStatus;)yield wn(100),z=yield zn(I.appConfig);const G=z.authToken;return 0===G.requestStatus?Bi(I,M):G})).apply(this,arguments)}function zn(I){return lo(I,M=>{if(!er(M))throw Ot.create("not-registered");return function Ue(I){return 1===I.requestStatus&&I.requestTime+1e4<Date.now()}(M.authToken)?Object.assign(Object.assign({},M),{authToken:{requestStatus:0}}):M})}function wi(I,M){return Di.apply(this,arguments)}function Di(){return(Di=(0,xe.Z)(function*(I,M){try{const z=yield co(I,M),G=Object.assign(Object.assign({},M),{authToken:z});return yield Ao(I.appConfig,G),z}catch(z){if(!Jt(z)||401!==z.customData.serverCode&&404!==z.customData.serverCode){const G=Object.assign(Object.assign({},M),{authToken:{requestStatus:0}});yield Ao(I.appConfig,G)}else yield jn(I.appConfig);throw z}})).apply(this,arguments)}function er(I){return void 0!==I&&2===I.registrationStatus}function Qe(I){return 2===I.requestStatus&&!function je(I){const M=Date.now();return M<I.creationTime||I.creationTime+I.expiresIn<M+36e5}(I)}function at(I){const M={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},I),{authToken:M})}function re(){return(re=(0,xe.Z)(function*(I){const M=I,{installationEntry:z,registrationPromise:G}=yield es(M);return G?G.catch(console.error):Bi(M).catch(console.error),z.fid})).apply(this,arguments)}function ae(){return(ae=(0,xe.Z)(function*(I,M=!1){const z=I;return yield we(z),(yield Bi(z,M)).token})).apply(this,arguments)}function we(I){return De.apply(this,arguments)}function De(){return(De=(0,xe.Z)(function*(I){const{registrationPromise:M}=yield es(I);M&&(yield M)})).apply(this,arguments)}function ni(I){return Ot.create("missing-app-config-values",{valueName:I})}const Xn="installations",di=I=>{const M=I.getProvider("app").getImmediate(),z=function cn(I){if(!I||!I.options)throw ni("App Configuration");if(!I.name)throw ni("App Name");const M=["projectId","apiKey","appId"];for(const z of M)if(!I.options[z])throw ni(z);return{appName:I.name,projectId:I.options.projectId,apiKey:I.options.apiKey,appId:I.options.appId}}(M);return{app:M,appConfig:z,heartbeatServiceProvider:(0,ct._getProvider)(M,"heartbeat"),_delete:()=>Promise.resolve()}},Li=I=>{const M=I.getProvider("app").getImmediate(),z=(0,ct._getProvider)(M,Xn).getImmediate();return{getId:()=>function Ce(I){return re.apply(this,arguments)}(z),getToken:$=>function ie(I){return ae.apply(this,arguments)}(z,$)}};(function ur(){(0,ct._registerComponent)(new Ht.wA(Xn,di,"PUBLIC")),(0,ct._registerComponent)(new Ht.wA("installations-internal",Li,"PRIVATE"))})(),(0,ct.registerVersion)(ht,qe),(0,ct.registerVersion)(ht,qe,"esm2017");const li="@firebase/remote-config",Rt=new Ct.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Cc{constructor(M,z,G,$){this.client=M,this.storage=z,this.storageCache=G,this.logger=$}isCachedDataFresh(M,z){if(!z)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const G=Date.now()-z,$=G<=M;return this.logger.debug(`Config fetch cache check. Cache age millis: ${G}. Cache max age millis (minimumFetchIntervalMillis setting): ${M}. Is cache hit: ${$}.`),$}fetch(M){var z=this;return(0,xe.Z)(function*(){const[G,$]=yield Promise.all([z.storage.getLastSuccessfulFetchTimestampMillis(),z.storage.getLastSuccessfulFetchResponse()]);if($&&z.isCachedDataFresh(M.cacheMaxAgeMillis,G))return $;M.eTag=$&&$.eTag;const te=yield z.client.fetch(M),ue=[z.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===te.status&&ue.push(z.storage.setLastSuccessfulFetchResponse(te)),yield Promise.all(ue),te})()}}function Zr(I=navigator){return I.languages&&I.languages[0]||I.language}class ta{constructor(M,z,G,$,te,ue){this.firebaseInstallations=M,this.sdkVersion=z,this.namespace=G,this.projectId=$,this.apiKey=te,this.appId=ue}fetch(M){var z=this;return(0,xe.Z)(function*(){const[G,$]=yield Promise.all([z.firebaseInstallations.getId(),z.firebaseInstallations.getToken()]),ue=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${z.projectId}/namespaces/${z.namespace}:fetch?key=${z.apiKey}`,fe={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":M.eTag||"*"},_e={sdk_version:z.sdkVersion,app_instance_id:G,app_instance_id_token:$,app_id:z.appId,language_code:Zr()},ye={method:"POST",headers:fe,body:JSON.stringify(_e)},Te=fetch(ue,ye),de=new Promise((Xe,ut)=>{M.signal.addEventListener(()=>{const Et=new Error("The operation was aborted.");Et.name="AbortError",ut(Et)})});let Oe;try{yield Promise.race([Te,de]),Oe=yield Te}catch(Xe){let ut="fetch-client-network";throw"AbortError"===Xe?.name&&(ut="fetch-timeout"),Rt.create(ut,{originalErrorMessage:Xe?.message})}let Re=Oe.status;const Fe=Oe.headers.get("ETag")||void 0;let Ye,We;if(200===Oe.status){let Xe;try{Xe=yield Oe.json()}catch(ut){throw Rt.create("fetch-client-parse",{originalErrorMessage:ut?.message})}Ye=Xe.entries,We=Xe.state}if("INSTANCE_STATE_UNSPECIFIED"===We?Re=500:"NO_CHANGE"===We?Re=304:("NO_TEMPLATE"===We||"EMPTY_CONFIG"===We)&&(Ye={}),304!==Re&&200!==Re)throw Rt.create("fetch-status",{httpStatus:Re});return{status:Re,eTag:Fe,config:Ye}})()}}class Ya{constructor(M,z){this.client=M,this.storage=z}fetch(M){var z=this;return(0,xe.Z)(function*(){const G=(yield z.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return z.attemptFetch(M,G)})()}attemptFetch(M,{throttleEndTimeMillis:z,backoffCount:G}){var $=this;return(0,xe.Z)(function*(){yield function qr(I,M){return new Promise((z,G)=>{const $=Math.max(M-Date.now(),0),te=setTimeout(z,$);I.addEventListener(()=>{clearTimeout(te),G(Rt.create("fetch-throttle",{throttleEndTimeMillis:M}))})})}(M.signal,z);try{const te=yield $.client.fetch(M);return yield $.storage.deleteThrottleMetadata(),te}catch(te){if(!function Ki(I){if(!(I instanceof Ct.ZR&&I.customData))return!1;const M=Number(I.customData.httpStatus);return 429===M||500===M||503===M||504===M}(te))throw te;const ue={throttleEndTimeMillis:Date.now()+(0,Ct.$s)(G),backoffCount:G+1};return yield $.storage.setThrottleMetadata(ue),$.attemptFetch(M,ue)}})()}}class jl{constructor(M,z,G,$,te){this.app=M,this._client=z,this._storageCache=G,this._storage=$,this._logger=te,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function Ja(I,M){const z=I.target.error||void 0;return Rt.create(M,{originalErrorMessage:z&&z?.message})}const go="app_namespace_store";class uo{constructor(M,z,G,$=function Rs(){return new Promise((I,M)=>{try{const z=indexedDB.open("firebase_remote_config",1);z.onerror=G=>{M(Ja(G,"storage-open"))},z.onsuccess=G=>{I(G.target.result)},z.onupgradeneeded=G=>{0===G.oldVersion&&G.target.result.createObjectStore(go,{keyPath:"compositeKey"})}}catch(z){M(Rt.create("storage-open",{originalErrorMessage:z?.message}))}})}()){this.appId=M,this.appName=z,this.namespace=G,this.openDbPromise=$}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(M){return this.set("last_fetch_status",M)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(M){return this.set("last_successful_fetch_timestamp_millis",M)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(M){return this.set("last_successful_fetch_response",M)}getActiveConfig(){return this.get("active_config")}setActiveConfig(M){return this.set("active_config",M)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(M){return this.set("active_config_etag",M)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(M){return this.set("throttle_metadata",M)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(M){var z=this;return(0,xe.Z)(function*(){const G=yield z.openDbPromise;return new Promise(($,te)=>{const fe=G.transaction([go],"readonly").objectStore(go),_e=z.createCompositeKey(M);try{const ye=fe.get(_e);ye.onerror=Te=>{te(Ja(Te,"storage-get"))},ye.onsuccess=Te=>{const de=Te.target.result;$(de?de.value:void 0)}}catch(ye){te(Rt.create("storage-get",{originalErrorMessage:ye?.message}))}})})()}set(M,z){var G=this;return(0,xe.Z)(function*(){const $=yield G.openDbPromise;return new Promise((te,ue)=>{const _e=$.transaction([go],"readwrite").objectStore(go),ye=G.createCompositeKey(M);try{const Te=_e.put({compositeKey:ye,value:z});Te.onerror=de=>{ue(Ja(de,"storage-set"))},Te.onsuccess=()=>{te()}}catch(Te){ue(Rt.create("storage-set",{originalErrorMessage:Te?.message}))}})})()}delete(M){var z=this;return(0,xe.Z)(function*(){const G=yield z.openDbPromise;return new Promise(($,te)=>{const fe=G.transaction([go],"readwrite").objectStore(go),_e=z.createCompositeKey(M);try{const ye=fe.delete(_e);ye.onerror=Te=>{te(Ja(Te,"storage-delete"))},ye.onsuccess=()=>{$()}}catch(ye){te(Rt.create("storage-delete",{originalErrorMessage:ye?.message}))}})})()}createCompositeKey(M){return[this.appId,this.appName,this.namespace,M].join()}}class ko{constructor(M){this.storage=M}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var M=this;return(0,xe.Z)(function*(){const z=M.storage.getLastFetchStatus(),G=M.storage.getLastSuccessfulFetchTimestampMillis(),$=M.storage.getActiveConfig(),te=yield z;te&&(M.lastFetchStatus=te);const ue=yield G;ue&&(M.lastSuccessfulFetchTimestampMillis=ue);const fe=yield $;fe&&(M.activeConfig=fe)})()}setLastFetchStatus(M){return this.lastFetchStatus=M,this.storage.setLastFetchStatus(M)}setLastSuccessfulFetchTimestampMillis(M){return this.lastSuccessfulFetchTimestampMillis=M,this.storage.setLastSuccessfulFetchTimestampMillis(M)}setActiveConfig(M){return this.activeConfig=M,this.storage.setActiveConfig(M)}}function Xh(){return Bu.apply(this,arguments)}function Bu(){return(Bu=(0,xe.Z)(function*(){if(!(0,Ct.hl)())return!1;try{return yield(0,Ct.eu)()}catch{return!1}})).apply(this,arguments)}!function Nu(){(0,ct._registerComponent)(new Ht.wA("remote-config",function I(M,{instanceIdentifier:z}){const G=M.getProvider("app").getImmediate(),$=M.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Rt.create("registration-window");if(!(0,Ct.hl)())throw Rt.create("indexed-db-unavailable");const{projectId:te,apiKey:ue,appId:fe}=G.options;if(!te)throw Rt.create("registration-project-id");if(!ue)throw Rt.create("registration-api-key");if(!fe)throw Rt.create("registration-app-id");const _e=new uo(fe,G.name,z=z||"firebase"),ye=new ko(_e),Te=new y.Yd(li);Te.logLevel=y.in.ERROR;const de=new ta($,ct.SDK_VERSION,z,te,ue,fe),Oe=new Ya(de,_e),Re=new Cc(Oe,_e,ye,Te),Fe=new jl(G,Re,ye,_e,Te);return function Hn(I){const M=(0,Ct.m9)(I);M._initializePromise||(M._initializePromise=M._storageCache.loadFromStorage().then(()=>{M._isInitializationComplete=!0}))}(Fe),Fe},"PUBLIC").setMultipleInstances(!0)),(0,ct.registerVersion)(li,"0.4.3"),(0,ct.registerVersion)(li,"0.4.3","esm2017")}();const Ca="/firebase-messaging-sw.js",jo="/firebase-cloud-messaging-push-scope",Ec="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Gl="google.c.a.c_id",fh="google.c.a.c_l",Gd="google.c.a.ts",mh="google.c.a.e";var na=(()=>{return(I=na||(na={})).PUSH_RECEIVED="push-received",I.NOTIFICATION_CLICKED="notification-clicked",na;var I})();function Qa(I){const M=new Uint8Array(I);return btoa(String.fromCharCode(...M)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function ed(I){const z=(I+"=".repeat((4-I.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),G=atob(z),$=new Uint8Array(G.length);for(let te=0;te<G.length;++te)$[te]=G.charCodeAt(te);return $}const Tc="fcm_token_details_db",Sc="fcm_token_object_Store";function $l(I){return ia.apply(this,arguments)}function ia(){return ia=(0,xe.Z)(function*(I){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(te=>te.name).includes(Tc))return null;let M=null;return(yield(0,ze.X3)(Tc,5,{upgrade:(G=(0,xe.Z)(function*($,te,ue,fe){var _e;if(te<2||!$.objectStoreNames.contains(Sc))return;const ye=fe.objectStore(Sc),Te=yield ye.index("fcmSenderId").get(I);if(yield ye.clear(),Te)if(2===te){const de=Te;if(!de.auth||!de.p256dh||!de.endpoint)return;M={token:de.fcmToken,createTime:null!==(_e=de.createTime)&&void 0!==_e?_e:Date.now(),subscriptionOptions:{auth:de.auth,p256dh:de.p256dh,endpoint:de.endpoint,swScope:de.swScope,vapidKey:"string"==typeof de.vapidKey?de.vapidKey:Qa(de.vapidKey)}}}else if(3===te){const de=Te;M={token:de.fcmToken,createTime:de.createTime,subscriptionOptions:{auth:Qa(de.auth),p256dh:Qa(de.p256dh),endpoint:de.endpoint,swScope:de.swScope,vapidKey:Qa(de.vapidKey)}}}else if(4===te){const de=Te;M={token:de.fcmToken,createTime:de.createTime,subscriptionOptions:{auth:Qa(de.auth),p256dh:Qa(de.p256dh),endpoint:de.endpoint,swScope:de.swScope,vapidKey:Qa(de.vapidKey)}}}}),function(te,ue,fe,_e){return G.apply(this,arguments)})})).close(),yield(0,ze.Lj)(Tc),yield(0,ze.Lj)("fcm_vapid_details_db"),yield(0,ze.Lj)("undefined"),tu(M)?M:null;var G}),ia.apply(this,arguments)}function tu(I){if(!I||!I.subscriptionOptions)return!1;const{subscriptionOptions:M}=I;return"number"==typeof I.createTime&&I.createTime>0&&"string"==typeof I.token&&I.token.length>0&&"string"==typeof M.auth&&M.auth.length>0&&"string"==typeof M.p256dh&&M.p256dh.length>0&&"string"==typeof M.endpoint&&M.endpoint.length>0&&"string"==typeof M.swScope&&M.swScope.length>0&&"string"==typeof M.vapidKey&&M.vapidKey.length>0}const Wl="firebase-messaging-store";let nu=null;function iu(){return nu||(nu=(0,ze.X3)("firebase-messaging-database",1,{upgrade:(I,M)=>{0===M&&I.createObjectStore(Wl)}})),nu}function Vu(I){return Xa.apply(this,arguments)}function Xa(){return(Xa=(0,xe.Z)(function*(I){const M=gl(I),G=yield(yield iu()).transaction(Wl).objectStore(Wl).get(M);if(G)return G;{const $=yield $l(I.appConfig.senderId);if($)return yield Ic(I,$),$}})).apply(this,arguments)}function Ic(I,M){return Dc.apply(this,arguments)}function Dc(){return(Dc=(0,xe.Z)(function*(I,M){const z=gl(I),$=(yield iu()).transaction(Wl,"readwrite");return yield $.objectStore(Wl).put(M,z),yield $.done,M})).apply(this,arguments)}function gh(I){return Zl.apply(this,arguments)}function Zl(){return(Zl=(0,xe.Z)(function*(I){const M=gl(I),G=(yield iu()).transaction(Wl,"readwrite");yield G.objectStore(Wl).delete(M),yield G.done})).apply(this,arguments)}function gl({appConfig:I}){return I.appId}const Ro=new Ct.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function _h(I,M){return _o.apply(this,arguments)}function _o(){return(_o=(0,xe.Z)(function*(I,M){const z=yield Oa(I),G=yl(M),$={method:"POST",headers:z,body:JSON.stringify(G)};let te;try{te=yield(yield fetch(ru(I.appConfig),$)).json()}catch(ue){throw Ro.create("token-subscribe-failed",{errorInfo:ue?.toString()})}if(te.error)throw Ro.create("token-subscribe-failed",{errorInfo:te.error.message});if(!te.token)throw Ro.create("token-subscribe-no-token");return te.token})).apply(this,arguments)}function Uu(I,M){return Pa.apply(this,arguments)}function Pa(){return(Pa=(0,xe.Z)(function*(I,M){const z=yield Oa(I),G=yl(M.subscriptionOptions),$={method:"PATCH",headers:z,body:JSON.stringify(G)};let te;try{te=yield(yield fetch(`${ru(I.appConfig)}/${M.token}`,$)).json()}catch(ue){throw Ro.create("token-update-failed",{errorInfo:ue?.toString()})}if(te.error)throw Ro.create("token-update-failed",{errorInfo:te.error.message});if(!te.token)throw Ro.create("token-update-no-token");return te.token})).apply(this,arguments)}function Ps(I,M){return _l.apply(this,arguments)}function _l(){return(_l=(0,xe.Z)(function*(I,M){const G={method:"DELETE",headers:yield Oa(I)};try{const te=yield(yield fetch(`${ru(I.appConfig)}/${M}`,G)).json();if(te.error)throw Ro.create("token-unsubscribe-failed",{errorInfo:te.error.message})}catch($){throw Ro.create("token-unsubscribe-failed",{errorInfo:$?.toString()})}})).apply(this,arguments)}function ru({projectId:I}){return`https://fcmregistrations.googleapis.com/v1/projects/${I}/registrations`}function Oa(I){return Co.apply(this,arguments)}function Co(){return(Co=(0,xe.Z)(function*({appConfig:I,installations:M}){const z=yield M.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":I.apiKey,"x-goog-firebase-installations-auth":`FIS ${z}`})})).apply(this,arguments)}function yl({p256dh:I,auth:M,endpoint:z,vapidKey:G}){const $={web:{endpoint:z,auth:M,p256dh:I}};return G!==Ec&&($.web.applicationPubKey=G),$}const vl=6048e5;function $d(I){return Oi.apply(this,arguments)}function Oi(){return(Oi=(0,xe.Z)(function*(I){const M=yield Rp(I.swRegistration,I.vapidKey),z={vapidKey:I.vapidKey,swScope:I.swRegistration.scope,endpoint:M.endpoint,auth:Qa(M.getKey("auth")),p256dh:Qa(M.getKey("p256dh"))},G=yield Vu(I.firebaseDependencies);if(G){if(vh(G.subscriptionOptions,z))return Date.now()>=G.createTime+vl?Wi(I,{token:G.token,createTime:Date.now(),subscriptionOptions:z}):G.token;try{yield Ps(I.firebaseDependencies,G.token)}catch($){console.warn($)}return td(I.firebaseDependencies,z)}return td(I.firebaseDependencies,z)})).apply(this,arguments)}function Hu(I){return Ac.apply(this,arguments)}function Ac(){return(Ac=(0,xe.Z)(function*(I){const M=yield Vu(I.firebaseDependencies);M&&(yield Ps(I.firebaseDependencies,M.token),yield gh(I.firebaseDependencies));const z=yield I.swRegistration.pushManager.getSubscription();return!z||z.unsubscribe()})).apply(this,arguments)}function Wi(I,M){return Mc.apply(this,arguments)}function Mc(){return(Mc=(0,xe.Z)(function*(I,M){try{const z=yield Uu(I.firebaseDependencies,M),G=Object.assign(Object.assign({},M),{token:z,createTime:Date.now()});return yield Ic(I.firebaseDependencies,G),z}catch(z){throw yield Hu(I),z}})).apply(this,arguments)}function td(I,M){return ju.apply(this,arguments)}function ju(){return(ju=(0,xe.Z)(function*(I,M){const G={token:yield _h(I,M),createTime:Date.now(),subscriptionOptions:M};return yield Ic(I,G),G.token})).apply(this,arguments)}function Rp(I,M){return yh.apply(this,arguments)}function yh(){return(yh=(0,xe.Z)(function*(I,M){return(yield I.pushManager.getSubscription())||I.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:ed(M)})})).apply(this,arguments)}function vh(I,M){return M.vapidKey===I.vapidKey&&M.endpoint===I.endpoint&&M.auth===I.auth&&M.p256dh===I.p256dh}function Gu(I){const M={from:I.from,collapseKey:I.collapse_key,messageId:I.fcmMessageId};return function Wd(I,M){if(!M.notification)return;I.notification={};const z=M.notification.title;z&&(I.notification.title=z);const G=M.notification.body;G&&(I.notification.body=G);const $=M.notification.image;$&&(I.notification.image=$);const te=M.notification.icon;te&&(I.notification.icon=te)}(M,I),function dn(I,M){M.data&&(I.data=M.data)}(M,I),function xi(I,M){var z,G,$,te,ue;if(!(M.fcmOptions||null!==(z=M.notification)&&void 0!==z&&z.click_action))return;I.fcmOptions={};const fe=null!==($=null===(G=M.fcmOptions)||void 0===G?void 0:G.link)&&void 0!==$?$:null===(te=M.notification)||void 0===te?void 0:te.click_action;fe&&(I.fcmOptions.link=fe);const _e=null===(ue=M.fcmOptions)||void 0===ue?void 0:ue.analytics_label;_e&&(I.fcmOptions.analyticsLabel=_e)}(M,I),M}function Pp(I){return"object"==typeof I&&!!I&&Gl in I}function Op(I,M){const z=[];for(let G=0;G<I.length;G++)z.push(I.charAt(G)),G<M.length&&z.push(M.charAt(G));return z.join("")}function ou(I){return Ro.create("missing-app-config-values",{valueName:I})}Op("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Op("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class su{constructor(M,z,G){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const $=function Go(I){if(!I||!I.options)throw ou("App Configuration Object");if(!I.name)throw ou("App Name");const M=["projectId","apiKey","appId","messagingSenderId"],{options:z}=I;for(const G of M)if(!z[G])throw ou(G);return{appName:I.name,projectId:z.projectId,apiKey:z.apiKey,appId:z.appId,senderId:z.messagingSenderId}}(M);this.firebaseDependencies={app:M,appConfig:$,installations:z,analyticsProvider:G}}_delete(){return Promise.resolve()}}function ga(I){return ql.apply(this,arguments)}function ql(){return(ql=(0,xe.Z)(function*(I){try{I.swRegistration=yield navigator.serviceWorker.register(Ca,{scope:jo}),I.swRegistration.update().catch(()=>{})}catch(M){throw Ro.create("failed-service-worker-registration",{browserErrorMessage:M?.message})}})).apply(this,arguments)}function el(I,M){return $u.apply(this,arguments)}function $u(){return($u=(0,xe.Z)(function*(I,M){if(!M&&!I.swRegistration&&(yield ga(I)),M||!I.swRegistration){if(!(M instanceof ServiceWorkerRegistration))throw Ro.create("invalid-sw-registration");I.swRegistration=M}})).apply(this,arguments)}function vm(I,M){return bl.apply(this,arguments)}function bl(){return(bl=(0,xe.Z)(function*(I,M){M?I.vapidKey=M:I.vapidKey||(I.vapidKey=Ec)})).apply(this,arguments)}function Ws(){return(Ws=(0,xe.Z)(function*(I,M){if(!navigator)throw Ro.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw Ro.create("permission-blocked");return yield vm(I,M?.vapidKey),yield el(I,M?.serviceWorkerRegistration),$d(I)})).apply(this,arguments)}function nd(I,M,z){return Zs.apply(this,arguments)}function Zs(){return(Zs=(0,xe.Z)(function*(I,M,z){const G=Kl(M);(yield I.firebaseDependencies.analyticsProvider.get()).logEvent(G,{message_id:z[Gl],message_name:z[fh],message_time:z[Gd],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function Kl(I){switch(I){case na.NOTIFICATION_CLICKED:return"notification_open";case na.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function au(){return(au=(0,xe.Z)(function*(I,M){const z=M.data;if(!z.isFirebaseMessaging)return;I.onMessageHandler&&z.messageType===na.PUSH_RECEIVED&&("function"==typeof I.onMessageHandler?I.onMessageHandler(Gu(z)):I.onMessageHandler.next(Gu(z)));const G=z.data;Pp(G)&&"1"===G[mh]&&(yield nd(I,z.messageType,G))})).apply(this,arguments)}const lu="@firebase/messaging",Yl=I=>{const M=new su(I.getProvider("app").getImmediate(),I.getProvider("installations-internal").getImmediate(),I.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",z=>function id(I,M){return au.apply(this,arguments)}(M,z)),M},rd=I=>{const M=I.getProvider("messaging").getImmediate();return{getToken:G=>function bs(I,M){return Ws.apply(this,arguments)}(M,G)}};function od(){return sd.apply(this,arguments)}function sd(){return(sd=(0,xe.Z)(function*(){try{yield(0,Ct.eu)()}catch{return!1}return typeof window<"u"&&(0,Ct.hl)()&&(0,Ct.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function Jl(){(0,ct._registerComponent)(new Ht.wA("messaging",Yl,"PUBLIC")),(0,ct._registerComponent)(new Ht.wA("messaging-internal",rd,"PRIVATE")),(0,ct.registerVersion)(lu,"0.12.3"),(0,ct.registerVersion)(lu,"0.12.3","esm2017")}();const bh="analytics",ra="firebase_id",ad="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",qd="https://www.googletagmanager.com/gtag/js",Po=new y.Yd("@firebase/analytics");function Wu(I){return Promise.all(I.map(M=>M.catch(z=>z)))}function ld(I,M){const z=document.createElement("script");z.src=`${qd}?l=${I}&id=${M}`,z.async=!0,document.head.appendChild(z)}function xl(I,M,z,G,$,te){return Ea.apply(this,arguments)}function Ea(){return(Ea=(0,xe.Z)(function*(I,M,z,G,$,te){const ue=G[$];try{if(ue)yield M[ue];else{const _e=(yield Wu(z)).find(ye=>ye.measurementId===$);_e&&(yield M[_e.appId])}}catch(fe){Po.error(fe)}I("config",$,te)})).apply(this,arguments)}function Cl(I,M,z,G,$){return ji.apply(this,arguments)}function ji(){return(ji=(0,xe.Z)(function*(I,M,z,G,$){try{let te=[];if($&&$.send_to){let ue=$.send_to;Array.isArray(ue)||(ue=[ue]);const fe=yield Wu(z);for(const _e of ue){const ye=fe.find(de=>de.measurementId===_e),Te=ye&&M[ye.appId];if(!Te){te=[];break}te.push(Te)}}0===te.length&&(te=Object.values(M)),yield Promise.all(te),I("event",G,$||{})}catch(te){Po.error(te)}})).apply(this,arguments)}function tl(I){const M=window.document.getElementsByTagName("script");for(const z of Object.values(M))if(z.src&&z.src.includes(qd)&&z.src.includes(I))return z;return null}const Os=new Ct.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),wh=new class Sf{constructor(M={},z=1e3){this.throttleMetadata=M,this.intervalMillis=z}getThrottleMetadata(M){return this.throttleMetadata[M]}setThrottleMetadata(M,z){this.throttleMetadata[M]=z}deleteThrottleMetadata(M){delete this.throttleMetadata[M]}};function Ta(I){return new Headers({Accept:"application/json","x-goog-api-key":I})}function Pc(I){return Eo.apply(this,arguments)}function Eo(){return(Eo=(0,xe.Z)(function*(I){var M;const{appId:z,apiKey:G}=I,$={method:"GET",headers:Ta(G)},te=ad.replace("{app-id}",z),ue=yield fetch(te,$);if(200!==ue.status&&304!==ue.status){let fe="";try{const _e=yield ue.json();null!==(M=_e.error)&&void 0!==M&&M.message&&(fe=_e.error.message)}catch{}throw Os.create("config-fetch-failed",{httpStatus:ue.status,responseMessage:fe})}return ue.json()})).apply(this,arguments)}function El(I){return qs.apply(this,arguments)}function qs(){return(qs=(0,xe.Z)(function*(I,M=wh,z){const{appId:G,apiKey:$,measurementId:te}=I.options;if(!G)throw Os.create("no-app-id");if(!$){if(te)return{measurementId:te,appId:G};throw Os.create("no-api-key")}const ue=M.getThrottleMetadata(G)||{backoffCount:0,throttleEndTimeMillis:Date.now()},fe=new uu;return setTimeout((0,xe.Z)(function*(){fe.abort()}),void 0!==z?z:6e4),Oc({appId:G,apiKey:$,measurementId:te},ue,fe,M)})).apply(this,arguments)}function Oc(I,M,z){return oa.apply(this,arguments)}function oa(){return(oa=(0,xe.Z)(function*(I,{throttleEndTimeMillis:M,backoffCount:z},G,$=wh){var te;const{appId:ue,measurementId:fe}=I;try{yield An(G,M)}catch(_e){if(fe)return Po.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${fe} provided in the "measurementId" field in the local Firebase config. [${_e?.message}]`),{appId:ue,measurementId:fe};throw _e}try{const _e=yield Pc(I);return $.deleteThrottleMetadata(ue),_e}catch(_e){const ye=_e;if(!_a(ye)){if($.deleteThrottleMetadata(ue),fe)return Po.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${fe} provided in the "measurementId" field in the local Firebase config. [${ye?.message}]`),{appId:ue,measurementId:fe};throw _e}const Te=503===Number(null===(te=ye?.customData)||void 0===te?void 0:te.httpStatus)?(0,Ct.$s)(z,$.intervalMillis,30):(0,Ct.$s)(z,$.intervalMillis),de={throttleEndTimeMillis:Date.now()+Te,backoffCount:z+1};return $.setThrottleMetadata(ue,de),Po.debug(`Calling attemptFetch again in ${Te} millis`),Oc(I,de,G,$)}})).apply(this,arguments)}function An(I,M){return new Promise((z,G)=>{const $=Math.max(M-Date.now(),0),te=setTimeout(z,$);I.addEventListener(()=>{clearTimeout(te),G(Os.create("fetch-throttle",{throttleEndTimeMillis:M}))})})}function _a(I){if(!(I instanceof Ct.ZR&&I.customData))return!1;const M=Number(I.customData.httpStatus);return 429===M||500===M||503===M||504===M}class uu{constructor(){this.listeners=[]}addEventListener(M){this.listeners.push(M)}abort(){this.listeners.forEach(M=>M())}}let xh,Zu;function il(){return(il=(0,xe.Z)(function*(I,M,z,G,$){if($&&$.global)I("event",z,G);else{const te=yield M;I("event",z,Object.assign(Object.assign({},G),{send_to:te}))}})).apply(this,arguments)}function cd(I){Zu=I}function hu(I){xh=I}function Eh(){return du.apply(this,arguments)}function du(){return(du=(0,xe.Z)(function*(){if(!(0,Ct.hl)())return Po.warn(Os.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,Ct.eu)()}catch(I){return Po.warn(Os.create("indexeddb-unavailable",{errorInfo:I?.toString()}).message),!1}return!0})).apply(this,arguments)}function tc(){return(tc=(0,xe.Z)(function*(I,M,z,G,$,te,ue){var fe;const _e=El(I);_e.then(Re=>{z[Re.measurementId]=Re.appId,I.options.measurementId&&Re.measurementId!==I.options.measurementId&&Po.warn(`The measurement ID in the local Firebase config (${I.options.measurementId}) does not match the measurement ID fetched from the server (${Re.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(Re=>Po.error(Re)),M.push(_e);const ye=Eh().then(Re=>{if(Re)return G.getId()}),[Te,de]=yield Promise.all([_e,ye]);tl(te)||ld(te,Te.measurementId),Zu&&($("consent","default",Zu),cd(void 0)),$("js",new Date);const Oe=null!==(fe=ue?.config)&&void 0!==fe?fe:{};return Oe.origin="firebase",Oe.update=!0,null!=de&&(Oe[ra]=de),$("config",Te.measurementId,Oe),xh&&($("set",xh),hu(void 0)),Te.measurementId})).apply(this,arguments)}class qu{constructor(M){this.app=M}_delete(){return delete Na[this.app.options.appId],Promise.resolve()}}let Na={},ud=[];const Fc={};let Nc,Ks,za="dataLayer",Sa=!1;function zc(I,M,z){!function dd(){const I=[];if((0,Ct.ru)()&&I.push("This is a browser extension environment."),(0,Ct.zI)()||I.push("Cookies are not available."),I.length>0){const M=I.map((G,$)=>`(${$+1}) ${G}`).join(" "),z=Os.create("invalid-analytics-context",{errorInfo:M});Po.warn(z.message)}}();const G=I.options.appId;if(!G)throw Os.create("no-app-id");if(!I.options.apiKey){if(!I.options.measurementId)throw Os.create("no-api-key");Po.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${I.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Na[G])throw Os.create("already-exists",{id:G});if(!Sa){!function cu(I){let M=[];Array.isArray(window[I])?M=window[I]:window[I]=M}(za);const{wrappedGtag:te,gtagCore:ue}=function Tf(I,M,z,G,$){let te=function(...ue){window[G].push(arguments)};return window[$]&&"function"==typeof window[$]&&(te=window[$]),window[$]=function Xl(I,M,z,G){function te(){return(te=(0,xe.Z)(function*(ue,fe,_e){try{"event"===ue?yield Cl(I,M,z,fe,_e):"config"===ue?yield xl(I,M,z,G,fe,_e):"consent"===ue?I("consent","update",_e):I("set",fe)}catch(ye){Po.error(ye)}})).apply(this,arguments)}return function $(ue,fe,_e){return te.apply(this,arguments)}}(te,I,M,z),{gtagCore:te,wrappedGtag:window[$]}}(Na,ud,Fc,za,"gtag");Ks=te,Nc=ue,Sa=!0}return Na[G]=function Kd(I,M,z,G,$,te,ue){return tc.apply(this,arguments)}(I,ud,Fc,M,Nc,za,z),new qu(I)}function Ls(){return Bc.apply(this,arguments)}function Bc(){return(Bc=(0,xe.Z)(function*(){if((0,Ct.ru)()||!(0,Ct.zI)()||!(0,Ct.hl)())return!1;try{return yield(0,Ct.eu)()}catch{return!1}})).apply(this,arguments)}const Cr="@firebase/analytics";!function Jd(){(0,ct._registerComponent)(new Ht.wA(bh,(M,{options:z})=>zc(M.getProvider("app").getImmediate(),M.getProvider("installations-internal").getImmediate(),z),"PUBLIC")),(0,ct._registerComponent)(new Ht.wA("analytics-internal",function I(M){try{const z=M.getProvider(bh).getImmediate();return{logEvent:(G,$,te)=>function Qu(I,M,z,G){I=(0,Ct.m9)(I),function nl(I,M,z,G,$){return il.apply(this,arguments)}(Ks,Na[I.app.options.appId],M,z,G).catch($=>Po.error($))}(z,G,$,te)}}catch(z){throw Os.create("interop-component-reg-failed",{reason:z})}},"PRIVATE")),(0,ct.registerVersion)(Cr,"0.9.3"),(0,ct.registerVersion)(Cr,"0.9.3","esm2017")}();var pd=Ee(233),Uc=Ee(4986),nc=Ee(9751),Sh=Ee(8505),Df=Ee(9468),ic=Ee(5363);const Af=new pe.GfV("7.5.0"),rc="__angularfire_symbol__analyticsIsSupportedValue",To="__angularfire_symbol__analyticsIsSupported",Hc="__angularfire_symbol__remoteConfigIsSupportedValue",oc="__angularfire_symbol__remoteConfigIsSupported",pu="__angularfire_symbol__messagingIsSupportedValue",hs="__angularfire_symbol__messagingIsSupported";function kf(I,M,z){if(M){if(1===M.length)return M[0];const te=M.filter(ue=>ue.app===z);if(1===te.length)return te[0]}return z.container.getProvider(I).getImmediate({optional:!0})}globalThis[To]||(globalThis[To]=Ls().then(I=>globalThis[rc]=I).catch(()=>globalThis[rc]=!1)),globalThis[hs]||(globalThis[hs]=od().then(I=>globalThis[pu]=I).catch(()=>globalThis[pu]=!1)),globalThis[oc]||(globalThis[oc]=Xh().then(I=>globalThis[Hc]=I).catch(()=>globalThis[Hc]=!1));const zp=(I,M)=>{const z=M?[M]:(0,o.C6)(),G=[];return z.forEach($=>{$.container.getProvider(I).instances.forEach(ue=>{G.includes(ue)||G.push(ue)})}),G};function fu(){}class Qd{constructor(M,z=pd.N){this.zone=M,this.delegate=z}now(){return this.delegate.now()}schedule(M,z,G){const $=this.zone;return this.delegate.schedule(function(ue){$.runGuarded(()=>{M.apply(this,[ue])})},z,G)}}class Ys{constructor(M){this.zone=M,this.task=null}call(M,z){const G=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",fu,{},fu,fu)),z.pipe((0,Sh.b)({next:G,complete:G,error:G})).subscribe(M).add(G)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let Xd=(()=>{class I{constructor(z){this.ngZone=z,this.outsideAngular=z.runOutsideAngular(()=>new Qd(Zone.current)),this.insideAngular=z.run(()=>new Qd(Zone.current,Uc.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return I.\u0275fac=function(z){return new(z||I)(pe.LFG(pe.R0b))},I.\u0275prov=pe.Yz7({token:I,factory:I.\u0275fac,providedIn:"root"}),I})();function Oo(){const I=globalThis.\u0275AngularFireScheduler;if(!I)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return I}function Qr(I){return Oo().ngZone.runOutsideAngular(()=>I())}function qn(I){return Oo().ngZone.run(()=>I())}function _(I){return Oo(),function T(I){return function(z){return(z=z.lift(new Ys(I.ngZone))).pipe((0,Df.R)(I.outsideAngular),(0,ic.Q)(I.insideAngular))}}(Oo())(I)}const k=(I,M)=>function(){const G=arguments;return M&&setTimeout(()=>{"scheduled"===M.state&&M.invoke()},10),qn(()=>I.apply(void 0,G))},P=(I,M)=>function(){let z;const G=arguments;for(let te=0;te<arguments.length;te++)"function"==typeof G[te]&&(M&&(z||(z=qn(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",fu,{},fu,fu)))),G[te]=k(G[te],z));const $=Qr(()=>I.apply(this,G));if(!M){if($ instanceof nc.y){const te=Oo();return $.pipe((0,Df.R)(te.outsideAngular),(0,ic.Q)(te.insideAngular))}return qn(()=>$)}return $ instanceof nc.y?$.pipe(_):$ instanceof Promise?qn(()=>new Promise((te,ue)=>$.then(fe=>qn(()=>te(fe)),fe=>qn(()=>ue(fe))))):"function"==typeof $&&z?function(){return setTimeout(()=>{z&&"scheduled"===z.state&&z.invoke()},10),$.apply(this,arguments)}:qn(()=>$)}},2722:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{$:()=>ru,A:()=>Ne,B:()=>ft,G:()=>Li,H:()=>Mr,J:()=>Ya,L:()=>Qe,M:()=>Bu,N:()=>ph,P:()=>Af,Q:()=>Gl,R:()=>Sl,T:()=>fh,U:()=>Ec,V:()=>na,W:()=>Qa,X:()=>$l,Y:()=>Mi,Z:()=>_h,_:()=>Uu,a:()=>Rc,a0:()=>$d,a1:()=>Hu,a2:()=>Wi,a3:()=>td,a4:()=>Rp,a5:()=>vh,a6:()=>Wd,a7:()=>dn,a8:()=>Pp,a9:()=>Op,aA:()=>je,aB:()=>Oe,aC:()=>k,aD:()=>T,aE:()=>Nn,aI:()=>Ta,aL:()=>mh,aa:()=>ga,ab:()=>el,ac:()=>vm,af:()=>nd,ag:()=>Kl,ah:()=>id,ak:()=>Wl,al:()=>Ql,an:()=>qd,ao:()=>Ea,ap:()=>en,aq:()=>Ke,ar:()=>we,as:()=>Jt,at:()=>Fr,au:()=>on,av:()=>ot,aw:()=>st,ax:()=>it,ay:()=>Xe,az:()=>xt,b:()=>Os,c:()=>fd,d:()=>fu,e:()=>kf,f:()=>M,g:()=>fe,h:()=>$,i:()=>du,j:()=>Te,k:()=>Ih,l:()=>Rn,m:()=>to,n:()=>cy,o:()=>ze,r:()=>pd,s:()=>Vc,u:()=>Df});var pe=Ee(5861),o=Ee(2090),xe=Ee(9681),ct=Ee(1877),Ct=Ee(655),Ht=Ee(4859);const ze={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Ne={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const ft=function nt(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},ln=function fn(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Ze=new o.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),dt=new ct.Yd("@firebase/auth");function Ot(Z,...F){dt.logLevel<=ct.in.ERROR&&dt.error(`Auth (${xe.SDK_VERSION}): ${Z}`,...F)}function Jt(Z,...F){throw yn(Z,...F)}function st(Z,...F){return yn(Z,...F)}function Zt(Z,F,V){const J=Object.assign(Object.assign({},ln()),{[F]:V});return new o.LL("auth","Firebase",J).create(F,{appName:Z.name})}function nn(Z,F,V){if(!(F instanceof V))throw V.name!==F.constructor.name&&Jt(Z,"argument-error"),Zt(Z,"argument-error",`Type of ${F.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function yn(Z,...F){if("string"!=typeof Z){const V=F[0],J=[...F.slice(1)];return J[0]&&(J[0].appName=Z.name),Z._errorFactory.create(V,...J)}return Ze.create(Z,...F)}function it(Z,F,...V){if(!Z)throw yn(F,...V)}function zt(Z){const F="INTERNAL ASSERTION FAILED: "+Z;throw Ot(F),new Error(F)}function en(Z,F){Z||zt(F)}const gt=new Map;function xt(Z){en(Z instanceof Function,"Expected a class definition");let F=gt.get(Z);return F?(en(F instanceof Z,"Instance stored in cache mismatched with class"),F):(F=new Z,gt.set(Z,F),F)}function Vt(){var Z;return typeof self<"u"&&(null===(Z=self.location)||void 0===Z?void 0:Z.href)||""}function wn(){return"http:"===ai()||"https:"===ai()}function ai(){var Z;return typeof self<"u"&&(null===(Z=self.location)||void 0===Z?void 0:Z.protocol)||null}class vi{constructor(F,V){this.shortDelay=F,this.longDelay=V,en(V>F,"Short delay should be less than long delay!"),this.isMobile=(0,o.uI)()||(0,o.b$)()}get(){return function ir(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(wn()||(0,o.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function zi(Z,F){en(Z.emulator,"Emulator should always be set here");const{url:V}=Z.emulator;return F?`${V}${F.startsWith("/")?F.slice(1):F}`:V}class ri{static initialize(F,V,J){this.fetchImpl=F,V&&(this.headersImpl=V),J&&(this.responseImpl=J)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void zt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void zt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void zt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const or={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},Bo=new vi(3e4,6e4);function $i(Z,F){return Z.tenantId&&!F.tenantId?Object.assign(Object.assign({},F),{tenantId:Z.tenantId}):F}function bi(Z,F,V,J){return Gr.apply(this,arguments)}function Gr(){return(Gr=(0,pe.Z)(function*(Z,F,V,J,me={}){return Vo(Z,me,(0,pe.Z)(function*(){let ke={},Mt={};J&&("GET"===F?Mt=J:ke={body:JSON.stringify(J)});const mn=(0,o.xO)(Object.assign({key:Z.config.apiKey},Mt)).slice(1),ei=yield Z._getAdditionalHeaders();return ei["Content-Type"]="application/json",Z.languageCode&&(ei["X-Firebase-Locale"]=Z.languageCode),ri.fetch()(ys(Z,Z.config.apiHost,V,mn),Object.assign({method:F,headers:ei,referrerPolicy:"no-referrer"},ke))}))})).apply(this,arguments)}function Vo(Z,F,V){return $r.apply(this,arguments)}function $r(){return($r=(0,pe.Z)(function*(Z,F,V){Z._canInitEmulator=!1;const J=Object.assign(Object.assign({},or),F);try{const me=new qi(Z),ke=yield Promise.race([V(),me.promise]);me.clearNetworkTimeout();const Mt=yield ke.json();if("needConfirmation"in Mt)throw Rr(Z,"account-exists-with-different-credential",Mt);if(ke.ok&&!("errorMessage"in Mt))return Mt;{const mn=ke.ok?Mt.errorMessage:Mt.error.message,[ei,oi]=mn.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===ei)throw Rr(Z,"credential-already-in-use",Mt);if("EMAIL_EXISTS"===ei)throw Rr(Z,"email-already-in-use",Mt);if("USER_DISABLED"===ei)throw Rr(Z,"user-disabled",Mt);const dr=J[ei]||ei.toLowerCase().replace(/[_\s]+/g,"-");if(oi)throw Zt(Z,dr,oi);Jt(Z,dr)}}catch(me){if(me instanceof o.ZR)throw me;Jt(Z,"network-request-failed")}})).apply(this,arguments)}function fo(Z,F,V,J){return Ar.apply(this,arguments)}function Ar(){return(Ar=(0,pe.Z)(function*(Z,F,V,J,me={}){const ke=yield bi(Z,F,V,J,me);return"mfaPendingCredential"in ke&&Jt(Z,"multi-factor-auth-required",{_serverResponse:ke}),ke})).apply(this,arguments)}function ys(Z,F,V,J){const me=`${F}${V}?${J}`;return Z.config.emulator?zi(Z.config,me):`${Z.config.apiScheme}://${me}`}class qi{constructor(F){this.auth=F,this.timer=null,this.promise=new Promise((V,J)=>{this.timer=setTimeout(()=>J(st(this.auth,"network-request-failed")),Bo.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Rr(Z,F,V){const J={appName:Z.name};V.email&&(J.email=V.email),V.phoneNumber&&(J.phoneNumber=V.phoneNumber);const me=st(Z,F,J);return me.customData._tokenResponse=V,me}function Gs(){return(Gs=(0,pe.Z)(function*(Z,F){return bi(Z,"POST","/v1/accounts:delete",F)})).apply(this,arguments)}function Ao(Z,F){return Pr.apply(this,arguments)}function Pr(){return(Pr=(0,pe.Z)(function*(Z,F){return bi(Z,"POST","/v1/accounts:update",F)})).apply(this,arguments)}function jn(Z,F){return Uo.apply(this,arguments)}function Uo(){return(Uo=(0,pe.Z)(function*(Z,F){return bi(Z,"POST","/v1/accounts:lookup",F)})).apply(this,arguments)}function lo(Z){if(Z)try{const F=new Date(Number(Z));if(!isNaN(F.getTime()))return F.toUTCString()}catch{}}function Mo(){return(Mo=(0,pe.Z)(function*(Z,F=!1){const V=(0,o.m9)(Z),J=yield V.getIdToken(F),me=yr(J);it(me&&me.exp&&me.auth_time&&me.iat,V.auth,"internal-error");const ke="object"==typeof me.firebase?me.firebase:void 0,Mt=ke?.sign_in_provider;return{claims:me,token:J,authTime:lo(wr(me.auth_time)),issuedAtTime:lo(wr(me.iat)),expirationTime:lo(wr(me.exp)),signInProvider:Mt||null,signInSecondFactor:ke?.sign_in_second_factor||null}})).apply(this,arguments)}function wr(Z){return 1e3*Number(Z)}function yr(Z){const[F,V,J]=Z.split(".");if(void 0===F||void 0===V||void 0===J)return Ot("JWT malformed, contained fewer than 3 sections"),null;try{const me=(0,o.tV)(V);return me?JSON.parse(me):(Ot("Failed to decode base64 JWT payload"),null)}catch(me){return Ot("Caught error parsing JWT payload as JSON",me?.toString()),null}}function Wn(Z,F){return ts.apply(this,arguments)}function ts(){return(ts=(0,pe.Z)(function*(Z,F,V=!1){if(V)return F;try{return yield F}catch(J){throw J instanceof o.ZR&&Ur(J)&&Z.auth.currentUser===Z&&(yield Z.auth.signOut()),J}})).apply(this,arguments)}function Ur({code:Z}){return"auth/user-disabled"===Z||"auth/user-token-expired"===Z}class Ho{constructor(F){this.user=F,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(F){var V;if(F){const J=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),J}{this.errorBackoff=3e4;const me=(null!==(V=this.user.stsTokenManager.expirationTime)&&void 0!==V?V:0)-Date.now()-3e5;return Math.max(0,me)}}schedule(F=!1){var V=this;if(!this.isRunning)return;const J=this.getInterval(F);this.timerId=setTimeout((0,pe.Z)(function*(){yield V.iteration()}),J)}iteration(){var F=this;return(0,pe.Z)(function*(){try{yield F.user.getIdToken(!0)}catch(V){return void("auth/network-request-failed"===V?.code&&F.schedule(!0))}F.schedule()})()}}class vs{constructor(F,V){this.createdAt=F,this.lastLoginAt=V,this._initializeTime()}_initializeTime(){this.lastSignInTime=lo(this.lastLoginAt),this.creationTime=lo(this.createdAt)}_copy(F){this.createdAt=F.createdAt,this.lastLoginAt=F.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Jr(Z){return co.apply(this,arguments)}function co(){return(co=(0,pe.Z)(function*(Z){var F;const V=Z.auth,J=yield Z.getIdToken(),me=yield Wn(Z,jn(V,{idToken:J}));it(me?.users.length,V,"internal-error");const ke=me.users[0];Z._notifyReloadListener(ke);const Mt=null!==(F=ke.providerUserInfo)&&void 0!==F&&F.length?qo(ke.providerUserInfo):[],mn=Bi(Z.providerData,Mt),dr=!!Z.isAnonymous&&!(Z.email&&ke.passwordHash||mn?.length),rs={uid:ke.localId,displayName:ke.displayName||null,photoURL:ke.photoUrl||null,email:ke.email||null,emailVerified:ke.emailVerified||!1,phoneNumber:ke.phoneNumber||null,tenantId:ke.tenantId||null,providerData:mn,metadata:new vs(ke.createdAt,ke.lastLoginAt),isAnonymous:dr};Object.assign(Z,rs)})).apply(this,arguments)}function cs(){return(cs=(0,pe.Z)(function*(Z){const F=(0,o.m9)(Z);yield Jr(F),yield F.auth._persistUserIfCurrent(F),F.auth._notifyListenersIfCurrent(F)})).apply(this,arguments)}function Bi(Z,F){return[...Z.filter(J=>!F.some(me=>me.providerId===J.providerId)),...F]}function qo(Z){return Z.map(F=>{var{providerId:V}=F,J=(0,Ct._T)(F,["providerId"]);return{providerId:V,uid:J.rawId||"",displayName:J.displayName||null,email:J.email||null,phoneNumber:J.phoneNumber||null,photoURL:J.photoUrl||null}})}function rn(){return(rn=(0,pe.Z)(function*(Z,F){const V=yield Vo(Z,{},(0,pe.Z)(function*(){const J=(0,o.xO)({grant_type:"refresh_token",refresh_token:F}).slice(1),{tokenApiHost:me,apiKey:ke}=Z.config,Mt=ys(Z,me,"/v1/token",`key=${ke}`),mn=yield Z._getAdditionalHeaders();return mn["Content-Type"]="application/x-www-form-urlencoded",ri.fetch()(Mt,{method:"POST",headers:mn,body:J})}));return{accessToken:V.access_token,expiresIn:V.expires_in,refreshToken:V.refresh_token}})).apply(this,arguments)}class zn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(F){it(F.idToken,"internal-error"),it(typeof F.idToken<"u","internal-error"),it(typeof F.refreshToken<"u","internal-error");const V="expiresIn"in F&&typeof F.expiresIn<"u"?Number(F.expiresIn):function ui(Z){const F=yr(Z);return it(F,"internal-error"),it(typeof F.exp<"u","internal-error"),it(typeof F.iat<"u","internal-error"),Number(F.exp)-Number(F.iat)}(F.idToken);this.updateTokensAndExpiration(F.idToken,F.refreshToken,V)}getToken(F,V=!1){var J=this;return(0,pe.Z)(function*(){return it(!J.accessToken||J.refreshToken,F,"user-token-expired"),V||!J.accessToken||J.isExpired?J.refreshToken?(yield J.refresh(F,J.refreshToken),J.accessToken):null:J.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(F,V){var J=this;return(0,pe.Z)(function*(){const{accessToken:me,refreshToken:ke,expiresIn:Mt}=yield function En(Z,F){return rn.apply(this,arguments)}(F,V);J.updateTokensAndExpiration(me,ke,Number(Mt))})()}updateTokensAndExpiration(F,V,J){this.refreshToken=V||null,this.accessToken=F||null,this.expirationTime=Date.now()+1e3*J}static fromJSON(F,V){const{refreshToken:J,accessToken:me,expirationTime:ke}=V,Mt=new zn;return J&&(it("string"==typeof J,"internal-error",{appName:F}),Mt.refreshToken=J),me&&(it("string"==typeof me,"internal-error",{appName:F}),Mt.accessToken=me),ke&&(it("number"==typeof ke,"internal-error",{appName:F}),Mt.expirationTime=ke),Mt}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(F){this.accessToken=F.accessToken,this.refreshToken=F.refreshToken,this.expirationTime=F.expirationTime}_clone(){return Object.assign(new zn,this.toJSON())}_performRefresh(){return zt("not implemented")}}function wi(Z,F){it("string"==typeof Z||typeof Z>"u","internal-error",{appName:F})}class Di{constructor(F){var{uid:V,auth:J,stsTokenManager:me}=F,ke=(0,Ct._T)(F,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Ho(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=V,this.auth=J,this.stsTokenManager=me,this.accessToken=me.accessToken,this.displayName=ke.displayName||null,this.email=ke.email||null,this.emailVerified=ke.emailVerified||!1,this.phoneNumber=ke.phoneNumber||null,this.photoURL=ke.photoURL||null,this.isAnonymous=ke.isAnonymous||!1,this.tenantId=ke.tenantId||null,this.providerData=ke.providerData?[...ke.providerData]:[],this.metadata=new vs(ke.createdAt||void 0,ke.lastLoginAt||void 0)}getIdToken(F){var V=this;return(0,pe.Z)(function*(){const J=yield Wn(V,V.stsTokenManager.getToken(V.auth,F));return it(J,V.auth,"internal-error"),V.accessToken!==J&&(V.accessToken=J,yield V.auth._persistUserIfCurrent(V),V.auth._notifyListenersIfCurrent(V)),J})()}getIdTokenResult(F){return function es(Z){return Mo.apply(this,arguments)}(this,F)}reload(){return function mr(Z){return cs.apply(this,arguments)}(this)}_assign(F){this!==F&&(it(this.uid===F.uid,this.auth,"internal-error"),this.displayName=F.displayName,this.photoURL=F.photoURL,this.email=F.email,this.emailVerified=F.emailVerified,this.phoneNumber=F.phoneNumber,this.isAnonymous=F.isAnonymous,this.tenantId=F.tenantId,this.providerData=F.providerData.map(V=>Object.assign({},V)),this.metadata._copy(F.metadata),this.stsTokenManager._assign(F.stsTokenManager))}_clone(F){return new Di(Object.assign(Object.assign({},this),{auth:F,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(F){it(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=F,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(F){this.reloadListener?this.reloadListener(F):this.reloadUserInfo=F}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(F,V=!1){var J=this;return(0,pe.Z)(function*(){let me=!1;F.idToken&&F.idToken!==J.stsTokenManager.accessToken&&(J.stsTokenManager.updateFromServerResponse(F),me=!0),V&&(yield Jr(J)),yield J.auth._persistUserIfCurrent(J),me&&J.auth._notifyListenersIfCurrent(J)})()}delete(){var F=this;return(0,pe.Z)(function*(){const V=yield F.getIdToken();return yield Wn(F,function Xo(Z,F){return Gs.apply(this,arguments)}(F.auth,{idToken:V})),F.stsTokenManager.clearRefreshToken(),F.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(F=>Object.assign({},F)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(F,V){var J,me,ke,Mt,mn,ei,oi,dr;const rs=null!==(J=V.displayName)&&void 0!==J?J:void 0,Ia=null!==(me=V.email)&&void 0!==me?me:void 0,jc=null!==(ke=V.phoneNumber)&&void 0!==ke?ke:void 0,ep=null!==(Mt=V.photoURL)&&void 0!==Mt?Mt:void 0,_u=null!==(mn=V.tenantId)&&void 0!==mn?mn:void 0,la=null!==(ei=V._redirectEventId)&&void 0!==ei?ei:void 0,xs=null!==(oi=V.createdAt)&&void 0!==oi?oi:void 0,$g=null!==(dr=V.lastLoginAt)&&void 0!==dr?dr:void 0,{uid:tp,emailVerified:uy,isAnonymous:hy,providerData:Wg,stsTokenManager:Vp}=V;it(tp&&Vp,F,"internal-error");const Pf=zn.fromJSON(this.name,Vp);it("string"==typeof tp,F,"internal-error"),wi(rs,F.name),wi(Ia,F.name),it("boolean"==typeof uy,F,"internal-error"),it("boolean"==typeof hy,F,"internal-error"),wi(jc,F.name),wi(ep,F.name),wi(_u,F.name),wi(la,F.name),wi(xs,F.name),wi($g,F.name);const ol=new Di({uid:tp,auth:F,email:Ia,emailVerified:uy,displayName:rs,isAnonymous:hy,photoURL:ep,phoneNumber:jc,tenantId:_u,stsTokenManager:Pf,createdAt:xs,lastLoginAt:$g});return Wg&&Array.isArray(Wg)&&(ol.providerData=Wg.map(yu=>Object.assign({},yu))),la&&(ol._redirectEventId=la),ol}static _fromIdTokenResponse(F,V,J=!1){return(0,pe.Z)(function*(){const me=new zn;me.updateFromServerResponse(V);const ke=new Di({uid:V.localId,auth:F,stsTokenManager:me,isAnonymous:J});return yield Jr(ke),ke})()}}const Qe=(()=>{class Z{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,pe.Z)(function*(){return!0})()}_set(V,J){var me=this;return(0,pe.Z)(function*(){me.storage[V]=J})()}_get(V){var J=this;return(0,pe.Z)(function*(){const me=J.storage[V];return void 0===me?null:me})()}_remove(V){var J=this;return(0,pe.Z)(function*(){delete J.storage[V]})()}_addListener(V,J){}_removeListener(V,J){}}return Z.type="NONE",Z})();function je(Z,F,V){return`firebase:${Z}:${F}:${V}`}class at{constructor(F,V,J){this.persistence=F,this.auth=V,this.userKey=J;const{config:me,name:ke}=this.auth;this.fullUserKey=je(this.userKey,me.apiKey,ke),this.fullPersistenceKey=je("persistence",me.apiKey,ke),this.boundEventHandler=V._onStorageEvent.bind(V),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(F){return this.persistence._set(this.fullUserKey,F.toJSON())}getCurrentUser(){var F=this;return(0,pe.Z)(function*(){const V=yield F.persistence._get(F.fullUserKey);return V?Di._fromJSON(F.auth,V):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(F){var V=this;return(0,pe.Z)(function*(){if(V.persistence===F)return;const J=yield V.getCurrentUser();return yield V.removeCurrentUser(),V.persistence=F,J?V.setCurrentUser(J):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(F,V,J="authUser"){return(0,pe.Z)(function*(){if(!V.length)return new at(xt(Qe),F,J);const me=(yield Promise.all(V.map(function(){var oi=(0,pe.Z)(function*(dr){if(yield dr._isAvailable())return dr});return function(dr){return oi.apply(this,arguments)}}()))).filter(oi=>oi);let ke=me[0]||xt(Qe);const Mt=je(J,F.config.apiKey,F.name);let mn=null;for(const oi of V)try{const dr=yield oi._get(Mt);if(dr){const rs=Di._fromJSON(F,dr);oi!==ke&&(mn=rs),ke=oi;break}}catch{}const ei=me.filter(oi=>oi._shouldAllowMigration);return ke._shouldAllowMigration&&ei.length?(ke=ei[0],mn&&(yield ke._set(Mt,mn.toJSON())),yield Promise.all(V.map(function(){var oi=(0,pe.Z)(function*(dr){if(dr!==ke)try{yield dr._remove(Mt)}catch{}});return function(dr){return oi.apply(this,arguments)}}())),new at(ke,F,J)):new at(ke,F,J)})()}}function Ue(Z){const F=Z.toLowerCase();if(F.includes("opera/")||F.includes("opr/")||F.includes("opios/"))return"Opera";if(ae(F))return"IEMobile";if(F.includes("msie")||F.includes("trident/"))return"IE";if(F.includes("edge/"))return"Edge";if(Ce(F))return"Firefox";if(F.includes("silk/"))return"Silk";if(De(F))return"Blackberry";if(Ve(F))return"Webos";if(re(F))return"Safari";if((F.includes("chrome/")||ie(F))&&!F.includes("edge/"))return"Chrome";if(we(F))return"Android";{const J=Z.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===J?.length)return J[1]}return"Other"}function Ce(Z=(0,o.z$)()){return/firefox\//i.test(Z)}function re(Z=(0,o.z$)()){const F=Z.toLowerCase();return F.includes("safari/")&&!F.includes("chrome/")&&!F.includes("crios/")&&!F.includes("android")}function ie(Z=(0,o.z$)()){return/crios\//i.test(Z)}function ae(Z=(0,o.z$)()){return/iemobile/i.test(Z)}function we(Z=(0,o.z$)()){return/android/i.test(Z)}function De(Z=(0,o.z$)()){return/blackberry/i.test(Z)}function Ve(Z=(0,o.z$)()){return/webos/i.test(Z)}function Ke(Z=(0,o.z$)()){return/iphone|ipad|ipod/i.test(Z)||/macintosh/i.test(Z)&&/mobile/i.test(Z)}function ot(Z=(0,o.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(Z)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(Z)}function $t(Z=(0,o.z$)()){return Ke(Z)||we(Z)||Ve(Z)||De(Z)||/windows phone/i.test(Z)||ae(Z)}function cn(Z,F=[]){let V;switch(Z){case"Browser":V=Ue((0,o.z$)());break;case"Worker":V=`${Ue((0,o.z$)())}-${Z}`;break;default:V=Z}const J=F.length?F.join(","):"FirebaseCore-web";return`${V}/JsCore/${xe.SDK_VERSION}/${J}`}class ni{constructor(F){this.auth=F,this.queue=[]}pushCallback(F,V){const J=ke=>new Promise((Mt,mn)=>{try{Mt(F(ke))}catch(ei){mn(ei)}});J.onAbort=V,this.queue.push(J);const me=this.queue.length-1;return()=>{this.queue[me]=()=>Promise.resolve()}}runMiddleware(F){var V=this;return(0,pe.Z)(function*(){if(V.auth.currentUser===F)return;const J=[];try{for(const me of V.queue)yield me(F),me.onAbort&&J.push(me.onAbort)}catch(me){J.reverse();for(const ke of J)try{ke()}catch{}throw V.auth._errorFactory.create("login-blocked",{originalMessage:me?.message})}})()}}class Xn{constructor(F,V,J){this.app=F,this.heartbeatServiceProvider=V,this.config=J,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new di(this),this.idTokenSubscription=new di(this),this.beforeStateQueue=new ni(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ze,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=F.name,this.clientVersion=J.sdkClientVersion}_initializeWithPersistence(F,V){var J=this;return V&&(this._popupRedirectResolver=xt(V)),this._initializationPromise=this.queue((0,pe.Z)(function*(){var me,ke;if(!J._deleted&&(J.persistenceManager=yield at.create(J,F),!J._deleted)){if(null!==(me=J._popupRedirectResolver)&&void 0!==me&&me._shouldInitProactively)try{yield J._popupRedirectResolver._initialize(J)}catch{}yield J.initializeCurrentUser(V),J.lastNotifiedUid=(null===(ke=J.currentUser)||void 0===ke?void 0:ke.uid)||null,!J._deleted&&(J._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var F=this;return(0,pe.Z)(function*(){if(F._deleted)return;const V=yield F.assertedPersistence.getCurrentUser();if(F.currentUser||V){if(F.currentUser&&V&&F.currentUser.uid===V.uid)return F._currentUser._assign(V),void(yield F.currentUser.getIdToken());yield F._updateCurrentUser(V,!0)}})()}initializeCurrentUser(F){var V=this;return(0,pe.Z)(function*(){var J;const me=yield V.assertedPersistence.getCurrentUser();let ke=me,Mt=!1;if(F&&V.config.authDomain){yield V.getOrInitRedirectPersistenceManager();const mn=null===(J=V.redirectUser)||void 0===J?void 0:J._redirectEventId,ei=ke?._redirectEventId,oi=yield V.tryRedirectSignIn(F);(!mn||mn===ei)&&oi?.user&&(ke=oi.user,Mt=!0)}if(!ke)return V.directlySetCurrentUser(null);if(!ke._redirectEventId){if(Mt)try{yield V.beforeStateQueue.runMiddleware(ke)}catch(mn){ke=me,V._popupRedirectResolver._overrideRedirectResult(V,()=>Promise.reject(mn))}return ke?V.reloadAndSetCurrentUserOrClear(ke):V.directlySetCurrentUser(null)}return it(V._popupRedirectResolver,V,"argument-error"),yield V.getOrInitRedirectPersistenceManager(),V.redirectUser&&V.redirectUser._redirectEventId===ke._redirectEventId?V.directlySetCurrentUser(ke):V.reloadAndSetCurrentUserOrClear(ke)})()}tryRedirectSignIn(F){var V=this;return(0,pe.Z)(function*(){let J=null;try{J=yield V._popupRedirectResolver._completeRedirectFn(V,F,!0)}catch{yield V._setRedirectUser(null)}return J})()}reloadAndSetCurrentUserOrClear(F){var V=this;return(0,pe.Z)(function*(){try{yield Jr(F)}catch(J){if("auth/network-request-failed"!==J?.code)return V.directlySetCurrentUser(null)}return V.directlySetCurrentUser(F)})()}useDeviceLanguage(){this.languageCode=function Ni(){if(typeof navigator>"u")return null;const Z=navigator;return Z.languages&&Z.languages[0]||Z.language||null}()}_delete(){var F=this;return(0,pe.Z)(function*(){F._deleted=!0})()}updateCurrentUser(F){var V=this;return(0,pe.Z)(function*(){const J=F?(0,o.m9)(F):null;return J&&it(J.auth.config.apiKey===V.config.apiKey,V,"invalid-user-token"),V._updateCurrentUser(J&&J._clone(V))})()}_updateCurrentUser(F,V=!1){var J=this;return(0,pe.Z)(function*(){if(!J._deleted)return F&&it(J.tenantId===F.tenantId,J,"tenant-id-mismatch"),V||(yield J.beforeStateQueue.runMiddleware(F)),J.queue((0,pe.Z)(function*(){yield J.directlySetCurrentUser(F),J.notifyAuthListeners()}))})()}signOut(){var F=this;return(0,pe.Z)(function*(){return yield F.beforeStateQueue.runMiddleware(null),(F.redirectPersistenceManager||F._popupRedirectResolver)&&(yield F._setRedirectUser(null)),F._updateCurrentUser(null,!0)})()}setPersistence(F){var V=this;return this.queue((0,pe.Z)(function*(){yield V.assertedPersistence.setPersistence(xt(F))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(F){this._errorFactory=new o.LL("auth","Firebase",F())}onAuthStateChanged(F,V,J){return this.registerStateListener(this.authStateSubscription,F,V,J)}beforeAuthStateChanged(F,V){return this.beforeStateQueue.pushCallback(F,V)}onIdTokenChanged(F,V,J){return this.registerStateListener(this.idTokenSubscription,F,V,J)}toJSON(){var F;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(F=this._currentUser)||void 0===F?void 0:F.toJSON()}}_setRedirectUser(F,V){var J=this;return(0,pe.Z)(function*(){const me=yield J.getOrInitRedirectPersistenceManager(V);return null===F?me.removeCurrentUser():me.setCurrentUser(F)})()}getOrInitRedirectPersistenceManager(F){var V=this;return(0,pe.Z)(function*(){if(!V.redirectPersistenceManager){const J=F&&xt(F)||V._popupRedirectResolver;it(J,V,"argument-error"),V.redirectPersistenceManager=yield at.create(V,[xt(J._redirectPersistence)],"redirectUser"),V.redirectUser=yield V.redirectPersistenceManager.getCurrentUser()}return V.redirectPersistenceManager})()}_redirectUserForId(F){var V=this;return(0,pe.Z)(function*(){var J,me;return V._isInitialized&&(yield V.queue((0,pe.Z)(function*(){}))),(null===(J=V._currentUser)||void 0===J?void 0:J._redirectEventId)===F?V._currentUser:(null===(me=V.redirectUser)||void 0===me?void 0:me._redirectEventId)===F?V.redirectUser:null})()}_persistUserIfCurrent(F){var V=this;return(0,pe.Z)(function*(){if(F===V.currentUser)return V.queue((0,pe.Z)(function*(){return V.directlySetCurrentUser(F)}))})()}_notifyListenersIfCurrent(F){F===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var F,V;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const J=null!==(V=null===(F=this.currentUser)||void 0===F?void 0:F.uid)&&void 0!==V?V:null;this.lastNotifiedUid!==J&&(this.lastNotifiedUid=J,this.authStateSubscription.next(this.currentUser))}registerStateListener(F,V,J,me){if(this._deleted)return()=>{};const ke="function"==typeof V?V:V.next.bind(V),Mt=this._isInitialized?Promise.resolve():this._initializationPromise;return it(Mt,this,"internal-error"),Mt.then(()=>ke(this.currentUser)),"function"==typeof V?F.addObserver(V,J,me):F.addObserver(V)}directlySetCurrentUser(F){var V=this;return(0,pe.Z)(function*(){V.currentUser&&V.currentUser!==F&&V._currentUser._stopProactiveRefresh(),F&&V.isProactiveRefreshEnabled&&F._startProactiveRefresh(),V.currentUser=F,F?yield V.assertedPersistence.setCurrentUser(F):yield V.assertedPersistence.removeCurrentUser()})()}queue(F){return this.operations=this.operations.then(F,F),this.operations}get assertedPersistence(){return it(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(F){!F||this.frameworks.includes(F)||(this.frameworks.push(F),this.frameworks.sort(),this.clientVersion=cn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var F=this;return(0,pe.Z)(function*(){var V;const J={"X-Client-Version":F.clientVersion};F.app.options.appId&&(J["X-Firebase-gmpid"]=F.app.options.appId);const me=yield null===(V=F.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===V?void 0:V.getHeartbeatsHeader();return me&&(J["X-Firebase-Client"]=me),J})()}}function Nn(Z){return(0,o.m9)(Z)}class di{constructor(F){this.auth=F,this.observer=null,this.addObserver=(0,o.ne)(V=>this.observer=V)}get next(){return it(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Li(Z,F,V){const J=Nn(Z);it(J._canInitEmulator,J,"emulator-config-failed"),it(/^https?:\/\//.test(F),J,"invalid-emulator-scheme");const me=!!V?.disableWarnings,ke=ur(F),{host:Mt,port:mn}=function li(Z){const F=ur(Z),V=/(\/\/)?([^?#/]+)/.exec(Z.substr(F.length));if(!V)return{host:"",port:null};const J=V[2].split("@").pop()||"",me=/^(\[[^\]]+\])(:|$)/.exec(J);if(me){const ke=me[1];return{host:ke,port:vr(J.substr(ke.length+1))}}{const[ke,Mt]=J.split(":");return{host:ke,port:vr(Mt)}}}(F);J.config.emulator={url:`${ke}//${Mt}${null===mn?"":`:${mn}`}/`},J.settings.appVerificationDisabledForTesting=!0,J.emulatorConfig=Object.freeze({host:Mt,port:mn,protocol:ke.replace(":",""),options:Object.freeze({disableWarnings:me})}),me||function ci(){function Z(){const F=document.createElement("p"),V=F.style;F.innerText="Running in emulator mode. Do not use with production credentials.",V.position="fixed",V.width="100%",V.backgroundColor="#ffffff",V.border=".1em solid #000000",V.color="#b50000",V.bottom="0px",V.left="0px",V.margin="0px",V.zIndex="10000",V.textAlign="center",F.classList.add("firebase-emulator-warning"),document.body.appendChild(F)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",Z):Z())}()}function ur(Z){const F=Z.indexOf(":");return F<0?"":Z.substr(0,F+1)}function vr(Z){if(!Z)return null;const F=Number(Z);return isNaN(F)?null:F}class Mr{constructor(F,V){this.providerId=F,this.signInMethod=V}toJSON(){return zt("not implemented")}_getIdTokenResponse(F){return zt("not implemented")}_linkToIdToken(F,V){return zt("not implemented")}_getReauthenticationResolver(F){return zt("not implemented")}}function mo(Z,F){return Rt.apply(this,arguments)}function Rt(){return(Rt=(0,pe.Z)(function*(Z,F){return bi(Z,"POST","/v1/accounts:resetPassword",$i(Z,F))})).apply(this,arguments)}function Ko(Z,F){return Sr.apply(this,arguments)}function Sr(){return(Sr=(0,pe.Z)(function*(Z,F){return bi(Z,"POST","/v1/accounts:update",F)})).apply(this,arguments)}function Vn(Z,F){return Vi.apply(this,arguments)}function Vi(){return(Vi=(0,pe.Z)(function*(Z,F){return bi(Z,"POST","/v1/accounts:update",$i(Z,F))})).apply(this,arguments)}function ns(){return(ns=(0,pe.Z)(function*(Z,F){return fo(Z,"POST","/v1/accounts:signInWithPassword",$i(Z,F))})).apply(this,arguments)}function Ka(Z,F){return xo.apply(this,arguments)}function xo(){return(xo=(0,pe.Z)(function*(Z,F){return bi(Z,"POST","/v1/accounts:sendOobCode",$i(Z,F))})).apply(this,arguments)}function vn(Z,F){return Hn.apply(this,arguments)}function Hn(){return(Hn=(0,pe.Z)(function*(Z,F){return Ka(Z,F)})).apply(this,arguments)}function Ui(Z,F){return Ms.apply(this,arguments)}function Ms(){return(Ms=(0,pe.Z)(function*(Z,F){return Ka(Z,F)})).apply(this,arguments)}function Zn(Z,F){return Hi.apply(this,arguments)}function Hi(){return(Hi=(0,pe.Z)(function*(Z,F){return Ka(Z,F)})).apply(this,arguments)}function Hl(Z,F){return pl.apply(this,arguments)}function pl(){return(pl=(0,pe.Z)(function*(Z,F){return Ka(Z,F)})).apply(this,arguments)}function kr(){return(kr=(0,pe.Z)(function*(Z,F){return fo(Z,"POST","/v1/accounts:signInWithEmailLink",$i(Z,F))})).apply(this,arguments)}function Cc(){return(Cc=(0,pe.Z)(function*(Z,F){return fo(Z,"POST","/v1/accounts:signInWithEmailLink",$i(Z,F))})).apply(this,arguments)}class Zr extends Mr{constructor(F,V,J,me=null){super("password",J),this._email=F,this._password=V,this._tenantId=me}static _fromEmailAndPassword(F,V){return new Zr(F,V,"password")}static _fromEmailAndCode(F,V,J=null){return new Zr(F,V,"emailLink",J)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(F){const V="string"==typeof F?JSON.parse(F):F;if(V?.email&&V?.password){if("password"===V.signInMethod)return this._fromEmailAndPassword(V.email,V.password);if("emailLink"===V.signInMethod)return this._fromEmailAndCode(V.email,V.password,V.tenantId)}return null}_getIdTokenResponse(F){var V=this;return(0,pe.Z)(function*(){switch(V.signInMethod){case"password":return function Pi(Z,F){return ns.apply(this,arguments)}(F,{returnSecureToken:!0,email:V._email,password:V._password});case"emailLink":return function $s(Z,F){return kr.apply(this,arguments)}(F,{email:V._email,oobCode:V._password});default:Jt(F,"internal-error")}})()}_linkToIdToken(F,V){var J=this;return(0,pe.Z)(function*(){switch(J.signInMethod){case"password":return Ko(F,{idToken:V,returnSecureToken:!0,email:J._email,password:J._password});case"emailLink":return function xr(Z,F){return Cc.apply(this,arguments)}(F,{idToken:V,email:J._email,oobCode:J._password});default:Jt(F,"internal-error")}})()}_getReauthenticationResolver(F){return this._getIdTokenResponse(F)}}function ta(Z,F){return qr.apply(this,arguments)}function qr(){return(qr=(0,pe.Z)(function*(Z,F){return fo(Z,"POST","/v1/accounts:signInWithIdp",$i(Z,F))})).apply(this,arguments)}class Ya extends Mr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(F){const V=new Ya(F.providerId,F.signInMethod);return F.idToken||F.accessToken?(F.idToken&&(V.idToken=F.idToken),F.accessToken&&(V.accessToken=F.accessToken),F.nonce&&!F.pendingToken&&(V.nonce=F.nonce),F.pendingToken&&(V.pendingToken=F.pendingToken)):F.oauthToken&&F.oauthTokenSecret?(V.accessToken=F.oauthToken,V.secret=F.oauthTokenSecret):Jt("argument-error"),V}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(F){const V="string"==typeof F?JSON.parse(F):F,{providerId:J,signInMethod:me}=V,ke=(0,Ct._T)(V,["providerId","signInMethod"]);if(!J||!me)return null;const Mt=new Ya(J,me);return Mt.idToken=ke.idToken||void 0,Mt.accessToken=ke.accessToken||void 0,Mt.secret=ke.secret,Mt.nonce=ke.nonce,Mt.pendingToken=ke.pendingToken||null,Mt}_getIdTokenResponse(F){return ta(F,this.buildRequest())}_linkToIdToken(F,V){const J=this.buildRequest();return J.idToken=V,ta(F,J)}_getReauthenticationResolver(F){const V=this.buildRequest();return V.autoCreate=!1,ta(F,V)}buildRequest(){const F={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)F.pendingToken=this.pendingToken;else{const V={};this.idToken&&(V.id_token=this.idToken),this.accessToken&&(V.access_token=this.accessToken),this.secret&&(V.oauth_token_secret=this.secret),V.providerId=this.providerId,this.nonce&&!this.pendingToken&&(V.nonce=this.nonce),F.postBody=(0,o.xO)(V)}return F}}function ks(Z,F){return fl.apply(this,arguments)}function fl(){return(fl=(0,pe.Z)(function*(Z,F){return bi(Z,"POST","/v1/accounts:sendVerificationCode",$i(Z,F))})).apply(this,arguments)}function Ja(){return(Ja=(0,pe.Z)(function*(Z,F){return fo(Z,"POST","/v1/accounts:signInWithPhoneNumber",$i(Z,F))})).apply(this,arguments)}function Qi(){return(Qi=(0,pe.Z)(function*(Z,F){const V=yield fo(Z,"POST","/v1/accounts:signInWithPhoneNumber",$i(Z,F));if(V.temporaryProof)throw Rr(Z,"account-exists-with-different-credential",V);return V})).apply(this,arguments)}const jd={USER_NOT_FOUND:"user-not-found"};function uo(){return(uo=(0,pe.Z)(function*(Z,F){return fo(Z,"POST","/v1/accounts:signInWithPhoneNumber",$i(Z,Object.assign(Object.assign({},F),{operation:"REAUTH"})),jd)})).apply(this,arguments)}class ko extends Mr{constructor(F){super("phone","phone"),this.params=F}static _fromVerification(F,V){return new ko({verificationId:F,verificationCode:V})}static _fromTokenResponse(F,V){return new ko({phoneNumber:F,temporaryProof:V})}_getIdTokenResponse(F){return function jl(Z,F){return Ja.apply(this,arguments)}(F,this._makeVerificationRequest())}_linkToIdToken(F,V){return function go(Z,F){return Qi.apply(this,arguments)}(F,Object.assign({idToken:V},this._makeVerificationRequest()))}_getReauthenticationResolver(F){return function Rs(Z,F){return uo.apply(this,arguments)}(F,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:F,phoneNumber:V,verificationId:J,verificationCode:me}=this.params;return F&&V?{temporaryProof:F,phoneNumber:V}:{sessionInfo:J,code:me}}toJSON(){const F={providerId:this.providerId};return this.params.phoneNumber&&(F.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(F.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(F.verificationCode=this.params.verificationCode),this.params.verificationId&&(F.verificationId=this.params.verificationId),F}static fromJSON(F){"string"==typeof F&&(F=JSON.parse(F));const{verificationId:V,verificationCode:J,phoneNumber:me,temporaryProof:ke}=F;return J||V||me||ke?new ko({verificationId:V,verificationCode:J,phoneNumber:me,temporaryProof:ke}):null}}class fr{constructor(F){var V,J,me,ke,Mt,mn;const ei=(0,o.zd)((0,o.pd)(F)),oi=null!==(V=ei.apiKey)&&void 0!==V?V:null,dr=null!==(J=ei.oobCode)&&void 0!==J?J:null,rs=function Nu(Z){switch(Z){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(me=ei.mode)&&void 0!==me?me:null);it(oi&&dr&&rs,"argument-error"),this.apiKey=oi,this.operation=rs,this.code=dr,this.continueUrl=null!==(ke=ei.continueUrl)&&void 0!==ke?ke:null,this.languageCode=null!==(Mt=ei.languageCode)&&void 0!==Mt?Mt:null,this.tenantId=null!==(mn=ei.tenantId)&&void 0!==mn?mn:null}static parseLink(F){const V=function zu(Z){const F=(0,o.zd)((0,o.pd)(Z)).link,V=F?(0,o.zd)((0,o.pd)(F)).deep_link_id:null,J=(0,o.zd)((0,o.pd)(Z)).deep_link_id;return(J?(0,o.zd)((0,o.pd)(J)).link:null)||J||V||F||Z}(F);try{return new fr(V)}catch{return null}}}let Bu=(()=>{class Z{constructor(){this.providerId=Z.PROVIDER_ID}static credential(V,J){return Zr._fromEmailAndPassword(V,J)}static credentialWithLink(V,J){const me=fr.parseLink(J);return it(me,"argument-error"),Zr._fromEmailAndCode(V,me.code,me.tenantId)}}return Z.PROVIDER_ID="password",Z.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Z.EMAIL_LINK_SIGN_IN_METHOD="emailLink",Z})();class Ca{constructor(F){this.providerId=F,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(F){this.defaultLanguageCode=F}setCustomParameters(F){return this.customParameters=F,this}getCustomParameters(){return this.customParameters}}class jo extends Ca{constructor(){super(...arguments),this.scopes=[]}addScope(F){return this.scopes.includes(F)||this.scopes.push(F),this}getScopes(){return[...this.scopes]}}class Ec extends jo{static credentialFromJSON(F){const V="string"==typeof F?JSON.parse(F):F;return it("providerId"in V&&"signInMethod"in V,"argument-error"),Ya._fromParams(V)}credential(F){return this._credential(Object.assign(Object.assign({},F),{nonce:F.rawNonce}))}_credential(F){return it(F.idToken||F.accessToken,"argument-error"),Ya._fromParams(Object.assign(Object.assign({},F),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(F){return Ec.oauthCredentialFromTaggedObject(F)}static credentialFromError(F){return Ec.oauthCredentialFromTaggedObject(F.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:F}){if(!F)return null;const{oauthIdToken:V,oauthAccessToken:J,oauthTokenSecret:me,pendingToken:ke,nonce:Mt,providerId:mn}=F;if(!J&&!me&&!V&&!ke||!mn)return null;try{return new Ec(mn)._credential({idToken:V,accessToken:J,nonce:Mt,pendingToken:ke})}catch{return null}}}let ph=(()=>{class Z extends jo{constructor(){super("facebook.com")}static credential(V){return Ya._fromParams({providerId:Z.PROVIDER_ID,signInMethod:Z.FACEBOOK_SIGN_IN_METHOD,accessToken:V})}static credentialFromResult(V){return Z.credentialFromTaggedObject(V)}static credentialFromError(V){return Z.credentialFromTaggedObject(V.customData||{})}static credentialFromTaggedObject({_tokenResponse:V}){if(!V||!("oauthAccessToken"in V)||!V.oauthAccessToken)return null;try{return Z.credential(V.oauthAccessToken)}catch{return null}}}return Z.FACEBOOK_SIGN_IN_METHOD="facebook.com",Z.PROVIDER_ID="facebook.com",Z})(),Gl=(()=>{class Z extends jo{constructor(){super("google.com"),this.addScope("profile")}static credential(V,J){return Ya._fromParams({providerId:Z.PROVIDER_ID,signInMethod:Z.GOOGLE_SIGN_IN_METHOD,idToken:V,accessToken:J})}static credentialFromResult(V){return Z.credentialFromTaggedObject(V)}static credentialFromError(V){return Z.credentialFromTaggedObject(V.customData||{})}static credentialFromTaggedObject({_tokenResponse:V}){if(!V)return null;const{oauthIdToken:J,oauthAccessToken:me}=V;if(!J&&!me)return null;try{return Z.credential(J,me)}catch{return null}}}return Z.GOOGLE_SIGN_IN_METHOD="google.com",Z.PROVIDER_ID="google.com",Z})(),fh=(()=>{class Z extends jo{constructor(){super("github.com")}static credential(V){return Ya._fromParams({providerId:Z.PROVIDER_ID,signInMethod:Z.GITHUB_SIGN_IN_METHOD,accessToken:V})}static credentialFromResult(V){return Z.credentialFromTaggedObject(V)}static credentialFromError(V){return Z.credentialFromTaggedObject(V.customData||{})}static credentialFromTaggedObject({_tokenResponse:V}){if(!V||!("oauthAccessToken"in V)||!V.oauthAccessToken)return null;try{return Z.credential(V.oauthAccessToken)}catch{return null}}}return Z.GITHUB_SIGN_IN_METHOD="github.com",Z.PROVIDER_ID="github.com",Z})();class mh extends Mr{constructor(F,V){super(F,F),this.pendingToken=V}_getIdTokenResponse(F){return ta(F,this.buildRequest())}_linkToIdToken(F,V){const J=this.buildRequest();return J.idToken=V,ta(F,J)}_getReauthenticationResolver(F){const V=this.buildRequest();return V.autoCreate=!1,ta(F,V)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(F){const V="string"==typeof F?JSON.parse(F):F,{providerId:J,signInMethod:me,pendingToken:ke}=V;return J&&me&&ke&&J===me?new mh(J,ke):null}static _create(F,V){return new mh(F,V)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class na extends Ca{constructor(F){it(F.startsWith("saml."),"argument-error"),super(F)}static credentialFromResult(F){return na.samlCredentialFromTaggedObject(F)}static credentialFromError(F){return na.samlCredentialFromTaggedObject(F.customData||{})}static credentialFromJSON(F){const V=mh.fromJSON(F);return it(V,"argument-error"),V}static samlCredentialFromTaggedObject({_tokenResponse:F}){if(!F)return null;const{pendingToken:V,providerId:J}=F;if(!V||!J)return null;try{return mh._create(J,V)}catch{return null}}}let Qa=(()=>{class Z extends jo{constructor(){super("twitter.com")}static credential(V,J){return Ya._fromParams({providerId:Z.PROVIDER_ID,signInMethod:Z.TWITTER_SIGN_IN_METHOD,oauthToken:V,oauthTokenSecret:J})}static credentialFromResult(V){return Z.credentialFromTaggedObject(V)}static credentialFromError(V){return Z.credentialFromTaggedObject(V.customData||{})}static credentialFromTaggedObject({_tokenResponse:V}){if(!V)return null;const{oauthAccessToken:J,oauthTokenSecret:me}=V;if(!J||!me)return null;try{return Z.credential(J,me)}catch{return null}}}return Z.TWITTER_SIGN_IN_METHOD="twitter.com",Z.PROVIDER_ID="twitter.com",Z})();function ed(Z,F){return Tc.apply(this,arguments)}function Tc(){return(Tc=(0,pe.Z)(function*(Z,F){return fo(Z,"POST","/v1/accounts:signUp",$i(Z,F))})).apply(this,arguments)}class tr{constructor(F){this.user=F.user,this.providerId=F.providerId,this._tokenResponse=F._tokenResponse,this.operationType=F.operationType}static _fromIdTokenResponse(F,V,J,me=!1){return(0,pe.Z)(function*(){const ke=yield Di._fromIdTokenResponse(F,J,me),Mt=Sc(J);return new tr({user:ke,providerId:Mt,_tokenResponse:J,operationType:V})})()}static _forOperation(F,V,J){return(0,pe.Z)(function*(){yield F._updateTokensIfNecessary(J,!0);const me=Sc(J);return new tr({user:F,providerId:me,_tokenResponse:J,operationType:V})})()}}function Sc(Z){return Z.providerId?Z.providerId:"phoneNumber"in Z?"phone":null}function $l(Z){return ia.apply(this,arguments)}function ia(){return(ia=(0,pe.Z)(function*(Z){var F;const V=Nn(Z);if(yield V._initializationPromise,null!==(F=V.currentUser)&&void 0!==F&&F.isAnonymous)return new tr({user:V.currentUser,providerId:null,operationType:"signIn"});const J=yield ed(V,{returnSecureToken:!0}),me=yield tr._fromIdTokenResponse(V,"signIn",J,!0);return yield V._updateCurrentUser(me.user),me})).apply(this,arguments)}class tu extends o.ZR{constructor(F,V,J,me){var ke;super(V.code,V.message),this.operationType=J,this.user=me,Object.setPrototypeOf(this,tu.prototype),this.customData={appName:F.name,tenantId:null!==(ke=F.tenantId)&&void 0!==ke?ke:void 0,_serverResponse:V.customData._serverResponse,operationType:J}}static _fromErrorAndOperation(F,V,J,me){return new tu(F,V,J,me)}}function wf(Z,F,V,J){return("reauthenticate"===F?V._getReauthenticationResolver(Z):V._getIdTokenResponse(Z)).catch(ke=>{throw"auth/multi-factor-auth-required"===ke.code?tu._fromErrorAndOperation(Z,ke,F,J):ke})}function ml(Z){return new Set(Z.map(({providerId:F})=>F).filter(F=>!!F))}function Wl(Z,F){return nu.apply(this,arguments)}function nu(){return(nu=(0,pe.Z)(function*(Z,F){const V=(0,o.m9)(Z);yield Xa(!0,V,F);const{providerUserInfo:J}=yield Ao(V.auth,{idToken:yield V.getIdToken(),deleteProvider:[F]}),me=ml(J||[]);return V.providerData=V.providerData.filter(ke=>me.has(ke.providerId)),me.has("phone")||(V.phoneNumber=null),yield V.auth._persistUserIfCurrent(V),V})).apply(this,arguments)}function iu(Z,F){return Vu.apply(this,arguments)}function Vu(){return(Vu=(0,pe.Z)(function*(Z,F,V=!1){const J=yield Wn(Z,F._linkToIdToken(Z.auth,yield Z.getIdToken()),V);return tr._forOperation(Z,"link",J)})).apply(this,arguments)}function Xa(Z,F,V){return Ic.apply(this,arguments)}function Ic(){return(Ic=(0,pe.Z)(function*(Z,F,V){yield Jr(F);const me=!1===Z?"provider-already-linked":"no-such-provider";it(ml(F.providerData).has(V)===Z,F.auth,me)})).apply(this,arguments)}function Dc(Z,F){return gh.apply(this,arguments)}function gh(){return(gh=(0,pe.Z)(function*(Z,F,V=!1){const{auth:J}=Z,me="reauthenticate";try{const ke=yield Wn(Z,wf(J,me,F,Z),V);it(ke.idToken,J,"internal-error");const Mt=yr(ke.idToken);it(Mt,J,"internal-error");const{sub:mn}=Mt;return it(Z.uid===mn,J,"user-mismatch"),tr._forOperation(Z,me,ke)}catch(ke){throw"auth/user-not-found"===ke?.code&&Jt(J,"user-mismatch"),ke}})).apply(this,arguments)}function Zl(Z,F){return gl.apply(this,arguments)}function gl(){return(gl=(0,pe.Z)(function*(Z,F,V=!1){const J="signIn",me=yield wf(Z,J,F),ke=yield tr._fromIdTokenResponse(Z,J,me);return V||(yield Z._updateCurrentUser(ke.user)),ke})).apply(this,arguments)}function Mi(Z,F){return Ro.apply(this,arguments)}function Ro(){return(Ro=(0,pe.Z)(function*(Z,F){return Zl(Nn(Z),F)})).apply(this,arguments)}function _h(Z,F){return _o.apply(this,arguments)}function _o(){return(_o=(0,pe.Z)(function*(Z,F){const V=(0,o.m9)(Z);return yield Xa(!1,V,F.providerId),iu(V,F)})).apply(this,arguments)}function Uu(Z,F){return Pa.apply(this,arguments)}function Pa(){return(Pa=(0,pe.Z)(function*(Z,F){return Dc((0,o.m9)(Z),F)})).apply(this,arguments)}function Ps(Z,F){return _l.apply(this,arguments)}function _l(){return(_l=(0,pe.Z)(function*(Z,F){return fo(Z,"POST","/v1/accounts:signInWithCustomToken",$i(Z,F))})).apply(this,arguments)}function ru(Z,F){return Oa.apply(this,arguments)}function Oa(){return(Oa=(0,pe.Z)(function*(Z,F){const V=Nn(Z),J=yield Ps(V,{token:F,returnSecureToken:!0}),me=yield tr._fromIdTokenResponse(V,"signIn",J);return yield V._updateCurrentUser(me.user),me})).apply(this,arguments)}class Co{constructor(F,V){this.factorId=F,this.uid=V.mfaEnrollmentId,this.enrollmentTime=new Date(V.enrolledAt).toUTCString(),this.displayName=V.displayName}static _fromServerResponse(F,V){return"phoneInfo"in V?yl._fromServerResponse(F,V):Jt(F,"internal-error")}}class yl extends Co{constructor(F){super("phone",F),this.phoneNumber=F.phoneInfo}static _fromServerResponse(F,V){return new yl(V)}}function vl(Z,F,V){var J;it((null===(J=V.url)||void 0===J?void 0:J.length)>0,Z,"invalid-continue-uri"),it(typeof V.dynamicLinkDomain>"u"||V.dynamicLinkDomain.length>0,Z,"invalid-dynamic-link-domain"),F.continueUrl=V.url,F.dynamicLinkDomain=V.dynamicLinkDomain,F.canHandleCodeInApp=V.handleCodeInApp,V.iOS&&(it(V.iOS.bundleId.length>0,Z,"missing-ios-bundle-id"),F.iOSBundleId=V.iOS.bundleId),V.android&&(it(V.android.packageName.length>0,Z,"missing-android-pkg-name"),F.androidInstallApp=V.android.installApp,F.androidMinimumVersionCode=V.android.minimumVersion,F.androidPackageName=V.android.packageName)}function $d(Z,F,V){return Oi.apply(this,arguments)}function Oi(){return(Oi=(0,pe.Z)(function*(Z,F,V){const J=(0,o.m9)(Z),me={requestType:"PASSWORD_RESET",email:F};V&&vl(J,me,V),yield Ui(J,me)})).apply(this,arguments)}function Hu(Z,F,V){return Ac.apply(this,arguments)}function Ac(){return(Ac=(0,pe.Z)(function*(Z,F,V){yield mo((0,o.m9)(Z),{oobCode:F,newPassword:V})})).apply(this,arguments)}function Wi(Z,F){return Mc.apply(this,arguments)}function Mc(){return(Mc=(0,pe.Z)(function*(Z,F){yield Vn((0,o.m9)(Z),{oobCode:F})})).apply(this,arguments)}function td(Z,F){return ju.apply(this,arguments)}function ju(){return(ju=(0,pe.Z)(function*(Z,F){const V=(0,o.m9)(Z),J=yield mo(V,{oobCode:F}),me=J.requestType;switch(it(me,V,"internal-error"),me){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":it(J.newEmail,V,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":it(J.mfaInfo,V,"internal-error");default:it(J.email,V,"internal-error")}let ke=null;return J.mfaInfo&&(ke=Co._fromServerResponse(Nn(V),J.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===J.requestType?J.newEmail:J.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===J.requestType?J.email:J.newEmail)||null,multiFactorInfo:ke},operation:me}})).apply(this,arguments)}function Rp(Z,F){return yh.apply(this,arguments)}function yh(){return(yh=(0,pe.Z)(function*(Z,F){const{data:V}=yield td((0,o.m9)(Z),F);return V.email})).apply(this,arguments)}function vh(Z,F,V){return Gu.apply(this,arguments)}function Gu(){return(Gu=(0,pe.Z)(function*(Z,F,V){const J=Nn(Z),me=yield ed(J,{returnSecureToken:!0,email:F,password:V}),ke=yield tr._fromIdTokenResponse(J,"signIn",me);return yield J._updateCurrentUser(ke.user),ke})).apply(this,arguments)}function Wd(Z,F,V){return Mi((0,o.m9)(Z),Bu.credential(F,V))}function dn(Z,F,V){return xi.apply(this,arguments)}function xi(){return(xi=(0,pe.Z)(function*(Z,F,V){const J=(0,o.m9)(Z),me={requestType:"EMAIL_SIGNIN",email:F};it(V.handleCodeInApp,J,"argument-error"),V&&vl(J,me,V),yield Zn(J,me)})).apply(this,arguments)}function Pp(Z,F){return"EMAIL_SIGNIN"===fr.parseLink(F)?.operation}function Op(Z,F,V){return Go.apply(this,arguments)}function Go(){return(Go=(0,pe.Z)(function*(Z,F,V){const J=(0,o.m9)(Z),me=Bu.credentialWithLink(F,V||Vt());return it(me._tenantId===(J.tenantId||null),J,"tenant-id-mismatch"),Mi(J,me)})).apply(this,arguments)}function ou(Z,F){return su.apply(this,arguments)}function su(){return(su=(0,pe.Z)(function*(Z,F){return bi(Z,"POST","/v1/accounts:createAuthUri",$i(Z,F))})).apply(this,arguments)}function ga(Z,F){return ql.apply(this,arguments)}function ql(){return(ql=(0,pe.Z)(function*(Z,F){const J={identifier:F,continueUri:wn()?Vt():"http://localhost"},{signinMethods:me}=yield ou((0,o.m9)(Z),J);return me||[]})).apply(this,arguments)}function el(Z,F){return $u.apply(this,arguments)}function $u(){return($u=(0,pe.Z)(function*(Z,F){const V=(0,o.m9)(Z),me={requestType:"VERIFY_EMAIL",idToken:yield Z.getIdToken()};F&&vl(V.auth,me,F);const{email:ke}=yield vn(V.auth,me);ke!==Z.email&&(yield Z.reload())})).apply(this,arguments)}function vm(Z,F,V){return bl.apply(this,arguments)}function bl(){return(bl=(0,pe.Z)(function*(Z,F,V){const J=(0,o.m9)(Z),ke={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield Z.getIdToken(),newEmail:F};V&&vl(J.auth,ke,V);const{email:Mt}=yield Hl(J.auth,ke);Mt!==Z.email&&(yield Z.reload())})).apply(this,arguments)}function bs(Z,F){return Ws.apply(this,arguments)}function Ws(){return(Ws=(0,pe.Z)(function*(Z,F){return bi(Z,"POST","/v1/accounts:update",F)})).apply(this,arguments)}function nd(Z,F){return Zs.apply(this,arguments)}function Zs(){return(Zs=(0,pe.Z)(function*(Z,{displayName:F,photoURL:V}){if(void 0===F&&void 0===V)return;const J=(0,o.m9)(Z),ke={idToken:yield J.getIdToken(),displayName:F,photoUrl:V,returnSecureToken:!0},Mt=yield Wn(J,bs(J.auth,ke));J.displayName=Mt.displayName||null,J.photoURL=Mt.photoUrl||null;const mn=J.providerData.find(({providerId:ei})=>"password"===ei);mn&&(mn.displayName=J.displayName,mn.photoURL=J.photoURL),yield J._updateTokensIfNecessary(Mt)})).apply(this,arguments)}function Kl(Z,F){return au((0,o.m9)(Z),F,null)}function id(Z,F){return au((0,o.m9)(Z),null,F)}function au(Z,F,V){return lu.apply(this,arguments)}function lu(){return(lu=(0,pe.Z)(function*(Z,F,V){const{auth:J}=Z,ke={idToken:yield Z.getIdToken(),returnSecureToken:!0};F&&(ke.email=F),V&&(ke.password=V);const Mt=yield Wn(Z,Ko(J,ke));yield Z._updateTokensIfNecessary(Mt,!0)})).apply(this,arguments)}class Yl{constructor(F,V,J={}){this.isNewUser=F,this.providerId=V,this.profile=J}}class rd extends Yl{constructor(F,V,J,me){super(F,V,J),this.username=me}}class Jl extends Yl{constructor(F,V){super(F,"facebook.com",V)}}class od extends rd{constructor(F,V){super(F,"github.com",V,"string"==typeof V?.login?V?.login:null)}}class sd extends Yl{constructor(F,V){super(F,"google.com",V)}}class Lp extends rd{constructor(F,V,J){super(F,"twitter.com",V,J)}}function Ql(Z){const{user:F,_tokenResponse:V}=Z;return F.isAnonymous&&!V?{providerId:null,isNewUser:!1,profile:null}:function xf(Z){var F,V;if(!Z)return null;const{providerId:J}=Z,me=Z.rawUserInfo?JSON.parse(Z.rawUserInfo):{},ke=Z.isNewUser||"identitytoolkit#SignupNewUserResponse"===Z.kind;if(!J&&Z?.idToken){const Mt=null===(V=null===(F=yr(Z.idToken))||void 0===F?void 0:F.firebase)||void 0===V?void 0:V.sign_in_provider;if(Mt)return new Yl(ke,"anonymous"!==Mt&&"custom"!==Mt?Mt:null)}if(!J)return null;switch(J){case"facebook.com":return new Jl(ke,me);case"github.com":return new od(ke,me);case"google.com":return new sd(ke,me);case"twitter.com":return new Lp(ke,me,Z.screenName||null);case"custom":case"anonymous":return new Yl(ke,null);default:return new Yl(ke,J,me)}}(V)}class Or{constructor(F,V,J){this.type=F,this.credential=V,this.auth=J}static _fromIdtoken(F,V){return new Or("enroll",F,V)}static _fromMfaPendingCredential(F){return new Or("signin",F)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(F){var V,J;if(F?.multiFactorSession){if(null!==(V=F.multiFactorSession)&&void 0!==V&&V.pendingCredential)return Or._fromMfaPendingCredential(F.multiFactorSession.pendingCredential);if(null!==(J=F.multiFactorSession)&&void 0!==J&&J.idToken)return Or._fromIdtoken(F.multiFactorSession.idToken)}return null}}class ad{constructor(F,V,J){this.session=F,this.hints=V,this.signInResolver=J}static _fromError(F,V){const J=Nn(F),me=V.customData._serverResponse,ke=(me.mfaInfo||[]).map(mn=>Co._fromServerResponse(J,mn));it(me.mfaPendingCredential,J,"internal-error");const Mt=Or._fromMfaPendingCredential(me.mfaPendingCredential);return new ad(Mt,ke,function(){var mn=(0,pe.Z)(function*(ei){const oi=yield ei._process(J,Mt);delete me.mfaInfo,delete me.mfaPendingCredential;const dr=Object.assign(Object.assign({},me),{idToken:oi.idToken,refreshToken:oi.refreshToken});switch(V.operationType){case"signIn":const rs=yield tr._fromIdTokenResponse(J,V.operationType,dr);return yield J._updateCurrentUser(rs.user),rs;case"reauthenticate":return it(V.user,J,"internal-error"),tr._forOperation(V.user,V.operationType,dr);default:Jt(J,"internal-error")}});return function(ei){return mn.apply(this,arguments)}}())}resolveSignIn(F){var V=this;return(0,pe.Z)(function*(){return V.signInResolver(F)})()}}function qd(Z,F){var V;const J=(0,o.m9)(Z),me=F;return it(F.customData.operationType,J,"argument-error"),it(null===(V=me.customData._serverResponse)||void 0===V?void 0:V.mfaPendingCredential,J,"argument-error"),ad._fromError(J,me)}function Po(Z,F){return bi(Z,"POST","/v2/accounts/mfaEnrollment:start",$i(Z,F))}class cu{constructor(F){this.user=F,this.enrolledFactors=[],F._onReload(V=>{V.mfaInfo&&(this.enrolledFactors=V.mfaInfo.map(J=>Co._fromServerResponse(F.auth,J)))})}static _fromUser(F){return new cu(F)}getSession(){var F=this;return(0,pe.Z)(function*(){return Or._fromIdtoken(yield F.user.getIdToken(),F.user.auth)})()}enroll(F,V){var J=this;return(0,pe.Z)(function*(){const me=F,ke=yield J.getSession(),Mt=yield Wn(J.user,me._process(J.user.auth,ke,V));return yield J.user._updateTokensIfNecessary(Mt),J.user.reload()})()}unenroll(F){var V=this;return(0,pe.Z)(function*(){const J="string"==typeof F?F:F.uid,me=yield V.user.getIdToken();try{const ke=yield Wn(V.user,function ld(Z,F){return bi(Z,"POST","/v2/accounts/mfaEnrollment:withdraw",$i(Z,F))}(V.user.auth,{idToken:me,mfaEnrollmentId:J}));V.enrolledFactors=V.enrolledFactors.filter(({uid:Mt})=>Mt!==J),yield V.user._updateTokensIfNecessary(ke),yield V.user.reload()}catch(ke){throw ke}})()}}const xl=new WeakMap;function Ea(Z){const F=(0,o.m9)(Z);return xl.has(F)||xl.set(F,cu._fromUser(F)),xl.get(F)}const Cl="__sak";class ji{constructor(F,V){this.storageRetriever=F,this.type=V}_isAvailable(){try{return this.storage?(this.storage.setItem(Cl,"1"),this.storage.removeItem(Cl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(F,V){return this.storage.setItem(F,JSON.stringify(V)),Promise.resolve()}_get(F){const V=this.storage.getItem(F);return Promise.resolve(V?JSON.parse(V):null)}_remove(F){return this.storage.removeItem(F),Promise.resolve()}get storage(){return this.storageRetriever()}}const Os=(()=>{class Z extends ji{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(V,J)=>this.onStorageEvent(V,J),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Xl(){const Z=(0,o.z$)();return re(Z)||Ke(Z)}()&&function Dn(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=$t(),this._shouldAllowMigration=!0}forAllChangedKeys(V){for(const J of Object.keys(this.listeners)){const me=this.storage.getItem(J),ke=this.localCache[J];me!==ke&&V(J,ke,me)}}onStorageEvent(V,J=!1){if(!V.key)return void this.forAllChangedKeys((mn,ei,oi)=>{this.notifyListeners(mn,oi)});const me=V.key;if(J?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const mn=this.storage.getItem(me);if(V.newValue!==mn)null!==V.newValue?this.storage.setItem(me,V.newValue):this.storage.removeItem(me);else if(this.localCache[me]===V.newValue&&!J)return}const ke=()=>{const mn=this.storage.getItem(me);!J&&this.localCache[me]===mn||this.notifyListeners(me,mn)},Mt=this.storage.getItem(me);!function rt(){return(0,o.w1)()&&10===document.documentMode}()||Mt===V.newValue||V.newValue===V.oldValue?ke():setTimeout(ke,10)}notifyListeners(V,J){this.localCache[V]=J;const me=this.listeners[V];if(me)for(const ke of Array.from(me))ke(J&&JSON.parse(J))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((V,J,me)=>{this.onStorageEvent(new StorageEvent("storage",{key:V,oldValue:J,newValue:me}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(V,J){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[V]||(this.listeners[V]=new Set,this.localCache[V]=this.storage.getItem(V)),this.listeners[V].add(J)}_removeListener(V,J){this.listeners[V]&&(this.listeners[V].delete(J),0===this.listeners[V].size&&delete this.listeners[V]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(V,J){var me=()=>super._set,ke=this;return(0,pe.Z)(function*(){yield me().call(ke,V,J),ke.localCache[V]=JSON.stringify(J)})()}_get(V){var J=()=>super._get,me=this;return(0,pe.Z)(function*(){const ke=yield J().call(me,V);return me.localCache[V]=JSON.stringify(ke),ke})()}_remove(V){var J=()=>super._remove,me=this;return(0,pe.Z)(function*(){yield J().call(me,V),delete me.localCache[V]})()}}return Z.type="LOCAL",Z})(),Rc=(()=>{class Z extends ji{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(V,J){}_removeListener(V,J){}}return Z.type="SESSION",Z})();let wh=(()=>{class Z{constructor(V){this.eventTarget=V,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(V){const J=this.receivers.find(ke=>ke.isListeningto(V));if(J)return J;const me=new Z(V);return this.receivers.push(me),me}isListeningto(V){return this.eventTarget===V}handleEvent(V){var J=this;return(0,pe.Z)(function*(){const me=V,{eventId:ke,eventType:Mt,data:mn}=me.data,ei=J.handlersMap[Mt];if(!ei?.size)return;me.ports[0].postMessage({status:"ack",eventId:ke,eventType:Mt});const oi=Array.from(ei).map(function(){var rs=(0,pe.Z)(function*(Ia){return Ia(me.origin,mn)});return function(Ia){return rs.apply(this,arguments)}}()),dr=yield function Sf(Z){return Promise.all(Z.map(function(){var F=(0,pe.Z)(function*(V){try{return{fulfilled:!0,value:yield V}}catch(J){return{fulfilled:!1,reason:J}}});return function(V){return F.apply(this,arguments)}}()))}(oi);me.ports[0].postMessage({status:"done",eventId:ke,eventType:Mt,response:dr})})()}_subscribe(V,J){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[V]||(this.handlersMap[V]=new Set),this.handlersMap[V].add(J)}_unsubscribe(V,J){this.handlersMap[V]&&J&&this.handlersMap[V].delete(J),(!J||0===this.handlersMap[V].size)&&delete this.handlersMap[V],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return Z.receivers=[],Z})();function Ta(Z="",F=10){let V="";for(let J=0;J<F;J++)V+=Math.floor(10*Math.random());return Z+V}class Pc{constructor(F){this.target=F,this.handlers=new Set}removeMessageHandler(F){F.messageChannel&&(F.messageChannel.port1.removeEventListener("message",F.onMessage),F.messageChannel.port1.close()),this.handlers.delete(F)}_send(F,V,J=50){var me=this;return(0,pe.Z)(function*(){const ke=typeof MessageChannel<"u"?new MessageChannel:null;if(!ke)throw new Error("connection_unavailable");let Mt,mn;return new Promise((ei,oi)=>{const dr=Ta("",20);ke.port1.start();const rs=setTimeout(()=>{oi(new Error("unsupported_event"))},J);mn={messageChannel:ke,onMessage(Ia){const jc=Ia;if(jc.data.eventId===dr)switch(jc.data.status){case"ack":clearTimeout(rs),Mt=setTimeout(()=>{oi(new Error("timeout"))},3e3);break;case"done":clearTimeout(Mt),ei(jc.data.response);break;default:clearTimeout(rs),clearTimeout(Mt),oi(new Error("invalid_response"))}}},me.handlers.add(mn),ke.port1.addEventListener("message",mn.onMessage),me.target.postMessage({eventType:F,eventId:dr,data:V},[ke.port2])}).finally(()=>{mn&&me.removeMessageHandler(mn)})})()}}function Eo(){return window}function qs(){return typeof Eo().WorkerGlobalScope<"u"&&"function"==typeof Eo().importScripts}function oa(){return(oa=(0,pe.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const uu="firebaseLocalStorageDb",nl="firebaseLocalStorage",il="fbase_key";class ec{constructor(F){this.request=F}toPromise(){return new Promise((F,V)=>{this.request.addEventListener("success",()=>{F(this.request.result)}),this.request.addEventListener("error",()=>{V(this.request.error)})})}}function Tl(Z,F){return Z.transaction([nl],F?"readwrite":"readonly").objectStore(nl)}function La(){const Z=indexedDB.open(uu,1);return new Promise((F,V)=>{Z.addEventListener("error",()=>{V(Z.error)}),Z.addEventListener("upgradeneeded",()=>{const J=Z.result;try{J.createObjectStore(nl,{keyPath:il})}catch(me){V(me)}}),Z.addEventListener("success",(0,pe.Z)(function*(){const J=Z.result;J.objectStoreNames.contains(nl)?F(J):(J.close(),yield function Ch(){const Z=indexedDB.deleteDatabase(uu);return new ec(Z).toPromise()}(),F(yield La()))}))})}function Lc(Z,F,V){return ws.apply(this,arguments)}function ws(){return(ws=(0,pe.Z)(function*(Z,F,V){const J=Tl(Z,!0).put({[il]:F,value:V});return new ec(J).toPromise()})).apply(this,arguments)}function Fa(){return(Fa=(0,pe.Z)(function*(Z,F){const V=Tl(Z,!1).get(F),J=yield new ec(V).toPromise();return void 0===J?null:J.value})).apply(this,arguments)}function Zu(Z,F){const V=Tl(Z,!0).delete(F);return new ec(V).toPromise()}const du=(()=>{class Z{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var V=this;return(0,pe.Z)(function*(){return V.db||(V.db=yield La()),V.db})()}_withRetries(V){var J=this;return(0,pe.Z)(function*(){let me=0;for(;;)try{const ke=yield J._openDb();return yield V(ke)}catch(ke){if(me++>3)throw ke;J.db&&(J.db.close(),J.db=void 0)}})()}initializeServiceWorkerMessaging(){var V=this;return(0,pe.Z)(function*(){return qs()?V.initializeReceiver():V.initializeSender()})()}initializeReceiver(){var V=this;return(0,pe.Z)(function*(){V.receiver=wh._getInstance(function _a(){return qs()?self:null}()),V.receiver._subscribe("keyChanged",function(){var J=(0,pe.Z)(function*(me,ke){return{keyProcessed:(yield V._poll()).includes(ke.key)}});return function(me,ke){return J.apply(this,arguments)}}()),V.receiver._subscribe("ping",function(){var J=(0,pe.Z)(function*(me,ke){return["keyChanged"]});return function(me,ke){return J.apply(this,arguments)}}())})()}initializeSender(){var V=this;return(0,pe.Z)(function*(){var J,me;if(V.activeServiceWorker=yield function Oc(){return oa.apply(this,arguments)}(),!V.activeServiceWorker)return;V.sender=new Pc(V.activeServiceWorker);const ke=yield V.sender._send("ping",{},800);ke&&null!==(J=ke[0])&&void 0!==J&&J.fulfilled&&null!==(me=ke[0])&&void 0!==me&&me.value.includes("keyChanged")&&(V.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(V){var J=this;return(0,pe.Z)(function*(){if(J.sender&&J.activeServiceWorker&&function An(){var Z;return(null===(Z=navigator?.serviceWorker)||void 0===Z?void 0:Z.controller)||null}()===J.activeServiceWorker)try{yield J.sender._send("keyChanged",{key:V},J.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,pe.Z)(function*(){try{if(!indexedDB)return!1;const V=yield La();return yield Lc(V,Cl,"1"),yield Zu(V,Cl),!0}catch{}return!1})()}_withPendingWrite(V){var J=this;return(0,pe.Z)(function*(){J.pendingWrites++;try{yield V()}finally{J.pendingWrites--}})()}_set(V,J){var me=this;return(0,pe.Z)(function*(){return me._withPendingWrite((0,pe.Z)(function*(){return yield me._withRetries(ke=>Lc(ke,V,J)),me.localCache[V]=J,me.notifyServiceWorker(V)}))})()}_get(V){var J=this;return(0,pe.Z)(function*(){const me=yield J._withRetries(ke=>function us(Z,F){return Fa.apply(this,arguments)}(ke,V));return J.localCache[V]=me,me})()}_remove(V){var J=this;return(0,pe.Z)(function*(){return J._withPendingWrite((0,pe.Z)(function*(){return yield J._withRetries(me=>Zu(me,V)),delete J.localCache[V],J.notifyServiceWorker(V)}))})()}_poll(){var V=this;return(0,pe.Z)(function*(){const J=yield V._withRetries(Mt=>{const mn=Tl(Mt,!1).getAll();return new ec(mn).toPromise()});if(!J)return[];if(0!==V.pendingWrites)return[];const me=[],ke=new Set;for(const{fbase_key:Mt,value:mn}of J)ke.add(Mt),JSON.stringify(V.localCache[Mt])!==JSON.stringify(mn)&&(V.notifyListeners(Mt,mn),me.push(Mt));for(const Mt of Object.keys(V.localCache))V.localCache[Mt]&&!ke.has(Mt)&&(V.notifyListeners(Mt,null),me.push(Mt));return me})()}notifyListeners(V,J){this.localCache[V]=J;const me=this.listeners[V];if(me)for(const ke of Array.from(me))ke(J)}startPolling(){var V=this;this.stopPolling(),this.pollTimer=setInterval((0,pe.Z)(function*(){return V._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(V,J){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[V]||(this.listeners[V]=new Set,this._get(V)),this.listeners[V].add(J)}_removeListener(V,J){this.listeners[V]&&(this.listeners[V].delete(J),0===this.listeners[V].size&&delete this.listeners[V]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return Z.type="LOCAL",Z})();function Kd(Z,F){return bi(Z,"POST","/v2/accounts/mfaSignIn:start",$i(Z,F))}function Na(){return(Na=(0,pe.Z)(function*(Z){return(yield bi(Z,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Fc(Z){return new Promise((F,V)=>{const J=document.createElement("script");J.setAttribute("src",Z),J.onload=F,J.onerror=me=>{const ke=st("internal-error");ke.customData=me,V(ke)},J.type="text/javascript",J.charset="UTF-8",function ud(){var Z,F;return null!==(F=null===(Z=document.getElementsByTagName("head"))||void 0===Z?void 0:Z[0])&&void 0!==F?F:document}().appendChild(J)})}function za(Z){return`__${Z}${Math.floor(1e6*Math.random())}`}const Ks=1e12;class Sa{constructor(F){this.auth=F,this.counter=Ks,this._widgets=new Map}render(F,V){const J=this.counter;return this._widgets.set(J,new If(F,this.auth.name,V||{})),this.counter++,J}reset(F){var V;const J=F||Ks;null===(V=this._widgets.get(J))||void 0===V||V.delete(),this._widgets.delete(J)}getResponse(F){var V;return(null===(V=this._widgets.get(F||Ks))||void 0===V?void 0:V.getResponse())||""}execute(F){var V=this;return(0,pe.Z)(function*(){var J;return null===(J=V._widgets.get(F||Ks))||void 0===J||J.execute(),""})()}}class If{constructor(F,V,J){this.params=J,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const me="string"==typeof F?document.getElementById(F):F;it(me,"argument-error",{appName:V}),this.container=me,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function dd(Z){const F=[],V="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let J=0;J<Z;J++)F.push(V.charAt(Math.floor(Math.random()*V.length)));return F.join("")}(50);const{callback:F,"expired-callback":V}=this.params;if(F)try{F(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,V)try{V()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const zc=za("rcb"),Np=new vi(3e4,6e4);class Ls{constructor(){var F;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(F=Eo().grecaptcha)||void 0===F||!F.render)}load(F,V=""){return it(function Bc(Z){return Z.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(Z)}(V),F,"argument-error"),this.shouldResolveImmediately(V)?Promise.resolve(Eo().grecaptcha):new Promise((J,me)=>{const ke=Eo().setTimeout(()=>{me(st(F,"network-request-failed"))},Np.get());Eo()[zc]=()=>{Eo().clearTimeout(ke),delete Eo()[zc];const mn=Eo().grecaptcha;if(!mn)return void me(st(F,"internal-error"));const ei=mn.render;mn.render=(oi,dr)=>{const rs=ei(oi,dr);return this.counter++,rs},this.hostLanguage=V,J(mn)},Fc(`https://www.google.com/recaptcha/api.js??${(0,o.xO)({onload:zc,render:"explicit",hl:V})}`).catch(()=>{clearTimeout(ke),me(st(F,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(F){var V;return!(null===(V=Eo().grecaptcha)||void 0===V||!V.render)&&(F===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Th{load(F){return(0,pe.Z)(function*(){return new Sa(F)})()}clearedOneInstance(){}}const Yu="recaptcha",Yd={theme:"light",type:"image"};class Sl{constructor(F,V=Object.assign({},Yd),J){this.parameters=V,this.type=Yu,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Nn(J),this.isInvisible="invisible"===this.parameters.size,it(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const me="string"==typeof F?document.getElementById(F):F;it(me,this.auth,"argument-error"),this.container=me,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Th:new Ls,this.validateStartingState()}verify(){var F=this;return(0,pe.Z)(function*(){F.assertNotDestroyed();const V=yield F.render(),J=F.getAssertedRecaptcha();return J.getResponse(V)||new Promise(ke=>{const Mt=mn=>{mn&&(F.tokenChangeListeners.delete(Mt),ke(mn))};F.tokenChangeListeners.add(Mt),F.isInvisible&&J.execute(V)})})()}render(){try{this.assertNotDestroyed()}catch(F){return Promise.reject(F)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(F=>{throw this.renderPromise=null,F})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(F=>{this.container.removeChild(F)})}validateStartingState(){it(!this.parameters.sitekey,this.auth,"argument-error"),it(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),it(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(F){return V=>{if(this.tokenChangeListeners.forEach(J=>J(V)),"function"==typeof F)F(V);else if("string"==typeof F){const J=Eo()[F];"function"==typeof J&&J(V)}}}assertNotDestroyed(){it(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var F=this;return(0,pe.Z)(function*(){if(yield F.init(),!F.widgetId){let V=F.container;if(!F.isInvisible){const J=document.createElement("div");V.appendChild(J),V=J}F.widgetId=F.getAssertedRecaptcha().render(V,F.parameters)}return F.widgetId})()}init(){var F=this;return(0,pe.Z)(function*(){it(wn()&&!qs(),F.auth,"internal-error"),yield function Ju(){let Z=null;return new Promise(F=>{"complete"!==document.readyState?(Z=()=>F(),window.addEventListener("load",Z)):F()}).catch(F=>{throw Z&&window.removeEventListener("load",Z),F})}(),F.recaptcha=yield F._recaptchaLoader.load(F.auth,F.auth.languageCode||void 0);const V=yield function qu(Z){return Na.apply(this,arguments)}(F.auth);it(V,F.auth,"internal-error"),F.parameters.sitekey=V})()}getAssertedRecaptcha(){return it(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Qu{constructor(F,V){this.verificationId=F,this.onConfirmation=V}confirm(F){const V=ko._fromVerification(this.verificationId,F);return this.onConfirmation(V)}}function Vc(Z,F,V){return Cr.apply(this,arguments)}function Cr(){return(Cr=(0,pe.Z)(function*(Z,F,V){const J=Nn(Z),me=yield nc(J,F,(0,o.m9)(V));return new Qu(me,ke=>Mi(J,ke))})).apply(this,arguments)}function Rn(Z,F,V){return Jd.apply(this,arguments)}function Jd(){return(Jd=(0,pe.Z)(function*(Z,F,V){const J=(0,o.m9)(Z);yield Xa(!1,J,"phone");const me=yield nc(J.auth,F,(0,o.m9)(V));return new Qu(me,ke=>_h(J,ke))})).apply(this,arguments)}function pd(Z,F,V){return Uc.apply(this,arguments)}function Uc(){return(Uc=(0,pe.Z)(function*(Z,F,V){const J=(0,o.m9)(Z),me=yield nc(J.auth,F,(0,o.m9)(V));return new Qu(me,ke=>Uu(J,ke))})).apply(this,arguments)}function nc(Z,F,V){return Sh.apply(this,arguments)}function Sh(){return(Sh=(0,pe.Z)(function*(Z,F,V){var J;const me=yield V.verify();try{let ke;if(it("string"==typeof me,Z,"argument-error"),it(V.type===Yu,Z,"argument-error"),ke="string"==typeof F?{phoneNumber:F}:F,"session"in ke){const Mt=ke.session;if("phoneNumber"in ke)return it("enroll"===Mt.type,Z,"internal-error"),(yield Po(Z,{idToken:Mt.credential,phoneEnrollmentInfo:{phoneNumber:ke.phoneNumber,recaptchaToken:me}})).phoneSessionInfo.sessionInfo;{it("signin"===Mt.type,Z,"internal-error");const mn=(null===(J=ke.multiFactorHint)||void 0===J?void 0:J.uid)||ke.multiFactorUid;return it(mn,Z,"missing-multi-factor-info"),(yield Kd(Z,{mfaPendingCredential:Mt.credential,mfaEnrollmentId:mn,phoneSignInInfo:{recaptchaToken:me}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:Mt}=yield ks(Z,{phoneNumber:ke.phoneNumber,recaptchaToken:me});return Mt}}finally{V._reset()}})).apply(this,arguments)}function Df(Z,F){return ic.apply(this,arguments)}function ic(){return(ic=(0,pe.Z)(function*(Z,F){yield iu((0,o.m9)(Z),F)})).apply(this,arguments)}let Af=(()=>{class Z{constructor(V){this.providerId=Z.PROVIDER_ID,this.auth=Nn(V)}verifyPhoneNumber(V,J){return nc(this.auth,V,(0,o.m9)(J))}static credential(V,J){return ko._fromVerification(V,J)}static credentialFromResult(V){return Z.credentialFromTaggedObject(V)}static credentialFromError(V){return Z.credentialFromTaggedObject(V.customData||{})}static credentialFromTaggedObject({_tokenResponse:V}){if(!V)return null;const{phoneNumber:J,temporaryProof:me}=V;return J&&me?ko._fromTokenResponse(J,me):null}}return Z.PROVIDER_ID="phone",Z.PHONE_SIGN_IN_METHOD="phone",Z})();function rc(Z,F){return F?xt(F):(it(Z._popupRedirectResolver,Z,"argument-error"),Z._popupRedirectResolver)}class To extends Mr{constructor(F){super("custom","custom"),this.params=F}_getIdTokenResponse(F){return ta(F,this._buildIdpRequest())}_linkToIdToken(F,V){return ta(F,this._buildIdpRequest(V))}_getReauthenticationResolver(F){return ta(F,this._buildIdpRequest())}_buildIdpRequest(F){const V={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return F&&(V.idToken=F),V}}function Hc(Z){return Zl(Z.auth,new To(Z),Z.bypassAuthState)}function oc(Z){const{auth:F,user:V}=Z;return it(V,F,"internal-error"),Dc(V,new To(Z),Z.bypassAuthState)}function pu(Z){return hs.apply(this,arguments)}function hs(){return(hs=(0,pe.Z)(function*(Z){const{auth:F,user:V}=Z;return it(V,F,"internal-error"),iu(V,new To(Z),Z.bypassAuthState)})).apply(this,arguments)}class Il{constructor(F,V,J,me,ke=!1){this.auth=F,this.resolver=J,this.user=me,this.bypassAuthState=ke,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(V)?V:[V]}execute(){var F=this;return new Promise(function(){var V=(0,pe.Z)(function*(J,me){F.pendingPromise={resolve:J,reject:me};try{F.eventManager=yield F.resolver._initialize(F.auth),yield F.onExecution(),F.eventManager.registerConsumer(F)}catch(ke){F.reject(ke)}});return function(J,me){return V.apply(this,arguments)}}())}onAuthEvent(F){var V=this;return(0,pe.Z)(function*(){const{urlResponse:J,sessionId:me,postBody:ke,tenantId:Mt,error:mn,type:ei}=F;if(mn)return void V.reject(mn);const oi={auth:V.auth,requestUri:J,sessionId:me,tenantId:Mt||void 0,postBody:ke||void 0,user:V.user,bypassAuthState:V.bypassAuthState};try{V.resolve(yield V.getIdpTask(ei)(oi))}catch(dr){V.reject(dr)}})()}onError(F){this.reject(F)}getIdpTask(F){switch(F){case"signInViaPopup":case"signInViaRedirect":return Hc;case"linkViaPopup":case"linkViaRedirect":return pu;case"reauthViaPopup":case"reauthViaRedirect":return oc;default:Jt(this.auth,"internal-error")}}resolve(F){en(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(F),this.unregisterAndCleanUp()}reject(F){en(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(F),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Mf=new vi(2e3,1e4);function fd(Z,F,V){return Xu.apply(this,arguments)}function Xu(){return(Xu=(0,pe.Z)(function*(Z,F,V){const J=Nn(Z);nn(Z,F,Ca);const me=rc(J,V);return new Ys(J,"signInViaPopup",F,me).executeNotNull()})).apply(this,arguments)}function kf(Z,F,V){return zp.apply(this,arguments)}function zp(){return(zp=(0,pe.Z)(function*(Z,F,V){const J=(0,o.m9)(Z);nn(J.auth,F,Ca);const me=rc(J.auth,V);return new Ys(J.auth,"reauthViaPopup",F,me,J).executeNotNull()})).apply(this,arguments)}function fu(Z,F,V){return Qd.apply(this,arguments)}function Qd(){return(Qd=(0,pe.Z)(function*(Z,F,V){const J=(0,o.m9)(Z);nn(J.auth,F,Ca);const me=rc(J.auth,V);return new Ys(J.auth,"linkViaPopup",F,me,J).executeNotNull()})).apply(this,arguments)}let Ys=(()=>{class Z extends Il{constructor(V,J,me,ke,Mt){super(V,J,ke,Mt),this.provider=me,this.authWindow=null,this.pollId=null,Z.currentPopupAction&&Z.currentPopupAction.cancel(),Z.currentPopupAction=this}executeNotNull(){var V=this;return(0,pe.Z)(function*(){const J=yield V.execute();return it(J,V.auth,"internal-error"),J})()}onExecution(){var V=this;return(0,pe.Z)(function*(){en(1===V.filter.length,"Popup operations only handle one event");const J=Ta();V.authWindow=yield V.resolver._openPopup(V.auth,V.provider,V.filter[0],J),V.authWindow.associatedEvent=J,V.resolver._originValidation(V.auth).catch(me=>{V.reject(me)}),V.resolver._isIframeWebStorageSupported(V.auth,me=>{me||V.reject(st(V.auth,"web-storage-unsupported"))}),V.pollUserCancellation()})()}get eventId(){var V;return(null===(V=this.authWindow)||void 0===V?void 0:V.associatedEvent)||null}cancel(){this.reject(st(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Z.currentPopupAction=null}pollUserCancellation(){const V=()=>{var J,me;this.pollId=null!==(me=null===(J=this.authWindow)||void 0===J?void 0:J.window)&&void 0!==me&&me.closed?window.setTimeout(()=>{this.pollId=null,this.reject(st(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(V,Mf.get())};V()}}return Z.currentPopupAction=null,Z})();const Oo=new Map;class Qr extends Il{constructor(F,V,J=!1){super(F,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],V,void 0,J),this.eventId=null}execute(){var F=()=>super.execute,V=this;return(0,pe.Z)(function*(){let J=Oo.get(V.auth._key());if(!J){try{const ke=(yield function qn(Z,F){return w.apply(this,arguments)}(V.resolver,V.auth))?yield F().call(V):null;J=()=>Promise.resolve(ke)}catch(me){J=()=>Promise.reject(me)}Oo.set(V.auth._key(),J)}return V.bypassAuthState||Oo.set(V.auth._key(),()=>Promise.resolve(null)),J()})()}onAuthEvent(F){var V=()=>super.onAuthEvent,J=this;return(0,pe.Z)(function*(){if("signInViaRedirect"===F.type)return V().call(J,F);if("unknown"!==F.type){if(F.eventId){const me=yield J.auth._redirectUserForId(F.eventId);if(me)return J.user=me,V().call(J,F);J.resolve(null)}}else J.resolve(null)})()}onExecution(){return(0,pe.Z)(function*(){})()}cleanUp(){}}function w(){return(w=(0,pe.Z)(function*(Z,F){const V=I(F),J=P(Z);if(!(yield J._isAvailable()))return!1;const me="true"===(yield J._get(V));return yield J._remove(V),me})).apply(this,arguments)}function h(Z,F){return _.apply(this,arguments)}function _(){return(_=(0,pe.Z)(function*(Z,F){return P(Z)._set(I(F),"true")})).apply(this,arguments)}function T(){Oo.clear()}function k(Z,F){Oo.set(Z._key(),F)}function P(Z){return xt(Z._redirectPersistence)}function I(Z){return je("pendingRedirect",Z.config.apiKey,Z.name)}function M(Z,F,V){return function z(Z,F,V){return G.apply(this,arguments)}(Z,F,V)}function G(){return(G=(0,pe.Z)(function*(Z,F,V){const J=Nn(Z);nn(Z,F,Ca),yield J._initializationPromise;const me=rc(J,V);return yield h(me,J),me._openRedirect(J,F,"signInViaRedirect")})).apply(this,arguments)}function $(Z,F,V){return function te(Z,F,V){return ue.apply(this,arguments)}(Z,F,V)}function ue(){return(ue=(0,pe.Z)(function*(Z,F,V){const J=(0,o.m9)(Z);nn(J.auth,F,Ca),yield J.auth._initializationPromise;const me=rc(J.auth,V);yield h(me,J.auth);const ke=yield Fe(J);return me._openRedirect(J.auth,F,"reauthViaRedirect",ke)})).apply(this,arguments)}function fe(Z,F,V){return function _e(Z,F,V){return ye.apply(this,arguments)}(Z,F,V)}function ye(){return(ye=(0,pe.Z)(function*(Z,F,V){const J=(0,o.m9)(Z);nn(J.auth,F,Ca),yield J.auth._initializationPromise;const me=rc(J.auth,V);yield Xa(!1,J,F.providerId),yield h(me,J.auth);const ke=yield Fe(J);return me._openRedirect(J.auth,F,"linkViaRedirect",ke)})).apply(this,arguments)}function Te(Z,F){return de.apply(this,arguments)}function de(){return(de=(0,pe.Z)(function*(Z,F){return yield Nn(Z)._initializationPromise,Oe(Z,F,!1)})).apply(this,arguments)}function Oe(Z,F){return Re.apply(this,arguments)}function Re(){return(Re=(0,pe.Z)(function*(Z,F,V=!1){const J=Nn(Z),me=rc(J,F),Mt=yield new Qr(J,me,V).execute();return Mt&&!V&&(delete Mt.user._redirectEventId,yield J._persistUserIfCurrent(Mt.user),yield J._setRedirectUser(null,F)),Mt})).apply(this,arguments)}function Fe(Z){return Ye.apply(this,arguments)}function Ye(){return(Ye=(0,pe.Z)(function*(Z){const F=Ta(`${Z.uid}:::`);return Z._redirectEventId=F,yield Z.auth._setRedirectUser(Z),yield Z.auth._persistUserIfCurrent(Z),F})).apply(this,arguments)}class Xe{constructor(F){this.auth=F,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(F){this.consumers.add(F),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,F)&&(this.sendToConsumer(this.queuedRedirectEvent,F),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(F){this.consumers.delete(F)}onEvent(F){if(this.hasEventBeenHandled(F))return!1;let V=!1;return this.consumers.forEach(J=>{this.isEventForConsumer(F,J)&&(V=!0,this.sendToConsumer(F,J),this.saveEventToCache(F))}),this.hasHandledPotentialRedirect||!function At(Z){switch(Z.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Et(Z);default:return!1}}(F)||(this.hasHandledPotentialRedirect=!0,V||(this.queuedRedirectEvent=F,V=!0)),V}sendToConsumer(F,V){var J;if(F.error&&!Et(F)){const me=(null===(J=F.error.code)||void 0===J?void 0:J.split("auth/")[1])||"internal-error";V.onError(st(this.auth,me))}else V.onAuthEvent(F)}isEventForConsumer(F,V){const J=null===V.eventId||!!F.eventId&&F.eventId===V.eventId;return V.filter.includes(F.type)&&J}hasEventBeenHandled(F){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(ut(F))}saveEventToCache(F){this.cachedEventUids.add(ut(F)),this.lastProcessedEventTime=Date.now()}}function ut(Z){return[Z.type,Z.eventId,Z.sessionId,Z.tenantId].filter(F=>F).join("-")}function Et({type:Z,error:F}){return"unknown"===Z&&"auth/no-auth-event"===F?.code}function on(Z){return wt.apply(this,arguments)}function wt(){return(wt=(0,pe.Z)(function*(Z,F={}){return bi(Z,"GET","/v1/projects",F)})).apply(this,arguments)}const qt=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Nt=/^https?/;function Tt(){return(Tt=(0,pe.Z)(function*(Z){if(Z.config.emulator)return;const{authorizedDomains:F}=yield on(Z);for(const V of F)try{if(yt(V))return}catch{}Jt(Z,"unauthorized-domain")})).apply(this,arguments)}function yt(Z){const F=Vt(),{protocol:V,hostname:J}=new URL(F);if(Z.startsWith("chrome-extension://")){const Mt=new URL(Z);return""===Mt.hostname&&""===J?"chrome-extension:"===V&&Z.replace("chrome-extension://","")===F.replace("chrome-extension://",""):"chrome-extension:"===V&&Mt.hostname===J}if(!Nt.test(V))return!1;if(qt.test(Z))return J===Z;const me=Z.replace(/\./g,"\\.");return new RegExp("^(.+\\."+me+"|"+me+")$","i").test(J)}const Pt=new vi(3e4,6e4);function tn(){const Z=Eo().___jsl;if(Z?.H)for(const F of Object.keys(Z.H))if(Z.H[F].r=Z.H[F].r||[],Z.H[F].L=Z.H[F].L||[],Z.H[F].r=[...Z.H[F].L],Z.CP)for(let V=0;V<Z.CP.length;V++)Z.CP[V]=null}let $n=null;function ki(Z){return $n=$n||function hn(Z){return new Promise((F,V)=>{var J,me,ke;function Mt(){tn(),gapi.load("gapi.iframes",{callback:()=>{F(gapi.iframes.getContext())},ontimeout:()=>{tn(),V(st(Z,"network-request-failed"))},timeout:Pt.get()})}if(null!==(me=null===(J=Eo().gapi)||void 0===J?void 0:J.iframes)&&void 0!==me&&me.Iframe)F(gapi.iframes.getContext());else{if(null===(ke=Eo().gapi)||void 0===ke||!ke.load){const mn=za("iframefcb");return Eo()[mn]=()=>{gapi.load?Mt():V(st(Z,"network-request-failed"))},Fc(`https://apis.google.com/js/api.js?onload=${mn}`).catch(ei=>V(ei))}Mt()}}).catch(F=>{throw $n=null,F})}(Z),$n}const Gn=new vi(5e3,15e3),sr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},hi=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Lr(Z){const F=Z.config;it(F.authDomain,Z,"auth-domain-config-required");const V=F.emulator?zi(F,"emulator/auth/iframe"):`https://${Z.config.authDomain}/__/auth/iframe`,J={apiKey:F.apiKey,appName:Z.name,v:xe.SDK_VERSION},me=hi.get(Z.config.apiHost);me&&(J.eid=me);const ke=Z._getFrameworks();return ke.length&&(J.fw=ke.join(",")),`${V}?${(0,o.xO)(J).slice(1)}`}function Xr(){return Xr=(0,pe.Z)(function*(Z){const F=yield ki(Z),V=Eo().gapi;return it(V,Z,"internal-error"),F.open({where:document.body,url:Lr(Z),messageHandlersFilter:V.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:sr,dontclear:!0},J=>new Promise(function(){var me=(0,pe.Z)(function*(ke,Mt){yield J.restyle({setHideOnLeave:!1});const mn=st(Z,"network-request-failed"),ei=Eo().setTimeout(()=>{Mt(mn)},Gn.get());function oi(){Eo().clearTimeout(ei),ke(J)}J.ping(oi).then(oi,()=>{Mt(mn)})});return function(ke,Mt){return me.apply(this,arguments)}}()))}),Xr.apply(this,arguments)}const Kr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class eo{constructor(F){this.window=F,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Fr(Z,F,V,J,me,ke){it(Z.config.authDomain,Z,"auth-domain-config-required"),it(Z.config.apiKey,Z,"invalid-api-key");const Mt={apiKey:Z.config.apiKey,appName:Z.name,authType:V,redirectUrl:J,v:xe.SDK_VERSION,eventId:me};if(F instanceof Ca){F.setDefaultLanguage(Z.languageCode),Mt.providerId=F.providerId||"",(0,o.xb)(F.getCustomParameters())||(Mt.customParameters=JSON.stringify(F.getCustomParameters()));for(const[ei,oi]of Object.entries(ke||{}))Mt[ei]=oi}if(F instanceof jo){const ei=F.getScopes().filter(oi=>""!==oi);ei.length>0&&(Mt.scopes=ei.join(","))}Z.tenantId&&(Mt.tid=Z.tenantId);const mn=Mt;for(const ei of Object.keys(mn))void 0===mn[ei]&&delete mn[ei];return`${function Fs({config:Z}){return Z.emulator?zi(Z,"emulator/auth/handler"):`https://${Z.authDomain}/__/auth/handler`}(Z)}?${(0,o.xO)(mn).slice(1)}`}const Ns="webStorageSupport",Ih=class gu{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Rc,this._completeRedirectFn=Oe,this._overrideRedirectResult=k}_openPopup(F,V,J,me){var ke=this;return(0,pe.Z)(function*(){var Mt;en(null===(Mt=ke.eventManagers[F._key()])||void 0===Mt?void 0:Mt.manager,"_initialize() not called before _openPopup()");const mn=Fr(F,V,J,Vt(),me);return function hr(Z,F,V,J=500,me=600){const ke=Math.max((window.screen.availHeight-me)/2,0).toString(),Mt=Math.max((window.screen.availWidth-J)/2,0).toString();let mn="";const ei=Object.assign(Object.assign({},Kr),{width:J.toString(),height:me.toString(),top:ke,left:Mt}),oi=(0,o.z$)().toLowerCase();V&&(mn=ie(oi)?"_blank":V),Ce(oi)&&(F=F||"http://localhost",ei.scrollbars="yes");const dr=Object.entries(ei).reduce((Ia,[jc,ep])=>`${Ia}${jc}=${ep},`,"");if(function tt(Z=(0,o.z$)()){var F;return Ke(Z)&&!(null===(F=window.navigator)||void 0===F||!F.standalone)}(oi)&&"_self"!==mn)return function gr(Z,F){const V=document.createElement("a");V.href=Z,V.target=F;const J=document.createEvent("MouseEvent");J.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),V.dispatchEvent(J)}(F||"",mn),new eo(null);const rs=window.open(F||"",mn,dr);it(rs,Z,"popup-blocked");try{rs.focus()}catch{}return new eo(rs)}(F,mn,Ta())})()}_openRedirect(F,V,J,me){var ke=this;return(0,pe.Z)(function*(){return yield ke._originValidation(F),function El(Z){Eo().location.href=Z}(Fr(F,V,J,Vt(),me)),new Promise(()=>{})})()}_initialize(F){const V=F._key();if(this.eventManagers[V]){const{manager:me,promise:ke}=this.eventManagers[V];return me?Promise.resolve(me):(en(ke,"If manager is not set, promise should be"),ke)}const J=this.initAndGetManager(F);return this.eventManagers[V]={promise:J},J.catch(()=>{delete this.eventManagers[V]}),J}initAndGetManager(F){var V=this;return(0,pe.Z)(function*(){const J=yield function Hr(Z){return Xr.apply(this,arguments)}(F),me=new Xe(F);return J.register("authEvent",ke=>(it(ke?.authEvent,F,"invalid-auth-event"),{status:me.onEvent(ke.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),V.eventManagers[F._key()]={manager:me},V.iframes[F._key()]=J,me})()}_isIframeWebStorageSupported(F,V){this.iframes[F._key()].send(Ns,{type:Ns},me=>{var ke;const Mt=null===(ke=me?.[0])||void 0===ke?void 0:ke[Ns];void 0!==Mt&&V(!!Mt),Jt(F,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(F){const V=F._key();return this.originValidationPromises[V]||(this.originValidationPromises[V]=function sn(Z){return Tt.apply(this,arguments)}(F)),this.originValidationPromises[V]}get _shouldInitProactively(){return $t()||re()||Ke()}};class Ba{constructor(F){this.factorId=F}_process(F,V,J){switch(V.type){case"enroll":return this._finalizeEnroll(F,V.credential,J);case"signin":return this._finalizeSignIn(F,V.credential);default:return zt("unexpected MultiFactorSessionType")}}}class rl extends Ba{constructor(F){super("phone"),this.credential=F}static _fromCredential(F){return new rl(F)}_finalizeEnroll(F,V,J){return function Wu(Z,F){return bi(Z,"POST","/v2/accounts/mfaEnrollment:finalize",$i(Z,F))}(F,{idToken:V,displayName:J,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(F,V){return function tc(Z,F){return bi(Z,"POST","/v2/accounts/mfaSignIn:finalize",$i(Z,F))}(F,{mfaPendingCredential:V,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let to=(()=>{class Z{constructor(){}static assertion(V){return rl._fromCredential(V)}}return Z.FACTOR_ID="phone",Z})();var yo="@firebase/auth";class md{constructor(F){this.auth=F,this.internalListeners=new Map}getUid(){var F;return this.assertAuthConfigured(),(null===(F=this.auth.currentUser)||void 0===F?void 0:F.uid)||null}getToken(F){var V=this;return(0,pe.Z)(function*(){return V.assertAuthConfigured(),yield V.auth._initializationPromise,V.auth.currentUser?{accessToken:yield V.auth.currentUser.getIdToken(F)}:null})()}addAuthTokenListener(F){if(this.assertAuthConfigured(),this.internalListeners.has(F))return;const V=this.auth.onIdTokenChanged(J=>{F(J?.stsTokenManager.accessToken||null)});this.internalListeners.set(F,V),this.updateProactiveRefresh()}removeAuthTokenListener(F){this.assertAuthConfigured();const V=this.internalListeners.get(F);V&&(this.internalListeners.delete(F),V(),this.updateProactiveRefresh())}assertAuthConfigured(){it(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const ly=(0,o.Pz)("authIdTokenMaxAge")||300;let Gg=null;const h0=Z=>function(){var F=(0,pe.Z)(function*(V){const J=V&&(yield V.getIdTokenResult()),me=J&&((new Date).getTime()-Date.parse(J.issuedAtTime))/1e3;if(me&&me>ly)return;const ke=J?.token;Gg!==ke&&(Gg=ke,yield fetch(Z,{method:ke?"POST":"DELETE",headers:ke?{Authorization:`Bearer ${ke}`}:{}}))});return function(V){return F.apply(this,arguments)}}();function cy(Z=(0,xe.getApp)()){const F=(0,xe._getProvider)(Z,"auth");if(F.isInitialized())return F.getImmediate();const V=function Lt(Z,F){const V=(0,xe._getProvider)(Z,"auth");if(V.isInitialized()){const me=V.getImmediate(),ke=V.getOptions();if((0,o.vZ)(ke,F??{}))return me;Jt(me,"already-initialized")}return V.initialize({options:F})}(Z,{popupRedirectResolver:Ih,persistence:[du,Os,Rc]}),J=(0,o.Pz)("authTokenSyncURL");if(J){const ke=h0(J);(function Ef(Z,F,V){(0,o.m9)(Z).beforeAuthStateChanged(F,V)})(V,ke,()=>ke(V.currentUser)),function Cf(Z,F,V,J){(0,o.m9)(Z).onIdTokenChanged(F,V,J)}(V,Mt=>ke(Mt))}const me=(0,o.q4)("auth");return me&&Li(V,`http://${me}`),V}!function ya(Z){(0,xe._registerComponent)(new Ht.wA("auth",(F,{options:V})=>{const J=F.getProvider("app").getImmediate(),me=F.getProvider("heartbeat"),{apiKey:ke,authDomain:Mt}=J.options;return((mn,ei)=>{it(ke&&!ke.includes(":"),"invalid-api-key",{appName:mn.name}),it(!Mt?.includes(":"),"argument-error",{appName:mn.name});const oi={apiKey:ke,authDomain:Mt,clientPlatform:Z,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:cn(Z)},dr=new Xn(mn,ei,oi);return function It(Z,F){const V=F?.persistence||[],J=(Array.isArray(V)?V:[V]).map(xt);F?.errorMap&&Z._updateErrorMap(F.errorMap),Z._initializeWithPersistence(J,F?.popupRedirectResolver)}(dr,V),dr})(J,me)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((F,V,J)=>{F.getProvider("auth-internal").initialize()})),(0,xe._registerComponent)(new Ht.wA("auth-internal",F=>{const V=Nn(F.getProvider("auth").getImmediate());return new md(V)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,xe.registerVersion)(yo,"0.21.3",function Rf(Z){switch(Z){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Z)),(0,xe.registerVersion)(yo,"0.21.3","esm2017")}("Browser")},2090:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{$s:()=>zn,BH:()=>Zt,G6:()=>ai,L:()=>ze,LL:()=>or,P0:()=>Ot,Pz:()=>st,Sg:()=>nn,UG:()=>zt,US:()=>Ht,ZB:()=>Ne,ZR:()=>ri,aH:()=>Jt,b$:()=>xt,eu:()=>Ni,hl:()=>ir,jU:()=>en,m9:()=>er,ne:()=>Mo,pd:()=>Wr,q4:()=>dt,r3:()=>qi,ru:()=>gt,tV:()=>ht,uI:()=>it,vZ:()=>Ao,w1:()=>It,xO:()=>Uo,xb:()=>Xo,z$:()=>yn,zI:()=>vi,zd:()=>lo});const ct=function(Qe){const je=[];let at=0;for(let Ue=0;Ue<Qe.length;Ue++){let Ce=Qe.charCodeAt(Ue);Ce<128?je[at++]=Ce:Ce<2048?(je[at++]=Ce>>6|192,je[at++]=63&Ce|128):55296==(64512&Ce)&&Ue+1<Qe.length&&56320==(64512&Qe.charCodeAt(Ue+1))?(Ce=65536+((1023&Ce)<<10)+(1023&Qe.charCodeAt(++Ue)),je[at++]=Ce>>18|240,je[at++]=Ce>>12&63|128,je[at++]=Ce>>6&63|128,je[at++]=63&Ce|128):(je[at++]=Ce>>12|224,je[at++]=Ce>>6&63|128,je[at++]=63&Ce|128)}return je},Ht={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(Qe,je){if(!Array.isArray(Qe))throw Error("encodeByteArray takes an array as a parameter");this.init_();const at=je?this.byteToCharMapWebSafe_:this.byteToCharMap_,Ue=[];for(let Ce=0;Ce<Qe.length;Ce+=3){const re=Qe[Ce],ie=Ce+1<Qe.length,ae=ie?Qe[Ce+1]:0,we=Ce+2<Qe.length,De=we?Qe[Ce+2]:0;let ot=(15&ae)<<2|De>>6,tt=63&De;we||(tt=64,ie||(ot=64)),Ue.push(at[re>>2],at[(3&re)<<4|ae>>4],at[ot],at[tt])}return Ue.join("")},encodeString(Qe,je){return this.HAS_NATIVE_SUPPORT&&!je?btoa(Qe):this.encodeByteArray(ct(Qe),je)},decodeString(Qe,je){return this.HAS_NATIVE_SUPPORT&&!je?atob(Qe):function(Qe){const je=[];let at=0,Ue=0;for(;at<Qe.length;){const Ce=Qe[at++];if(Ce<128)je[Ue++]=String.fromCharCode(Ce);else if(Ce>191&&Ce<224){const re=Qe[at++];je[Ue++]=String.fromCharCode((31&Ce)<<6|63&re)}else if(Ce>239&&Ce<365){const we=((7&Ce)<<18|(63&Qe[at++])<<12|(63&Qe[at++])<<6|63&Qe[at++])-65536;je[Ue++]=String.fromCharCode(55296+(we>>10)),je[Ue++]=String.fromCharCode(56320+(1023&we))}else{const re=Qe[at++],ie=Qe[at++];je[Ue++]=String.fromCharCode((15&Ce)<<12|(63&re)<<6|63&ie)}}return je.join("")}(this.decodeStringToByteArray(Qe,je))},decodeStringToByteArray(Qe,je){this.init_();const at=je?this.charToByteMapWebSafe_:this.charToByteMap_,Ue=[];for(let Ce=0;Ce<Qe.length;){const re=at[Qe.charAt(Ce++)],ae=Ce<Qe.length?at[Qe.charAt(Ce)]:0;++Ce;const De=Ce<Qe.length?at[Qe.charAt(Ce)]:64;++Ce;const Ke=Ce<Qe.length?at[Qe.charAt(Ce)]:64;if(++Ce,null==re||null==ae||null==De||null==Ke)throw Error();Ue.push(re<<2|ae>>4),64!==De&&(Ue.push(ae<<4&240|De>>2),64!==Ke&&Ue.push(De<<6&192|Ke))}return Ue},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let Qe=0;Qe<this.ENCODED_VALS.length;Qe++)this.byteToCharMap_[Qe]=this.ENCODED_VALS.charAt(Qe),this.charToByteMap_[this.byteToCharMap_[Qe]]=Qe,this.byteToCharMapWebSafe_[Qe]=this.ENCODED_VALS_WEBSAFE.charAt(Qe),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[Qe]]=Qe,Qe>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(Qe)]=Qe,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(Qe)]=Qe)}}},ze=function(Qe){return function(Qe){const je=ct(Qe);return Ht.encodeByteArray(je,!0)}(Qe).replace(/\./g,"")},ht=function(Qe){try{return Ht.decodeString(Qe,!0)}catch(je){console.error("base64Decode failed: ",je)}return null};function Ne(Qe,je){if(!(je instanceof Object))return je;switch(je.constructor){case Date:return new Date(je.getTime());case Object:void 0===Qe&&(Qe={});break;case Array:Qe=[];break;default:return je}for(const at in je)!je.hasOwnProperty(at)||!nt(at)||(Qe[at]=Ne(Qe[at],je[at]));return Qe}function nt(Qe){return"__proto__"!==Qe}const Je=()=>{try{return function fn(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const Qe=process.env.__FIREBASE_DEFAULTS__;return Qe?JSON.parse(Qe):void 0})()||(()=>{if(typeof document>"u")return;let Qe;try{Qe=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const je=Qe&&ht(Qe[1]);return je&&JSON.parse(je)})()}catch(Qe){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${Qe}`)}},dt=Qe=>{var je,at;return null===(at=null===(je=Je())||void 0===je?void 0:je.emulatorHosts)||void 0===at?void 0:at[Qe]},Ot=Qe=>{const je=dt(Qe);if(!je)return;const at=je.lastIndexOf(":");if(at<=0||at+1===je.length)throw new Error(`Invalid host ${je} with no separate hostname and port!`);const Ue=parseInt(je.substring(at+1),10);return"["===je[0]?[je.substring(1,at-1),Ue]:[je.substring(0,at),Ue]},Jt=()=>{var Qe;return null===(Qe=Je())||void 0===Qe?void 0:Qe.config},st=Qe=>{var je;return null===(je=Je())||void 0===je?void 0:je[`_${Qe}`]};class Zt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((je,at)=>{this.resolve=je,this.reject=at})}wrapCallback(je){return(at,Ue)=>{at?this.reject(at):this.resolve(Ue),"function"==typeof je&&(this.promise.catch(()=>{}),1===je.length?je(at):je(at,Ue))}}}function nn(Qe,je){if(Qe.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const Ue=je||"demo-project",Ce=Qe.iat||0,re=Qe.sub||Qe.user_id;if(!re)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const ie=Object.assign({iss:`https://securetoken.google.com/${Ue}`,aud:Ue,iat:Ce,exp:Ce+3600,auth_time:Ce,sub:re,user_id:re,firebase:{sign_in_provider:"custom",identities:{}}},Qe);return[ze(JSON.stringify({alg:"none",type:"JWT"})),ze(JSON.stringify(ie)),""].join(".")}function yn(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function it(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(yn())}function zt(){var Qe;const je=null===(Qe=Je())||void 0===Qe?void 0:Qe.forceEnvironment;if("node"===je)return!0;if("browser"===je)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function en(){return"object"==typeof self&&self.self===self}function gt(){const Qe="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof Qe&&void 0!==Qe.id}function xt(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function It(){const Qe=yn();return Qe.indexOf("MSIE ")>=0||Qe.indexOf("Trident/")>=0}function ai(){return!zt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ir(){try{return"object"==typeof indexedDB}catch{return!1}}function Ni(){return new Promise((Qe,je)=>{try{let at=!0;const Ue="validate-browser-context-for-indexeddb-analytics-module",Ce=self.indexedDB.open(Ue);Ce.onsuccess=()=>{Ce.result.close(),at||self.indexedDB.deleteDatabase(Ue),Qe(!0)},Ce.onupgradeneeded=()=>{at=!1},Ce.onerror=()=>{var re;je((null===(re=Ce.error)||void 0===re?void 0:re.message)||"")}}catch(at){je(at)}})}function vi(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class ri extends Error{constructor(je,at,Ue){super(at),this.code=je,this.customData=Ue,this.name="FirebaseError",Object.setPrototypeOf(this,ri.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,or.prototype.create)}}class or{constructor(je,at,Ue){this.service=je,this.serviceName=at,this.errors=Ue}create(je,...at){const Ue=at[0]||{},Ce=`${this.service}/${je}`,re=this.errors[je],ie=re?function Bo(Qe,je){return Qe.replace($i,(at,Ue)=>{const Ce=je[Ue];return null!=Ce?String(Ce):`<${Ue}?>`})}(re,Ue):"Error";return new ri(Ce,`${this.serviceName}: ${ie} (${Ce}).`,Ue)}}const $i=/\{\$([^}]+)}/g;function qi(Qe,je){return Object.prototype.hasOwnProperty.call(Qe,je)}function Xo(Qe){for(const je in Qe)if(Object.prototype.hasOwnProperty.call(Qe,je))return!1;return!0}function Ao(Qe,je){if(Qe===je)return!0;const at=Object.keys(Qe),Ue=Object.keys(je);for(const Ce of at){if(!Ue.includes(Ce))return!1;const re=Qe[Ce],ie=je[Ce];if(Pr(re)&&Pr(ie)){if(!Ao(re,ie))return!1}else if(re!==ie)return!1}for(const Ce of Ue)if(!at.includes(Ce))return!1;return!0}function Pr(Qe){return null!==Qe&&"object"==typeof Qe}function Uo(Qe){const je=[];for(const[at,Ue]of Object.entries(Qe))Array.isArray(Ue)?Ue.forEach(Ce=>{je.push(encodeURIComponent(at)+"="+encodeURIComponent(Ce))}):je.push(encodeURIComponent(at)+"="+encodeURIComponent(Ue));return je.length?"&"+je.join("&"):""}function lo(Qe){const je={};return Qe.replace(/^\?/,"").split("&").forEach(Ue=>{if(Ue){const[Ce,re]=Ue.split("=");je[decodeURIComponent(Ce)]=decodeURIComponent(re)}}),je}function Wr(Qe){const je=Qe.indexOf("?");if(!je)return"";const at=Qe.indexOf("#",je);return Qe.substring(je,at>0?at:void 0)}function Mo(Qe,je){const at=new wr(Qe,je);return at.subscribe.bind(at)}class wr{constructor(je,at){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=at,this.task.then(()=>{je(this)}).catch(Ue=>{this.error(Ue)})}next(je){this.forEachObserver(at=>{at.next(je)})}error(je){this.forEachObserver(at=>{at.error(je)}),this.close(je)}complete(){this.forEachObserver(je=>{je.complete()}),this.close()}subscribe(je,at,Ue){let Ce;if(void 0===je&&void 0===at&&void 0===Ue)throw new Error("Missing Observer.");Ce=function ui(Qe,je){if("object"!=typeof Qe||null===Qe)return!1;for(const at of je)if(at in Qe&&"function"==typeof Qe[at])return!0;return!1}(je,["next","error","complete"])?je:{next:je,error:at,complete:Ue},void 0===Ce.next&&(Ce.next=Wn),void 0===Ce.error&&(Ce.error=Wn),void 0===Ce.complete&&(Ce.complete=Wn);const re=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?Ce.error(this.finalError):Ce.complete()}catch{}}),this.observers.push(Ce),re}unsubscribeOne(je){void 0===this.observers||void 0===this.observers[je]||(delete this.observers[je],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(je){if(!this.finalized)for(let at=0;at<this.observers.length;at++)this.sendOne(at,je)}sendOne(je,at){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[je])try{at(this.observers[je])}catch(Ue){typeof console<"u"&&console.error&&console.error(Ue)}})}close(je){this.finalized||(this.finalized=!0,void 0!==je&&(this.finalError=je),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Wn(){}function zn(Qe,je=1e3,at=2){const Ue=je*Math.pow(at,Qe),Ce=Math.round(.5*Ue*(Math.random()-.5)*2);return Math.min(144e5,Ue+Ce)}function er(Qe){return Qe&&Qe._delegate?Qe._delegate:Qe}},3081:(bt,vt,Ee)=>{"use strict";var pe={};Ee.r(pe),Ee.d(pe,{auth:()=>TU});var o=Ee(4650);let xe=null;function ct(){return xe}class Ht{}const y=new o.OlP("DocumentToken");let ze=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:function(){return function ht(){return(0,o.LFG)(Ne)}()},providedIn:"platform"}),n})();const qe=new o.OlP("Location Initialized");let Ne=(()=>{class n extends ze{constructor(e){super(),this._doc=e,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ct().getBaseHref(this._doc)}onPopState(e){const i=ct().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",e,!1),()=>i.removeEventListener("popstate",e)}onHashChange(e){const i=ct().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",e,!1),()=>i.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,i,r){nt()?this._history.pushState(e,i,r):this._location.hash=r}replaceState(e,i,r){nt()?this._history.replaceState(e,i,r):this._location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(y))},n.\u0275prov=o.Yz7({token:n,factory:function(){return function fn(){return new Ne((0,o.LFG)(y))}()},providedIn:"platform"}),n})();function nt(){return!!window.history.pushState}function ft(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function ln(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function Ze(n){return n&&"?"!==n[0]?"?"+n:n}let Je=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:function(){return(0,o.f3M)(Ot)},providedIn:"root"}),n})();const dt=new o.OlP("appBaseHref");let Ot=(()=>{class n extends Je{constructor(e,i){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??(0,o.f3M)(y).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return ft(this._baseHref,e)}path(e=!1){const i=this._platformLocation.pathname+Ze(this._platformLocation.search),r=this._platformLocation.hash;return r&&e?`${i}${r}`:i}pushState(e,i,r,a){const g=this.prepareExternalUrl(r+Ze(a));this._platformLocation.pushState(e,i,g)}replaceState(e,i,r,a){const g=this.prepareExternalUrl(r+Ze(a));this._platformLocation.replaceState(e,i,g)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(ze),o.LFG(dt,8))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Jt=(()=>{class n extends Je{constructor(e,i){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(e){const i=ft(this._baseHref,e);return i.length>0?"#"+i:i}pushState(e,i,r,a){let g=this.prepareExternalUrl(r+Ze(a));0==g.length&&(g=this._platformLocation.pathname),this._platformLocation.pushState(e,i,g)}replaceState(e,i,r,a){let g=this.prepareExternalUrl(r+Ze(a));0==g.length&&(g=this._platformLocation.pathname),this._platformLocation.replaceState(e,i,g)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(ze),o.LFG(dt,8))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})(),st=(()=>{class n{constructor(e){this._subject=new o.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const i=this._locationStrategy.getBaseHref();this._basePath=function it(n){if(new RegExp("^(https?:)?//").test(n)){const[,e]=n.split(/\/\/[^\/]+/);return e}return n}(ln(yn(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,i=""){return this.path()==this.normalize(e+Ze(i))}normalize(e){return n.stripTrailingSlash(function nn(n,t){return n&&new RegExp(`^${n}([/;?#]|$)`).test(t)?t.substring(n.length):t}(this._basePath,yn(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,i="",r=null){this._locationStrategy.pushState(r,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Ze(i)),r)}replaceState(e,i="",r=null){this._locationStrategy.replaceState(r,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Ze(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",i){this._urlChangeListeners.forEach(r=>r(e,i))}subscribe(e,i,r){return this._subject.subscribe({next:e,error:i,complete:r})}}return n.normalizeQueryParams=Ze,n.joinWithSlash=ft,n.stripTrailingSlash=ln,n.\u0275fac=function(e){return new(e||n)(o.LFG(Je))},n.\u0275prov=o.Yz7({token:n,factory:function(){return function Zt(){return new st((0,o.LFG)(Je))}()},providedIn:"root"}),n})();function yn(n){return n.replace(/\/index.html$/,"")}const zt={ADP:[void 0,void 0,0],AFN:[void 0,"\u060b",0],ALL:[void 0,void 0,0],AMD:[void 0,"\u058f",2],AOA:[void 0,"Kz"],ARS:[void 0,"$"],AUD:["A$","$"],AZN:[void 0,"\u20bc"],BAM:[void 0,"KM"],BBD:[void 0,"$"],BDT:[void 0,"\u09f3"],BHD:[void 0,void 0,3],BIF:[void 0,void 0,0],BMD:[void 0,"$"],BND:[void 0,"$"],BOB:[void 0,"Bs"],BRL:["R$"],BSD:[void 0,"$"],BWP:[void 0,"P"],BYN:[void 0,void 0,2],BYR:[void 0,void 0,0],BZD:[void 0,"$"],CAD:["CA$","$",2],CHF:[void 0,void 0,2],CLF:[void 0,void 0,4],CLP:[void 0,"$",0],CNY:["CN\xa5","\xa5"],COP:[void 0,"$",2],CRC:[void 0,"\u20a1",2],CUC:[void 0,"$"],CUP:[void 0,"$"],CZK:[void 0,"K\u010d",2],DJF:[void 0,void 0,0],DKK:[void 0,"kr",2],DOP:[void 0,"$"],EGP:[void 0,"E\xa3"],ESP:[void 0,"\u20a7",0],EUR:["\u20ac"],FJD:[void 0,"$"],FKP:[void 0,"\xa3"],GBP:["\xa3"],GEL:[void 0,"\u20be"],GHS:[void 0,"GH\u20b5"],GIP:[void 0,"\xa3"],GNF:[void 0,"FG",0],GTQ:[void 0,"Q"],GYD:[void 0,"$",2],HKD:["HK$","$"],HNL:[void 0,"L"],HRK:[void 0,"kn"],HUF:[void 0,"Ft",2],IDR:[void 0,"Rp",2],ILS:["\u20aa"],INR:["\u20b9"],IQD:[void 0,void 0,0],IRR:[void 0,void 0,0],ISK:[void 0,"kr",0],ITL:[void 0,void 0,0],JMD:[void 0,"$"],JOD:[void 0,void 0,3],JPY:["\xa5",void 0,0],KHR:[void 0,"\u17db"],KMF:[void 0,"CF",0],KPW:[void 0,"\u20a9",0],KRW:["\u20a9",void 0,0],KWD:[void 0,void 0,3],KYD:[void 0,"$"],KZT:[void 0,"\u20b8"],LAK:[void 0,"\u20ad",0],LBP:[void 0,"L\xa3",0],LKR:[void 0,"Rs"],LRD:[void 0,"$"],LTL:[void 0,"Lt"],LUF:[void 0,void 0,0],LVL:[void 0,"Ls"],LYD:[void 0,void 0,3],MGA:[void 0,"Ar",0],MGF:[void 0,void 0,0],MMK:[void 0,"K",0],MNT:[void 0,"\u20ae",2],MRO:[void 0,void 0,0],MUR:[void 0,"Rs",2],MXN:["MX$","$"],MYR:[void 0,"RM"],NAD:[void 0,"$"],NGN:[void 0,"\u20a6"],NIO:[void 0,"C$"],NOK:[void 0,"kr",2],NPR:[void 0,"Rs"],NZD:["NZ$","$"],OMR:[void 0,void 0,3],PHP:["\u20b1"],PKR:[void 0,"Rs",2],PLN:[void 0,"z\u0142"],PYG:[void 0,"\u20b2",0],RON:[void 0,"lei"],RSD:[void 0,void 0,0],RUB:[void 0,"\u20bd"],RWF:[void 0,"RF",0],SBD:[void 0,"$"],SEK:[void 0,"kr",2],SGD:[void 0,"$"],SHP:[void 0,"\xa3"],SLE:[void 0,void 0,2],SLL:[void 0,void 0,0],SOS:[void 0,void 0,0],SRD:[void 0,"$"],SSP:[void 0,"\xa3"],STD:[void 0,void 0,0],STN:[void 0,"Db"],SYP:[void 0,"\xa3",0],THB:[void 0,"\u0e3f"],TMM:[void 0,void 0,0],TND:[void 0,void 0,3],TOP:[void 0,"T$"],TRL:[void 0,void 0,0],TRY:[void 0,"\u20ba"],TTD:[void 0,"$"],TWD:["NT$","$",2],TZS:[void 0,void 0,2],UAH:[void 0,"\u20b4"],UGX:[void 0,void 0,0],USD:["$"],UYI:[void 0,void 0,0],UYU:[void 0,"$"],UYW:[void 0,void 0,4],UZS:[void 0,void 0,2],VEF:[void 0,"Bs",2],VND:["\u20ab",void 0,0],VUV:[void 0,void 0,0],XAF:["FCFA",void 0,0],XCD:["EC$","$"],XOF:["F\u202fCFA",void 0,0],XPF:["CFPF",void 0,0],XXX:["\xa4"],YER:[void 0,void 0,0],ZAR:[void 0,"R"],ZMK:[void 0,void 0,0],ZMW:[void 0,"ZK"],ZWD:[void 0,void 0,0]};var en=(()=>((en=en||{})[en.Decimal=0]="Decimal",en[en.Percent=1]="Percent",en[en.Currency=2]="Currency",en[en.Scientific=3]="Scientific",en))(),Vt=(()=>((Vt=Vt||{})[Vt.Decimal=0]="Decimal",Vt[Vt.Group=1]="Group",Vt[Vt.List=2]="List",Vt[Vt.PercentSign=3]="PercentSign",Vt[Vt.PlusSign=4]="PlusSign",Vt[Vt.MinusSign=5]="MinusSign",Vt[Vt.Exponential=6]="Exponential",Vt[Vt.SuperscriptingExponent=7]="SuperscriptingExponent",Vt[Vt.PerMille=8]="PerMille",Vt[Vt.Infinity=9]="Infinity",Vt[Vt.NaN=10]="NaN",Vt[Vt.TimeSeparator=11]="TimeSeparator",Vt[Vt.CurrencyDecimal=12]="CurrencyDecimal",Vt[Vt.CurrencyGroup=13]="CurrencyGroup",Vt))();function Gr(n,t){const e=(0,o.cg1)(n),i=e[o.wAp.NumberSymbols][t];if(typeof i>"u"){if(t===Vt.CurrencyDecimal)return e[o.wAp.NumberSymbols][Vt.Decimal];if(t===Vt.CurrencyGroup)return e[o.wAp.NumberSymbols][Vt.Group]}return i}const De=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function Xn(n,t,e,i,r){const g=function Li(n,t="-"){const e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=n.split(";"),r=i[0],a=i[1],g=-1!==r.indexOf(".")?r.split("."):[r.substring(0,r.lastIndexOf("0")+1),r.substring(r.lastIndexOf("0")+1)],E=g[0],O=g[1]||"";e.posPre=E.substring(0,E.indexOf("#"));for(let Y=0;Y<O.length;Y++){const se=O.charAt(Y);"0"===se?e.minFrac=e.maxFrac=Y+1:"#"===se?e.maxFrac=Y+1:e.posSuf+=se}const j=E.split(",");if(e.gSize=j[1]?j[1].length:0,e.lgSize=j[2]||j[1]?(j[2]||j[1]).length:0,a){const Y=r.length-e.posPre.length-e.posSuf.length,se=a.indexOf("#");e.negPre=a.substring(0,se).replace(/'/g,""),e.negSuf=a.slice(se+Y).replace(/'/g,"")}else e.negPre=t+e.posPre,e.negSuf=e.posSuf;return e}(function Vo(n,t){return(0,o.cg1)(n)[o.wAp.NumberFormats][t]}(t,en.Currency),Gr(t,Vt.MinusSign));return g.minFrac=function Wr(n){let t;const e=zt[n];return e&&(t=e[2]),"number"==typeof t?t:2}(i),g.maxFrac=g.minFrac,function ni(n,t,e,i,r,a,g=!1){let E="",O=!1;if(isFinite(n)){let j=function li(n){let i,r,a,g,E,t=Math.abs(n)+"",e=0;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(a=t.search(/e/i))>0?(r<0&&(r=a),r+=+t.slice(a+1),t=t.substring(0,a)):r<0&&(r=t.length),a=0;"0"===t.charAt(a);a++);if(a===(E=t.length))i=[0],r=1;else{for(E--;"0"===t.charAt(E);)E--;for(r-=a,i=[],g=0;a<=E;a++,g++)i[g]=Number(t.charAt(a))}return r>22&&(i=i.splice(0,21),e=r-1,r=1),{digits:i,exponent:e,integerLen:r}}(n);g&&(j=function ur(n){if(0===n.digits[0])return n;const t=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===t?n.digits.push(0,0):1===t&&n.digits.push(0),n.integerLen+=2),n}(j));let Y=t.minInt,se=t.minFrac,be=t.maxFrac;if(a){const Ln=a.match(De);if(null===Ln)throw new Error(`${a} is not a valid digit info`);const Bn=Ln[1],Un=Ln[3],ii=Ln[5];null!=Bn&&(Y=ci(Bn)),null!=Un&&(se=ci(Un)),null!=ii?be=ci(ii):null!=Un&&se>be&&(be=se)}!function vr(n,t,e){if(t>e)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${e}).`);let i=n.digits,r=i.length-n.integerLen;const a=Math.min(Math.max(t,r),e);let g=a+n.integerLen,E=i[g];if(g>0){i.splice(Math.max(n.integerLen,g));for(let se=g;se<i.length;se++)i[se]=0}else{r=Math.max(0,r),n.integerLen=1,i.length=Math.max(1,g=a+1),i[0]=0;for(let se=1;se<g;se++)i[se]=0}if(E>=5)if(g-1<0){for(let se=0;se>g;se--)i.unshift(0),n.integerLen++;i.unshift(1),n.integerLen++}else i[g-1]++;for(;r<Math.max(0,a);r++)i.push(0);let O=0!==a;const j=t+n.integerLen,Y=i.reduceRight(function(se,be,Me,Ge){return Ge[Me]=(be+=se)<10?be:be-10,O&&(0===Ge[Me]&&Me>=j?Ge.pop():O=!1),be>=10?1:0},0);Y&&(i.unshift(Y),n.integerLen++)}(j,se,be);let Me=j.digits,Ge=j.integerLen;const _t=j.exponent;let Dt=[];for(O=Me.every(Ln=>!Ln);Ge<Y;Ge++)Me.unshift(0);for(;Ge<0;Ge++)Me.unshift(0);Ge>0?Dt=Me.splice(Ge,Me.length):(Dt=Me,Me=[0]);const _n=[];for(Me.length>=t.lgSize&&_n.unshift(Me.splice(-t.lgSize,Me.length).join(""));Me.length>t.gSize;)_n.unshift(Me.splice(-t.gSize,Me.length).join(""));Me.length&&_n.unshift(Me.join("")),E=_n.join(Gr(e,i)),Dt.length&&(E+=Gr(e,r)+Dt.join("")),_t&&(E+=Gr(e,Vt.Exponential)+"+"+_t)}else E=Gr(e,Vt.Infinity);return E=n<0&&!O?t.negPre+E+t.negSuf:t.posPre+E+t.posSuf,E}(n,g,t,Vt.CurrencyGroup,Vt.CurrencyDecimal,r).replace("\xa4",e).replace("\xa4","").trim()}function ci(n){const t=parseInt(n);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+n);return t}function Sr(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const i=e.indexOf("="),[r,a]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===t)return decodeURIComponent(a)}return null}const Vn=/\s+/,Vi=[];let Pi=(()=>{class n{constructor(e,i,r,a){this._iterableDiffers=e,this._keyValueDiffers=i,this._ngEl=r,this._renderer=a,this.initialClasses=Vi,this.stateMap=new Map}set klass(e){this.initialClasses=null!=e?e.trim().split(Vn):Vi}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(Vn):e}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const i of e)this._updateState(i,!0);else if(null!=e)for(const i of Object.keys(e))this._updateState(i,Boolean(e[i]));this._applyStateDiff()}_updateState(e,i){const r=this.stateMap.get(e);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(e,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const i=e[0],r=e[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(e,i){(e=e.trim()).length>0&&e.split(Vn).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.ZZ4),o.Y36(o.aQg),o.Y36(o.SBq),o.Y36(o.Qsj))},n.\u0275dir=o.lG2({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class vn{constructor(t,e,i,r){this.$implicit=t,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Hn=(()=>{class n{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,a,g)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new vn(r.item,this._ngForOf,-1,-1),null===g?void 0:g);else if(null==g)i.remove(null===a?void 0:a);else if(null!==a){const E=i.get(a);i.move(E,g),Ui(E,r)}});for(let r=0,a=i.length;r<a;r++){const E=i.get(r).context;E.index=r,E.count=a,E.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{Ui(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.s_b),o.Y36(o.Rgc),o.Y36(o.ZZ4))},n.\u0275dir=o.lG2({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function Ui(n,t){n.context.$implicit=t.item}let Zn=(()=>{class n{constructor(e,i){this._viewContainer=e,this._context=new Hi,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){Hl("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){Hl("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.s_b),o.Y36(o.Rgc))},n.\u0275dir=o.lG2({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class Hi{constructor(){this.$implicit=null,this.ngIf=null}}function Hl(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${(0,o.AaK)(t)}'.`)}let qr=(()=>{class n{constructor(e,i,r){this._ngEl=e,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){const[r,a]=e.split("."),g=-1===r.indexOf("-")?void 0:o.JOm.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,a?`${i}${a}`:i,g):this._renderer.removeStyle(this._ngEl.nativeElement,r,g)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.SBq),o.Y36(o.aQg),o.Y36(o.Qsj))},n.\u0275dir=o.lG2({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),n})(),Ki=(()=>{class n{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(e.ngTemplateOutlet||e.ngTemplateOutletInjector){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:a,ngTemplateOutletInjector:g}=this;this._viewRef=i.createEmbeddedView(r,a,g?{injector:g}:void 0)}else this._viewRef=null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.s_b))},n.\u0275dir=o.lG2({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[o.TTD]}),n})();function ks(n,t){return new o.vHH(2100,!1)}class fl{createSubscription(t,e){return t.subscribe({next:e,error:i=>{throw i}})}dispose(t){t.unsubscribe()}}class jl{createSubscription(t,e){return t.then(e,i=>{throw i})}dispose(t){}}const Ja=new jl,go=new fl;let Qi=(()=>{class n{constructor(e){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=e}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(e){return this._obj?e!==this._obj?(this._dispose(),this.transform(e)):this._latestValue:(e&&this._subscribe(e),this._latestValue)}_subscribe(e){this._obj=e,this._strategy=this._selectStrategy(e),this._subscription=this._strategy.createSubscription(e,i=>this._updateLatestValue(e,i))}_selectStrategy(e){if((0,o.QGY)(e))return Ja;if((0,o.F4k)(e))return go;throw ks()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(e,i){e===this._obj&&(this._latestValue=i,this._ref.markForCheck())}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.sBO,16))},n.\u0275pipe=o.Yjl({name:"async",type:n,pure:!1,standalone:!0}),n})(),kp=(()=>{class n{constructor(e,i="USD"){this._locale=e,this._defaultCurrencyCode=i}transform(e,i=this._defaultCurrencyCode,r="symbol",a,g){if(!function na(n){return!(null==n||""===n||n!=n)}(e))return null;g=g||this._locale,"boolean"==typeof r&&(r=r?"symbol":"code");let E=i||this._defaultCurrencyCode;"code"!==r&&(E="symbol"===r||"symbol-narrow"===r?function Uo(n,t,e="en"){const i=function ys(n){return(0,o.cg1)(n)[o.wAp.Currencies]}(e)[n]||zt[n]||[],r=i[1];return"narrow"===t&&"string"==typeof r?r:i[0]||n}(E,"symbol"===r?"wide":"narrow",g):r);try{return Xn(function Qa(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(e),g,E,i,a)}catch(O){throw ks()}}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.soG,16),o.Y36(o.EJc,16))},n.\u0275pipe=o.Yjl({name:"currency",type:n,pure:!0,standalone:!0}),n})();let tr=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({}),n})();function ml(n){return"server"===n}let Vu=(()=>{class n{}return n.\u0275prov=(0,o.Yz7)({token:n,providedIn:"root",factory:()=>new Xa((0,o.LFG)(y),window)}),n})();class Xa{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function Dc(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const a=r.shadowRoot;if(a){const g=a.getElementById(t)||a.querySelector(`[name="${t}"]`);if(g)return g}r=i.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),i=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo(i-a[0],r-a[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=Ic(this.window.history)||Ic(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function Ic(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class Zl{}class Cl extends Ht{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class ji extends Cl{static makeCurrent(){!function Ct(n){xe||(xe=n)}(new ji)}onAndCancel(t,e,i){return t.addEventListener(e,i,!1),()=>{t.removeEventListener(e,i,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function Tf(){return Xl=Xl||document.querySelector("base"),Xl?Xl.getAttribute("href"):null}();return null==e?null:function kc(n){tl=tl||document.createElement("a"),tl.setAttribute("href",n);const t=tl.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){Xl=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return Sr(document.cookie,t)}}let tl,Xl=null;const Os=new o.OlP("TRANSITION_ID"),Rc=[{provide:o.ip1,useFactory:function wm(n,t,e){return()=>{e.get(o.CZH).donePromise.then(()=>{const i=ct(),r=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let a=0;a<r.length;a++)i.remove(r[a])})}},deps:[Os,y,o.zs3],multi:!0}];let wh=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();const Ta=new o.OlP("EventManagerPlugins");let Pc=(()=>{class n{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>r.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}addGlobalEventListener(e,i,r){return this._findPluginFor(i).addGlobalEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){const i=this._eventNameToPlugin.get(e);if(i)return i;const r=this._plugins;for(let a=0;a<r.length;a++){const g=r[a];if(g.supports(e))return this._eventNameToPlugin.set(e,g),g}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(Ta),o.LFG(o.R0b))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();class Eo{constructor(t){this._doc=t}addGlobalEventListener(t,e,i){const r=ct().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,i)}}let El=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(e){const i=new Set;e.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})(),qs=(()=>{class n extends El{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,i,r){e.forEach(a=>{const g=this._doc.createElement("style");g.textContent=a,r.push(i.appendChild(g))})}addHost(e){const i=[];this._addStylesToHost(this._stylesSet,e,i),this._hostNodes.set(e,i)}removeHost(e){const i=this._hostNodes.get(e);i&&i.forEach(Oc),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(e,r,i)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(Oc))}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(y))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();function Oc(n){ct().remove(n)}const oa={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},An=/%COMP%/g;function Tl(n,t){return t.flat(100).map(e=>e.replace(An,n))}function Ch(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let La=(()=>{class n{constructor(e,i,r){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new Lc(e)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;switch(i.encapsulation){case o.ifc.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new Zu(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(e),r}case o.ifc.ShadowDom:return new cd(this.eventManager,this.sharedStylesHost,e,i);default:if(!this.rendererByCompId.has(i.id)){const r=Tl(i.id,i.styles);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(Pc),o.LFG(qs),o.LFG(o.AFp))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();class Lc{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(oa[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){(Fa(t)?t.content:t).appendChild(e)}insertBefore(t,e,i){t&&(Fa(t)?t.content:t).insertBefore(e,i)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let i="string"==typeof t?document.querySelector(t):t;if(!i)throw new Error(`The selector "${t}" did not match any elements`);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,r){if(r){e=r+":"+e;const a=oa[r];a?t.setAttributeNS(a,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){const r=oa[i];r?t.removeAttributeNS(r,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,r){r&(o.JOm.DashCase|o.JOm.Important)?t.style.setProperty(e,i,r&o.JOm.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&o.JOm.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){t[e]=i}setValue(t,e){t.nodeValue=e}listen(t,e,i){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,Ch(i)):this.eventManager.addEventListener(t,e,Ch(i))}}function Fa(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class Zu extends Lc{constructor(t,e,i,r){super(t),this.component=i;const a=Tl(r+"-"+i.id,i.styles);e.addStyles(a),this.contentAttr=function il(n){return"_ngcontent-%COMP%".replace(An,n)}(r+"-"+i.id),this.hostAttr=function ec(n){return"_nghost-%COMP%".replace(An,n)}(r+"-"+i.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}}class cd extends Lc{constructor(t,e,i,r){super(t),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const a=Tl(r.id,r.styles);for(let g=0;g<a.length;g++){const E=document.createElement("style");E.textContent=a[g],this.shadowRoot.appendChild(E)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let hu=(()=>{class n extends Eo{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(y))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();const Eh=["alt","control","meta","shift"],du={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Kd={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let tc=(()=>{class n extends Eo{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,i,r){const a=n.parseEventName(i),g=n.eventCallback(a.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ct().onAndCancel(e,a.domEventName,g))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const a=n._normalizeKey(i.pop());let g="",E=i.indexOf("code");if(E>-1&&(i.splice(E,1),g="code."),Eh.forEach(j=>{const Y=i.indexOf(j);Y>-1&&(i.splice(Y,1),g+=j+".")}),g+=a,0!=i.length||0===a.length)return null;const O={};return O.domEventName=r,O.fullKey=g,O}static matchEventFullKeyCode(e,i){let r=du[e.key]||e.key,a="";return i.indexOf("code.")>-1&&(r=e.code,a="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),Eh.forEach(g=>{g!==r&&(0,Kd[g])(e)&&(a+=g+".")}),a+=r,a===i)}static eventCallback(e,i,r){return a=>{n.matchEventFullKeyCode(a,e)&&r.runGuarded(()=>i(a))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(y))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();const If=(0,o.eFA)(o._c5,"browser",[{provide:o.Lbi,useValue:"browser"},{provide:o.g9A,useValue:function hd(){ji.makeCurrent()},multi:!0},{provide:y,useFactory:function Ks(){return(0,o.RDi)(document),document},deps:[]}]),dd=new o.OlP(""),zc=[{provide:o.rWj,useClass:class Sf{addToWindow(t){o.dqk.getAngularTestability=(i,r=!0)=>{const a=t.findTestabilityInTree(i,r);if(null==a)throw new Error("Could not find testability for element.");return a},o.dqk.getAllAngularTestabilities=()=>t.getAllTestabilities(),o.dqk.getAllAngularRootElements=()=>t.getAllRootElements(),o.dqk.frameworkStabilizers||(o.dqk.frameworkStabilizers=[]),o.dqk.frameworkStabilizers.push(i=>{const r=o.dqk.getAllAngularTestabilities();let a=r.length,g=!1;const E=function(O){g=g||O,a--,0==a&&i(g)};r.forEach(function(O){O.whenStable(E)})})}findTestabilityInTree(t,e,i){return null==e?null:t.getTestability(e)??(i?ct().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:o.lri,useClass:o.dDg,deps:[o.R0b,o.eoX,o.rWj]},{provide:o.dDg,useClass:o.dDg,deps:[o.R0b,o.eoX,o.rWj]}],Np=[{provide:o.zSh,useValue:"root"},{provide:o.qLn,useFactory:function Nc(){return new o.qLn},deps:[]},{provide:Ta,useClass:hu,multi:!0,deps:[y,o.R0b,o.Lbi]},{provide:Ta,useClass:tc,multi:!0,deps:[y]},{provide:La,useClass:La,deps:[Pc,qs,o.AFp]},{provide:o.FYo,useExisting:La},{provide:El,useExisting:qs},{provide:qs,useClass:qs,deps:[y]},{provide:Pc,useClass:Pc,deps:[Ta,o.R0b]},{provide:Zl,useClass:wh,deps:[]},[]];let Ku=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:o.AFp,useValue:e.appId},{provide:Os,useExisting:o.AFp},Rc]}}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(dd,12))},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({providers:[...Np,...zc],imports:[tr,o.hGG]}),n})(),Yd=(()=>{class n{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(y))},n.\u0275prov=o.Yz7({token:n,factory:function(e){let i=null;return i=e?new e:function Yu(){return new Yd((0,o.LFG)(y))}(),i},providedIn:"root"}),n})();typeof window<"u"&&window;var Oo=Ee(3269),Qr=Ee(8996);function qn(...n){const t=(0,Oo.yG)(n);return(0,Qr.D)(n,t)}var w=Ee(9751),h=Ee(5577),_=Ee(576);function T(n,t){return(0,_.m)(t)?(0,h.z)(n,t,1):(0,h.z)(n,1)}var k=Ee(4482),P=Ee(5403);function I(n,t){return(0,k.e)((e,i)=>{let r=0;e.subscribe((0,P.x)(i,a=>n.call(t,a,r++)&&i.next(a)))})}var M=Ee(4004);class z{}class G{}class ${constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(e=>{const i=e.indexOf(":");if(i>0){const r=e.slice(0,i),a=r.toLowerCase(),g=e.slice(i+1).trim();this.maybeSetNormalizedName(r,a),this.headers.has(a)?this.headers.get(a).push(g):this.headers.set(a,[g])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let i=t[e];const r=e.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(r,i),this.maybeSetNormalizedName(e,r))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof $?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new $;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof $?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let i=t.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(t.name,e);const r=("a"===t.op?this.headers.get(e):void 0)||[];r.push(...i),this.headers.set(e,r);break;case"d":const a=t.value;if(a){let g=this.headers.get(e);if(!g)return;g=g.filter(E=>-1===a.indexOf(E)),0===g.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,g)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class ue{encodeKey(t){return Te(t)}encodeValue(t){return Te(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const _e=/%(\d[a-f0-9])/gi,ye={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Te(n){return encodeURIComponent(n).replace(_e,(t,e)=>ye[e]??t)}function de(n){return`${n}`}class Oe{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new ue,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function fe(n,t){const e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const a=r.indexOf("="),[g,E]=-1==a?[t.decodeKey(r),""]:[t.decodeKey(r.slice(0,a)),t.decodeValue(r.slice(a+1))],O=e.get(g)||[];O.push(E),e.set(g,O)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const i=t.fromObject[e],r=Array.isArray(i)?i.map(de):[de(i)];this.map.set(e,r)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(i=>{const r=t[i];Array.isArray(r)?r.forEach(a=>{e.push({param:i,value:a,op:"a"})}):e.push({param:i,value:r,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(i=>e+"="+this.encoder.encodeValue(i)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new Oe({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(de(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let i=this.map.get(t.param)||[];const r=i.indexOf(de(t.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(t.param,i):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class Fe{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function We(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function Xe(n){return typeof Blob<"u"&&n instanceof Blob}function ut(n){return typeof FormData<"u"&&n instanceof FormData}class At{constructor(t,e,i,r){let a;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function Ye(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,a=r):a=i,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params)),this.headers||(this.headers=new $),this.context||(this.context=new Fe),this.params){const g=this.params.toString();if(0===g.length)this.urlWithParams=e;else{const E=e.indexOf("?");this.urlWithParams=e+(-1===E?"?":E<e.length-1?"&":"")+g}}else this.params=new Oe,this.urlWithParams=e}serializeBody(){return null===this.body?null:We(this.body)||Xe(this.body)||ut(this.body)||function Et(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Oe?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||ut(this.body)?null:Xe(this.body)?this.body.type||null:We(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Oe?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,i=t.url||this.url,r=t.responseType||this.responseType,a=void 0!==t.body?t.body:this.body,g=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,E=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let O=t.headers||this.headers,j=t.params||this.params;const Y=t.context??this.context;return void 0!==t.setHeaders&&(O=Object.keys(t.setHeaders).reduce((se,be)=>se.set(be,t.setHeaders[be]),O)),t.setParams&&(j=Object.keys(t.setParams).reduce((se,be)=>se.set(be,t.setParams[be]),j)),new At(e,i,a,{params:j,headers:O,context:Y,reportProgress:E,responseType:r,withCredentials:g})}}var on=(()=>((on=on||{})[on.Sent=0]="Sent",on[on.UploadProgress=1]="UploadProgress",on[on.ResponseHeader=2]="ResponseHeader",on[on.DownloadProgress=3]="DownloadProgress",on[on.Response=4]="Response",on[on.User=5]="User",on))();class wt{constructor(t,e=200,i="OK"){this.headers=t.headers||new $,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||i,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class qt extends wt{constructor(t={}){super(t),this.type=on.ResponseHeader}clone(t={}){return new qt({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Nt extends wt{constructor(t={}){super(t),this.type=on.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new Nt({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class sn extends wt{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function Tt(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let yt=(()=>{class n{constructor(e){this.handler=e}request(e,i,r={}){let a;if(e instanceof At)a=e;else{let O,j;O=r.headers instanceof $?r.headers:new $(r.headers),r.params&&(j=r.params instanceof Oe?r.params:new Oe({fromObject:r.params})),a=new At(e,i,void 0!==r.body?r.body:null,{headers:O,context:r.context,params:j,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const g=qn(a).pipe(T(O=>this.handler.handle(O)));if(e instanceof At||"events"===r.observe)return g;const E=g.pipe(I(O=>O instanceof Nt));switch(r.observe||"body"){case"body":switch(a.responseType){case"arraybuffer":return E.pipe((0,M.U)(O=>{if(null!==O.body&&!(O.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return O.body}));case"blob":return E.pipe((0,M.U)(O=>{if(null!==O.body&&!(O.body instanceof Blob))throw new Error("Response is not a Blob.");return O.body}));case"text":return E.pipe((0,M.U)(O=>{if(null!==O.body&&"string"!=typeof O.body)throw new Error("Response is not a string.");return O.body}));default:return E.pipe((0,M.U)(O=>O.body))}case"response":return E;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(e,i={}){return this.request("DELETE",e,i)}get(e,i={}){return this.request("GET",e,i)}head(e,i={}){return this.request("HEAD",e,i)}jsonp(e,i){return this.request("JSONP",e,{params:(new Oe).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,i={}){return this.request("OPTIONS",e,i)}patch(e,i,r={}){return this.request("PATCH",e,Tt(r,i))}post(e,i,r={}){return this.request("POST",e,Tt(r,i))}put(e,i,r={}){return this.request("PUT",e,Tt(r,i))}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(z))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();function Pt(n,t){return t(n)}function tn(n,t){return(e,i)=>t.intercept(e,{handle:r=>n(r,i)})}const $n=new o.OlP("HTTP_INTERCEPTORS"),ki=new o.OlP("HTTP_INTERCEPTOR_FNS");function Gn(){let n=null;return(t,e)=>(null===n&&(n=((0,o.f3M)($n,{optional:!0})??[]).reduceRight(tn,Pt)),n(t,e))}let On=(()=>{class n extends z{constructor(e,i){super(),this.backend=e,this.injector=i,this.chain=null}handle(e){if(null===this.chain){const i=Array.from(new Set(this.injector.get(ki)));this.chain=i.reduceRight((r,a)=>function hn(n,t,e){return(i,r)=>e.runInContext(()=>t(i,a=>n(a,r)))}(r,a,this.injector),Pt)}return this.chain(e,i=>this.backend.handle(i))}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(G),o.LFG(o.lqb))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();const eo=/^\)\]\}',?\n/;let gr=(()=>{class n{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new w.y(i=>{const r=this.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach((Me,Ge)=>r.setRequestHeader(Me,Ge.join(","))),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const Me=e.detectContentTypeHeader();null!==Me&&r.setRequestHeader("Content-Type",Me)}if(e.responseType){const Me=e.responseType.toLowerCase();r.responseType="json"!==Me?Me:"text"}const a=e.serializeBody();let g=null;const E=()=>{if(null!==g)return g;const Me=r.statusText||"OK",Ge=new $(r.getAllResponseHeaders()),_t=function hr(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(r)||e.url;return g=new qt({headers:Ge,status:r.status,statusText:Me,url:_t}),g},O=()=>{let{headers:Me,status:Ge,statusText:_t,url:Dt}=E(),_n=null;204!==Ge&&(_n=typeof r.response>"u"?r.responseText:r.response),0===Ge&&(Ge=_n?200:0);let Ln=Ge>=200&&Ge<300;if("json"===e.responseType&&"string"==typeof _n){const Bn=_n;_n=_n.replace(eo,"");try{_n=""!==_n?JSON.parse(_n):null}catch(Un){_n=Bn,Ln&&(Ln=!1,_n={error:Un,text:_n})}}Ln?(i.next(new Nt({body:_n,headers:Me,status:Ge,statusText:_t,url:Dt||void 0})),i.complete()):i.error(new sn({error:_n,headers:Me,status:Ge,statusText:_t,url:Dt||void 0}))},j=Me=>{const{url:Ge}=E(),_t=new sn({error:Me,status:r.status||0,statusText:r.statusText||"Unknown Error",url:Ge||void 0});i.error(_t)};let Y=!1;const se=Me=>{Y||(i.next(E()),Y=!0);let Ge={type:on.DownloadProgress,loaded:Me.loaded};Me.lengthComputable&&(Ge.total=Me.total),"text"===e.responseType&&r.responseText&&(Ge.partialText=r.responseText),i.next(Ge)},be=Me=>{let Ge={type:on.UploadProgress,loaded:Me.loaded};Me.lengthComputable&&(Ge.total=Me.total),i.next(Ge)};return r.addEventListener("load",O),r.addEventListener("error",j),r.addEventListener("timeout",j),r.addEventListener("abort",j),e.reportProgress&&(r.addEventListener("progress",se),null!==a&&r.upload&&r.upload.addEventListener("progress",be)),r.send(a),i.next({type:on.Sent}),()=>{r.removeEventListener("error",j),r.removeEventListener("abort",j),r.removeEventListener("load",O),r.removeEventListener("timeout",j),e.reportProgress&&(r.removeEventListener("progress",se),null!==a&&r.upload&&r.upload.removeEventListener("progress",be)),r.readyState!==r.DONE&&r.abort()}})}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(Zl))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();const Lo=new o.OlP("XSRF_ENABLED"),aa="XSRF-TOKEN",Fr=new o.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>aa}),Fs="X-XSRF-TOKEN",Ns=new o.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>Fs});class gu{}let Ih=(()=>{class n{constructor(e,i,r){this.doc=e,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Sr(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(y),o.LFG(o.Lbi),o.LFG(Fr))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();function Ba(n,t){const e=n.url.toLowerCase();if(!(0,o.f3M)(Lo)||"GET"===n.method||"HEAD"===n.method||e.startsWith("http://")||e.startsWith("https://"))return t(n);const i=(0,o.f3M)(gu).getToken(),r=(0,o.f3M)(Ns);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),t(n)}var to=(()=>((to=to||{})[to.Interceptors=0]="Interceptors",to[to.LegacyInterceptors=1]="LegacyInterceptors",to[to.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",to[to.NoXsrfProtection=3]="NoXsrfProtection",to[to.JsonpSupport=4]="JsonpSupport",to[to.RequestsMadeViaParent=5]="RequestsMadeViaParent",to))();function yo(n,t){return{\u0275kind:n,\u0275providers:t}}function sc(...n){const t=[yt,gr,On,{provide:z,useExisting:On},{provide:G,useExisting:gr},{provide:ki,useValue:Ba,multi:!0},{provide:Lo,useValue:!0},{provide:gu,useClass:Ih}];for(const e of n)t.push(...e.\u0275providers);return(0,o.MR2)(t)}const Rf=new o.OlP("LEGACY_INTERCEPTOR_FN");function Bp({cookieName:n,headerName:t}){const e=[];return void 0!==n&&e.push({provide:Fr,useValue:n}),void 0!==t&&e.push({provide:Ns,useValue:t}),yo(to.CustomXsrfConfiguration,e)}let Z=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({providers:[sc(yo(to.LegacyInterceptors,[{provide:Rf,useFactory:Gn},{provide:ki,useExisting:Rf,multi:!0}]),Bp({cookieName:aa,headerName:Fs}))]}),n})();const{isArray:J}=Array,{getPrototypeOf:me,prototype:ke,keys:Mt}=Object;function mn(n){if(1===n.length){const t=n[0];if(J(t))return{args:t,keys:null};if(function ei(n){return n&&"object"==typeof n&&me(n)===ke}(t)){const e=Mt(t);return{args:e.map(i=>t[i]),keys:e}}}return{args:n,keys:null}}var oi=Ee(8421);const{isArray:dr}=Array;function Ia(n){return(0,M.U)(t=>function rs(n,t){return dr(t)?n(...t):n(t)}(n,t))}function jc(n,t){return n.reduce((e,i,r)=>(e[i]=t[r],e),{})}let _u=(()=>{class n{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.Qsj),o.Y36(o.SBq))},n.\u0275dir=o.lG2({type:n}),n})(),la=(()=>{class n extends _u{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=o.n5z(n)))(i||n)}}(),n.\u0275dir=o.lG2({type:n,features:[o.qOj]}),n})();const xs=new o.OlP("NgValueAccessor"),uy={provide:xs,useExisting:(0,o.Gpc)(()=>Vp),multi:!0},Wg=new o.OlP("CompositionEventMode");let Vp=(()=>{class n extends _u{constructor(e,i,r){super(e,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function hy(){const n=ct()?ct().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.Qsj),o.Y36(o.SBq),o.Y36(Wg,8))},n.\u0275dir=o.lG2({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,i){1&e&&o.NdJ("input",function(a){return i._handleInput(a.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(a){return i._compositionEnd(a.target.value)})},features:[o._Bn([uy]),o.qOj]}),n})();const $o=new o.OlP("NgValidators"),Al=new o.OlP("NgAsyncValidators");function Cs(n){return null!=n}function Ci(n){return(0,o.QGY)(n)?(0,Qr.D)(n):n}function _d(n){let t={};return n.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function Em(n,t){return t.map(e=>e(n))}function py(n){return n.map(t=>function Ml(n){return!n.validate}(t)?t:e=>t.validate(e))}function kl(n){return null!=n?function Tm(n){if(!n)return null;const t=n.filter(Cs);return 0==t.length?null:function(e){return _d(Em(e,t))}}(py(n)):null}function Dh(n){return null!=n?function Zg(n){if(!n)return null;const t=n.filter(Cs);return 0==t.length?null:function(e){return function ep(...n){const t=(0,Oo.jO)(n),{args:e,keys:i}=mn(n),r=new w.y(a=>{const{length:g}=e;if(!g)return void a.complete();const E=new Array(g);let O=g,j=g;for(let Y=0;Y<g;Y++){let se=!1;(0,oi.Xf)(e[Y]).subscribe((0,P.x)(a,be=>{se||(se=!0,j--),E[Y]=be},()=>O--,void 0,()=>{(!O||!se)&&(j||a.next(i?jc(i,E):E),a.complete())}))}});return t?r.pipe(Ia(t)):r}(Em(e,t).map(Ci)).pipe((0,M.U)(_d))}}(py(n)):null}function Hp(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function Sm(n){return n?Array.isArray(n)?n:[n]:[]}function Im(n,t){return Array.isArray(n)?n.includes(t):n===t}function f0(n,t){const e=Sm(t);return Sm(n).forEach(r=>{Im(e,r)||e.push(r)}),e}function Fw(n,t){return Sm(t).filter(e=>!Im(n,e))}class fy{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=kl(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=Dh(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class sl extends fy{get formDirective(){return null}get path(){return null}}class vu extends fy{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class vd{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let my=(()=>{class n extends vd{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(vu,2))},n.\u0275dir=o.lG2({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,i){2&e&&o.ekj("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[o.qOj]}),n})();const Am="VALID",g0="INVALID",Jg="PENDING",Qg="DISABLED";function km(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class wd{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===Am}get invalid(){return this.status===g0}get pending(){return this.status==Jg}get disabled(){return this.status===Qg}get enabled(){return this.status!==Qg}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(f0(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(f0(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(Fw(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(Fw(t,this._rawAsyncValidators))}hasValidator(t){return Im(this._rawValidators,t)}hasAsyncValidator(t){return Im(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=Jg,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Qg,this.errors=null,this._forEachChild(i=>{i.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Am,this._forEachChild(i=>{i.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Am||this.status===Jg)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Qg:Am}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=Jg,this._hasOwnPendingAsyncValidator=!0;const e=Ci(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((i,r)=>i&&i._find(r),this)}getError(t,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new o.vpe,this.statusChanges=new o.vpe}_calculateStatus(){return this._allControlsDisabled()?Qg:this.errors?g0:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Jg)?Jg:this._anyControlsHaveStatus(g0)?g0:Am}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){km(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=function gy(n){return Array.isArray(n)?kl(n):n||null}(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=function y0(n){return Array.isArray(n)?Dh(n):n||null}(this._rawAsyncValidators)}}const Xg=new o.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>Uw}),Uw="always";function Pl(n,t,e=Uw){(function vy(n,t){const e=function yd(n){return n._rawValidators}(n);null!==t.validator?n.setValidators(Hp(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const i=function jp(n){return n._rawAsyncValidators}(n);null!==t.asyncValidator?n.setAsyncValidators(Hp(i,t.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();yy(t._rawValidators,r),yy(t._rawAsyncValidators,r)})(n,t),t.valueAccessor.writeValue(n.value),(n.disabled||"always"===e)&&t.valueAccessor.setDisabledState?.(n.disabled),function v0(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&zf(n,t)})}(n,t),function Pm(n,t){const e=(i,r)=>{t.valueAccessor.writeValue(i),r&&t.viewToModelUpdate(i)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function Rm(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&zf(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function lE(n,t){if(t.valueAccessor.setDisabledState){const e=i=>{t.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function yy(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function zf(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function cc(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}function Gc(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const uc=class extends wd{constructor(t=null,e,i){super(function _0(n){return(km(n)?n.validators:n)||null}(e),function Mm(n,t){return(km(t)?t.asyncValidators:n)||null}(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),km(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=Gc(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){cc(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){cc(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){Gc(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}},S0={provide:vu,useExisting:(0,o.Gpc)(()=>Bm)},n_=(()=>Promise.resolve())();let Bm=(()=>{class n extends vu{constructor(e,i,r,a,g,E){super(),this._changeDetectorRef=g,this.callSetDisabledState=E,this.control=new uc,this._registered=!1,this.update=new o.vpe,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function x0(n,t){if(!t)return null;let e,i,r;return Array.isArray(t),t.forEach(a=>{a.constructor===Vp?e=a:function w0(n){return Object.getPrototypeOf(n.constructor)===la}(a)?i=a:r=a}),r||i||e||null}(0,a)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function Fm(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Pl(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){n_.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,r=0!==i&&(0,o.D6c)(i);n_.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?function e_(n,t){return[...t.path,n]}(e,this._parent):[e]}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(sl,9),o.Y36($o,10),o.Y36(Al,10),o.Y36(xs,10),o.Y36(o.sBO,8),o.Y36(Xg,8))},n.\u0275dir=o.lG2({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[o._Bn([S0]),o.qOj,o.TTD]}),n})(),I0=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({}),n})(),Js=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[I0]}),n})(),Uf=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:Xg,useValue:e.callSetDisabledState??Uw}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[Js]}),n})();class tx{}class nx{}const xu="*";function l_(n,t){return{type:7,name:n,definitions:t,options:{}}}function ih(n,t=null){return{type:4,styles:t,timings:n}}function Dy(n,t=null){return{type:2,steps:n,options:t}}function Ti(n){return{type:6,styles:n,offset:null}}function c_(n,t,e){return{type:0,name:n,styles:t,options:e}}function Ph(n,t,e=null){return{type:1,expr:n,animation:t,options:e}}function Ay(n,t=null){return{type:8,animation:n,options:t}}function u_(n,t=null){return{type:10,animation:n,options:t}}function ix(n){Promise.resolve().then(n)}class Wm{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){ix(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class Zm{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,i=0,r=0;const a=this.players.length;0==a?ix(()=>this._onFinish()):this.players.forEach(g=>{g.onDone(()=>{++e==a&&this._onFinish()}),g.onDestroy(()=>{++i==a&&this._onDestroy()}),g.onStart(()=>{++r==a&&this._onStart()})}),this.totalTime=this.players.reduce((g,E)=>Math.max(g,E.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(r)})}getPosition(){const t=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}function Yp(n){return new o.vHH(3e3,!1)}function SE(){return typeof window<"u"&&typeof window.document<"u"}function Ym(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function Cu(n){switch(n.length){case 0:return new Wm;case 1:return n[0];default:return new Zm(n)}}function Gf(n,t,e,i,r=new Map,a=new Map){const g=[],E=[];let O=-1,j=null;if(i.forEach(Y=>{const se=Y.get("offset"),be=se==O,Me=be&&j||new Map;Y.forEach((Ge,_t)=>{let Dt=_t,_n=Ge;if("offset"!==_t)switch(Dt=t.normalizePropertyName(Dt,g),_n){case"!":_n=r.get(_t);break;case xu:_n=a.get(_t);break;default:_n=t.normalizeStyleValue(_t,Dt,_n,g)}Me.set(Dt,_n)}),be||E.push(Me),j=Me,O=se}),g.length)throw function EE(n){return new o.vHH(3502,!1)}();return E}function $f(n,t,e,i){switch(t){case"start":n.onStart(()=>i(e&&Jm(e,"start",n)));break;case"done":n.onDone(()=>i(e&&Jm(e,"done",n)));break;case"destroy":n.onDestroy(()=>i(e&&Jm(e,"destroy",n)))}}function Jm(n,t,e){const a=Wf(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,e.totalTime??n.totalTime,!!e.disabled),g=n._data;return null!=g&&(a._data=g),a}function Wf(n,t,e,i,r="",a=0,g){return{element:n,triggerName:t,fromState:e,toState:i,phaseName:r,totalTime:a,disabled:!!g}}function pc(n,t,e){let i=n.get(t);return i||n.set(t,i=e),i}function Ny(n){const t=n.indexOf(":");return[n.substring(1,t),n.slice(t+1)]}let p_=(n,t)=>!1,zy=(n,t,e)=>[],G0=null;function f_(n){const t=n.parentNode||n.host;return t===G0?null:t}(Ym()||typeof Element<"u")&&(SE()?(G0=(()=>document.documentElement)(),p_=(n,t)=>{for(;t;){if(t===n)return!0;t=f_(t)}return!1}):p_=(n,t)=>n.contains(t),zy=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const i=n.querySelector(t);return i?[i]:[]});let ps=null,Oh=!1;const mx=p_,Wc=zy;let gx=(()=>{class n{validateStyleProperty(e){return function By(n){ps||(ps=function Qm(){return typeof document<"u"?document.body:null}()||{},Oh=!!ps.style&&"WebkitAppearance"in ps.style);let t=!0;return ps.style&&!function DE(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in ps.style,!t&&Oh&&(t="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in ps.style)),t}(e)}matchesElement(e,i){return!1}containsElement(e,i){return mx(e,i)}getParentElement(e){return f_(e)}query(e,i,r){return Wc(e,i,r)}computeStyle(e,i,r){return r||""}animate(e,i,r,a,g,E=[],O){return new Wm(r,a)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})(),_x=(()=>{class n{}return n.NOOP=new gx,n})();const no="ng-enter",Xm="ng-leave",eg="ng-trigger",g_=".ng-trigger",Sd="ng-animating",Id=".ng-animating";function Dd(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:$0(parseFloat(t[1]),t[2])}function $0(n,t){return"s"===t?1e3*n:n}function Hy(n,t,e){return n.hasOwnProperty("duration")?n:function AE(n,t,e){let r,a=0,g="";if("string"==typeof n){const E=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===E)return t.push(Yp()),{duration:0,delay:0,easing:""};r=$0(parseFloat(E[1]),E[2]);const O=E[3];null!=O&&(a=$0(parseFloat(O),E[4]));const j=E[5];j&&(g=j)}else r=n;if(!e){let E=!1,O=t.length;r<0&&(t.push(function rx(){return new o.vHH(3100,!1)}()),E=!0),a<0&&(t.push(function Ry(){return new o.vHH(3101,!1)}()),E=!0),E&&t.splice(O,0,Yp())}return{duration:r,delay:a,easing:g}}(n,t,e)}function __(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function Lh(n){const t=new Map;return Object.keys(n).forEach(e=>{t.set(e,n[e])}),t}function Jp(n,t=new Map,e){if(e)for(let[i,r]of e)t.set(i,r);for(let[i,r]of n)t.set(i,r);return t}function Z0(n,t,e){return e?t+":"+e+";":""}function y_(n){let t="";for(let e=0;e<n.style.length;e++){const i=n.style.item(e);t+=Z0(0,i,n.style.getPropertyValue(i))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=Z0(0,v_(e),n.style[e]));n.setAttribute("style",t)}function fc(n,t,e){n.style&&(t.forEach((i,r)=>{const a=ap(r);e&&!e.has(r)&&e.set(r,n.style[a]),n.style[a]=i}),Ym()&&y_(n))}function Qp(n,t){n.style&&(t.forEach((e,i)=>{const r=ap(i);n.style[r]=""}),Ym()&&y_(n))}function qf(n){return Array.isArray(n)?1==n.length?n[0]:Dy(n):n}const q0=new RegExp("{{\\s*(.+?)\\s*}}","g");function Kf(n){let t=[];if("string"==typeof n){let e;for(;e=q0.exec(n);)t.push(e[1]);q0.lastIndex=0}return t}function sp(n,t,e){const i=n.toString(),r=i.replace(q0,(a,g)=>{let E=t[g];return null==E&&(e.push(function xE(n){return new o.vHH(3003,!1)}()),E=""),E.toString()});return r==i?n:r}function Xp(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const rh=/-+([a-z0-9])/g;function ap(n){return n.replace(rh,(...t)=>t[1].toUpperCase())}function v_(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Zc(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function xD(n){return new o.vHH(3004,!1)}()}}function Gy(n,t){return window.getComputedStyle(n)[t]}function lp(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function bx(n,t,e){if(":"==n[0]){const O=function ng(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return t.push(function ux(n){return new o.vHH(3016,!1)}()),"* => *"}}(n,e);if("function"==typeof O)return void t.push(O);n=O}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function cx(n){return new o.vHH(3015,!1)}()),t;const r=i[1],a=i[2],g=i[3];t.push(wx(r,g));"<"==a[0]&&!("*"==r&&"*"==g)&&t.push(wx(g,r))}(i,e,t)):e.push(n),e}const C_=new Set(["true","1"]),$y=new Set(["false","0"]);function wx(n,t){const e=C_.has(n)||$y.has(n),i=C_.has(t)||$y.has(t);return(r,a)=>{let g="*"==n||n==r,E="*"==t||t==a;return!g&&e&&"boolean"==typeof r&&(g=r?C_.has(n):$y.has(n)),!E&&i&&"boolean"==typeof a&&(E=a?C_.has(t):$y.has(t)),g&&E}}const Cx=new RegExp("s*:selfs*,?","g");function Wy(n,t,e,i){return new Ex(n).build(t,e,i)}class Ex{constructor(t){this._driver=t}build(t,e,i){const r=new ef(e);return this._resetContextStyleTimingState(r),Zc(this,qf(t),r)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let i=e.queryCount=0,r=e.depCount=0;const a=[],g=[];return"@"==t.name.charAt(0)&&e.errors.push(function V0(){return new o.vHH(3006,!1)}()),t.definitions.forEach(E=>{if(this._resetContextStyleTimingState(e),0==E.type){const O=E,j=O.name;j.toString().split(/\s*,\s*/).forEach(Y=>{O.name=Y,a.push(this.visitState(O,e))}),O.name=j}else if(1==E.type){const O=this.visitTransition(E,e);i+=O.queryCount,r+=O.depCount,g.push(O)}else e.errors.push(function Py(){return new o.vHH(3007,!1)}())}),{type:7,name:t.name,states:a,transitions:g,queryCount:i,depCount:r,options:null}}visitState(t,e){const i=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(i.containsDynamicStyles){const a=new Set,g=r||{};i.styles.forEach(E=>{E instanceof Map&&E.forEach(O=>{Kf(O).forEach(j=>{g.hasOwnProperty(j)||a.add(j)})})}),a.size&&(Xp(a.values()),e.errors.push(function sx(n,t){return new o.vHH(3008,!1)}()))}return{type:0,name:t.name,style:i,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const i=Zc(this,qf(t.animation),e);return{type:1,matchers:lp(t.expr,e.errors),animation:i,queryCount:e.queryCount,depCount:e.depCount,options:tf(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(i=>Zc(this,i,e)),options:tf(t.options)}}visitGroup(t,e){const i=e.currentTime;let r=0;const a=t.steps.map(g=>{e.currentTime=i;const E=Zc(this,g,e);return r=Math.max(r,e.currentTime),E});return e.currentTime=r,{type:3,steps:a,options:tf(t.options)}}visitAnimate(t,e){const i=function rg(n,t){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return og(Hy(n,t).duration,0,"");const e=n;if(e.split(/\s+/).some(a=>"{"==a.charAt(0)&&"{"==a.charAt(1))){const a=og(0,0,"");return a.dynamic=!0,a.strValue=e,a}const r=Hy(e,t);return og(r.duration,r.delay,r.easing)}(t.timings,e.errors);e.currentAnimateTimings=i;let r,a=t.styles?t.styles:Ti({});if(5==a.type)r=this.visitKeyframes(a,e);else{let g=t.styles,E=!1;if(!g){E=!0;const j={};i.easing&&(j.easing=i.easing),g=Ti(j)}e.currentTime+=i.duration+i.delay;const O=this.visitStyle(g,e);O.isEmptyStep=E,r=O}return e.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(t,e){const i=this._makeStyleAst(t,e);return this._validateStyleAst(i,e),i}_makeStyleAst(t,e){const i=[],r=Array.isArray(t.styles)?t.styles:[t.styles];for(let E of r)"string"==typeof E?E===xu?i.push(E):e.errors.push(new o.vHH(3002,!1)):i.push(Lh(E));let a=!1,g=null;return i.forEach(E=>{if(E instanceof Map&&(E.has("easing")&&(g=E.get("easing"),E.delete("easing")),!a))for(let O of E.values())if(O.toString().indexOf("{{")>=0){a=!0;break}}),{type:6,styles:i,easing:g,offset:t.offset,containsDynamicStyles:a,options:null}}_validateStyleAst(t,e){const i=e.currentAnimateTimings;let r=e.currentTime,a=e.currentTime;i&&a>0&&(a-=i.duration+i.delay),t.styles.forEach(g=>{"string"!=typeof g&&g.forEach((E,O)=>{const j=e.collectedStyles.get(e.currentQuerySelector),Y=j.get(O);let se=!0;Y&&(a!=r&&a>=Y.startTime&&r<=Y.endTime&&(e.errors.push(function Td(n,t,e,i,r){return new o.vHH(3010,!1)}()),se=!1),a=Y.startTime),se&&j.set(O,{startTime:a,endTime:r}),e.options&&function ME(n,t,e){const i=t.params||{},r=Kf(n);r.length&&r.forEach(a=>{i.hasOwnProperty(a)||e.push(function B0(n){return new o.vHH(3001,!1)}())})}(E,e.options,e.errors)})})}visitKeyframes(t,e){const i={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function ax(){return new o.vHH(3011,!1)}()),i;let a=0;const g=[];let E=!1,O=!1,j=0;const Y=t.steps.map(_n=>{const Ln=this._makeStyleAst(_n,e);let Bn=null!=Ln.offset?Ln.offset:function Sx(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){const i=e;t=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const e=n;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(Ln.styles),Un=0;return null!=Bn&&(a++,Un=Ln.offset=Bn),O=O||Un<0||Un>1,E=E||Un<j,j=Un,g.push(Un),Ln});O&&e.errors.push(function qm(){return new o.vHH(3012,!1)}()),E&&e.errors.push(function h_(){return new o.vHH(3200,!1)}());const se=t.steps.length;let be=0;a>0&&a<se?e.errors.push(function CE(){return new o.vHH(3202,!1)}()):0==a&&(be=1/(se-1));const Me=se-1,Ge=e.currentTime,_t=e.currentAnimateTimings,Dt=_t.duration;return Y.forEach((_n,Ln)=>{const Bn=be>0?Ln==Me?1:be*Ln:g[Ln],Un=Bn*Dt;e.currentTime=Ge+_t.delay+Un,_t.duration=Un,this._validateStyleAst(_n,e),_n.offset=Bn,i.styles.push(_n)}),i}visitReference(t,e){return{type:8,animation:Zc(this,qf(t.animation),e),options:tf(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:tf(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:tf(t.options)}}visitQuery(t,e){const i=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[a,g]=function Tx(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(Cx,"")),n=n.replace(/@\*/g,g_).replace(/@\w+/g,e=>g_+"-"+e.slice(1)).replace(/:animating/g,Id),[n,t]}(t.selector);e.currentQuerySelector=i.length?i+" "+a:a,pc(e.collectedStyles,e.currentQuerySelector,new Map);const E=Zc(this,qf(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:11,selector:a,limit:r.limit||0,optional:!!r.optional,includeSelf:g,animation:E,originalSelector:t.selector,options:tf(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function U0(){return new o.vHH(3013,!1)}());const i="full"===t.timings?{duration:0,delay:0,easing:"full"}:Hy(t.timings,e.errors,!0);return{type:12,animation:Zc(this,qf(t.animation),e),timings:i,options:null}}}class ef{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function tf(n){return n?(n=__(n)).params&&(n.params=function Zy(n){return n?__(n):null}(n.params)):n={},n}function og(n,t,e){return{duration:n,delay:t,easing:e}}function sg(n,t,e,i,r,a,g=null,E=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:i,duration:r,delay:a,totalTime:r+a,easing:g,subTimeline:E}}class qy{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let i=this._map.get(t);i||this._map.set(t,i=[]),i.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const LE=new RegExp(":enter","g"),Qf=new RegExp(":leave","g");function E_(n,t,e,i,r,a=new Map,g=new Map,E,O,j=[]){return(new TD).buildKeyframes(n,t,e,i,r,a,g,E,O,j)}class TD{buildKeyframes(t,e,i,r,a,g,E,O,j,Y=[]){j=j||new qy;const se=new lg(t,e,j,r,a,Y,[]);se.options=O;const be=O.delay?Dd(O.delay):0;se.currentTimeline.delayNextStep(be),se.currentTimeline.setStyles([g],null,se.errors,O),Zc(this,i,se);const Me=se.timelines.filter(Ge=>Ge.containsAnimation());if(Me.length&&E.size){let Ge;for(let _t=Me.length-1;_t>=0;_t--){const Dt=Me[_t];if(Dt.element===e){Ge=Dt;break}}Ge&&!Ge.allowOnlyTimelineStyles()&&Ge.setStyles([E],null,se.errors,O)}return Me.length?Me.map(Ge=>Ge.buildKeyframes()):[sg(e,[],[],[],0,be,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const i=e.subInstructions.get(e.element);if(i){const r=e.createSubContext(t.options),a=e.currentTimeline.currentTime,g=this._visitSubInstructions(i,r,r.options);a!=g&&e.transformIntoNewTimeline(g)}e.previousNode=t}visitAnimateRef(t,e){const i=e.createSubContext(t.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,i),this.visitReference(t.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,i){for(const r of t){const a=r?.delay;if(a){const g="number"==typeof a?a:Dd(sp(a,r?.params??{},e.errors));i.delayNextStep(g)}}}_visitSubInstructions(t,e,i){let a=e.currentTimeline.currentTime;const g=null!=i.duration?Dd(i.duration):null,E=null!=i.delay?Dd(i.delay):null;return 0!==g&&t.forEach(O=>{const j=e.appendInstructionToTimeline(O,g,E);a=Math.max(a,j.duration+j.delay)}),a}visitReference(t,e){e.updateOptions(t.options,!0),Zc(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const i=e.subContextCount;let r=e;const a=t.options;if(a&&(a.params||a.delay)&&(r=e.createSubContext(a),r.transformIntoNewTimeline(),null!=a.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=ag);const g=Dd(a.delay);r.delayNextStep(g)}t.steps.length&&(t.steps.forEach(g=>Zc(this,g,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const i=[];let r=e.currentTimeline.currentTime;const a=t.options&&t.options.delay?Dd(t.options.delay):0;t.steps.forEach(g=>{const E=e.createSubContext(t.options);a&&E.delayNextStep(a),Zc(this,g,E),r=Math.max(r,E.currentTimeline.currentTime),i.push(E.currentTimeline)}),i.forEach(g=>e.currentTimeline.mergeTimelineCollectedStyles(g)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const i=t.strValue;return Hy(e.params?sp(i,e.params,e.errors):i,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const i=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),r.snapshotCurrentStyles());const a=t.style;5==a.type?this.visitKeyframes(a,e):(e.incrementTime(i.duration),this.visitStyle(a,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const i=e.currentTimeline,r=e.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const a=r&&r.easing||t.easing;t.isEmptyStep?i.applyEmptyStep(a):i.setStyles(t.styles,a,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const i=e.currentAnimateTimings,r=e.currentTimeline.duration,a=i.duration,E=e.createSubContext().currentTimeline;E.easing=i.easing,t.styles.forEach(O=>{E.forwardTime((O.offset||0)*a),E.setStyles(O.styles,O.easing,e.errors,e.options),E.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(E),e.transformIntoNewTimeline(r+a),e.previousNode=t}visitQuery(t,e){const i=e.currentTimeline.currentTime,r=t.options||{},a=r.delay?Dd(r.delay):0;a&&(6===e.previousNode.type||0==i&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=ag);let g=i;const E=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=E.length;let O=null;E.forEach((j,Y)=>{e.currentQueryIndex=Y;const se=e.createSubContext(t.options,j);a&&se.delayNextStep(a),j===e.element&&(O=se.currentTimeline),Zc(this,t.animation,se),se.currentTimeline.applyStylesToKeyframe(),g=Math.max(g,se.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(g),O&&(e.currentTimeline.mergeTimelineCollectedStyles(O),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const i=e.parentContext,r=e.currentTimeline,a=t.timings,g=Math.abs(a.duration),E=g*(e.currentQueryTotal-1);let O=g*e.currentQueryIndex;switch(a.duration<0?"reverse":a.easing){case"reverse":O=E-O;break;case"full":O=i.currentStaggerTime}const Y=e.currentTimeline;O&&Y.delayNextStep(O);const se=Y.currentTime;Zc(this,t.animation,e),e.previousNode=t,i.currentStaggerTime=r.currentTime-se+(r.startTime-i.currentTimeline.startTime)}}const ag={};class lg{constructor(t,e,i,r,a,g,E,O){this._driver=t,this.element=e,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=a,this.errors=g,this.timelines=E,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=ag,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=O||new sh(this._driver,e,0),E.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const i=t;let r=this.options;null!=i.duration&&(r.duration=Dd(i.duration)),null!=i.delay&&(r.delay=Dd(i.delay));const a=i.params;if(a){let g=r.params;g||(g=this.options.params={}),Object.keys(a).forEach(E=>{(!e||!g.hasOwnProperty(E))&&(g[E]=sp(a[E],g,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const i=t.params={};Object.keys(e).forEach(r=>{i[r]=e[r]})}}return t}createSubContext(t=null,e,i){const r=e||this.element,a=new lg(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return a.previousNode=this.previousNode,a.currentAnimateTimings=this.currentAnimateTimings,a.options=this._copyOptions(),a.updateOptions(t),a.currentQueryIndex=this.currentQueryIndex,a.currentQueryTotal=this.currentQueryTotal,a.parentContext=this,this.subContextCount++,a}transformIntoNewTimeline(t){return this.previousNode=ag,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,i){const r={duration:e??t.duration,delay:this.currentTimeline.currentTime+(i??0)+t.delay,easing:""},a=new SD(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(a),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,i,r,a,g){let E=[];if(r&&E.push(this.element),t.length>0){t=(t=t.replace(LE,"."+this._enterClassName)).replace(Qf,"."+this._leaveClassName);let j=this._driver.query(this.element,t,1!=i);0!==i&&(j=i<0?j.slice(j.length+i,j.length):j.slice(0,i)),E.push(...j)}return!a&&0==E.length&&g.push(function lx(n){return new o.vHH(3014,!1)}()),E}}class sh{constructor(t,e,i,r){this._driver=t,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new sh(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,i]of this._globalTimelineStyles)this._backFill.set(e,i||xu),this._currentKeyframe.set(e,xu);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,i,r){e&&this._previousKeyframe.set("easing",e);const a=r&&r.params||{},g=function Dx(n,t){const e=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||t.keys();for(let a of i)e.set(a,xu)}else Jp(r,e)}),e}(t,this._globalTimelineStyles);for(let[E,O]of g){const j=sp(O,a,i);this._pendingStyles.set(E,j),this._localTimelineStyles.has(E)||this._backFill.set(E,this._globalTimelineStyles.get(E)??xu),this._updateStyle(E,j)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,i)=>{const r=this._styleSummary.get(i);(!r||e.time>r.time)&&this._updateStyle(i,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((E,O)=>{const j=Jp(E,new Map,this._backFill);j.forEach((Y,se)=>{"!"===Y?t.add(se):Y===xu&&e.add(se)}),i||j.set("offset",O/this.duration),r.push(j)});const a=t.size?Xp(t.values()):[],g=e.size?Xp(e.values()):[];if(i){const E=r[0],O=new Map(E);E.set("offset",0),O.set("offset",1),r=[E,O]}return sg(this.element,r,a,g,this.duration,this.startTime,this.easing,!1)}}class SD extends sh{constructor(t,e,i,r,a,g,E=!1){super(t,e,g.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=a,this._stretchStartingKeyframe=E,this.timings={duration:g.duration,delay:g.delay,easing:g.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const a=[],g=i+e,E=e/g,O=Jp(t[0]);O.set("offset",0),a.push(O);const j=Jp(t[0]);j.set("offset",ah(E)),a.push(j);const Y=t.length-1;for(let se=1;se<=Y;se++){let be=Jp(t[se]);const Me=be.get("offset");be.set("offset",ah((e+Me*i)/g)),a.push(be)}i=g,e=0,r="",t=a}return sg(this.element,t,this.preStyleProps,this.postStyleProps,i,e,r,!0)}}function ah(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class nf{}const Ad=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class cg extends nf{normalizePropertyName(t,e){return ap(t)}normalizeStyleValue(t,e,i,r){let a="";const g=i.toString().trim();if(Ad.has(e)&&0!==i&&"0"!==i)if("number"==typeof i)a="px";else{const E=i.match(/^[+-]?[\d\.]+([a-z]*)$/);E&&0==E[1].length&&r.push(function ox(n,t){return new o.vHH(3005,!1)}())}return g+a}}function Bs(n,t,e,i,r,a,g,E,O,j,Y,se,be){return{type:0,element:n,triggerName:t,isRemovalTransition:r,fromState:e,fromStyles:a,toState:i,toStyles:g,timelines:E,queriedElements:O,preStyleProps:j,postStyleProps:Y,totalTime:se,errors:be}}const cp={};class lh{constructor(t,e,i){this._triggerName=t,this.ast=e,this._stateStyles=i}match(t,e,i,r){return function Xf(n,t,e,i,r){return n.some(a=>a(t,e,i,r))}(this.ast.matchers,t,e,i,r)}buildStyles(t,e,i){let r=this._stateStyles.get("*");return void 0!==t&&(r=this._stateStyles.get(t?.toString())||r),r?r.buildStyles(e,i):new Map}build(t,e,i,r,a,g,E,O,j,Y){const se=[],be=this.ast.options&&this.ast.options.params||cp,Ge=this.buildStyles(i,E&&E.params||cp,se),_t=O&&O.params||cp,Dt=this.buildStyles(r,_t,se),_n=new Set,Ln=new Map,Bn=new Map,Un="void"===r,ii={params:Md(_t,be),delay:this.ast.options?.delay},si=Y?[]:E_(t,e,this.ast.animation,a,g,Ge,Dt,ii,j,se);let _r=0;if(si.forEach(ka=>{_r=Math.max(ka.duration+ka.delay,_r)}),se.length)return Bs(e,this._triggerName,i,r,Un,Ge,Dt,[],[],Ln,Bn,_r,se);si.forEach(ka=>{const Ou=ka.element,Zo=pc(Ln,Ou,new Set);ka.preStyleProps.forEach(No=>Zo.add(No));const xp=pc(Bn,Ou,new Set);ka.postStyleProps.forEach(No=>xp.add(No)),Ou!==e&&_n.add(Ou)});const Ds=Xp(_n.values());return Bs(e,this._triggerName,i,r,Un,Ge,Dt,si,Ds,Ln,Bn,_r)}}function Md(n,t){const e=__(t);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(e[i]=n[i]);return e}class kd{constructor(t,e,i){this.styles=t,this.defaultParams=e,this.normalizer=i}buildStyles(t,e){const i=new Map,r=__(this.defaultParams);return Object.keys(t).forEach(a=>{const g=t[a];null!==g&&(r[a]=g)}),this.styles.styles.forEach(a=>{"string"!=typeof a&&a.forEach((g,E)=>{g&&(g=sp(g,r,e));const O=this.normalizer.normalizePropertyName(E,e);g=this.normalizer.normalizeStyleValue(E,O,g,e),i.set(E,g)})}),i}}class up{constructor(t,e,i){this.name=t,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states=new Map,e.states.forEach(r=>{this.states.set(r.name,new kd(r.style,r.options&&r.options.params||{},i))}),em(this.states,"true","1"),em(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new lh(t,r,this.states))}),this.fallbackTransition=function ug(n,t,e){return new lh(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(g,E)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,i,r){return this.transitionFactories.find(g=>g.match(t,e,i,r))||null}matchStyles(t,e,i){return this.fallbackTransition.buildStyles(t,e,i)}}function em(n,t,e){n.has(t)?n.has(e)||n.set(e,n.get(t)):n.has(e)&&n.set(t,n.get(e))}const Nh=new qy;class hp{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const i=[],a=Wy(this._driver,e,i,[]);if(i.length)throw function H0(n){return new o.vHH(3503,!1)}();this._animations.set(t,a)}_buildPlayer(t,e,i){const r=t.element,a=Gf(0,this._normalizer,0,t.keyframes,e,i);return this._driver.animate(r,a,t.duration,t.delay,t.easing,[],!0)}create(t,e,i={}){const r=[],a=this._animations.get(t);let g;const E=new Map;if(a?(g=E_(this._driver,e,a,no,Xm,new Map,new Map,i,Nh,r),g.forEach(Y=>{const se=pc(E,Y.element,new Map);Y.postStyleProps.forEach(be=>se.set(be,null))})):(r.push(function d_(){return new o.vHH(3300,!1)}()),g=[]),r.length)throw function Ly(n){return new o.vHH(3504,!1)}();E.forEach((Y,se)=>{Y.forEach((be,Me)=>{Y.set(Me,this._driver.computeStyle(se,Me,xu))})});const j=Cu(g.map(Y=>{const se=E.get(Y.element);return this._buildPlayer(Y,new Map,se)}));return this._playersById.set(t,j),j.onDestroy(()=>this.destroy(t)),this.players.push(j),j}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function dc(n){return new o.vHH(3301,!1)}();return e}listen(t,e,i,r){const a=Wf(e,"","","");return $f(this._getPlayer(t),i,a,r),()=>{}}command(t,e,i,r){if("register"==i)return void this.register(t,r[0]);if("create"==i)return void this.create(t,e,r[0]||{});const a=this._getPlayer(t);switch(i){case"play":a.play();break;case"pause":a.pause();break;case"reset":a.reset();break;case"restart":a.restart();break;case"finish":a.finish();break;case"init":a.init();break;case"setPosition":a.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const tm="ng-animate-queued",T_="ng-animate-disabled",J0=[],Q0={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},X0={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Eu="__ng_removed";class eb{get params(){return this.options.params}constructor(t,e=""){this.namespaceId=e;const i=t&&t.hasOwnProperty("value");if(this.value=function sf(n){return n??null}(i?t.value:t),i){const a=__(t);delete a.value,this.options=a}else this.options={};this.options.params||(this.options.params={})}absorbOptions(t){const e=t.params;if(e){const i=this.options.params;Object.keys(e).forEach(r=>{null==i[r]&&(i[r]=e[r])})}}}const rf="void",nm=new eb(rf);class Ky{constructor(t,e,i){this.id=t,this.hostElement=e,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,mc(e,this._hostClassName)}listen(t,e,i,r){if(!this._triggers.has(e))throw function Hf(n,t){return new o.vHH(3302,!1)}();if(null==i||0==i.length)throw function Km(n){return new o.vHH(3303,!1)}();if(!function hg(n){return"start"==n||"done"==n}(i))throw function Fy(n,t){return new o.vHH(3400,!1)}();const a=pc(this._elementListeners,t,[]),g={name:e,phase:i,callback:r};a.push(g);const E=pc(this._engine.statesByElement,t,new Map);return E.has(e)||(mc(t,eg),mc(t,eg+"-"+e),E.set(e,nm)),()=>{this._engine.afterFlush(()=>{const O=a.indexOf(g);O>=0&&a.splice(O,1),this._triggers.has(e)||E.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function jf(n){return new o.vHH(3401,!1)}();return e}trigger(t,e,i,r=!0){const a=this._getTrigger(e),g=new im(this.id,e,t);let E=this._engine.statesByElement.get(t);E||(mc(t,eg),mc(t,eg+"-"+e),this._engine.statesByElement.set(t,E=new Map));let O=E.get(e);const j=new eb(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&O&&j.absorbOptions(O.options),E.set(e,j),O||(O=nm),j.value!==rf&&O.value===j.value){if(!function dg(n,t){const e=Object.keys(n),i=Object.keys(t);if(e.length!=i.length)return!1;for(let r=0;r<e.length;r++){const a=e[r];if(!t.hasOwnProperty(a)||n[a]!==t[a])return!1}return!0}(O.params,j.params)){const _t=[],Dt=a.matchStyles(O.value,O.params,_t),_n=a.matchStyles(j.value,j.params,_t);_t.length?this._engine.reportError(_t):this._engine.afterFlush(()=>{Qp(t,Dt),fc(t,_n)})}return}const be=pc(this._engine.playersByElement,t,[]);be.forEach(_t=>{_t.namespaceId==this.id&&_t.triggerName==e&&_t.queued&&_t.destroy()});let Me=a.matchTransition(O.value,j.value,t,j.params),Ge=!1;if(!Me){if(!r)return;Me=a.fallbackTransition,Ge=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:Me,fromState:O,toState:j,player:g,isFallbackTransition:Ge}),Ge||(mc(t,tm),g.onStart(()=>{af(t,tm)})),g.onDone(()=>{let _t=this.players.indexOf(g);_t>=0&&this.players.splice(_t,1);const Dt=this._engine.playersByElement.get(t);if(Dt){let _n=Dt.indexOf(g);_n>=0&&Dt.splice(_n,1)}}),this.players.push(g),be.push(g),g}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(r=>r.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const i=this._engine.driver.query(t,g_,!0);i.forEach(r=>{if(r[Eu])return;const a=this._engine.fetchNamespacesByElement(r);a.size?a.forEach(g=>g.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(t,e,i,r){const a=this._engine.statesByElement.get(t),g=new Map;if(a){const E=[];if(a.forEach((O,j)=>{if(g.set(j,O.value),this._triggers.has(j)){const Y=this.trigger(t,j,rf,r);Y&&E.push(Y)}}),E.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,g),i&&Cu(E).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),i=this._engine.statesByElement.get(t);if(e&&i){const r=new Set;e.forEach(a=>{const g=a.name;if(r.has(g))return;r.add(g);const O=this._triggers.get(g).fallbackTransition,j=i.get(g)||nm,Y=new eb(rf),se=new im(this.id,g,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:g,transition:O,fromState:j,toState:Y,player:se,isFallbackTransition:!0})})}}removeNode(t,e){const i=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(i.totalAnimations){const a=i.players.length?i.playersByQueriedElement.get(t):[];if(a&&a.length)r=!0;else{let g=t;for(;g=g.parentNode;)if(i.statesByElement.get(g)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)i.markElementAsRemoved(this.id,t,!1,e);else{const a=t[Eu];(!a||a===Q0)&&(i.afterFlush(()=>this.clearElementCache(t)),i.destroyInnerAnimations(t),i._onRemovalComplete(t,e))}}insertNode(t,e){mc(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const a=i.element,g=this._elementListeners.get(a);g&&g.forEach(E=>{if(E.name==i.triggerName){const O=Wf(a,i.triggerName,i.fromState.value,i.toState.value);O._data=t,$f(i.player,E.phase,O,E.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(i)}),this._queue=[],e.sort((i,r)=>{const a=i.transition.ast.depCount,g=r.transition.ast.depCount;return 0==a||0==g?a-g:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(i=>i.element===t)||e,e}}class Rx{_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}constructor(t,e,i){this.bodyNode=t,this.driver=e,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,a)=>{}}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&t.push(i)})}),t}createNamespace(t,e){const i=new Ky(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[t]=i}_balanceNamespaceList(t,e){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let g=!1,E=this.driver.getParentElement(e);for(;E;){const O=r.get(E);if(O){const j=i.indexOf(O);i.splice(j+1,0,t),g=!0;break}E=this.driver.getParentElement(E)}g||i.unshift(t)}else i.push(t);return r.set(e,t),t}register(t,e){let i=this._namespaceLookup[t];return i||(i=this.createNamespace(t,e)),i}registerTrigger(t,e,i){let r=this._namespaceLookup[t];r&&r.register(e,i)&&this.totalAnimations++}destroy(t,e){if(!t)return;const i=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[t];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,i=this.statesByElement.get(t);if(i)for(let r of i.values())if(r.namespaceId){const a=this._fetchNamespace(r.namespaceId);a&&e.add(a)}return e}trigger(t,e,i,r){if(rm(e)){const a=this._fetchNamespace(t);if(a)return a.trigger(e,i,r),!0}return!1}insertNode(t,e,i,r){if(!rm(e))return;const a=e[Eu];if(a&&a.setForRemoval){a.setForRemoval=!1,a.setForMove=!0;const g=this.collectedLeaveElements.indexOf(e);g>=0&&this.collectedLeaveElements.splice(g,1)}if(t){const g=this._fetchNamespace(t);g&&g.insertNode(e,i)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),mc(t,T_)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),af(t,T_))}removeNode(t,e,i,r){if(rm(e)){const a=t?this._fetchNamespace(t):null;if(a?a.removeNode(e,r):this.markElementAsRemoved(t,e,!1,r),i){const g=this.namespacesByHostElement.get(e);g&&g.id!==t&&g.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(t,e,i,r,a){this.collectedLeaveElements.push(e),e[Eu]={namespaceId:t,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:a}}listen(t,e,i,r,a){return rm(e)?this._fetchNamespace(t).listen(e,i,r,a):()=>{}}_buildInstruction(t,e,i,r,a){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,i,r,t.fromState.options,t.toState.options,e,a)}destroyInnerAnimations(t){let e=this.driver.query(t,g_,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,Id,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return Cu(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[Eu];if(e&&e.setForRemoval){if(t[Eu]=Q0,e.namespaceId){this.destroyInnerAnimations(t);const i=this._fetchNamespace(e.namespaceId);i&&i.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(T_)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)mc(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,t)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?Cu(e).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(t){throw function j0(n){return new o.vHH(3402,!1)}()}_flushAnimations(t,e){const i=new qy,r=[],a=new Map,g=[],E=new Map,O=new Map,j=new Map,Y=new Set;this.disabledNodes.forEach(Sn=>{Y.add(Sn);const yi=this.driver.query(Sn,".ng-animate-queued",!0);for(let Ji=0;Ji<yi.length;Ji++)Y.add(yi[Ji])});const se=this.bodyNode,be=Array.from(this.statesByElement.keys()),Me=A_(be,this.collectedEnterElements),Ge=new Map;let _t=0;Me.forEach((Sn,yi)=>{const Ji=no+_t++;Ge.set(yi,Ji),Sn.forEach(oo=>mc(oo,Ji))});const Dt=[],_n=new Set,Ln=new Set;for(let Sn=0;Sn<this.collectedLeaveElements.length;Sn++){const yi=this.collectedLeaveElements[Sn],Ji=yi[Eu];Ji&&Ji.setForRemoval&&(Dt.push(yi),_n.add(yi),Ji.hasAnimation?this.driver.query(yi,".ng-star-inserted",!0).forEach(oo=>_n.add(oo)):Ln.add(yi))}const Bn=new Map,Un=A_(be,Array.from(_n));Un.forEach((Sn,yi)=>{const Ji=Xm+_t++;Bn.set(yi,Ji),Sn.forEach(oo=>mc(oo,Ji))}),t.push(()=>{Me.forEach((Sn,yi)=>{const Ji=Ge.get(yi);Sn.forEach(oo=>af(oo,Ji))}),Un.forEach((Sn,yi)=>{const Ji=Bn.get(yi);Sn.forEach(oo=>af(oo,Ji))}),Dt.forEach(Sn=>{this.processLeaveNode(Sn)})});const ii=[],si=[];for(let Sn=this._namespaceList.length-1;Sn>=0;Sn--)this._namespaceList[Sn].drainQueuedTransitions(e).forEach(Ji=>{const oo=Ji.player,As=Ji.element;if(ii.push(oo),this.collectedEnterElements.length){const gs=As[Eu];if(gs&&gs.setForMove){if(gs.previousTriggersValues&&gs.previousTriggersValues.has(Ji.triggerName)){const zg=gs.previousTriggersValues.get(Ji.triggerName),Lu=this.statesByElement.get(Ji.element);if(Lu&&Lu.has(Ji.triggerName)){const vC=Lu.get(Ji.triggerName);vC.value=zg,Lu.set(Ji.triggerName,vC)}}return void oo.destroy()}}const Cp=!se||!this.driver.containsElement(se,As),wc=Bn.get(As),Ng=Ge.get(As),ma=this._buildInstruction(Ji,i,Ng,wc,Cp);if(ma.errors&&ma.errors.length)return void si.push(ma);if(Cp)return oo.onStart(()=>Qp(As,ma.fromStyles)),oo.onDestroy(()=>fc(As,ma.toStyles)),void r.push(oo);if(Ji.isFallbackTransition)return oo.onStart(()=>Qp(As,ma.fromStyles)),oo.onDestroy(()=>fc(As,ma.toStyles)),void r.push(oo);const Ek=[];ma.timelines.forEach(gs=>{gs.stretchStartingKeyframe=!0,this.disabledNodes.has(gs.element)||Ek.push(gs)}),ma.timelines=Ek,i.append(As,ma.timelines),g.push({instruction:ma,player:oo,element:As}),ma.queriedElements.forEach(gs=>pc(E,gs,[]).push(oo)),ma.preStyleProps.forEach((gs,zg)=>{if(gs.size){let Lu=O.get(zg);Lu||O.set(zg,Lu=new Set),gs.forEach((vC,pI)=>Lu.add(pI))}}),ma.postStyleProps.forEach((gs,zg)=>{let Lu=j.get(zg);Lu||j.set(zg,Lu=new Set),gs.forEach((vC,pI)=>Lu.add(pI))})});if(si.length){const Sn=[];si.forEach(yi=>{Sn.push(function fx(n,t){return new o.vHH(3505,!1)}())}),ii.forEach(yi=>yi.destroy()),this.reportError(Sn)}const _r=new Map,Ds=new Map;g.forEach(Sn=>{const yi=Sn.element;i.has(yi)&&(Ds.set(yi,yi),this._beforeAnimationBuild(Sn.player.namespaceId,Sn.instruction,_r))}),r.forEach(Sn=>{const yi=Sn.element;this._getPreviousPlayers(yi,!1,Sn.namespaceId,Sn.triggerName,null).forEach(oo=>{pc(_r,yi,[]).push(oo),oo.destroy()})});const ka=Dt.filter(Sn=>Yy(Sn,O,j)),Ou=new Map;D_(Ou,this.driver,Ln,j,xu).forEach(Sn=>{Yy(Sn,O,j)&&ka.push(Sn)});const xp=new Map;Me.forEach((Sn,yi)=>{D_(xp,this.driver,new Set(Sn),O,"!")}),ka.forEach(Sn=>{const yi=Ou.get(Sn),Ji=xp.get(Sn);Ou.set(Sn,new Map([...Array.from(yi?.entries()??[]),...Array.from(Ji?.entries()??[])]))});const No=[],Fg=[],Hs={};g.forEach(Sn=>{const{element:yi,player:Ji,instruction:oo}=Sn;if(i.has(yi)){if(Y.has(yi))return Ji.onDestroy(()=>fc(yi,oo.toStyles)),Ji.disabled=!0,Ji.overrideTotalTime(oo.totalTime),void r.push(Ji);let As=Hs;if(Ds.size>1){let wc=yi;const Ng=[];for(;wc=wc.parentNode;){const ma=Ds.get(wc);if(ma){As=ma;break}Ng.push(wc)}Ng.forEach(ma=>Ds.set(ma,As))}const Cp=this._buildAnimation(Ji.namespaceId,oo,_r,a,xp,Ou);if(Ji.setRealPlayer(Cp),As===Hs)No.push(Ji);else{const wc=this.playersByElement.get(As);wc&&wc.length&&(Ji.parentPlayer=Cu(wc)),r.push(Ji)}}else Qp(yi,oo.fromStyles),Ji.onDestroy(()=>fc(yi,oo.toStyles)),Fg.push(Ji),Y.has(yi)&&r.push(Ji)}),Fg.forEach(Sn=>{const yi=a.get(Sn.element);if(yi&&yi.length){const Ji=Cu(yi);Sn.setRealPlayer(Ji)}}),r.forEach(Sn=>{Sn.parentPlayer?Sn.syncPlayerEvents(Sn.parentPlayer):Sn.destroy()});for(let Sn=0;Sn<Dt.length;Sn++){const yi=Dt[Sn],Ji=yi[Eu];if(af(yi,Xm),Ji&&Ji.hasAnimation)continue;let oo=[];if(E.size){let Cp=E.get(yi);Cp&&Cp.length&&oo.push(...Cp);let wc=this.driver.query(yi,Id,!0);for(let Ng=0;Ng<wc.length;Ng++){let ma=E.get(wc[Ng]);ma&&ma.length&&oo.push(...ma)}}const As=oo.filter(Cp=>!Cp.destroyed);As.length?Px(this,yi,As):this.processLeaveNode(yi)}return Dt.length=0,No.forEach(Sn=>{this.players.push(Sn),Sn.onDone(()=>{Sn.destroy();const yi=this.players.indexOf(Sn);this.players.splice(yi,1)}),Sn.play()}),No}elementContainsData(t,e){let i=!1;const r=e[Eu];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(e)&&(i=!0),this.playersByQueriedElement.has(e)&&(i=!0),this.statesByElement.has(e)&&(i=!0),this._fetchNamespace(t).elementContainsData(e)||i}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,i,r,a){let g=[];if(e){const E=this.playersByQueriedElement.get(t);E&&(g=E)}else{const E=this.playersByElement.get(t);if(E){const O=!a||a==rf;E.forEach(j=>{j.queued||!O&&j.triggerName!=r||g.push(j)})}}return(i||r)&&(g=g.filter(E=>!(i&&i!=E.namespaceId||r&&r!=E.triggerName))),g}_beforeAnimationBuild(t,e,i){const a=e.element,g=e.isRemovalTransition?void 0:t,E=e.isRemovalTransition?void 0:e.triggerName;for(const O of e.timelines){const j=O.element,Y=j!==a,se=pc(i,j,[]);this._getPreviousPlayers(j,Y,g,E,e.toState).forEach(Me=>{const Ge=Me.getRealPlayer();Ge.beforeDestroy&&Ge.beforeDestroy(),Me.destroy(),se.push(Me)})}Qp(a,e.fromStyles)}_buildAnimation(t,e,i,r,a,g){const E=e.triggerName,O=e.element,j=[],Y=new Set,se=new Set,be=e.timelines.map(Ge=>{const _t=Ge.element;Y.add(_t);const Dt=_t[Eu];if(Dt&&Dt.removedBeforeQueried)return new Wm(Ge.duration,Ge.delay);const _n=_t!==O,Ln=function M_(n){const t=[];return tb(n,t),t}((i.get(_t)||J0).map(_r=>_r.getRealPlayer())).filter(_r=>!!_r.element&&_r.element===_t),Bn=a.get(_t),Un=g.get(_t),ii=Gf(0,this._normalizer,0,Ge.keyframes,Bn,Un),si=this._buildPlayer(Ge,ii,Ln);if(Ge.subTimeline&&r&&se.add(_t),_n){const _r=new im(t,E,_t);_r.setRealPlayer(si),j.push(_r)}return si});j.forEach(Ge=>{pc(this.playersByQueriedElement,Ge.element,[]).push(Ge),Ge.onDone(()=>function S_(n,t,e){let i=n.get(t);if(i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&n.delete(t)}return i}(this.playersByQueriedElement,Ge.element,Ge))}),Y.forEach(Ge=>mc(Ge,Sd));const Me=Cu(be);return Me.onDestroy(()=>{Y.forEach(Ge=>af(Ge,Sd)),fc(O,e.toStyles)}),se.forEach(Ge=>{pc(r,Ge,[]).push(Me)}),Me}_buildPlayer(t,e,i){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,i):new Wm(t.duration,t.delay)}}class im{constructor(t,e,i){this.namespaceId=t,this.triggerName=e,this.element=i,this._player=new Wm,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,i)=>{e.forEach(r=>$f(t,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){pc(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function rm(n){return n&&1===n.nodeType}function I_(n,t){const e=n.style.display;return n.style.display=t??"none",e}function D_(n,t,e,i,r){const a=[];e.forEach(O=>a.push(I_(O)));const g=[];i.forEach((O,j)=>{const Y=new Map;O.forEach(se=>{const be=t.computeStyle(j,se,r);Y.set(se,be),(!be||0==be.length)&&(j[Eu]=X0,g.push(j))}),n.set(j,Y)});let E=0;return e.forEach(O=>I_(O,a[E++])),g}function A_(n,t){const e=new Map;if(n.forEach(E=>e.set(E,[])),0==t.length)return e;const r=new Set(t),a=new Map;function g(E){if(!E)return 1;let O=a.get(E);if(O)return O;const j=E.parentNode;return O=e.has(j)?j:r.has(j)?1:g(j),a.set(E,O),O}return t.forEach(E=>{const O=g(E);1!==O&&e.get(O).push(E)}),e}function mc(n,t){n.classList?.add(t)}function af(n,t){n.classList?.remove(t)}function Px(n,t,e){Cu(e).onDone(()=>n.processLeaveNode(t))}function tb(n,t){for(let e=0;e<n.length;e++){const i=n[e];i instanceof Zm?tb(i.players,t):t.push(i)}}function Yy(n,t,e){const i=e.get(n);if(!i)return!1;let r=t.get(n);return r?i.forEach(a=>r.add(a)):t.set(n,i),e.delete(n),!0}class k_{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,a)=>{},this._transitionEngine=new Rx(t,e,i),this._timelineEngine=new hp(t,e,i),this._transitionEngine.onRemovalComplete=(r,a)=>this.onRemovalComplete(r,a)}registerTrigger(t,e,i,r,a){const g=t+"-"+r;let E=this._triggerCache[g];if(!E){const O=[],Y=Wy(this._driver,a,O,[]);if(O.length)throw function px(n,t){return new o.vHH(3404,!1)}();E=function Rd(n,t,e){return new up(n,t,e)}(r,Y,this._normalizer),this._triggerCache[g]=E}this._transitionEngine.registerTrigger(e,r,E)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,i,r){this._transitionEngine.insertNode(t,e,i,r)}onRemove(t,e,i,r){this._transitionEngine.removeNode(t,e,r||!1,i)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,i,r){if("@"==i.charAt(0)){const[a,g]=Ny(i);this._timelineEngine.command(a,e,g,r)}else this._transitionEngine.trigger(t,e,i,r)}listen(t,e,i,r,a){if("@"==i.charAt(0)){const[g,E]=Ny(i);return this._timelineEngine.listen(g,e,E,a)}return this._transitionEngine.listen(t,e,i,r,a)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let Lx=(()=>{class n{constructor(e,i,r){this._element=e,this._startStyles=i,this._endStyles=r,this._state=0;let a=n.initialStylesByElement.get(e);a||n.initialStylesByElement.set(e,a=new Map),this._initialStyles=a}start(){this._state<1&&(this._startStyles&&fc(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(fc(this._element,this._initialStyles),this._endStyles&&(fc(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Qp(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Qp(this._element,this._endStyles),this._endStyles=null),fc(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function R_(n){let t=null;return n.forEach((e,i)=>{(function Tu(n){return"display"===n||"position"===n})(i)&&(t=t||new Map,t.set(i,e))}),t}class ch{constructor(t,e,i,r){this.element=t,this.keyframes=e,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(i=>{e.push(Object.fromEntries(i))}),e}_triggerWebAnimation(t,e,i){return t.animate(this._convertKeyframesToObject(e),i)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&t.set(r,this._finished?i:Gy(this.element,r))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class lf{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return mx(t,e)}getParentElement(t){return f_(t)}query(t,e,i){return Wc(t,e,i)}computeStyle(t,e,i){return window.getComputedStyle(t)[e]}animate(t,e,i,r,a,g=[]){const O={duration:i,delay:r,fill:0==r?"both":"forwards"};a&&(O.easing=a);const j=new Map,Y=g.filter(Me=>Me instanceof ch);(function jy(n,t){return 0===n||0===t})(i,r)&&Y.forEach(Me=>{Me.currentSnapshot.forEach((Ge,_t)=>j.set(_t,Ge))});let se=function W0(n){return n.length?n[0]instanceof Map?n:n.map(t=>Lh(t)):[]}(e).map(Me=>Jp(Me));se=function b_(n,t,e){if(e.size&&t.length){let i=t[0],r=[];if(e.forEach((a,g)=>{i.has(g)||r.push(g),i.set(g,a)}),r.length)for(let a=1;a<t.length;a++){let g=t[a];r.forEach(E=>g.set(E,Gy(n,E)))}}return t}(t,se,j);const be=function Ox(n,t){let e=null,i=null;return Array.isArray(t)&&t.length?(e=R_(t[0]),t.length>1&&(i=R_(t[t.length-1]))):t instanceof Map&&(e=R_(t)),e||i?new Lx(n,e,i):null}(t,se);return new ch(t,se,O,be)}}let zh=(()=>{class n extends tx{constructor(e,i){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(i.body,{id:"0",encapsulation:o.ifc.None,styles:[],data:{animation:[]}})}build(e){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?Dy(e):e;return P_(this._renderer,null,i,"register",[r]),new dp(i,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(o.FYo),o.LFG(y))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();class dp extends nx{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new pg(this._id,t,e||{},this._renderer)}}class pg{constructor(t,e,i,r){this.id=t,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return P_(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function P_(n,t,e,i,r){return n.setProperty(t,`@@${e}:${i}`,r)}const Jy="@.disabled";let Qy=(()=>{class n{constructor(e,i,r){this.delegate=e,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(a,g)=>{const E=g?.parentNode(a);E&&g.removeChild(E,a)}}createRenderer(e,i){const a=this.delegate.createRenderer(e,i);if(!(e&&i&&i.data&&i.data.animation)){let Y=this._rendererCache.get(a);return Y||(Y=new nb("",a,this.engine,()=>this._rendererCache.delete(a)),this._rendererCache.set(a,Y)),Y}const g=i.id,E=i.id+"-"+this._currentId;this._currentId++,this.engine.register(E,e);const O=Y=>{Array.isArray(Y)?Y.forEach(O):this.engine.registerTrigger(g,E,e,Y.name,Y)};return i.data.animation.forEach(O),new ib(this,E,a,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,i,r){e>=0&&e<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(a=>{const[g,E]=a;g(E)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(o.FYo),o.LFG(k_),o.LFG(o.R0b))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();class nb{constructor(t,e,i,r){this.namespaceId=t,this.delegate=e,this.engine=i,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?a=>e.destroyNode(a):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,i,r=!0){this.delegate.insertBefore(t,e,i),this.engine.onInsert(this.namespaceId,e,t,r)}removeChild(t,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate,i)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,i,r){this.delegate.setAttribute(t,e,i,r)}removeAttribute(t,e,i){this.delegate.removeAttribute(t,e,i)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,i,r){this.delegate.setStyle(t,e,i,r)}removeStyle(t,e,i){this.delegate.removeStyle(t,e,i)}setProperty(t,e,i){"@"==e.charAt(0)&&e==Jy?this.disableAnimations(t,!!i):this.delegate.setProperty(t,e,i)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,i){return this.delegate.listen(t,e,i)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class ib extends nb{constructor(t,e,i,r,a){super(e,i,r,a),this.factory=t,this.namespaceId=e}setProperty(t,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==Jy?this.disableAnimations(t,i=void 0===i||!!i):this.engine.process(this.namespaceId,t,e.slice(1),i):this.delegate.setProperty(t,e,i)}listen(t,e,i){if("@"==e.charAt(0)){const r=function rb(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let a=e.slice(1),g="";return"@"!=a.charAt(0)&&([a,g]=function ob(n){const t=n.indexOf(".");return[n.substring(0,t),n.slice(t+1)]}(a)),this.engine.listen(this.namespaceId,r,a,g,E=>{this.factory.scheduleListenerCallback(E._data||-1,i,E)})}return this.delegate.listen(t,e,i)}}let sb=(()=>{class n extends k_{constructor(e,i,r,a){super(e.body,i,r)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(y),o.LFG(_x),o.LFG(nf),o.LFG(o.z2F))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();const ab=[{provide:tx,useClass:zh},{provide:nf,useFactory:function O_(){return new cg}},{provide:k_,useClass:sb},{provide:o.FYo,useFactory:function pp(n,t,e){return new Qy(n,t,e)},deps:[La,k_,o.R0b]}],Pd=[{provide:_x,useFactory:()=>new lf},{provide:o.QbO,useValue:"BrowserAnimations"},...ab],L_=[{provide:_x,useClass:gx},{provide:o.QbO,useValue:"NoopAnimations"},...ab];let om=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?L_:Pd}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({providers:Pd,imports:[Ku]}),n})();var Es=Ee(7579),zx=Ee(6451),sm=Ee(5363);function Yo(n,t){return(0,k.e)((e,i)=>{let r=null,a=0,g=!1;const E=()=>g&&!r&&i.complete();e.subscribe((0,P.x)(i,O=>{r?.unsubscribe();let j=0;const Y=a++;(0,oi.Xf)(n(O,Y)).subscribe(r=(0,P.x)(i,se=>i.next(t?t(O,se,Y,j++):se),()=>{r=null,E()}))},()=>{g=!0,E()}))})}var Xy=Ee(6063);class cb extends Es.x{constructor(t=1/0,e=1/0,i=Xy.l){super(),this._bufferSize=t,this._windowTime=e,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,e)}next(t){const{isStopped:e,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:a,_windowTime:g}=this;e||(i.push(t),!r&&i.push(a.now()+g)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(t),{_infiniteTimeWindow:i,_buffer:r}=this,a=r.slice();for(let g=0;g<a.length&&!t.closed;g+=i?1:2)t.next(a[g]);return this._checkFinalizedStatuses(t),e}_trimBuffer(){const{_bufferSize:t,_timestampProvider:e,_buffer:i,_infiniteTimeWindow:r}=this,a=(r?1:2)*t;if(t<1/0&&a<i.length&&i.splice(0,i.length-a),!r){const g=e.now();let E=0;for(let O=1;O<i.length&&i[O]<=g;O+=2)E=O;E&&i.splice(0,E+1)}}}var Fo=Ee(3099);function fp(n,t,e){let i,r=!1;return n&&"object"==typeof n?({bufferSize:i=1/0,windowTime:t=1/0,refCount:r=!1,scheduler:e}=n):i=n??1/0,(0,Fo.B)({connector:()=>new cb(i,t,e),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}const mg=(0,Ee(3888).d)(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});var Su=Ee(515);function cf(n){return n<=0?()=>Su.E:(0,k.e)((t,e)=>{let i=0;t.subscribe((0,P.x)(e,r=>{++i<=n&&(e.next(r),n<=i&&e.complete())}))})}function gg(n){return(0,k.e)((t,e)=>{let i=!1;t.subscribe((0,P.x)(e,r=>{i=!0,e.next(r)},()=>{i||e.next(n),e.complete()}))})}function ev(n=_g){return(0,k.e)((t,e)=>{let i=!1;t.subscribe((0,P.x)(e,r=>{i=!0,e.next(r)},()=>i?e.complete():e.error(n())))})}function _g(){return new mg}var am=Ee(4671);function Bh(n,t){const e=arguments.length>=2;return i=>i.pipe(n?I((r,a)=>n(r,a,i)):am.y,cf(1),e?gg(t):ev(()=>new mg))}function ub(n,t){return(0,_.m)(t)?Yo(()=>n,t):Yo(()=>n)}var F_=Ee(9468),jr=Ee(263),qc=Ee(2011),l=Ee(259);class s{constructor(t){return t}}class c{constructor(){return(0,l.C6)()}}const C=new o.OlP("angularfire2._apps"),S={provide:s,useFactory:function v(n){return n&&1===n.length?n[0]:new s((0,l.Mq)())},deps:[[new o.FiY,C]]},R={provide:c,deps:[[new o.FiY,C]]};function N(n){return(t,e)=>{const i=t.runOutsideAngular(()=>n(e));return new s(i)}}let U=(()=>{class n{constructor(e){(0,l.KN)("angularfire",jr.q4.full,"core"),(0,l.KN)("angularfire",jr.q4.full,"app"),(0,l.KN)("angular",o.q4F.full,e.toString())}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(o.Lbi))},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({providers:[S,R]}),n})();const le=(0,jr.u3)(l.ZF,!0);var ve=Ee(5861),Pe=Ee(9681),He=Ee(4859),Be=Ee(2090),$e=Ee(1877);const kt=new Map,St={activated:!1,tokenObservers:[]},Gt={initialized:!1,enabled:!1};function Qt(n){return kt.get(n)||Object.assign({},St)}function Kt(){return Gt}class Pn{constructor(t,e,i,r,a){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=i,this.lowerBound=r,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=r,r>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(t){var e=this;return(0,ve.Z)(function*(){e.stop();try{e.pending=new Be.BH,yield function Kn(n){return new Promise(t=>{setTimeout(t,n)})}(e.getNextRun(t)),e.pending.resolve(),yield e.pending.promise,e.pending=new Be.BH,yield e.operation(),e.pending.resolve(),yield e.pending.promise,e.process(!0).catch(()=>{})}catch(i){e.retryPolicy(i)?e.process(!1).catch(()=>{}):e.stop()}})()}getNextRun(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e}}}const Yn=new Be.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function nr(n){if(!Qt(n).activated)throw Yn.create("use-before-activation",{appName:n.name})}function Nr(n,t){return Ri.apply(this,arguments)}function Ri(){return(Ri=(0,ve.Z)(function*({url:n,body:t},e){const i={"Content-Type":"application/json"},r=e.getImmediate({optional:!0});if(r){const se=yield r.getHeartbeatsHeader();se&&(i["X-Firebase-Client"]=se)}const a={method:"POST",body:JSON.stringify(t),headers:i};let g,E;try{g=yield fetch(n,a)}catch(se){throw Yn.create("fetch-network-error",{originalErrorMessage:se?.message})}if(200!==g.status)throw Yn.create("fetch-status-error",{httpStatus:g.status});try{E=yield g.json()}catch(se){throw Yn.create("fetch-parse-error",{originalErrorMessage:se?.message})}const O=E.ttl.match(/^([\d.]+)(s)$/);if(!O||!O[2]||isNaN(Number(O[1])))throw Yn.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${E.ttl}`});const j=1e3*Number(O[1]),Y=Date.now();return{token:E.token,expireTimeMillis:Y+j,issuedAtTimeMillis:Y}})).apply(this,arguments)}function So(n,t){const{projectId:e,appId:i,apiKey:r}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${e}/apps/${i}:exchangeDebugToken?key=${r}`,body:{debug_token:t}}}const ro="firebase-app-check-store";let Qs=null;function zr(){return Qs||(Qs=new Promise((n,t)=>{try{const e=indexedDB.open("firebase-app-check-database",1);e.onsuccess=i=>{n(i.target.result)},e.onerror=i=>{var r;t(Yn.create("storage-open",{originalErrorMessage:null===(r=i.target.error)||void 0===r?void 0:r.message}))},e.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(ro,{keyPath:"compositeKey"})}}catch(e){t(Yn.create("storage-open",{originalErrorMessage:e?.message}))}}),Qs)}function Br(){return(Br=(0,ve.Z)(function*(n,t){const i=(yield zr()).transaction(ro,"readwrite"),a=i.objectStore(ro).put({compositeKey:n,value:t});return new Promise((g,E)=>{a.onsuccess=O=>{g()},i.onerror=O=>{var j;E(Yn.create("storage-set",{originalErrorMessage:null===(j=O.target.error)||void 0===j?void 0:j.message}))}})})).apply(this,arguments)}const Ss=new $e.Yd("@firebase/app-check");function Vh(n,t){return(0,Be.hl)()?function Ts(n,t){return function Us(n,t){return Br.apply(this,arguments)}(function ca(n){return`${n.options.appId}-${n.name}`}(n),t)}(n,t).catch(e=>{Ss.warn(`Failed to write token to IndexedDB. Error: ${e}`)}):Promise.resolve()}function uf(){return Kt().enabled}function Vx(){return N_.apply(this,arguments)}function N_(){return(N_=(0,ve.Z)(function*(){const n=Kt();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const Ux={error:"UNKNOWN_ERROR"};function Fi(n){return Be.US.encodeString(JSON.stringify(n),!1)}function Iu(n){return tv.apply(this,arguments)}function tv(){return(tv=(0,ve.Z)(function*(n,t=!1){const e=n.app;nr(e);const i=Qt(e);let a,r=i.token;if(r&&!Jo(r)&&(i.token=void 0,r=void 0),!r){const O=yield i.cachedTokenPromise;O&&(Jo(O)?r=O:yield Vh(e,void 0))}if(!t&&r&&Jo(r))return{token:r.token};let E,g=!1;if(uf()){i.exchangeTokenPromise||(i.exchangeTokenPromise=Nr(So(e,yield Vx()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),g=!0);const O=yield i.exchangeTokenPromise;return yield Vh(e,O),i.token=O,{token:O.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),g=!0),r=yield Qt(e).exchangeTokenPromise}catch(O){"appCheck/throttled"===O.code?Ss.warn(O.message):Ss.error(O),a=O}return r?a?E=Jo(r)?{token:r.token,internalError:a}:Kc(a):(E={token:r.token},i.token=r,yield Vh(e,r)):E=Kc(a),g&&lm(e,E),E})).apply(this,arguments)}function Od(n,t){const e=Qt(n),i=e.tokenObservers.filter(r=>r.next!==t);0===i.length&&e.tokenRefresher&&e.tokenRefresher.isRunning()&&e.tokenRefresher.stop(),e.tokenObservers=i}function nv(n){const{app:t}=n,e=Qt(t);let i=e.tokenRefresher;i||(i=function Hh(n){const{app:t}=n;return new Pn((0,ve.Z)(function*(){let i;if(i=Qt(t).token?yield Iu(n,!0):yield Iu(n),i.error)throw i.error;if(i.internalError)throw i.internalError}),()=>!0,()=>{const e=Qt(t);if(e.token){let i=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return i=Math.min(i,e.token.expireTimeMillis-3e5),Math.max(0,i-Date.now())}return 0},3e4,96e4)}(n),e.tokenRefresher=i),!i.isRunning()&&e.isTokenAutoRefreshEnabled&&i.start()}function lm(n,t){const e=Qt(n).tokenObservers;for(const i of e)try{"EXTERNAL"===i.type&&null!=t.error?i.error(t.error):i.next(t)}catch{}}function Jo(n){return n.expireTimeMillis-Date.now()>0}function Kc(n){return{token:Fi(Ux),error:n}}class gc{constructor(t,e){this.app=t,this.heartbeatServiceProvider=e}_delete(){const{tokenObservers:t}=Qt(this.app);for(const e of t)Od(this.app,e.next);return Promise.resolve()}}const VE="app-check-internal";!function K2(){(0,Pe._registerComponent)(new He.wA("app-check",n=>function vg(n,t){return new gc(n,t)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,t,e)=>{n.getProvider(VE).initialize()})),(0,Pe._registerComponent)(new He.wA(VE,n=>function db(n){return{getToken:t=>Iu(n,t),addTokenListener:t=>function mp(n,t,e,i){const{app:r}=n,a=Qt(r);if(a.tokenObservers=[...a.tokenObservers,{next:e,error:i,type:t}],a.token&&Jo(a.token)){const E=a.token;Promise.resolve().then(()=>{e({token:E.token}),nv(n)}).catch(()=>{})}a.cachedTokenPromise.then(()=>nv(n))}(n,"INTERNAL",t),removeTokenListener:t=>Od(n.app,t)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,Pe.registerVersion)("@firebase/app-check","0.6.3")}();class UE{constructor(){return(0,jr.vb)("app-check")}}typeof window<"u"&&window;var Gi=Ee(9260);const z_=new o.OlP("angularfire2.auth.use-emulator"),FD=new o.OlP("angularfire2.auth.settings"),HE=new o.OlP("angularfire2.auth.tenant-id"),ND=new o.OlP("angularfire2.auth.langugage-code"),jE=new o.OlP("angularfire2.auth.use-device-language"),zD=new o.OlP("angularfire.auth.persistence"),GE=(n,t,e,i,r,a,g,E)=>(0,qc.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const O=t.runOutsideAngular(()=>n.auth());if(e&&O.useEmulator(...e),i&&(O.tenantId=i),O.languageCode=r,a&&O.useDeviceLanguage(),g)for(const[j,Y]of Object.entries(g))O.settings[j]=Y;return E&&O.setPersistence(E),O},[e,i,r,a,g,E]);let fb=(()=>{class n{constructor(e,i,r,a,g,E,O,j,Y,se,be,Me){const Ge=new Es.x,_t=qn(void 0).pipe((0,sm.Q)(g.outsideAngular),Yo(()=>a.runOutsideAngular(()=>Promise.resolve().then(Ee.bind(Ee,9568)))),(0,M.U)(()=>(0,qc.on)(e,a,i)),(0,M.U)(Dt=>GE(Dt,a,E,j,Y,se,O,be)),fp({bufferSize:1,refCount:!1}));if(ml(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=qn(null);else{_t.pipe(Bh()).subscribe();const _n=_t.pipe(Yo(Un=>Un.getRedirectResult().then(ii=>ii,()=>null)),jr.iC,fp({bufferSize:1,refCount:!1})),Ln=_t.pipe(Yo(Un=>new w.y(ii=>({unsubscribe:a.runOutsideAngular(()=>Un.onAuthStateChanged(si=>ii.next(si),si=>ii.error(si),()=>ii.complete()))})))),Bn=_t.pipe(Yo(Un=>new w.y(ii=>({unsubscribe:a.runOutsideAngular(()=>Un.onIdTokenChanged(si=>ii.next(si),si=>ii.error(si),()=>ii.complete()))}))));this.authState=_n.pipe(ub(Ln),(0,F_.R)(g.outsideAngular),(0,sm.Q)(g.insideAngular)),this.user=_n.pipe(ub(Bn),(0,F_.R)(g.outsideAngular),(0,sm.Q)(g.insideAngular)),this.idToken=this.user.pipe(Yo(Un=>Un?(0,Qr.D)(Un.getIdToken()):qn(null))),this.idTokenResult=this.user.pipe(Yo(Un=>Un?(0,Qr.D)(Un.getIdTokenResult()):qn(null))),this.credential=(0,zx.T)(_n,Ge,this.authState.pipe(I(Un=>!Un))).pipe((0,M.U)(Un=>Un?.user?Un:null),(0,F_.R)(g.outsideAngular),(0,sm.Q)(g.insideAngular))}return(0,qc.pX)(this,_t,a,{spy:{apply:(Dt,_n,Ln)=>{(Dt.startsWith("signIn")||Dt.startsWith("createUser"))&&Ln.then(Bn=>Ge.next(Bn))}}})}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(qc.Dh),o.LFG(qc.xv,8),o.LFG(o.Lbi),o.LFG(o.R0b),o.LFG(jr.HU),o.LFG(z_,8),o.LFG(FD,8),o.LFG(HE,8),o.LFG(ND,8),o.LFG(jE,8),o.LFG(zD,8),o.LFG(UE,8))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),$E=(()=>{class n{constructor(){Gi.Z.registerVersion("angularfire",jr.q4.full,"auth-compat")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({providers:[fb]}),n})();var tR=Ee(2722);class BD{constructor(){return(0,jr.vb)("auth")}}var Si,ZD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},df={},KE=KE||{},lr=ZD||self;function bg(){}function gb(n){var t=typeof n;return"array"==(t="object"!=t?t:n?Array.isArray(n)?"array":t:"null")||"object"==t&&"number"==typeof n.length}function sv(n){var t=typeof n;return"object"==t&&null!=n||"function"==t}var qx="closure_uid_"+(1e9*Math.random()>>>0),KD=0;function YD(n,t,e){return n.call.apply(n.bind,arguments)}function ER(n,t,e){if(!n)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,i),n.apply(t,r)}}return function(){return n.apply(t,arguments)}}function Du(n,t,e){return(Du=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?YD:ER).apply(null,arguments)}function _b(n,t){var e=Array.prototype.slice.call(arguments,1);return function(){var i=e.slice();return i.push.apply(i,arguments),n.apply(this,i)}}function _c(n,t){function e(){}e.prototype=t.prototype,n.X=t.prototype,n.prototype=new e,n.prototype.constructor=n,n.Wb=function(i,r,a){for(var g=Array(arguments.length-2),E=2;E<arguments.length;E++)g[E-2]=arguments[E];return t.prototype[r].apply(i,g)}}function wg(){this.s=this.s,this.o=this.o}wg.prototype.s=!1,wg.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function qD(n){Object.prototype.hasOwnProperty.call(n,qx)&&n[qx]||(n[qx]=++KD)}(this)},wg.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const QD=Array.prototype.indexOf?function(n,t){return Array.prototype.indexOf.call(n,t,void 0)}:function(n,t){if("string"==typeof n)return"string"!=typeof t||1!=t.length?-1:n.indexOf(t,0);for(let e=0;e<n.length;e++)if(e in n&&n[e]===t)return e;return-1};function B_(n){const t=n.length;if(0<t){const e=Array(t);for(let i=0;i<t;i++)e[i]=n[i];return e}return[]}function XD(n,t){for(let e=1;e<arguments.length;e++){const i=arguments[e];if(gb(i)){const r=n.length||0,a=i.length||0;n.length=r+a;for(let g=0;g<a;g++)n[r+g]=i[g]}else n.push(i)}}function Ol(n,t){this.type=n,this.g=this.target=t,this.defaultPrevented=!1}Ol.prototype.h=function(){this.defaultPrevented=!0};var pf=function(){if(!lr.addEventListener||!Object.defineProperty)return!1;var n=!1,t=Object.defineProperty({},"passive",{get:function(){n=!0}});try{lr.addEventListener("test",bg,t),lr.removeEventListener("test",bg,t)}catch{}return n}();function Kx(n){return/^[\s\xa0]*$/.test(n)}var Yx=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function V_(n,t){return n<t?-1:n>t?1:0}function Jx(){var n=lr.navigator;return n&&(n=n.userAgent)?n:""}function ff(n){return-1!=Jx().indexOf(n)}function YE(n){return YE[" "](n),n}YE[" "]=bg;var lv,n,Xx=ff("Opera"),av=ff("Trident")||ff("MSIE"),eA=ff("Edge"),e1=eA||av,JE=ff("Gecko")&&!(-1!=Jx().toLowerCase().indexOf("webkit")&&!ff("Edge"))&&!(ff("Trident")||ff("MSIE"))&&!ff("Edge"),QE=-1!=Jx().toLowerCase().indexOf("webkit")&&!ff("Edge");function XE(){var n=lr.document;return n?n.documentMode:void 0}e:{var yb="",t1=(n=Jx(),JE?/rv:([^\);]+)(\)|;)/.exec(n):eA?/Edge\/([\d\.]+)/.exec(n):av?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):QE?/WebKit\/(\S+)/.exec(n):Xx?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(t1&&(yb=t1?t1[1]:""),av){var vb=XE();if(null!=vb&&vb>parseFloat(yb)){lv=String(vb);break e}}lv=yb}var eT={};var SR=lr.document&&av&&(XE()||parseInt(lv,10))||void 0;function cv(n,t){if(Ol.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var e=this.type=n.type,i=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=t,t=n.relatedTarget){if(JE){e:{try{YE(t.nodeName);var r=!0;break e}catch{}r=!1}r||(t=null)}}else"mouseover"==e?t=n.fromElement:"mouseout"==e&&(t=n.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:nT[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&cv.X.h.call(this)}}_c(cv,Ol);var nT={2:"touch",3:"pen",4:"mouse"};cv.prototype.h=function(){cv.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var uv="closure_listenable_"+(1e6*Math.random()|0),nA=0;function iA(n,t,e,i,r){this.listener=n,this.proxy=null,this.src=t,this.type=e,this.capture=!!i,this.ha=r,this.key=++nA,this.ba=this.ea=!1}function bb(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function iT(n,t,e){for(const i in n)t.call(e,n[i],i,n)}function rT(n){const t={};for(const e in n)t[e]=n[e];return t}const oT="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rA(n,t){let e,i;for(let r=1;r<arguments.length;r++){for(e in i=arguments[r],i)n[e]=i[e];for(let a=0;a<oT.length;a++)e=oT[a],Object.prototype.hasOwnProperty.call(i,e)&&(n[e]=i[e])}}function wb(n){this.src=n,this.g={},this.h=0}function n1(n,t){var e=t.type;if(e in n.g){var a,i=n.g[e],r=QD(i,t);(a=0<=r)&&Array.prototype.splice.call(i,r,1),a&&(bb(t),0==n.g[e].length&&(delete n.g[e],n.h--))}}function yc(n,t,e,i){for(var r=0;r<n.length;++r){var a=n[r];if(!a.ba&&a.listener==t&&a.capture==!!e&&a.ha==i)return r}return-1}wb.prototype.add=function(n,t,e,i,r){var a=n.toString();(n=this.g[a])||(n=this.g[a]=[],this.h++);var g=yc(n,t,i,r);return-1<g?(t=n[g],e||(t.ea=!1)):((t=new iA(t,this.src,a,!!i,r)).ea=e,n.push(t)),t};var xg="closure_lm_"+(1e6*Math.random()|0),sT={};function oA(n,t,e,i,r){if(i&&i.once)return aT(n,t,e,i,r);if(Array.isArray(t)){for(var a=0;a<t.length;a++)oA(n,t[a],e,i,r);return null}return e=hT(e),n&&n[uv]?n.N(t,e,sv(i)?!!i.capture:!!i,r):IR(n,t,e,!1,i,r)}function IR(n,t,e,i,r,a){if(!t)throw Error("Invalid event type");var g=sv(r)?!!r.capture:!!r,E=uT(n);if(E||(n[xg]=E=new wb(n)),(e=E.add(t,e,i,g,a)).proxy)return e;if(i=function X3(){const t=cT;return function n(e){return t.call(n.src,n.listener,e)}}(),e.proxy=i,i.src=n,i.listener=e,n.addEventListener)pf||(r=g),void 0===r&&(r=!1),n.addEventListener(t.toString(),i,r);else if(n.attachEvent)n.attachEvent(sA(t.toString()),i);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(i)}return e}function aT(n,t,e,i,r){if(Array.isArray(t)){for(var a=0;a<t.length;a++)aT(n,t[a],e,i,r);return null}return e=hT(e),n&&n[uv]?n.O(t,e,sv(i)?!!i.capture:!!i,r):IR(n,t,e,!0,i,r)}function lT(n,t,e,i,r){if(Array.isArray(t))for(var a=0;a<t.length;a++)lT(n,t[a],e,i,r);else i=sv(i)?!!i.capture:!!i,e=hT(e),n&&n[uv]?(n=n.i,(t=String(t).toString())in n.g&&-1<(e=yc(a=n.g[t],e,i,r))&&(bb(a[e]),Array.prototype.splice.call(a,e,1),0==a.length&&(delete n.g[t],n.h--))):n&&(n=uT(n))&&(t=n.g[t.toString()],n=-1,t&&(n=yc(t,e,i,r)),(e=-1<n?t[n]:null)&&U_(e))}function U_(n){if("number"!=typeof n&&n&&!n.ba){var t=n.src;if(t&&t[uv])n1(t.i,n);else{var e=n.type,i=n.proxy;t.removeEventListener?t.removeEventListener(e,i,n.capture):t.detachEvent?t.detachEvent(sA(e),i):t.addListener&&t.removeListener&&t.removeListener(i),(e=uT(t))?(n1(e,n),0==e.h&&(e.src=null,t[xg]=null)):bb(n)}}}function sA(n){return n in sT?sT[n]:sT[n]="on"+n}function cT(n,t){if(n.ba)n=!0;else{t=new cv(t,this);var e=n.listener,i=n.ha||n.src;n.ea&&U_(n),n=e.call(i,t)}return n}function uT(n){return(n=n[xg])instanceof wb?n:null}var r1="__closure_events_fn_"+(1e9*Math.random()>>>0);function hT(n){return"function"==typeof n?n:(n[r1]||(n[r1]=function(t){return n.handleEvent(t)}),n[r1])}function Ll(){wg.call(this),this.i=new wb(this),this.P=this,this.I=null}function vc(n,t){var e,i=n.I;if(i)for(e=[];i;i=i.I)e.push(i);if(n=n.P,i=t.type||t,"string"==typeof t)t=new Ol(t,n);else if(t instanceof Ol)t.target=t.target||n;else{var r=t;rA(t=new Ol(i,n),r)}if(r=!0,e)for(var a=e.length-1;0<=a;a--){var g=t.g=e[a];r=hv(g,i,!0,t)&&r}if(r=hv(g=t.g=n,i,!0,t)&&r,r=hv(g,i,!1,t)&&r,e)for(a=0;a<e.length;a++)r=hv(g=t.g=e[a],i,!1,t)&&r}function hv(n,t,e,i){if(!(t=n.i.g[String(t)]))return!0;t=t.concat();for(var r=!0,a=0;a<t.length;++a){var g=t[a];if(g&&!g.ba&&g.capture==e){var E=g.listener,O=g.ha||g.src;g.ea&&n1(n.i,g),r=!1!==E.call(O,i)&&r}}return r&&!i.defaultPrevented}_c(Ll,wg),Ll.prototype[uv]=!0,Ll.prototype.removeEventListener=function(n,t,e,i){lT(this,n,t,e,i)},Ll.prototype.M=function(){if(Ll.X.M.call(this),this.i){var t,n=this.i;for(t in n.g){for(var e=n.g[t],i=0;i<e.length;i++)bb(e[i]);delete n.g[t],n.h--}}this.I=null},Ll.prototype.N=function(n,t,e,i){return this.i.add(String(n),t,!1,e,i)},Ll.prototype.O=function(n,t,e,i){return this.i.add(String(n),t,!0,e,i)};var o1=lr.JSON.stringify;function aA(){var n=pT;let t=null;return n.g&&(t=n.g,n.g=n.g.next,n.g||(n.h=null),t.next=null),t}var l1,a1=new class{constructor(n,t){this.i=n,this.j=t,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new ez,n=>n.reset());class ez{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function lA(n){lr.setTimeout(()=>{throw n},0)}function cA(n,t){l1||function dv(){var n=lr.Promise.resolve(void 0);l1=function(){n.then(fT)}}(),dT||(l1(),dT=!0),pT.add(n,t)}var dT=!1,pT=new class s1{constructor(){this.h=this.g=null}add(t,e){const i=a1.get();i.set(t,e),this.h?this.h.next=i:this.g=i,this.h=i}};function fT(){for(var n;n=aA();){try{n.h.call(n.g)}catch(e){lA(e)}var t=a1;t.j(n),100>t.h&&(t.h++,n.next=t.g,t.g=n)}dT=!1}function mT(n,t){Ll.call(this),this.h=n||1,this.g=t||lr,this.j=Du(this.lb,this),this.l=Date.now()}function gT(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function uA(n,t,e){if("function"==typeof n)e&&(n=Du(n,e));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=Du(n.handleEvent,n)}return 2147483647<Number(t)?-1:lr.setTimeout(n,t||0)}function hA(n){n.g=uA(()=>{n.g=null,n.i&&(n.i=!1,hA(n))},n.j);const t=n.h;n.h=null,n.m.apply(null,t)}_c(mT,Ll),(Si=mT.prototype).ca=!1,Si.R=null,Si.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),vc(this,"tick"),this.ca&&(gT(this),this.start()))}},Si.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Si.M=function(){mT.X.M.call(this),gT(this),delete this.g};class DR extends wg{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:hA(this)}M(){super.M(),this.g&&(lr.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xb(n){wg.call(this),this.h=n,this.g={}}_c(xb,wg);var _T=[];function yT(n,t,e,i){Array.isArray(e)||(e&&(_T[0]=e.toString()),e=_T);for(var r=0;r<e.length;r++){var a=oA(t,e[r],i||n.handleEvent,!1,n.h||n);if(!a)break;n.g[a.key]=a}}function dA(n){iT(n.g,function(t,e){this.g.hasOwnProperty(e)&&U_(t)},n),n.g={}}function Cb(){this.g=!0}function pv(n,t,e,i){n.info(function(){return"XMLHTTP TEXT ("+t+"): "+function MR(n,t){if(!n.g)return t;if(!t)return null;try{var e=JSON.parse(t);if(e)for(n=0;n<e.length;n++)if(Array.isArray(e[n])){var i=e[n];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var a=r[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var g=1;g<r.length;g++)r[g]=""}}}return o1(e)}catch{return t}}(n,e)+(i?" "+i:"")})}xb.prototype.M=function(){xb.X.M.call(this),dA(this)},xb.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Cb.prototype.Aa=function(){this.g=!1},Cb.prototype.info=function(){};var Cg={},vT=null;function Eb(){return vT=vT||new Ll}function bT(n){Ol.call(this,Cg.Pa,n)}function Tb(n){const t=Eb();vc(t,new bT(t))}function mA(n,t){Ol.call(this,Cg.STAT_EVENT,n),this.stat=t}function uh(n){const t=Eb();vc(t,new mA(t,n))}function wT(n,t){Ol.call(this,Cg.Qa,n),this.size=t}function c1(n,t){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return lr.setTimeout(function(){n()},t)}Cg.Pa="serverreachability",_c(bT,Ol),Cg.STAT_EVENT="statevent",_c(mA,Ol),Cg.Qa="timingevent",_c(wT,Ol);var xT={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},kR={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function gA(){}function PR(){}gA.prototype.h=null;var yA,u1={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function _A(){Ol.call(this,"d")}function fv(){Ol.call(this,"c")}function Sb(){}function Eg(n,t,e,i){this.l=n,this.j=t,this.m=e,this.U=i||1,this.S=new xb(this),this.O=vA,this.T=new mT(n=e1?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new CT}function CT(){this.i=null,this.g="",this.h=!1}_c(_A,Ol),_c(fv,Ol),_c(Sb,gA),Sb.prototype.g=function(){return new XMLHttpRequest},Sb.prototype.i=function(){return{}},yA=new Sb;var vA=45e3,bA={},mv={};function h1(n,t,e){n.K=1,n.v=_v(mf(t)),n.s=e,n.P=!0,wA(n,null)}function wA(n,t){n.F=Date.now(),Ib(n),n.A=mf(n.v);var e=n.A,i=n.U;Array.isArray(i)||(i=[String(i)]),AT(e.i,"t",i),n.C=0,e=n.l.H,n.h=new CT,n.g=KR(n.l,e?t:null,!n.s),0<n.N&&(n.L=new DR(Du(n.La,n,n.g),n.N)),yT(n.S,n.g,"readystatechange",n.ib),t=n.H?rT(n.H):{},n.s?(n.u||(n.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,t)):(n.u="GET",n.g.da(n.A,n.u,null,t)),Tb(),function pA(n,t,e,i,r,a){n.info(function(){if(n.g)if(a)for(var g="",E=a.split("&"),O=0;O<E.length;O++){var j=E[O].split("=");if(1<j.length){var Y=j[0];j=j[1];var se=Y.split("_");g=2<=se.length&&"type"==se[1]?g+(Y+"=")+j+"&":g+(Y+"=redacted&")}}else g=null;else g=a;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+t+"\n"+e+"\n"+g})}(n.j,n.u,n.A,n.m,n.U,n.s)}function ET(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function OR(n,t,e){let r,i=!0;for(;!n.I&&n.C<e.length;){if(r=LR(n,e),r==mv){4==t&&(n.o=4,uh(14),i=!1),pv(n.j,n.m,null,"[Incomplete Response]");break}if(r==bA){n.o=4,uh(15),pv(n.j,n.m,e,"[Invalid Chunk]"),i=!1;break}pv(n.j,n.m,r,null),CA(n,r)}ET(n)&&r!=mv&&r!=bA&&(n.h.g="",n.C=0),4!=t||0!=e.length||n.h.h||(n.o=1,uh(16),i=!1),n.i=n.i&&i,i?0<e.length&&!n.$&&(n.$=!0,(t=n.l).g==n&&t.$&&!t.K&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+e.length),b1(t),t.K=!0,uh(11))):(pv(n.j,n.m,e,"[Invalid Chunked Response]"),gv(n),Db(n))}function LR(n,t){var e=n.C,i=t.indexOf("\n",e);return-1==i?mv:(e=Number(t.substring(e,i)),isNaN(e)?bA:(i+=1)+e>t.length?mv:(t=t.substr(i,e),n.C=i+e,t))}function Ib(n){n.V=Date.now()+n.O,xA(n,n.O)}function xA(n,t){if(null!=n.B)throw Error("WatchDog timer not null");n.B=c1(Du(n.gb,n),t)}function H_(n){n.B&&(lr.clearTimeout(n.B),n.B=null)}function Db(n){0==n.l.G||n.I||zA(n.l,n)}function gv(n){H_(n);var t=n.L;t&&"function"==typeof t.na&&t.na(),n.L=null,gT(n.T),dA(n.S),n.g&&(t=n.g,n.g=null,t.abort(),t.na())}function CA(n,t){try{var e=n.l;if(0!=e.G&&(e.g==n||gp(e.h,n)))if(!n.J&&gp(e.h,n)&&3==e.G){try{var i=e.Fa.g.parse(t)}catch{i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!e.u){if(e.g){if(!(e.g.F+3e3<n.F))break e;xv(e),zT(e)}um(e),uh(18)}}else e.Ba=r[1],0<e.Ba-e.T&&37500>r[2]&&e.L&&0==e.A&&!e.v&&(e.v=c1(Du(e.cb,e),6e3));if(1>=f1(e.h)&&e.ja){try{e.ja()}catch{}e.ja=void 0}}else hm(e,11)}else if((n.J||e.g==n)&&xv(e),!Kx(t))for(r=e.Fa.g.parse(t),t=0;t<r.length;t++){let j=r[t];if(e.T=j[0],j=j[1],2==e.G)if("c"==j[0]){e.I=j[1],e.ka=j[2];const Y=j[3];null!=Y&&(e.ma=Y,e.j.info("VER="+e.ma));const se=j[4];null!=se&&(e.Ca=se,e.j.info("SVER="+e.Ca));const be=j[5];null!=be&&"number"==typeof be&&0<be&&(e.J=i=1.5*be,e.j.info("backChannelRequestTimeoutMs_="+i)),i=e;const Me=n.g;if(Me){const Ge=Me.g?Me.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ge){var a=i.h;a.g||-1==Ge.indexOf("spdy")&&-1==Ge.indexOf("quic")&&-1==Ge.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(kT(a,a.h),a.h=null))}if(i.D){const _t=Me.g?Me.g.getResponseHeader("X-HTTP-Session-Id"):null;_t&&(i.za=_t,ea(i.F,i.D,_t))}}e.G=3,e.l&&e.l.xa(),e.$&&(e.P=Date.now()-n.F,e.j.info("Handshake RTT: "+e.P+"ms"));var g=n;if((i=e).sa=qR(i,i.H?i.ka:null,i.V),g.J){VR(i.h,g);var E=g,O=i.J;O&&E.setTimeout(O),E.B&&(H_(E),Ib(E)),i.g=g}else VT(i);0<e.i.length&&BT(e)}else"stop"!=j[0]&&"close"!=j[0]||hm(e,7);else 3==e.G&&("stop"==j[0]||"close"==j[0]?"stop"==j[0]?hm(e,7):FA(e):"noop"!=j[0]&&e.l&&e.l.wa(j),e.A=0)}Tb()}catch{}}function EA(n,t){if(n.forEach&&"function"==typeof n.forEach)n.forEach(t,void 0);else if(gb(n)||"string"==typeof n)Array.prototype.forEach.call(n,t,void 0);else for(var e=function FR(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(gb(n)||"string"==typeof n){var t=[];n=n.length;for(var e=0;e<n;e++)t.push(e);return t}t=[],e=0;for(const i in n)t[e++]=i;return t}}}(n),i=function tz(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(gb(n)){for(var t=[],e=n.length,i=0;i<e;i++)t.push(n[i]);return t}for(i in t=[],e=0,n)t[e++]=n[i];return t}(n),r=i.length,a=0;a<r;a++)t.call(void 0,i[a],e&&e[a],n)}(Si=Eg.prototype).setTimeout=function(n){this.O=n},Si.ib=function(n){n=n.target;const t=this.L;t&&3==Sg(n)?t.l():this.La(n)},Si.La=function(n){try{if(n==this.g)e:{const Y=Sg(this.g);var t=this.g.Ea();if(this.g.aa(),!(3>Y)&&(3!=Y||e1||this.g&&(this.h.h||this.g.fa()||FT(this.g)))){this.I||4!=Y||7==t||Tb(),H_(this);var e=this.g.aa();this.Y=e;t:if(ET(this)){var i=FT(this.g);n="";var r=i.length,a=4==Sg(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){gv(this),Db(this);var g="";break t}this.h.i=new lr.TextDecoder}for(t=0;t<r;t++)this.h.h=!0,n+=this.h.i.decode(i[t],{stream:a&&t==r-1});i.splice(0,r),this.h.g+=n,this.C=0,g=this.h.g}else g=this.g.fa();if(this.i=200==e,function AR(n,t,e,i,r,a,g){n.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+t+"\n"+e+"\n"+a+" "+g})}(this.j,this.u,this.A,this.m,this.U,Y,e),this.i){if(this.Z&&!this.J){t:{if(this.g){var E,O=this.g;if((E=O.g?O.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Kx(E)){var j=E;break t}}j=null}if(!(e=j)){this.i=!1,this.o=3,uh(12),gv(this),Db(this);break e}pv(this.j,this.m,e,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,CA(this,e)}this.P?(OR(this,Y,g),e1&&this.i&&3==Y&&(yT(this.S,this.T,"tick",this.hb),this.T.start())):(pv(this.j,this.m,g,null),CA(this,g)),4==Y&&gv(this),this.i&&!this.I&&(4==Y?zA(this.l,this):(this.i=!1,Ib(this)))}else 400==e&&0<g.indexOf("Unknown SID")?(this.o=3,uh(12)):(this.o=0,uh(13)),gv(this),Db(this)}}}catch{}},Si.hb=function(){if(this.g){var n=Sg(this.g),t=this.g.fa();this.C<t.length&&(H_(this),OR(this,n,t),this.i&&4!=n&&Ib(this))}},Si.cancel=function(){this.I=!0,gv(this)},Si.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function fA(n,t){n.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(Tb(),uh(17)),gv(this),this.o=2,Db(this)):xA(this,this.V-n)};var TA=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function j_(n,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof j_){this.h=void 0!==t?t:n.h,Ab(this,n.j),this.s=n.s,this.g=n.g,TT(this,n.m),this.l=n.l,t=n.i;var e=new yv;e.i=t.i,t.g&&(e.g=new Map(t.g),e.h=t.h),Ld(this,e),this.o=n.o}else n&&(e=String(n).match(TA))?(this.h=!!t,Ab(this,e[1]||"",!0),this.s=Mb(e[2]||""),this.g=Mb(e[3]||"",!0),TT(this,e[4]),this.l=Mb(e[5]||"",!0),Ld(this,e[6]||"",!0),this.o=Mb(e[7]||"")):(this.h=!!t,this.i=new yv(null,this.h))}function mf(n){return new j_(n)}function Ab(n,t,e){n.j=e?Mb(t,!0):t,n.j&&(n.j=n.j.replace(/:$/,""))}function TT(n,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);n.m=t}else n.m=null}function Ld(n,t,e){t instanceof yv?(n.i=t,function DA(n,t){t&&!n.j&&(cm(n),n.i=null,n.g.forEach(function(e,i){var r=i.toLowerCase();i!=r&&(IA(this,i),AT(this,r,e))},n)),n.j=t}(n.i,n.h)):(e||(t=d1(t,zR)),n.i=new yv(t,n.h))}function ea(n,t,e){n.i.set(t,e)}function _v(n){return ea(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Mb(n,t){return n?t?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function d1(n,t,e){return"string"==typeof n?(n=encodeURI(n).replace(t,Fd),e&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Fd(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}j_.prototype.toString=function(){var n=[],t=this.j;t&&n.push(d1(t,SA,!0),":");var e=this.g;return(e||"file"==t)&&(n.push("//"),(t=this.s)&&n.push(d1(t,SA,!0),"@"),n.push(encodeURIComponent(String(e)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(e=this.m)&&n.push(":",String(e))),(e=this.l)&&(this.g&&"/"!=e.charAt(0)&&n.push("/"),n.push(d1(e,"/"==e.charAt(0)?NR:ST,!0))),(e=this.i.toString())&&n.push("?",e),(e=this.o)&&n.push("#",d1(e,IT)),n.join("")};var SA=/[#\/\?@]/g,ST=/[#\?:]/g,NR=/[#\?]/g,zR=/[#\?@]/g,IT=/#/g;function yv(n,t){this.h=this.g=null,this.i=n||null,this.j=!!t}function cm(n){n.g||(n.g=new Map,n.h=0,n.i&&function nz(n,t){if(n){n=n.split("&");for(var e=0;e<n.length;e++){var i=n[e].indexOf("="),r=null;if(0<=i){var a=n[e].substring(0,i);r=n[e].substring(i+1)}else a=n[e];t(a,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(n.i,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function IA(n,t){cm(n),t=vv(n,t),n.g.has(t)&&(n.i=null,n.h-=n.g.get(t).length,n.g.delete(t))}function DT(n,t){return cm(n),t=vv(n,t),n.g.has(t)}function AT(n,t,e){IA(n,t),0<e.length&&(n.i=null,n.g.set(vv(n,t),B_(e)),n.h+=e.length)}function vv(n,t){return t=String(t),n.j&&(t=t.toLowerCase()),t}function p1(n){this.l=n||Tg,n=lr.PerformanceNavigationTiming?0<(n=lr.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(lr.g&&lr.g.Ga&&lr.g.Ga()&&lr.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Si=yv.prototype).add=function(n,t){cm(this),this.i=null,n=vv(this,n);var e=this.g.get(n);return e||this.g.set(n,e=[]),e.push(t),this.h+=1,this},Si.forEach=function(n,t){cm(this),this.g.forEach(function(e,i){e.forEach(function(r){n.call(t,r,i,this)},this)},this)},Si.oa=function(){cm(this);const n=Array.from(this.g.values()),t=Array.from(this.g.keys()),e=[];for(let i=0;i<t.length;i++){const r=n[i];for(let a=0;a<r.length;a++)e.push(t[i])}return e},Si.W=function(n){cm(this);let t=[];if("string"==typeof n)DT(this,n)&&(t=t.concat(this.g.get(vv(this,n))));else{n=Array.from(this.g.values());for(let e=0;e<n.length;e++)t=t.concat(n[e])}return t},Si.set=function(n,t){return cm(this),this.i=null,DT(this,n=vv(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[t]),this.h+=1,this},Si.get=function(n,t){return n&&0<(n=this.W(n)).length?String(n[0]):t},Si.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],t=Array.from(this.g.keys());for(var e=0;e<t.length;e++){var i=t[e];const a=encodeURIComponent(String(i)),g=this.W(i);for(i=0;i<g.length;i++){var r=a;""!==g[i]&&(r+="="+encodeURIComponent(String(g[i]))),n.push(r)}}return this.i=n.join("&")};var Tg=10;function MT(n){return!!n.h||!!n.g&&n.g.size>=n.j}function f1(n){return n.h?1:n.g?n.g.size:0}function gp(n,t){return n.h?n.h==t:!!n.g&&n.g.has(t)}function kT(n,t){n.g?n.g.add(t):n.h=t}function VR(n,t){n.h&&n.h==t?n.h=null:n.g&&n.g.has(t)&&n.g.delete(t)}function AA(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let t=n.i;for(const e of n.g.values())t=t.concat(e.D);return t}return B_(n.i)}function RT(){}function UR(){this.g=new RT}function HR(n,t,e){const i=e||"";try{EA(n,function(r,a){let g=r;sv(r)&&(g=o1(r)),t.push(i+a+"="+encodeURIComponent(g))})}catch(r){throw t.push(i+"type="+encodeURIComponent("_badmap")),r}}function PT(n,t,e,i,r){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,r(i)}catch{}}function bv(n){this.l=n.ac||null,this.j=n.jb||!1}function m1(n,t){Ll.call(this),this.D=n,this.u=t,this.m=void 0,this.readyState=g1,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}p1.prototype.cancel=function(){if(this.i=AA(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},RT.prototype.stringify=function(n){return lr.JSON.stringify(n,void 0)},RT.prototype.parse=function(n){return lr.JSON.parse(n,void 0)},_c(bv,gA),bv.prototype.g=function(){return new m1(this.l,this.j)},bv.prototype.i=function(n){return function(){return n}}({}),_c(m1,Ll);var g1=0;function jR(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function G_(n){n.readyState=4,n.l=null,n.j=null,n.A=null,wv(n)}function wv(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(Si=m1.prototype).open=function(n,t){if(this.readyState!=g1)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=t,this.readyState=1,wv(this)},Si.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(t.body=n),(this.D||lr).fetch(new Request(this.B,t)).then(this.Wa.bind(this),this.ga.bind(this))},Si.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,G_(this)),this.readyState=g1},Si.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,wv(this)),this.g&&(this.readyState=3,wv(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof lr.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;jR(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},Si.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var t=n.value?n.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!n.done}))&&(this.response=this.responseText+=t)}n.done?G_(this):wv(this),3==this.readyState&&jR(this)}},Si.Va=function(n){this.g&&(this.response=this.responseText=n,G_(this))},Si.Ua=function(n){this.g&&(this.response=n,G_(this))},Si.ga=function(){this.g&&G_(this)},Si.setRequestHeader=function(n,t){this.v.append(n,t)},Si.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},Si.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],t=this.h.entries();for(var e=t.next();!e.done;)n.push((e=e.value)[0]+": "+e[1]),e=t.next();return n.join("\r\n")},Object.defineProperty(m1.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var kA=lr.JSON.parse;function ha(n){Ll.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=OT,this.K=this.L=!1}_c(ha,Ll);var OT="",RA=/^https?$/i,_1=["POST","PUT"];function LT(n,t){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=t,n.m=5,PA(n),v1(n)}function PA(n){n.D||(n.D=!0,vc(n,"complete"),vc(n,"error"))}function OA(n){if(n.h&&typeof KE<"u"&&(!n.C[1]||4!=Sg(n)||2!=n.aa()))if(n.v&&4==Sg(n))uA(n.Ha,0,n);else if(vc(n,"readystatechange"),4==Sg(n)){n.h=!1;try{const E=n.aa();e:switch(E){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var e;if(!(e=t)){var i;if(i=0===E){var r=String(n.H).match(TA)[1]||null;if(!r&&lr.self&&lr.self.location){var a=lr.self.location.protocol;r=a.substr(0,a.length-1)}i=!RA.test(r?r.toLowerCase():"")}e=i}if(e)vc(n,"complete"),vc(n,"success");else{n.m=6;try{var g=2<Sg(n)?n.g.statusText:""}catch{g=""}n.j=g+" ["+n.aa()+"]",PA(n)}}finally{v1(n)}}}function v1(n,t){if(n.g){GR(n);const e=n.g,i=n.C[0]?bg:null;n.g=null,n.C=null,t||vc(n,"ready");try{e.onreadystatechange=i}catch{}}}function GR(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(lr.clearTimeout(n.A),n.A=null)}function Sg(n){return n.g?n.g.readyState:0}function FT(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case OT:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function LA(n){let t="";return iT(n,function(e,i){t+=i,t+=":",t+=e,t+="\r\n"}),t}function NT(n,t,e){e:{for(i in e){var i=!1;break e}i=!0}i||(e=LA(e),"string"==typeof n?null!=e&&encodeURIComponent(String(e)):ea(n,t,e))}function kb(n,t,e){return e&&e.internalChannelParams&&e.internalChannelParams[n]||t}function $R(n){this.Ca=0,this.i=[],this.j=new Cb,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=kb("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=kb("baseRetryDelayMs",5e3,n),this.bb=kb("retryDelaySeedMs",1e4,n),this.$a=kb("forwardChannelMaxRetries",2,n),this.ta=kb("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new p1(n&&n.concurrentRequestLimit),this.Fa=new UR,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function FA(n){if(WR(n),3==n.G){var t=n.U++,e=mf(n.F);ea(e,"SID",n.I),ea(e,"RID",t),ea(e,"TYPE","terminate"),Pb(n,e),(t=new Eg(n,n.j,t,void 0)).K=2,t.v=_v(mf(e)),e=!1,lr.navigator&&lr.navigator.sendBeacon&&(e=lr.navigator.sendBeacon(t.v.toString(),"")),!e&&lr.Image&&((new Image).src=t.v,e=!0),e||(t.g=KR(t.l,null),t.g.da(t.v)),t.F=Date.now(),Ib(t)}Ob(n)}function zT(n){n.g&&(b1(n),n.g.cancel(),n.g=null)}function WR(n){zT(n),n.u&&(lr.clearTimeout(n.u),n.u=null),xv(n),n.h.cancel(),n.m&&("number"==typeof n.m&&lr.clearTimeout(n.m),n.m=null)}function BT(n){MT(n.h)||n.m||(n.m=!0,cA(n.Ja,n),n.C=0)}function Rb(n,t){var e;e=t?t.m:n.U++;const i=mf(n.F);ea(i,"SID",n.I),ea(i,"RID",e),ea(i,"AID",n.T),Pb(n,i),n.o&&n.s&&NT(i,n.o,n.s),e=new Eg(n,n.j,e,n.C+1),null===n.o&&(e.H=n.s),t&&(n.i=t.D.concat(n.i)),t=NA(n,e,1e3),e.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),kT(n.h,e),h1(e,i,t)}function Pb(n,t){n.ia&&iT(n.ia,function(e,i){ea(t,i,e)}),n.l&&EA({},function(e,i){ea(t,i,e)})}function NA(n,t,e){e=Math.min(n.i.length,e);var i=n.l?Du(n.l.Ra,n.l,n):null;e:{var r=n.i;let a=-1;for(;;){const g=["count="+e];-1==a?0<e?(a=r[0].h,g.push("ofs="+a)):a=0:g.push("ofs="+a);let E=!0;for(let O=0;O<e;O++){let j=r[O].h;const Y=r[O].g;if(j-=a,0>j)a=Math.max(0,r[O].h-100),E=!1;else try{HR(Y,g,"req"+j+"_")}catch{i&&i(Y)}}if(E){i=g.join("&");break e}}}return n=n.i.splice(0,e),t.D=n,i}function VT(n){n.g||n.u||(n.Z=1,cA(n.Ia,n),n.A=0)}function um(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=c1(Du(n.Ia,n),x1(n,n.A)),n.A++,0))}function b1(n){null!=n.B&&(lr.clearTimeout(n.B),n.B=null)}function w1(n){n.g=new Eg(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var t=mf(n.sa);ea(t,"RID","rpc"),ea(t,"SID",n.I),ea(t,"CI",n.L?"0":"1"),ea(t,"AID",n.T),ea(t,"TYPE","xmlhttp"),Pb(n,t),n.o&&n.s&&NT(t,n.o,n.s),n.J&&n.g.setTimeout(n.J);var e=n.g;n=n.ka,e.K=1,e.v=_v(mf(t)),e.s=null,e.P=!0,wA(e,n)}function xv(n){null!=n.v&&(lr.clearTimeout(n.v),n.v=null)}function zA(n,t){var e=null;if(n.g==t){xv(n),b1(n),n.g=null;var i=2}else{if(!gp(n.h,t))return;e=t.D,VR(n.h,t),i=1}if(0!=n.G)if(n.pa=t.Y,t.i)if(1==i){e=t.s?t.s.length:0,t=Date.now()-t.F;var r=n.C;vc(i=Eb(),new wT(i,e)),BT(n)}else VT(n);else if(3==(r=t.o)||0==r&&0<n.pa||!(1==i&&function ZR(n,t){return!(f1(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=t.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=c1(Du(n.Ja,n,t),x1(n,n.C)),n.C++,0)))}(n,t)||2==i&&um(n)))switch(e&&0<e.length&&(t=n.h,t.i=t.i.concat(e)),r){case 1:hm(n,5);break;case 4:hm(n,10);break;case 3:hm(n,6);break;default:hm(n,2)}}function x1(n,t){let e=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(e*=2),e*t}function hm(n,t){if(n.j.info("Error code "+t),2==t){var e=null;n.l&&(e=null);var i=Du(n.kb,n);e||(e=new j_("//www.google.com/images/cleardot.gif"),lr.location&&"http"==lr.location.protocol||Ab(e,"https"),_v(e)),function MA(n,t){const e=new Cb;if(lr.Image){const i=new Image;i.onload=_b(PT,e,i,"TestLoadImage: loaded",!0,t),i.onerror=_b(PT,e,i,"TestLoadImage: error",!1,t),i.onabort=_b(PT,e,i,"TestLoadImage: abort",!1,t),i.ontimeout=_b(PT,e,i,"TestLoadImage: timeout",!1,t),lr.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n}else t(!1)}(e.toString(),i)}else uh(2);n.G=0,n.l&&n.l.va(t),Ob(n),WR(n)}function Ob(n){if(n.G=0,n.la=[],n.l){const t=AA(n.h);(0!=t.length||0!=n.i.length)&&(XD(n.la,t),XD(n.la,n.i),n.h.i.length=0,B_(n.i),n.i.length=0),n.l.ua()}}function qR(n,t,e){var i=e instanceof j_?mf(e):new j_(e,void 0);if(""!=i.g)t&&(i.g=t+"."+i.g),TT(i,i.m);else{var r=lr.location;i=r.protocol,t=t?t+"."+r.hostname:r.hostname,r=+r.port;var a=new j_(null,void 0);i&&Ab(a,i),t&&(a.g=t),r&&TT(a,r),e&&(a.l=e),i=a}return t=n.za,(e=n.D)&&t&&ea(i,e,t),ea(i,"VER",n.ma),Pb(n,i),i}function KR(n,t,e){if(t&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new ha(e&&n.Da&&!n.ra?new bv({jb:!0}):n.ra)).Ka(n.H),t}function YR(){}function UT(){if(av&&!(10<=Number(SR)))throw Error("Environmental error: no available transport.")}function hh(n,t){Ll.call(this),this.g=new $R(t),this.l=n,this.h=t&&t.messageUrlParams||null,n=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(n?n["X-WebChannel-Content-Type"]=t.messageContentType:n={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(n?n["X-WebChannel-Client-Profile"]=t.ya:n={"X-WebChannel-Client-Profile":t.ya}),this.g.S=n,(n=t&&t.Yb)&&!Kx(n)&&(this.g.o=n),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Kx(t)&&(this.g.D=t,null!==(n=this.h)&&t in n&&t in(n=this.h)&&delete n[t]),this.j=new Cv(this)}function BA(n){_A.call(this);var t=n.__sm__;if(t){e:{for(const e in t){n=e;break e}n=void 0}(this.i=n)&&(n=this.i,t=null!==t&&n in t?t[n]:void 0),this.data=t}else this.data=n}function VA(){fv.call(this),this.status=1}function Cv(n){this.g=n}(Si=ha.prototype).Ka=function(n){this.L=n},Si.da=function(n,t,e,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);t=t?t.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():yA.g(),this.C=function RR(n){return n.h||(n.h=n.i())}(this.u?this.u:yA),this.g.onreadystatechange=Du(this.Ha,this);try{this.F=!0,this.g.open(t,String(n),!0),this.F=!1}catch(a){return void LT(this,a)}if(n=e||"",e=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)e.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const a of i.keys())e.set(a,i.get(a))}i=Array.from(e.keys()).find(a=>"content-type"==a.toLowerCase()),r=lr.FormData&&n instanceof lr.FormData,!(0<=QD(_1,t))||i||r||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,g]of e)this.g.setRequestHeader(a,g);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{GR(this),0<this.B&&((this.K=function y1(n){return av&&function TR(){return function Qx(n){var t=eT;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=n(9)}(function(){let n=0;const t=Yx(String(lv)).split("."),e=Yx("9").split("."),i=Math.max(t.length,e.length);for(let g=0;0==n&&g<i;g++){var r=t[g]||"",a=e[g]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==r[0].length&&0==a[0].length)break;n=V_(0==r[1].length?0:parseInt(r[1],10),0==a[1].length?0:parseInt(a[1],10))||V_(0==r[2].length,0==a[2].length)||V_(r[2],a[2]),r=r[3],a=a[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Du(this.qa,this)):this.A=uA(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(a){LT(this,a)}},Si.qa=function(){typeof KE<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,vc(this,"timeout"),this.abort(8))},Si.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,vc(this,"complete"),vc(this,"abort"),v1(this))},Si.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),v1(this,!0)),ha.X.M.call(this)},Si.Ha=function(){this.s||(this.F||this.v||this.l?OA(this):this.fb())},Si.fb=function(){OA(this)},Si.aa=function(){try{return 2<Sg(this)?this.g.status:-1}catch{return-1}},Si.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},Si.Sa=function(n){if(this.g){var t=this.g.responseText;return n&&0==t.indexOf(n)&&(t=t.substring(n.length)),kA(t)}},Si.Ea=function(){return this.m},Si.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Si=$R.prototype).ma=8,Si.G=1,Si.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const r=new Eg(this,this.j,n,void 0);let a=this.s;if(this.S&&(a?(a=rT(a),rA(a,this.S)):a=this.S),null!==this.o||this.N||(r.H=a,a=null),this.O)e:{for(var t=0,e=0;e<this.i.length;e++){var i=this.i[e];if(void 0===(i="__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=e;break e}if(4096===t||e===this.i.length-1){t=e+1;break e}}t=1e3}else t=1e3;t=NA(this,r,t),ea(e=mf(this.F),"RID",n),ea(e,"CVER",22),this.D&&ea(e,"X-HTTP-Session-Id",this.D),Pb(this,e),a&&(this.N?t="headers="+encodeURIComponent(String(LA(a)))+"&"+t:this.o&&NT(e,this.o,a)),kT(this.h,r),this.Ya&&ea(e,"TYPE","init"),this.O?(ea(e,"$req",t),ea(e,"SID","null"),r.Z=!0,h1(r,e,null)):h1(r,e,t),this.G=2}}else 3==this.G&&(n?Rb(this,n):0==this.i.length||MT(this.h)||Rb(this))},Si.Ia=function(){if(this.u=null,w1(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=c1(Du(this.eb,this),n)}},Si.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,uh(10),zT(this),w1(this))},Si.cb=function(){null!=this.v&&(this.v=null,zT(this),um(this),uh(19))},Si.kb=function(n){n?(this.j.info("Successfully pinged google.com"),uh(2)):(this.j.info("Failed to ping google.com"),uh(1))},(Si=YR.prototype).xa=function(){},Si.wa=function(){},Si.va=function(){},Si.ua=function(){},Si.Ra=function(){},UT.prototype.g=function(n,t){return new hh(n,t)},_c(hh,Ll),hh.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,t=this.l,e=this.h||void 0;uh(0),n.V=t,n.ia=e||{},n.L=n.Y,n.F=qR(n,null,n.V),BT(n)},hh.prototype.close=function(){FA(this.g)},hh.prototype.u=function(n){var t=this.g;if("string"==typeof n){var e={};e.__data__=n,n=e}else this.v&&((e={}).__data__=o1(n),n=e);t.i.push(new class{constructor(n,t){this.h=n,this.g=t}}(t.ab++,n)),3==t.G&&BT(t)},hh.prototype.M=function(){this.g.l=null,delete this.j,FA(this.g),delete this.g,hh.X.M.call(this)},_c(BA,_A),_c(VA,fv),_c(Cv,YR),Cv.prototype.xa=function(){vc(this.g,"a")},Cv.prototype.wa=function(n){vc(this.g,new BA(n))},Cv.prototype.va=function(n){vc(this.g,new VA)},Cv.prototype.ua=function(){vc(this.g,"b")},UT.prototype.createWebChannel=UT.prototype.g,hh.prototype.send=hh.prototype.u,hh.prototype.open=hh.prototype.m,hh.prototype.close=hh.prototype.close,xT.NO_ERROR=0,xT.TIMEOUT=8,xT.HTTP_ERROR=6,kR.COMPLETE="complete",PR.EventType=u1,u1.OPEN="a",u1.CLOSE="b",u1.ERROR="c",u1.MESSAGE="d",Ll.prototype.listen=Ll.prototype.N,ha.prototype.listenOnce=ha.prototype.O,ha.prototype.getLastError=ha.prototype.Oa,ha.prototype.getLastErrorCode=ha.prototype.Ea,ha.prototype.getStatus=ha.prototype.aa,ha.prototype.getResponseJson=ha.prototype.Sa,ha.prototype.getResponseText=ha.prototype.fa,ha.prototype.send=ha.prototype.da,ha.prototype.setWithCredentials=ha.prototype.Ka;var JR=df.createWebChannelTransport=function(){return new UT},UA=df.getStatEventTarget=function(){return Eb()},C1=df.ErrorCode=xT,HA=df.EventType=kR,QR=df.Event=Cg,jA=df.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},GA=df.FetchXmlHttpFactory=bv,Ev=df.WebChannel=PR,iz=df.XhrIo=ha;const HT="@firebase/firestore";class Ha{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Ha.UNAUTHENTICATED=new Ha(null),Ha.GOOGLE_CREDENTIALS=new Ha("google-credentials-uid"),Ha.FIRST_PARTY=new Ha("first-party-uid"),Ha.MOCK_USER=new Ha("mock-user");let Tv="9.17.1";const Ig=new $e.Yd("@firebase/firestore");function $A(){return Ig.logLevel}function kn(n,...t){if(Ig.logLevel<=$e.in.DEBUG){const e=t.map(WA);Ig.debug(`Firestore (${Tv}): ${n}`,...e)}}function Aa(n,...t){if(Ig.logLevel<=$e.in.ERROR){const e=t.map(WA);Ig.error(`Firestore (${Tv}): ${n}`,...e)}}function $_(n,...t){if(Ig.logLevel<=$e.in.WARN){const e=t.map(WA);Ig.warn(`Firestore (${Tv}): ${n}`,...e)}}function WA(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function fi(n="Unexpected state"){const t=`FIRESTORE (${Tv}) INTERNAL ASSERTION FAILED: `+n;throw Aa(t),new Error(t)}function Ii(n,t){n||fi()}function Qn(n,t){return n}const Wt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Cn extends Be.ZR{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Fl{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class XR{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class sz{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(Ha.UNAUTHENTICATED))}shutdown(){}}class az{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class lz{constructor(t){this.t=t,this.currentUser=Ha.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){var i=this;let r=this.i;const a=j=>this.i!==r?(r=this.i,e(j)):Promise.resolve();let g=new Fl;this.o=()=>{this.i++,this.currentUser=this.u(),g.resolve(),g=new Fl,t.enqueueRetryable(()=>a(this.currentUser))};const E=()=>{const j=g;t.enqueueRetryable((0,ve.Z)(function*(){yield j.promise,yield a(i.currentUser)}))},O=j=>{kn("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=j,this.auth.addAuthTokenListener(this.o),E()};this.t.onInit(j=>O(j)),setTimeout(()=>{if(!this.auth){const j=this.t.getImmediate({optional:!0});j?O(j):(kn("FirebaseAuthCredentialsProvider","Auth not yet detected"),g.resolve(),g=new Fl)}},0),E()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(i=>this.i!==t?(kn("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ii("string"==typeof i.accessToken),new XR(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Ii(null===t||"string"==typeof t),new Ha(t)}}class d{constructor(t,e,i,r){this.h=t,this.l=e,this.m=i,this.g=r,this.type="FirstParty",this.user=Ha.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(Ii(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.p.set("Authorization",t),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class p{constructor(t,e,i,r){this.h=t,this.l=e,this.m=i,this.g=r}getToken(){return Promise.resolve(new d(this.h,this.l,this.m,this.g))}start(t,e){t.enqueueRetryable(()=>e(Ha.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class m{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class x{constructor(t){this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(t,e){const i=a=>{null!=a.error&&kn("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const g=a.token!==this.A;return this.A=a.token,kn("FirebaseAppCheckTokenProvider",`Received ${g?"new":"existing"} token.`),g?e(a.token):Promise.resolve()};this.o=a=>{t.enqueueRetryable(()=>i(a))};const r=a=>{kn("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.appCheck.addTokenListener(this.o)};this.T.onInit(a=>r(a)),setTimeout(()=>{if(!this.appCheck){const a=this.T.getImmediate({optional:!0});a?r(a):kn("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(Ii("string"==typeof e.token),this.A=e.token,new m(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function L(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(let i=0;i<n;i++)e[i]=Math.floor(256*Math.random());return e}class H{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let i="";for(;i.length<20;){const r=L(40);for(let a=0;a<r.length;++a)i.length<20&&r[a]<e&&(i+=t.charAt(r[a]%t.length))}return i}}function q(n,t){return n<t?-1:n>t?1:0}function ne(n,t,e){return n.length===t.length&&n.every((i,r)=>e(i,t[r]))}function ce(n){return n+"\0"}class ge{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Cn(Wt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Cn(Wt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Cn(Wt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Cn(Wt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return ge.fromMillis(Date.now())}static fromDate(t){return ge.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),i=Math.floor(1e6*(t-1e3*e));return new ge(e,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?q(this.nanoseconds,t.nanoseconds):q(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ae{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Ae(t)}static min(){return new Ae(new ge(0,0))}static max(){return new Ae(new ge(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class lt{constructor(t,e,i){void 0===e?e=0:e>t.length&&fi(),void 0===i?i=t.length-e:i>t.length-e&&fi(),this.segments=t,this.offset=e,this.len=i}get length(){return this.len}isEqual(t){return 0===lt.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof lt?t.forEach(i=>{e.push(i)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,i=this.limit();e<i;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const i=Math.min(t.length,e.length);for(let r=0;r<i;r++){const a=t.get(r),g=e.get(r);if(a<g)return-1;if(a>g)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class mt extends lt{construct(t,e,i){return new mt(t,e,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const i of t){if(i.indexOf("//")>=0)throw new Cn(Wt.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter(r=>r.length>0))}return new mt(e)}static emptyPath(){return new mt([])}}const an=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gn extends lt{construct(t,e,i){return new gn(t,e,i)}static isValidIdentifier(t){return an.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gn.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new gn(["__name__"])}static fromServerFormat(t){const e=[];let i="",r=0;const a=()=>{if(0===i.length)throw new Cn(Wt.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(i),i=""};let g=!1;for(;r<t.length;){const E=t[r];if("\\"===E){if(r+1===t.length)throw new Cn(Wt.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const O=t[r+1];if("\\"!==O&&"."!==O&&"`"!==O)throw new Cn(Wt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=O,r+=2}else"`"===E?(g=!g,r++):"."!==E||g?(i+=E,r++):(a(),r++)}if(a(),g)throw new Cn(Wt.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new gn(e)}static emptyPath(){return new gn([])}}class Ut{constructor(t){this.path=t}static fromPath(t){return new Ut(mt.fromString(t))}static fromName(t){return new Ut(mt.fromString(t).popFirst(5))}static empty(){return new Ut(mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===mt.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return mt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Ut(new mt(t.slice()))}}class pi{constructor(t,e,i,r){this.indexId=t,this.collectionGroup=e,this.fields=i,this.indexState=r}}function Zi(n){return n.fields.find(t=>2===t.kind)}function bn(n){return n.fields.filter(t=>2!==t.kind)}pi.UNKNOWN_ID=-1;class fs{constructor(t,e){this.fieldPath=t,this.kind=e}}class E1{constructor(t,e){this.sequenceNumber=t,this.offset=e}static empty(){return new E1(0,_p.min())}}function cz(n,t){const e=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Ae.fromTimestamp(1e9===i?new ge(e+1,0):new ge(e,i));return new _p(r,Ut.empty(),t)}function uz(n){return new _p(n.readTime,n.key,-1)}class _p{constructor(t,e,i){this.readTime=t,this.documentKey=e,this.largestBatchId=i}static min(){return new _p(Ae.min(),Ut.empty(),-1)}static max(){return new _p(Ae.max(),Ut.empty(),-1)}}function eP(n,t){let e=n.readTime.compareTo(t.readTime);return 0!==e?e:(e=Ut.comparator(n.documentKey,t.documentKey),0!==e?e:q(n.largestBatchId,t.largestBatchId))}const hz="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class dz{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}function Sv(n){return tP.apply(this,arguments)}function tP(){return tP=(0,ve.Z)(function*(n){if(n.code!==Wt.FAILED_PRECONDITION||n.message!==hz)throw n;kn("LocalStore","Unexpectedly lost primary lease")}),tP.apply(this,arguments)}class jt{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&fi(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new jt((i,r)=>{this.nextCallback=a=>{this.wrapSuccess(t,a).next(i,r)},this.catchCallback=a=>{this.wrapFailure(e,a).next(i,r)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof jt?e:jt.resolve(e)}catch(e){return jt.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):jt.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):jt.reject(e)}static resolve(t){return new jt((e,i)=>{e(t)})}static reject(t){return new jt((e,i)=>{i(t)})}static waitFor(t){return new jt((e,i)=>{let r=0,a=0,g=!1;t.forEach(E=>{++r,E.next(()=>{++a,g&&a===r&&e()},O=>i(O))}),g=!0,a===r&&e()})}static or(t){let e=jt.resolve(!1);for(const i of t)e=e.next(r=>r?jt.resolve(r):i());return e}static forEach(t,e){const i=[];return t.forEach((r,a)=>{i.push(e.call(this,r,a))}),this.waitFor(i)}static mapArray(t,e){return new jt((i,r)=>{const a=t.length,g=new Array(a);let E=0;for(let O=0;O<a;O++){const j=O;e(t[j]).next(Y=>{g[j]=Y,++E,E===a&&i(g)},Y=>r(Y))}})}static doWhile(t,e){return new jt((i,r)=>{const a=()=>{!0===t()?e().next(()=>{a()},r):i()};a()})}}class ZA{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.P=new Fl,this.transaction.oncomplete=()=>{this.P.resolve()},this.transaction.onabort=()=>{e.error?this.P.reject(new jT(t,e.error)):this.P.resolve()},this.transaction.onerror=i=>{const r=nP(i.target.error);this.P.reject(new jT(t,r))}}static open(t,e,i,r){try{return new ZA(e,t.transaction(r,i))}catch(a){throw new jT(e,a)}}get v(){return this.P.promise}abort(t){t&&this.P.reject(t),this.aborted||(kn("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}V(){const t=this.transaction;this.aborted||"function"!=typeof t.commit||t.commit()}store(t){const e=this.transaction.objectStore(t);return new e8(e)}}class dm{constructor(t,e,i){this.name=t,this.version=e,this.S=i,12.2===dm.D((0,Be.z$)())&&Aa("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return kn("SimpleDb","Removing database:",t),Lb(window.indexedDB.deleteDatabase(t)).toPromise()}static C(){if(!(0,Be.hl)())return!1;if(dm.N())return!0;const t=(0,Be.z$)(),e=dm.D(t),i=0<e&&e<10,r=dm.k(t),a=0<r&&r<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||i||a)}static N(){var t;return typeof process<"u"&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.O)}static M(t,e){return t.store(e)}static D(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(i)}static k(t){const e=t.match(/Android ([\d.]+)/i),i=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(i)}F(t){var e=this;return(0,ve.Z)(function*(){return e.db||(kn("SimpleDb","Opening database:",e.name),e.db=yield new Promise((i,r)=>{const a=indexedDB.open(e.name,e.version);a.onsuccess=g=>{i(g.target.result)},a.onblocked=()=>{r(new jT(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=g=>{const E=g.target.error;r("VersionError"===E.name?new Cn(Wt.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===E.name?new Cn(Wt.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+E):new jT(t,E))},a.onupgradeneeded=g=>{kn("SimpleDb",'Database "'+e.name+'" requires upgrade from version:',g.oldVersion),e.S.$(g.target.result,a.transaction,g.oldVersion,e.version).next(()=>{kn("SimpleDb","Database upgrade to version "+e.version+" complete")})}})),e.B&&(e.db.onversionchange=i=>e.B(i)),e.db})()}L(t){this.B=t,this.db&&(this.db.onversionchange=e=>t(e))}runTransaction(t,e,i,r){var a=this;return(0,ve.Z)(function*(){const g="readonly"===e;let E=0;for(;;){++E;try{a.db=yield a.F(t);const O=ZA.open(a.db,t,g?"readonly":"readwrite",i),j=r(O).next(Y=>(O.V(),Y)).catch(Y=>(O.abort(Y),jt.reject(Y))).toPromise();return j.catch(()=>{}),yield O.v,j}catch(O){const j=O,Y="FirebaseError"!==j.name&&E<3;if(kn("SimpleDb","Transaction failed with error:",j.message,"Retrying:",Y),a.close(),!Y)return Promise.reject(j)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class X${constructor(t){this.q=t,this.U=!1,this.K=null}get isDone(){return this.U}get G(){return this.K}set cursor(t){this.q=t}done(){this.U=!0}j(t){this.K=t}delete(){return Lb(this.q.delete())}}class jT extends Cn{constructor(t,e){super(Wt.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function Iv(n){return"IndexedDbTransactionError"===n.name}class e8{constructor(t){this.store=t}put(t,e){let i;return void 0!==e?(kn("SimpleDb","PUT",this.store.name,t,e),i=this.store.put(e,t)):(kn("SimpleDb","PUT",this.store.name,"<auto-key>",t),i=this.store.put(t)),Lb(i)}add(t){return kn("SimpleDb","ADD",this.store.name,t,t),Lb(this.store.add(t))}get(t){return Lb(this.store.get(t)).next(e=>(void 0===e&&(e=null),kn("SimpleDb","GET",this.store.name,t,e),e))}delete(t){return kn("SimpleDb","DELETE",this.store.name,t),Lb(this.store.delete(t))}count(){return kn("SimpleDb","COUNT",this.store.name),Lb(this.store.count())}W(t,e){const i=this.options(t,e);if(i.index||"function"!=typeof this.store.getAll){const r=this.cursor(i),a=[];return this.H(r,(g,E)=>{a.push(E)}).next(()=>a)}{const r=this.store.getAll(i.range);return new jt((a,g)=>{r.onerror=E=>{g(E.target.error)},r.onsuccess=E=>{a(E.target.result)}})}}J(t,e){const i=this.store.getAll(t,null===e?void 0:e);return new jt((r,a)=>{i.onerror=g=>{a(g.target.error)},i.onsuccess=g=>{r(g.target.result)}})}Y(t,e){kn("SimpleDb","DELETE ALL",this.store.name);const i=this.options(t,e);i.X=!1;const r=this.cursor(i);return this.H(r,(a,g,E)=>E.delete())}Z(t,e){let i;e?i=t:(i={},e=t);const r=this.cursor(i);return this.H(r,e)}tt(t){const e=this.cursor({});return new jt((i,r)=>{e.onerror=a=>{const g=nP(a.target.error);r(g)},e.onsuccess=a=>{const g=a.target.result;g?t(g.primaryKey,g.value).next(E=>{E?g.continue():i()}):i()}})}H(t,e){const i=[];return new jt((r,a)=>{t.onerror=g=>{a(g.target.error)},t.onsuccess=g=>{const E=g.target.result;if(!E)return void r();const O=new X$(E),j=e(E.primaryKey,E.value,O);if(j instanceof jt){const Y=j.catch(se=>(O.done(),jt.reject(se)));i.push(Y)}O.isDone?r():null===O.G?E.continue():E.continue(O.G)}}).next(()=>jt.waitFor(i))}options(t,e){let i;return void 0!==t&&("string"==typeof t?i=t:e=t),{index:i,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const i=this.store.index(t.index);return t.X?i.openKeyCursor(t.range,e):i.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function Lb(n){return new jt((t,e)=>{n.onsuccess=i=>{t(i.target.result)},n.onerror=i=>{const r=nP(i.target.error);e(r)}})}let pz=!1;function nP(n){const t=dm.D((0,Be.z$)());if(t>=12.2&&t<13){const e="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(e)>=0){const i=new Cn("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return pz||(pz=!0,setTimeout(()=>{throw i},0)),i}}return n}class t8{constructor(t,e){this.asyncQueue=t,this.et=e,this.task=null}start(){this.nt(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}nt(t){var e=this;kn("IndexBackiller",`Scheduled in ${t}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",t,(0,ve.Z)(function*(){e.task=null;try{kn("IndexBackiller",`Documents written: ${yield e.et.st()}`)}catch(i){Iv(i)?kn("IndexBackiller","Ignoring IndexedDB error during index backfill: ",i):yield Sv(i)}yield e.nt(6e4)}))}}class n8{constructor(t,e){this.localStore=t,this.persistence=e}st(t=50){var e=this;return(0,ve.Z)(function*(){return e.persistence.runTransaction("Backfill Indexes","readwrite-primary",i=>e.it(i,t))})()}it(t,e){const i=new Set;let r=e,a=!0;return jt.doWhile(()=>!0===a&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(t).next(g=>{if(null!==g&&!i.has(g))return kn("IndexBackiller",`Processing collection: ${g}`),this.rt(t,g,r).next(E=>{r-=E,i.add(g)});a=!1})).next(()=>e-r)}rt(t,e,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(t,e).next(r=>this.localStore.localDocuments.getNextDocuments(t,e,r,i).next(a=>{const g=a.changes;return this.localStore.indexManager.updateIndexEntries(t,g).next(()=>this.ot(r,a)).next(E=>(kn("IndexBackiller",`Updating offset: ${E}`),this.localStore.indexManager.updateCollectionGroup(t,e,E))).next(()=>g.size)}))}ot(t,e){let i=t;return e.changes.forEach((r,a)=>{const g=uz(a);eP(g,i)>0&&(i=g)}),new _p(i.readTime,i.documentKey,Math.max(e.batchId,t.largestBatchId))}}let yp=(()=>{class n{constructor(e,i){this.previousValue=e,i&&(i.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>i.writeSequenceNumber(r))}ut(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ct&&this.ct(e),e}}return n.at=-1,n})();class r8{constructor(t,e,i,r,a,g,E,O){this.databaseId=t,this.appId=e,this.persistenceKey=i,this.host=r,this.ssl=a,this.forceLongPolling=g,this.autoDetectLongPolling=E,this.useFetchStreams=O}}class Dv{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Dv("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Dv&&t.projectId===this.projectId&&t.database===this.database}}function fz(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function Fb(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function mz(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}function GT(n){return null==n}function $T(n){return 0===n&&1/n==-1/0}function gz(n){return"number"==typeof n&&Number.isInteger(n)&&!$T(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}class bc{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new bc(e)}static fromUint8Array(t){const e=function(i){let r="";for(let a=0;a<i.length;++a)r+=String.fromCharCode(i[a]);return r}(t);return new bc(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let i=0;i<t.length;i++)e[i]=t.charCodeAt(i);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return q(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}bc.EMPTY_BYTE_STRING=new bc("");const s8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Av(n){if(Ii(!!n),"string"==typeof n){let t=0;const e=s8.exec(n);if(Ii(!!e),e[1]){let r=e[1];r=(r+"000000000").substr(0,9),t=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:ja(n.seconds),nanos:ja(n.nanos)}}function ja(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Nb(n){return"string"==typeof n?bc.fromBase64String(n):bc.fromUint8Array(n)}function iP(n){var t,e;return"server_timestamp"===(null===(e=((null===(t=n?.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===e?void 0:e.stringValue)}function _z(n){const t=n.mapValue.fields.__previous_value__;return iP(t)?_z(t):t}function WT(n){const t=Av(n.mapValue.fields.__local_write_time__.timestampValue);return new ge(t.seconds,t.nanos)}const Mv={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},qA={nullValue:"NULL_VALUE"};function zb(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?iP(n)?4:wz(n)?9007199254740991:10:fi()}function Dg(n,t){if(n===t)return!0;const e=zb(n);if(e!==zb(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return WT(n).isEqual(WT(t));case 3:return function(i,r){if("string"==typeof i.timestampValue&&"string"==typeof r.timestampValue&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;const a=Av(i.timestampValue),g=Av(r.timestampValue);return a.seconds===g.seconds&&a.nanos===g.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return r=t,Nb(n.bytesValue).isEqual(Nb(r.bytesValue));case 7:return n.referenceValue===t.referenceValue;case 8:return function(i,r){return ja(i.geoPointValue.latitude)===ja(r.geoPointValue.latitude)&&ja(i.geoPointValue.longitude)===ja(r.geoPointValue.longitude)}(n,t);case 2:return function(i,r){if("integerValue"in i&&"integerValue"in r)return ja(i.integerValue)===ja(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){const a=ja(i.doubleValue),g=ja(r.doubleValue);return a===g?$T(a)===$T(g):isNaN(a)&&isNaN(g)}return!1}(n,t);case 9:return ne(n.arrayValue.values||[],t.arrayValue.values||[],Dg);case 10:return function(i,r){const a=i.mapValue.fields||{},g=r.mapValue.fields||{};if(fz(a)!==fz(g))return!1;for(const E in a)if(a.hasOwnProperty(E)&&(void 0===g[E]||!Dg(a[E],g[E])))return!1;return!0}(n,t);default:return fi()}var r}function ZT(n,t){return void 0!==(n.values||[]).find(e=>Dg(e,t))}function kv(n,t){if(n===t)return 0;const e=zb(n),i=zb(t);if(e!==i)return q(e,i);switch(e){case 0:case 9007199254740991:return 0;case 1:return q(n.booleanValue,t.booleanValue);case 2:return function(r,a){const g=ja(r.integerValue||r.doubleValue),E=ja(a.integerValue||a.doubleValue);return g<E?-1:g>E?1:g===E?0:isNaN(g)?isNaN(E)?0:-1:1}(n,t);case 3:return yz(n.timestampValue,t.timestampValue);case 4:return yz(WT(n),WT(t));case 5:return q(n.stringValue,t.stringValue);case 6:return function(r,a){const g=Nb(r),E=Nb(a);return g.compareTo(E)}(n.bytesValue,t.bytesValue);case 7:return function(r,a){const g=r.split("/"),E=a.split("/");for(let O=0;O<g.length&&O<E.length;O++){const j=q(g[O],E[O]);if(0!==j)return j}return q(g.length,E.length)}(n.referenceValue,t.referenceValue);case 8:return function(r,a){const g=q(ja(r.latitude),ja(a.latitude));return 0!==g?g:q(ja(r.longitude),ja(a.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return function(r,a){const g=r.values||[],E=a.values||[];for(let O=0;O<g.length&&O<E.length;++O){const j=kv(g[O],E[O]);if(j)return j}return q(g.length,E.length)}(n.arrayValue,t.arrayValue);case 10:return function(r,a){if(r===Mv.mapValue&&a===Mv.mapValue)return 0;if(r===Mv.mapValue)return 1;if(a===Mv.mapValue)return-1;const g=r.fields||{},E=Object.keys(g),O=a.fields||{},j=Object.keys(O);E.sort(),j.sort();for(let Y=0;Y<E.length&&Y<j.length;++Y){const se=q(E[Y],j[Y]);if(0!==se)return se;const be=kv(g[E[Y]],O[j[Y]]);if(0!==be)return be}return q(E.length,j.length)}(n.mapValue,t.mapValue);default:throw fi()}}function yz(n,t){if("string"==typeof n&&"string"==typeof t&&n.length===t.length)return q(n,t);const e=Av(n),i=Av(t),r=q(e.seconds,i.seconds);return 0!==r?r:q(e.nanos,i.nanos)}function T1(n){return rP(n)}function rP(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(i){const r=Av(i);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Nb(n.bytesValue).toBase64():"referenceValue"in n?Ut.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(t=n.geoPointValue).latitude},${t.longitude})`:"arrayValue"in n?function(i){let r="[",a=!0;for(const g of i.values||[])a?a=!1:r+=",",r+=rP(g);return r+"]"}(n.arrayValue):"mapValue"in n?function(i){const r=Object.keys(i.fields||{}).sort();let a="{",g=!0;for(const E of r)g?g=!1:a+=",",a+=`${E}:${rP(i.fields[E])}`;return a+"}"}(n.mapValue):fi();var t}function Bb(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function oP(n){return!!n&&"integerValue"in n}function qT(n){return!!n&&"arrayValue"in n}function vz(n){return!!n&&"nullValue"in n}function bz(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function KA(n){return!!n&&"mapValue"in n}function KT(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return Fb(n.mapValue.fields,(e,i)=>t.mapValue.fields[e]=KT(i)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=KT(n.arrayValue.values[e]);return t}return Object.assign({},n)}function wz(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function a8(n){return"nullValue"in n?qA:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Bb(Dv.empty(),Ut.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:fi()}function l8(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Bb(Dv.empty(),Ut.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Mv:fi()}function xz(n,t){const e=kv(n.value,t.value);return 0!==e?e:n.inclusive&&!t.inclusive?-1:!n.inclusive&&t.inclusive?1:0}function Cz(n,t){const e=kv(n.value,t.value);return 0!==e?e:n.inclusive&&!t.inclusive?1:!n.inclusive&&t.inclusive?-1:0}class Rv{constructor(t,e){this.position=t,this.inclusive=e}}function Ez(n,t,e){let i=0;for(let r=0;r<n.position.length;r++){const a=t[r],g=n.position[r];if(i=a.field.isKeyField()?Ut.comparator(Ut.fromName(g.referenceValue),e.key):kv(g,e.data.field(a.field)),"desc"===a.dir&&(i*=-1),0!==i)break}return i}function Tz(n,t){if(null===n)return null===t;if(null===t||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!Dg(n.position[e],t.position[e]))return!1;return!0}class Sz{}class ho extends Sz{constructor(t,e,i){super(),this.field=t,this.op=e,this.value=i}static create(t,e,i){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,i):new c8(t,e,i):"array-contains"===e?new d8(t,i):"in"===e?new Rz(t,i):"not-in"===e?new p8(t,i):"array-contains-any"===e?new f8(t,i):new ho(t,e,i)}static createKeyFieldInFilter(t,e,i){return"in"===e?new u8(t,i):new h8(t,i)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(kv(e,this.value)):null!==e&&zb(this.value)===zb(e)&&this.matchesComparison(kv(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return fi()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class ms extends Sz{constructor(t,e){super(),this.filters=t,this.op=e,this.ht=null}static create(t,e){return new ms(t,e)}matches(t){return S1(this)?void 0===this.filters.find(e=>!e.matches(t)):void 0!==this.filters.find(e=>e.matches(t))}getFlattenedFilters(){return null!==this.ht||(this.ht=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.ht}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const t=this.lt(e=>e.isInequality());return null!==t?t.field:null}lt(t){for(const e of this.getFlattenedFilters())if(t(e))return e;return null}}function S1(n){return"and"===n.op}function sP(n){return"or"===n.op}function aP(n){return Iz(n)&&S1(n)}function Iz(n){for(const t of n.filters)if(t instanceof ms)return!1;return!0}function lP(n){if(n instanceof ho)return n.field.canonicalString()+n.op.toString()+T1(n.value);if(aP(n))return n.filters.map(t=>lP(t)).join(",");{const t=n.filters.map(e=>lP(e)).join(",");return`${n.op}(${t})`}}function Dz(n,t){return n instanceof ho?(e=n,(i=t)instanceof ho&&e.op===i.op&&e.field.isEqual(i.field)&&Dg(e.value,i.value)):n instanceof ms?function(e,i){return i instanceof ms&&e.op===i.op&&e.filters.length===i.filters.length&&e.filters.reduce((r,a,g)=>r&&Dz(a,i.filters[g]),!0)}(n,t):void fi();var e,i}function Az(n,t){const e=n.filters.concat(t);return ms.create(e,n.op)}function Mz(n){return n instanceof ho?`${(t=n).field.canonicalString()} ${t.op} ${T1(t.value)}`:n instanceof ms?function(t){return t.op.toString()+" {"+t.getFilters().map(Mz).join(" ,")+"}"}(n):"Filter";var t}class c8 extends ho{constructor(t,e,i){super(t,e,i),this.key=Ut.fromName(i.referenceValue)}matches(t){const e=Ut.comparator(t.key,this.key);return this.matchesComparison(e)}}class u8 extends ho{constructor(t,e){super(t,"in",e),this.keys=kz(0,e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class h8 extends ho{constructor(t,e){super(t,"not-in",e),this.keys=kz(0,e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function kz(n,t){var e;return((null===(e=t.arrayValue)||void 0===e?void 0:e.values)||[]).map(i=>Ut.fromName(i.referenceValue))}class d8 extends ho{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return qT(e)&&ZT(e.arrayValue,this.value)}}class Rz extends ho{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&ZT(this.value.arrayValue,e)}}class p8 extends ho{constructor(t,e){super(t,"not-in",e)}matches(t){if(ZT(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!ZT(this.value.arrayValue,e)}}class f8 extends ho{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!qT(e)||!e.arrayValue.values)&&e.arrayValue.values.some(i=>ZT(this.value.arrayValue,i))}}class I1{constructor(t,e="asc"){this.field=t,this.dir=e}}function m8(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}class Ga{constructor(t,e){this.comparator=t,this.root=e||Au.EMPTY}insert(t,e){return new Ga(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Au.BLACK,null,null))}remove(t){return new Ga(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Au.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const i=this.comparator(t,e.key);if(0===i)return e.value;i<0?e=e.left:i>0&&(e=e.right)}return null}indexOf(t){let e=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(t,i.key);if(0===r)return e+i.left.size;r<0?i=i.left:(e+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,i)=>(t(e,i),!1))}toString(){const t=[];return this.inorderTraversal((e,i)=>(t.push(`${e}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new YA(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new YA(this.root,t,this.comparator,!1)}getReverseIterator(){return new YA(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new YA(this.root,t,this.comparator,!0)}}class YA{constructor(t,e,i,r){this.isReverse=r,this.nodeStack=[];let a=1;for(;!t.isEmpty();)if(a=e?i(t.key,e):1,e&&r&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Au{constructor(t,e,i,r,a){this.key=t,this.value=e,this.color=i??Au.RED,this.left=r??Au.EMPTY,this.right=a??Au.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,i,r,a){return new Au(t??this.key,e??this.value,i??this.color,r??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,i){let r=this;const a=i(t,r.key);return r=a<0?r.copy(null,null,null,r.left.insert(t,e,i),null):0===a?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Au.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let i,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===e(t,r.key)){if(r.right.isEmpty())return Au.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Au.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Au.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw fi();const t=this.left.check();if(t!==this.right.check())throw fi();return t+(this.isRed()?0:1)}}Au.EMPTY=null,Au.RED=!0,Au.BLACK=!1,Au.EMPTY=new class{constructor(){this.size=0}get key(){throw fi()}get value(){throw fi()}get color(){throw fi()}get left(){throw fi()}get right(){throw fi()}copy(n,t,e,i,r){return this}insert(n,t,e){return new Au(n,t)}remove(n,t){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Is{constructor(t){this.comparator=t,this.data=new Ga(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,i)=>(t(e),!1))}forEachInRange(t,e){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let i;for(i=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Pz(this.data.getIterator())}getIteratorFrom(t){return new Pz(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(i=>{e=e.add(i)}),e}isEqual(t){if(!(t instanceof Is)||this.size!==t.size)return!1;const e=this.data.getIterator(),i=t.data.getIterator();for(;e.hasNext();){const r=e.getNext().key,a=i.getNext().key;if(0!==this.comparator(r,a))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new Is(this.comparator);return e.data=t,e}}class Pz{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function D1(n){return n.hasNext()?n.getNext():void 0}class Nd{constructor(t){this.fields=t,t.sort(gn.comparator)}static empty(){return new Nd([])}unionWith(t){let e=new Is(gn.comparator);for(const i of this.fields)e=e.add(i);for(const i of t)e=e.add(i);return new Nd(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return ne(this.fields,t.fields,(e,i)=>e.isEqual(i))}}class Mu{constructor(t){this.value=t}static empty(){return new Mu({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let i=0;i<t.length-1;++i)if(e=(e.mapValue.fields||{})[t.get(i)],!KA(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=KT(e)}setAll(t){let e=gn.emptyPath(),i={},r=[];t.forEach((g,E)=>{if(!e.isImmediateParentOf(E)){const O=this.getFieldsMap(e);this.applyChanges(O,i,r),i={},r=[],e=E.popLast()}g?i[E.lastSegment()]=KT(g):r.push(E.lastSegment())});const a=this.getFieldsMap(e);this.applyChanges(a,i,r)}delete(t){const e=this.field(t.popLast());KA(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Dg(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let i=0;i<t.length;++i){let r=e.mapValue.fields[t.get(i)];KA(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(i)]=r),e=r}return e.mapValue.fields}applyChanges(t,e,i){Fb(e,(r,a)=>t[r]=a);for(const r of i)delete t[r]}clone(){return new Mu(KT(this.value))}}function Oz(n){const t=[];return Fb(n.fields,(e,i)=>{const r=new gn([e]);if(KA(i)){const a=Oz(i.mapValue).fields;if(0===a.length)t.push(r);else for(const g of a)t.push(r.child(g))}else t.push(r)}),new Nd(t)}class da{constructor(t,e,i,r,a,g,E){this.key=t,this.documentType=e,this.version=i,this.readTime=r,this.createTime=a,this.data=g,this.documentState=E}static newInvalidDocument(t){return new da(t,0,Ae.min(),Ae.min(),Ae.min(),Mu.empty(),0)}static newFoundDocument(t,e,i,r){return new da(t,1,e,Ae.min(),i,r,0)}static newNoDocument(t,e){return new da(t,2,e,Ae.min(),Ae.min(),Mu.empty(),0)}static newUnknownDocument(t,e){return new da(t,3,e,Ae.min(),Ae.min(),Mu.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Ae.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Mu.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Mu.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ae.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof da&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new da(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class g8{constructor(t,e=null,i=[],r=[],a=null,g=null,E=null){this.path=t,this.collectionGroup=e,this.orderBy=i,this.filters=r,this.limit=a,this.startAt=g,this.endAt=E,this.ft=null}}function cP(n,t=null,e=[],i=[],r=null,a=null,g=null){return new g8(n,t,e,i,r,a,g)}function Vb(n){const t=Qn(n);if(null===t.ft){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(i=>lP(i)).join(","),e+="|ob:",e+=t.orderBy.map(i=>{return(r=i).field.canonicalString()+r.dir;var r}).join(","),GT(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(i=>T1(i)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(i=>T1(i)).join(",")),t.ft=e}return t.ft}function YT(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!m8(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!Dz(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!Tz(n.startAt,t.startAt)&&Tz(n.endAt,t.endAt)}function JA(n){return Ut.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function QA(n,t){return n.filters.filter(e=>e instanceof ho&&e.field.isEqual(t))}function Lz(n,t,e){let i=qA,r=!0;for(const a of QA(n,t)){let g=qA,E=!0;switch(a.op){case"<":case"<=":g=a8(a.value);break;case"==":case"in":case">=":g=a.value;break;case">":g=a.value,E=!1;break;case"!=":case"not-in":g=qA}xz({value:i,inclusive:r},{value:g,inclusive:E})<0&&(i=g,r=E)}if(null!==e)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(t)){const g=e.position[a];xz({value:i,inclusive:r},{value:g,inclusive:e.inclusive})<0&&(i=g,r=e.inclusive);break}return{value:i,inclusive:r}}function Fz(n,t,e){let i=Mv,r=!0;for(const a of QA(n,t)){let g=Mv,E=!0;switch(a.op){case">=":case">":g=l8(a.value),E=!1;break;case"==":case"in":case"<=":g=a.value;break;case"<":g=a.value,E=!1;break;case"!=":case"not-in":g=Mv}Cz({value:i,inclusive:r},{value:g,inclusive:E})>0&&(i=g,r=E)}if(null!==e)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(t)){const g=e.position[a];Cz({value:i,inclusive:r},{value:g,inclusive:e.inclusive})>0&&(i=g,r=e.inclusive);break}return{value:i,inclusive:r}}class W_{constructor(t,e=null,i=[],r=[],a=null,g="F",E=null,O=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=i,this.filters=r,this.limit=a,this.limitType=g,this.startAt=E,this.endAt=O,this.dt=null,this._t=null}}function Nz(n,t,e,i,r,a,g,E){return new W_(n,t,e,i,r,a,g,E)}function A1(n){return new W_(n)}function zz(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function uP(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function XA(n){for(const t of n.filters){const e=t.getFirstInequalityField();if(null!==e)return e}return null}function hP(n){return null!==n.collectionGroup}function Ub(n){const t=Qn(n);if(null===t.dt){t.dt=[];const e=XA(t),i=uP(t);if(null!==e&&null===i)e.isKeyField()||t.dt.push(new I1(e)),t.dt.push(new I1(gn.keyField(),"asc"));else{let r=!1;for(const a of t.explicitOrderBy)t.dt.push(a),a.field.isKeyField()&&(r=!0);if(!r){const a=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.dt.push(new I1(gn.keyField(),a))}}}return t.dt}function jh(n){const t=Qn(n);if(!t._t)if("F"===t.limitType)t._t=cP(t.path,t.collectionGroup,Ub(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const a of Ub(t))e.push(new I1(a.field,"desc"===a.dir?"asc":"desc"));const i=t.endAt?new Rv(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Rv(t.startAt.position,t.startAt.inclusive):null;t._t=cP(t.path,t.collectionGroup,e,t.filters,t.limit,i,r)}return t._t}function dP(n,t){t.getFirstInequalityField(),XA(n);const e=n.filters.concat([t]);return new W_(n.path,n.collectionGroup,n.explicitOrderBy.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)}function eM(n,t,e){return new W_(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function JT(n,t){return YT(jh(n),jh(t))&&n.limitType===t.limitType}function Bz(n){return`${Vb(jh(n))}|lt:${n.limitType}`}function pP(n){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(i=>Mz(i)).join(", ")}]`),GT(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(i=>{return`${(r=i).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(i=>T1(i)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(i=>T1(i)).join(",")),`Target(${e})`}(jh(n))}; limitType=${n.limitType})`}function QT(n,t){return t.isFoundDocument()&&function(e,i){const r=i.key.path;return null!==e.collectionGroup?i.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(r):Ut.isDocumentKey(e.path)?e.path.isEqual(r):e.path.isImmediateParentOf(r)}(n,t)&&function(e,i){for(const r of Ub(e))if(!r.field.isKeyField()&&null===i.data.field(r.field))return!1;return!0}(n,t)&&function(e,i){for(const r of e.filters)if(!r.matches(i))return!1;return!0}(n,t)&&(i=t,!((e=n).startAt&&!function(r,a,g){const E=Ez(r,a,g);return r.inclusive?E<=0:E<0}(e.startAt,Ub(e),i)||e.endAt&&!function(r,a,g){const E=Ez(r,a,g);return r.inclusive?E>=0:E>0}(e.endAt,Ub(e),i)));var e,i}function Vz(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Uz(n){return(t,e)=>{let i=!1;for(const r of Ub(n)){const a=_8(r,t,e);if(0!==a)return a;i=i||r.field.isKeyField()}return 0}}function _8(n,t,e){const i=n.field.isKeyField()?Ut.comparator(t.key,e.key):function(r,a,g){const E=a.data.field(r),O=g.data.field(r);return null!==E&&null!==O?kv(E,O):fi()}(n.field,t,e);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return fi()}}function Hz(n,t){if(n.wt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$T(t)?"-0":t}}function jz(n){return{integerValue:""+n}}function Gz(n,t){return gz(t)?jz(t):Hz(n,t)}class tM{constructor(){this._=void 0}}function y8(n,t,e){return n instanceof M1?function(i,r){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return r&&(a.fields.__previous_value__=r),{mapValue:a}}(e,t):n instanceof Hb?Wz(n,t):n instanceof jb?Zz(n,t):function(i,r){const a=$z(i,r),g=qz(a)+qz(i.gt);return oP(a)&&oP(i.gt)?jz(g):Hz(i.yt,g)}(n,t)}function v8(n,t,e){return n instanceof Hb?Wz(n,t):n instanceof jb?Zz(n,t):e}function $z(n,t){return n instanceof k1?oP(e=t)||(i=e)&&"doubleValue"in i?t:{integerValue:0}:null;var i,e}class M1 extends tM{}class Hb extends tM{constructor(t){super(),this.elements=t}}function Wz(n,t){const e=Kz(t);for(const i of n.elements)e.some(r=>Dg(r,i))||e.push(i);return{arrayValue:{values:e}}}class jb extends tM{constructor(t){super(),this.elements=t}}function Zz(n,t){let e=Kz(t);for(const i of n.elements)e=e.filter(r=>!Dg(r,i));return{arrayValue:{values:e}}}class k1 extends tM{constructor(t,e){super(),this.yt=t,this.gt=e}}function qz(n){return ja(n.integerValue||n.doubleValue)}function Kz(n){return qT(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class XT{constructor(t,e){this.field=t,this.transform=e}}class w8{constructor(t,e){this.version=t,this.transformResults=e}}class ba{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new ba}static exists(t){return new ba(void 0,t)}static updateTime(t){return new ba(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function nM(n,t){return void 0!==n.updateTime?t.isFoundDocument()&&t.version.isEqual(n.updateTime):void 0===n.exists||n.exists===t.isFoundDocument()}class iM{}function Yz(n,t){if(!n.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return n.isNoDocument()?new P1(n.key,ba.none()):new R1(n.key,n.data,ba.none());{const e=n.data,i=Mu.empty();let r=new Is(gn.comparator);for(let a of t.fields)if(!r.has(a)){let g=e.field(a);null===g&&a.length>1&&(a=a.popLast(),g=e.field(a)),null===g?i.delete(a):i.set(a,g),r=r.add(a)}return new Z_(n.key,i,new Nd(r.toArray()),ba.none())}}function x8(n,t,e){n instanceof R1?function(i,r,a){const g=i.value.clone(),E=Xz(i.fieldTransforms,r,a.transformResults);g.setAll(E),r.convertToFoundDocument(a.version,g).setHasCommittedMutations()}(n,t,e):n instanceof Z_?function(i,r,a){if(!nM(i.precondition,r))return void r.convertToUnknownDocument(a.version);const g=Xz(i.fieldTransforms,r,a.transformResults),E=r.data;E.setAll(Qz(i)),E.setAll(g),r.convertToFoundDocument(a.version,E).setHasCommittedMutations()}(n,t,e):t.convertToNoDocument(e.version).setHasCommittedMutations()}function eS(n,t,e,i){return n instanceof R1?function(r,a,g,E){if(!nM(r.precondition,a))return g;const O=r.value.clone(),j=eB(r.fieldTransforms,E,a);return O.setAll(j),a.convertToFoundDocument(a.version,O).setHasLocalMutations(),null}(n,t,e,i):n instanceof Z_?function(r,a,g,E){if(!nM(r.precondition,a))return g;const O=eB(r.fieldTransforms,E,a),j=a.data;return j.setAll(Qz(r)),j.setAll(O),a.convertToFoundDocument(a.version,j).setHasLocalMutations(),null===g?null:g.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(Y=>Y.field))}(n,t,e,i):(g=e,nM(n.precondition,a=t)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):g);var a,g}function C8(n,t){let e=null;for(const i of n.fieldTransforms){const r=t.data.field(i.field),a=$z(i.transform,r||null);null!=a&&(null===e&&(e=Mu.empty()),e.set(i.field,a))}return e||null}function Jz(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&(i=t.fieldTransforms,!!(void 0===(e=n.fieldTransforms)&&void 0===i||e&&i&&ne(e,i,(r,a)=>function b8(n,t){return n.field.isEqual(t.field)&&(i=t.transform,(e=n.transform)instanceof Hb&&i instanceof Hb||e instanceof jb&&i instanceof jb?ne(e.elements,i.elements,Dg):e instanceof k1&&i instanceof k1?Dg(e.gt,i.gt):e instanceof M1&&i instanceof M1);var e,i}(r,a))))&&(0===n.type?n.value.isEqual(t.value):1!==n.type||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask));var e,i}class R1 extends iM{constructor(t,e,i,r=[]){super(),this.key=t,this.value=e,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Z_ extends iM{constructor(t,e,i,r,a=[]){super(),this.key=t,this.data=e,this.fieldMask=i,this.precondition=r,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Qz(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const i=n.data.field(e);t.set(e,i)}}),t}function Xz(n,t,e){const i=new Map;Ii(n.length===e.length);for(let r=0;r<e.length;r++){const a=n[r],g=a.transform,E=t.data.field(a.field);i.set(a.field,v8(g,E,e[r]))}return i}function eB(n,t,e){const i=new Map;for(const r of n){const a=r.transform,g=e.data.field(r.field);i.set(r.field,y8(a,g,t))}return i}class P1 extends iM{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class fP extends iM{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class E8{constructor(t){this.count=t}}var Nl,Do;function tB(n){switch(n){default:return fi();case Wt.CANCELLED:case Wt.UNKNOWN:case Wt.DEADLINE_EXCEEDED:case Wt.RESOURCE_EXHAUSTED:case Wt.INTERNAL:case Wt.UNAVAILABLE:case Wt.UNAUTHENTICATED:return!1;case Wt.INVALID_ARGUMENT:case Wt.NOT_FOUND:case Wt.ALREADY_EXISTS:case Wt.PERMISSION_DENIED:case Wt.FAILED_PRECONDITION:case Wt.ABORTED:case Wt.OUT_OF_RANGE:case Wt.UNIMPLEMENTED:case Wt.DATA_LOSS:return!0}}function nB(n){if(void 0===n)return Aa("GRPC error has no .code"),Wt.UNKNOWN;switch(n){case Nl.OK:return Wt.OK;case Nl.CANCELLED:return Wt.CANCELLED;case Nl.UNKNOWN:return Wt.UNKNOWN;case Nl.DEADLINE_EXCEEDED:return Wt.DEADLINE_EXCEEDED;case Nl.RESOURCE_EXHAUSTED:return Wt.RESOURCE_EXHAUSTED;case Nl.INTERNAL:return Wt.INTERNAL;case Nl.UNAVAILABLE:return Wt.UNAVAILABLE;case Nl.UNAUTHENTICATED:return Wt.UNAUTHENTICATED;case Nl.INVALID_ARGUMENT:return Wt.INVALID_ARGUMENT;case Nl.NOT_FOUND:return Wt.NOT_FOUND;case Nl.ALREADY_EXISTS:return Wt.ALREADY_EXISTS;case Nl.PERMISSION_DENIED:return Wt.PERMISSION_DENIED;case Nl.FAILED_PRECONDITION:return Wt.FAILED_PRECONDITION;case Nl.ABORTED:return Wt.ABORTED;case Nl.OUT_OF_RANGE:return Wt.OUT_OF_RANGE;case Nl.UNIMPLEMENTED:return Wt.UNIMPLEMENTED;case Nl.DATA_LOSS:return Wt.DATA_LOSS;default:return fi()}}(Do=Nl||(Nl={}))[Do.OK=0]="OK",Do[Do.CANCELLED=1]="CANCELLED",Do[Do.UNKNOWN=2]="UNKNOWN",Do[Do.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Do[Do.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Do[Do.NOT_FOUND=5]="NOT_FOUND",Do[Do.ALREADY_EXISTS=6]="ALREADY_EXISTS",Do[Do.PERMISSION_DENIED=7]="PERMISSION_DENIED",Do[Do.UNAUTHENTICATED=16]="UNAUTHENTICATED",Do[Do.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Do[Do.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Do[Do.ABORTED=10]="ABORTED",Do[Do.OUT_OF_RANGE=11]="OUT_OF_RANGE",Do[Do.UNIMPLEMENTED=12]="UNIMPLEMENTED",Do[Do.INTERNAL=13]="INTERNAL",Do[Do.UNAVAILABLE=14]="UNAVAILABLE",Do[Do.DATA_LOSS=15]="DATA_LOSS";class Pv{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),i=this.inner[e];if(void 0!==i)for(const[r,a]of i)if(this.equalsFn(r,t))return a}has(t){return void 0!==this.get(t)}set(t,e){const i=this.mapKeyFn(t),r=this.inner[i];if(void 0===r)return this.inner[i]=[[t,e]],void this.innerSize++;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],t))return void(r[a]=[t,e]);r.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),i=this.inner[e];if(void 0===i)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],t))return 1===i.length?delete this.inner[e]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(t){Fb(this.inner,(e,i)=>{for(const[r,a]of i)t(r,a)})}isEmpty(){return mz(this.inner)}size(){return this.innerSize}}const T8=new Ga(Ut.comparator);function zd(){return T8}const iB=new Ga(Ut.comparator);function tS(...n){let t=iB;for(const e of n)t=t.insert(e.key,e);return t}function rB(n){let t=iB;return n.forEach((e,i)=>t=t.insert(e,i.overlayedDocument)),t}function Ag(){return nS()}function oB(){return nS()}function nS(){return new Pv(n=>n.toString(),(n,t)=>n.isEqual(t))}const S8=new Ga(Ut.comparator),I8=new Is(Ut.comparator);function Ir(...n){let t=I8;for(const e of n)t=t.add(e);return t}const D8=new Is(q);function rM(){return D8}class iS{constructor(t,e,i,r,a){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(t,e,i){const r=new Map;return r.set(t,rS.createSynthesizedTargetChangeForCurrentChange(t,e,i)),new iS(Ae.min(),r,rM(),zd(),Ir())}}class rS{constructor(t,e,i,r,a){this.resumeToken=t,this.current=e,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(t,e,i){return new rS(i,e,Ir(),Ir(),Ir())}}class oM{constructor(t,e,i,r){this.It=t,this.removedTargetIds=e,this.key=i,this.Tt=r}}class sB{constructor(t,e){this.targetId=t,this.Et=e}}class aB{constructor(t,e,i=bc.EMPTY_BYTE_STRING,r=null){this.state=t,this.targetIds=e,this.resumeToken=i,this.cause=r}}class lB{constructor(){this.At=0,this.Rt=uB(),this.bt=bc.EMPTY_BYTE_STRING,this.Pt=!1,this.vt=!0}get current(){return this.Pt}get resumeToken(){return this.bt}get Vt(){return 0!==this.At}get St(){return this.vt}Dt(t){t.approximateByteSize()>0&&(this.vt=!0,this.bt=t)}Ct(){let t=Ir(),e=Ir(),i=Ir();return this.Rt.forEach((r,a)=>{switch(a){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:i=i.add(r);break;default:fi()}}),new rS(this.bt,this.Pt,t,e,i)}xt(){this.vt=!1,this.Rt=uB()}Nt(t,e){this.vt=!0,this.Rt=this.Rt.insert(t,e)}kt(t){this.vt=!0,this.Rt=this.Rt.remove(t)}Ot(){this.At+=1}Mt(){this.At-=1}Ft(){this.vt=!0,this.Pt=!0}}class A8{constructor(t){this.$t=t,this.Bt=new Map,this.Lt=zd(),this.qt=cB(),this.Ut=new Is(q)}Kt(t){for(const e of t.It)t.Tt&&t.Tt.isFoundDocument()?this.Gt(e,t.Tt):this.Qt(e,t.key,t.Tt);for(const e of t.removedTargetIds)this.Qt(e,t.key,t.Tt)}jt(t){this.forEachTarget(t,e=>{const i=this.Wt(e);switch(t.state){case 0:this.zt(e)&&i.Dt(t.resumeToken);break;case 1:i.Mt(),i.Vt||i.xt(),i.Dt(t.resumeToken);break;case 2:i.Mt(),i.Vt||this.removeTarget(e);break;case 3:this.zt(e)&&(i.Ft(),i.Dt(t.resumeToken));break;case 4:this.zt(e)&&(this.Ht(e),i.Dt(t.resumeToken));break;default:fi()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Bt.forEach((i,r)=>{this.zt(r)&&e(r)})}Jt(t){const e=t.targetId,i=t.Et.count,r=this.Yt(e);if(r){const a=r.target;if(JA(a))if(0===i){const g=new Ut(a.path);this.Qt(e,g,da.newNoDocument(g,Ae.min()))}else Ii(1===i);else this.Xt(e)!==i&&(this.Ht(e),this.Ut=this.Ut.add(e))}}Zt(t){const e=new Map;this.Bt.forEach((a,g)=>{const E=this.Yt(g);if(E){if(a.current&&JA(E.target)){const O=new Ut(E.target.path);null!==this.Lt.get(O)||this.te(g,O)||this.Qt(g,O,da.newNoDocument(O,t))}a.St&&(e.set(g,a.Ct()),a.xt())}});let i=Ir();this.qt.forEach((a,g)=>{let E=!0;g.forEachWhile(O=>{const j=this.Yt(O);return!j||2===j.purpose||(E=!1,!1)}),E&&(i=i.add(a))}),this.Lt.forEach((a,g)=>g.setReadTime(t));const r=new iS(t,e,this.Ut,this.Lt,i);return this.Lt=zd(),this.qt=cB(),this.Ut=new Is(q),r}Gt(t,e){if(!this.zt(t))return;const i=this.te(t,e.key)?2:0;this.Wt(t).Nt(e.key,i),this.Lt=this.Lt.insert(e.key,e),this.qt=this.qt.insert(e.key,this.ee(e.key).add(t))}Qt(t,e,i){if(!this.zt(t))return;const r=this.Wt(t);this.te(t,e)?r.Nt(e,1):r.kt(e),this.qt=this.qt.insert(e,this.ee(e).delete(t)),i&&(this.Lt=this.Lt.insert(e,i))}removeTarget(t){this.Bt.delete(t)}Xt(t){const e=this.Wt(t).Ct();return this.$t.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ot(t){this.Wt(t).Ot()}Wt(t){let e=this.Bt.get(t);return e||(e=new lB,this.Bt.set(t,e)),e}ee(t){let e=this.qt.get(t);return e||(e=new Is(q),this.qt=this.qt.insert(t,e)),e}zt(t){const e=null!==this.Yt(t);return e||kn("WatchChangeAggregator","Detected inactive target",t),e}Yt(t){const e=this.Bt.get(t);return e&&e.Vt?null:this.$t.ne(t)}Ht(t){this.Bt.set(t,new lB),this.$t.getRemoteKeysForTarget(t).forEach(e=>{this.Qt(t,e,null)})}te(t,e){return this.$t.getRemoteKeysForTarget(t).has(e)}}function cB(){return new Ga(Ut.comparator)}function uB(){return new Ga(Ut.comparator)}const M8={asc:"ASCENDING",desc:"DESCENDING"},k8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},R8={and:"AND",or:"OR"};class P8{constructor(t,e){this.databaseId=t,this.wt=e}}function O1(n,t){return n.wt?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function hB(n,t){return n.wt?t.toBase64():t.toUint8Array()}function O8(n,t){return O1(n,t.toTimestamp())}function ll(n){return Ii(!!n),Ae.fromTimestamp(function(t){const e=Av(t);return new ge(e.seconds,e.nanos)}(n))}function mP(n,t){return(e=n,new mt(["projects",e.projectId,"databases",e.database])).child("documents").child(t).canonicalString();var e}function dB(n){const t=mt.fromString(n);return Ii(wB(t)),t}function oS(n,t){return mP(n.databaseId,t.path)}function Mg(n,t){const e=dB(t);if(e.get(1)!==n.databaseId.projectId)throw new Cn(Wt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new Cn(Wt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new Ut(fB(e))}function gP(n,t){return mP(n.databaseId,t)}function pB(n){const t=dB(n);return 4===t.length?mt.emptyPath():fB(t)}function sS(n){return new mt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function fB(n){return Ii(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function mB(n,t,e){return{name:oS(n,t),fields:e.value.mapValue.fields}}function gB(n,t,e){const i=Mg(n,t.name),r=ll(t.updateTime),a=t.createTime?ll(t.createTime):Ae.min(),g=new Mu({mapValue:{fields:t.fields}}),E=da.newFoundDocument(i,r,a,g);return e&&E.setHasCommittedMutations(),e?E.setHasCommittedMutations():E}function aS(n,t){let e;if(t instanceof R1)e={update:mB(n,t.key,t.value)};else if(t instanceof P1)e={delete:oS(n,t.key)};else if(t instanceof Z_)e={update:mB(n,t.key,t.data),updateMask:H8(t.fieldMask)};else{if(!(t instanceof fP))return fi();e={verify:oS(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(i=>function(r,a){const g=a.transform;if(g instanceof M1)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(g instanceof Hb)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:g.elements}};if(g instanceof jb)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:g.elements}};if(g instanceof k1)return{fieldPath:a.field.canonicalString(),increment:g.gt};throw fi()}(0,i))),t.precondition.isNone||(e.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:O8(n,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:fi()),e;var r}function _P(n,t){const e=t.currentDocument?void 0!==(r=t.currentDocument).updateTime?ba.updateTime(ll(r.updateTime)):void 0!==r.exists?ba.exists(r.exists):ba.none():ba.none(),i=t.updateTransforms?t.updateTransforms.map(r=>function(a,g){let E=null;"setToServerValue"in g?(Ii("REQUEST_TIME"===g.setToServerValue),E=new M1):"appendMissingElements"in g?E=new Hb(g.appendMissingElements.values||[]):"removeAllFromArray"in g?E=new jb(g.removeAllFromArray.values||[]):"increment"in g?E=new k1(a,g.increment):fi();const O=gn.fromServerFormat(g.fieldPath);return new XT(O,E)}(n,r)):[];var r;if(t.update){const r=Mg(n,t.update.name),a=new Mu({mapValue:{fields:t.update.fields}});if(t.updateMask){const g=new Nd((t.updateMask.fieldPaths||[]).map(j=>gn.fromServerFormat(j)));return new Z_(r,a,g,e,i)}return new R1(r,a,e,i)}if(t.delete){const r=Mg(n,t.delete);return new P1(r,e)}if(t.verify){const r=Mg(n,t.verify);return new fP(r,e)}return fi()}function _B(n,t){return{documents:[gP(n,t.path)]}}function yP(n,t){const e={structuredQuery:{}},i=t.path;null!==t.collectionGroup?(e.parent=gP(n,i),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=gP(n,i.popLast()),e.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(O){if(0!==O.length)return bB(ms.create(O,"and"))}(t.filters);r&&(e.structuredQuery.where=r);const a=function(O){if(0!==O.length)return O.map(j=>{return{field:L1((Y=j).field),direction:B8(Y.dir)};var Y})}(t.orderBy);a&&(e.structuredQuery.orderBy=a);const g=(j=t.limit,n.wt||GT(j)?j:{value:j});var j,E,O;return null!==g&&(e.structuredQuery.limit=g),t.startAt&&(e.structuredQuery.startAt={before:(E=t.startAt).inclusive,values:E.position}),t.endAt&&(e.structuredQuery.endAt={before:!(O=t.endAt).inclusive,values:O.position}),e}function yB(n){let t=pB(n.parent);const e=n.structuredQuery,i=e.from?e.from.length:0;let r=null;if(i>0){Ii(1===i);const Y=e.from[0];Y.allDescendants?r=Y.collectionId:t=t.child(Y.collectionId)}let a=[];e.where&&(a=function(Y){const se=vB(Y);return se instanceof ms&&aP(se)?se.getFilters():[se]}(e.where));let g=[];e.orderBy&&(g=e.orderBy.map(Y=>{return new I1(F1((se=Y).field),function(be){switch(be){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(se.direction));var se}));let E=null;e.limit&&(E=function(Y){let se;return se="object"==typeof Y?Y.value:Y,GT(se)?null:se}(e.limit));let O=null;var Y;e.startAt&&(O=new Rv((Y=e.startAt).values||[],!!Y.before));let j=null;return e.endAt&&(j=function(Y){return new Rv(Y.values||[],!Y.before)}(e.endAt)),Nz(t,r,g,a,E,"F",O,j)}function vB(n){return void 0!==n.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=F1(t.unaryFilter.field);return ho.create(e,"==",{doubleValue:NaN});case"IS_NULL":const i=F1(t.unaryFilter.field);return ho.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=F1(t.unaryFilter.field);return ho.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=F1(t.unaryFilter.field);return ho.create(a,"!=",{nullValue:"NULL_VALUE"});default:return fi()}}(n):void 0!==n.fieldFilter?ho.create(F1((t=n).fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return fi()}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==n.compositeFilter?function(t){return ms.create(t.compositeFilter.filters.map(e=>vB(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return fi()}}(t.compositeFilter.op))}(n):fi();var t}function B8(n){return M8[n]}function V8(n){return k8[n]}function U8(n){return R8[n]}function L1(n){return{fieldPath:n.canonicalString()}}function F1(n){return gn.fromServerFormat(n.fieldPath)}function bB(n){return n instanceof ho?function(t){if("=="===t.op){if(bz(t.value))return{unaryFilter:{field:L1(t.field),op:"IS_NAN"}};if(vz(t.value))return{unaryFilter:{field:L1(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(bz(t.value))return{unaryFilter:{field:L1(t.field),op:"IS_NOT_NAN"}};if(vz(t.value))return{unaryFilter:{field:L1(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:L1(t.field),op:V8(t.op),value:t.value}}}(n):n instanceof ms?function(t){const e=t.getFilters().map(i=>bB(i));return 1===e.length?e[0]:{compositeFilter:{op:U8(t.op),filters:e}}}(n):fi()}function H8(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function wB(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function Gh(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=xB(t)),t=j8(n.get(e),t);return xB(t)}function j8(n,t){let e=t;const i=n.length;for(let r=0;r<i;r++){const a=n.charAt(r);switch(a){case"\0":e+="\x01\x10";break;case"\x01":e+="\x01\x11";break;default:e+=a}}return e}function xB(n){return n+"\x01\x01"}function kg(n){const t=n.length;if(Ii(t>=2),2===t)return Ii("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),mt.emptyPath();const e=t-2,i=[];let r="";for(let a=0;a<t;){const g=n.indexOf("\x01",a);switch((g<0||g>e)&&fi(),n.charAt(g+1)){case"\x01":const E=n.substring(a,g);let O;0===r.length?O=E:(r+=E,O=r,r=""),i.push(O);break;case"\x10":r+=n.substring(a,g),r+="\0";break;case"\x11":r+=n.substring(a,g+1);break;default:fi()}a=g+2}return new mt(i)}const CB=["userId","batchId"];function sM(n,t){return[n,Gh(t)]}function EB(n,t,e){return[n,Gh(t),e]}const G8={},$8=["prefixPath","collectionGroup","readTime","documentId"],W8=["prefixPath","collectionGroup","documentId"],Z8=["collectionGroup","readTime","prefixPath","documentId"],q8=["canonicalId","targetId"],K8=["targetId","path"],Y8=["path","targetId"],J8=["collectionId","parent"],Q8=["indexId","uid"],X8=["uid","sequenceNumber"],eW=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],tW=["indexId","uid","orderedDocumentKey"],nW=["userId","collectionPath","documentId"],iW=["userId","collectionPath","largestBatchId"],rW=["userId","collectionGroup","largestBatchId"],TB=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],oW=[...TB,"documentOverlays"],SB=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],IB=SB,sW=[...IB,"indexConfiguration","indexState","indexEntries"];class vP extends dz{constructor(t,e){super(),this.se=t,this.currentSequenceNumber=e}}function Yc(n,t){const e=Qn(n);return dm.M(e.se,t)}class bP{constructor(t,e,i,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(t,e){const i=e.mutationResults;for(let r=0;r<this.mutations.length;r++){const a=this.mutations[r];a.key.isEqual(t.key)&&x8(a,t,i[r])}}applyToLocalView(t,e){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(e=eS(i,t,e,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(e=eS(i,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const i=oB();return this.mutations.forEach(r=>{const a=t.get(r.key),g=a.overlayedDocument;let E=this.applyToLocalView(g,a.mutatedFields);E=e.has(r.key)?null:E;const O=Yz(g,E);null!==O&&i.set(r.key,O),g.isValidDocument()||g.convertToNoDocument(Ae.min())}),i}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),Ir())}isEqual(t){return this.batchId===t.batchId&&ne(this.mutations,t.mutations,(e,i)=>Jz(e,i))&&ne(this.baseMutations,t.baseMutations,(e,i)=>Jz(e,i))}}class wP{constructor(t,e,i,r){this.batch=t,this.commitVersion=e,this.mutationResults=i,this.docVersions=r}static from(t,e,i){Ii(t.mutations.length===i.length);let r=S8;const a=t.mutations;for(let g=0;g<a.length;g++)r=r.insert(a[g].key,i[g].version);return new wP(t,e,i,r)}}class xP{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Ov{constructor(t,e,i,r,a=Ae.min(),g=Ae.min(),E=bc.EMPTY_BYTE_STRING){this.target=t,this.targetId=e,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=g,this.resumeToken=E}withSequenceNumber(t){return new Ov(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new Ov(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new Ov(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}class DB{constructor(t){this.ie=t}}function AB(n,t){const e=t.key,i={prefixPath:e.getCollectionPath().popLast().toArray(),collectionGroup:e.collectionGroup,documentId:e.path.lastSegment(),readTime:aM(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())i.document={name:oS(r=n.ie,(a=t).key),fields:a.data.value.mapValue.fields,updateTime:O1(r,a.version.toTimestamp()),createTime:O1(r,a.createTime.toTimestamp())};else if(t.isNoDocument())i.noDocument={path:e.path.toArray(),readTime:Gb(t.version)};else{if(!t.isUnknownDocument())return fi();i.unknownDocument={path:e.path.toArray(),version:Gb(t.version)}}var r,a;return i}function aM(n){const t=n.toTimestamp();return[t.seconds,t.nanoseconds]}function Gb(n){const t=n.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function $b(n){const t=new ge(n.seconds,n.nanoseconds);return Ae.fromTimestamp(t)}function Wb(n,t){const e=(t.baseMutations||[]).map(a=>_P(n.ie,a));for(let a=0;a<t.mutations.length-1;++a)a+1<t.mutations.length&&void 0!==t.mutations[a+1].transform&&(t.mutations[a].updateTransforms=t.mutations[a+1].transform.fieldTransforms,t.mutations.splice(a+1,1),++a);const i=t.mutations.map(a=>_P(n.ie,a)),r=ge.fromMillis(t.localWriteTimeMs);return new bP(t.batchId,r,e,i)}function lS(n){const t=$b(n.readTime),e=void 0!==n.lastLimboFreeSnapshotVersion?$b(n.lastLimboFreeSnapshotVersion):Ae.min();let i;var r;return void 0!==n.query.documents?(Ii(1===(r=n.query).documents.length),i=jh(A1(pB(r.documents[0])))):i=jh(yB(n.query)),new Ov(i,n.targetId,0,n.lastListenSequenceNumber,t,e,bc.fromBase64String(n.resumeToken))}function MB(n,t){const e=Gb(t.snapshotVersion),i=Gb(t.lastLimboFreeSnapshotVersion);let r;r=JA(t.target)?_B(n.ie,t.target):yP(n.ie,t.target);const a=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Vb(t.target),readTime:e,resumeToken:a,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function CP(n){const t=yB({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?eM(t,t.limit,"L"):t}function EP(n,t){return new xP(t.largestBatchId,_P(n.ie,t.overlayMutation))}function kB(n,t){const e=t.path.lastSegment();return[n,Gh(t.path.popLast()),e]}function RB(n,t,e,i){return{indexId:n,uid:t.uid||"",sequenceNumber:e,readTime:Gb(i.readTime),documentKey:Gh(i.documentKey.path),largestBatchId:i.largestBatchId}}class lW{getBundleMetadata(t,e){return PB(t).get(e).next(i=>{if(i)return{id:(r=i).bundleId,createTime:$b(r.createTime),version:r.version};var r})}saveBundleMetadata(t,e){return PB(t).put({bundleId:(i=e).id,createTime:Gb(ll(i.createTime)),version:i.version});var i}getNamedQuery(t,e){return OB(t).get(e).next(i=>{if(i)return{name:(r=i).name,query:CP(r.bundledQuery),readTime:$b(r.readTime)};var r})}saveNamedQuery(t,e){return OB(t).put({name:(i=e).name,readTime:Gb(ll(i.readTime)),bundledQuery:i.bundledQuery});var i}}function PB(n){return Yc(n,"bundles")}function OB(n){return Yc(n,"namedQueries")}class lM{constructor(t,e){this.yt=t,this.userId=e}static re(t,e){return new lM(t,e.uid||"")}getOverlay(t,e){return cS(t).get(kB(this.userId,e)).next(i=>i?EP(this.yt,i):null)}getOverlays(t,e){const i=Ag();return jt.forEach(e,r=>this.getOverlay(t,r).next(a=>{null!==a&&i.set(r,a)})).next(()=>i)}saveOverlays(t,e,i){const r=[];return i.forEach((a,g)=>{const E=new xP(e,g);r.push(this.oe(t,E))}),jt.waitFor(r)}removeOverlaysForBatchId(t,e,i){const r=new Set;e.forEach(g=>r.add(Gh(g.getCollectionPath())));const a=[];return r.forEach(g=>{const E=IDBKeyRange.bound([this.userId,g,i],[this.userId,g,i+1],!1,!0);a.push(cS(t).Y("collectionPathOverlayIndex",E))}),jt.waitFor(a)}getOverlaysForCollection(t,e,i){const r=Ag(),a=Gh(e),g=IDBKeyRange.bound([this.userId,a,i],[this.userId,a,Number.POSITIVE_INFINITY],!0);return cS(t).W("collectionPathOverlayIndex",g).next(E=>{for(const O of E){const j=EP(this.yt,O);r.set(j.getKey(),j)}return r})}getOverlaysForCollectionGroup(t,e,i,r){const a=Ag();let g;const E=IDBKeyRange.bound([this.userId,e,i],[this.userId,e,Number.POSITIVE_INFINITY],!0);return cS(t).Z({index:"collectionGroupOverlayIndex",range:E},(O,j,Y)=>{const se=EP(this.yt,j);a.size()<r||se.largestBatchId===g?(a.set(se.getKey(),se),g=se.largestBatchId):Y.done()}).next(()=>a)}oe(t,e){return cS(t).put(function(i,r,a){const[g,E,O]=kB(r,a.mutation.key);return{userId:r,collectionPath:E,documentId:O,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:aS(i.ie,a.mutation)}}(this.yt,this.userId,e))}}function cS(n){return Yc(n,"documentOverlays")}class Zb{constructor(){}ue(t,e){this.ce(t,e),e.ae()}ce(t,e){if("nullValue"in t)this.he(e,5);else if("booleanValue"in t)this.he(e,10),e.le(t.booleanValue?1:0);else if("integerValue"in t)this.he(e,15),e.le(ja(t.integerValue));else if("doubleValue"in t){const i=ja(t.doubleValue);isNaN(i)?this.he(e,13):(this.he(e,15),$T(i)?e.le(0):e.le(i))}else if("timestampValue"in t){const i=t.timestampValue;this.he(e,20),"string"==typeof i?e.fe(i):(e.fe(`${i.seconds||""}`),e.le(i.nanos||0))}else if("stringValue"in t)this.de(t.stringValue,e),this._e(e);else if("bytesValue"in t)this.he(e,30),e.we(Nb(t.bytesValue)),this._e(e);else if("referenceValue"in t)this.me(t.referenceValue,e);else if("geoPointValue"in t){const i=t.geoPointValue;this.he(e,45),e.le(i.latitude||0),e.le(i.longitude||0)}else"mapValue"in t?wz(t)?this.he(e,Number.MAX_SAFE_INTEGER):(this.ge(t.mapValue,e),this._e(e)):"arrayValue"in t?(this.ye(t.arrayValue,e),this._e(e)):fi()}de(t,e){this.he(e,25),this.pe(t,e)}pe(t,e){e.fe(t)}ge(t,e){const i=t.fields||{};this.he(e,55);for(const r of Object.keys(i))this.de(r,e),this.ce(i[r],e)}ye(t,e){const i=t.values||[];this.he(e,50);for(const r of i)this.ce(r,e)}me(t,e){this.he(e,37),Ut.fromName(t).path.forEach(i=>{this.he(e,60),this.pe(i,e)})}he(t,e){t.le(e)}_e(t){t.le(2)}}function cW(n){if(0===n)return 8;let t=0;return!(n>>4)&&(t+=4,n<<=4),!(n>>6)&&(t+=2,n<<=2),!(n>>7)&&(t+=1),t}function LB(n){const t=64-function(e){let i=0;for(let r=0;r<8;++r){const a=cW(255&e[r]);if(i+=a,8!==a)break}return i}(n);return Math.ceil(t/8)}Zb.Ie=new Zb;class uW{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Te(t){const e=t[Symbol.iterator]();let i=e.next();for(;!i.done;)this.Ee(i.value),i=e.next();this.Ae()}Re(t){const e=t[Symbol.iterator]();let i=e.next();for(;!i.done;)this.be(i.value),i=e.next();this.Pe()}ve(t){for(const e of t){const i=e.charCodeAt(0);if(i<128)this.Ee(i);else if(i<2048)this.Ee(960|i>>>6),this.Ee(128|63&i);else if(e<"\ud800"||"\udbff"<e)this.Ee(480|i>>>12),this.Ee(128|63&i>>>6),this.Ee(128|63&i);else{const r=e.codePointAt(0);this.Ee(240|r>>>18),this.Ee(128|63&r>>>12),this.Ee(128|63&r>>>6),this.Ee(128|63&r)}}this.Ae()}Ve(t){for(const e of t){const i=e.charCodeAt(0);if(i<128)this.be(i);else if(i<2048)this.be(960|i>>>6),this.be(128|63&i);else if(e<"\ud800"||"\udbff"<e)this.be(480|i>>>12),this.be(128|63&i>>>6),this.be(128|63&i);else{const r=e.codePointAt(0);this.be(240|r>>>18),this.be(128|63&r>>>12),this.be(128|63&r>>>6),this.be(128|63&r)}}this.Pe()}Se(t){const e=this.De(t),i=LB(e);this.Ce(1+i),this.buffer[this.position++]=255&i;for(let r=e.length-i;r<e.length;++r)this.buffer[this.position++]=255&e[r]}xe(t){const e=this.De(t),i=LB(e);this.Ce(1+i),this.buffer[this.position++]=~(255&i);for(let r=e.length-i;r<e.length;++r)this.buffer[this.position++]=~(255&e[r])}Ne(){this.ke(255),this.ke(255)}Oe(){this.Me(255),this.Me(255)}reset(){this.position=0}seed(t){this.Ce(t.length),this.buffer.set(t,this.position),this.position+=t.length}Fe(){return this.buffer.slice(0,this.position)}De(t){const e=function(r){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,r,!1),new Uint8Array(a.buffer)}(t),i=0!=(128&e[0]);e[0]^=i?255:128;for(let r=1;r<e.length;++r)e[r]^=i?255:0;return e}Ee(t){const e=255&t;0===e?(this.ke(0),this.ke(255)):255===e?(this.ke(255),this.ke(0)):this.ke(e)}be(t){const e=255&t;0===e?(this.Me(0),this.Me(255)):255===e?(this.Me(255),this.Me(0)):this.Me(t)}Ae(){this.ke(0),this.ke(1)}Pe(){this.Me(0),this.Me(1)}ke(t){this.Ce(1),this.buffer[this.position++]=t}Me(t){this.Ce(1),this.buffer[this.position++]=~t}Ce(t){const e=t+this.position;if(e<=this.buffer.length)return;let i=2*this.buffer.length;i<e&&(i=e);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class hW{constructor(t){this.$e=t}we(t){this.$e.Te(t)}fe(t){this.$e.ve(t)}le(t){this.$e.Se(t)}ae(){this.$e.Ne()}}class dW{constructor(t){this.$e=t}we(t){this.$e.Re(t)}fe(t){this.$e.Ve(t)}le(t){this.$e.xe(t)}ae(){this.$e.Oe()}}class uS{constructor(){this.$e=new uW,this.Be=new hW(this.$e),this.Le=new dW(this.$e)}seed(t){this.$e.seed(t)}qe(t){return 0===t?this.Be:this.Le}Fe(){return this.$e.Fe()}reset(){this.$e.reset()}}class qb{constructor(t,e,i,r){this.indexId=t,this.documentKey=e,this.arrayValue=i,this.directionalValue=r}Ue(){const t=this.directionalValue.length,e=0===t||255===this.directionalValue[t-1]?t+1:t,i=new Uint8Array(e);return i.set(this.directionalValue,0),e!==t?i.set([0],this.directionalValue.length):++i[i.length-1],new qb(this.indexId,this.documentKey,this.arrayValue,i)}}function Lv(n,t){let e=n.indexId-t.indexId;return 0!==e?e:(e=FB(n.arrayValue,t.arrayValue),0!==e?e:(e=FB(n.directionalValue,t.directionalValue),0!==e?e:Ut.comparator(n.documentKey,t.documentKey)))}function FB(n,t){for(let e=0;e<n.length&&e<t.length;++e){const i=n[e]-t[e];if(0!==i)return i}return n.length-t.length}class pW{constructor(t){this.collectionId=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment(),this.Ke=t.orderBy,this.Ge=[];for(const e of t.filters){const i=e;i.isInequality()?this.Qe=i:this.Ge.push(i)}}je(t){Ii(t.collectionGroup===this.collectionId);const e=Zi(t);if(void 0!==e&&!this.We(e))return!1;const i=bn(t);let r=0,a=0;for(;r<i.length&&this.We(i[r]);++r);if(r===i.length)return!0;if(void 0!==this.Qe){const g=i[r];if(!this.ze(this.Qe,g)||!this.He(this.Ke[a++],g))return!1;++r}for(;r<i.length;++r)if(a>=this.Ke.length||!this.He(this.Ke[a++],i[r]))return!1;return!0}We(t){for(const e of this.Ge)if(this.ze(e,t))return!0;return!1}ze(t,e){return!(void 0===t||!t.field.isEqual(e.fieldPath))&&2===e.kind==("array-contains"===t.op||"array-contains-any"===t.op)}He(t,e){return!!t.field.isEqual(e.fieldPath)&&(0===e.kind&&"asc"===t.dir||1===e.kind&&"desc"===t.dir)}}function NB(n){var t,e;if(Ii(n instanceof ho||n instanceof ms),n instanceof ho){if(n instanceof Rz){const r=(null===(e=null===(t=n.value.arrayValue)||void 0===t?void 0:t.values)||void 0===e?void 0:e.map(a=>ho.create(n.field,"==",a)))||[];return ms.create(r,"or")}return n}const i=n.filters.map(r=>NB(r));return ms.create(i,n.op)}function fW(n){if(0===n.getFilters().length)return[];const t=IP(NB(n));return Ii(zB(t)),TP(t)||SP(t)?[t]:t.getFilters()}function TP(n){return n instanceof ho}function SP(n){return n instanceof ms&&aP(n)}function zB(n){return TP(n)||SP(n)||function(t){if(t instanceof ms&&sP(t)){for(const e of t.getFilters())if(!TP(e)&&!SP(e))return!1;return!0}return!1}(n)}function IP(n){if(Ii(n instanceof ho||n instanceof ms),n instanceof ho)return n;if(1===n.filters.length)return IP(n.filters[0]);const t=n.filters.map(i=>IP(i));let e=ms.create(t,n.op);return e=cM(e),zB(e)?e:(Ii(e instanceof ms),Ii(S1(e)),Ii(e.filters.length>1),e.filters.reduce((i,r)=>DP(i,r)))}function DP(n,t){let e;return Ii(n instanceof ho||n instanceof ms),Ii(t instanceof ho||t instanceof ms),e=n instanceof ho?t instanceof ho?ms.create([n,t],"and"):BB(n,t):t instanceof ho?BB(t,n):function(i,r){if(Ii(i.filters.length>0&&r.filters.length>0),S1(i)&&S1(r))return Az(i,r.getFilters());const a=sP(i)?i:r,g=sP(i)?r:i,E=a.filters.map(O=>DP(O,g));return ms.create(E,"or")}(n,t),cM(e)}function BB(n,t){if(S1(t))return Az(t,n.getFilters());{const e=t.filters.map(i=>DP(n,i));return ms.create(e,"or")}}function cM(n){if(Ii(n instanceof ho||n instanceof ms),n instanceof ho)return n;const t=n.getFilters();if(1===t.length)return cM(t[0]);if(Iz(n))return n;const e=t.map(r=>cM(r)),i=[];return e.forEach(r=>{r instanceof ho?i.push(r):r instanceof ms&&(r.op===n.op?i.push(...r.filters):i.push(r))}),1===i.length?i[0]:ms.create(i,n.op)}class mW{constructor(){this.Je=new AP}addToCollectionParentIndex(t,e){return this.Je.add(e),jt.resolve()}getCollectionParents(t,e){return jt.resolve(this.Je.getEntries(e))}addFieldIndex(t,e){return jt.resolve()}deleteFieldIndex(t,e){return jt.resolve()}getDocumentsMatchingTarget(t,e){return jt.resolve(null)}getIndexType(t,e){return jt.resolve(0)}getFieldIndexes(t,e){return jt.resolve([])}getNextCollectionGroupToUpdate(t){return jt.resolve(null)}getMinOffset(t,e){return jt.resolve(_p.min())}getMinOffsetFromCollectionGroup(t,e){return jt.resolve(_p.min())}updateCollectionGroup(t,e,i){return jt.resolve()}updateIndexEntries(t,e){return jt.resolve()}}class AP{constructor(){this.index={}}add(t){const e=t.lastSegment(),i=t.popLast(),r=this.index[e]||new Is(mt.comparator),a=!r.has(i);return this.index[e]=r.add(i),a}has(t){const e=t.lastSegment(),i=t.popLast(),r=this.index[e];return r&&r.has(i)}getEntries(t){return(this.index[t]||new Is(mt.comparator)).toArray()}}const uM=new Uint8Array(0);class gW{constructor(t,e){this.user=t,this.databaseId=e,this.Ye=new AP,this.Xe=new Pv(i=>Vb(i),(i,r)=>YT(i,r)),this.uid=t.uid||""}addToCollectionParentIndex(t,e){if(!this.Ye.has(e)){const i=e.lastSegment(),r=e.popLast();t.addOnCommittedListener(()=>{this.Ye.add(e)});const a={collectionId:i,parent:Gh(r)};return VB(t).put(a)}return jt.resolve()}getCollectionParents(t,e){const i=[],r=IDBKeyRange.bound([e,""],[ce(e),""],!1,!0);return VB(t).W(r).next(a=>{for(const g of a){if(g.collectionId!==e)break;i.push(kg(g.parent))}return i})}addFieldIndex(t,e){const i=hM(t),r={indexId:(g=e).indexId,collectionGroup:g.collectionGroup,fields:g.fields.map(E=>[E.fieldPath.canonicalString(),E.kind])};var g;delete r.indexId;const a=i.add(r);if(e.indexState){const g=dS(t);return a.next(E=>{g.put(RB(E,this.user,e.indexState.sequenceNumber,e.indexState.offset))})}return a.next()}deleteFieldIndex(t,e){const i=hM(t),r=dS(t),a=hS(t);return i.delete(e.indexId).next(()=>r.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0)))}getDocumentsMatchingTarget(t,e){const i=hS(t);let r=!0;const a=new Map;return jt.forEach(this.Ze(e),g=>this.tn(t,g).next(E=>{r&&(r=!!E),a.set(g,E)})).next(()=>{if(r){let g=Ir();const E=[];return jt.forEach(a,(O,j)=>{var Y;kn("IndexedDbIndexManager",`Using index ${Y=O,`id=${Y.indexId}|cg=${Y.collectionGroup}|f=${Y.fields.map(Bn=>`${Bn.fieldPath}:${Bn.kind}`).join(",")}`} to execute ${Vb(e)}`);const se=function(Bn,Un){const ii=Zi(Un);if(void 0===ii)return null;for(const si of QA(Bn,ii.fieldPath))switch(si.op){case"array-contains-any":return si.value.arrayValue.values||[];case"array-contains":return[si.value]}return null}(j,O),be=function(Bn,Un){const ii=new Map;for(const si of bn(Un))for(const _r of QA(Bn,si.fieldPath))switch(_r.op){case"==":case"in":ii.set(si.fieldPath.canonicalString(),_r.value);break;case"not-in":case"!=":return ii.set(si.fieldPath.canonicalString(),_r.value),Array.from(ii.values())}return null}(j,O),Me=function(Bn,Un){const ii=[];let si=!0;for(const _r of bn(Un)){const Ds=0===_r.kind?Lz(Bn,_r.fieldPath,Bn.startAt):Fz(Bn,_r.fieldPath,Bn.startAt);ii.push(Ds.value),si&&(si=Ds.inclusive)}return new Rv(ii,si)}(j,O),Ge=function(Bn,Un){const ii=[];let si=!0;for(const _r of bn(Un)){const Ds=0===_r.kind?Fz(Bn,_r.fieldPath,Bn.endAt):Lz(Bn,_r.fieldPath,Bn.endAt);ii.push(Ds.value),si&&(si=Ds.inclusive)}return new Rv(ii,si)}(j,O),_t=this.en(O,j,Me),Dt=this.en(O,j,Ge),_n=this.nn(O,j,be),Ln=this.sn(O.indexId,se,_t,Me.inclusive,Dt,Ge.inclusive,_n);return jt.forEach(Ln,Bn=>i.J(Bn,e.limit).next(Un=>{Un.forEach(ii=>{const si=Ut.fromSegments(ii.documentKey);g.has(si)||(g=g.add(si),E.push(si))})}))}).next(()=>E)}return jt.resolve(null)})}Ze(t){let e=this.Xe.get(t);return e||(e=0===t.filters.length?[t]:fW(ms.create(t.filters,"and")).map(i=>cP(t.path,t.collectionGroup,t.orderBy,i.getFilters(),t.limit,t.startAt,t.endAt)),this.Xe.set(t,e),e)}sn(t,e,i,r,a,g,E){const O=(null!=e?e.length:1)*Math.max(i.length,a.length),j=O/(null!=e?e.length:1),Y=[];for(let se=0;se<O;++se){const be=e?this.rn(e[se/j]):uM,Me=this.on(t,be,i[se%j],r),Ge=this.un(t,be,a[se%j],g),_t=E.map(Dt=>this.on(t,be,Dt,!0));Y.push(...this.createRange(Me,Ge,_t))}return Y}on(t,e,i,r){const a=new qb(t,Ut.empty(),e,i);return r?a:a.Ue()}un(t,e,i,r){const a=new qb(t,Ut.empty(),e,i);return r?a.Ue():a}tn(t,e){const i=new pW(e),r=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment();return this.getFieldIndexes(t,r).next(a=>{let g=null;for(const E of a)i.je(E)&&(!g||E.fields.length>g.fields.length)&&(g=E);return g})}getIndexType(t,e){let i=2;const r=this.Ze(e);return jt.forEach(r,a=>this.tn(t,a).next(g=>{g?0!==i&&g.fields.length<function(E){let O=new Is(gn.comparator),j=!1;for(const Y of E.filters)for(const se of Y.getFlattenedFilters())se.field.isKeyField()||("array-contains"===se.op||"array-contains-any"===se.op?j=!0:O=O.add(se.field));for(const Y of E.orderBy)Y.field.isKeyField()||(O=O.add(Y.field));return O.size+(j?1:0)}(a)&&(i=1):i=0})).next(()=>null!==e.limit&&r.length>1&&2===i?1:i)}cn(t,e){const i=new uS;for(const r of bn(t)){const a=e.data.field(r.fieldPath);if(null==a)return null;const g=i.qe(r.kind);Zb.Ie.ue(a,g)}return i.Fe()}rn(t){const e=new uS;return Zb.Ie.ue(t,e.qe(0)),e.Fe()}an(t,e){const i=new uS;return Zb.Ie.ue(Bb(this.databaseId,e),i.qe(function(r){const a=bn(r);return 0===a.length?0:a[a.length-1].kind}(t))),i.Fe()}nn(t,e,i){if(null===i)return[];let r=[];r.push(new uS);let a=0;for(const g of bn(t)){const E=i[a++];for(const O of r)if(this.hn(e,g.fieldPath)&&qT(E))r=this.ln(r,g,E);else{const j=O.qe(g.kind);Zb.Ie.ue(E,j)}}return this.fn(r)}en(t,e,i){return this.nn(t,e,i.position)}fn(t){const e=[];for(let i=0;i<t.length;++i)e[i]=t[i].Fe();return e}ln(t,e,i){const r=[...t],a=[];for(const g of i.arrayValue.values||[])for(const E of r){const O=new uS;O.seed(E.Fe()),Zb.Ie.ue(g,O.qe(e.kind)),a.push(O)}return a}hn(t,e){return!!t.filters.find(i=>i instanceof ho&&i.field.isEqual(e)&&("in"===i.op||"not-in"===i.op))}getFieldIndexes(t,e){const i=hM(t),r=dS(t);return(e?i.W("collectionGroupIndex",IDBKeyRange.bound(e,e)):i.W()).next(a=>{const g=[];return jt.forEach(a,E=>r.get([E.indexId,this.uid]).next(O=>{g.push(function(j,Y){const se=Y?new E1(Y.sequenceNumber,new _p($b(Y.readTime),new Ut(kg(Y.documentKey)),Y.largestBatchId)):E1.empty(),be=j.fields.map(([Me,Ge])=>new fs(gn.fromServerFormat(Me),Ge));return new pi(j.indexId,j.collectionGroup,be,se)}(E,O))})).next(()=>g)})}getNextCollectionGroupToUpdate(t){return this.getFieldIndexes(t).next(e=>0===e.length?null:(e.sort((i,r)=>{const a=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return 0!==a?a:q(i.collectionGroup,r.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(t,e,i){const r=hM(t),a=dS(t);return this.dn(t).next(g=>r.W("collectionGroupIndex",IDBKeyRange.bound(e,e)).next(E=>jt.forEach(E,O=>a.put(RB(O.indexId,this.user,g,i)))))}updateIndexEntries(t,e){const i=new Map;return jt.forEach(e,(r,a)=>{const g=i.get(r.collectionGroup);return(g?jt.resolve(g):this.getFieldIndexes(t,r.collectionGroup)).next(E=>(i.set(r.collectionGroup,E),jt.forEach(E,O=>this._n(t,r,O).next(j=>{const Y=this.wn(a,O);return j.isEqual(Y)?jt.resolve():this.mn(t,a,O,j,Y)}))))})}gn(t,e,i,r){return hS(t).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.an(i,e.key),documentKey:e.key.path.toArray()})}yn(t,e,i,r){return hS(t).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.an(i,e.key),e.key.path.toArray()])}_n(t,e,i){const r=hS(t);let a=new Is(Lv);return r.Z({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.an(i,e)])},(g,E)=>{a=a.add(new qb(i.indexId,e,E.arrayValue,E.directionalValue))}).next(()=>a)}wn(t,e){let i=new Is(Lv);const r=this.cn(e,t);if(null==r)return i;const a=Zi(e);if(null!=a){const g=t.data.field(a.fieldPath);if(qT(g))for(const E of g.arrayValue.values||[])i=i.add(new qb(e.indexId,t.key,this.rn(E),r))}else i=i.add(new qb(e.indexId,t.key,uM,r));return i}mn(t,e,i,r,a){kn("IndexedDbIndexManager","Updating index entries for document '%s'",e.key);const g=[];return function(E,O,j,Y,se){const be=E.getIterator(),Me=O.getIterator();let Ge=D1(be),_t=D1(Me);for(;Ge||_t;){let Dt=!1,_n=!1;if(Ge&&_t){const Ln=j(Ge,_t);Ln<0?_n=!0:Ln>0&&(Dt=!0)}else null!=Ge?_n=!0:Dt=!0;Dt?(Y(_t),_t=D1(Me)):_n?(se(Ge),Ge=D1(be)):(Ge=D1(be),_t=D1(Me))}}(r,a,Lv,E=>{g.push(this.gn(t,e,i,E))},E=>{g.push(this.yn(t,e,i,E))}),jt.waitFor(g)}dn(t){let e=1;return dS(t).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,r,a)=>{a.done(),e=r.sequenceNumber+1}).next(()=>e)}createRange(t,e,i){i=i.sort((g,E)=>Lv(g,E)).filter((g,E,O)=>!E||0!==Lv(g,O[E-1]));const r=[];r.push(t);for(const g of i){const E=Lv(g,t),O=Lv(g,e);if(0===E)r[0]=t.Ue();else if(E>0&&O<0)r.push(g),r.push(g.Ue());else if(O>0)break}r.push(e);const a=[];for(let g=0;g<r.length;g+=2){if(this.pn(r[g],r[g+1]))return[];a.push(IDBKeyRange.bound([r[g].indexId,this.uid,r[g].arrayValue,r[g].directionalValue,uM,[]],[r[g+1].indexId,this.uid,r[g+1].arrayValue,r[g+1].directionalValue,uM,[]]))}return a}pn(t,e){return Lv(t,e)>0}getMinOffsetFromCollectionGroup(t,e){return this.getFieldIndexes(t,e).next(UB)}getMinOffset(t,e){return jt.mapArray(this.Ze(e),i=>this.tn(t,i).next(r=>r||fi())).next(UB)}}function VB(n){return Yc(n,"collectionParents")}function hS(n){return Yc(n,"indexEntries")}function hM(n){return Yc(n,"indexConfiguration")}function dS(n){return Yc(n,"indexState")}function UB(n){Ii(0!==n.length);let t=n[0].indexState.offset,e=t.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;eP(r,t)<0&&(t=r),e<r.largestBatchId&&(e=r.largestBatchId)}return new _p(t.readTime,t.documentKey,e)}const HB={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Bd{constructor(t,e,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=i}static withCacheSize(t){return new Bd(t,Bd.DEFAULT_COLLECTION_PERCENTILE,Bd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function jB(n,t,e){const i=n.store("mutations"),r=n.store("documentMutations"),a=[],g=IDBKeyRange.only(e.batchId);let E=0;const O=i.Z({range:g},(Y,se,be)=>(E++,be.delete()));a.push(O.next(()=>{Ii(1===E)}));const j=[];for(const Y of e.mutations){const se=EB(t,Y.key.path,e.batchId);a.push(r.delete(se)),j.push(Y.key)}return jt.waitFor(a).next(()=>j)}function dM(n){if(!n)return 0;let t;if(n.document)t=n.document;else if(n.unknownDocument)t=n.unknownDocument;else{if(!n.noDocument)throw fi();t=n.noDocument}return JSON.stringify(t).length}Bd.DEFAULT_COLLECTION_PERCENTILE=10,Bd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bd.DEFAULT=new Bd(41943040,Bd.DEFAULT_COLLECTION_PERCENTILE,Bd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bd.DISABLED=new Bd(-1,0,0);class pM{constructor(t,e,i,r){this.userId=t,this.yt=e,this.indexManager=i,this.referenceDelegate=r,this.In={}}static re(t,e,i,r){Ii(""!==t.uid);const a=t.isAuthenticated()?t.uid:"";return new pM(a,e,i,r)}checkEmpty(t){let e=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Fv(t).Z({index:"userMutationsIndex",range:i},(r,a,g)=>{e=!1,g.done()}).next(()=>e)}addMutationBatch(t,e,i,r){const a=N1(t),g=Fv(t);return g.add({}).next(E=>{Ii("number"==typeof E);const O=new bP(E,e,i,r),j=function(be,Me,Ge){const _t=Ge.baseMutations.map(_n=>aS(be.ie,_n)),Dt=Ge.mutations.map(_n=>aS(be.ie,_n));return{userId:Me,batchId:Ge.batchId,localWriteTimeMs:Ge.localWriteTime.toMillis(),baseMutations:_t,mutations:Dt}}(this.yt,this.userId,O),Y=[];let se=new Is((be,Me)=>q(be.canonicalString(),Me.canonicalString()));for(const be of r){const Me=EB(this.userId,be.key.path,E);se=se.add(be.key.path.popLast()),Y.push(g.put(j)),Y.push(a.put(Me,G8))}return se.forEach(be=>{Y.push(this.indexManager.addToCollectionParentIndex(t,be))}),t.addOnCommittedListener(()=>{this.In[E]=O.keys()}),jt.waitFor(Y).next(()=>O)})}lookupMutationBatch(t,e){return Fv(t).get(e).next(i=>i?(Ii(i.userId===this.userId),Wb(this.yt,i)):null)}Tn(t,e){return this.In[e]?jt.resolve(this.In[e]):this.lookupMutationBatch(t,e).next(i=>{if(i){const r=i.keys();return this.In[e]=r,r}return null})}getNextMutationBatchAfterBatchId(t,e){const i=e+1,r=IDBKeyRange.lowerBound([this.userId,i]);let a=null;return Fv(t).Z({index:"userMutationsIndex",range:r},(g,E,O)=>{E.userId===this.userId&&(Ii(E.batchId>=i),a=Wb(this.yt,E)),O.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(t){const e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=-1;return Fv(t).Z({index:"userMutationsIndex",range:e,reverse:!0},(r,a,g)=>{i=a.batchId,g.done()}).next(()=>i)}getAllMutationBatches(t){const e=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Fv(t).W("userMutationsIndex",e).next(i=>i.map(r=>Wb(this.yt,r)))}getAllMutationBatchesAffectingDocumentKey(t,e){const i=sM(this.userId,e.path),r=IDBKeyRange.lowerBound(i),a=[];return N1(t).Z({range:r},(g,E,O)=>{const[j,Y,se]=g,be=kg(Y);if(j===this.userId&&e.path.isEqual(be))return Fv(t).get(se).next(Me=>{if(!Me)throw fi();Ii(Me.userId===this.userId),a.push(Wb(this.yt,Me))});O.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(t,e){let i=new Is(q);const r=[];return e.forEach(a=>{const g=sM(this.userId,a.path),E=IDBKeyRange.lowerBound(g),O=N1(t).Z({range:E},(j,Y,se)=>{const[be,Me,Ge]=j,_t=kg(Me);be===this.userId&&a.path.isEqual(_t)?i=i.add(Ge):se.done()});r.push(O)}),jt.waitFor(r).next(()=>this.En(t,i))}getAllMutationBatchesAffectingQuery(t,e){const i=e.path,r=i.length+1,a=sM(this.userId,i),g=IDBKeyRange.lowerBound(a);let E=new Is(q);return N1(t).Z({range:g},(O,j,Y)=>{const[se,be,Me]=O,Ge=kg(be);se===this.userId&&i.isPrefixOf(Ge)?Ge.length===r&&(E=E.add(Me)):Y.done()}).next(()=>this.En(t,E))}En(t,e){const i=[],r=[];return e.forEach(a=>{r.push(Fv(t).get(a).next(g=>{if(null===g)throw fi();Ii(g.userId===this.userId),i.push(Wb(this.yt,g))}))}),jt.waitFor(r).next(()=>i)}removeMutationBatch(t,e){return jB(t.se,this.userId,e).next(i=>(t.addOnCommittedListener(()=>{this.An(e.batchId)}),jt.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(t,r))))}An(t){delete this.In[t]}performConsistencyCheck(t){return this.checkEmpty(t).next(e=>{if(!e)return jt.resolve();const i=IDBKeyRange.lowerBound([this.userId]),r=[];return N1(t).Z({range:i},(a,g,E)=>{if(a[0]===this.userId){const O=kg(a[1]);r.push(O)}else E.done()}).next(()=>{Ii(0===r.length)})})}containsKey(t,e){return GB(t,this.userId,e)}Rn(t){return $B(t).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function GB(n,t,e){const i=sM(t,e.path),r=i[1],a=IDBKeyRange.lowerBound(i);let g=!1;return N1(n).Z({range:a,X:!0},(E,O,j)=>{const[Y,se,be]=E;Y===t&&se===r&&(g=!0),j.done()}).next(()=>g)}function Fv(n){return Yc(n,"mutations")}function N1(n){return Yc(n,"documentMutations")}function $B(n){return Yc(n,"mutationQueues")}class Kb{constructor(t){this.bn=t}next(){return this.bn+=2,this.bn}static Pn(){return new Kb(0)}static vn(){return new Kb(-1)}}class _W{constructor(t,e){this.referenceDelegate=t,this.yt=e}allocateTargetId(t){return this.Vn(t).next(e=>{const i=new Kb(e.highestTargetId);return e.highestTargetId=i.next(),this.Sn(t,e).next(()=>e.highestTargetId)})}getLastRemoteSnapshotVersion(t){return this.Vn(t).next(e=>Ae.fromTimestamp(new ge(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(t){return this.Vn(t).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(t,e,i){return this.Vn(t).next(r=>(r.highestListenSequenceNumber=e,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),e>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e),this.Sn(t,r)))}addTargetData(t,e){return this.Dn(t,e).next(()=>this.Vn(t).next(i=>(i.targetCount+=1,this.Cn(e,i),this.Sn(t,i))))}updateTargetData(t,e){return this.Dn(t,e)}removeTargetData(t,e){return this.removeMatchingKeysForTargetId(t,e.targetId).next(()=>z1(t).delete(e.targetId)).next(()=>this.Vn(t)).next(i=>(Ii(i.targetCount>0),i.targetCount-=1,this.Sn(t,i)))}removeTargets(t,e,i){let r=0;const a=[];return z1(t).Z((g,E)=>{const O=lS(E);O.sequenceNumber<=e&&null===i.get(O.targetId)&&(r++,a.push(this.removeTargetData(t,O)))}).next(()=>jt.waitFor(a)).next(()=>r)}forEachTarget(t,e){return z1(t).Z((i,r)=>{const a=lS(r);e(a)})}Vn(t){return WB(t).get("targetGlobalKey").next(e=>(Ii(null!==e),e))}Sn(t,e){return WB(t).put("targetGlobalKey",e)}Dn(t,e){return z1(t).put(MB(this.yt,e))}Cn(t,e){let i=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,i=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,i=!0),i}getTargetCount(t){return this.Vn(t).next(e=>e.targetCount)}getTargetData(t,e){const i=Vb(e),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let a=null;return z1(t).Z({range:r,index:"queryTargetsIndex"},(g,E,O)=>{const j=lS(E);YT(e,j.target)&&(a=j,O.done())}).next(()=>a)}addMatchingKeys(t,e,i){const r=[],a=Nv(t);return e.forEach(g=>{const E=Gh(g.path);r.push(a.put({targetId:i,path:E})),r.push(this.referenceDelegate.addReference(t,i,g))}),jt.waitFor(r)}removeMatchingKeys(t,e,i){const r=Nv(t);return jt.forEach(e,a=>{const g=Gh(a.path);return jt.waitFor([r.delete([i,g]),this.referenceDelegate.removeReference(t,i,a)])})}removeMatchingKeysForTargetId(t,e){const i=Nv(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(t,e){const i=IDBKeyRange.bound([e],[e+1],!1,!0),r=Nv(t);let a=Ir();return r.Z({range:i,X:!0},(g,E,O)=>{const j=kg(g[1]),Y=new Ut(j);a=a.add(Y)}).next(()=>a)}containsKey(t,e){const i=Gh(e.path),r=IDBKeyRange.bound([i],[ce(i)],!1,!0);let a=0;return Nv(t).Z({index:"documentTargetsIndex",X:!0,range:r},([g,E],O,j)=>{0!==g&&(a++,j.done())}).next(()=>a>0)}ne(t,e){return z1(t).get(e).next(i=>i?lS(i):null)}}function z1(n){return Yc(n,"targets")}function WB(n){return Yc(n,"targetGlobal")}function Nv(n){return Yc(n,"targetDocuments")}function ZB([n,t],[e,i]){const r=q(n,e);return 0===r?q(t,i):r}class yW{constructor(t){this.xn=t,this.buffer=new Is(ZB),this.Nn=0}kn(){return++this.Nn}On(t){const e=[t,this.kn()];if(this.buffer.size<this.xn)this.buffer=this.buffer.add(e);else{const i=this.buffer.last();ZB(e,i)<0&&(this.buffer=this.buffer.delete(i).add(e))}}get maxValue(){return this.buffer.last()[0]}}class vW{constructor(t,e,i){this.garbageCollector=t,this.asyncQueue=e,this.localStore=i,this.Mn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Fn(6e4)}stop(){this.Mn&&(this.Mn.cancel(),this.Mn=null)}get started(){return null!==this.Mn}Fn(t){var e=this;kn("LruGarbageCollector",`Garbage collection scheduled in ${t}ms`),this.Mn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(0,ve.Z)(function*(){e.Mn=null;try{yield e.localStore.collectGarbage(e.garbageCollector)}catch(i){Iv(i)?kn("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",i):yield Sv(i)}yield e.Fn(3e5)}))}}class bW{constructor(t,e){this.$n=t,this.params=e}calculateTargetCount(t,e){return this.$n.Bn(t).next(i=>Math.floor(e/100*i))}nthSequenceNumber(t,e){if(0===e)return jt.resolve(yp.at);const i=new yW(e);return this.$n.forEachTarget(t,r=>i.On(r.sequenceNumber)).next(()=>this.$n.Ln(t,r=>i.On(r))).next(()=>i.maxValue)}removeTargets(t,e,i){return this.$n.removeTargets(t,e,i)}removeOrphanedDocuments(t,e){return this.$n.removeOrphanedDocuments(t,e)}collect(t,e){return-1===this.params.cacheSizeCollectionThreshold?(kn("LruGarbageCollector","Garbage collection skipped; disabled"),jt.resolve(HB)):this.getCacheSize(t).next(i=>i<this.params.cacheSizeCollectionThreshold?(kn("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),HB):this.qn(t,e))}getCacheSize(t){return this.$n.getCacheSize(t)}qn(t,e){let i,r,a,g,E,O,j;const Y=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(se=>(se>this.params.maximumSequenceNumbersToCollect?(kn("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${se}`),r=this.params.maximumSequenceNumbersToCollect):r=se,g=Date.now(),this.nthSequenceNumber(t,r))).next(se=>(i=se,E=Date.now(),this.removeTargets(t,i,e))).next(se=>(a=se,O=Date.now(),this.removeOrphanedDocuments(t,i))).next(se=>(j=Date.now(),$A()<=$e.in.DEBUG&&kn("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${g-Y}ms\n\tDetermined least recently used ${r} in `+(E-g)+`ms\n\tRemoved ${a} targets in `+(O-E)+`ms\n\tRemoved ${se} documents in `+(j-O)+`ms\nTotal Duration: ${j-Y}ms`),jt.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:a,documentsRemoved:se})))}}class wW{constructor(t,e){this.db=t,this.garbageCollector=new bW(this,e)}Bn(t){const e=this.Un(t);return this.db.getTargetCache().getTargetCount(t).next(i=>e.next(r=>i+r))}Un(t){let e=0;return this.Ln(t,i=>{e++}).next(()=>e)}forEachTarget(t,e){return this.db.getTargetCache().forEachTarget(t,e)}Ln(t,e){return this.Kn(t,(i,r)=>e(r))}addReference(t,e,i){return fM(t,i)}removeReference(t,e,i){return fM(t,i)}removeTargets(t,e,i){return this.db.getTargetCache().removeTargets(t,e,i)}markPotentiallyOrphaned(t,e){return fM(t,e)}Gn(t,e){return function(i,r){let a=!1;return $B(i).tt(g=>GB(i,g,r).next(E=>(E&&(a=!0),jt.resolve(!E)))).next(()=>a)}(t,e)}removeOrphanedDocuments(t,e){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let a=0;return this.Kn(t,(g,E)=>{if(E<=e){const O=this.Gn(t,g).next(j=>{if(!j)return a++,i.getEntry(t,g).next(()=>(i.removeEntry(g,Ae.min()),Nv(t).delete([0,Gh(g.path)])))});r.push(O)}}).next(()=>jt.waitFor(r)).next(()=>i.apply(t)).next(()=>a)}removeTarget(t,e){const i=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,i)}updateLimboDocument(t,e){return fM(t,e)}Kn(t,e){const i=Nv(t);let r,a=yp.at;return i.Z({index:"documentTargetsIndex"},([g,E],{path:O,sequenceNumber:j})=>{0===g?(a!==yp.at&&e(new Ut(kg(r)),a),a=j,r=O):a=yp.at}).next(()=>{a!==yp.at&&e(new Ut(kg(r)),a)})}getCacheSize(t){return this.db.getRemoteDocumentCache().getSize(t)}}function fM(n,t){return Nv(n).put((i=n.currentSequenceNumber,{targetId:0,path:Gh(t.path),sequenceNumber:i}));var i}class qB{constructor(){this.changes=new Pv(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,da.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const i=this.changes.get(e);return void 0!==i?jt.resolve(i):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class xW{constructor(t){this.yt=t}setIndexManager(t){this.indexManager=t}addEntry(t,e,i){return Yb(t).put(i)}removeEntry(t,e,i){return Yb(t).delete(function(r,a){const g=r.path.toArray();return[g.slice(0,g.length-2),g[g.length-2],aM(a),g[g.length-1]]}(e,i))}updateMetadata(t,e){return this.getMetadata(t).next(i=>(i.byteSize+=e,this.Qn(t,i)))}getEntry(t,e){let i=da.newInvalidDocument(e);return Yb(t).Z({index:"documentKeyIndex",range:IDBKeyRange.only(pS(e))},(r,a)=>{i=this.jn(e,a)}).next(()=>i)}Wn(t,e){let i={size:0,document:da.newInvalidDocument(e)};return Yb(t).Z({index:"documentKeyIndex",range:IDBKeyRange.only(pS(e))},(r,a)=>{i={document:this.jn(e,a),size:dM(a)}}).next(()=>i)}getEntries(t,e){let i=zd();return this.zn(t,e,(r,a)=>{const g=this.jn(r,a);i=i.insert(r,g)}).next(()=>i)}Hn(t,e){let i=zd(),r=new Ga(Ut.comparator);return this.zn(t,e,(a,g)=>{const E=this.jn(a,g);i=i.insert(a,E),r=r.insert(a,dM(g))}).next(()=>({documents:i,Jn:r}))}zn(t,e,i){if(e.isEmpty())return jt.resolve();let r=new Is(QB);e.forEach(O=>r=r.add(O));const a=IDBKeyRange.bound(pS(r.first()),pS(r.last())),g=r.getIterator();let E=g.getNext();return Yb(t).Z({index:"documentKeyIndex",range:a},(O,j,Y)=>{const se=Ut.fromSegments([...j.prefixPath,j.collectionGroup,j.documentId]);for(;E&&QB(E,se)<0;)i(E,null),E=g.getNext();E&&E.isEqual(se)&&(i(E,j),E=g.hasNext()?g.getNext():null),E?Y.j(pS(E)):Y.done()}).next(()=>{for(;E;)i(E,null),E=g.hasNext()?g.getNext():null})}getDocumentsMatchingQuery(t,e,i,r){const a=e.path,g=[a.popLast().toArray(),a.lastSegment(),aM(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],E=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Yb(t).W(IDBKeyRange.bound(g,E,!0)).next(O=>{let j=zd();for(const Y of O){const se=this.jn(Ut.fromSegments(Y.prefixPath.concat(Y.collectionGroup,Y.documentId)),Y);se.isFoundDocument()&&(QT(e,se)||r.has(se.key))&&(j=j.insert(se.key,se))}return j})}getAllFromCollectionGroup(t,e,i,r){let a=zd();const g=JB(e,i),E=JB(e,_p.max());return Yb(t).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(g,E,!0)},(O,j,Y)=>{const se=this.jn(Ut.fromSegments(j.prefixPath.concat(j.collectionGroup,j.documentId)),j);a=a.insert(se.key,se),a.size===r&&Y.done()}).next(()=>a)}newChangeBuffer(t){return new CW(this,!!t&&t.trackRemovals)}getSize(t){return this.getMetadata(t).next(e=>e.byteSize)}getMetadata(t){return YB(t).get("remoteDocumentGlobalKey").next(e=>(Ii(!!e),e))}Qn(t,e){return YB(t).put("remoteDocumentGlobalKey",e)}jn(t,e){if(e){const i=function aW(n,t){let e;if(t.document)e=gB(n.ie,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const i=Ut.fromSegments(t.noDocument.path),r=$b(t.noDocument.readTime);e=da.newNoDocument(i,r),t.hasCommittedMutations&&e.setHasCommittedMutations()}else{if(!t.unknownDocument)return fi();{const i=Ut.fromSegments(t.unknownDocument.path),r=$b(t.unknownDocument.version);e=da.newUnknownDocument(i,r)}}return t.readTime&&e.setReadTime(function(i){const r=new ge(i[0],i[1]);return Ae.fromTimestamp(r)}(t.readTime)),e}(this.yt,e);if(!i.isNoDocument()||!i.version.isEqual(Ae.min()))return i}return da.newInvalidDocument(t)}}function KB(n){return new xW(n)}class CW extends qB{constructor(t,e){super(),this.Yn=t,this.trackRemovals=e,this.Xn=new Pv(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(t){const e=[];let i=0,r=new Is((a,g)=>q(a.canonicalString(),g.canonicalString()));return this.changes.forEach((a,g)=>{const E=this.Xn.get(a);if(e.push(this.Yn.removeEntry(t,a,E.readTime)),g.isValidDocument()){const O=AB(this.Yn.yt,g);r=r.add(a.path.popLast());const j=dM(O);i+=j-E.size,e.push(this.Yn.addEntry(t,a,O))}else if(i-=E.size,this.trackRemovals){const O=AB(this.Yn.yt,g.convertToNoDocument(Ae.min()));e.push(this.Yn.addEntry(t,a,O))}}),r.forEach(a=>{e.push(this.Yn.indexManager.addToCollectionParentIndex(t,a))}),e.push(this.Yn.updateMetadata(t,i)),jt.waitFor(e)}getFromCache(t,e){return this.Yn.Wn(t,e).next(i=>(this.Xn.set(e,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(t,e){return this.Yn.Hn(t,e).next(({documents:i,Jn:r})=>(r.forEach((a,g)=>{this.Xn.set(a,{size:g,readTime:i.get(a).readTime})}),i))}}function YB(n){return Yc(n,"remoteDocumentGlobal")}function Yb(n){return Yc(n,"remoteDocumentsV14")}function pS(n){const t=n.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function JB(n,t){const e=t.documentKey.path.toArray();return[n,aM(t.readTime),e.slice(0,e.length-2),e.length>0?e[e.length-1]:""]}function QB(n,t){const e=n.path.toArray(),i=t.path.toArray();let r=0;for(let a=0;a<e.length-2&&a<i.length-2;++a)if(r=q(e[a],i[a]),r)return r;return r=q(e.length,i.length),r||(r=q(e[e.length-2],i[i.length-2]),r||q(e[e.length-1],i[i.length-1]))}class EW{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class XB{constructor(t,e,i,r){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=i,this.indexManager=r}getDocument(t,e){let i=null;return this.documentOverlayCache.getOverlay(t,e).next(r=>(i=r,this.remoteDocumentCache.getEntry(t,e))).next(r=>(null!==i&&eS(i.mutation,r,Nd.empty(),ge.now()),r))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(i=>this.getLocalViewOfDocuments(t,i,Ir()).next(()=>i))}getLocalViewOfDocuments(t,e,i=Ir()){const r=Ag();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,i).next(a=>{let g=tS();return a.forEach((E,O)=>{g=g.insert(E,O.overlayedDocument)}),g}))}getOverlayedDocuments(t,e){const i=Ag();return this.populateOverlays(t,i,e).next(()=>this.computeViews(t,e,i,Ir()))}populateOverlays(t,e,i){const r=[];return i.forEach(a=>{e.has(a)||r.push(a)}),this.documentOverlayCache.getOverlays(t,r).next(a=>{a.forEach((g,E)=>{e.set(g,E)})})}computeViews(t,e,i,r){let a=zd();const g=nS(),E=nS();return e.forEach((O,j)=>{const Y=i.get(j.key);r.has(j.key)&&(void 0===Y||Y.mutation instanceof Z_)?a=a.insert(j.key,j):void 0!==Y?(g.set(j.key,Y.mutation.getFieldMask()),eS(Y.mutation,j,Y.mutation.getFieldMask(),ge.now())):g.set(j.key,Nd.empty())}),this.recalculateAndSaveOverlays(t,a).next(O=>(O.forEach((j,Y)=>g.set(j,Y)),e.forEach((j,Y)=>{var se;return E.set(j,new EW(Y,null!==(se=g.get(j))&&void 0!==se?se:null))}),E))}recalculateAndSaveOverlays(t,e){const i=nS();let r=new Ga((g,E)=>g-E),a=Ir();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(g=>{for(const E of g)E.keys().forEach(O=>{const j=e.get(O);if(null===j)return;let Y=i.get(O)||Nd.empty();Y=E.applyToLocalView(j,Y),i.set(O,Y);const se=(r.get(E.batchId)||Ir()).add(O);r=r.insert(E.batchId,se)})}).next(()=>{const g=[],E=r.getReverseIterator();for(;E.hasNext();){const O=E.getNext(),j=O.key,Y=O.value,se=oB();Y.forEach(be=>{if(!a.has(be)){const Me=Yz(e.get(be),i.get(be));null!==Me&&se.set(be,Me),a=a.add(be)}}),g.push(this.documentOverlayCache.saveOverlays(t,j,se))}return jt.waitFor(g)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,e,i){return Ut.isDocumentKey((r=e).path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(t,e.path):hP(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,i):this.getDocumentsMatchingCollectionQuery(t,e,i);var r}getNextDocuments(t,e,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,i,r).next(a=>{const g=r-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,i.largestBatchId,r-a.size):jt.resolve(Ag());let E=-1,O=a;return g.next(j=>jt.forEach(j,(Y,se)=>(E<se.largestBatchId&&(E=se.largestBatchId),a.get(Y)?jt.resolve():this.remoteDocumentCache.getEntry(t,Y).next(be=>{O=O.insert(Y,be)}))).next(()=>this.populateOverlays(t,j,a)).next(()=>this.computeViews(t,O,j,Ir())).next(Y=>({batchId:E,changes:rB(Y)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Ut(e)).next(i=>{let r=tS();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(t,e,i){const r=e.collectionGroup;let a=tS();return this.indexManager.getCollectionParents(t,r).next(g=>jt.forEach(g,E=>{const O=(j=e,Y=E.child(r),new W_(Y,null,j.explicitOrderBy.slice(),j.filters.slice(),j.limit,j.limitType,j.startAt,j.endAt));var j,Y;return this.getDocumentsMatchingCollectionQuery(t,O,i).next(j=>{j.forEach((Y,se)=>{a=a.insert(Y,se)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(t,e,i){let r;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,i.largestBatchId).next(a=>(r=a,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,i,r))).next(a=>{r.forEach((E,O)=>{const j=O.getKey();null===a.get(j)&&(a=a.insert(j,da.newInvalidDocument(j)))});let g=tS();return a.forEach((E,O)=>{const j=r.get(E);void 0!==j&&eS(j.mutation,O,Nd.empty(),ge.now()),QT(e,O)&&(g=g.insert(E,O))}),g})}}class TW{constructor(t){this.yt=t,this.Zn=new Map,this.ts=new Map}getBundleMetadata(t,e){return jt.resolve(this.Zn.get(e))}saveBundleMetadata(t,e){var i;return this.Zn.set(e.id,{id:(i=e).id,version:i.version,createTime:ll(i.createTime)}),jt.resolve()}getNamedQuery(t,e){return jt.resolve(this.ts.get(e))}saveNamedQuery(t,e){return this.ts.set(e.name,{name:(i=e).name,query:CP(i.bundledQuery),readTime:ll(i.readTime)}),jt.resolve();var i}}class SW{constructor(){this.overlays=new Ga(Ut.comparator),this.es=new Map}getOverlay(t,e){return jt.resolve(this.overlays.get(e))}getOverlays(t,e){const i=Ag();return jt.forEach(e,r=>this.getOverlay(t,r).next(a=>{null!==a&&i.set(r,a)})).next(()=>i)}saveOverlays(t,e,i){return i.forEach((r,a)=>{this.oe(t,e,a)}),jt.resolve()}removeOverlaysForBatchId(t,e,i){const r=this.es.get(i);return void 0!==r&&(r.forEach(a=>this.overlays=this.overlays.remove(a)),this.es.delete(i)),jt.resolve()}getOverlaysForCollection(t,e,i){const r=Ag(),a=e.length+1,g=new Ut(e.child("")),E=this.overlays.getIteratorFrom(g);for(;E.hasNext();){const O=E.getNext().value,j=O.getKey();if(!e.isPrefixOf(j.path))break;j.path.length===a&&O.largestBatchId>i&&r.set(O.getKey(),O)}return jt.resolve(r)}getOverlaysForCollectionGroup(t,e,i,r){let a=new Ga((j,Y)=>j-Y);const g=this.overlays.getIterator();for(;g.hasNext();){const j=g.getNext().value;if(j.getKey().getCollectionGroup()===e&&j.largestBatchId>i){let Y=a.get(j.largestBatchId);null===Y&&(Y=Ag(),a=a.insert(j.largestBatchId,Y)),Y.set(j.getKey(),j)}}const E=Ag(),O=a.getIterator();for(;O.hasNext()&&(O.getNext().value.forEach((j,Y)=>E.set(j,Y)),!(E.size()>=r)););return jt.resolve(E)}oe(t,e,i){const r=this.overlays.get(i.key);if(null!==r){const g=this.es.get(r.largestBatchId).delete(i.key);this.es.set(r.largestBatchId,g)}this.overlays=this.overlays.insert(i.key,new xP(e,i));let a=this.es.get(e);void 0===a&&(a=Ir(),this.es.set(e,a)),this.es.set(e,a.add(i.key))}}class MP{constructor(){this.ns=new Is(Jc.ss),this.rs=new Is(Jc.os)}isEmpty(){return this.ns.isEmpty()}addReference(t,e){const i=new Jc(t,e);this.ns=this.ns.add(i),this.rs=this.rs.add(i)}us(t,e){t.forEach(i=>this.addReference(i,e))}removeReference(t,e){this.cs(new Jc(t,e))}hs(t,e){t.forEach(i=>this.removeReference(i,e))}ls(t){const e=new Ut(new mt([])),i=new Jc(e,t),r=new Jc(e,t+1),a=[];return this.rs.forEachInRange([i,r],g=>{this.cs(g),a.push(g.key)}),a}fs(){this.ns.forEach(t=>this.cs(t))}cs(t){this.ns=this.ns.delete(t),this.rs=this.rs.delete(t)}ds(t){const e=new Ut(new mt([])),i=new Jc(e,t),r=new Jc(e,t+1);let a=Ir();return this.rs.forEachInRange([i,r],g=>{a=a.add(g.key)}),a}containsKey(t){const e=new Jc(t,0),i=this.ns.firstAfterOrEqual(e);return null!==i&&t.isEqual(i.key)}}class Jc{constructor(t,e){this.key=t,this._s=e}static ss(t,e){return Ut.comparator(t.key,e.key)||q(t._s,e._s)}static os(t,e){return q(t._s,e._s)||Ut.comparator(t.key,e.key)}}class IW{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.ws=1,this.gs=new Is(Jc.ss)}checkEmpty(t){return jt.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,i,r){const a=this.ws;this.ws++;const g=new bP(a,e,i,r);this.mutationQueue.push(g);for(const E of r)this.gs=this.gs.add(new Jc(E.key,a)),this.indexManager.addToCollectionParentIndex(t,E.key.path.popLast());return jt.resolve(g)}lookupMutationBatch(t,e){return jt.resolve(this.ys(e))}getNextMutationBatchAfterBatchId(t,e){const r=this.ps(e+1),a=r<0?0:r;return jt.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return jt.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(t){return jt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const i=new Jc(e,0),r=new Jc(e,Number.POSITIVE_INFINITY),a=[];return this.gs.forEachInRange([i,r],g=>{const E=this.ys(g._s);a.push(E)}),jt.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(t,e){let i=new Is(q);return e.forEach(r=>{const a=new Jc(r,0),g=new Jc(r,Number.POSITIVE_INFINITY);this.gs.forEachInRange([a,g],E=>{i=i.add(E._s)})}),jt.resolve(this.Is(i))}getAllMutationBatchesAffectingQuery(t,e){const i=e.path,r=i.length+1;let a=i;Ut.isDocumentKey(a)||(a=a.child(""));const g=new Jc(new Ut(a),0);let E=new Is(q);return this.gs.forEachWhile(O=>{const j=O.key.path;return!!i.isPrefixOf(j)&&(j.length===r&&(E=E.add(O._s)),!0)},g),jt.resolve(this.Is(E))}Is(t){const e=[];return t.forEach(i=>{const r=this.ys(i);null!==r&&e.push(r)}),e}removeMutationBatch(t,e){Ii(0===this.Ts(e.batchId,"removed")),this.mutationQueue.shift();let i=this.gs;return jt.forEach(e.mutations,r=>{const a=new Jc(r.key,e.batchId);return i=i.delete(a),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)}).next(()=>{this.gs=i})}An(t){}containsKey(t,e){const i=new Jc(e,0),r=this.gs.firstAfterOrEqual(i);return jt.resolve(e.isEqual(r&&r.key))}performConsistencyCheck(t){return jt.resolve()}Ts(t,e){return this.ps(t)}ps(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ys(t){const e=this.ps(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class DW{constructor(t){this.Es=t,this.docs=new Ga(Ut.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const i=e.key,r=this.docs.get(i),a=r?r.size:0,g=this.Es(e);return this.docs=this.docs.insert(i,{document:e.mutableCopy(),size:g}),this.size+=g-a,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const i=this.docs.get(e);return jt.resolve(i?i.document.mutableCopy():da.newInvalidDocument(e))}getEntries(t,e){let i=zd();return e.forEach(r=>{const a=this.docs.get(r);i=i.insert(r,a?a.document.mutableCopy():da.newInvalidDocument(r))}),jt.resolve(i)}getDocumentsMatchingQuery(t,e,i,r){let a=zd();const g=e.path,E=new Ut(g.child("")),O=this.docs.getIteratorFrom(E);for(;O.hasNext();){const{key:j,value:{document:Y}}=O.getNext();if(!g.isPrefixOf(j.path))break;j.path.length>g.length+1||eP(uz(Y),i)<=0||(r.has(Y.key)||QT(e,Y))&&(a=a.insert(Y.key,Y.mutableCopy()))}return jt.resolve(a)}getAllFromCollectionGroup(t,e,i,r){fi()}As(t,e){return jt.forEach(this.docs,i=>e(i))}newChangeBuffer(t){return new AW(this)}getSize(t){return jt.resolve(this.size)}}class AW extends qB{constructor(t){super(),this.Yn=t}applyChanges(t){const e=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?e.push(this.Yn.addEntry(t,r)):this.Yn.removeEntry(i)}),jt.waitFor(e)}getFromCache(t,e){return this.Yn.getEntry(t,e)}getAllFromCache(t,e){return this.Yn.getEntries(t,e)}}class MW{constructor(t){this.persistence=t,this.Rs=new Pv(e=>Vb(e),YT),this.lastRemoteSnapshotVersion=Ae.min(),this.highestTargetId=0,this.bs=0,this.Ps=new MP,this.targetCount=0,this.vs=Kb.Pn()}forEachTarget(t,e){return this.Rs.forEach((i,r)=>e(r)),jt.resolve()}getLastRemoteSnapshotVersion(t){return jt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return jt.resolve(this.bs)}allocateTargetId(t){return this.highestTargetId=this.vs.next(),jt.resolve(this.highestTargetId)}setTargetsMetadata(t,e,i){return i&&(this.lastRemoteSnapshotVersion=i),e>this.bs&&(this.bs=e),jt.resolve()}Dn(t){this.Rs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.vs=new Kb(e),this.highestTargetId=e),t.sequenceNumber>this.bs&&(this.bs=t.sequenceNumber)}addTargetData(t,e){return this.Dn(e),this.targetCount+=1,jt.resolve()}updateTargetData(t,e){return this.Dn(e),jt.resolve()}removeTargetData(t,e){return this.Rs.delete(e.target),this.Ps.ls(e.targetId),this.targetCount-=1,jt.resolve()}removeTargets(t,e,i){let r=0;const a=[];return this.Rs.forEach((g,E)=>{E.sequenceNumber<=e&&null===i.get(E.targetId)&&(this.Rs.delete(g),a.push(this.removeMatchingKeysForTargetId(t,E.targetId)),r++)}),jt.waitFor(a).next(()=>r)}getTargetCount(t){return jt.resolve(this.targetCount)}getTargetData(t,e){const i=this.Rs.get(e)||null;return jt.resolve(i)}addMatchingKeys(t,e,i){return this.Ps.us(e,i),jt.resolve()}removeMatchingKeys(t,e,i){this.Ps.hs(e,i);const r=this.persistence.referenceDelegate,a=[];return r&&e.forEach(g=>{a.push(r.markPotentiallyOrphaned(t,g))}),jt.waitFor(a)}removeMatchingKeysForTargetId(t,e){return this.Ps.ls(e),jt.resolve()}getMatchingKeysForTargetId(t,e){const i=this.Ps.ds(e);return jt.resolve(i)}containsKey(t,e){return jt.resolve(this.Ps.containsKey(e))}}class eV{constructor(t,e){this.Vs={},this.overlays={},this.Ss=new yp(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new MW(this),this.indexManager=new mW,this.remoteDocumentCache=new DW(i=>this.referenceDelegate.xs(i)),this.yt=new DB(e),this.Ns=new TW(this.yt)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new SW,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let i=this.Vs[t.toKey()];return i||(i=new IW(e,this.referenceDelegate),this.Vs[t.toKey()]=i),i}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(t,e,i){kn("MemoryPersistence","Starting transaction:",t);const r=new kW(this.Ss.next());return this.referenceDelegate.ks(),i(r).next(a=>this.referenceDelegate.Os(r).next(()=>a)).toPromise().then(a=>(r.raiseOnCommittedEvent(),a))}Ms(t,e){return jt.or(Object.values(this.Vs).map(i=>()=>i.containsKey(t,e)))}}class kW extends dz{constructor(t){super(),this.currentSequenceNumber=t}}class mM{constructor(t){this.persistence=t,this.Fs=new MP,this.$s=null}static Bs(t){return new mM(t)}get Ls(){if(this.$s)return this.$s;throw fi()}addReference(t,e,i){return this.Fs.addReference(i,e),this.Ls.delete(i.toString()),jt.resolve()}removeReference(t,e,i){return this.Fs.removeReference(i,e),this.Ls.add(i.toString()),jt.resolve()}markPotentiallyOrphaned(t,e){return this.Ls.add(e.toString()),jt.resolve()}removeTarget(t,e){this.Fs.ls(e.targetId).forEach(r=>this.Ls.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,e.targetId).next(r=>{r.forEach(a=>this.Ls.add(a.toString()))}).next(()=>i.removeTargetData(t,e))}ks(){this.$s=new Set}Os(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return jt.forEach(this.Ls,i=>{const r=Ut.fromPath(i);return this.qs(t,r).next(a=>{a||e.removeEntry(r,Ae.min())})}).next(()=>(this.$s=null,e.apply(t)))}updateLimboDocument(t,e){return this.qs(t,e).next(i=>{i?this.Ls.delete(e.toString()):this.Ls.add(e.toString())})}xs(t){return 0}qs(t,e){return jt.or([()=>jt.resolve(this.Fs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ms(t,e)])}}class RW{constructor(t){this.yt=t}$(t,e,i,r){const a=new ZA("createOrUpgrade",e);var E;i<1&&r>=1&&(t.createObjectStore("owner"),(E=t).createObjectStore("mutationQueues",{keyPath:"userId"}),E.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",CB,{unique:!0}),E.createObjectStore("documentMutations"),tV(t),function(E){E.createObjectStore("remoteDocuments")}(t));let g=jt.resolve();return i<3&&r>=3&&(0!==i&&(function(E){E.deleteObjectStore("targetDocuments"),E.deleteObjectStore("targets"),E.deleteObjectStore("targetGlobal")}(t),tV(t)),g=g.next(()=>function(E){const O=E.store("targetGlobal"),j={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ae.min().toTimestamp(),targetCount:0};return O.put("targetGlobalKey",j)}(a))),i<4&&r>=4&&(0!==i&&(g=g.next(()=>function(E,O){return O.store("mutations").W().next(j=>{E.deleteObjectStore("mutations"),E.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",CB,{unique:!0});const Y=O.store("mutations"),se=j.map(be=>Y.put(be));return jt.waitFor(se)})}(t,a))),g=g.next(()=>{!function(E){E.createObjectStore("clientMetadata",{keyPath:"clientId"})}(t)})),i<5&&r>=5&&(g=g.next(()=>this.Us(a))),i<6&&r>=6&&(g=g.next(()=>(function(E){E.createObjectStore("remoteDocumentGlobal")}(t),this.Ks(a)))),i<7&&r>=7&&(g=g.next(()=>this.Gs(a))),i<8&&r>=8&&(g=g.next(()=>this.Qs(t,a))),i<9&&r>=9&&(g=g.next(()=>{!function(E){E.objectStoreNames.contains("remoteDocumentChanges")&&E.deleteObjectStore("remoteDocumentChanges")}(t)})),i<10&&r>=10&&(g=g.next(()=>this.js(a))),i<11&&r>=11&&(g=g.next(()=>{(function(E){E.createObjectStore("bundles",{keyPath:"bundleId"})})(t),function(E){E.createObjectStore("namedQueries",{keyPath:"name"})}(t)})),i<12&&r>=12&&(g=g.next(()=>{!function(E){const O=E.createObjectStore("documentOverlays",{keyPath:nW});O.createIndex("collectionPathOverlayIndex",iW,{unique:!1}),O.createIndex("collectionGroupOverlayIndex",rW,{unique:!1})}(t)})),i<13&&r>=13&&(g=g.next(()=>function(E){const O=E.createObjectStore("remoteDocumentsV14",{keyPath:$8});O.createIndex("documentKeyIndex",W8),O.createIndex("collectionGroupIndex",Z8)}(t)).next(()=>this.Ws(t,a)).next(()=>t.deleteObjectStore("remoteDocuments"))),i<14&&r>=14&&(g=g.next(()=>this.zs(t,a))),i<15&&r>=15&&(g=g.next(()=>function(E){E.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),E.createObjectStore("indexState",{keyPath:Q8}).createIndex("sequenceNumberIndex",X8,{unique:!1}),E.createObjectStore("indexEntries",{keyPath:eW}).createIndex("documentKeyIndex",tW,{unique:!1})}(t))),g}Ks(t){let e=0;return t.store("remoteDocuments").Z((i,r)=>{e+=dM(r)}).next(()=>{const i={byteSize:e};return t.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)})}Us(t){const e=t.store("mutationQueues"),i=t.store("mutations");return e.W().next(r=>jt.forEach(r,a=>{const g=IDBKeyRange.bound([a.userId,-1],[a.userId,a.lastAcknowledgedBatchId]);return i.W("userMutationsIndex",g).next(E=>jt.forEach(E,O=>{Ii(O.userId===a.userId);const j=Wb(this.yt,O);return jB(t,a.userId,j).next(()=>{})}))}))}Gs(t){const e=t.store("targetDocuments"),i=t.store("remoteDocuments");return t.store("targetGlobal").get("targetGlobalKey").next(r=>{const a=[];return i.Z((g,E)=>{const O=new mt(g),j=[0,Gh(O)];a.push(e.get(j).next(Y=>Y?jt.resolve():e.put({targetId:0,path:Gh(O),sequenceNumber:r.highestListenSequenceNumber})))}).next(()=>jt.waitFor(a))})}Qs(t,e){t.createObjectStore("collectionParents",{keyPath:J8});const i=e.store("collectionParents"),r=new AP,a=g=>{if(r.add(g)){const E=g.lastSegment(),O=g.popLast();return i.put({collectionId:E,parent:Gh(O)})}};return e.store("remoteDocuments").Z({X:!0},(g,E)=>{const O=new mt(g);return a(O.popLast())}).next(()=>e.store("documentMutations").Z({X:!0},([g,E,O],j)=>{const Y=kg(E);return a(Y.popLast())}))}js(t){const e=t.store("targets");return e.Z((i,r)=>{const a=lS(r),g=MB(this.yt,a);return e.put(g)})}Ws(t,e){const i=e.store("remoteDocuments"),r=[];return i.Z((a,g)=>{const E=e.store("remoteDocumentsV14"),O=(j=g,j.document?new Ut(mt.fromString(j.document.name).popFirst(5)):j.noDocument?Ut.fromSegments(j.noDocument.path):j.unknownDocument?Ut.fromSegments(j.unknownDocument.path):fi()).path.toArray();var j;const Y={prefixPath:O.slice(0,O.length-2),collectionGroup:O[O.length-2],documentId:O[O.length-1],readTime:g.readTime||[0,0],unknownDocument:g.unknownDocument,noDocument:g.noDocument,document:g.document,hasCommittedMutations:!!g.hasCommittedMutations};r.push(E.put(Y))}).next(()=>jt.waitFor(r))}zs(t,e){const i=e.store("mutations"),r=KB(this.yt),a=new eV(mM.Bs,this.yt.ie);return i.W().next(g=>{const E=new Map;return g.forEach(O=>{var j;let Y=null!==(j=E.get(O.userId))&&void 0!==j?j:Ir();Wb(this.yt,O).keys().forEach(se=>Y=Y.add(se)),E.set(O.userId,Y)}),jt.forEach(E,(O,j)=>{const Y=new Ha(j),se=lM.re(this.yt,Y),be=a.getIndexManager(Y),Me=pM.re(Y,this.yt,be,a.referenceDelegate);return new XB(r,Me,se,be).recalculateAndSaveOverlaysForDocumentKeys(new vP(e,yp.at),O).next()})})}}function tV(n){n.createObjectStore("targetDocuments",{keyPath:K8}).createIndex("documentTargetsIndex",Y8,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",q8,{unique:!0}),n.createObjectStore("targetGlobal")}const kP="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class RP{constructor(t,e,i,r,a,g,E,O,j,Y,se=15){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=i,this.Hs=a,this.window=g,this.document=E,this.Js=j,this.Ys=Y,this.Xs=se,this.Ss=null,this.Ds=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.ti=null,this.ei=null,this.ni=Number.NEGATIVE_INFINITY,this.si=be=>Promise.resolve(),!RP.C())throw new Cn(Wt.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new wW(this,r),this.ii=e+"main",this.yt=new DB(O),this.ri=new dm(this.ii,this.Xs,new RW(this.yt)),this.Cs=new _W(this.referenceDelegate,this.yt),this.remoteDocumentCache=KB(this.yt),this.Ns=new lW,this.window&&this.window.localStorage?this.oi=this.window.localStorage:(this.oi=null,!1===Y&&Aa("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ui().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Cn(Wt.FAILED_PRECONDITION,kP);return this.ci(),this.ai(),this.hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",t=>this.Cs.getHighestSequenceNumber(t))}).then(t=>{this.Ss=new yp(t,this.Js)}).then(()=>{this.Ds=!0}).catch(t=>(this.ri&&this.ri.close(),Promise.reject(t)))}li(t){var e=this;return this.si=function(){var i=(0,ve.Z)(function*(r){if(e.started)return t(r)});return function(r){return i.apply(this,arguments)}}(),t(this.isPrimary)}setDatabaseDeletedListener(t){this.ri.L(function(){var e=(0,ve.Z)(function*(i){null===i.newVersion&&(yield t())});return function(i){return e.apply(this,arguments)}}())}setNetworkEnabled(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Hs.enqueueAndForget((0,ve.Z)(function*(){e.started&&(yield e.ui())})))}ui(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",t=>gM(t).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(t).next(e=>{e||(this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)))})}).next(()=>this.di(t)).next(e=>this.isPrimary&&!e?this._i(t).next(()=>!1):!!e&&this.wi(t).next(()=>!0))).catch(t=>{if(Iv(t))return kn("IndexedDbPersistence","Failed to extend owner lease: ",t),this.isPrimary;if(!this.allowTabSynchronization)throw t;return kn("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(t=>{this.isPrimary!==t&&this.Hs.enqueueRetryable(()=>this.si(t)),this.isPrimary=t})}fi(t){return fS(t).get("owner").next(e=>jt.resolve(this.mi(e)))}gi(t){return gM(t).delete(this.clientId)}yi(){var t=this;return(0,ve.Z)(function*(){if(t.isPrimary&&!t.pi(t.ni,18e5)){t.ni=Date.now();const e=yield t.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",i=>{const r=Yc(i,"clientMetadata");return r.W().next(a=>{const g=t.Ii(a,18e5),E=a.filter(O=>-1===g.indexOf(O));return jt.forEach(E,O=>r.delete(O.clientId)).next(()=>E)})}).catch(()=>[]);if(t.oi)for(const i of e)t.oi.removeItem(t.Ti(i.clientId))}})()}hi(){this.ei=this.Hs.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ui().then(()=>this.yi()).then(()=>this.hi()))}mi(t){return!!t&&t.ownerId===this.clientId}di(t){return this.Ys?jt.resolve(!0):fS(t).get("owner").next(e=>{if(null!==e&&this.pi(e.leaseTimestampMs,5e3)&&!this.Ei(e.ownerId)){if(this.mi(e)&&this.networkEnabled)return!0;if(!this.mi(e)){if(!e.allowTabSynchronization)throw new Cn(Wt.FAILED_PRECONDITION,kP);return!1}}return!(!this.networkEnabled||!this.inForeground)||gM(t).W().next(i=>void 0===this.Ii(i,5e3).find(r=>!(this.clientId===r.clientId||!(!this.networkEnabled&&r.networkEnabled||!this.inForeground&&r.inForeground&&this.networkEnabled===r.networkEnabled))))}).next(e=>(this.isPrimary!==e&&kn("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}shutdown(){var t=this;return(0,ve.Z)(function*(){t.Ds=!1,t.Ai(),t.ei&&(t.ei.cancel(),t.ei=null),t.Ri(),t.bi(),yield t.ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const i=new vP(e,yp.at);return t._i(i).next(()=>t.gi(i))}),t.ri.close(),t.Pi()})()}Ii(t,e){return t.filter(i=>this.pi(i.updateTimeMs,e)&&!this.Ei(i.clientId))}vi(){return this.runTransaction("getActiveClients","readonly",t=>gM(t).W().next(e=>this.Ii(e,18e5).map(i=>i.clientId)))}get started(){return this.Ds}getMutationQueue(t,e){return pM.re(t,this.yt,e,this.referenceDelegate)}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(t){return new gW(t,this.yt.ie.databaseId)}getDocumentOverlayCache(t){return lM.re(this.yt,t)}getBundleCache(){return this.Ns}runTransaction(t,e,i){kn("IndexedDbPersistence","Starting transaction:",t);const r="readonly"===e?"readonly":"readwrite",a=15===(g=this.Xs)?sW:14===g?IB:13===g?SB:12===g?oW:11===g?TB:void fi();var g;let E;return this.ri.runTransaction(t,r,a,O=>(E=new vP(O,this.Ss?this.Ss.next():yp.at),"readwrite-primary"===e?this.fi(E).next(j=>!!j||this.di(E)).next(j=>{if(!j)throw Aa(`Failed to obtain primary lease for action '${t}'.`),this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)),new Cn(Wt.FAILED_PRECONDITION,hz);return i(E)}).next(j=>this.wi(E).next(()=>j)):this.Vi(E).next(()=>i(E)))).then(O=>(E.raiseOnCommittedEvent(),O))}Vi(t){return fS(t).get("owner").next(e=>{if(null!==e&&this.pi(e.leaseTimestampMs,5e3)&&!this.Ei(e.ownerId)&&!this.mi(e)&&!(this.Ys||this.allowTabSynchronization&&e.allowTabSynchronization))throw new Cn(Wt.FAILED_PRECONDITION,kP)})}wi(t){const e={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return fS(t).put("owner",e)}static C(){return dm.C()}_i(t){const e=fS(t);return e.get("owner").next(i=>this.mi(i)?(kn("IndexedDbPersistence","Releasing primary lease."),e.delete("owner")):jt.resolve())}pi(t,e){const i=Date.now();return!(t<i-e||t>i&&(Aa(`Detected an update time that is in the future: ${t} > ${i}`),1))}ci(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ti=()=>{this.Hs.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ui()))},this.document.addEventListener("visibilitychange",this.ti),this.inForeground="visible"===this.document.visibilityState)}Ri(){this.ti&&(this.document.removeEventListener("visibilitychange",this.ti),this.ti=null)}ai(){var t;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Zs=()=>{this.Ai(),(0,Be.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Hs.enterRestrictedMode(!0),this.Hs.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Zs))}bi(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}Ei(t){var e;try{const i=null!==(null===(e=this.oi)||void 0===e?void 0:e.getItem(this.Ti(t)));return kn("IndexedDbPersistence",`Client '${t}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return Aa("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}Ai(){if(this.oi)try{this.oi.setItem(this.Ti(this.clientId),String(Date.now()))}catch(t){Aa("Failed to set zombie client id.",t)}}Pi(){if(this.oi)try{this.oi.removeItem(this.Ti(this.clientId))}catch{}}Ti(t){return`firestore_zombie_${this.persistenceKey}_${t}`}}function fS(n){return Yc(n,"owner")}function gM(n){return Yc(n,"clientMetadata")}function PP(n,t){let e=n.projectId;return n.isDefaultDatabase||(e+="."+n.database),"firestore/"+t+"/"+e+"/"}class OP{constructor(t,e,i,r){this.targetId=t,this.fromCache=e,this.Si=i,this.Di=r}static Ci(t,e){let i=Ir(),r=Ir();for(const a of e.docChanges)switch(a.type){case 0:i=i.add(a.doc.key);break;case 1:r=r.add(a.doc.key)}return new OP(t,e.fromCache,i,r)}}class nV{constructor(){this.xi=!1}initialize(t,e){this.Ni=t,this.indexManager=e,this.xi=!0}getDocumentsMatchingQuery(t,e,i,r){return this.ki(t,e).next(a=>a||this.Oi(t,e,r,i)).next(a=>a||this.Mi(t,e))}ki(t,e){if(zz(e))return jt.resolve(null);let i=jh(e);return this.indexManager.getIndexType(t,i).next(r=>0===r?null:(null!==e.limit&&1===r&&(e=eM(e,null,"F"),i=jh(e)),this.indexManager.getDocumentsMatchingTarget(t,i).next(a=>{const g=Ir(...a);return this.Ni.getDocuments(t,g).next(E=>this.indexManager.getMinOffset(t,i).next(O=>{const j=this.Fi(e,E);return this.$i(e,j,g,O.readTime)?this.ki(t,eM(e,null,"F")):this.Bi(t,j,e,O)}))})))}Oi(t,e,i,r){return zz(e)||r.isEqual(Ae.min())?this.Mi(t,e):this.Ni.getDocuments(t,i).next(a=>{const g=this.Fi(e,a);return this.$i(e,g,i,r)?this.Mi(t,e):($A()<=$e.in.DEBUG&&kn("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),pP(e)),this.Bi(t,g,e,cz(r,-1)))})}Fi(t,e){let i=new Is(Uz(t));return e.forEach((r,a)=>{QT(t,a)&&(i=i.add(a))}),i}$i(t,e,i,r){if(null===t.limit)return!1;if(i.size!==e.size)return!0;const a="F"===t.limitType?e.last():e.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(r)>0)}Mi(t,e){return $A()<=$e.in.DEBUG&&kn("QueryEngine","Using full collection scan to execute query:",pP(e)),this.Ni.getDocumentsMatchingQuery(t,e,_p.min())}Bi(t,e,i,r){return this.Ni.getDocumentsMatchingQuery(t,i,r).next(a=>(e.forEach(g=>{a=a.insert(g.key,g)}),a))}}class PW{constructor(t,e,i,r){this.persistence=t,this.Li=e,this.yt=r,this.qi=new Ga(q),this.Ui=new Pv(a=>Vb(a),YT),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(i)}Qi(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new XB(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.qi))}}function iV(n,t,e,i){return new PW(n,t,e,i)}function rV(n,t){return LP.apply(this,arguments)}function LP(){return LP=(0,ve.Z)(function*(n,t){const e=Qn(n);return yield e.persistence.runTransaction("Handle user change","readonly",i=>{let r;return e.mutationQueue.getAllMutationBatches(i).next(a=>(r=a,e.Qi(t),e.mutationQueue.getAllMutationBatches(i))).next(a=>{const g=[],E=[];let O=Ir();for(const j of r){g.push(j.batchId);for(const Y of j.mutations)O=O.add(Y.key)}for(const j of a){E.push(j.batchId);for(const Y of j.mutations)O=O.add(Y.key)}return e.localDocuments.getDocuments(i,O).next(j=>({ji:j,removedBatchIds:g,addedBatchIds:E}))})})}),LP.apply(this,arguments)}function OW(n,t){const e=Qn(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=t.batch.keys(),a=e.Gi.newChangeBuffer({trackRemovals:!0});return function(g,E,O,j){const Y=O.batch,se=Y.keys();let be=jt.resolve();return se.forEach(Me=>{be=be.next(()=>j.getEntry(E,Me)).next(Ge=>{const _t=O.docVersions.get(Me);Ii(null!==_t),Ge.version.compareTo(_t)<0&&(Y.applyToRemoteDocument(Ge,O),Ge.isValidDocument()&&(Ge.setReadTime(O.commitVersion),j.addEntry(Ge)))})}),be.next(()=>g.mutationQueue.removeMutationBatch(E,Y))}(e,i,t,a).next(()=>a.apply(i)).next(()=>e.mutationQueue.performConsistencyCheck(i)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(i,r,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(g){let E=Ir();for(let O=0;O<g.mutationResults.length;++O)g.mutationResults[O].transformResults.length>0&&(E=E.add(g.batch.mutations[O].key));return E}(t))).next(()=>e.localDocuments.getDocuments(i,r))})}function oV(n){const t=Qn(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Cs.getLastRemoteSnapshotVersion(e))}function LW(n,t){const e=Qn(n),i=t.snapshotVersion;let r=e.qi;return e.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const g=e.Gi.newChangeBuffer({trackRemovals:!0});r=e.qi;const E=[];t.targetChanges.forEach((Y,se)=>{const be=r.get(se);if(!be)return;E.push(e.Cs.removeMatchingKeys(a,Y.removedDocuments,se).next(()=>e.Cs.addMatchingKeys(a,Y.addedDocuments,se)));let Me=be.withSequenceNumber(a.currentSequenceNumber);var Ge,_t,Dt;t.targetMismatches.has(se)?Me=Me.withResumeToken(bc.EMPTY_BYTE_STRING,Ae.min()).withLastLimboFreeSnapshotVersion(Ae.min()):Y.resumeToken.approximateByteSize()>0&&(Me=Me.withResumeToken(Y.resumeToken,i)),r=r.insert(se,Me),_t=Me,Dt=Y,(0===(Ge=be).resumeToken.approximateByteSize()||_t.snapshotVersion.toMicroseconds()-Ge.snapshotVersion.toMicroseconds()>=3e8||Dt.addedDocuments.size+Dt.modifiedDocuments.size+Dt.removedDocuments.size>0)&&E.push(e.Cs.updateTargetData(a,Me))});let O=zd(),j=Ir();if(t.documentUpdates.forEach(Y=>{t.resolvedLimboDocuments.has(Y)&&E.push(e.persistence.referenceDelegate.updateLimboDocument(a,Y))}),E.push(sV(a,g,t.documentUpdates).next(Y=>{O=Y.Wi,j=Y.zi})),!i.isEqual(Ae.min())){const Y=e.Cs.getLastRemoteSnapshotVersion(a).next(se=>e.Cs.setTargetsMetadata(a,a.currentSequenceNumber,i));E.push(Y)}return jt.waitFor(E).next(()=>g.apply(a)).next(()=>e.localDocuments.getLocalViewOfDocuments(a,O,j)).next(()=>O)}).then(a=>(e.qi=r,a))}function sV(n,t,e){let i=Ir(),r=Ir();return e.forEach(a=>i=i.add(a)),t.getEntries(n,i).next(a=>{let g=zd();return e.forEach((E,O)=>{const j=a.get(E);O.isFoundDocument()!==j.isFoundDocument()&&(r=r.add(E)),O.isNoDocument()&&O.version.isEqual(Ae.min())?(t.removeEntry(E,O.readTime),g=g.insert(E,O)):!j.isValidDocument()||O.version.compareTo(j.version)>0||0===O.version.compareTo(j.version)&&j.hasPendingWrites?(t.addEntry(O),g=g.insert(E,O)):kn("LocalStore","Ignoring outdated watch update for ",E,". Current version:",j.version," Watch version:",O.version)}),{Wi:g,zi:r}})}function FW(n,t){const e=Qn(n);return e.persistence.runTransaction("Get next mutation batch","readonly",i=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(i,t)))}function B1(n,t){const e=Qn(n);return e.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return e.Cs.getTargetData(i,t).next(a=>a?(r=a,jt.resolve(r)):e.Cs.allocateTargetId(i).next(g=>(r=new Ov(t,g,0,i.currentSequenceNumber),e.Cs.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=e.qi.get(i.targetId);return(null===r||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(e.qi=e.qi.insert(i.targetId,i),e.Ui.set(t,i.targetId)),i})}function V1(n,t,e){return FP.apply(this,arguments)}function FP(){return FP=(0,ve.Z)(function*(n,t,e){const i=Qn(n),r=i.qi.get(t),a=e?"readwrite":"readwrite-primary";try{e||(yield i.persistence.runTransaction("Release target",a,g=>i.persistence.referenceDelegate.removeTarget(g,r)))}catch(g){if(!Iv(g))throw g;kn("LocalStore",`Failed to update sequence numbers for target ${t}: ${g}`)}i.qi=i.qi.remove(t),i.Ui.delete(r.target)}),FP.apply(this,arguments)}function _M(n,t,e){const i=Qn(n);let r=Ae.min(),a=Ir();return i.persistence.runTransaction("Execute query","readonly",g=>function(E,O,j){const Y=Qn(E),se=Y.Ui.get(j);return void 0!==se?jt.resolve(Y.qi.get(se)):Y.Cs.getTargetData(O,j)}(i,g,jh(t)).next(E=>{if(E)return r=E.lastLimboFreeSnapshotVersion,i.Cs.getMatchingKeysForTargetId(g,E.targetId).next(O=>{a=O})}).next(()=>i.Li.getDocumentsMatchingQuery(g,t,e?r:Ae.min(),e?a:Ir())).next(E=>(cV(i,Vz(t),E),{documents:E,Hi:a})))}function aV(n,t){const e=Qn(n),i=Qn(e.Cs),r=e.qi.get(t);return r?Promise.resolve(r.target):e.persistence.runTransaction("Get target data","readonly",a=>i.ne(a,t).next(g=>g?g.target:null))}function lV(n,t){const e=Qn(n),i=e.Ki.get(t)||Ae.min();return e.persistence.runTransaction("Get new document changes","readonly",r=>e.Gi.getAllFromCollectionGroup(r,t,cz(i,-1),Number.MAX_SAFE_INTEGER)).then(r=>(cV(e,t,r),r))}function cV(n,t,e){let i=n.Ki.get(t)||Ae.min();e.forEach((r,a)=>{a.readTime.compareTo(i)>0&&(i=a.readTime)}),n.Ki.set(t,i)}function NP(){return NP=(0,ve.Z)(function*(n,t,e,i){const r=Qn(n);let a=Ir(),g=zd();for(const j of e){const Y=t.Ji(j.metadata.name);j.document&&(a=a.add(Y));const se=t.Yi(j);se.setReadTime(t.Xi(j.metadata.readTime)),g=g.insert(Y,se)}const E=r.Gi.newChangeBuffer({trackRemovals:!0}),O=yield B1(r,(j=i,jh(A1(mt.fromString(`__bundle__/docs/${j}`)))));var j;return r.persistence.runTransaction("Apply bundle documents","readwrite",j=>sV(j,E,g).next(Y=>(E.apply(j),Y)).next(Y=>r.Cs.removeMatchingKeysForTargetId(j,O.targetId).next(()=>r.Cs.addMatchingKeys(j,a,O.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(j,Y.Wi,Y.zi)).next(()=>Y.Wi)))}),NP.apply(this,arguments)}function zW(n,t){return zP.apply(this,arguments)}function zP(){return zP=(0,ve.Z)(function*(n,t,e=Ir()){const i=yield B1(n,jh(CP(t.bundledQuery))),r=Qn(n);return r.persistence.runTransaction("Save named query","readwrite",a=>{const g=ll(t.readTime);if(i.snapshotVersion.compareTo(g)>=0)return r.Ns.saveNamedQuery(a,t);const E=i.withResumeToken(bc.EMPTY_BYTE_STRING,g);return r.qi=r.qi.insert(E.targetId,E),r.Cs.updateTargetData(a,E).next(()=>r.Cs.removeMatchingKeysForTargetId(a,i.targetId)).next(()=>r.Cs.addMatchingKeys(a,e,i.targetId)).next(()=>r.Ns.saveNamedQuery(a,t))})}),zP.apply(this,arguments)}function uV(n,t){return`firestore_clients_${n}_${t}`}function hV(n,t,e){let i=`firestore_mutations_${n}_${e}`;return t.isAuthenticated()&&(i+=`_${t.uid}`),i}function BP(n,t){return`firestore_targets_${n}_${t}`}class yM{constructor(t,e,i,r){this.user=t,this.batchId=e,this.state=i,this.error=r}static Zi(t,e,i){const r=JSON.parse(i);let a,g="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return g&&r.error&&(g="string"==typeof r.error.message&&"string"==typeof r.error.code,g&&(a=new Cn(r.error.code,r.error.message))),g?new yM(t,e,r.state,a):(Aa("SharedClientState",`Failed to parse mutation state for ID '${e}': ${i}`),null)}tr(){const t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}}class mS{constructor(t,e,i){this.targetId=t,this.state=e,this.error=i}static Zi(t,e){const i=JSON.parse(e);let r,a="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return a&&i.error&&(a="string"==typeof i.error.message&&"string"==typeof i.error.code,a&&(r=new Cn(i.error.code,i.error.message))),a?new mS(t,i.state,r):(Aa("SharedClientState",`Failed to parse target state for ID '${t}': ${e}`),null)}tr(){const t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}}class vM{constructor(t,e){this.clientId=t,this.activeTargetIds=e}static Zi(t,e){const i=JSON.parse(e);let r="object"==typeof i&&i.activeTargetIds instanceof Array,a=rM();for(let g=0;r&&g<i.activeTargetIds.length;++g)r=gz(i.activeTargetIds[g]),a=a.add(i.activeTargetIds[g]);return r?new vM(t,a):(Aa("SharedClientState",`Failed to parse client data for instance '${t}': ${e}`),null)}}class VP{constructor(t,e){this.clientId=t,this.onlineState=e}static Zi(t){const e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new VP(e.clientId,e.onlineState):(Aa("SharedClientState",`Failed to parse online state: ${t}`),null)}}class UP{constructor(){this.activeTargetIds=rM()}er(t){this.activeTargetIds=this.activeTargetIds.add(t)}nr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}tr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class HP{constructor(t,e,i,r,a){this.window=t,this.Hs=e,this.persistenceKey=i,this.sr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ir=this.rr.bind(this),this.ur=new Ga(q),this.started=!1,this.cr=[];const g=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.ar=uV(this.persistenceKey,this.sr),this.hr=`firestore_sequence_number_${this.persistenceKey}`,this.ur=this.ur.insert(this.sr,new UP),this.lr=new RegExp(`^firestore_clients_${g}_([^_]*)$`),this.dr=new RegExp(`^firestore_mutations_${g}_(\\d+)(?:_(.*))?$`),this._r=new RegExp(`^firestore_targets_${g}_(\\d+)$`),this.wr=`firestore_online_state_${this.persistenceKey}`,this.mr=function(E){return`firestore_bundle_loaded_v2_${E}`}(this.persistenceKey),this.window.addEventListener("storage",this.ir)}static C(t){return!(!t||!t.localStorage)}start(){var t=this;return(0,ve.Z)(function*(){const e=yield t.syncEngine.vi();for(const r of e){if(r===t.sr)continue;const a=t.getItem(uV(t.persistenceKey,r));if(a){const g=vM.Zi(r,a);g&&(t.ur=t.ur.insert(g.clientId,g))}}t.gr();const i=t.storage.getItem(t.wr);if(i){const r=t.yr(i);r&&t.pr(r)}for(const r of t.cr)t.rr(r);t.cr=[],t.window.addEventListener("pagehide",()=>t.shutdown()),t.started=!0})()}writeSequenceNumber(t){this.setItem(this.hr,JSON.stringify(t))}getAllActiveQueryTargets(){return this.Ir(this.ur)}isActiveQueryTarget(t){let e=!1;return this.ur.forEach((i,r)=>{r.activeTargetIds.has(t)&&(e=!0)}),e}addPendingMutation(t){this.Tr(t,"pending")}updateMutationState(t,e,i){this.Tr(t,e,i),this.Er(t)}addLocalQueryTarget(t){let e="not-current";if(this.isActiveQueryTarget(t)){const i=this.storage.getItem(BP(this.persistenceKey,t));if(i){const r=mS.Zi(t,i);r&&(e=r.state)}}return this.Ar.er(t),this.gr(),e}removeLocalQueryTarget(t){this.Ar.nr(t),this.gr()}isLocalQueryTarget(t){return this.Ar.activeTargetIds.has(t)}clearQueryState(t){this.removeItem(BP(this.persistenceKey,t))}updateQueryState(t,e,i){this.Rr(t,e,i)}handleUserChange(t,e,i){e.forEach(r=>{this.Er(r)}),this.currentUser=t,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(t){this.br(t)}notifyBundleLoaded(t){this.Pr(t)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ir),this.removeItem(this.ar),this.started=!1)}getItem(t){const e=this.storage.getItem(t);return kn("SharedClientState","READ",t,e),e}setItem(t,e){kn("SharedClientState","SET",t,e),this.storage.setItem(t,e)}removeItem(t){kn("SharedClientState","REMOVE",t),this.storage.removeItem(t)}rr(t){var e=this;const i=t;if(i.storageArea===this.storage){if(kn("SharedClientState","EVENT",i.key,i.newValue),i.key===this.ar)return void Aa("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Hs.enqueueRetryable((0,ve.Z)(function*(){if(e.started){if(null!==i.key)if(e.lr.test(i.key)){if(null==i.newValue){const r=e.vr(i.key);return e.Vr(r,null)}{const r=e.Sr(i.key,i.newValue);if(r)return e.Vr(r.clientId,r)}}else if(e.dr.test(i.key)){if(null!==i.newValue){const r=e.Dr(i.key,i.newValue);if(r)return e.Cr(r)}}else if(e._r.test(i.key)){if(null!==i.newValue){const r=e.Nr(i.key,i.newValue);if(r)return e.kr(r)}}else if(i.key===e.wr){if(null!==i.newValue){const r=e.yr(i.newValue);if(r)return e.pr(r)}}else if(i.key===e.hr){const r=function(a){let g=yp.at;if(null!=a)try{const E=JSON.parse(a);Ii("number"==typeof E),g=E}catch(E){Aa("SharedClientState","Failed to read sequence number from WebStorage",E)}return g}(i.newValue);r!==yp.at&&e.sequenceNumberHandler(r)}else if(i.key===e.mr){const r=e.Or(i.newValue);yield Promise.all(r.map(a=>e.syncEngine.Mr(a)))}}else e.cr.push(i)}))}}get Ar(){return this.ur.get(this.sr)}gr(){this.setItem(this.ar,this.Ar.tr())}Tr(t,e,i){const r=new yM(this.currentUser,t,e,i),a=hV(this.persistenceKey,this.currentUser,t);this.setItem(a,r.tr())}Er(t){const e=hV(this.persistenceKey,this.currentUser,t);this.removeItem(e)}br(t){this.storage.setItem(this.wr,JSON.stringify({clientId:this.sr,onlineState:t}))}Rr(t,e,i){const r=BP(this.persistenceKey,t),a=new mS(t,e,i);this.setItem(r,a.tr())}Pr(t){const e=JSON.stringify(Array.from(t));this.setItem(this.mr,e)}vr(t){const e=this.lr.exec(t);return e?e[1]:null}Sr(t,e){const i=this.vr(t);return vM.Zi(i,e)}Dr(t,e){const i=this.dr.exec(t),r=Number(i[1]);return yM.Zi(new Ha(void 0!==i[2]?i[2]:null),r,e)}Nr(t,e){const i=this._r.exec(t),r=Number(i[1]);return mS.Zi(r,e)}yr(t){return VP.Zi(t)}Or(t){return JSON.parse(t)}Cr(t){var e=this;return(0,ve.Z)(function*(){if(t.user.uid===e.currentUser.uid)return e.syncEngine.Fr(t.batchId,t.state,t.error);kn("SharedClientState",`Ignoring mutation for non-active user ${t.user.uid}`)})()}kr(t){return this.syncEngine.$r(t.targetId,t.state,t.error)}Vr(t,e){const i=e?this.ur.insert(t,e):this.ur.remove(t),r=this.Ir(this.ur),a=this.Ir(i),g=[],E=[];return a.forEach(O=>{r.has(O)||g.push(O)}),r.forEach(O=>{a.has(O)||E.push(O)}),this.syncEngine.Br(g,E).then(()=>{this.ur=i})}pr(t){this.ur.get(t.clientId)&&this.onlineStateHandler(t.onlineState)}Ir(t){let e=rM();return t.forEach((i,r)=>{e=e.unionWith(r.activeTargetIds)}),e}}class dV{constructor(){this.Lr=new UP,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,i){}addLocalQueryTarget(t){return this.Lr.er(t),this.qr[t]||"not-current"}updateQueryState(t,e,i){this.qr[t]=e}removeLocalQueryTarget(t){this.Lr.nr(t)}isLocalQueryTarget(t){return this.Lr.activeTargetIds.has(t)}clearQueryState(t){delete this.qr[t]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(t){return this.Lr.activeTargetIds.has(t)}start(){return this.Lr=new UP,Promise.resolve()}handleUserChange(t,e,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class BW{Ur(t){}shutdown(){}}class pV{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}Ur(t){this.Wr.push(t)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){kn("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Wr)t(0)}jr(){kn("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Wr)t(1)}static C(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const VW={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class UW{constructor(t){this.Hr=t.Hr,this.Jr=t.Jr}Yr(t){this.Xr=t}Zr(t){this.eo=t}onMessage(t){this.no=t}close(){this.Jr()}send(t){this.Hr(t)}so(){this.Xr()}io(t){this.eo(t)}ro(t){this.no(t)}}class HW extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.oo=(t.ssl?"https":"http")+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(t,e,i,r,a){const g=this.ho(t,e);kn("RestConnection","Sending: ",g,i);const E={};return this.lo(E,r,a),this.fo(t,g,E,i).then(O=>(kn("RestConnection","Received: ",O),O),O=>{throw $_("RestConnection",`${t} failed with error: `,O,"url: ",g,"request:",i),O})}_o(t,e,i,r,a,g){return this.ao(t,e,i,r,a)}lo(t,e,i){t["X-Goog-Api-Client"]="gl-js/ fire/"+Tv,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((r,a)=>t[a]=r),i&&i.headers.forEach((r,a)=>t[a]=r)}ho(t,e){return`${this.oo}/v1/${e}:${VW[t]}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}fo(t,e,i,r){return new Promise((a,g)=>{const E=new iz;E.setWithCredentials(!0),E.listenOnce(HA.COMPLETE,()=>{try{switch(E.getLastErrorCode()){case C1.NO_ERROR:const j=E.getResponseJson();kn("Connection","XHR received:",JSON.stringify(j)),a(j);break;case C1.TIMEOUT:kn("Connection",'RPC "'+t+'" timed out'),g(new Cn(Wt.DEADLINE_EXCEEDED,"Request time out"));break;case C1.HTTP_ERROR:const Y=E.getStatus();if(kn("Connection",'RPC "'+t+'" failed with status:',Y,"response text:",E.getResponseText()),Y>0){let se=E.getResponseJson();Array.isArray(se)&&(se=se[0]);const be=se?.error;if(be&&be.status&&be.message){const Me=function(Ge){const _t=Ge.toLowerCase().replace(/_/g,"-");return Object.values(Wt).indexOf(_t)>=0?_t:Wt.UNKNOWN}(be.status);g(new Cn(Me,be.message))}else g(new Cn(Wt.UNKNOWN,"Server responded with status "+E.getStatus()))}else g(new Cn(Wt.UNAVAILABLE,"Connection failed."));break;default:fi()}}finally{kn("Connection",'RPC "'+t+'" completed.')}});const O=JSON.stringify(r);E.send(e,"POST",O,i,15)})}wo(t,e,i){const r=[this.oo,"/","google.firestore.v1.Firestore","/",t,"/channel"],a=JR(),g=UA(),E={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(E.xmlHttpFactory=new GA({})),this.lo(E.initMessageHeaders,e,i),E.encodeInitMessageHeaders=!0;const O=r.join("");kn("Connection","Creating WebChannel: "+O,E);const j=a.createWebChannel(O,E);let Y=!1,se=!1;const be=new UW({Hr:Ge=>{se?kn("Connection","Not sending because WebChannel is closed:",Ge):(Y||(kn("Connection","Opening WebChannel transport."),j.open(),Y=!0),kn("Connection","WebChannel sending:",Ge),j.send(Ge))},Jr:()=>j.close()}),Me=(Ge,_t,Dt)=>{Ge.listen(_t,_n=>{try{Dt(_n)}catch(Ln){setTimeout(()=>{throw Ln},0)}})};return Me(j,Ev.EventType.OPEN,()=>{se||kn("Connection","WebChannel transport opened.")}),Me(j,Ev.EventType.CLOSE,()=>{se||(se=!0,kn("Connection","WebChannel transport closed"),be.io())}),Me(j,Ev.EventType.ERROR,Ge=>{se||(se=!0,$_("Connection","WebChannel transport errored:",Ge),be.io(new Cn(Wt.UNAVAILABLE,"The operation could not be completed")))}),Me(j,Ev.EventType.MESSAGE,Ge=>{var _t;if(!se){const Dt=Ge.data[0];Ii(!!Dt);const Ln=Dt.error||(null===(_t=Dt[0])||void 0===_t?void 0:_t.error);if(Ln){kn("Connection","WebChannel received error:",Ln);const Bn=Ln.status;let Un=function(si){const _r=Nl[si];if(void 0!==_r)return nB(_r)}(Bn),ii=Ln.message;void 0===Un&&(Un=Wt.INTERNAL,ii="Unknown error status: "+Bn+" with message "+Ln.message),se=!0,be.io(new Cn(Un,ii)),j.close()}else kn("Connection","WebChannel received:",Dt),be.ro(Dt)}}),Me(g,QR.STAT_EVENT,Ge=>{Ge.stat===jA.PROXY?kn("Connection","Detected buffering proxy"):Ge.stat===jA.NOPROXY&&kn("Connection","Detected no buffering proxy")}),setTimeout(()=>{be.so()},0),be}}function fV(){return typeof window<"u"?window:null}function bM(){return typeof document<"u"?document:null}function gS(n){return new P8(n,!0)}class jP{constructor(t,e,i=1e3,r=1.5,a=6e4){this.Hs=t,this.timerId=e,this.mo=i,this.yo=r,this.po=a,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(t){this.cancel();const e=Math.floor(this.Io+this.bo()),i=Math.max(0,Date.now()-this.Eo),r=Math.max(0,e-i);r>0&&kn("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Io} ms, delay with jitter: ${e} ms, last attempt: ${i} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,r,()=>(this.Eo=Date.now(),t())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class mV{constructor(t,e,i,r,a,g,E,O){this.Hs=t,this.vo=i,this.Vo=r,this.connection=a,this.authCredentialsProvider=g,this.appCheckCredentialsProvider=E,this.listener=O,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new jP(t,e)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}stop(){var t=this;return(0,ve.Z)(function*(){t.No()&&(yield t.close(0))})()}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(t){this.Lo(),this.stream.send(t)}$o(){var t=this;return(0,ve.Z)(function*(){if(t.ko())return t.close(0)})()}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}qo(){this.Co&&(this.Co.cancel(),this.Co=null)}close(t,e){var i=this;return(0,ve.Z)(function*(){i.Lo(),i.qo(),i.xo.cancel(),i.So++,4!==t?i.xo.reset():e&&e.code===Wt.RESOURCE_EXHAUSTED?(Aa(e.toString()),Aa("Using maximum backoff delay to prevent overloading the backend."),i.xo.Ao()):e&&e.code===Wt.UNAUTHENTICATED&&3!==i.state&&(i.authCredentialsProvider.invalidateToken(),i.appCheckCredentialsProvider.invalidateToken()),null!==i.stream&&(i.Uo(),i.stream.close(),i.stream=null),i.state=t,yield i.listener.Zr(e)})()}Uo(){}auth(){this.state=1;const t=this.Ko(this.So),e=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.So===e&&this.Go(i,r)},i=>{t(()=>{const r=new Cn(Wt.UNKNOWN,"Fetching auth token failed: "+i.message);return this.Qo(r)})})}Go(t,e){const i=this.Ko(this.So);this.stream=this.jo(t,e),this.stream.Yr(()=>{i(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(r=>{i(()=>this.Qo(r))}),this.stream.onMessage(r=>{i(()=>this.onMessage(r))})}Oo(){var t=this;this.state=5,this.xo.Ro((0,ve.Z)(function*(){t.state=0,t.start()}))}Qo(t){return kn("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Ko(t){return e=>{this.Hs.enqueueAndForget(()=>this.So===t?e():(kn("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class jW extends mV{constructor(t,e,i,r,a,g){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,i,r,g),this.yt=a}jo(t,e){return this.connection.wo("Listen",t,e)}onMessage(t){this.xo.reset();const e=function F8(n,t){let e;if("targetChange"in t){const i="NO_CHANGE"===(O=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===O?1:"REMOVE"===O?2:"CURRENT"===O?3:"RESET"===O?4:fi(),r=t.targetChange.targetIds||[],a=function(O,j){return O.wt?(Ii(void 0===j||"string"==typeof j),bc.fromBase64String(j||"")):(Ii(void 0===j||j instanceof Uint8Array),bc.fromUint8Array(j||new Uint8Array))}(n,t.targetChange.resumeToken),g=t.targetChange.cause,E=g&&function(O){const j=void 0===O.code?Wt.UNKNOWN:nB(O.code);return new Cn(j,O.message||"")}(g);e=new aB(i,r,a,E||null)}else if("documentChange"in t){const i=t.documentChange,r=Mg(n,i.document.name),a=ll(i.document.updateTime),g=i.document.createTime?ll(i.document.createTime):Ae.min(),E=new Mu({mapValue:{fields:i.document.fields}}),O=da.newFoundDocument(r,a,g,E);e=new oM(i.targetIds||[],i.removedTargetIds||[],O.key,O)}else if("documentDelete"in t){const i=t.documentDelete,r=Mg(n,i.document),a=i.readTime?ll(i.readTime):Ae.min(),g=da.newNoDocument(r,a);e=new oM([],i.removedTargetIds||[],g.key,g)}else if("documentRemove"in t){const i=t.documentRemove,r=Mg(n,i.document);e=new oM([],i.removedTargetIds||[],r,null)}else{if(!("filter"in t))return fi();{const i=t.filter,a=new E8(i.count||0);e=new sB(i.targetId,a)}}var O;return e}(this.yt,t),i=function(r){if(!("targetChange"in r))return Ae.min();const a=r.targetChange;return a.targetIds&&a.targetIds.length?Ae.min():a.readTime?ll(a.readTime):Ae.min()}(t);return this.listener.Wo(e,i)}zo(t){const e={};e.database=sS(this.yt),e.addTarget=function(r,a){let g;const E=a.target;return g=JA(E)?{documents:_B(r,E)}:{query:yP(r,E)},g.targetId=a.targetId,a.resumeToken.approximateByteSize()>0?g.resumeToken=hB(r,a.resumeToken):a.snapshotVersion.compareTo(Ae.min())>0&&(g.readTime=O1(r,a.snapshotVersion.toTimestamp())),g}(this.yt,t);const i=function z8(n,t){const e=function(i,r){switch(r){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return fi()}}(0,t.purpose);return null==e?null:{"goog-listen-tags":e}}(0,t);i&&(e.labels=i),this.Bo(e)}Ho(t){const e={};e.database=sS(this.yt),e.removeTarget=t,this.Bo(e)}}class GW extends mV{constructor(t,e,i,r,a,g){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,i,r,g),this.yt=a,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}Uo(){this.Jo&&this.Xo([])}jo(t,e){return this.connection.wo("Write",t,e)}onMessage(t){if(Ii(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Jo){this.xo.reset();const e=function N8(n,t){return n&&n.length>0?(Ii(void 0!==t),n.map(e=>function(i,r){let a=ll(i.updateTime?i.updateTime:r);return a.isEqual(Ae.min())&&(a=ll(r)),new w8(a,i.transformResults||[])}(e,t))):[]}(t.writeResults,t.commitTime),i=ll(t.commitTime);return this.listener.Zo(i,e)}return Ii(!t.writeResults||0===t.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const t={};t.database=sS(this.yt),this.Bo(t)}Xo(t){const e={streamToken:this.lastStreamToken,writes:t.map(i=>aS(this.yt,i))};this.Bo(e)}}class $W extends class{}{constructor(t,e,i,r){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=i,this.yt=r,this.nu=!1}su(){if(this.nu)throw new Cn(Wt.FAILED_PRECONDITION,"The client has already been terminated.")}ao(t,e,i){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,a])=>this.connection.ao(t,e,i,r,a)).catch(r=>{throw"FirebaseError"===r.name?(r.code===Wt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new Cn(Wt.UNKNOWN,r.toString())})}_o(t,e,i,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,g])=>this.connection._o(t,e,i,a,g,r)).catch(a=>{throw"FirebaseError"===a.name?(a.code===Wt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Cn(Wt.UNKNOWN,a.toString())})}terminate(){this.nu=!0}}class ZW{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(t){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.cu("Offline")))}set(t){this.lu(),this.iu=0,"Online"===t&&(this.ou=!1),this.cu(t)}cu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}au(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(Aa(e),this.ou=!1):kn("OnlineStateTracker",e)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class qW{constructor(t,e,i,r,a){var g=this;this.localStore=t,this.datastore=e,this.asyncQueue=i,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=a,this.mu.Ur(E=>{i.enqueueAndForget((0,ve.Z)(function*(){var O;q_(g)&&(kn("RemoteStore","Restarting streams for network reachability change."),yield(O=(0,ve.Z)(function*(j){const Y=Qn(j);Y._u.add(4),yield U1(Y),Y.gu.set("Unknown"),Y._u.delete(4),yield _S(Y)}),function(j){return O.apply(this,arguments)})(g))}))}),this.gu=new ZW(i,r)}}function _S(n){return $P.apply(this,arguments)}function $P(){return $P=(0,ve.Z)(function*(n){if(q_(n))for(const t of n.wu)yield t(!0)}),$P.apply(this,arguments)}function U1(n){return WP.apply(this,arguments)}function WP(){return WP=(0,ve.Z)(function*(n){for(const t of n.wu)yield t(!1)}),WP.apply(this,arguments)}function wM(n,t){const e=Qn(n);e.du.has(t.targetId)||(e.du.set(t.targetId,t),KP(e)?qP(e):j1(e).ko()&&ZP(e,t))}function yS(n,t){const e=Qn(n),i=j1(e);e.du.delete(t),i.ko()&&gV(e,t),0===e.du.size&&(i.ko()?i.Fo():q_(e)&&e.gu.set("Unknown"))}function ZP(n,t){n.yu.Ot(t.targetId),j1(n).zo(t)}function gV(n,t){n.yu.Ot(t),j1(n).Ho(t)}function qP(n){n.yu=new A8({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),ne:t=>n.du.get(t)||null}),j1(n).start(),n.gu.uu()}function KP(n){return q_(n)&&!j1(n).No()&&n.du.size>0}function q_(n){return 0===Qn(n)._u.size}function _V(n){n.yu=void 0}function KW(n){return YP.apply(this,arguments)}function YP(){return YP=(0,ve.Z)(function*(n){n.du.forEach((t,e)=>{ZP(n,t)})}),YP.apply(this,arguments)}function YW(n,t){return JP.apply(this,arguments)}function JP(){return JP=(0,ve.Z)(function*(n,t){_V(n),KP(n)?(n.gu.hu(t),qP(n)):n.gu.set("Unknown")}),JP.apply(this,arguments)}function JW(n,t,e){return QP.apply(this,arguments)}function QP(){return QP=(0,ve.Z)(function*(n,t,e){if(n.gu.set("Online"),t instanceof aB&&2===t.state&&t.cause)try{yield(i=(0,ve.Z)(function*(r,a){const g=a.cause;for(const E of a.targetIds)r.du.has(E)&&(yield r.remoteSyncer.rejectListen(E,g),r.du.delete(E),r.yu.removeTarget(E))}),function(r,a){return i.apply(this,arguments)})(n,t)}catch(i){kn("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),i),yield xM(n,i)}else if(t instanceof oM?n.yu.Kt(t):t instanceof sB?n.yu.Jt(t):n.yu.jt(t),!e.isEqual(Ae.min()))try{const i=yield oV(n.localStore);e.compareTo(i)>=0&&(yield function(r,a){const g=r.yu.Zt(a);return g.targetChanges.forEach((E,O)=>{if(E.resumeToken.approximateByteSize()>0){const j=r.du.get(O);j&&r.du.set(O,j.withResumeToken(E.resumeToken,a))}}),g.targetMismatches.forEach(E=>{const O=r.du.get(E);if(!O)return;r.du.set(E,O.withResumeToken(bc.EMPTY_BYTE_STRING,O.snapshotVersion)),gV(r,E);const j=new Ov(O.target,E,1,O.sequenceNumber);ZP(r,j)}),r.remoteSyncer.applyRemoteEvent(g)}(n,e))}catch(i){kn("RemoteStore","Failed to raise snapshot:",i),yield xM(n,i)}var i}),QP.apply(this,arguments)}function xM(n,t,e){return XP.apply(this,arguments)}function XP(){return XP=(0,ve.Z)(function*(n,t,e){if(!Iv(t))throw t;n._u.add(1),yield U1(n),n.gu.set("Offline"),e||(e=()=>oV(n.localStore)),n.asyncQueue.enqueueRetryable((0,ve.Z)(function*(){kn("RemoteStore","Retrying IndexedDB access"),yield e(),n._u.delete(1),yield _S(n)}))}),XP.apply(this,arguments)}function yV(n,t){return t().catch(e=>xM(n,e,t))}function H1(n){return eO.apply(this,arguments)}function eO(){return eO=(0,ve.Z)(function*(n){const t=Qn(n),e=zv(t);let i=t.fu.length>0?t.fu[t.fu.length-1].batchId:-1;for(;QW(t);)try{const r=yield FW(t.localStore,i);if(null===r){0===t.fu.length&&e.Fo();break}i=r.batchId,XW(t,r)}catch(r){yield xM(t,r)}vV(t)&&bV(t)}),eO.apply(this,arguments)}function QW(n){return q_(n)&&n.fu.length<10}function XW(n,t){n.fu.push(t);const e=zv(n);e.ko()&&e.Yo&&e.Xo(t.mutations)}function vV(n){return q_(n)&&!zv(n).No()&&n.fu.length>0}function bV(n){zv(n).start()}function eZ(n){return tO.apply(this,arguments)}function tO(){return tO=(0,ve.Z)(function*(n){zv(n).eu()}),tO.apply(this,arguments)}function tZ(n){return nO.apply(this,arguments)}function nO(){return nO=(0,ve.Z)(function*(n){const t=zv(n);for(const e of n.fu)t.Xo(e.mutations)}),nO.apply(this,arguments)}function nZ(n,t,e){return iO.apply(this,arguments)}function iO(){return iO=(0,ve.Z)(function*(n,t,e){const i=n.fu.shift(),r=wP.from(i,t,e);yield yV(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield H1(n)}),iO.apply(this,arguments)}function iZ(n,t){return rO.apply(this,arguments)}function rO(){return rO=(0,ve.Z)(function*(n,t){var e;t&&zv(n).Yo&&(yield(e=(0,ve.Z)(function*(i,r){if(tB(a=r.code)&&a!==Wt.ABORTED){const g=i.fu.shift();zv(i).Mo(),yield yV(i,()=>i.remoteSyncer.rejectFailedWrite(g.batchId,r)),yield H1(i)}var a}),function(i,r){return e.apply(this,arguments)})(n,t)),vV(n)&&bV(n)}),rO.apply(this,arguments)}function wV(n,t){return oO.apply(this,arguments)}function oO(){return oO=(0,ve.Z)(function*(n,t){const e=Qn(n);e.asyncQueue.verifyOperationInProgress(),kn("RemoteStore","RemoteStore received new credentials");const i=q_(e);e._u.add(3),yield U1(e),i&&e.gu.set("Unknown"),yield e.remoteSyncer.handleCredentialChange(t),e._u.delete(3),yield _S(e)}),oO.apply(this,arguments)}function sO(n,t){return aO.apply(this,arguments)}function aO(){return aO=(0,ve.Z)(function*(n,t){const e=Qn(n);t?(e._u.delete(2),yield _S(e)):t||(e._u.add(2),yield U1(e),e.gu.set("Unknown"))}),aO.apply(this,arguments)}function j1(n){return n.pu||(n.pu=function(t,e,i){const r=Qn(t);return r.su(),new jW(e,r.connection,r.authCredentials,r.appCheckCredentials,r.yt,i)}(n.datastore,n.asyncQueue,{Yr:KW.bind(null,n),Zr:YW.bind(null,n),Wo:JW.bind(null,n)}),n.wu.push(function(){var t=(0,ve.Z)(function*(e){e?(n.pu.Mo(),KP(n)?qP(n):n.gu.set("Unknown")):(yield n.pu.stop(),_V(n))});return function(e){return t.apply(this,arguments)}}())),n.pu}function zv(n){return n.Iu||(n.Iu=function(t,e,i){const r=Qn(t);return r.su(),new GW(e,r.connection,r.authCredentials,r.appCheckCredentials,r.yt,i)}(n.datastore,n.asyncQueue,{Yr:eZ.bind(null,n),Zr:iZ.bind(null,n),tu:tZ.bind(null,n),Zo:nZ.bind(null,n)}),n.wu.push(function(){var t=(0,ve.Z)(function*(e){e?(n.Iu.Mo(),yield H1(n)):(yield n.Iu.stop(),n.fu.length>0&&(kn("RemoteStore",`Stopping write stream with ${n.fu.length} pending writes`),n.fu=[]))});return function(e){return t.apply(this,arguments)}}())),n.Iu}class lO{constructor(t,e,i,r,a){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=i,this.op=r,this.removalCallback=a,this.deferred=new Fl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(g=>{})}static createAndSchedule(t,e,i,r,a){const g=Date.now()+i,E=new lO(t,e,g,r,a);return E.start(i),E}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Cn(Wt.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function G1(n,t){if(Aa("AsyncQueue",`${t}: ${n}`),Iv(n))return new Cn(Wt.UNAVAILABLE,`${t}: ${n}`);throw n}class $1{constructor(t){this.comparator=t?(e,i)=>t(e,i)||Ut.comparator(e.key,i.key):(e,i)=>Ut.comparator(e.key,i.key),this.keyedMap=tS(),this.sortedSet=new Ga(this.comparator)}static emptySet(t){return new $1(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,i)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof $1)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;e.hasNext();){const r=e.getNext().key,a=i.getNext().key;if(!r.isEqual(a))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const i=new $1;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=e,i}}class xV{constructor(){this.Tu=new Ga(Ut.comparator)}track(t){const e=t.doc.key,i=this.Tu.get(e);i?0!==t.type&&3===i.type?this.Tu=this.Tu.insert(e,t):3===t.type&&1!==i.type?this.Tu=this.Tu.insert(e,{type:i.type,doc:t.doc}):2===t.type&&2===i.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===i.type?this.Tu=this.Tu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===i.type?this.Tu=this.Tu.remove(e):1===t.type&&2===i.type?this.Tu=this.Tu.insert(e,{type:1,doc:i.doc}):0===t.type&&1===i.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):fi():this.Tu=this.Tu.insert(e,t)}Eu(){const t=[];return this.Tu.inorderTraversal((e,i)=>{t.push(i)}),t}}class W1{constructor(t,e,i,r,a,g,E,O,j){this.query=t,this.docs=e,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=a,this.fromCache=g,this.syncStateChanged=E,this.excludesMetadataChanges=O,this.hasCachedResults=j}static fromInitialDocuments(t,e,i,r,a){const g=[];return e.forEach(E=>{g.push({type:0,doc:E})}),new W1(t,e,$1.emptySet(e),g,i,r,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&JT(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,i=t.docChanges;if(e.length!==i.length)return!1;for(let r=0;r<e.length;r++)if(e[r].type!==i[r].type||!e[r].doc.isEqual(i[r].doc))return!1;return!0}}class rZ{constructor(){this.Au=void 0,this.listeners=[]}}class oZ{constructor(){this.queries=new Pv(t=>Bz(t),JT),this.onlineState="Unknown",this.Ru=new Set}}function cO(n,t){return uO.apply(this,arguments)}function uO(){return uO=(0,ve.Z)(function*(n,t){const e=Qn(n),i=t.query;let r=!1,a=e.queries.get(i);if(a||(r=!0,a=new rZ),r)try{a.Au=yield e.onListen(i)}catch(g){const E=G1(g,`Initialization of query '${pP(t.query)}' failed`);return void t.onError(E)}e.queries.set(i,a),a.listeners.push(t),t.bu(e.onlineState),a.Au&&t.Pu(a.Au)&&pO(e)}),uO.apply(this,arguments)}function hO(n,t){return dO.apply(this,arguments)}function dO(){return dO=(0,ve.Z)(function*(n,t){const e=Qn(n),i=t.query;let r=!1;const a=e.queries.get(i);if(a){const g=a.listeners.indexOf(t);g>=0&&(a.listeners.splice(g,1),r=0===a.listeners.length)}if(r)return e.queries.delete(i),e.onUnlisten(i)}),dO.apply(this,arguments)}function sZ(n,t){const e=Qn(n);let i=!1;for(const r of t){const g=e.queries.get(r.query);if(g){for(const E of g.listeners)E.Pu(r)&&(i=!0);g.Au=r}}i&&pO(e)}function aZ(n,t,e){const i=Qn(n),r=i.queries.get(t);if(r)for(const a of r.listeners)a.onError(e);i.queries.delete(t)}function pO(n){n.Ru.forEach(t=>{t.next()})}class fO{constructor(t,e,i){this.query=t,this.vu=e,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=i||{}}Pu(t){if(!this.options.includeMetadataChanges){const i=[];for(const r of t.docChanges)3!==r.type&&i.push(r);t=new W1(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Vu?this.Du(t)&&(this.vu.next(t),e=!0):this.Cu(t,this.onlineState)&&(this.xu(t),e=!0),this.Su=t,e}onError(t){this.vu.error(t)}bu(t){this.onlineState=t;let e=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,t)&&(this.xu(this.Su),e=!0),e}Cu(t,e){return!t.fromCache||(!this.options.Nu||!("Offline"!==e))&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Du(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Su&&this.Su.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges}xu(t){t=W1.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Vu=!0,this.vu.next(t)}}class lZ{constructor(t,e){this.ku=t,this.byteLength=e}Ou(){return"metadata"in this.ku}}class CV{constructor(t){this.yt=t}Ji(t){return Mg(this.yt,t)}Yi(t){return t.metadata.exists?gB(this.yt,t.document,!1):da.newNoDocument(this.Ji(t.metadata.name),this.Xi(t.metadata.readTime))}Xi(t){return ll(t)}}class cZ{constructor(t,e,i){this.Mu=t,this.localStore=e,this.yt=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=EV(t)}Fu(t){this.progress.bytesLoaded+=t.byteLength;let e=this.progress.documentsLoaded;if(t.ku.namedQuery)this.queries.push(t.ku.namedQuery);else if(t.ku.documentMetadata){this.documents.push({metadata:t.ku.documentMetadata}),t.ku.documentMetadata.exists||++e;const i=mt.fromString(t.ku.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else t.ku.document&&(this.documents[this.documents.length-1].document=t.ku.document,++e);return e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null}$u(t){const e=new Map,i=new CV(this.yt);for(const r of t)if(r.metadata.queries){const a=i.Ji(r.metadata.name);for(const g of r.metadata.queries){const E=(e.get(g)||Ir()).add(a);e.set(g,E)}}return e}complete(){var t=this;return(0,ve.Z)(function*(){const e=yield function NW(n,t,e,i){return NP.apply(this,arguments)}(t.localStore,new CV(t.yt),t.documents,t.Mu.id),i=t.$u(t.documents);for(const r of t.queries)yield zW(t.localStore,r,i.get(r.name));return t.progress.taskState="Success",{progress:t.progress,Bu:t.collectionGroups,Lu:e}})()}}function EV(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class TV{constructor(t){this.key=t}}class SV{constructor(t){this.key=t}}class IV{constructor(t,e){this.query=t,this.qu=e,this.Uu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=Ir(),this.mutatedKeys=Ir(),this.Gu=Uz(t),this.Qu=new $1(this.Gu)}get ju(){return this.qu}Wu(t,e){const i=e?e.zu:new xV,r=e?e.Qu:this.Qu;let a=e?e.mutatedKeys:this.mutatedKeys,g=r,E=!1;const O="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,j="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(t.inorderTraversal((Y,se)=>{const be=r.get(Y),Me=QT(this.query,se)?se:null,Ge=!!be&&this.mutatedKeys.has(be.key),_t=!!Me&&(Me.hasLocalMutations||this.mutatedKeys.has(Me.key)&&Me.hasCommittedMutations);let Dt=!1;be&&Me?be.data.isEqual(Me.data)?Ge!==_t&&(i.track({type:3,doc:Me}),Dt=!0):this.Hu(be,Me)||(i.track({type:2,doc:Me}),Dt=!0,(O&&this.Gu(Me,O)>0||j&&this.Gu(Me,j)<0)&&(E=!0)):!be&&Me?(i.track({type:0,doc:Me}),Dt=!0):be&&!Me&&(i.track({type:1,doc:be}),Dt=!0,(O||j)&&(E=!0)),Dt&&(Me?(g=g.add(Me),a=_t?a.add(Y):a.delete(Y)):(g=g.delete(Y),a=a.delete(Y)))}),null!==this.query.limit)for(;g.size>this.query.limit;){const Y="F"===this.query.limitType?g.last():g.first();g=g.delete(Y.key),a=a.delete(Y.key),i.track({type:1,doc:Y})}return{Qu:g,zu:i,$i:E,mutatedKeys:a}}Hu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,i){const r=this.Qu;this.Qu=t.Qu,this.mutatedKeys=t.mutatedKeys;const a=t.zu.Eu();a.sort((j,Y)=>function(se,be){const Me=Ge=>{switch(Ge){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fi()}};return Me(se)-Me(be)}(j.type,Y.type)||this.Gu(j.doc,Y.doc)),this.Ju(i);const g=e?this.Yu():[],E=0===this.Ku.size&&this.current?1:0,O=E!==this.Uu;return this.Uu=E,0!==a.length||O?{snapshot:new W1(this.query,t.Qu,r,a,t.mutatedKeys,0===E,O,!1,!!i&&i.resumeToken.approximateByteSize()>0),Xu:g}:{Xu:g}}bu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new xV,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(t){return!this.qu.has(t)&&!!this.Qu.has(t)&&!this.Qu.get(t).hasLocalMutations}Ju(t){t&&(t.addedDocuments.forEach(e=>this.qu=this.qu.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.qu=this.qu.delete(e)),this.current=t.current)}Yu(){if(!this.current)return[];const t=this.Ku;this.Ku=Ir(),this.Qu.forEach(i=>{this.Zu(i.key)&&(this.Ku=this.Ku.add(i.key))});const e=[];return t.forEach(i=>{this.Ku.has(i)||e.push(new SV(i))}),this.Ku.forEach(i=>{t.has(i)||e.push(new TV(i))}),e}tc(t){this.qu=t.Hi,this.Ku=Ir();const e=this.Wu(t.documents);return this.applyChanges(e,!0)}ec(){return W1.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.Uu,this.hasCachedResults)}}class uZ{constructor(t,e,i){this.query=t,this.targetId=e,this.view=i}}class hZ{constructor(t){this.key=t,this.nc=!1}}class dZ{constructor(t,e,i,r,a,g){this.localStore=t,this.remoteStore=e,this.eventManager=i,this.sharedClientState=r,this.currentUser=a,this.maxConcurrentLimboResolutions=g,this.sc={},this.ic=new Pv(E=>Bz(E),JT),this.rc=new Map,this.oc=new Set,this.uc=new Ga(Ut.comparator),this.cc=new Map,this.ac=new MP,this.hc={},this.lc=new Map,this.fc=Kb.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}function pZ(n,t){return mO.apply(this,arguments)}function mO(){return mO=(0,ve.Z)(function*(n,t){const e=zO(n);let i,r;const a=e.ic.get(t);if(a)i=a.targetId,e.sharedClientState.addLocalQueryTarget(i),r=a.view.ec();else{const g=yield B1(e.localStore,jh(t));e.isPrimaryClient&&wM(e.remoteStore,g);const E=e.sharedClientState.addLocalQueryTarget(g.targetId);i=g.targetId,r=yield gO(e,t,i,"current"===E,g.resumeToken)}return r}),mO.apply(this,arguments)}function gO(n,t,e,i,r){return _O.apply(this,arguments)}function _O(){return _O=(0,ve.Z)(function*(n,t,e,i,r){n._c=(se,be,Me)=>{return(Ge=(0,ve.Z)(function*(_t,Dt,_n,Ln){let Bn=Dt.view.Wu(_n);Bn.$i&&(Bn=yield _M(_t.localStore,Dt.query,!1).then(({documents:si})=>Dt.view.Wu(si,Bn)));const Un=Ln&&Ln.targetChanges.get(Dt.targetId),ii=Dt.view.applyChanges(Bn,_t.isPrimaryClient,Un);return IO(_t,Dt.targetId,ii.Xu),ii.snapshot}),function(_t,Dt,_n,Ln){return Ge.apply(this,arguments)})(n,se,be,Me);var Ge};const a=yield _M(n.localStore,t,!0),g=new IV(t,a.Hi),E=g.Wu(a.documents),O=rS.createSynthesizedTargetChangeForCurrentChange(e,i&&"Offline"!==n.onlineState,r),j=g.applyChanges(E,n.isPrimaryClient,O);IO(n,e,j.Xu);const Y=new uZ(t,e,g);return n.ic.set(t,Y),n.rc.has(e)?n.rc.get(e).push(t):n.rc.set(e,[t]),j.snapshot}),_O.apply(this,arguments)}function fZ(n,t){return yO.apply(this,arguments)}function yO(){return yO=(0,ve.Z)(function*(n,t){const e=Qn(n),i=e.ic.get(t),r=e.rc.get(i.targetId);if(r.length>1)return e.rc.set(i.targetId,r.filter(a=>!JT(a,t))),void e.ic.delete(t);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(i.targetId),e.sharedClientState.isActiveQueryTarget(i.targetId)||(yield V1(e.localStore,i.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(i.targetId),yS(e.remoteStore,i.targetId),Z1(e,i.targetId)}).catch(Sv))):(Z1(e,i.targetId),yield V1(e.localStore,i.targetId,!0))}),yO.apply(this,arguments)}function vO(){return vO=(0,ve.Z)(function*(n,t,e){const i=BO(n);try{const r=yield function(a,g){const E=Qn(a),O=ge.now(),j=g.reduce((be,Me)=>be.add(Me.key),Ir());let Y,se;return E.persistence.runTransaction("Locally write mutations","readwrite",be=>{let Me=zd(),Ge=Ir();return E.Gi.getEntries(be,j).next(_t=>{Me=_t,Me.forEach((Dt,_n)=>{_n.isValidDocument()||(Ge=Ge.add(Dt))})}).next(()=>E.localDocuments.getOverlayedDocuments(be,Me)).next(_t=>{Y=_t;const Dt=[];for(const _n of g){const Ln=C8(_n,Y.get(_n.key).overlayedDocument);null!=Ln&&Dt.push(new Z_(_n.key,Ln,Oz(Ln.value.mapValue),ba.exists(!0)))}return E.mutationQueue.addMutationBatch(be,O,Dt,g)}).next(_t=>{se=_t;const Dt=_t.applyToLocalDocumentSet(Y,Ge);return E.documentOverlayCache.saveOverlays(be,_t.batchId,Dt)})}).then(()=>({batchId:se.batchId,changes:rB(Y)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(r.batchId),function(a,g,E){let O=a.hc[a.currentUser.toKey()];O||(O=new Ga(q)),O=O.insert(g,E),a.hc[a.currentUser.toKey()]=O}(i,r.batchId,e),yield K_(i,r.changes),yield H1(i.remoteStore)}catch(r){const a=G1(r,"Failed to persist write");e.reject(a)}}),vO.apply(this,arguments)}function DV(n,t){return bO.apply(this,arguments)}function bO(){return bO=(0,ve.Z)(function*(n,t){const e=Qn(n);try{const i=yield LW(e.localStore,t);t.targetChanges.forEach((r,a)=>{const g=e.cc.get(a);g&&(Ii(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?g.nc=!0:r.modifiedDocuments.size>0?Ii(g.nc):r.removedDocuments.size>0&&(Ii(g.nc),g.nc=!1))}),yield K_(e,i,t)}catch(i){yield Sv(i)}}),bO.apply(this,arguments)}function AV(n,t,e){const i=Qn(n);if(i.isPrimaryClient&&0===e||!i.isPrimaryClient&&1===e){const r=[];i.ic.forEach((a,g)=>{const E=g.view.bu(t);E.snapshot&&r.push(E.snapshot)}),function(a,g){const E=Qn(a);E.onlineState=g;let O=!1;E.queries.forEach((j,Y)=>{for(const se of Y.listeners)se.bu(g)&&(O=!0)}),O&&pO(E)}(i.eventManager,t),r.length&&i.sc.Wo(r),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}function gZ(n,t,e){return wO.apply(this,arguments)}function wO(){return wO=(0,ve.Z)(function*(n,t,e){const i=Qn(n);i.sharedClientState.updateQueryState(t,"rejected",e);const r=i.cc.get(t),a=r&&r.key;if(a){let g=new Ga(Ut.comparator);g=g.insert(a,da.newNoDocument(a,Ae.min()));const E=Ir().add(a),O=new iS(Ae.min(),new Map,new Is(q),g,E);yield DV(i,O),i.uc=i.uc.remove(a),i.cc.delete(t),DO(i)}else yield V1(i.localStore,t,!1).then(()=>Z1(i,t,e)).catch(Sv)}),wO.apply(this,arguments)}function _Z(n,t){return xO.apply(this,arguments)}function xO(){return xO=(0,ve.Z)(function*(n,t){const e=Qn(n),i=t.batch.batchId;try{const r=yield OW(e.localStore,t);SO(e,i,null),TO(e,i),e.sharedClientState.updateMutationState(i,"acknowledged"),yield K_(e,r)}catch(r){yield Sv(r)}}),xO.apply(this,arguments)}function yZ(n,t,e){return CO.apply(this,arguments)}function CO(){return CO=(0,ve.Z)(function*(n,t,e){const i=Qn(n);try{const r=yield function(a,g){const E=Qn(a);return E.persistence.runTransaction("Reject batch","readwrite-primary",O=>{let j;return E.mutationQueue.lookupMutationBatch(O,g).next(Y=>(Ii(null!==Y),j=Y.keys(),E.mutationQueue.removeMutationBatch(O,Y))).next(()=>E.mutationQueue.performConsistencyCheck(O)).next(()=>E.documentOverlayCache.removeOverlaysForBatchId(O,j,g)).next(()=>E.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(O,j)).next(()=>E.localDocuments.getDocuments(O,j))})}(i.localStore,t);SO(i,t,e),TO(i,t),i.sharedClientState.updateMutationState(t,"rejected",e),yield K_(i,r)}catch(r){yield Sv(r)}}),CO.apply(this,arguments)}function EO(){return EO=(0,ve.Z)(function*(n,t){const e=Qn(n);q_(e.remoteStore)||kn("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=yield function(a){const g=Qn(a);return g.persistence.runTransaction("Get highest unacknowledged batch id","readonly",E=>g.mutationQueue.getHighestUnacknowledgedBatchId(E))}(e.localStore);if(-1===i)return void t.resolve();const r=e.lc.get(i)||[];r.push(t),e.lc.set(i,r)}catch(i){const r=G1(i,"Initialization of waitForPendingWrites() operation failed");t.reject(r)}}),EO.apply(this,arguments)}function TO(n,t){(n.lc.get(t)||[]).forEach(e=>{e.resolve()}),n.lc.delete(t)}function SO(n,t,e){const i=Qn(n);let r=i.hc[i.currentUser.toKey()];if(r){const a=r.get(t);a&&(e?a.reject(e):a.resolve(),r=r.remove(t)),i.hc[i.currentUser.toKey()]=r}}function Z1(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const i of n.rc.get(t))n.ic.delete(i),e&&n.sc.wc(i,e);n.rc.delete(t),n.isPrimaryClient&&n.ac.ls(t).forEach(i=>{n.ac.containsKey(i)||MV(n,i)})}function MV(n,t){n.oc.delete(t.path.canonicalString());const e=n.uc.get(t);null!==e&&(yS(n.remoteStore,e),n.uc=n.uc.remove(t),n.cc.delete(e),DO(n))}function IO(n,t,e){for(const i of e)i instanceof TV?(n.ac.addReference(i.key,t),bZ(n,i)):i instanceof SV?(kn("SyncEngine","Document no longer in limbo: "+i.key),n.ac.removeReference(i.key,t),n.ac.containsKey(i.key)||MV(n,i.key)):fi()}function bZ(n,t){const e=t.key,i=e.path.canonicalString();n.uc.get(e)||n.oc.has(i)||(kn("SyncEngine","New document in limbo: "+e),n.oc.add(i),DO(n))}function DO(n){for(;n.oc.size>0&&n.uc.size<n.maxConcurrentLimboResolutions;){const t=n.oc.values().next().value;n.oc.delete(t);const e=new Ut(mt.fromString(t)),i=n.fc.next();n.cc.set(i,new hZ(e)),n.uc=n.uc.insert(e,i),wM(n.remoteStore,new Ov(jh(A1(e.path)),i,2,yp.at))}}function K_(n,t,e){return AO.apply(this,arguments)}function AO(){return AO=(0,ve.Z)(function*(n,t,e){const i=Qn(n),r=[],a=[],g=[];var E;i.ic.isEmpty()||(i.ic.forEach((E,O)=>{g.push(i._c(O,t,e).then(j=>{if((j||e)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(O.targetId,j?.fromCache?"not-current":"current"),j){r.push(j);const Y=OP.Ci(O.targetId,j);a.push(Y)}}))}),yield Promise.all(g),i.sc.Wo(r),yield(E=(0,ve.Z)(function*(O,j){const Y=Qn(O);try{yield Y.persistence.runTransaction("notifyLocalViewChanges","readwrite",se=>jt.forEach(j,be=>jt.forEach(be.Si,Me=>Y.persistence.referenceDelegate.addReference(se,be.targetId,Me)).next(()=>jt.forEach(be.Di,Me=>Y.persistence.referenceDelegate.removeReference(se,be.targetId,Me)))))}catch(se){if(!Iv(se))throw se;kn("LocalStore","Failed to update sequence numbers: "+se)}for(const se of j){const be=se.targetId;if(!se.fromCache){const Me=Y.qi.get(be),_t=Me.withLastLimboFreeSnapshotVersion(Me.snapshotVersion);Y.qi=Y.qi.insert(be,_t)}}}),function(O,j){return E.apply(this,arguments)})(i.localStore,a))}),AO.apply(this,arguments)}function wZ(n,t){return MO.apply(this,arguments)}function MO(){return MO=(0,ve.Z)(function*(n,t){const e=Qn(n);if(!e.currentUser.isEqual(t)){kn("SyncEngine","User change. New user:",t.toKey());const i=yield rV(e.localStore,t);e.currentUser=t,(r=e).lc.forEach(g=>{g.forEach(E=>{E.reject(new Cn(Wt.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),r.lc.clear(),e.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),yield K_(e,i.ji)}var r}),MO.apply(this,arguments)}function xZ(n,t){const e=Qn(n),i=e.cc.get(t);if(i&&i.nc)return Ir().add(i.key);{let r=Ir();const a=e.rc.get(t);if(!a)return r;for(const g of a){const E=e.ic.get(g);r=r.unionWith(E.view.ju)}return r}}function CZ(n,t){return kO.apply(this,arguments)}function kO(){return kO=(0,ve.Z)(function*(n,t){const e=Qn(n),i=yield _M(e.localStore,t.query,!0),r=t.view.tc(i);return e.isPrimaryClient&&IO(e,t.targetId,r.Xu),r}),kO.apply(this,arguments)}function EZ(n,t){return RO.apply(this,arguments)}function RO(){return RO=(0,ve.Z)(function*(n,t){const e=Qn(n);return lV(e.localStore,t).then(i=>K_(e,i))}),RO.apply(this,arguments)}function TZ(n,t,e,i){return PO.apply(this,arguments)}function PO(){return PO=(0,ve.Z)(function*(n,t,e,i){const r=Qn(n),a=yield function(g,E){const O=Qn(g),j=Qn(O.mutationQueue);return O.persistence.runTransaction("Lookup mutation documents","readonly",Y=>j.Tn(Y,E).next(se=>se?O.localDocuments.getDocuments(Y,se):jt.resolve(null)))}(r.localStore,t);var E;null!==a?("pending"===e?yield H1(r.remoteStore):"acknowledged"===e||"rejected"===e?(SO(r,t,i||null),TO(r,t),E=t,Qn(Qn(r.localStore).mutationQueue).An(E)):fi(),yield K_(r,a)):kn("SyncEngine","Cannot apply mutation batch with id: "+t)}),PO.apply(this,arguments)}function OO(){return OO=(0,ve.Z)(function*(n,t){const e=Qn(n);if(zO(e),BO(e),!0===t&&!0!==e.dc){const i=e.sharedClientState.getAllActiveQueryTargets(),r=yield kV(e,i.toArray());e.dc=!0,yield sO(e.remoteStore,!0);for(const a of r)wM(e.remoteStore,a)}else if(!1===t&&!1!==e.dc){const i=[];let r=Promise.resolve();e.rc.forEach((a,g)=>{e.sharedClientState.isLocalQueryTarget(g)?i.push(g):r=r.then(()=>(Z1(e,g),V1(e.localStore,g,!0))),yS(e.remoteStore,g)}),yield r,yield kV(e,i),function(a){const g=Qn(a);g.cc.forEach((E,O)=>{yS(g.remoteStore,O)}),g.ac.fs(),g.cc=new Map,g.uc=new Ga(Ut.comparator)}(e),e.dc=!1,yield sO(e.remoteStore,!1)}}),OO.apply(this,arguments)}function kV(n,t,e){return LO.apply(this,arguments)}function LO(){return LO=(0,ve.Z)(function*(n,t,e){const i=Qn(n),r=[],a=[];for(const g of t){let E;const O=i.rc.get(g);if(O&&0!==O.length){E=yield B1(i.localStore,jh(O[0]));for(const j of O){const Y=i.ic.get(j),se=yield CZ(i,Y);se.snapshot&&a.push(se.snapshot)}}else{const j=yield aV(i.localStore,g);E=yield B1(i.localStore,j),yield gO(i,RV(j),g,!1,E.resumeToken)}r.push(E)}return i.sc.Wo(a),r}),LO.apply(this,arguments)}function RV(n){return Nz(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function IZ(n){const t=Qn(n);return Qn(Qn(t.localStore).persistence).vi()}function DZ(n,t,e,i){return FO.apply(this,arguments)}function FO(){return FO=(0,ve.Z)(function*(n,t,e,i){const r=Qn(n);if(r.dc)return void kn("SyncEngine","Ignoring unexpected query state notification.");const a=r.rc.get(t);if(a&&a.length>0)switch(e){case"current":case"not-current":{const g=yield lV(r.localStore,Vz(a[0])),E=iS.createSynthesizedRemoteEventForCurrentChange(t,"current"===e,bc.EMPTY_BYTE_STRING);yield K_(r,g,E);break}case"rejected":yield V1(r.localStore,t,!0),Z1(r,t,i);break;default:fi()}}),FO.apply(this,arguments)}function AZ(n,t,e){return NO.apply(this,arguments)}function NO(){return NO=(0,ve.Z)(function*(n,t,e){const i=zO(n);if(i.dc){for(const r of t){if(i.rc.has(r)){kn("SyncEngine","Adding an already active target "+r);continue}const a=yield aV(i.localStore,r),g=yield B1(i.localStore,a);yield gO(i,RV(a),g.targetId,!1,g.resumeToken),wM(i.remoteStore,g)}for(const r of e)i.rc.has(r)&&(yield V1(i.localStore,r,!1).then(()=>{yS(i.remoteStore,r),Z1(i,r)}).catch(Sv))}}),NO.apply(this,arguments)}function zO(n){const t=Qn(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=DV.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=xZ.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=gZ.bind(null,t),t.sc.Wo=sZ.bind(null,t.eventManager),t.sc.wc=aZ.bind(null,t.eventManager),t}function BO(n){const t=Qn(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=_Z.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=yZ.bind(null,t),t}class PV{constructor(){this.synchronizeTabs=!1}initialize(t){var e=this;return(0,ve.Z)(function*(){e.yt=gS(t.databaseInfo.databaseId),e.sharedClientState=e.gc(t),e.persistence=e.yc(t),yield e.persistence.start(),e.localStore=e.Ic(t),e.gcScheduler=e.Tc(t,e.localStore),e.indexBackfillerScheduler=e.Ec(t,e.localStore)})()}Tc(t,e){return null}Ec(t,e){return null}Ic(t){return iV(this.persistence,new nV,t.initialUser,this.yt)}yc(t){return new eV(mM.Bs,this.yt)}gc(t){return new dV}terminate(){var t=this;return(0,ve.Z)(function*(){t.gcScheduler&&t.gcScheduler.stop(),yield t.sharedClientState.shutdown(),yield t.persistence.shutdown()})()}}class OV extends PV{constructor(t,e,i){super(),this.Ac=t,this.cacheSizeBytes=e,this.forceOwnership=i,this.synchronizeTabs=!1}initialize(t){var e=()=>super.initialize,i=this;return(0,ve.Z)(function*(){yield e().call(i,t),yield i.Ac.initialize(i,t),yield BO(i.Ac.syncEngine),yield H1(i.Ac.remoteStore),yield i.persistence.li(()=>(i.gcScheduler&&!i.gcScheduler.started&&i.gcScheduler.start(),i.indexBackfillerScheduler&&!i.indexBackfillerScheduler.started&&i.indexBackfillerScheduler.start(),Promise.resolve()))})()}Ic(t){return iV(this.persistence,new nV,t.initialUser,this.yt)}Tc(t,e){return new vW(this.persistence.referenceDelegate.garbageCollector,t.asyncQueue,e)}Ec(t,e){const i=new n8(e,this.persistence);return new t8(t.asyncQueue,i)}yc(t){const e=PP(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),i=void 0!==this.cacheSizeBytes?Bd.withCacheSize(this.cacheSizeBytes):Bd.DEFAULT;return new RP(this.synchronizeTabs,e,t.clientId,i,t.asyncQueue,fV(),bM(),this.yt,this.sharedClientState,!!this.forceOwnership)}gc(t){return new dV}}class kZ extends OV{constructor(t,e){super(t,e,!1),this.Ac=t,this.cacheSizeBytes=e,this.synchronizeTabs=!0}initialize(t){var e=()=>super.initialize,i=this;return(0,ve.Z)(function*(){yield e().call(i,t);const r=i.Ac.syncEngine;i.sharedClientState instanceof HP&&(i.sharedClientState.syncEngine={Fr:TZ.bind(null,r),$r:DZ.bind(null,r),Br:AZ.bind(null,r),vi:IZ.bind(null,r),Mr:EZ.bind(null,r)},yield i.sharedClientState.start()),yield i.persistence.li(function(){var a=(0,ve.Z)(function*(g){yield function SZ(n,t){return OO.apply(this,arguments)}(i.Ac.syncEngine,g),i.gcScheduler&&(g&&!i.gcScheduler.started?i.gcScheduler.start():g||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(g&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():g||i.indexBackfillerScheduler.stop())});return function(g){return a.apply(this,arguments)}}())})()}gc(t){const e=fV();if(!HP.C(e))throw new Cn(Wt.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=PP(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new HP(e,t.asyncQueue,i,t.clientId,t.initialUser)}}class VO{initialize(t,e){var i=this;return(0,ve.Z)(function*(){i.localStore||(i.localStore=t.localStore,i.sharedClientState=t.sharedClientState,i.datastore=i.createDatastore(e),i.remoteStore=i.createRemoteStore(e),i.eventManager=i.createEventManager(e),i.syncEngine=i.createSyncEngine(e,!t.synchronizeTabs),i.sharedClientState.onlineStateHandler=r=>AV(i.syncEngine,r,1),i.remoteStore.remoteSyncer.handleCredentialChange=wZ.bind(null,i.syncEngine),yield sO(i.remoteStore,i.syncEngine.isPrimaryClient))})()}createEventManager(t){return new oZ}createDatastore(t){const e=gS(t.databaseInfo.databaseId),i=new HW(t.databaseInfo);return new $W(t.authCredentials,t.appCheckCredentials,i,e)}createRemoteStore(t){return e=this.localStore,i=this.datastore,r=t.asyncQueue,a=E=>AV(this.syncEngine,E,0),g=pV.C()?new pV:new BW,new qW(e,i,r,a,g);var e,i,r,a,g}createSyncEngine(t,e){return function(i,r,a,g,E,O,j){const Y=new dZ(i,r,a,g,E,O);return j&&(Y.dc=!0),Y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return(t=(0,ve.Z)(function*(e){const i=Qn(e);kn("RemoteStore","RemoteStore shutting down."),i._u.add(5),yield U1(i),i.mu.shutdown(),i.gu.set("Unknown")}),function(e){return t.apply(this,arguments)})(this.remoteStore);var t}}function UO(n,t,e){if(!e)throw new Cn(Wt.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function LV(n,t,e,i){if(!0===t&&!0===i)throw new Cn(Wt.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function FV(n){if(!Ut.isDocumentKey(n))throw new Cn(Wt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function NV(n){if(Ut.isDocumentKey(n))throw new Cn(Wt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function CM(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const t=(e=n).constructor?e.constructor.name:null;return t?`a custom ${t} object`:"an object"}}var e;return"function"==typeof n?"a function":fi()}function po(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new Cn(Wt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=CM(n);throw new Cn(Wt.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}function zV(n,t){if(t<=0)throw new Cn(Wt.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${t}.`)}const BV=new Map;class VV{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Cn(Wt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Cn(Wt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,LV("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class vS{constructor(t,e,i,r){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new VV({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Cn(Wt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Cn(Wt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new VV(t),void 0!==t.credentials&&(this._authCredentials=function(e){if(!e)return new sz;switch(e.type){case"gapi":return new p(e.client,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Cn(Wt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=BV.get(t);e&&(kn("ComponentProvider","Removing Datastore"),BV.delete(t),e.terminate())}(this),Promise.resolve()}}function UV(n,t,e,i={}){var r;const a=(n=po(n,vS))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==t&&$_("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},a),{host:`${t}:${e}`,ssl:!1})),i.mockUserToken){let g,E;if("string"==typeof i.mockUserToken)g=i.mockUserToken,E=Ha.MOCK_USER;else{g=(0,Be.Sg)(i.mockUserToken,null===(r=n._app)||void 0===r?void 0:r.options.projectId);const O=i.mockUserToken.sub||i.mockUserToken.user_id;if(!O)throw new Cn(Wt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");E=new Ha(O)}n._authCredentials=new az(new XR(g,E))}}class pa{constructor(t,e,i){this.converter=e,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rg(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new pa(this.firestore,t,this._key)}}class ku{constructor(t,e,i){this.converter=e,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new ku(this.firestore,t,this._query)}}class Rg extends ku{constructor(t,e,i){super(t,e,A1(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new pa(this.firestore,null,new Ut(t))}withConverter(t){return new Rg(this.firestore,t,this._path)}}function HO(n,t,...e){if(n=(0,Be.m9)(n),UO("collection","path",t),n instanceof vS){const i=mt.fromString(t,...e);return NV(i),new Rg(n,null,i)}{if(!(n instanceof pa||n instanceof Rg))throw new Cn(Wt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(mt.fromString(t,...e));return NV(i),new Rg(n.firestore,null,i)}}function EM(n,t,...e){if(n=(0,Be.m9)(n),1===arguments.length&&(t=H.R()),UO("doc","path",t),n instanceof vS){const i=mt.fromString(t,...e);return FV(i),new pa(n,null,new Ut(i))}{if(!(n instanceof pa||n instanceof Rg))throw new Cn(Wt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(mt.fromString(t,...e));return FV(i),new pa(n.firestore,n instanceof Rg?n.converter:null,new Ut(i))}}function HV(n,t){return n=(0,Be.m9)(n),t=(0,Be.m9)(t),(n instanceof pa||n instanceof Rg)&&(t instanceof pa||t instanceof Rg)&&n.firestore===t.firestore&&n.path===t.path&&n.converter===t.converter}function jO(n,t){return n=(0,Be.m9)(n),t=(0,Be.m9)(t),n instanceof ku&&t instanceof ku&&n.firestore===t.firestore&&JT(n._query,t._query)&&n.converter===t.converter}function jV(n,t=10240){let e=0;return{read:()=>(0,ve.Z)(function*(){if(e<n.byteLength){const i={value:n.slice(e,e+t),done:!1};return e+=t,i}return{done:!0}})(),cancel:()=>(0,ve.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class TM{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Rc(this.observer.next,t)}error(t){this.observer.error?this.Rc(this.observer.error,t):Aa("Uncaught Error in snapshot listener:",t.toString())}bc(){this.muted=!0}Rc(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}}class PZ{constructor(t,e){this.Pc=t,this.yt=e,this.metadata=new Fl,this.buffer=new Uint8Array,this.vc=new TextDecoder("utf-8"),this.Vc().then(i=>{i&&i.Ou()?this.metadata.resolve(i.ku.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(i?.ku)}`))},i=>this.metadata.reject(i))}close(){return this.Pc.cancel()}getMetadata(){var t=this;return(0,ve.Z)(function*(){return t.metadata.promise})()}mc(){var t=this;return(0,ve.Z)(function*(){return yield t.getMetadata(),t.Vc()})()}Vc(){var t=this;return(0,ve.Z)(function*(){const e=yield t.Sc();if(null===e)return null;const i=t.vc.decode(e),r=Number(i);isNaN(r)&&t.Dc(`length string (${i}) is not valid number`);const a=yield t.Cc(r);return new lZ(JSON.parse(a),e.length+r)})()}xc(){return this.buffer.findIndex(t=>t==="{".charCodeAt(0))}Sc(){var t=this;return(0,ve.Z)(function*(){for(;t.xc()<0&&!(yield t.Nc()););if(0===t.buffer.length)return null;const e=t.xc();e<0&&t.Dc("Reached the end of bundle when a length string is expected.");const i=t.buffer.slice(0,e);return t.buffer=t.buffer.slice(e),i})()}Cc(t){var e=this;return(0,ve.Z)(function*(){for(;e.buffer.length<t;)(yield e.Nc())&&e.Dc("Reached the end of bundle when more is expected.");const i=e.vc.decode(e.buffer.slice(0,t));return e.buffer=e.buffer.slice(t),i})()}Dc(t){throw this.Pc.cancel(),new Error(`Invalid bundle format: ${t}`)}Nc(){var t=this;return(0,ve.Z)(function*(){const e=yield t.Pc.read();if(!e.done){const i=new Uint8Array(t.buffer.length+e.value.length);i.set(t.buffer),i.set(e.value,t.buffer.length),t.buffer=i}return e.done})()}}class FZ{constructor(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(t){var e=this;return(0,ve.Z)(function*(){if(e.ensureCommitNotCalled(),e.mutations.length>0)throw new Cn(Wt.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const i=yield(r=(0,ve.Z)(function*(a,g){const E=Qn(a),O=sS(E.yt)+"/documents",j={documents:g.map(Me=>oS(E.yt,Me))},Y=yield E._o("BatchGetDocuments",O,j,g.length),se=new Map;Y.forEach(Me=>{const Ge=function L8(n,t){return"found"in t?function(e,i){Ii(!!i.found);const r=Mg(e,i.found.name),a=ll(i.found.updateTime),g=i.found.createTime?ll(i.found.createTime):Ae.min(),E=new Mu({mapValue:{fields:i.found.fields}});return da.newFoundDocument(r,a,g,E)}(n,t):"missing"in t?function(e,i){Ii(!!i.missing),Ii(!!i.readTime);const r=Mg(e,i.missing),a=ll(i.readTime);return da.newNoDocument(r,a)}(n,t):fi()}(E.yt,Me);se.set(Ge.key.toString(),Ge)});const be=[];return g.forEach(Me=>{const Ge=se.get(Me.toString());Ii(!!Ge),be.push(Ge)}),be}),function(a,g){return r.apply(this,arguments)})(e.datastore,t);var r;return i.forEach(r=>e.recordVersion(r)),i})()}set(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())}update(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(i){this.lastWriteError=i}this.writtenDocs.add(t.toString())}delete(t){this.write(new P1(t,this.precondition(t))),this.writtenDocs.add(t.toString())}commit(){var t=this;return(0,ve.Z)(function*(){if(t.ensureCommitNotCalled(),t.lastWriteError)throw t.lastWriteError;const e=t.readVersions;var i;t.mutations.forEach(i=>{e.delete(i.key.toString())}),e.forEach((i,r)=>{const a=Ut.fromPath(r);t.mutations.push(new fP(a,t.precondition(a)))}),yield(i=(0,ve.Z)(function*(r,a){const g=Qn(r),E=sS(g.yt)+"/documents",O={writes:a.map(j=>aS(g.yt,j))};yield g.ao("Commit",E,O)}),function(r,a){return i.apply(this,arguments)})(t.datastore,t.mutations),t.committed=!0})()}recordVersion(t){let e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw fi();e=Ae.min()}const i=this.readVersions.get(t.key.toString());if(i){if(!e.isEqual(i))throw new Cn(Wt.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)}precondition(t){const e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?e.isEqual(Ae.min())?ba.exists(!1):ba.updateTime(e):ba.none()}preconditionForUpdate(t){const e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(Ae.min()))throw new Cn(Wt.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ba.updateTime(e)}return ba.exists(!0)}write(t){this.ensureCommitNotCalled(),this.mutations.push(t)}ensureCommitNotCalled(){}}class NZ{constructor(t,e,i,r,a){this.asyncQueue=t,this.datastore=e,this.options=i,this.updateFunction=r,this.deferred=a,this.kc=i.maxAttempts,this.xo=new jP(this.asyncQueue,"transaction_retry")}run(){this.kc-=1,this.Oc()}Oc(){var t=this;this.xo.Ro((0,ve.Z)(function*(){const e=new FZ(t.datastore),i=t.Mc(e);i&&i.then(r=>{t.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{t.deferred.resolve(r)}).catch(a=>{t.Fc(a)}))}).catch(r=>{t.Fc(r)})}))}Mc(t){try{const e=this.updateFunction(t);return!GT(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Fc(t){this.kc>0&&this.$c(t)?(this.kc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Oc(),Promise.resolve()))):this.deferred.reject(t)}$c(t){if("FirebaseError"===t.name){const e=t.code;return"aborted"===e||"failed-precondition"===e||"already-exists"===e||!tB(e)}return!1}}class zZ{constructor(t,e,i,r){var a=this;this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=i,this.databaseInfo=r,this.user=Ha.UNAUTHENTICATED,this.clientId=H.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,function(){var g=(0,ve.Z)(function*(E){kn("FirestoreClient","Received user=",E.uid),yield a.authCredentialListener(E),a.user=E});return function(E){return g.apply(this,arguments)}}()),this.appCheckCredentials.start(i,g=>(kn("FirestoreClient","Received new app check token=",g),this.appCheckCredentialListener(g,this.user)))}getConfiguration(){var t=this;return(0,ve.Z)(function*(){return{asyncQueue:t.asyncQueue,databaseInfo:t.databaseInfo,clientId:t.clientId,authCredentials:t.authCredentials,appCheckCredentials:t.appCheckCredentials,initialUser:t.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Cn(Wt.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var t=this;this.asyncQueue.enterRestrictedMode();const e=new Fl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,ve.Z)(function*(){try{t.onlineComponents&&(yield t.onlineComponents.terminate()),t.offlineComponents&&(yield t.offlineComponents.terminate()),t.authCredentials.shutdown(),t.appCheckCredentials.shutdown(),e.resolve()}catch(i){const r=G1(i,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}function GV(n,t){return GO.apply(this,arguments)}function GO(){return GO=(0,ve.Z)(function*(n,t){n.asyncQueue.verifyOperationInProgress(),kn("FirestoreClient","Initializing OfflineComponentProvider");const e=yield n.getConfiguration();yield t.initialize(e);let i=e.initialUser;n.setCredentialChangeListener(function(){var r=(0,ve.Z)(function*(a){i.isEqual(a)||(yield rV(t.localStore,a),i=a)});return function(a){return r.apply(this,arguments)}}()),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=t}),GO.apply(this,arguments)}function $V(n,t){return $O.apply(this,arguments)}function $O(){return $O=(0,ve.Z)(function*(n,t){n.asyncQueue.verifyOperationInProgress();const e=yield WO(n);kn("FirestoreClient","Initializing OnlineComponentProvider");const i=yield n.getConfiguration();yield t.initialize(e,i),n.setCredentialChangeListener(r=>wV(t.remoteStore,r)),n.setAppCheckTokenChangeListener((r,a)=>wV(t.remoteStore,a)),n.onlineComponents=t}),$O.apply(this,arguments)}function WO(n){return ZO.apply(this,arguments)}function ZO(){return ZO=(0,ve.Z)(function*(n){return n.offlineComponents||(kn("FirestoreClient","Using default OfflineComponentProvider"),yield GV(n,new PV)),n.offlineComponents}),ZO.apply(this,arguments)}function SM(n){return qO.apply(this,arguments)}function qO(){return qO=(0,ve.Z)(function*(n){return n.onlineComponents||(kn("FirestoreClient","Using default OnlineComponentProvider"),yield $V(n,new VO)),n.onlineComponents}),qO.apply(this,arguments)}function WV(n){return WO(n).then(t=>t.persistence)}function IM(n){return WO(n).then(t=>t.localStore)}function KO(n){return SM(n).then(t=>t.remoteStore)}function YO(n){return SM(n).then(t=>t.syncEngine)}function q1(n){return JO.apply(this,arguments)}function JO(){return JO=(0,ve.Z)(function*(n){const t=yield SM(n),e=t.eventManager;return e.onListen=pZ.bind(null,t.syncEngine),e.onUnlisten=fZ.bind(null,t.syncEngine),e}),JO.apply(this,arguments)}function qV(n,t,e={}){const i=new Fl;return n.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return function(r,a,g,E,O){const j=new TM({next:se=>{a.enqueueAndForget(()=>hO(r,Y));const be=se.docs.has(g);!be&&se.fromCache?O.reject(new Cn(Wt.UNAVAILABLE,"Failed to get document because the client is offline.")):be&&se.fromCache&&E&&"server"===E.source?O.reject(new Cn(Wt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):O.resolve(se)},error:se=>O.reject(se)}),Y=new fO(A1(g.path),j,{includeMetadataChanges:!0,Nu:!0});return cO(r,Y)}(yield q1(n),n.asyncQueue,t,e,i)})),i.promise}function KV(n,t,e={}){const i=new Fl;return n.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return function(r,a,g,E,O){const j=new TM({next:se=>{a.enqueueAndForget(()=>hO(r,Y)),se.fromCache&&"server"===E.source?O.reject(new Cn(Wt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):O.resolve(se)},error:se=>O.reject(se)}),Y=new fO(g,j,{includeMetadataChanges:!0,Nu:!0});return cO(r,Y)}(yield q1(n),n.asyncQueue,t,e,i)})),i.promise}class WZ{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.qc=!1,this.Uc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new jP(this,"async_queue_retry"),this.Wc=()=>{const e=bM();e&&kn("AsyncQueue","Visibility state changed to "+e.visibilityState),this.xo.Po()};const t=bM();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.qc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.zc(),this.Hc(t)}enterRestrictedMode(t){if(!this.qc){this.qc=!0,this.Qc=t||!1;const e=bM();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Wc)}}enqueue(t){if(this.zc(),this.qc)return new Promise(()=>{});const e=new Fl;return this.Hc(()=>this.qc&&this.Qc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Lc.push(t),this.Jc()))}Jc(){var t=this;return(0,ve.Z)(function*(){if(0!==t.Lc.length){try{yield t.Lc[0](),t.Lc.shift(),t.xo.reset()}catch(e){if(!Iv(e))throw e;kn("AsyncQueue","Operation failed with retryable error: "+e)}t.Lc.length>0&&t.xo.Ro(()=>t.Jc())}})()}Hc(t){const e=this.Bc.then(()=>(this.Gc=!0,t().catch(i=>{throw this.Kc=i,this.Gc=!1,Aa("INTERNAL UNHANDLED ERROR: ",function(a){let g=a.message||"";return a.stack&&(g=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),g}(i)),i}).then(i=>(this.Gc=!1,i))));return this.Bc=e,e}enqueueAfterDelay(t,e,i){this.zc(),this.jc.indexOf(t)>-1&&(e=0);const r=lO.createAndSchedule(this,t,e,i,a=>this.Yc(a));return this.Uc.push(r),r}zc(){this.Kc&&fi()}verifyOperationInProgress(){}Xc(){var t=this;return(0,ve.Z)(function*(){let e;do{e=t.Bc,yield e}while(e!==t.Bc)})()}Zc(t){for(const e of this.Uc)if(e.timerId===t)return!0;return!1}ta(t){return this.Xc().then(()=>{this.Uc.sort((e,i)=>e.targetTimeMs-i.targetTimeMs);for(const e of this.Uc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Xc()})}ea(t){this.jc.push(t)}Yc(t){const e=this.Uc.indexOf(t);this.Uc.splice(e,1)}}function QO(n){return function(t,e){if("object"!=typeof t||null===t)return!1;const i=t;for(const r of["next","error","complete"])if(r in i&&"function"==typeof i[r])return!0;return!1}(n)}class ZZ{constructor(){this._progressObserver={},this._taskCompletionResolver=new Fl,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(t,e,i){this._progressObserver={next:t,error:e,complete:i}}catch(t){return this._taskCompletionResolver.promise.catch(t)}then(t,e){return this._taskCompletionResolver.promise.then(t,e)}_completeWith(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)}_failWith(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)}_updateProgress(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}}class fa extends vS{constructor(t,e,i,r){super(t,e,i,r),this.type="firestore",this._queue=new WZ,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||YV(this),this._firestoreClient.terminate()}}function KZ(n,t){const e="object"==typeof n?n:(0,Pe.getApp)(),i="string"==typeof n?n:t||"(default)",r=(0,Pe._getProvider)(e,"firestore").getImmediate({identifier:i});if(!r._initialized){const a=(0,Be.P0)("firestore");a&&UV(r,...a)}return r}function cl(n){return n._firestoreClient||YV(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function YV(n){var t;const e=n._freezeSettings(),i=(a=(null===(t=n._app)||void 0===t?void 0:t.options.appId)||"",new r8(n._databaseId,a,n._persistenceKey,(E=e).host,E.ssl,E.experimentalForceLongPolling,E.experimentalAutoDetectLongPolling,E.useFetchStreams));var a,E;n._firestoreClient=new zZ(n._authCredentials,n._appCheckCredentials,n._queue,i)}function JV(n,t,e){const i=new Fl;return n.asyncQueue.enqueue((0,ve.Z)(function*(){try{yield GV(n,e),yield $V(n,t),i.resolve()}catch(r){const a=r;if(!("FirebaseError"===(g=a).name?g.code===Wt.FAILED_PRECONDITION||g.code===Wt.UNIMPLEMENTED:!(typeof DOMException<"u"&&g instanceof DOMException)||22===g.code||20===g.code||11===g.code))throw a;$_("Error enabling offline persistence. Falling back to persistence disabled: "+a),i.reject(a)}var g})).then(()=>i.promise)}function QV(n){if(n._initialized||n._terminated)throw new Cn(Wt.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Pg{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Pg(bc.fromBase64String(t))}catch(e){throw new Cn(Wt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new Pg(bc.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Y_{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Cn(Wt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gn(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Jb{constructor(t){this._methodName=t}}class DM{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Cn(Wt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Cn(Wt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return q(this._lat,t._lat)||q(this._long,t._long)}}const rq=/^__.*__$/;class oq{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return null!==this.fieldMask?new Z_(t,this.data,this.fieldMask,e,this.fieldTransforms):new R1(t,this.data,e,this.fieldTransforms)}}class XV{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return new Z_(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function eU(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw fi()}}class AM{constructor(t,e,i,r,a,g){this.settings=t,this.databaseId=e,this.yt=i,this.ignoreUndefinedProperties=r,void 0===a&&this.na(),this.fieldTransforms=a||[],this.fieldMask=g||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(t){return new AM(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.yt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(t){var e;const i=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.ia({path:i,oa:!1});return r.ua(t),r}ca(t){var e;const i=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.ia({path:i,oa:!1});return r.na(),r}aa(t){return this.ia({path:void 0,oa:!0})}ha(t){return RM(t,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(t){return void 0!==this.fieldMask.find(e=>t.isPrefixOf(e))||void 0!==this.fieldTransforms.find(e=>t.isPrefixOf(e.field))}na(){if(this.path)for(let t=0;t<this.path.length;t++)this.ua(this.path.get(t))}ua(t){if(0===t.length)throw this.ha("Document fields must not be empty");if(eU(this.sa)&&rq.test(t))throw this.ha('Document fields cannot begin and end with "__"')}}class sq{constructor(t,e,i){this.databaseId=t,this.ignoreUndefinedProperties=e,this.yt=i||gS(t)}da(t,e,i,r=!1){return new AM({sa:t,methodName:e,fa:i,path:gn.emptyPath(),oa:!1,la:r},this.databaseId,this.yt,this.ignoreUndefinedProperties)}}function Qb(n){const t=n._freezeSettings(),e=gS(n._databaseId);return new sq(n._databaseId,!!t.ignoreUndefinedProperties,e)}function MM(n,t,e,i,r,a={}){const g=n.da(a.merge||a.mergeFields?2:0,t,e,r);nL("Data must be an object, but it was:",g,i);const E=iU(i,g);let O,j;if(a.merge)O=new Nd(g.fieldMask),j=g.fieldTransforms;else if(a.mergeFields){const Y=[];for(const se of a.mergeFields){const be=iL(t,se,e);if(!g.contains(be))throw new Cn(Wt.INVALID_ARGUMENT,`Field '${be}' is specified in your field mask but missing from your input data.`);oU(Y,be)||Y.push(be)}O=new Nd(Y),j=g.fieldTransforms.filter(se=>O.covers(se.field))}else O=null,j=g.fieldTransforms;return new oq(new Mu(E),O,j)}class bS extends Jb{_toFieldTransform(t){if(2!==t.sa)throw t.ha(1===t.sa?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof bS}}function tU(n,t,e){return new AM({sa:3,fa:t.settings.fa,methodName:n._methodName,oa:e},t.databaseId,t.yt,t.ignoreUndefinedProperties)}class XO extends Jb{_toFieldTransform(t){return new XT(t.path,new M1)}isEqual(t){return t instanceof XO}}class aq extends Jb{constructor(t,e){super(t),this._a=e}_toFieldTransform(t){const e=tU(this,t,!0),i=this._a.map(a=>Xb(a,e)),r=new Hb(i);return new XT(t.path,r)}isEqual(t){return this===t}}class lq extends Jb{constructor(t,e){super(t),this._a=e}_toFieldTransform(t){const e=tU(this,t,!0),i=this._a.map(a=>Xb(a,e)),r=new jb(i);return new XT(t.path,r)}isEqual(t){return this===t}}class cq extends Jb{constructor(t,e){super(t),this.wa=e}_toFieldTransform(t){const e=new k1(t.yt,Gz(t.yt,this.wa));return new XT(t.path,e)}isEqual(t){return this===t}}function eL(n,t,e,i){const r=n.da(1,t,e);nL("Data must be an object, but it was:",r,i);const a=[],g=Mu.empty();Fb(i,(O,j)=>{const Y=kM(t,O,e);j=(0,Be.m9)(j);const se=r.ca(Y);if(j instanceof bS)a.push(Y);else{const be=Xb(j,se);null!=be&&(a.push(Y),g.set(Y,be))}});const E=new Nd(a);return new XV(g,E,r.fieldTransforms)}function tL(n,t,e,i,r,a){const g=n.da(1,t,e),E=[iL(t,i,e)],O=[r];if(a.length%2!=0)throw new Cn(Wt.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let be=0;be<a.length;be+=2)E.push(iL(t,a[be])),O.push(a[be+1]);const j=[],Y=Mu.empty();for(let be=E.length-1;be>=0;--be)if(!oU(j,E[be])){const Me=E[be];let Ge=O[be];Ge=(0,Be.m9)(Ge);const _t=g.ca(Me);if(Ge instanceof bS)j.push(Me);else{const Dt=Xb(Ge,_t);null!=Dt&&(j.push(Me),Y.set(Me,Dt))}}const se=new Nd(j);return new XV(Y,se,g.fieldTransforms)}function nU(n,t,e,i=!1){return Xb(e,n.da(i?4:3,t))}function Xb(n,t){if(rU(n=(0,Be.m9)(n)))return nL("Unsupported field value:",t,n),iU(n,t);if(n instanceof Jb)return function(e,i){if(!eU(i.sa))throw i.ha(`${e._methodName}() can only be used with update() and set()`);if(!i.path)throw i.ha(`${e._methodName}() is not currently supported inside arrays`);const r=e._toFieldTransform(i);r&&i.fieldTransforms.push(r)}(n,t),null;if(void 0===n&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.oa&&4!==t.sa)throw t.ha("Nested arrays are not supported");return function(e,i){const r=[];let a=0;for(const g of e){let E=Xb(g,i.aa(a));null==E&&(E={nullValue:"NULL_VALUE"}),r.push(E),a++}return{arrayValue:{values:r}}}(n,t)}return function(e,i){if(null===(e=(0,Be.m9)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Gz(i.yt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const r=ge.fromDate(e);return{timestampValue:O1(i.yt,r)}}if(e instanceof ge){const r=new ge(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:O1(i.yt,r)}}if(e instanceof DM)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Pg)return{bytesValue:hB(i.yt,e._byteString)};if(e instanceof pa){const r=i.databaseId,a=e.firestore._databaseId;if(!a.isEqual(r))throw i.ha(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:mP(e.firestore._databaseId||i.databaseId,e._key.path)}}throw i.ha(`Unsupported field value: ${CM(e)}`)}(n,t)}function iU(n,t){const e={};return mz(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Fb(n,(i,r)=>{const a=Xb(r,t.ra(i));null!=a&&(e[i]=a)}),{mapValue:{fields:e}}}function rU(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof ge||n instanceof DM||n instanceof Pg||n instanceof pa||n instanceof Jb)}function nL(n,t,e){if(!rU(e)||"object"!=typeof(i=e)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const i=CM(e);throw t.ha("an object"===i?n+" a custom object":n+" "+i)}var i}function iL(n,t,e){if((t=(0,Be.m9)(t))instanceof Y_)return t._internalPath;if("string"==typeof t)return kM(n,t);throw RM("Field path arguments must be of type string or ",n,!1,void 0,e)}const uq=new RegExp("[~\\*/\\[\\]]");function kM(n,t,e){if(t.search(uq)>=0)throw RM(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new Y_(...t.split("."))._internalPath}catch{throw RM(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function RM(n,t,e,i,r){const a=i&&!i.isEmpty(),g=void 0!==r;let E=`Function ${t}() called with invalid data`;e&&(E+=" (via `toFirestore()`)"),E+=". ";let O="";return(a||g)&&(O+=" (found",a&&(O+=` in field ${i}`),g&&(O+=` in document ${r}`),O+=")"),new Cn(Wt.INVALID_ARGUMENT,E+n+O)}function oU(n,t){return n.some(e=>e.isEqual(t))}class wS{constructor(t,e,i,r,a){this._firestore=t,this._userDataWriter=e,this._key=i,this._document=r,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new pa(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new hq(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(PM("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class hq extends wS{data(){return super.data()}}function PM(n,t){return"string"==typeof t?kM(n,t):t instanceof Y_?t._internalPath:t._delegate._internalPath}function sU(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Cn(Wt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class rL{}class xS extends rL{}function J_(n,t,...e){let i=[];t instanceof rL&&i.push(t),i=i.concat(e),function(r){const a=r.filter(E=>E instanceof K1).length,g=r.filter(E=>E instanceof CS).length;if(a>1||a>0&&g>0)throw new Cn(Wt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)n=r._apply(n);return n}class CS extends xS{constructor(t,e,i){super(),this._field=t,this._op=e,this._value=i,this.type="where"}static _create(t,e,i){return new CS(t,e,i)}_apply(t){const e=this._parse(t);return hU(t._query,e),new ku(t.firestore,t.converter,dP(t._query,e))}_parse(t){const e=Qb(t.firestore);return function(r,a,g,E,O,j,Y){let se;if(O.isKeyField()){if("array-contains"===j||"array-contains-any"===j)throw new Cn(Wt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${j}' queries on documentId().`);if("in"===j||"not-in"===j){uU(Y,j);const be=[];for(const Me of Y)be.push(cU(E,r,Me));se={arrayValue:{values:be}}}else se=cU(E,r,Y)}else"in"!==j&&"not-in"!==j&&"array-contains-any"!==j||uU(Y,j),se=nU(g,"where",Y,"in"===j||"not-in"===j);return ho.create(O,j,se)}(t._query,0,e,t.firestore._databaseId,this._field,this._op,this._value)}}function aU(n,t,e){const i=t,r=PM("where",n);return CS._create(r,i,e)}class K1 extends rL{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new K1(t,e)}_parse(t){const e=this._queryConstraints.map(i=>i._parse(t)).filter(i=>i.getFilters().length>0);return 1===e.length?e[0]:ms.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return 0===e.getFilters().length?t:(function(i,r){let a=i;const g=r.getFlattenedFilters();for(const E of g)hU(a,E),a=dP(a,E)}(t._query,e),new ku(t.firestore,t.converter,dP(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class oL extends xS{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new oL(t,e)}_apply(t){const e=function(i,r,a){if(null!==i.startAt)throw new Cn(Wt.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new Cn(Wt.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const g=new I1(r,a);return function(E,O){if(null===uP(E)){const j=XA(E);null!==j&&dU(0,j,O.field)}}(i,g),g}(t._query,this._field,this._direction);return new ku(t.firestore,t.converter,function(i,r){const a=i.explicitOrderBy.concat([r]);return new W_(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(t._query,e))}}class OM extends xS{constructor(t,e,i){super(),this.type=t,this._limit=e,this._limitType=i}static _create(t,e,i){return new OM(t,e,i)}_apply(t){return new ku(t.firestore,t.converter,eM(t._query,this._limit,this._limitType))}}class LM extends xS{constructor(t,e,i){super(),this.type=t,this._docOrFields=e,this._inclusive=i}static _create(t,e,i){return new LM(t,e,i)}_apply(t){const e=lU(t,this.type,this._docOrFields,this._inclusive);return new ku(t.firestore,t.converter,(r=e,new W_((i=t._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,r,i.endAt)));var i,r}}class FM extends xS{constructor(t,e,i){super(),this.type=t,this._docOrFields=e,this._inclusive=i}static _create(t,e,i){return new FM(t,e,i)}_apply(t){const e=lU(t,this.type,this._docOrFields,this._inclusive);return new ku(t.firestore,t.converter,(r=e,new W_((i=t._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,r)));var i,r}}function lU(n,t,e,i){if(e[0]=(0,Be.m9)(e[0]),e[0]instanceof wS)return function(r,a,g,E,O){if(!E)throw new Cn(Wt.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${g}().`);const j=[];for(const Y of Ub(r))if(Y.field.isKeyField())j.push(Bb(a,E.key));else{const se=E.data.field(Y.field);if(iP(se))throw new Cn(Wt.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+Y.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===se){const be=Y.field.canonicalString();throw new Cn(Wt.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${be}' (used as the orderBy) does not exist.`)}j.push(se)}return new Rv(j,O)}(n._query,n.firestore._databaseId,t,e[0]._document,i);{const r=Qb(n.firestore);return function(a,g,E,O,j,Y){const se=a.explicitOrderBy;if(j.length>se.length)throw new Cn(Wt.INVALID_ARGUMENT,`Too many arguments provided to ${O}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const be=[];for(let Me=0;Me<j.length;Me++){const Ge=j[Me];if(se[Me].field.isKeyField()){if("string"!=typeof Ge)throw new Cn(Wt.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${O}(), but got a ${typeof Ge}`);if(!hP(a)&&-1!==Ge.indexOf("/"))throw new Cn(Wt.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${O}() must be a plain document ID, but '${Ge}' contains a slash.`);const _t=a.path.child(mt.fromString(Ge));if(!Ut.isDocumentKey(_t))throw new Cn(Wt.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${O}() must result in a valid document path, but '${_t}' is not because it contains an odd number of segments.`);const Dt=new Ut(_t);be.push(Bb(g,Dt))}else{const _t=nU(E,O,Ge);be.push(_t)}}return new Rv(be,Y)}(n._query,n.firestore._databaseId,r,t,e,i)}}function cU(n,t,e){if("string"==typeof(e=(0,Be.m9)(e))){if(""===e)throw new Cn(Wt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!hP(t)&&-1!==e.indexOf("/"))throw new Cn(Wt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const i=t.path.child(mt.fromString(e));if(!Ut.isDocumentKey(i))throw new Cn(Wt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Bb(n,new Ut(i))}if(e instanceof pa)return Bb(n,e._key);throw new Cn(Wt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${CM(e)}.`)}function uU(n,t){if(!Array.isArray(n)||0===n.length)throw new Cn(Wt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(n.length>10)throw new Cn(Wt.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function hU(n,t){if(t.isInequality()){const i=XA(n),r=t.field;if(null!==i&&!i.isEqual(r))throw new Cn(Wt.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${i.toString()}' and '${r.toString()}'`);const a=uP(n);null!==a&&dU(0,r,a)}const e=function(i,r){for(const a of i)for(const g of a.getFlattenedFilters())if(r.indexOf(g.op)>=0)return g.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==e)throw new Cn(Wt.INVALID_ARGUMENT,e===t.op?`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`:`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}function dU(n,t,e){if(!e.isEqual(t))throw new Cn(Wt.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${e.toString()}' instead.`)}class sL{convertValue(t,e="none"){switch(zb(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ja(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Nb(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw fi()}}convertObject(t,e){const i={};return Fb(t.fields,(r,a)=>{i[r]=this.convertValue(a,e)}),i}convertGeoPoint(t){return new DM(ja(t.latitude),ja(t.longitude))}convertArray(t,e){return(t.values||[]).map(i=>this.convertValue(i,e))}convertServerTimestamp(t,e){switch(e){case"previous":const i=_z(t);return null==i?null:this.convertValue(i,e);case"estimate":return this.convertTimestamp(WT(t));default:return null}}convertTimestamp(t){const e=Av(t);return new ge(e.seconds,e.nanos)}convertDocumentKey(t,e){const i=mt.fromString(t);Ii(wB(i));const r=new Dv(i.get(1),i.get(3)),a=new Ut(i.popFirst(5));return r.isEqual(e)||Aa(`Document ${a} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),a}}function NM(n,t,e){let i;return i=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,i}class vq extends sL{constructor(t){super(),this.firestore=t}convertBytes(t){return new Pg(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new pa(this.firestore,null,e)}}class ew{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Q_ extends wS{constructor(t,e,i,r,a,g){super(t,e,i,r,g),this._firestore=t,this._firestoreImpl=t,this.metadata=a}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new ES(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const i=this._document.data.field(PM("DocumentSnapshot.get",t));if(null!==i)return this._userDataWriter.convertValue(i,e.serverTimestamps)}}}class ES extends Q_{data(t={}){return super.data(t)}}class Bv{constructor(t,e,i,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new ew(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach(i=>{t.call(e,new ES(this._firestore,this._userDataWriter,i.key,i,new ew(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Cn(Wt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(i,r){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(g=>({type:"added",doc:new ES(i._firestore,i._userDataWriter,g.doc.key,g.doc,new ew(i._snapshot.mutatedKeys.has(g.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:a++}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(g=>r||3!==g.type).map(g=>{const E=new ES(i._firestore,i._userDataWriter,g.doc.key,g.doc,new ew(i._snapshot.mutatedKeys.has(g.doc.key),i._snapshot.fromCache),i.query.converter);let O=-1,j=-1;return 0!==g.type&&(O=a.indexOf(g.doc.key),a=a.delete(g.doc.key)),1!==g.type&&(a=a.add(g.doc),j=a.indexOf(g.doc.key)),{type:bq(g.type),doc:E,oldIndex:O,newIndex:j}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function bq(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fi()}}function fU(n,t){return n instanceof Q_&&t instanceof Q_?n._firestore===t._firestore&&n._key.isEqual(t._key)&&(null===n._document?null===t._document:n._document.isEqual(t._document))&&n._converter===t._converter:n instanceof Bv&&t instanceof Bv&&n._firestore===t._firestore&&jO(n.query,t.query)&&n.metadata.isEqual(t.metadata)&&n._snapshot.isEqual(t._snapshot)}class Vv extends sL{constructor(t){super(),this.firestore=t}convertBytes(t){return new Pg(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new pa(this.firestore,null,e)}}function mU(n,t,e){n=po(n,pa);const i=po(n.firestore,fa),r=NM(n.converter,t,e);return Y1(i,[MM(Qb(i),"setDoc",n._key,r,null!==n.converter,e).toMutation(n._key,ba.none())])}function gU(n,t,e,...i){n=po(n,pa);const r=po(n.firestore,fa),a=Qb(r);let g;return g="string"==typeof(t=(0,Be.m9)(t))||t instanceof Y_?tL(a,"updateDoc",n._key,t,e,i):eL(a,"updateDoc",n._key,t),Y1(r,[g.toMutation(n._key,ba.exists(!0))])}function aL(n,...t){var e,i,r;n=(0,Be.m9)(n);let a={includeMetadataChanges:!1},g=0;"object"!=typeof t[g]||QO(t[g])||(a=t[g],g++);const E={includeMetadataChanges:a.includeMetadataChanges};if(QO(t[g])){const se=t[g];t[g]=null===(e=se.next)||void 0===e?void 0:e.bind(se),t[g+1]=null===(i=se.error)||void 0===i?void 0:i.bind(se),t[g+2]=null===(r=se.complete)||void 0===r?void 0:r.bind(se)}let O,j,Y;if(n instanceof pa)j=po(n.firestore,fa),Y=A1(n._key.path),O={next:se=>{t[g]&&t[g](lL(j,n,se))},error:t[g+1],complete:t[g+2]};else{const se=po(n,ku);j=po(se.firestore,fa),Y=se._query;const be=new Vv(j);O={next:Me=>{t[g]&&t[g](new Bv(j,be,se,Me))},error:t[g+1],complete:t[g+2]},sU(n._query)}return function(se,be,Me,Ge){const _t=new TM(Ge),Dt=new fO(be,_t,Me);return se.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return cO(yield q1(se),Dt)})),()=>{_t.bc(),se.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return hO(yield q1(se),Dt)}))}}(cl(j),Y,E,O)}function Y1(n,t){return function(e,i){const r=new Fl;return e.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return function mZ(n,t,e){return vO.apply(this,arguments)}(yield YO(e),i,r)})),r.promise}(cl(n),t)}function lL(n,t,e){const i=e.docs.get(t._key),r=new Vv(n);return new Q_(n,r,t._key,i,new ew(e.hasPendingWrites,e.fromCache),t.converter)}const Mq={maxAttempts:5};class _U{constructor(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Qb(t)}set(t,e,i){this._verifyNotCommitted();const r=Uv(t,this._firestore),a=NM(r.converter,e,i),g=MM(this._dataReader,"WriteBatch.set",r._key,a,null!==r.converter,i);return this._mutations.push(g.toMutation(r._key,ba.none())),this}update(t,e,i,...r){this._verifyNotCommitted();const a=Uv(t,this._firestore);let g;return g="string"==typeof(e=(0,Be.m9)(e))||e instanceof Y_?tL(this._dataReader,"WriteBatch.update",a._key,e,i,r):eL(this._dataReader,"WriteBatch.update",a._key,e),this._mutations.push(g.toMutation(a._key,ba.exists(!0))),this}delete(t){this._verifyNotCommitted();const e=Uv(t,this._firestore);return this._mutations=this._mutations.concat(new P1(e._key,ba.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Cn(Wt.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Uv(n,t){if((n=(0,Be.m9)(n)).firestore!==t)throw new Cn(Wt.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class kq extends class{constructor(t,e){this._firestore=t,this._transaction=e,this._dataReader=Qb(t)}get(t){const e=Uv(t,this._firestore),i=new vq(this._firestore);return this._transaction.lookup([e._key]).then(r=>{if(!r||1!==r.length)return fi();const a=r[0];if(a.isFoundDocument())return new wS(this._firestore,i,a.key,a,e.converter);if(a.isNoDocument())return new wS(this._firestore,i,e._key,null,e.converter);throw fi()})}set(t,e,i){const r=Uv(t,this._firestore),a=NM(r.converter,e,i),g=MM(this._dataReader,"Transaction.set",r._key,a,null!==r.converter,i);return this._transaction.set(r._key,g),this}update(t,e,i,...r){const a=Uv(t,this._firestore);let g;return g="string"==typeof(e=(0,Be.m9)(e))||e instanceof Y_?tL(this._dataReader,"Transaction.update",a._key,e,i,r):eL(this._dataReader,"Transaction.update",a._key,e),this._transaction.update(a._key,g),this}delete(t){const e=Uv(t,this._firestore);return this._transaction.delete(e._key),this}}{constructor(t,e){super(t,e),this._firestore=t}get(t){const e=Uv(t,this._firestore),i=new Vv(this._firestore);return super.get(t).then(r=>new Q_(this._firestore,i,e._key,r._document,new ew(!1,!1),e.converter))}}function yU(){return new bS("deleteField")}!function(n,t=!0){Tv=Pe.SDK_VERSION,(0,Pe._registerComponent)(new He.wA("firestore",(e,{instanceIdentifier:i,options:r})=>{const a=e.getProvider("app").getImmediate(),g=new fa(new lz(e.getProvider("auth-internal")),new x(e.getProvider("app-check-internal")),function(E,O){if(!Object.prototype.hasOwnProperty.apply(E.options,["projectId"]))throw new Cn(Wt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Dv(E.options.projectId,O)}(a,i),a);return r=Object.assign({useFetchStreams:t},r),g._setSettings(r),g},"PUBLIC").setMultipleInstances(!0)),(0,Pe.registerVersion)(HT,"3.8.3",n),(0,Pe.registerVersion)(HT,"3.8.3","esm2017")}();var Nq={includeMetadataChanges:!1};function Gq(n,t){return void 0===t&&(t={}),function jq(n){return function cL(n,t){return void 0===t&&(t=Nq),new w.y(function(e){return{unsubscribe:aL(n,t,{next:e.next.bind(e),error:e.error.bind(e),complete:e.complete.bind(e)})}})}(n,{includeMetadataChanges:!0}).pipe((0,M.U)(function(t){return t.docs}))}(n).pipe((0,M.U)(function(e){return e.map(function(i){return function bU(n,t){void 0===t&&(t={});var e=n.data();return!n.exists()||"object"!=typeof e||null===e||t.idField&&(e[t.idField]=n.id),e}(i,t)})}))}class zM{constructor(t){return t}}const EU="firestore",dL=new o.OlP("angularfire2.firestore-instances");function Zq(n){return(t,e)=>{const i=t.runOutsideAngular(()=>n(e));return new zM(i)}}const qq={provide:class $q{constructor(){return(0,jr.vb)(EU)}},deps:[[new o.FiY,dL]]},Kq={provide:zM,useFactory:function Wq(n,t){const e=(0,jr.JM)(EU,n,t);return e&&new zM(e)},deps:[[new o.FiY,dL],s]};let Yq=(()=>{class n{constructor(){(0,l.KN)("angularfire",jr.q4.full,"fst")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({providers:[Kq,qq]}),n})();const Qq=(0,jr.u3)(Gq,!0),Xq=(0,jr.u3)(HO,!0),e7=(0,jr.u3)(yU,!0),t7=(0,jr.u3)(KZ,!0),n7=(0,jr.u3)(J_,!0),r7=(0,jr.u3)(aU,!0);Ee(9568);var o7=Ee(4159),s7=Ee.n(o7);Ee(2125),Ee(5473),Ee(9812),Ee(7792),Ee(2910),function(){(function(){var n,e,t="function"==typeof Object.create?Object.create:function(u){function b(){}return b.prototype=u,new b};if("function"==typeof Object.setPrototypeOf)e=Object.setPrototypeOf;else{var i;e:{var a={};try{a.__proto__={xb:!0},i=a.xb;break e}catch{}i=!1}e=i?function(u,b){if(u.__proto__=b,u.__proto__!==b)throw new TypeError(u+" is not extensible");return u}:null}var g=e;function E(u,b){if(u.prototype=t(b.prototype),u.prototype.constructor=u,g)g(u,b);else for(var A in b)if("prototype"!=A)if(Object.defineProperties){var B=Object.getOwnPropertyDescriptor(b,A);B&&Object.defineProperty(u,A,B)}else u[A]=b[A];u.K=b.prototype}var O="function"==typeof Object.defineProperties?Object.defineProperty:function(u,b,A){u!=Array.prototype&&u!=Object.prototype&&(u[b]=A.value)},j=typeof window<"u"&&window===this?this:typeof global<"u"&&null!=global?global:this;function Y(u,b){if(b){var A=j;u=u.split(".");for(var B=0;B<u.length-1;B++){var K=u[B];K in A||(A[K]={}),A=A[K]}(b=b(B=A[u=u[u.length-1]]))!=B&&null!=b&&O(A,u,{configurable:!0,writable:!0,value:b})}}Y("Object.is",function(u){return u||function(b,A){return b===A?0!==b||1/b==1/A:b!=b&&A!=A}}),Y("Array.prototype.includes",function(u){return u||function(b,A){var B=this;B instanceof String&&(B=String(B));var K=B.length;for(0>(A=A||0)&&(A=Math.max(A+K,0));A<K;A++){var X=B[A];if(X===b||Object.is(X,b))return!0}return!1}});var se=this;function be(u){return void 0!==u}function Me(u){return"string"==typeof u}var Ge=/^[\w+/_-]+[=]{0,2}$/,_t=null;function Dt(){}function _n(u){u.W=void 0,u.Xa=function(){return u.W?u.W:u.W=new u}}function Ln(u){var b=typeof u;if("object"==b){if(!u)return"null";if(u instanceof Array)return"array";if(u instanceof Object)return b;var A=Object.prototype.toString.call(u);if("[object Window]"==A)return"object";if("[object Array]"==A||"number"==typeof u.length&&typeof u.splice<"u"&&typeof u.propertyIsEnumerable<"u"&&!u.propertyIsEnumerable("splice"))return"array";if("[object Function]"==A||typeof u.call<"u"&&typeof u.propertyIsEnumerable<"u"&&!u.propertyIsEnumerable("call"))return"function"}else if("function"==b&&typeof u.call>"u")return"object";return b}function Bn(u){return"array"==Ln(u)}function Un(u){var b=Ln(u);return"array"==b||"object"==b&&"number"==typeof u.length}function ii(u){return"function"==Ln(u)}function si(u){var b=typeof u;return"object"==b&&null!=u||"function"==b}var _r="closure_uid_"+(1e9*Math.random()>>>0),Ds=0;function ka(u,b,A){return u.call.apply(u.bind,arguments)}function Ou(u,b,A){if(!u)throw Error();if(2<arguments.length){var B=Array.prototype.slice.call(arguments,2);return function(){var K=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(K,B),u.apply(b,K)}}return function(){return u.apply(b,arguments)}}function Zo(u,b,A){return(Zo=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ka:Ou).apply(null,arguments)}function xp(u,b){var A=Array.prototype.slice.call(arguments,1);return function(){var B=A.slice();return B.push.apply(B,arguments),u.apply(this,B)}}function No(u,b){for(var A in b)u[A]=b[A]}var Ji,Fg=Date.now||function(){return+new Date};function Hs(u,b){u=u.split(".");var B,A=se;u[0]in A||typeof A.execScript>"u"||A.execScript("var "+u[0]);for(;u.length&&(B=u.shift());)!u.length&&be(b)?A[B]=b:A=A[B]&&A[B]!==Object.prototype[B]?A[B]:A[B]={}}function Sn(u,b){function A(){}A.prototype=b.prototype,u.K=b.prototype,u.prototype=new A,u.prototype.constructor=u,u.vc=function(B,K,X){for(var Se=Array(arguments.length-2),et=2;et<arguments.length;et++)Se[et-2]=arguments[et];return b.prototype[K].apply(B,Se)}}function yi(u){if(Error.captureStackTrace)Error.captureStackTrace(this,yi);else{var b=Error().stack;b&&(this.stack=b)}u&&(this.message=String(u))}function oo(u,b){for(var A="",B=(u=u.split("%s")).length-1,K=0;K<B;K++)A+=u[K]+(K<b.length?b[K]:"%s");yi.call(this,A+u[B])}function As(u,b){throw new oo("Failure"+(u?": "+u:""),Array.prototype.slice.call(arguments,1))}Sn(yi,Error),yi.prototype.name="CustomError",Sn(oo,yi),oo.prototype.name="AssertionError";var Cp=Array.prototype.indexOf?function(u,b){return Array.prototype.indexOf.call(u,b,void 0)}:function(u,b){if(Me(u))return Me(b)&&1==b.length?u.indexOf(b,0):-1;for(var A=0;A<u.length;A++)if(A in u&&u[A]===b)return A;return-1},wc=Array.prototype.forEach?function(u,b,A){Array.prototype.forEach.call(u,b,A)}:function(u,b,A){for(var B=u.length,K=Me(u)?u.split(""):u,X=0;X<B;X++)X in K&&b.call(A,K[X],X,u)},ma=Array.prototype.filter?function(u,b){return Array.prototype.filter.call(u,b,void 0)}:function(u,b){for(var A=u.length,B=[],K=0,X=Me(u)?u.split(""):u,Se=0;Se<A;Se++)if(Se in X){var et=X[Se];b.call(void 0,et,Se,u)&&(B[K++]=et)}return B},Ek=Array.prototype.map?function(u,b){return Array.prototype.map.call(u,b,void 0)}:function(u,b){for(var A=u.length,B=Array(A),K=Me(u)?u.split(""):u,X=0;X<A;X++)X in K&&(B[X]=b.call(void 0,K[X],X,u));return B},NF=Array.prototype.some?function(u,b){return Array.prototype.some.call(u,b,void 0)}:function(u,b){for(var A=u.length,B=Me(u)?u.split(""):u,K=0;K<A;K++)if(K in B&&b.call(void 0,B[K],K,u))return!0;return!1};function gs(u,b){return 0<=Cp(u,b)}function zg(u,b){var A;return(A=0<=(b=Cp(u,b)))&&Lu(u,b),A}function Lu(u,b){return 1==Array.prototype.splice.call(u,b,1).length}function A5(u){return Array.prototype.concat.apply([],arguments)}function M5(u){var b=u.length;if(0<b){for(var A=Array(b),B=0;B<b;B++)A[B]=u[B];return A}return[]}function rae(u,b,A){return 2>=arguments.length?Array.prototype.slice.call(u,b):Array.prototype.slice.call(u,b,A)}var Ep=String.prototype.trim?function(u){return u.trim()}:function(u){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(u)[1]},oae=/&/g,sae=/</g,aae=/>/g,lae=/"/g,cae=/'/g,uae=/\x00/g,hae=/[\x00&<>"']/;function zF(u,b){return u<b?-1:u>b?1:0}function bC(u){return hae.test(u)&&(-1!=u.indexOf("&")&&(u=u.replace(oae,"&amp;")),-1!=u.indexOf("<")&&(u=u.replace(sae,"&lt;")),-1!=u.indexOf(">")&&(u=u.replace(aae,"&gt;")),-1!=u.indexOf('"')&&(u=u.replace(lae,"&quot;")),-1!=u.indexOf("'")&&(u=u.replace(cae,"&#39;")),-1!=u.indexOf("\0")&&(u=u.replace(uae,"&#0;"))),u}function k5(u,b,A){for(var B in u)b.call(A,u[B],B,u)}function BF(u){var A,b={};for(A in u)b[A]=u[A];return b}var R5="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Tk(u,b){for(var A,B,K=1;K<arguments.length;K++){for(A in B=arguments[K])u[A]=B[A];for(var X=0;X<R5.length;X++)A=R5[X],Object.prototype.hasOwnProperty.call(B,A)&&(u[A]=B[A])}}var wC="StopIteration"in se?se.StopIteration:{message:"StopIteration",stack:""};function _w(){}function P5(u){if(u instanceof _w)return u;if("function"==typeof u.ha)return u.ha(!1);if(Un(u)){var b=0,A=new _w;return A.next=function(){for(;;){if(b>=u.length)throw wC;if(b in u)return u[b++];b++}},A}throw Error("Not implemented")}function Sk(u,b){this.g={},this.a=[],this.j=this.h=0;var A=arguments.length;if(1<A){if(A%2)throw Error("Uneven number of arguments");for(var B=0;B<A;B+=2)this.set(arguments[B],arguments[B+1])}else if(u)if(u instanceof Sk)for(A=u.ja(),B=0;B<A.length;B++)this.set(A[B],u.get(A[B]));else for(B in u)this.set(B,u[B])}function Ik(u){if(u.h!=u.a.length){for(var b=0,A=0;b<u.a.length;){var B=u.a[b];yw(u.g,B)&&(u.a[A++]=B),b++}u.a.length=A}if(u.h!=u.a.length){var K={};for(A=b=0;b<u.a.length;)yw(K,B=u.a[b])||(u.a[A++]=B,K[B]=1),b++;u.a.length=A}}function yw(u,b){return Object.prototype.hasOwnProperty.call(u,b)}_w.prototype.next=function(){throw wC},_w.prototype.ha=function(){return this},(n=Sk.prototype).la=function(){Ik(this);for(var u=[],b=0;b<this.a.length;b++)u.push(this.g[this.a[b]]);return u},n.ja=function(){return Ik(this),this.a.concat()},n.clear=function(){this.g={},this.j=this.h=this.a.length=0},n.get=function(u,b){return yw(this.g,u)?this.g[u]:b},n.set=function(u,b){yw(this.g,u)||(this.h++,this.a.push(u),this.j++),this.g[u]=b},n.forEach=function(u,b){for(var A=this.ja(),B=0;B<A.length;B++){var K=A[B],X=this.get(K);u.call(b,X,K,this)}},n.ha=function(u){Ik(this);var b=0,A=this.j,B=this,K=new _w;return K.next=function(){if(A!=B.j)throw Error("The map has changed since the iterator was created");if(b>=B.a.length)throw wC;var X=B.a[b++];return u?X:B.g[X]},K};var fae=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function O5(u,b,A,B){for(var K=A.length;0<=(b=u.indexOf(A,b))&&b<B;){var X=u.charCodeAt(b-1);if(!(38!=X&&63!=X||(X=u.charCodeAt(b+K))&&61!=X&&38!=X&&35!=X))return b;b+=K+1}return-1}var L5=/#|$/;function Dk(u,b){var A=u.search(L5),B=O5(u,0,b,A);if(0>B)return null;var K=u.indexOf("&",B);return(0>K||K>A)&&(K=A),B+=b.length+1,decodeURIComponent(u.substr(B,K-B).replace(/\+/g," "))}var gae=/[?&]($|#)/;function Zv(u,b){var A;this.h=this.A=this.j="",this.C=null,this.s=this.g="",this.i=!1,u instanceof Zv?(this.i=be(b)?b:u.i,VF(this,u.j),this.A=u.A,this.h=u.h,UF(this,u.C),this.g=u.g,HF(this,z5(u.a)),this.s=u.s):u&&(A=String(u).match(fae))?(this.i=!!b,VF(this,A[1]||"",!0),this.A=fI(A[2]||""),this.h=fI(A[3]||"",!0),UF(this,A[4]),this.g=fI(A[5]||"",!0),HF(this,A[6]||"",!0),this.s=fI(A[7]||"")):(this.i=!!b,this.a=new gI(null,this.i))}function VF(u,b,A){u.j=A?fI(b,!0):b,u.j&&(u.j=u.j.replace(/:$/,""))}function UF(u,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error("Bad port number "+b);u.C=b}else u.C=null}function HF(u,b,A){b instanceof gI?(u.a=b,function xae(u,b){b&&!u.j&&(qv(u),u.h=null,u.a.forEach(function(A,B){var K=B.toLowerCase();B!=K&&(vw(this,B),vw(this,K),0<A.length&&(this.h=null,this.a.set(xC(this,K),M5(A)),this.g+=A.length))},u)),u.j=b}(u.a,u.i)):(A||(b=mI(b,bae)),u.a=new gI(b,u.i))}function jF(u){return u instanceof Zv?new Zv(u):new Zv(u,void 0)}function fI(u,b){return u?b?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function mI(u,b,A){return Me(u)?(u=encodeURI(u).replace(b,_ae),A&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function _ae(u){return"%"+((u=u.charCodeAt(0))>>4&15).toString(16)+(15&u).toString(16)}Zv.prototype.toString=function(){var u=[],b=this.j;b&&u.push(mI(b,F5,!0),":");var A=this.h;return(A||"file"==b)&&(u.push("//"),(b=this.A)&&u.push(mI(b,F5,!0),"@"),u.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(A=this.C)&&u.push(":",String(A))),(A=this.g)&&(this.h&&"/"!=A.charAt(0)&&u.push("/"),u.push(mI(A,"/"==A.charAt(0)?vae:yae,!0))),(A=this.a.toString())&&u.push("?",A),(A=this.s)&&u.push("#",mI(A,wae)),u.join("")};var F5=/[#\/\?@]/g,yae=/[#\?:]/g,vae=/[#\?]/g,bae=/[#\?@]/g,wae=/#/g;function gI(u,b){this.g=this.a=null,this.h=u||null,this.j=!!b}function qv(u){u.a||(u.a=new Sk,u.g=0,u.h&&function mae(u,b){if(u){u=u.split("&");for(var A=0;A<u.length;A++){var B=u[A].indexOf("="),K=null;if(0<=B){var X=u[A].substring(0,B);K=u[A].substring(B+1)}else X=u[A];b(X,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}(u.h,function(b,A){u.add(decodeURIComponent(b.replace(/\+/g," ")),A)}))}function vw(u,b){qv(u),b=xC(u,b),yw(u.a.g,b)&&(u.h=null,u.g-=u.a.get(b).length,yw((u=u.a).g,b)&&(delete u.g[b],u.h--,u.j++,u.a.length>2*u.h&&Ik(u)))}function N5(u,b){return qv(u),b=xC(u,b),yw(u.a.g,b)}function z5(u){var b=new gI;return b.h=u.h,u.a&&(b.a=new Sk(u.a),b.g=u.g),b}function xC(u,b){return b=String(b),u.j&&(b=b.toLowerCase()),b}function bw(u){this.a=jF(u)}function B5(u){return u.a.a.get(zl.Pa)||null}function V5(u,b){b?u.a.a.set(zl.PROVIDER_ID,b):vw(u.a.a,zl.PROVIDER_ID)}(n=gI.prototype).add=function(u,b){qv(this),this.h=null,u=xC(this,u);var A=this.a.get(u);return A||this.a.set(u,A=[]),A.push(b),this.g+=1,this},n.clear=function(){this.a=this.h=null,this.g=0},n.forEach=function(u,b){qv(this),this.a.forEach(function(A,B){wc(A,function(K){u.call(b,K,B,this)},this)},this)},n.ja=function(){qv(this);for(var u=this.a.la(),b=this.a.ja(),A=[],B=0;B<b.length;B++)for(var K=u[B],X=0;X<K.length;X++)A.push(b[B]);return A},n.la=function(u){qv(this);var b=[];if(Me(u))N5(this,u)&&(b=A5(b,this.a.get(xC(this,u))));else{u=this.a.la();for(var A=0;A<u.length;A++)b=A5(b,u[A])}return b},n.set=function(u,b){return qv(this),this.h=null,N5(this,u=xC(this,u))&&(this.g-=this.a.get(u).length),this.a.set(u,[b]),this.g+=1,this},n.get=function(u,b){return u&&0<(u=this.la(u)).length?String(u[0]):b},n.toString=function(){if(this.h)return this.h;if(!this.a)return"";for(var u=[],b=this.a.ja(),A=0;A<b.length;A++){var B=b[A],K=encodeURIComponent(String(B));B=this.la(B);for(var X=0;X<B.length;X++){var Se=K;""!==B[X]&&(Se+="="+encodeURIComponent(String(B[X]))),u.push(Se)}}return this.h=u.join("&")},bw.prototype.toString=function(){return this.a.toString()};var CC,zl={Pa:"ui_auid",lc:"apiKey",Qa:"ui_sd",ub:"mode",$a:"oobCode",PROVIDER_ID:"ui_pid",Sa:"ui_sid",vb:"tenantId"};e:{var U5=se.navigator;if(U5){var H5=U5.userAgent;if(H5){CC=H5;break e}}CC=""}function so(u){return-1!=CC.indexOf(u)}function j5(){return(so("Chrome")||so("CriOS"))&&!so("Edge")}function GF(u){return GF[" "](u),u}GF[" "]=Dt;var Ak,u,G5=so("Opera"),$a=so("Trident")||so("MSIE"),Kv=so("Edge"),Sae=Kv||$a,pm=so("Gecko")&&!(-1!=CC.toLowerCase().indexOf("webkit")&&!so("Edge"))&&!(so("Trident")||so("MSIE"))&&!so("Edge"),Kh=-1!=CC.toLowerCase().indexOf("webkit")&&!so("Edge"),Iae=Kh&&so("Mobile"),Yv=so("Macintosh");function $5(){var u=se.document;return u?u.documentMode:void 0}e:{var $F="",WF=(u=CC,pm?/rv:([^\);]+)(\)|;)/.exec(u):Kv?/Edge\/([\d\.]+)/.exec(u):$a?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(u):Kh?/WebKit\/(\S+)/.exec(u):G5?/(?:Version)[ \/]?(\S+)/.exec(u):void 0);if(WF&&($F=WF?WF[1]:""),$a){var ZF=$5();if(null!=ZF&&ZF>parseFloat($F)){Ak=String(ZF);break e}}Ak=$F}var Dae={};function ww(u){return function Tae(u,b){var A=Dae;return Object.prototype.hasOwnProperty.call(A,u)?A[u]:A[u]=b(u)}(u,function(){for(var b=0,A=Ep(String(Ak)).split("."),B=Ep(String(u)).split("."),K=Math.max(A.length,B.length),X=0;0==b&&X<K;X++){var Se=A[X]||"",et=B[X]||"";do{if(Se=/(\d*)(\D*)(.*)/.exec(Se)||["","","",""],et=/(\d*)(\D*)(.*)/.exec(et)||["","","",""],0==Se[0].length&&0==et[0].length)break;b=zF(0==Se[1].length?0:parseInt(Se[1],10),0==et[1].length?0:parseInt(et[1],10))||zF(0==Se[2].length,0==et[2].length)||zF(Se[2],et[2]),Se=Se[3],et=et[3]}while(0==b)}return 0<=b})}var _I,W5=se.document;function EC(u,b){this.a=u===q5&&b||"",this.g=Z5}_I=W5&&$a?$5()||("CSS1Compat"==W5.compatMode?parseInt(Ak,10):5):void 0,EC.prototype.ma=!0,EC.prototype.ka=function(){return this.a},EC.prototype.toString=function(){return"Const{"+this.a+"}"};var Z5={},q5={};function xw(){this.a="",this.h=Y5}function K5(u){return u instanceof xw&&u.constructor===xw&&u.h===Y5?u.a:(As("expected object of type TrustedResourceUrl, got '"+u+"' of type "+Ln(u)),"type_error:TrustedResourceUrl")}xw.prototype.ma=!0,xw.prototype.ka=function(){return this.a.toString()},xw.prototype.g=function(){return 1},xw.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Y5={};function Tp(){this.a="",this.h=X5}function Jv(u){return u instanceof Tp&&u.constructor===Tp&&u.h===X5?u.a:(As("expected object of type SafeUrl, got '"+u+"' of type "+Ln(u)),"type_error:SafeUrl")}Tp.prototype.ma=!0,Tp.prototype.ka=function(){return this.a.toString()},Tp.prototype.g=function(){return 1},Tp.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var J5=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Mk(u){return u instanceof Tp?u:(u="object"==typeof u&&u.ma?u.ka():String(u),J5.test(u)||(u="about:invalid#zClosurez"),qF(u))}function Q5(u){return u instanceof Tp?u:(u="object"==typeof u&&u.ma?u.ka():String(u),J5.test(u)||(u="about:invalid#zClosurez"),qF(u))}var X5={};function qF(u){var b=new Tp;return b.a=u,b}function TC(){this.a="",this.g=eH}qF("about:blank"),TC.prototype.ma=!0;var eH={};function Qv(){this.a="",this.j=tH,this.h=null}function kk(u){return u instanceof Qv&&u.constructor===Qv&&u.j===tH?u.a:(As("expected object of type SafeHtml, got '"+u+"' of type "+Ln(u)),"type_error:SafeHtml")}TC.prototype.ka=function(){return this.a},TC.prototype.toString=function(){return"SafeStyle{"+this.a+"}"},Qv.prototype.g=function(){return this.h},Qv.prototype.ma=!0,Qv.prototype.ka=function(){return this.a.toString()},Qv.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var tH={};function yI(u,b){var A=new Qv;return A.a=u,A.h=b,A}yI("<!DOCTYPE html>",0);var Mae=yI("",0);yI("<br>",0);var A,b,kae=(b=!1,function(){return b||(A=function(){if(typeof document>"u")return!1;var u=document.createElement("div"),b=document.createElement("div");return b.appendChild(document.createElement("div")),u.appendChild(b),!!u.firstChild&&(b=u.firstChild.firstChild,u.innerHTML=kk(Mae),!b.parentElement)}(),b=!0),A});function SC(u,b){b=b instanceof Tp?b:Q5(b),u.assign(Jv(b))}function Xv(u,b){this.a=be(u)?u:0,this.g=be(b)?b:0}function KF(u,b){this.width=u,this.height=b}function Rk(u){return u?new XF(vI(u)):Ji||(Ji=new XF)}function YF(u,b){var A=b||document;return A.querySelectorAll&&A.querySelector?A.querySelectorAll("."+u):nH(document,u,b)}function JF(u,b){var A=b||document;if(A.getElementsByClassName)u=A.getElementsByClassName(u)[0];else{A=document;var B=b||A;u=B.querySelectorAll&&B.querySelector&&u?B.querySelector(u?"."+u:""):nH(A,u,b)[0]||null}return u||null}function nH(u,b,A){var B;if((u=A||u).querySelectorAll&&u.querySelector&&b)return u.querySelectorAll(b?"."+b:"");if(b&&u.getElementsByClassName){var K=u.getElementsByClassName(b);return K}if(K=u.getElementsByTagName("*"),b){var X={};for(A=B=0;u=K[A];A++){var Se=u.className;"function"==typeof Se.split&&gs(Se.split(/\s+/),b)&&(X[B++]=u)}return X.length=B,X}return K}Xv.prototype.toString=function(){return"("+this.a+", "+this.g+")"},Xv.prototype.ceil=function(){return this.a=Math.ceil(this.a),this.g=Math.ceil(this.g),this},Xv.prototype.floor=function(){return this.a=Math.floor(this.a),this.g=Math.floor(this.g),this},Xv.prototype.round=function(){return this.a=Math.round(this.a),this.g=Math.round(this.g),this},(n=KF.prototype).toString=function(){return"("+this.width+" x "+this.height+")"},n.aspectRatio=function(){return this.width/this.height},n.ceil=function(){return this.width=Math.ceil(this.width),this.height=Math.ceil(this.height),this},n.floor=function(){return this.width=Math.floor(this.width),this.height=Math.floor(this.height),this},n.round=function(){return this.width=Math.round(this.width),this.height=Math.round(this.height),this};var iH={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Pk(u){return u.scrollingElement?u.scrollingElement:(Kh||"CSS1Compat"!=u.compatMode)&&u.body||u.documentElement}function Cw(u){u&&u.parentNode&&u.parentNode.removeChild(u)}function vI(u){return 9==u.nodeType?u:u.ownerDocument||u.document}function QF(u,b){if("textContent"in u)u.textContent=b;else if(3==u.nodeType)u.data=String(b);else if(u.firstChild&&3==u.firstChild.nodeType){for(;u.lastChild!=u.firstChild;)u.removeChild(u.lastChild);u.firstChild.data=String(b)}else{for(var A;A=u.firstChild;)u.removeChild(A);u.appendChild(vI(u).createTextNode(String(b)))}}function rH(u,b){return b?function Oae(u,b){for(;u;){if(b(u))return u;u=u.parentNode}return null}(u,function(A){return!b||Me(A.className)&&gs(A.className.split(/\s+/),b)}):null}function XF(u){this.a=u||se.document||document}XF.prototype.N=function(){return Me(void 0)?this.a.getElementById(void 0):void 0};var Ok={Fc:!0},oH={Hc:!0},Lae={Ec:!0},sH={Gc:!0};function e0(){throw Error("Do not instantiate directly")}function bI(u,b,A,B){if(u=u(b||zae,void 0,A),B=(B||Rk()).a.createElement("DIV"),(u=function Fae(u){if(!si(u))return bC(String(u));if(u instanceof e0){if(u.fa===Ok)return u.content;if(u.fa===sH)return bC(u.content)}return As("Soy template output is unsafe for use as HTML: "+u),"zSoyz"}(u)).match(Nae),u=yI(u,null),kae())for(;B.lastChild;)B.removeChild(B.lastChild);return B.innerHTML=kk(u),1==B.childNodes.length&&1==(u=B.firstChild).nodeType&&(B=u),B}e0.prototype.va=null,e0.prototype.toString=function(){return this.content};var Nae=/^<(body|caption|col|colgroup|head|html|tr|td|th|tbody|thead|tfoot)>/i,zae={};function Lk(){e0.call(this)}function cr(u){return null!=u&&u.fa===Ok?u:u instanceof Qv?gi(kk(u).toString(),u.g()):gi(bC(String(String(u))),function Bae(u){if(null!=u)switch(u.va){case 1:return 1;case-1:return-1;case 0:return 0}return null}(u))}function Fk(){e0.call(this)}function Nk(u,b){this.content=String(u),this.va=b??null}function zo(u){return new Nk(u,void 0)}Sn(Lk,e0),Lk.prototype.fa=Ok,Sn(Fk,e0),Fk.prototype.fa=oH,Fk.prototype.va=1,Sn(Nk,e0),Nk.prototype.fa=sH;var gi=function(u){function b(A){this.content=A}return b.prototype=u.prototype,function(A,B){return A=new b(String(A)),void 0!==B&&(A.va=B),A}}(Lk),Vae=function(u){function b(A){this.content=A}return b.prototype=u.prototype,function(A){return new b(String(A))}}(Fk);function Wa(u){return(u=String(u))?new Nk(u,void 0):""}var aH=function(u){function b(A){this.content=A}return b.prototype=u.prototype,function(A,B){return(A=String(A))?(A=new b(A),void 0!==B&&(A.va=B),A):""}}(Lk);function Yh(u){return null!=u&&u.fa===Ok?String(String(u.content).replace(qae,"").replace(Kae,"&lt;")).replace($ae,jae):bC(String(u))}function Ew(u){return null!=u&&u.fa===oH?u=String(u).replace(tN,eN):u instanceof Tp?u=String(Jv(u).toString()).replace(tN,eN):(u=String(u),Zae.test(u)?u=u.replace(tN,eN):(As("Bad value `%s` for |filterNormalizeUri",[u]),u="#zSoyz")),u}function lH(u){return null!=u&&u.fa===Lae?u=u.content:null==u?u="":u instanceof TC?u instanceof TC&&u.constructor===TC&&u.g===eH?u=u.a:(As("expected object of type SafeStyle, got '"+u+"' of type "+Ln(u)),u="type_error:SafeStyle"):(u=String(u),Wae.test(u)||(As("Bad value `%s` for |filterCssValue",[u]),u="zSoyz")),u}var Hae={"\0":"&#0;","\t":"&#9;","\n":"&#10;","\v":"&#11;","\f":"&#12;","\r":"&#13;"," ":"&#32;",'"':"&quot;","&":"&amp;","'":"&#39;","-":"&#45;","/":"&#47;","<":"&lt;","=":"&#61;",">":"&gt;","`":"&#96;","\x85":"&#133;","\xa0":"&#160;","\u2028":"&#8232;","\u2029":"&#8233;"};function jae(u){return Hae[u]}var Gae={"\0":"%00","\x01":"%01","\x02":"%02","\x03":"%03","\x04":"%04","\x05":"%05","\x06":"%06","\x07":"%07","\b":"%08","\t":"%09","\n":"%0A","\v":"%0B","\f":"%0C","\r":"%0D","\x0e":"%0E","\x0f":"%0F","\x10":"%10","\x11":"%11","\x12":"%12","\x13":"%13","\x14":"%14","\x15":"%15","\x16":"%16","\x17":"%17","\x18":"%18","\x19":"%19","\x1a":"%1A","\x1b":"%1B","\x1c":"%1C","\x1d":"%1D","\x1e":"%1E","\x1f":"%1F"," ":"%20",'"':"%22","'":"%27","(":"%28",")":"%29","<":"%3C",">":"%3E","\\":"%5C","{":"%7B","}":"%7D","\x7f":"%7F","\x85":"%C2%85","\xa0":"%C2%A0","\u2028":"%E2%80%A8","\u2029":"%E2%80%A9","\uff01":"%EF%BC%81","\uff03":"%EF%BC%83","\uff04":"%EF%BC%84","\uff06":"%EF%BC%86","\uff07":"%EF%BC%87","\uff08":"%EF%BC%88","\uff09":"%EF%BC%89","\uff0a":"%EF%BC%8A","\uff0b":"%EF%BC%8B","\uff0c":"%EF%BC%8C","\uff0f":"%EF%BC%8F","\uff1a":"%EF%BC%9A","\uff1b":"%EF%BC%9B","\uff1d":"%EF%BC%9D","\uff1f":"%EF%BC%9F","\uff20":"%EF%BC%A0","\uff3b":"%EF%BC%BB","\uff3d":"%EF%BC%BD"};function eN(u){return Gae[u]}var $ae=/[\x00\x22\x27\x3c\x3e]/g,tN=/[\x00- \x22\x27-\x29\x3c\x3e\\\x7b\x7d\x7f\x85\xa0\u2028\u2029\uff01\uff03\uff04\uff06-\uff0c\uff0f\uff1a\uff1b\uff1d\uff1f\uff20\uff3b\uff3d]/g,Wae=/^(?!-*(?:expression|(?:moz-)?binding))(?:[.#]?-?(?:[_a-z0-9-]+)(?:-[_a-z0-9-]+)*-?|-?(?:[0-9]+(?:\.[0-9]*)?|\.[0-9]+)(?:[a-z]{1,2}|%)?|!important|)$/i,Zae=/^(?![^#?]*\/(?:\.|%2E){2}(?:[\/?#]|$))(?:(?:https?|mailto):|[^&:\/?#]*(?:[\/?#]|$))/i,qae=/<(?:!|\/?([a-zA-Z][a-zA-Z0-9:\-]*))(?:[^>'"]|"[^"]*"|'[^']*')*>/g,Kae=/</g;function nN(){return zo("Enter a valid phone number")}function cH(){return zo("Unable to send password reset code to specified email")}function uH(){return zo("Something went wrong. Please try again.")}function hH(){return zo("This email already exists without any means of sign-in. Please reset the password to recover.")}function dH(u){var b="";switch((u=u||{}).code){case"invalid-argument":b+="Client specified an invalid argument.";break;case"invalid-configuration":b+="Client specified an invalid project configuration.";break;case"failed-precondition":b+="Request can not be executed in the current system state.";break;case"out-of-range":b+="Client specified an invalid range.";break;case"unauthenticated":b+="Request not authenticated due to missing, invalid, or expired OAuth token.";break;case"permission-denied":b+="Client does not have sufficient permission.";break;case"not-found":b+="Specified resource is not found.";break;case"aborted":b+="Concurrency conflict, such as read-modify-write conflict.";break;case"already-exists":b+="The resource that a client tried to create already exists.";break;case"resource-exhausted":b+="Either out of resource quota or reaching rate limiting.";break;case"cancelled":b+="Request cancelled by the client.";break;case"data-loss":b+="Unrecoverable data loss or data corruption.";break;case"unknown":b+="Unknown server error.";break;case"internal":b+="Internal server error.";break;case"not-implemented":b+="API method not implemented by the server.";break;case"unavailable":b+="Service unavailable.";break;case"deadline-exceeded":b+="Request deadline exceeded.";break;case"auth/user-disabled":b+="The user account has been disabled by an administrator.";break;case"auth/timeout":b+="The operation has timed out.";break;case"auth/too-many-requests":b+="We have blocked all requests from this device due to unusual activity. Try again later.";break;case"auth/quota-exceeded":b+="The quota for this operation has been exceeded. Try again later.";break;case"auth/network-request-failed":b+="A network error has occurred. Try again later.";break;case"restart-process":b+="An issue was encountered when authenticating your request. Please visit the URL that redirected you to this page again to restart the authentication process.";break;case"no-matching-tenant-for-email":b+="No sign-in provider is available for the given email, please try with a different email."}return zo(b)}function wI(u,b,A){var B=Error.call(this);this.message=B.message,"stack"in B&&(this.stack=B.stack),this.code=Yae+u,(u=b)||("firebaseui/merge-conflict"===(u="",this.code)?u+="The current anonymous user failed to upgrade. The non-anonymous credential is already associated with a different user account.":u+=uH(),u=zo(u).toString()),this.message=u||"",this.credential=A||null}E(wI,Error),wI.prototype.toJSON=function(){return{code:this.code,message:this.message}};var Yae="firebaseui/";function Tw(){0!=iN&&(fH[this[_r]||(this[_r]=++Ds)]=this),this.T=this.T,this.C=this.C}var iN=0,fH={};function xI(u,b){u.T?be(void 0)?b.call(void 0):b():(u.C||(u.C=[]),u.C.push(be(void 0)?Zo(b,void 0):b))}function CI(u){u&&"function"==typeof u.m&&u.m()}Tw.prototype.T=!1,Tw.prototype.m=function(){if(!this.T&&(this.T=!0,this.o(),0!=iN)){var u=this[_r]||(this[_r]=++Ds);if(0!=iN&&this.C&&0<this.C.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete fH[u]}},Tw.prototype.o=function(){if(this.C)for(;this.C.length;)this.C.shift()()};var Jae=Object.freeze||function(u){return u},mH=!$a||9<=Number(_I),Qae=$a&&!ww("9"),Xae=function(){if(!se.addEventListener||!Object.defineProperty)return!1;var u=!1,b=Object.defineProperty({},"passive",{get:function(){u=!0}});try{se.addEventListener("test",Dt,b),se.removeEventListener("test",Dt,b)}catch{}return u}();function ty(u,b){this.type=u,this.g=this.target=b,this.h=!1,this.qb=!0}function Jh(u,b){if(ty.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.j=this.keyCode=0,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,u){var A=this.type=u.type,B=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=b,b=u.relatedTarget){if(pm){e:{try{GF(b.nodeName);var K=!0;break e}catch{}K=!1}K||(b=null)}}else"mouseover"==A?b=u.fromElement:"mouseout"==A&&(b=u.toElement);this.relatedTarget=b,B?(this.clientX=void 0!==B.clientX?B.clientX:B.pageX,this.clientY=void 0!==B.clientY?B.clientY:B.pageY,this.screenX=B.screenX||0,this.screenY=B.screenY||0):(this.clientX=void 0!==u.clientX?u.clientX:u.pageX,this.clientY=void 0!==u.clientY?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.keyCode=u.keyCode||0,this.key=u.key||"",this.j=u.charCode||("keypress"==A?u.keyCode:0),this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=Me(u.pointerType)?u.pointerType:ele[u.pointerType]||"",this.a=u,u.defaultPrevented&&this.preventDefault()}}ty.prototype.stopPropagation=function(){this.h=!0},ty.prototype.preventDefault=function(){this.qb=!1},Sn(Jh,ty);var ele=Jae({2:"touch",3:"pen",4:"mouse"});Jh.prototype.stopPropagation=function(){Jh.K.stopPropagation.call(this),this.a.stopPropagation?this.a.stopPropagation():this.a.cancelBubble=!0},Jh.prototype.preventDefault=function(){Jh.K.preventDefault.call(this);var u=this.a;if(u.preventDefault)u.preventDefault();else if(u.returnValue=!1,Qae)try{(u.ctrlKey||112<=u.keyCode&&123>=u.keyCode)&&(u.keyCode=-1)}catch{}};var EI="closure_listenable_"+(1e6*Math.random()|0),tle=0;function nle(u,b,A,B,K){this.listener=u,this.proxy=null,this.src=b,this.type=A,this.capture=!!B,this.La=K,this.key=++tle,this.sa=this.Ia=!1}function zk(u){u.sa=!0,u.listener=null,u.proxy=null,u.src=null,u.La=null}function Bk(u){this.src=u,this.a={},this.g=0}function rN(u,b){var A=b.type;A in u.a&&zg(u.a[A],b)&&(zk(b),0==u.a[A].length&&(delete u.a[A],u.g--))}function oN(u,b,A,B){for(var K=0;K<u.length;++K){var X=u[K];if(!X.sa&&X.listener==b&&X.capture==!!A&&X.La==B)return K}return-1}Bk.prototype.add=function(u,b,A,B,K){var X=u.toString();(u=this.a[X])||(u=this.a[X]=[],this.g++);var Se=oN(u,b,B,K);return-1<Se?(b=u[Se],A||(b.Ia=!1)):((b=new nle(b,this.src,X,!!B,K)).Ia=A,u.push(b)),b};var sN="closure_lm_"+(1e6*Math.random()|0),aN={};function fm(u,b,A,B,K){if(B&&B.once)return TI(u,b,A,B,K);if(Bn(b)){for(var X=0;X<b.length;X++)fm(u,b[X],A,B,K);return null}return A=cN(A),u&&u[EI]?u.J.add(String(b),A,!1,si(B)?!!B.capture:!!B,K):_H(u,b,A,!1,B,K)}function _H(u,b,A,B,K,X){if(!b)throw Error("Invalid event type");var Se=si(K)?!!K.capture:!!K,et=Vk(u);if(et||(u[sN]=et=new Bk(u)),(A=et.add(b,A,B,Se,X)).proxy)return A;if(B=function ile(){var u=rle,b=mH?function(A){return u.call(b.src,b.listener,A)}:function(A){if(!(A=u.call(b.src,b.listener,A)))return A};return b}(),A.proxy=B,B.src=u,B.listener=A,u.addEventListener)Xae||(K=Se),void 0===K&&(K=!1),u.addEventListener(b.toString(),B,K);else if(u.attachEvent)u.attachEvent(yH(b.toString()),B);else{if(!u.addListener||!u.removeListener)throw Error("addEventListener and attachEvent are unavailable.");u.addListener(B)}return A}function TI(u,b,A,B,K){if(Bn(b)){for(var X=0;X<b.length;X++)TI(u,b[X],A,B,K);return null}return A=cN(A),u&&u[EI]?u.J.add(String(b),A,!0,si(B)?!!B.capture:!!B,K):_H(u,b,A,!0,B,K)}function Sw(u,b,A,B,K){if(Bn(b))for(var X=0;X<b.length;X++)Sw(u,b[X],A,B,K);else B=si(B)?!!B.capture:!!B,A=cN(A),u&&u[EI]?(u=u.J,(b=String(b).toString())in u.a&&-1<(A=oN(X=u.a[b],A,B,K))&&(zk(X[A]),Lu(X,A),0==X.length&&(delete u.a[b],u.g--))):u&&(u=Vk(u))&&(b=u.a[b.toString()],u=-1,b&&(u=oN(b,A,B,K)),(A=-1<u?b[u]:null)&&t0(A))}function t0(u){if("number"!=typeof u&&u&&!u.sa){var b=u.src;if(b&&b[EI])rN(b.J,u);else{var A=u.type,B=u.proxy;b.removeEventListener?b.removeEventListener(A,B,u.capture):b.detachEvent?b.detachEvent(yH(A),B):b.addListener&&b.removeListener&&b.removeListener(B),(A=Vk(b))?(rN(A,u),0==A.g&&(A.src=null,b[sN]=null)):zk(u)}}}function yH(u){return u in aN?aN[u]:aN[u]="on"+u}function vH(u,b,A,B){var K=!0;if((u=Vk(u))&&(b=u.a[b.toString()]))for(b=b.concat(),u=0;u<b.length;u++){var X=b[u];X&&X.capture==A&&!X.sa&&(X=bH(X,B),K=K&&!1!==X)}return K}function bH(u,b){var A=u.listener,B=u.La||u.src;return u.Ia&&t0(u),A.call(B,b)}function rle(u,b){if(u.sa)return!0;if(!mH){if(!b)e:{b=["window","event"];for(var A=se,B=0;B<b.length;B++)if(null==(A=A[b[B]])){b=null;break e}b=A}if(b=new Jh(B=b,this),A=!0,!(0>B.keyCode||null!=B.returnValue)){e:{var K=!1;if(0==B.keyCode)try{B.keyCode=-1;break e}catch{K=!0}(K||null==B.returnValue)&&(B.returnValue=!0)}for(B=[],K=b.g;K;K=K.parentNode)B.push(K);for(u=u.type,K=B.length-1;!b.h&&0<=K;K--){b.g=B[K];var X=vH(B[K],u,!0,b);A=A&&X}for(K=0;!b.h&&K<B.length;K++)b.g=B[K],X=vH(B[K],u,!1,b),A=A&&X}return A}return bH(u,new Jh(b,this))}function Vk(u){return(u=u[sN])instanceof Bk?u:null}var lN="__closure_events_fn_"+(1e9*Math.random()>>>0);function cN(u){return ii(u)?u:(u[lN]||(u[lN]=function(b){return u.handleEvent(b)}),u[lN])}function Bl(){Tw.call(this),this.J=new Bk(this),this.wb=this,this.Ha=null}function n0(u,b){var A,B=u.Ha;if(B)for(A=[];B;B=B.Ha)A.push(B);if(u=u.wb,B=b.type||b,Me(b))b=new ty(b,u);else if(b instanceof ty)b.target=b.target||u;else{var K=b;Tk(b=new ty(B,u),K)}if(K=!0,A)for(var X=A.length-1;!b.h&&0<=X;X--){var Se=b.g=A[X];K=Uk(Se,B,!0,b)&&K}if(b.h||(K=Uk(Se=b.g=u,B,!0,b)&&K,b.h||(K=Uk(Se,B,!1,b)&&K)),A)for(X=0;!b.h&&X<A.length;X++)K=Uk(Se=b.g=A[X],B,!1,b)&&K;return K}function Uk(u,b,A,B){if(!(b=u.J.a[String(b)]))return!0;b=b.concat();for(var K=!0,X=0;X<b.length;++X){var Se=b[X];if(Se&&!Se.sa&&Se.capture==A){var et=Se.listener,Yt=Se.La||Se.src;Se.Ia&&rN(u.J,Se),K=!1!==et.call(Yt,B)&&K}}return K&&0!=B.qb}Sn(Bl,Tw),Bl.prototype[EI]=!0,Bl.prototype.Za=function(u){this.Ha=u},Bl.prototype.removeEventListener=function(u,b,A,B){Sw(this,u,b,A,B)},Bl.prototype.o=function(){if(Bl.K.o.call(this),this.J){var A,u=this.J;for(A in u.a){for(var B=u.a[A],K=0;K<B.length;K++)zk(B[K]);delete u.a[A],u.g--}}this.Ha=null};var Sp={},wH=0;function xH(u,b){if(!u)throw Error("Event target element must be provided!");if(u=uN(u),Sp[u]&&Sp[u].length)for(var A=0;A<Sp[u].length;A++)n0(Sp[u][A],b)}function uN(u){return typeof u.a>"u"&&(u.a=wH,wH++),u.a}function Hk(u){if(!u)throw Error("Event target element must be provided!");Bl.call(this),this.a=u}function CH(u){if(!u)return!1;try{return!!u.$goog_Thenable}catch{return!1}}function hN(u,b){this.h=u,this.j=b,this.g=0,this.a=null}function EH(u,b){u.j(b),100>u.g&&(u.g++,b.next=u.a,u.a=b)}function TH(){this.g=this.a=null}E(Hk,Bl),Hk.prototype.N=function(){return this.a},Hk.prototype.register=function(){var u=uN(this.N());Sp[u]?gs(Sp[u],this)||Sp[u].push(this):Sp[u]=[this]},hN.prototype.get=function(){if(0<this.g){this.g--;var u=this.a;this.a=u.next,u.next=null}else u=this.h();return u};var pN,jk,SH=new hN(function(){return new dN},function(u){u.reset()});function sle(){var u=DH,b=null;return u.a&&(b=u.a,u.a=u.a.next,u.a||(u.g=null),b.next=null),b}function dN(){this.next=this.g=this.a=null}function IH(u){se.setTimeout(function(){throw u},0)}function fN(u,b){jk||function lle(){if(se.Promise&&se.Promise.resolve){var u=se.Promise.resolve(void 0);jk=function(){u.then(AH)}}else jk=function(){var b=AH;!ii(se.setImmediate)||se.Window&&se.Window.prototype&&!so("Edge")&&se.Window.prototype.setImmediate==se.setImmediate?(pN||(pN=function ale(){var u=se.MessageChannel;if(typeof u>"u"&&typeof window<"u"&&window.postMessage&&window.addEventListener&&!so("Presto")&&(u=function(){var K=document.createElement("IFRAME");K.style.display="none",K.src="",document.documentElement.appendChild(K);var X=K.contentWindow;(K=X.document).open(),K.write(""),K.close();var Se="callImmediate"+Math.random(),et="file:"==X.location.protocol?"*":X.location.protocol+"//"+X.location.host;K=Zo(function(Yt){("*"==et||Yt.origin==et)&&Yt.data==Se&&this.port1.onmessage()},this),X.addEventListener("message",K,!1),this.port1={},this.port2={postMessage:function(){X.postMessage(Se,et)}}}),typeof u<"u"&&!so("Trident")&&!so("MSIE")){var b=new u,A={},B=A;return b.port1.onmessage=function(){if(be(A.next)){var K=(A=A.next).gb;A.gb=null,K()}},function(K){B.next={gb:K},B=B.next,b.port2.postMessage(0)}}return typeof document<"u"&&"onreadystatechange"in document.createElement("SCRIPT")?function(K){var X=document.createElement("SCRIPT");X.onreadystatechange=function(){X.onreadystatechange=null,X.parentNode.removeChild(X),X=null,K(),K=null},document.documentElement.appendChild(X)}:function(K){se.setTimeout(K,0)}}()),pN(b)):se.setImmediate(b)}}(),mN||(jk(),mN=!0),DH.add(u,b)}TH.prototype.add=function(u,b){var A=SH.get();A.set(u,b),this.g?this.g.next=A:this.a=A,this.g=A},dN.prototype.set=function(u,b){this.a=u,this.g=b,this.next=null},dN.prototype.reset=function(){this.next=this.g=this.a=null};var mN=!1,DH=new TH;function AH(){for(var u;u=sle();){try{u.a.call(u.g)}catch(b){IH(b)}EH(SH,u)}mN=!1}function Vl(u){if(this.a=Iw,this.A=void 0,this.j=this.g=this.h=null,this.s=this.i=!1,u!=Dt)try{var b=this;u.call(void 0,function(A){Dw(b,SI,A)},function(A){if(!(A instanceof DC))try{throw A instanceof Error?A:Error("Promise rejected.")}catch{}Dw(b,ny,A)})}catch(A){Dw(this,ny,A)}}var Iw=0,SI=2,ny=3;function MH(){this.next=this.j=this.g=this.s=this.a=null,this.h=!1}MH.prototype.reset=function(){this.j=this.g=this.s=this.a=null,this.h=!1};var kH=new hN(function(){return new MH},function(u){u.reset()});function gN(u,b,A){var B=kH.get();return B.s=u,B.g=b,B.j=A,B}function Za(u){if(u instanceof Vl)return u;var b=new Vl(Dt);return Dw(b,SI,u),b}function IC(u){return new Vl(function(b,A){A(u)})}function RH(u,b){if(u.a==Iw)if(u.h){var A=u.h;if(A.g){for(var B=0,K=null,X=null,Se=A.g;Se&&(Se.h||(B++,Se.a==u&&(K=Se),!(K&&1<B)));Se=Se.next)K||(X=Se);K&&(A.a==Iw&&1==B?RH(A,b):(X?((B=X).next==A.j&&(A.j=B),B.next=B.next.next):LH(A),FH(A,K,ny,b)))}u.h=null}else Dw(u,ny,b)}function _N(u,b){u.g||u.a!=SI&&u.a!=ny||OH(u),u.j?u.j.next=b:u.g=b,u.j=b}function PH(u,b,A,B){var K=gN(null,null,null);return K.a=new Vl(function(X,Se){K.s=b?function(et){try{var Yt=b.call(B,et);X(Yt)}catch(Fn){Se(Fn)}}:X,K.g=A?function(et){try{var Yt=A.call(B,et);!be(Yt)&&et instanceof DC?Se(et):X(Yt)}catch(Fn){Se(Fn)}}:Se}),K.a.h=u,_N(u,K),K.a}function Dw(u,b,A){if(u.a==Iw){u===A&&(b=ny,A=new TypeError("Promise cannot resolve to itself")),u.a=1;e:{var B=A,K=u.hc,X=u.ic;if(B instanceof Vl){_N(B,gN(K||Dt,X||null,u));var Se=!0}else if(CH(B))B.then(K,X,u),Se=!0;else{if(si(B))try{var et=B.then;if(ii(et)){(function cle(u,b,A,B,K){function X(Yt){et||(et=!0,B.call(K,Yt))}var et=!1;try{b.call(u,function Se(Yt){et||(et=!0,A.call(K,Yt))},X)}catch(Yt){X(Yt)}})(B,et,K,X,u),Se=!0;break e}}catch(Yt){X.call(u,Yt),Se=!0;break e}Se=!1}}Se||(u.A=A,u.a=b,u.h=null,OH(u),b!=ny||A instanceof DC||function ule(u,b){u.s=!0,fN(function(){u.s&&zH.call(null,b)})}(u,A))}}function OH(u){u.i||(u.i=!0,fN(u.Hb,u))}function LH(u){var b=null;return u.g&&(u.g=(b=u.g).next,b.next=null),u.g||(u.j=null),b}function FH(u,b,A,B){if(A==ny&&b.g&&!b.h)for(;u&&u.s;u=u.h)u.s=!1;if(b.a)b.a.h=null,NH(b,A,B);else try{b.h?b.s.call(b.j):NH(b,A,B)}catch(K){zH.call(null,K)}EH(kH,b)}function NH(u,b,A){b==SI?u.s.call(u.j,A):u.g&&u.g.call(u.j,A)}Vl.prototype.then=function(u,b,A){return PH(this,ii(u)?u:null,ii(b)?b:null,A)},Vl.prototype.$goog_Thenable=!0,(n=Vl.prototype).fc=function(u,b){return(u=gN(u,u,b)).h=!0,_N(this,u),this},n.Ca=function(u,b){return PH(this,null,u,b)},n.cancel=function(u){this.a==Iw&&fN(function(){RH(this,new DC(u))},this)},n.hc=function(u){this.a=Iw,Dw(this,SI,u)},n.ic=function(u){this.a=Iw,Dw(this,ny,u)},n.Hb=function(){for(var u;u=LH(this);)FH(this,u,this.a,this.A);this.i=!1};var zH=IH;function DC(u){yi.call(this,u)}function BH(u,b,A){b||(b={}),A=A||window;var B=u instanceof Tp?u:Mk(typeof u.href<"u"?u.href:String(u));u=b.target||u.target;var K=[];for(X in b)switch(X){case"width":case"height":case"top":case"left":K.push(X+"="+b[X]);break;case"target":case"noopener":case"noreferrer":break;default:K.push(X+"="+(b[X]?1:0))}var X=K.join(",");return(so("iPhone")&&!so("iPod")&&!so("iPad")||so("iPad")||so("iPod"))&&A.navigator&&A.navigator.standalone&&u&&"_self"!=u?(X=A.document.createElement("A"),B=B instanceof Tp?B:Q5(B),X.href=Jv(B),X.setAttribute("target",u),b.noreferrer&&X.setAttribute("rel","noreferrer"),(b=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,A,1),X.dispatchEvent(b),A={}):b.noreferrer?(A=A.open("",u,X),b=Jv(B).toString(),A&&(Sae&&-1!=b.indexOf(";")&&(b="'"+b.replace(/'/g,"%27")+"'"),A.opener=null,b=yI('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+bC(b)+'">',null),A.document.write(kk(b)),A.document.close())):(A=A.open(Jv(B).toString(),u,X))&&b.noopener&&(A.opener=null),A}function VH(){try{return!(!window.opener||!window.opener.location||window.opener.location.hostname!==window.location.hostname||window.opener.location.protocol!==window.location.protocol)}catch{}return!1}function AC(u){BH(u,{target:window.cordova&&window.cordova.InAppBrowser?"_system":"_blank"},void 0)}function Gk(u,b){if(null==(u=si(u)&&1==u.nodeType?u:document.querySelector(String(u))))throw Error(b||"Cannot find element.");return u}function iy(){return window.location.href}function r0(u){var b=gle;this.s=[],this.T=b,this.O=u||null,this.j=this.a=!1,this.h=void 0,this.J=this.l=this.A=!1,this.i=0,this.g=null,this.C=0}function II(u,b,A){u.a=!0,u.h=A,u.j=!b,jH(u)}function $k(u){if(u.a){if(!u.J)throw new Wk(u);u.J=!1}}function UH(u,b,A){u.s.push([b,A,void 0]),u.a&&jH(u)}function HH(u){return NF(u.s,function(b){return ii(b[1])})}function jH(u){if(u.i&&u.a&&HH(u)){var b=u.i,A=Zk[b];A&&(se.clearTimeout(A.a),delete Zk[b]),u.i=0}u.g&&(u.g.C--,delete u.g),b=u.h;for(var B=A=!1;u.s.length&&!u.A;){var K=u.s.shift(),X=K[0],Se=K[1];if(K=K[2],X=u.j?Se:X)try{var et=X.call(K||u.O,b);be(et)&&(u.j=u.j&&(et==b||et instanceof Error),u.h=b=et),(CH(b)||"function"==typeof se.Promise&&b instanceof se.Promise)&&(B=!0,u.A=!0)}catch(Yt){b=Yt,u.j=!0,HH(u)||(A=!0)}}u.h=b,B&&(et=Zo(u.L,u,!0),B=Zo(u.L,u,!1),b instanceof r0?(UH(b,et,B),b.l=!0):b.then(et,B)),A&&(b=new GH(b),Zk[b.a]=b,u.i=b.a)}function Wk(){yi.call(this)}function DI(){yi.call(this)}function GH(u){this.a=se.setTimeout(Zo(this.h,this),0),this.g=u}Sn(DC,yi),DC.prototype.name="cancel",r0.prototype.cancel=function(u){if(this.a)this.h instanceof r0&&this.h.cancel();else{if(this.g){var b=this.g;delete this.g,u?b.cancel(u):(b.C--,0>=b.C&&b.cancel())}this.T?this.T.call(this.O,this):this.J=!0,this.a||(u=new DI(this),$k(this),II(this,!1,u))}},r0.prototype.L=function(u,b){this.A=!1,II(this,u,b)},r0.prototype.callback=function(u){$k(this),II(this,!0,u)},r0.prototype.then=function(u,b,A){var B,K,X=new Vl(function(Se,et){B=Se,K=et});return UH(this,B,function(Se){Se instanceof DI?X.cancel():K(Se)}),X.then(u,b,A)},r0.prototype.$goog_Thenable=!0,Sn(Wk,yi),Wk.prototype.message="Deferred has already fired",Wk.prototype.name="AlreadyCalledError",Sn(DI,yi),DI.prototype.message="Deferred was canceled",DI.prototype.name="CanceledError",GH.prototype.h=function(){throw delete Zk[this.a],this.g};var Zk={};function gle(){if(this&&this.rb){var u=this.rb;u&&"SCRIPT"==u.tagName&&qk(u,!0,this.sb)}}function qk(u,b,A){null!=A&&se.clearTimeout(A),u.onload=Dt,u.onerror=Dt,u.onreadystatechange=Dt,b&&window.setTimeout(function(){Cw(u)},0)}var _le=0,yle=1;function yN(u,b){var A="Jsloader error (code #"+u+")";b&&(A+=": "+b),yi.call(this,A),this.code=u}function AI(){return se.google&&se.google.accounts&&se.google.accounts.id||null}function vN(u){this.a=u||AI(),this.h=!1,this.g=null}function $H(u,b,A){return u.a&&b?(u.h=!0,new Vl(function(K){u.g=K,u.a.initialize({client_id:b,callback:K,auto_select:!A}),u.a.prompt()})):Za(b?bN.Xa().load().then(function(){return u.a=AI(),$H(u,b,A)}).Ca(function(){return null}):null)}Sn(yN,yi),vN.prototype.cancel=function(){this.a&&this.h&&(this.g&&this.g(null),this.a.cancel())},_n(vN);var vle=new EC(q5,"https://accounts.google.com/gsi/client");function bN(){this.a=null}function wN(u,b){this.a=u,this.g=b||function(A){throw A}}function xN(u,b,A){this.reset(u,b,A,void 0,void 0)}function CN(u){this.s=u,this.a=this.h=this.j=this.g=null}function Kk(u,b){this.name=u,this.value=b}bN.prototype.load=function(){var u=this;if(this.a)return this.a;var b=function Aae(){var u=vle;u instanceof EC&&u.constructor===EC&&u.g===Z5?u=u.a:(As("expected object of type Const, got '"+u+"'"),u="type_error:Const");var b=new xw;return b.a=u,b}();return AI()?Za():this.a=function hle(){var u=null;return new Vl(function(b){"complete"==se.document.readyState?b():(u=function(){b()},TI(window,"load",u))}).Ca(function(b){throw Sw(window,"load",u),b})}().then(function(){if(!AI())return new Vl(function(A,B){var K=setTimeout(function(){u.a=null,B(Error("Network error!"))},1e4);se.onGoogleLibraryLoad=function(){clearTimeout(K),A()},Za(function fle(u){var b={},A=b.document||document,B=K5(u).toString(),K=document.createElement("SCRIPT"),X={rb:K,sb:void 0},Se=new r0(X),et=null,Yt=null!=b.timeout?b.timeout:5e3;return 0<Yt&&(et=window.setTimeout(function(){qk(K,!0);var Fn=new yN(yle,"Timeout reached for loading script "+B);$k(Se),II(Se,!1,Fn)},Yt),X.sb=et),K.onload=K.onreadystatechange=function(){K.readyState&&"loaded"!=K.readyState&&"complete"!=K.readyState||(qk(K,b.xc||!1,et),Se.callback(null))},K.onerror=function(){qk(K,!0,et);var Fn=new yN(_le,"Error while loading script "+B);$k(Se),II(Se,!1,Fn)},Tk(X=b.attributes||{},{type:"text/javascript",charset:"UTF-8"}),function Pae(u,b){k5(b,function(A,B){A&&"object"==typeof A&&A.ma&&(A=A.ka()),"style"==B?u.style.cssText=A:"class"==B?u.className=A:"for"==B?u.htmlFor=A:iH.hasOwnProperty(B)?u.setAttribute(iH[B],A):0==B.lastIndexOf("aria-",0)||0==B.lastIndexOf("data-",0)?u.setAttribute(B,A):u[B]=A})}(K,X),function Rae(u,b){u.src=K5(b),null===_t&&(_t=(b=(b=se.document).querySelector&&b.querySelector("script[nonce]"))&&(b=b.nonce||b.getAttribute("nonce"))&&Ge.test(b)?b:""),(b=_t)&&u.setAttribute("nonce",b)}(K,u),function mle(u){var b=(u||document).getElementsByTagName("HEAD");return b&&0!=b.length?b[0]:u.documentElement}(A).appendChild(K),Se}(b)).then(function(){AI()&&A()}).Ca(function(X){clearTimeout(K),u.a=null,B(X)})})})},_n(bN),wN.prototype.confirm=function(u){return Za(this.a.confirm(u)).Ca(this.g)},xN.prototype.a=null,xN.prototype.reset=function(u,b,A,B,K){this.h=B||Fg(),this.j=u,this.s=b,this.g=A,delete this.a},Kk.prototype.toString=function(){return this.name};var WH=new Kk("SEVERE",1e3),ZH=new Kk("WARNING",900),qH=new Kk("CONFIG",700);function KH(u){return u.j?u.j:u.g?KH(u.g):(As("Root logger has no level set."),null)}CN.prototype.log=function(u,b,A){if(u.value>=KH(this).value)for(ii(b)&&(b=b()),u=new xN(u,String(b),this.s),A&&(u.a=A),A=this;A;){var B=A,K=u;if(B.a)for(var X=0;b=B.a[X];X++)b(K);A=A.g}};var EN={},MI=null;function YH(){MI||(MI=new CN(""),EN[""]=MI,MI.j=qH)}function Yk(){this.a=Fg()}var TN=null;function kI(u){this.j=u||"",TN||(TN=new Yk),this.s=TN}function Aw(u){return 10>u?"0"+u:String(u)}function QH(u){kI.call(this,u)}function XH(){this.s=Zo(this.h,this),this.a=new QH,this.a.g=!1,this.a.h=!1,this.g=this.a.a=!1,this.j={}}Yk.prototype.set=function(u){this.a=u},Yk.prototype.reset=function(){this.set(Fg())},Yk.prototype.get=function(){return this.a},kI.prototype.a=!0,kI.prototype.g=!0,kI.prototype.h=!1,Sn(QH,kI),XH.prototype.h=function(u){if(!this.j[u.g]){var A=function xle(u,b){var A=[];if(A.push(u.j," "),u.g){var B=new Date(b.h);A.push("[",Aw(B.getFullYear()-2e3)+Aw(B.getMonth()+1)+Aw(B.getDate())+" "+Aw(B.getHours())+":"+Aw(B.getMinutes())+":"+Aw(B.getSeconds())+"."+Aw(Math.floor(B.getMilliseconds()/10)),"] ")}return A.push("[",function wle(u,b){b=(u=(u.h-b)/1e3).toFixed(3);var A=0;if(1>u)A=2;else for(;100>u;)A++,u*=10;for(;0<A--;)b=" "+b;return b}(b,u.s.get()),"s] "),A.push("[",b.g,"] "),A.push(b.s),u.h&&(b=b.a)&&A.push("\n",b instanceof Error?b.message:b.toString()),u.a&&A.push("\n"),A.join("")}(this.a,u);Cle&&function Ele(u,b,A,B){u[b]?u[b](A,B||""):u.log(A,B||"")}(Cle,function b(X){if(X){if(X.value>=WH.value)return"error";if(X.value>=ZH.value)return"warn";if(X.value>=qH.value)return"log"}return"debug"}(u.j),A,u.a)}};var SN,Cle=se.console;function Ip(u,b){SN&&SN.log(WH,u,b)}SN=function JH(u){var b;if(YH(),!(b=EN[u])){b=new CN(u);var A=u.lastIndexOf("."),B=u.substr(A+1);(A=JH(u.substr(0,A))).h||(A.h={}),A.h[B]=b,b.g=A,EN[u]=b}return b}("firebaseui");var IN=new XH;if(1!=IN.g){var Jk;YH();var Tle=IN.s;(Jk=MI).a||(Jk.a=[]),Jk.a.push(Tle),IN.g=!0}function o0(u){SN&&SN.log(ZH,u,void 0)}function ej(){this.a=(typeof document>"u"?null:document)||{cookie:""}}function DN(u){u=(u.a.cookie||"").split(";");for(var B,K,b=[],A=[],X=0;X<u.length;X++)-1==(B=(K=Ep(u[X])).indexOf("="))?(b.push(""),A.push(K)):(b.push(K.substring(0,B)),A.push(K.substring(B+1)));return{keys:b,values:A}}(n=ej.prototype).set=function(u,b,A,B,K,X){if(/[;=\s]/.test(u))throw Error('Invalid cookie name "'+u+'"');if(/[;\r\n]/.test(b))throw Error('Invalid cookie value "'+b+'"');be(A)||(A=-1),K=K?";domain="+K:"",B=B?";path="+B:"",X=X?";secure":"",A=0>A?"":0==A?";expires="+new Date(1970,1,1).toUTCString():";expires="+new Date(Fg()+1e3*A).toUTCString(),this.a.cookie=u+"="+b+K+B+A+X},n.get=function(u,b){for(var X,A=u+"=",B=(this.a.cookie||"").split(";"),K=0;K<B.length;K++){if(0==(X=Ep(B[K])).lastIndexOf(A,0))return X.substr(A.length);if(X==u)return""}return b},n.ja=function(){return DN(this).keys},n.la=function(){return DN(this).values},n.clear=function(){for(var u=DN(this).keys,b=u.length-1;0<=b;b--){var A=u[b];this.get(A),this.set(A,"",0,void 0,void 0)}};var Qk=new ej;function tj(){}function MC(u,b,A,B){this.h=typeof u<"u"&&null!==u?u:-1,this.g=b||null,this.a=A||null,this.j=!!B}function AN(u,b){this.g=u,this.a=b||null}function nj(u){return{email:u.g,credential:u.a&&u.a.toJSON()}}function ij(u){if(u&&u.email){var b=u.credential&&Gi.Z.auth.AuthCredential.fromJSON(u.credential);return new AN(u.email,b)}return null}function rj(u){this.a=u||null}function oj(u){for(var b=[],A=0,B=0;B<u.length;B++){var K=u.charCodeAt(B);255<K&&(b[A++]=255&K,K>>=8),b[A++]=K}return b}function Sle(u){return Ek(u,function(b){return 1<(b=b.toString(16)).length?b:"0"+b}).join("")}function Xk(u){for(this.i=u,this.g=this.i.length/4,this.j=this.g+6,this.h=[[],[],[],[]],this.s=[[],[],[],[]],this.a=Array(kC*(this.j+1)),u=0;u<this.g;u++)this.a[u]=[this.i[4*u],this.i[4*u+1],this.i[4*u+2],this.i[4*u+3]];var b=Array(4);for(u=this.g;u<kC*(this.j+1);u++){if(b[0]=this.a[u-1][0],b[1]=this.a[u-1][1],b[2]=this.a[u-1][2],b[3]=this.a[u-1][3],u%this.g==0){var A=b,B=A[0];A[0]=A[1],A[1]=A[2],A[2]=A[3],A[3]=B,uj(b),b[0]^=t2[u/this.g][0],b[1]^=t2[u/this.g][1],b[2]^=t2[u/this.g][2],b[3]^=t2[u/this.g][3]}else 6<this.g&&u%this.g==4&&uj(b);this.a[u]=Array(4),this.a[u][0]=this.a[u-this.g][0]^b[0],this.a[u][1]=this.a[u-this.g][1]^b[1],this.a[u][2]=this.a[u-this.g][2]^b[2],this.a[u][3]=this.a[u-this.g][3]^b[3]}}E(MC,tj),MC.prototype.set=function(u,b){Qk.set(u,b,this.h,this.g,this.a,this.j)},MC.prototype.get=function(u){return Qk.get(u)||null},MC.prototype.ra=function(u){var b=this.g,A=this.a;Qk.get(u),Qk.set(u,"",0,b,A)};var kC=(Xk.prototype.A=16)/4;function sj(u,b){for(var B=0;B<kC;B++)for(var K=0;4>K;K++)u.h[B][K]=b[4*K+B]}function aj(u){for(var b=[],A=0;A<kC;A++)for(var B=0;4>B;B++)b[4*B+A]=u.h[A][B];return b}function RC(u,b){for(var A=0;4>A;A++)for(var B=0;4>B;B++)u.h[A][B]^=u.a[4*b+B][A]}function e2(u,b){for(var A=0;4>A;A++)for(var B=0;4>B;B++)u.h[A][B]=b[u.h[A][B]]}function lj(u){for(var b=1;4>b;b++)for(var A=0;4>A;A++)u.s[b][A]=u.h[b][A];for(b=1;4>b;b++)for(A=0;4>A;A++)u.h[b][A]=u.s[b][(A+b)%kC]}function cj(u){for(var b=1;4>b;b++)for(var A=0;4>A;A++)u.s[b][(A+b)%kC]=u.h[b][A];for(b=1;4>b;b++)for(A=0;4>A;A++)u.h[b][A]=u.s[b][A]}function uj(u){u[0]=PC[u[0]],u[1]=PC[u[1]],u[2]=PC[u[2]],u[3]=PC[u[3]]}var PC=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],hj=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],t2=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]],n2=[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,118,120,122,124,126,128,130,132,134,136,138,140,142,144,146,148,150,152,154,156,158,160,162,164,166,168,170,172,174,176,178,180,182,184,186,188,190,192,194,196,198,200,202,204,206,208,210,212,214,216,218,220,222,224,226,228,230,232,234,236,238,240,242,244,246,248,250,252,254,27,25,31,29,19,17,23,21,11,9,15,13,3,1,7,5,59,57,63,61,51,49,55,53,43,41,47,45,35,33,39,37,91,89,95,93,83,81,87,85,75,73,79,77,67,65,71,69,123,121,127,125,115,113,119,117,107,105,111,109,99,97,103,101,155,153,159,157,147,145,151,149,139,137,143,141,131,129,135,133,187,185,191,189,179,177,183,181,171,169,175,173,163,161,167,165,219,217,223,221,211,209,215,213,203,201,207,205,195,193,199,197,251,249,255,253,243,241,247,245,235,233,239,237,227,225,231,229],r2=[0,3,6,5,12,15,10,9,24,27,30,29,20,23,18,17,48,51,54,53,60,63,58,57,40,43,46,45,36,39,34,33,96,99,102,101,108,111,106,105,120,123,126,125,116,119,114,113,80,83,86,85,92,95,90,89,72,75,78,77,68,71,66,65,192,195,198,197,204,207,202,201,216,219,222,221,212,215,210,209,240,243,246,245,252,255,250,249,232,235,238,237,228,231,226,225,160,163,166,165,172,175,170,169,184,187,190,189,180,183,178,177,144,147,150,149,156,159,154,153,136,139,142,141,132,135,130,129,155,152,157,158,151,148,145,146,131,128,133,134,143,140,137,138,171,168,173,174,167,164,161,162,179,176,181,182,191,188,185,186,251,248,253,254,247,244,241,242,227,224,229,230,239,236,233,234,203,200,205,206,199,196,193,194,211,208,213,214,223,220,217,218,91,88,93,94,87,84,81,82,67,64,69,70,79,76,73,74,107,104,109,110,103,100,97,98,115,112,117,118,127,124,121,122,59,56,61,62,55,52,49,50,35,32,37,38,47,44,41,42,11,8,13,14,7,4,1,2,19,16,21,22,31,28,25,26],o2=[0,9,18,27,36,45,54,63,72,65,90,83,108,101,126,119,144,153,130,139,180,189,166,175,216,209,202,195,252,245,238,231,59,50,41,32,31,22,13,4,115,122,97,104,87,94,69,76,171,162,185,176,143,134,157,148,227,234,241,248,199,206,213,220,118,127,100,109,82,91,64,73,62,55,44,37,26,19,8,1,230,239,244,253,194,203,208,217,174,167,188,181,138,131,152,145,77,68,95,86,105,96,123,114,5,12,23,30,33,40,51,58,221,212,207,198,249,240,235,226,149,156,135,142,177,184,163,170,236,229,254,247,200,193,218,211,164,173,182,191,128,137,146,155,124,117,110,103,88,81,74,67,52,61,38,47,16,25,2,11,215,222,197,204,243,250,225,232,159,150,141,132,187,178,169,160,71,78,85,92,99,106,113,120,15,6,29,20,43,34,57,48,154,147,136,129,190,183,172,165,210,219,192,201,246,255,228,237,10,3,24,17,46,39,60,53,66,75,80,89,102,111,116,125,161,168,179,186,133,140,151,158,233,224,251,242,205,196,223,214,49,56,35,42,21,28,7,14,121,112,107,98,93,84,79,70],s2=[0,11,22,29,44,39,58,49,88,83,78,69,116,127,98,105,176,187,166,173,156,151,138,129,232,227,254,245,196,207,210,217,123,112,109,102,87,92,65,74,35,40,53,62,15,4,25,18,203,192,221,214,231,236,241,250,147,152,133,142,191,180,169,162,246,253,224,235,218,209,204,199,174,165,184,179,130,137,148,159,70,77,80,91,106,97,124,119,30,21,8,3,50,57,36,47,141,134,155,144,161,170,183,188,213,222,195,200,249,242,239,228,61,54,43,32,17,26,7,12,101,110,115,120,73,66,95,84,247,252,225,234,219,208,205,198,175,164,185,178,131,136,149,158,71,76,81,90,107,96,125,118,31,20,9,2,51,56,37,46,140,135,154,145,160,171,182,189,212,223,194,201,248,243,238,229,60,55,42,33,16,27,6,13,100,111,114,121,72,67,94,85,1,10,23,28,45,38,59,48,89,82,79,68,117,126,99,104,177,186,167,172,157,150,139,128,233,226,255,244,197,206,211,216,122,113,108,103,86,93,64,75,34,41,52,63,14,5,24,19,202,193,220,215,230,237,240,251,146,153,132,143,190,181,168,163],a2=[0,13,26,23,52,57,46,35,104,101,114,127,92,81,70,75,208,221,202,199,228,233,254,243,184,181,162,175,140,129,150,155,187,182,161,172,143,130,149,152,211,222,201,196,231,234,253,240,107,102,113,124,95,82,69,72,3,14,25,20,55,58,45,32,109,96,119,122,89,84,67,78,5,8,31,18,49,60,43,38,189,176,167,170,137,132,147,158,213,216,207,194,225,236,251,246,214,219,204,193,226,239,248,245,190,179,164,169,138,135,144,157,6,11,28,17,50,63,40,37,110,99,116,121,90,87,64,77,218,215,192,205,238,227,244,249,178,191,168,165,134,139,156,145,10,7,16,29,62,51,36,41,98,111,120,117,86,91,76,65,97,108,123,118,85,88,79,66,9,4,19,30,61,48,39,42,177,188,171,166,133,136,159,146,217,212,195,206,237,224,247,250,183,186,173,160,131,142,153,148,223,210,197,200,235,230,241,252,103,106,125,112,83,94,73,68,15,2,21,24,59,54,33,44,12,1,22,27,56,53,34,47,100,105,126,115,80,93,74,71,220,209,198,203,232,229,242,255,180,185,174,163,128,141,154,151],l2=[0,14,28,18,56,54,36,42,112,126,108,98,72,70,84,90,224,238,252,242,216,214,196,202,144,158,140,130,168,166,180,186,219,213,199,201,227,237,255,241,171,165,183,185,147,157,143,129,59,53,39,41,3,13,31,17,75,69,87,89,115,125,111,97,173,163,177,191,149,155,137,135,221,211,193,207,229,235,249,247,77,67,81,95,117,123,105,103,61,51,33,47,5,11,25,23,118,120,106,100,78,64,82,92,6,8,26,20,62,48,34,44,150,152,138,132,174,160,178,188,230,232,250,244,222,208,194,204,65,79,93,83,121,119,101,107,49,63,45,35,9,7,21,27,161,175,189,179,153,151,133,139,209,223,205,195,233,231,245,251,154,148,134,136,162,172,190,176,234,228,246,248,210,220,206,192,122,116,102,104,66,76,94,80,10,4,22,24,50,60,46,32,236,226,240,254,212,218,200,198,156,146,128,142,164,170,184,182,12,2,16,30,52,58,40,38,124,114,96,110,68,74,88,86,55,57,43,37,15,1,19,29,71,73,91,85,127,113,99,109,215,217,203,197,239,225,243,253,167,169,187,181,159,145,131,141];function dj(u,b){u=new Xk(fj(u));for(var K,A=(b=oj(b)).splice(0,16),B="";A.length;){K=16-A.length;for(var X=0;X<K;X++)A.push(0);for(sj(K=u,A),RC(K,0),A=1;A<K.j;++A){e2(K,PC),lj(K),X=K.h;for(var Se=K.s[0],et=0;4>et;et++)Se[0]=X[0][et],Se[1]=X[1][et],Se[2]=X[2][et],Se[3]=X[3][et],X[0][et]=n2[Se[0]]^r2[Se[1]]^Se[2]^Se[3],X[1][et]=Se[0]^n2[Se[1]]^r2[Se[2]]^Se[3],X[2][et]=Se[0]^Se[1]^n2[Se[2]]^r2[Se[3]],X[3][et]=r2[Se[0]]^Se[1]^Se[2]^n2[Se[3]];RC(K,A)}e2(K,PC),lj(K),RC(K,K.j),B+=Sle(aj(K)),A=b.splice(0,16)}return B}function pj(u,b){u=new Xk(fj(u));for(var A=[],B=0;B<b.length;B+=2)A.push(parseInt(b.substring(B,B+2),16));var K=A.splice(0,16);for(b="";K.length;){for(sj(B=u,K),RC(B,B.j),K=1;K<B.j;++K){cj(B),e2(B,hj),RC(B,B.j-K);for(var X=B.h,Se=B.s[0],et=0;4>et;et++)Se[0]=X[0][et],Se[1]=X[1][et],Se[2]=X[2][et],Se[3]=X[3][et],X[0][et]=l2[Se[0]]^s2[Se[1]]^a2[Se[2]]^o2[Se[3]],X[1][et]=o2[Se[0]]^l2[Se[1]]^s2[Se[2]]^a2[Se[3]],X[2][et]=a2[Se[0]]^o2[Se[1]]^l2[Se[2]]^s2[Se[3]],X[3][et]=s2[Se[0]]^a2[Se[1]]^o2[Se[2]]^l2[Se[3]]}if(cj(B),e2(B,hj),RC(B,0),8192>=(B=aj(B)).length)B=String.fromCharCode.apply(null,B);else{for(K="",X=0;X<B.length;X+=8192)K+=String.fromCharCode.apply(null,rae(B,X,X+8192));B=K}b+=B,K=A.splice(0,16)}return b.replace(/(\x00)+$/,"")}function fj(u){for(var b=32-(u=oj(u.substring(0,32))).length,A=0;A<b;A++)u.push(0);return u}function mj(u){var b=[];return MN(new Ile,u,b),b.join("")}function Ile(){}function MN(u,b,A){if(null==b)A.push("null");else{if("object"==typeof b){if(Bn(b)){var B=b;b=B.length,A.push("[");for(var K="",X=0;X<b;X++)A.push(K),MN(u,B[X],A),K=",";return void A.push("]")}if(!(b instanceof String||b instanceof Number||b instanceof Boolean)){for(B in A.push("{"),K="",b)Object.prototype.hasOwnProperty.call(b,B)&&"function"!=typeof(X=b[B])&&(A.push(K),_j(B,A),A.push(":"),MN(u,X,A),K=",");return void A.push("}")}b=b.valueOf()}switch(typeof b){case"string":_j(b,A);break;case"number":A.push(isFinite(b)&&!isNaN(b)?String(b):"null");break;case"boolean":A.push(String(b));break;case"function":A.push("null");break;default:throw Error("Unknown type: "+typeof b)}}}var gj={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Dle=/\uffff/.test("\uffff")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function _j(u,b){b.push('"',u.replace(Dle,function(A){var B=gj[A];return B||(B="\\u"+(65536|A.charCodeAt(0)).toString(16).substr(1),gj[A]=B),B}),'"')}function RI(u){this.a=u}function c2(){}function u2(u){this.a=u}function h2(u){if(!u.a)return!1;try{return u.a.setItem("__sak","1"),u.a.removeItem("__sak"),!0}catch{return!1}}function kN(){var u=null;try{u=window.localStorage||null}catch{}this.a=u}function RN(){var u=null;try{u=window.sessionStorage||null}catch{}this.a=u}function OC(u,b){this.g=u,this.a=b+"::"}RI.prototype.set=function(u,b){be(b)?this.a.set(u,mj(b)):this.a.ra(u)},RI.prototype.get=function(u){try{var b=this.a.get(u)}catch{return}if(null!==b)try{return JSON.parse(b)}catch{throw"Storage: Invalid value was encountered"}},Sn(c2,tj),c2.prototype.clear=function(){var u=function pae(u){if(Un(u))return M5(u);u=P5(u);var b=[];return function dae(u,b){if(Un(u))try{wc(u,b,void 0)}catch(A){if(A!==wC)throw A}else{u=P5(u);try{for(;;)b.call(void 0,u.next(),void 0,u)}catch(A){if(A!==wC)throw A}}}(u,function(A){b.push(A)}),b}(this.ha(!0)),b=this;wc(u,function(A){b.ra(A)})},Sn(u2,c2),(n=u2.prototype).set=function(u,b){try{this.a.setItem(u,b)}catch{throw 0==this.a.length?"Storage mechanism: Storage disabled":"Storage mechanism: Quota exceeded"}},n.get=function(u){if(!Me(u=this.a.getItem(u))&&null!==u)throw"Storage mechanism: Invalid value was encountered";return u},n.ra=function(u){this.a.removeItem(u)},n.ha=function(u){var b=0,A=this.a,B=new _w;return B.next=function(){if(b>=A.length)throw wC;var K=A.key(b++);if(u)return K;if(!Me(K=A.getItem(K)))throw"Storage mechanism: Invalid value was encountered";return K},B},n.clear=function(){this.a.clear()},n.key=function(u){return this.a.key(u)},Sn(kN,u2),Sn(RN,u2),Sn(OC,c2),OC.prototype.set=function(u,b){this.g.set(this.a+u,b)},OC.prototype.get=function(u){return this.g.get(this.a+u)},OC.prototype.ra=function(u){this.g.ra(this.a+u)},OC.prototype.ha=function(u){var b=this.g.ha(!0),A=this,B=new _w;return B.next=function(){for(var K=b.next();K.substr(0,A.a.length)!=A.a;)K=b.next();return u?K.substr(A.a.length):A.g.get(K)},B},h2(new kN);var vj=new RN,PN=new RI(h2(vj)?new OC(vj,"firebaseui"):null),ON={name:"pendingEmailCredential",storage:PN},Mw={name:"redirectStatus",storage:PN},PI={name:"redirectUrl",storage:PN},LC={name:"emailForSignIn",storage:new RI(new MC(3600,"/"))},OI={name:"pendingEncryptedCredential",storage:new RI(new MC(3600,"/"))};function FC(u,b){return u.storage.get(b?u.name+":"+b:u.name)}function Ud(u,b){u.storage.a.ra(b?u.name+":"+b:u.name)}function NC(u,b,A){u.storage.set(A?u.name+":"+A:u.name,b)}function bj(u){return FC(PI,u)||null}function Bg(u){return ij(u=FC(ON,u)||null)}function Vg(u){Ud(ON,u)}function wj(u,b){NC(ON,nj(u),b)}function LN(u){return(u=FC(Mw,u)||null)&&typeof u.tenantId<"u"?new rj(u.tenantId):null}function FN(){this.W={}}function ul(u,b,A){if(b.toLowerCase()in u.W)throw Error("Configuration "+b+" has already been defined.");u.W[b.toLowerCase()]=A}function NN(u,b,A){if(!(b.toLowerCase()in u.W))throw Error("Configuration "+b+" is not defined.");u.W[b.toLowerCase()]=A}function zN(u,b){if(!(u=u.get(b)))throw Error("Configuration "+b+" is required.");return u}function BN(){this.g=void 0,this.a={}}function xj(u,b,A,B){for(var K=0;K<b.length;K++){var X=b.charAt(K);u.a[X]||(u.a[X]=new BN),u=u.a[X]}if(B&&void 0!==u.g)throw Error('The collection already contains the key "'+b+'"');u.g=A}function Cj(u,b){for(var A in void 0!==u.g&&b.push(u.g),u.a)Cj(u.a[A],b)}function Ej(u,b,A){for(var B in void 0!==u.g&&A.push(b),u.a)Ej(u.a[B],b+B,A)}function Tj(u){for(this.a=u,this.g=new BN,u=0;u<this.a.length;u++){var b=this.g.get("+"+this.a[u].b);b?b.push(this.a[u]):this.g.add("+"+this.a[u].b,[this.a[u]])}}function d2(u,b){var A={},B=0;for(void 0!==(u=u.g).g&&(A[B]=u.g);B<b.length;B++){var K=b.charAt(B);if(!(K in u.a))break;void 0!==(u=u.a[K]).g&&(A[B]=u.g)}for(var X in A)if(A.hasOwnProperty(X))return A[X];return[]}function kw(u){for(var b=0;b<Qh.length;b++)if(Qh[b].c===u)return Qh[b];return null}function Sj(u){u=u.toUpperCase();for(var b=[],A=0;A<Qh.length;A++)Qh[A].f===u&&b.push(Qh[A]);return b}function Ij(u){if(0<u.length&&"+"==u.charAt(0)){u=u.substring(1);for(var b=[],A=0;A<Qh.length;A++)Qh[A].b==u&&b.push(Qh[A]);u=b}else u=Sj(u);return u}function Dj(u){u.sort(function(b,A){return b.name.localeCompare(A.name,"en")})}FN.prototype.get=function(u){if(!(u.toLowerCase()in this.W))throw Error("Configuration "+u+" is not defined.");return this.W[u.toLowerCase()]},(n=BN.prototype).set=function(u,b){xj(this,u,b,!1)},n.add=function(u,b){xj(this,u,b,!0)},n.get=function(u){e:{for(var b=this,A=0;A<u.length;A++)if(!(b=b.a[u.charAt(A)])){u=void 0;break e}u=b}return u?u.g:void 0},n.la=function(){var u=[];return Cj(this,u),u},n.ja=function(){var u=[];return Ej(this,"",u),u},n.clear=function(){this.a={},this.g=void 0};var Qh=[{name:"Afghanistan",c:"93-AF-0",b:"93",f:"AF"},{name:"\xc5land Islands",c:"358-AX-0",b:"358",f:"AX"},{name:"Albania",c:"355-AL-0",b:"355",f:"AL"},{name:"Algeria",c:"213-DZ-0",b:"213",f:"DZ"},{name:"American Samoa",c:"1-AS-0",b:"1",f:"AS"},{name:"Andorra",c:"376-AD-0",b:"376",f:"AD"},{name:"Angola",c:"244-AO-0",b:"244",f:"AO"},{name:"Anguilla",c:"1-AI-0",b:"1",f:"AI"},{name:"Antigua and Barbuda",c:"1-AG-0",b:"1",f:"AG"},{name:"Argentina",c:"54-AR-0",b:"54",f:"AR"},{name:"Armenia",c:"374-AM-0",b:"374",f:"AM"},{name:"Aruba",c:"297-AW-0",b:"297",f:"AW"},{name:"Ascension Island",c:"247-AC-0",b:"247",f:"AC"},{name:"Australia",c:"61-AU-0",b:"61",f:"AU"},{name:"Austria",c:"43-AT-0",b:"43",f:"AT"},{name:"Azerbaijan",c:"994-AZ-0",b:"994",f:"AZ"},{name:"Bahamas",c:"1-BS-0",b:"1",f:"BS"},{name:"Bahrain",c:"973-BH-0",b:"973",f:"BH"},{name:"Bangladesh",c:"880-BD-0",b:"880",f:"BD"},{name:"Barbados",c:"1-BB-0",b:"1",f:"BB"},{name:"Belarus",c:"375-BY-0",b:"375",f:"BY"},{name:"Belgium",c:"32-BE-0",b:"32",f:"BE"},{name:"Belize",c:"501-BZ-0",b:"501",f:"BZ"},{name:"Benin",c:"229-BJ-0",b:"229",f:"BJ"},{name:"Bermuda",c:"1-BM-0",b:"1",f:"BM"},{name:"Bhutan",c:"975-BT-0",b:"975",f:"BT"},{name:"Bolivia",c:"591-BO-0",b:"591",f:"BO"},{name:"Bosnia and Herzegovina",c:"387-BA-0",b:"387",f:"BA"},{name:"Botswana",c:"267-BW-0",b:"267",f:"BW"},{name:"Brazil",c:"55-BR-0",b:"55",f:"BR"},{name:"British Indian Ocean Territory",c:"246-IO-0",b:"246",f:"IO"},{name:"British Virgin Islands",c:"1-VG-0",b:"1",f:"VG"},{name:"Brunei",c:"673-BN-0",b:"673",f:"BN"},{name:"Bulgaria",c:"359-BG-0",b:"359",f:"BG"},{name:"Burkina Faso",c:"226-BF-0",b:"226",f:"BF"},{name:"Burundi",c:"257-BI-0",b:"257",f:"BI"},{name:"Cambodia",c:"855-KH-0",b:"855",f:"KH"},{name:"Cameroon",c:"237-CM-0",b:"237",f:"CM"},{name:"Canada",c:"1-CA-0",b:"1",f:"CA"},{name:"Cape Verde",c:"238-CV-0",b:"238",f:"CV"},{name:"Caribbean Netherlands",c:"599-BQ-0",b:"599",f:"BQ"},{name:"Cayman Islands",c:"1-KY-0",b:"1",f:"KY"},{name:"Central African Republic",c:"236-CF-0",b:"236",f:"CF"},{name:"Chad",c:"235-TD-0",b:"235",f:"TD"},{name:"Chile",c:"56-CL-0",b:"56",f:"CL"},{name:"China",c:"86-CN-0",b:"86",f:"CN"},{name:"Christmas Island",c:"61-CX-0",b:"61",f:"CX"},{name:"Cocos [Keeling] Islands",c:"61-CC-0",b:"61",f:"CC"},{name:"Colombia",c:"57-CO-0",b:"57",f:"CO"},{name:"Comoros",c:"269-KM-0",b:"269",f:"KM"},{name:"Democratic Republic Congo",c:"243-CD-0",b:"243",f:"CD"},{name:"Republic of Congo",c:"242-CG-0",b:"242",f:"CG"},{name:"Cook Islands",c:"682-CK-0",b:"682",f:"CK"},{name:"Costa Rica",c:"506-CR-0",b:"506",f:"CR"},{name:"C\xf4te d'Ivoire",c:"225-CI-0",b:"225",f:"CI"},{name:"Croatia",c:"385-HR-0",b:"385",f:"HR"},{name:"Cuba",c:"53-CU-0",b:"53",f:"CU"},{name:"Cura\xe7ao",c:"599-CW-0",b:"599",f:"CW"},{name:"Cyprus",c:"357-CY-0",b:"357",f:"CY"},{name:"Czech Republic",c:"420-CZ-0",b:"420",f:"CZ"},{name:"Denmark",c:"45-DK-0",b:"45",f:"DK"},{name:"Djibouti",c:"253-DJ-0",b:"253",f:"DJ"},{name:"Dominica",c:"1-DM-0",b:"1",f:"DM"},{name:"Dominican Republic",c:"1-DO-0",b:"1",f:"DO"},{name:"East Timor",c:"670-TL-0",b:"670",f:"TL"},{name:"Ecuador",c:"593-EC-0",b:"593",f:"EC"},{name:"Egypt",c:"20-EG-0",b:"20",f:"EG"},{name:"El Salvador",c:"503-SV-0",b:"503",f:"SV"},{name:"Equatorial Guinea",c:"240-GQ-0",b:"240",f:"GQ"},{name:"Eritrea",c:"291-ER-0",b:"291",f:"ER"},{name:"Estonia",c:"372-EE-0",b:"372",f:"EE"},{name:"Ethiopia",c:"251-ET-0",b:"251",f:"ET"},{name:"Falkland Islands [Islas Malvinas]",c:"500-FK-0",b:"500",f:"FK"},{name:"Faroe Islands",c:"298-FO-0",b:"298",f:"FO"},{name:"Fiji",c:"679-FJ-0",b:"679",f:"FJ"},{name:"Finland",c:"358-FI-0",b:"358",f:"FI"},{name:"France",c:"33-FR-0",b:"33",f:"FR"},{name:"French Guiana",c:"594-GF-0",b:"594",f:"GF"},{name:"French Polynesia",c:"689-PF-0",b:"689",f:"PF"},{name:"Gabon",c:"241-GA-0",b:"241",f:"GA"},{name:"Gambia",c:"220-GM-0",b:"220",f:"GM"},{name:"Georgia",c:"995-GE-0",b:"995",f:"GE"},{name:"Germany",c:"49-DE-0",b:"49",f:"DE"},{name:"Ghana",c:"233-GH-0",b:"233",f:"GH"},{name:"Gibraltar",c:"350-GI-0",b:"350",f:"GI"},{name:"Greece",c:"30-GR-0",b:"30",f:"GR"},{name:"Greenland",c:"299-GL-0",b:"299",f:"GL"},{name:"Grenada",c:"1-GD-0",b:"1",f:"GD"},{name:"Guadeloupe",c:"590-GP-0",b:"590",f:"GP"},{name:"Guam",c:"1-GU-0",b:"1",f:"GU"},{name:"Guatemala",c:"502-GT-0",b:"502",f:"GT"},{name:"Guernsey",c:"44-GG-0",b:"44",f:"GG"},{name:"Guinea Conakry",c:"224-GN-0",b:"224",f:"GN"},{name:"Guinea-Bissau",c:"245-GW-0",b:"245",f:"GW"},{name:"Guyana",c:"592-GY-0",b:"592",f:"GY"},{name:"Haiti",c:"509-HT-0",b:"509",f:"HT"},{name:"Heard Island and McDonald Islands",c:"672-HM-0",b:"672",f:"HM"},{name:"Honduras",c:"504-HN-0",b:"504",f:"HN"},{name:"Hong Kong",c:"852-HK-0",b:"852",f:"HK"},{name:"Hungary",c:"36-HU-0",b:"36",f:"HU"},{name:"Iceland",c:"354-IS-0",b:"354",f:"IS"},{name:"India",c:"91-IN-0",b:"91",f:"IN"},{name:"Indonesia",c:"62-ID-0",b:"62",f:"ID"},{name:"Iran",c:"98-IR-0",b:"98",f:"IR"},{name:"Iraq",c:"964-IQ-0",b:"964",f:"IQ"},{name:"Ireland",c:"353-IE-0",b:"353",f:"IE"},{name:"Isle of Man",c:"44-IM-0",b:"44",f:"IM"},{name:"Israel",c:"972-IL-0",b:"972",f:"IL"},{name:"Italy",c:"39-IT-0",b:"39",f:"IT"},{name:"Jamaica",c:"1-JM-0",b:"1",f:"JM"},{name:"Japan",c:"81-JP-0",b:"81",f:"JP"},{name:"Jersey",c:"44-JE-0",b:"44",f:"JE"},{name:"Jordan",c:"962-JO-0",b:"962",f:"JO"},{name:"Kazakhstan",c:"7-KZ-0",b:"7",f:"KZ"},{name:"Kenya",c:"254-KE-0",b:"254",f:"KE"},{name:"Kiribati",c:"686-KI-0",b:"686",f:"KI"},{name:"Kosovo",c:"377-XK-0",b:"377",f:"XK"},{name:"Kosovo",c:"381-XK-0",b:"381",f:"XK"},{name:"Kosovo",c:"386-XK-0",b:"386",f:"XK"},{name:"Kuwait",c:"965-KW-0",b:"965",f:"KW"},{name:"Kyrgyzstan",c:"996-KG-0",b:"996",f:"KG"},{name:"Laos",c:"856-LA-0",b:"856",f:"LA"},{name:"Latvia",c:"371-LV-0",b:"371",f:"LV"},{name:"Lebanon",c:"961-LB-0",b:"961",f:"LB"},{name:"Lesotho",c:"266-LS-0",b:"266",f:"LS"},{name:"Liberia",c:"231-LR-0",b:"231",f:"LR"},{name:"Libya",c:"218-LY-0",b:"218",f:"LY"},{name:"Liechtenstein",c:"423-LI-0",b:"423",f:"LI"},{name:"Lithuania",c:"370-LT-0",b:"370",f:"LT"},{name:"Luxembourg",c:"352-LU-0",b:"352",f:"LU"},{name:"Macau",c:"853-MO-0",b:"853",f:"MO"},{name:"Macedonia",c:"389-MK-0",b:"389",f:"MK"},{name:"Madagascar",c:"261-MG-0",b:"261",f:"MG"},{name:"Malawi",c:"265-MW-0",b:"265",f:"MW"},{name:"Malaysia",c:"60-MY-0",b:"60",f:"MY"},{name:"Maldives",c:"960-MV-0",b:"960",f:"MV"},{name:"Mali",c:"223-ML-0",b:"223",f:"ML"},{name:"Malta",c:"356-MT-0",b:"356",f:"MT"},{name:"Marshall Islands",c:"692-MH-0",b:"692",f:"MH"},{name:"Martinique",c:"596-MQ-0",b:"596",f:"MQ"},{name:"Mauritania",c:"222-MR-0",b:"222",f:"MR"},{name:"Mauritius",c:"230-MU-0",b:"230",f:"MU"},{name:"Mayotte",c:"262-YT-0",b:"262",f:"YT"},{name:"Mexico",c:"52-MX-0",b:"52",f:"MX"},{name:"Micronesia",c:"691-FM-0",b:"691",f:"FM"},{name:"Moldova",c:"373-MD-0",b:"373",f:"MD"},{name:"Monaco",c:"377-MC-0",b:"377",f:"MC"},{name:"Mongolia",c:"976-MN-0",b:"976",f:"MN"},{name:"Montenegro",c:"382-ME-0",b:"382",f:"ME"},{name:"Montserrat",c:"1-MS-0",b:"1",f:"MS"},{name:"Morocco",c:"212-MA-0",b:"212",f:"MA"},{name:"Mozambique",c:"258-MZ-0",b:"258",f:"MZ"},{name:"Myanmar [Burma]",c:"95-MM-0",b:"95",f:"MM"},{name:"Namibia",c:"264-NA-0",b:"264",f:"NA"},{name:"Nauru",c:"674-NR-0",b:"674",f:"NR"},{name:"Nepal",c:"977-NP-0",b:"977",f:"NP"},{name:"Netherlands",c:"31-NL-0",b:"31",f:"NL"},{name:"New Caledonia",c:"687-NC-0",b:"687",f:"NC"},{name:"New Zealand",c:"64-NZ-0",b:"64",f:"NZ"},{name:"Nicaragua",c:"505-NI-0",b:"505",f:"NI"},{name:"Niger",c:"227-NE-0",b:"227",f:"NE"},{name:"Nigeria",c:"234-NG-0",b:"234",f:"NG"},{name:"Niue",c:"683-NU-0",b:"683",f:"NU"},{name:"Norfolk Island",c:"672-NF-0",b:"672",f:"NF"},{name:"North Korea",c:"850-KP-0",b:"850",f:"KP"},{name:"Northern Mariana Islands",c:"1-MP-0",b:"1",f:"MP"},{name:"Norway",c:"47-NO-0",b:"47",f:"NO"},{name:"Oman",c:"968-OM-0",b:"968",f:"OM"},{name:"Pakistan",c:"92-PK-0",b:"92",f:"PK"},{name:"Palau",c:"680-PW-0",b:"680",f:"PW"},{name:"Palestinian Territories",c:"970-PS-0",b:"970",f:"PS"},{name:"Panama",c:"507-PA-0",b:"507",f:"PA"},{name:"Papua New Guinea",c:"675-PG-0",b:"675",f:"PG"},{name:"Paraguay",c:"595-PY-0",b:"595",f:"PY"},{name:"Peru",c:"51-PE-0",b:"51",f:"PE"},{name:"Philippines",c:"63-PH-0",b:"63",f:"PH"},{name:"Poland",c:"48-PL-0",b:"48",f:"PL"},{name:"Portugal",c:"351-PT-0",b:"351",f:"PT"},{name:"Puerto Rico",c:"1-PR-0",b:"1",f:"PR"},{name:"Qatar",c:"974-QA-0",b:"974",f:"QA"},{name:"R\xe9union",c:"262-RE-0",b:"262",f:"RE"},{name:"Romania",c:"40-RO-0",b:"40",f:"RO"},{name:"Russia",c:"7-RU-0",b:"7",f:"RU"},{name:"Rwanda",c:"250-RW-0",b:"250",f:"RW"},{name:"Saint Barth\xe9lemy",c:"590-BL-0",b:"590",f:"BL"},{name:"Saint Helena",c:"290-SH-0",b:"290",f:"SH"},{name:"St. Kitts",c:"1-KN-0",b:"1",f:"KN"},{name:"St. Lucia",c:"1-LC-0",b:"1",f:"LC"},{name:"Saint Martin",c:"590-MF-0",b:"590",f:"MF"},{name:"Saint Pierre and Miquelon",c:"508-PM-0",b:"508",f:"PM"},{name:"St. Vincent",c:"1-VC-0",b:"1",f:"VC"},{name:"Samoa",c:"685-WS-0",b:"685",f:"WS"},{name:"San Marino",c:"378-SM-0",b:"378",f:"SM"},{name:"S\xe3o Tom\xe9 and Pr\xedncipe",c:"239-ST-0",b:"239",f:"ST"},{name:"Saudi Arabia",c:"966-SA-0",b:"966",f:"SA"},{name:"Senegal",c:"221-SN-0",b:"221",f:"SN"},{name:"Serbia",c:"381-RS-0",b:"381",f:"RS"},{name:"Seychelles",c:"248-SC-0",b:"248",f:"SC"},{name:"Sierra Leone",c:"232-SL-0",b:"232",f:"SL"},{name:"Singapore",c:"65-SG-0",b:"65",f:"SG"},{name:"Sint Maarten",c:"1-SX-0",b:"1",f:"SX"},{name:"Slovakia",c:"421-SK-0",b:"421",f:"SK"},{name:"Slovenia",c:"386-SI-0",b:"386",f:"SI"},{name:"Solomon Islands",c:"677-SB-0",b:"677",f:"SB"},{name:"Somalia",c:"252-SO-0",b:"252",f:"SO"},{name:"South Africa",c:"27-ZA-0",b:"27",f:"ZA"},{name:"South Georgia and the South Sandwich Islands",c:"500-GS-0",b:"500",f:"GS"},{name:"South Korea",c:"82-KR-0",b:"82",f:"KR"},{name:"South Sudan",c:"211-SS-0",b:"211",f:"SS"},{name:"Spain",c:"34-ES-0",b:"34",f:"ES"},{name:"Sri Lanka",c:"94-LK-0",b:"94",f:"LK"},{name:"Sudan",c:"249-SD-0",b:"249",f:"SD"},{name:"Suriname",c:"597-SR-0",b:"597",f:"SR"},{name:"Svalbard and Jan Mayen",c:"47-SJ-0",b:"47",f:"SJ"},{name:"Swaziland",c:"268-SZ-0",b:"268",f:"SZ"},{name:"Sweden",c:"46-SE-0",b:"46",f:"SE"},{name:"Switzerland",c:"41-CH-0",b:"41",f:"CH"},{name:"Syria",c:"963-SY-0",b:"963",f:"SY"},{name:"Taiwan",c:"886-TW-0",b:"886",f:"TW"},{name:"Tajikistan",c:"992-TJ-0",b:"992",f:"TJ"},{name:"Tanzania",c:"255-TZ-0",b:"255",f:"TZ"},{name:"Thailand",c:"66-TH-0",b:"66",f:"TH"},{name:"Togo",c:"228-TG-0",b:"228",f:"TG"},{name:"Tokelau",c:"690-TK-0",b:"690",f:"TK"},{name:"Tonga",c:"676-TO-0",b:"676",f:"TO"},{name:"Trinidad/Tobago",c:"1-TT-0",b:"1",f:"TT"},{name:"Tunisia",c:"216-TN-0",b:"216",f:"TN"},{name:"Turkey",c:"90-TR-0",b:"90",f:"TR"},{name:"Turkmenistan",c:"993-TM-0",b:"993",f:"TM"},{name:"Turks and Caicos Islands",c:"1-TC-0",b:"1",f:"TC"},{name:"Tuvalu",c:"688-TV-0",b:"688",f:"TV"},{name:"U.S. Virgin Islands",c:"1-VI-0",b:"1",f:"VI"},{name:"Uganda",c:"256-UG-0",b:"256",f:"UG"},{name:"Ukraine",c:"380-UA-0",b:"380",f:"UA"},{name:"United Arab Emirates",c:"971-AE-0",b:"971",f:"AE"},{name:"United Kingdom",c:"44-GB-0",b:"44",f:"GB"},{name:"United States",c:"1-US-0",b:"1",f:"US"},{name:"Uruguay",c:"598-UY-0",b:"598",f:"UY"},{name:"Uzbekistan",c:"998-UZ-0",b:"998",f:"UZ"},{name:"Vanuatu",c:"678-VU-0",b:"678",f:"VU"},{name:"Vatican City",c:"379-VA-0",b:"379",f:"VA"},{name:"Venezuela",c:"58-VE-0",b:"58",f:"VE"},{name:"Vietnam",c:"84-VN-0",b:"84",f:"VN"},{name:"Wallis and Futuna",c:"681-WF-0",b:"681",f:"WF"},{name:"Western Sahara",c:"212-EH-0",b:"212",f:"EH"},{name:"Yemen",c:"967-YE-0",b:"967",f:"YE"},{name:"Zambia",c:"260-ZM-0",b:"260",f:"ZM"},{name:"Zimbabwe",c:"263-ZW-0",b:"263",f:"ZW"}];Dj(Qh);var LI=new Tj(Qh);function Aj(u,b){this.a=u,this.Aa=b}function Mj(u){u=Ep(u);var b=d2(LI,u);return 0<b.length?new Aj("1"==b[0].b?"1-US-0":b[0].c,Ep(u.substr(b[0].b.length+1))):null}function VN(u){var b=kw(u.a);if(!b)throw Error("Country ID "+u.a+" not found.");return"+"+b.b+u.Aa}function kj(u,b){for(var A=0;A<u.length;A++)if(!gs(Rj,u[A])&&(null!==zC&&u[A]in zC||gs(b,u[A])))return u[A];return null}var Rj=["emailLink","password","phone"],zC={"facebook.com":"FacebookAuthProvider","github.com":"GithubAuthProvider","google.com":"GoogleAuthProvider",password:"EmailAuthProvider","twitter.com":"TwitterAuthProvider",phone:"PhoneAuthProvider"};function Ple(){this.a=new FN,ul(this.a,"autoUpgradeAnonymousUsers"),ul(this.a,"callbacks"),ul(this.a,"credentialHelper",m2),ul(this.a,"immediateFederatedRedirect",!1),ul(this.a,"popupMode",!1),ul(this.a,"privacyPolicyUrl"),ul(this.a,"queryParameterForSignInSuccessUrl","signInSuccessUrl"),ul(this.a,"queryParameterForWidgetMode","mode"),ul(this.a,"signInFlow"),ul(this.a,"signInOptions"),ul(this.a,"signInSuccessUrl"),ul(this.a,"siteName"),ul(this.a,"tosUrl"),ul(this.a,"widgetUrl"),ul(this.a,"adminRestrictedOperation")}function p2(u){var b=!!u.a.get("autoUpgradeAnonymousUsers");return b&&!Hj(u)&&Ip('Missing "signInFailure" callback: "signInFailure" callback needs to be provided when "autoUpgradeAnonymousUsers" is set to true.',void 0),b}function f2(u){u=u.a.get("signInOptions")||[];for(var b=[],A=0;A<u.length;A++){var B=u[A];(B=si(B)?B:{provider:B}).provider&&b.push(B)}return b}function Dp(u,b){u=f2(u);for(var A=0;A<u.length;A++)if(u[A].provider===b)return u[A];return null}function BC(u){return f2(u).map(function(b){return b.provider})}function FI(u,b){u=Pj(u);for(var A=0;A<u.length;A++)if(u[A].providerId===b)return u[A];return null}function Pj(u){return f2(u).map(function(b){if(zC[b.provider]||gs(jle,b.provider)){for(var A in b={providerId:b.provider,S:b.providerName||null,V:b.fullLabel||null,ta:b.buttonColor||null,za:b.iconUrl?Jv(Mk(b.iconUrl)).toString():null})null===b[A]&&delete b[A];return b}return{providerId:b.provider,S:b.providerName||null,V:b.fullLabel||null,ta:b.buttonColor||null,za:b.iconUrl?Jv(Mk(b.iconUrl)).toString():null,Ob:b.loginHintKey||null}})}function Oj(u){var A,b=Dp(u,Gi.Z.auth.GoogleAuthProvider.PROVIDER_ID);if(A=b&&b.clientId){e:{if("http:"===(window.location&&window.location.protocol)||"https:"===(window.location&&window.location.protocol))for(B in u=u.a.get("credentialHelper"),$N)if($N[B]===u){var B=$N[B];break e}B=m2}A=B===GN}return A&&b.clientId||null}function Lj(u){return!!((u=Dp(u,Gi.Z.auth.EmailAuthProvider.PROVIDER_ID))&&u.disableSignUp&&u.disableSignUp.status)}function Rw(u){return!(!(u=u.a.get("adminRestrictedOperation")||null)||!u.status)}function Fj(u,b){return u=(u=Dp(u,b))&&u.scopes,Array.isArray(u)?u:[]}function Nj(u,b){return si(u=(u=Dp(u,b))&&u.customParameters)?(u=BF(u),b===Gi.Z.auth.GoogleAuthProvider.PROVIDER_ID&&delete u.login_hint,b===Gi.Z.auth.GithubAuthProvider.PROVIDER_ID&&delete u.login,u):null}function UN(u){if(!(u=Dp(u,Gi.Z.auth.PhoneAuthProvider.PROVIDER_ID)))return null;var b=u.whitelistedCountries,A=u.blacklistedCountries;if(typeof b<"u"&&(!Array.isArray(b)||0==b.length))throw Error("WhitelistedCountries must be a non-empty array.");if(typeof A<"u"&&!Array.isArray(A))throw Error("BlacklistedCountries must be an array.");if(b&&A)throw Error("Both whitelistedCountries and blacklistedCountries are provided.");if(!b&&!A)return Qh;if(u=[],b){A={};for(var B=0;B<b.length;B++)for(var K=Ij(b[B]),X=0;X<K.length;X++)A[K[X].c]=K[X];for(var Se in A)A.hasOwnProperty(Se)&&u.push(A[Se])}else{for(Se={},b=0;b<A.length;b++)for(K=Ij(A[b]),B=0;B<K.length;B++)Se[K[B].c]=K[B];for(K=0;K<Qh.length;K++)null!==Se&&Qh[K].c in Se||u.push(Qh[K])}return u}function zj(u){return zN(u.a,"queryParameterForWidgetMode")}function hl(u){var b=u.a.get("tosUrl")||null;if(u=u.a.get("privacyPolicyUrl")||null,b&&!u&&o0("Privacy Policy URL is missing, the link will not be displayed."),b&&u){if("function"==typeof b)return b;if("string"==typeof b)return function(){AC(b)}}return null}function dl(u){var b=u.a.get("tosUrl")||null,A=u.a.get("privacyPolicyUrl")||null;if(A&&!b&&o0("Term of Service URL is missing, the link will not be displayed."),b&&A){if("function"==typeof A)return A;if("string"==typeof A)return function(){AC(A)}}return null}function Bj(u){return!((u=Dp(u,Gi.Z.auth.EmailAuthProvider.PROVIDER_ID))&&typeof u.requireDisplayName<"u"&&!u.requireDisplayName)}function VC(u){return!(!(u=Dp(u,Gi.Z.auth.EmailAuthProvider.PROVIDER_ID))||u.signInMethod!==Gi.Z.auth.EmailAuthProvider.EMAIL_LINK_SIGN_IN_METHOD)}function HN(u){var b=!!u.a.get("immediateFederatedRedirect"),A=BC(u);return u=Vj(u),b&&1==A.length&&!gs(Rj,A[0])&&u==g2}function Vj(u){for(var b in u=u.a.get("signInFlow"),WN)if(WN[b]==u)return WN[b];return g2}function jN(u){return NI(u).signInSuccess||null}function Uj(u){return NI(u).signInSuccessWithAuthResult||null}function Hj(u){return NI(u).signInFailure||null}function NI(u){return u.a.get("callbacks")||{}}var zI,UC,qN,jj,GN="googleyolo",m2="none",$N={nc:GN,NONE:m2},g2="redirect",WN={qc:"popup",rc:g2},ZN={mc:"callback",RECOVER_EMAIL:"recoverEmail",sc:"resetPassword",REVERT_SECOND_FACTOR_ADDITION:"revertSecondFactorAddition",tc:"select",uc:"signIn",VERIFY_AND_CHANGE_EMAIL:"verifyAndChangeEmail",VERIFY_EMAIL:"verifyEmail"},jle=["anonymous"],Gle=["sitekey","tabindex","callback","expired-callback"],Qo={};function Ei(u,b,A,B){Qo[u].apply(null,Array.prototype.slice.call(arguments,1))}function Gj(u){return u.classList?u.classList:Me(u=u.className)&&u.match(/\S+/g)||[]}function BI(u,b){return u.classList?u.classList.contains(b):gs(Gj(u),b)}function Ug(u,b){u.classList?u.classList.add(b):BI(u,b)||(u.className+=0<u.className.length?" "+b:b)}function Hg(u,b){u.classList?u.classList.remove(b):BI(u,b)&&(u.className=ma(Gj(u),function(A){return A!=b}).join(" "))}function Qc(u){var b=u.type;switch(Me(b)&&b.toLowerCase()){case"checkbox":case"radio":return u.checked?u.value:null;case"select-one":return 0<=(b=u.selectedIndex)?u.options[b].value:null;case"select-multiple":b=[];for(var A,B=0;A=u.options[B];B++)A.selected&&b.push(A.value);return b.length?b:null;default:return null!=u.value?u.value:null}}function $j(u,b){var A=u.type;switch(Me(A)&&A.toLowerCase()){case"checkbox":case"radio":u.checked=b;break;case"select-one":if(u.selectedIndex=-1,Me(b))for(var B=0;A=u.options[B];B++)if(A.value==b){A.selected=!0;break}break;case"select-multiple":for(Me(b)&&(b=[b]),B=0;A=u.options[B];B++)if(A.selected=!1,b)for(var K,X=0;K=b[X];X++)A.value==K&&(A.selected=!0);break;default:u.value=b??""}}function Wj(u,b,A,B,K,X){if(Kh&&!ww("525"))return!0;if(Yv&&K)return VI(u);if(K&&!B)return!1;if(!pm&&("number"==typeof b&&(b=KN(b)),(!A||Yv)&&(17==b||18==b||Yv&&91==b)||Yv&&16==b&&(B||X)))return!1;if((Kh||Kv)&&B&&A)switch(u){case 220:case 219:case 221:case 192:case 186:case 189:case 187:case 188:case 190:case 191:case 192:case 222:return!1}if($a&&B&&b==u)return!1;switch(u){case 13:return!(pm&&(X||K||A&&B));case 27:return!(Kh||Kv||pm)}return(!pm||!(B||K||X))&&VI(u)}function VI(u){if(48<=u&&57>=u||96<=u&&106>=u||65<=u&&90>=u||(Kh||Kv)&&0==u)return!0;switch(u){case 32:case 43:case 63:case 64:case 107:case 109:case 110:case 111:case 186:case 59:case 189:case 187:case 61:case 188:case 190:case 191:case 192:case 222:case 219:case 220:case 221:case 163:return!0;case 173:return pm;default:return!1}}function KN(u){return pm?u=function Wle(u){switch(u){case 61:return 187;case 59:return 186;case 173:return 189;case 224:return 91;case 0:return 224;default:return u}}(u):Yv&&Kh&&93===u&&(u=91),u}function HC(u){Bl.call(this),this.a=u,fm(u,"keydown",this.g,!1,this),fm(u,"click",this.h,!1,this)}function Zj(u,b){var A=new Kj(b);if(n0(u,A)){A=new qj(b);try{n0(u,A)}finally{b.stopPropagation()}}}function qj(u){Jh.call(this,u.a),this.type="action"}function Kj(u){Jh.call(this,u.a),this.type="beforeaction"}function jC(u){Bl.call(this),this.a=u,u=$a?"focusout":"blur",this.g=fm(this.a,$a?"focusin":"focus",this,!$a),this.h=fm(this.a,u,this,!$a)}function _2(u,b){Bl.call(this),this.g=u||1,this.a=b||se,this.h=Zo(this.gc,this),this.j=Fg()}function y2(u){u.Ka=!1,u.aa&&(u.a.clearTimeout(u.aa),u.aa=null)}function GC(u){Tw.call(this),this.g=u,this.a={}}Sn(HC,Bl),HC.prototype.g=function(u){(13==u.keyCode||Kh&&3==u.keyCode)&&Zj(this,u)},HC.prototype.h=function(u){Zj(this,u)},HC.prototype.o=function(){HC.K.o.call(this),Sw(this.a,"keydown",this.g,!1,this),Sw(this.a,"click",this.h,!1,this),delete this.a},Sn(qj,Jh),Sn(Kj,Jh),Sn(jC,Bl),jC.prototype.handleEvent=function(u){var b=new Jh(u.a);b.type="focusin"==u.type||"focus"==u.type?"focusin":"focusout",n0(this,b)},jC.prototype.o=function(){jC.K.o.call(this),t0(this.g),t0(this.h),delete this.a},Sn(_2,Bl),(n=_2.prototype).Ka=!1,n.aa=null,n.gc=function(){if(this.Ka){var u=Fg()-this.j;0<u&&u<.8*this.g?this.aa=this.a.setTimeout(this.h,this.g-u):(this.aa&&(this.a.clearTimeout(this.aa),this.aa=null),n0(this,"tick"),this.Ka&&(y2(this),this.start()))}},n.start=function(){this.Ka=!0,this.aa||(this.aa=this.a.setTimeout(this.h,this.g),this.j=Fg())},n.o=function(){_2.K.o.call(this),y2(this),delete this.a},Sn(GC,Tw);var Yj=[];function $C(u,b,A,B){Bn(A)||(A&&(Yj[0]=A.toString()),A=Yj);for(var K=0;K<A.length;K++){var X=fm(b,A[K],B||u.handleEvent,!1,u.g||u);if(!X)break;u.a[X.key]=X}}function Jj(u){k5(u.a,function(b,A){this.a.hasOwnProperty(A)&&t0(b)},u),u.a={}}function UI(u){Bl.call(this),this.a=null,this.g=u,u=$a||Kv||Kh&&!ww("531")&&"TEXTAREA"==u.tagName,this.h=new GC(this),$C(this.h,this.g,u?["keydown","paste","cut","drop","input"]:"input",this)}function YN(u){null!=u.a&&(se.clearTimeout(u.a),u.a=null)}function Qj(u){return(u=new Jh(u.a)).type="input",u}function HI(u,b){Bl.call(this),u&&(this.Oa&&iG(this),this.qa=u,this.Na=fm(this.qa,"keypress",this,b),this.Ya=fm(this.qa,"keydown",this.Jb,b,this),this.Oa=fm(this.qa,"keyup",this.Kb,b,this))}GC.prototype.o=function(){GC.K.o.call(this),Jj(this)},GC.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Sn(UI,Bl),UI.prototype.handleEvent=function(u){if("input"==u.type)$a&&ww(10)&&0==u.keyCode&&0==u.j||(YN(this),n0(this,Qj(u)));else if("keydown"!=u.type||function $le(u){if(u.altKey&&!u.ctrlKey||u.metaKey||112<=u.keyCode&&123>=u.keyCode)return!1;if(VI(u.keyCode))return!0;switch(u.keyCode){case 18:case 20:case 93:case 17:case 40:case 35:case 27:case 36:case 45:case 37:case 224:case 91:case 144:case 12:case 34:case 33:case 19:case 255:case 44:case 39:case 145:case 16:case 38:case 252:case 224:case 92:return!1;case 0:return!pm;default:return 166>u.keyCode||183<u.keyCode}}(u)){var b="keydown"==u.type?this.g.value:null;$a&&229==u.keyCode&&(b=null);var A=Qj(u);YN(this),this.a=function Zle(u,b){if(ii(u))b&&(u=Zo(u,b));else{if(!u||"function"!=typeof u.handleEvent)throw Error("Invalid listener argument");u=Zo(u.handleEvent,u)}return 2147483647<Number(0)?-1:se.setTimeout(u,0)}(function(){this.a=null,this.g.value!=b&&n0(this,A)},this)}},UI.prototype.o=function(){UI.K.o.call(this),this.h.m(),YN(this),delete this.g},Sn(HI,Bl),(n=HI.prototype).qa=null,n.Na=null,n.Ya=null,n.Oa=null,n.R=-1,n.X=-1,n.Ua=!1;var Xj={3:13,12:144,63232:38,63233:40,63234:37,63235:39,63236:112,63237:113,63238:114,63239:115,63240:116,63241:117,63242:118,63243:119,63244:120,63245:121,63246:122,63247:123,63248:44,63272:46,63273:36,63275:35,63276:33,63277:34,63289:144,63302:45},eG={Up:38,Down:40,Left:37,Right:39,Enter:13,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"U+007F":46,Home:36,End:35,PageUp:33,PageDown:34,Insert:45},tG=!Kh||ww("525"),nG=Yv&&pm;function iG(u){u.Na&&(t0(u.Na),t0(u.Ya),t0(u.Oa),u.Na=null,u.Ya=null,u.Oa=null),u.qa=null,u.R=-1,u.X=-1}function rG(u,b,A,B){Jh.call(this,B),this.type="key",this.keyCode=u,this.j=b,this.repeat=A}function WC(u,b,A,B){this.top=u,this.right=b,this.bottom=A,this.left=B}function v2(u,b){var A=vI(u);return A.defaultView&&A.defaultView.getComputedStyle&&(u=A.defaultView.getComputedStyle(u,null))&&(u[b]||u.getPropertyValue(b))||""}function oG(u){try{var b=u.getBoundingClientRect()}catch{return{left:0,top:0,right:0,bottom:0}}return $a&&u.ownerDocument.body&&(b.left-=(u=u.ownerDocument).documentElement.clientLeft+u.body.clientLeft,b.top-=u.documentElement.clientTop+u.body.clientTop),b}function sG(u){var b=vI(u),A=new Xv(0,0),B=b?vI(b):document;return u==(B=!$a||9<=Number(_I)||"CSS1Compat"==Rk(B).a.compatMode?B.documentElement:B.body)||(u=oG(u),b=Pk(B=Rk(b).a),B=B.parentWindow||B.defaultView,b=$a&&ww("10")&&B.pageYOffset!=b.scrollTop?new Xv(b.scrollLeft,b.scrollTop):new Xv(B.pageXOffset||b.scrollLeft,B.pageYOffset||b.scrollTop),A.a=u.left+b.a,A.g=u.top+b.g),A}(n=HI.prototype).Jb=function(u){(Kh||Kv)&&(17==this.R&&!u.ctrlKey||18==this.R&&!u.altKey||Yv&&91==this.R&&!u.metaKey)&&(this.X=this.R=-1),-1==this.R&&(u.ctrlKey&&17!=u.keyCode?this.R=17:u.altKey&&18!=u.keyCode?this.R=18:u.metaKey&&91!=u.keyCode&&(this.R=91)),tG&&!Wj(u.keyCode,this.R,u.shiftKey,u.ctrlKey,u.altKey,u.metaKey)?this.handleEvent(u):(this.X=KN(u.keyCode),nG&&(this.Ua=u.altKey))},n.Kb=function(u){this.X=this.R=-1,this.Ua=u.altKey},n.handleEvent=function(u){var b=u.a,A=b.altKey;if($a&&"keypress"==u.type)var B=this.X,K=13!=B&&27!=B?b.keyCode:0;else(Kh||Kv)&&"keypress"==u.type?(B=this.X,K=0<=b.charCode&&63232>b.charCode&&VI(B)?b.charCode:0):G5&&!Kh?K=VI(B=this.X)?b.keyCode:0:("keypress"==u.type?(nG&&(A=this.Ua),b.keyCode==b.charCode?32>b.keyCode?(B=b.keyCode,K=0):(B=this.X,K=b.charCode):(B=b.keyCode||this.X,K=b.charCode||0)):(B=b.keyCode||this.X,K=b.charCode||0),Yv&&63==K&&224==B&&(B=191));var X=B=KN(B);B?63232<=B&&B in Xj?X=Xj[B]:25==B&&u.shiftKey&&(X=9):b.keyIdentifier&&b.keyIdentifier in eG&&(X=eG[b.keyIdentifier]),pm&&tG&&"keypress"==u.type&&!Wj(X,this.R,u.shiftKey,u.ctrlKey,A,u.metaKey)||(u=X==this.R,this.R=X,(b=new rG(X,K,u,b)).altKey=A,n0(this,b))},n.N=function(){return this.qa},n.o=function(){HI.K.o.call(this),iG(this)},Sn(rG,Jh),WC.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"},WC.prototype.ceil=function(){return this.top=Math.ceil(this.top),this.right=Math.ceil(this.right),this.bottom=Math.ceil(this.bottom),this.left=Math.ceil(this.left),this},WC.prototype.floor=function(){return this.top=Math.floor(this.top),this.right=Math.floor(this.right),this.bottom=Math.floor(this.bottom),this.left=Math.floor(this.left),this},WC.prototype.round=function(){return this.top=Math.round(this.top),this.right=Math.round(this.right),this.bottom=Math.round(this.bottom),this.left=Math.round(this.left),this};var aG={thin:2,medium:4,thick:6};function b2(u,b){if("none"==(u.currentStyle?u.currentStyle[b+"Style"]:null))return 0;var A=u.currentStyle?u.currentStyle[b+"Width"]:null;if(A in aG)u=aG[A];else if(/^\d+px?$/.test(A))u=parseInt(A,10);else{b=u.style.left;var B=u.runtimeStyle.left;u.runtimeStyle.left=u.currentStyle.left,u.style.left=A,A=u.style.pixelLeft,u.style.left=b,u.runtimeStyle.left=B,u=+A}return u}function JN(){}function Pw(u){Bl.call(this),this.s=u||Rk(),this.cb=null,this.na=!1,this.g=null,this.L=void 0,this.oa=this.Ea=this.Y=null}function bo(u,b){return u.g?JF(b,u.g||u.s.a):null}function jI(u){return u.L||(u.L=new GC(u)),u.L}function QN(u,b){u.Ea&&wc(u.Ea,b,void 0)}function qa(u,b){var A=rH(u,"firebaseui-textfield");b?(Hg(u,"firebaseui-input-invalid"),Ug(u,"firebaseui-input"),A&&Hg(A,"firebaseui-textfield-invalid")):(Hg(u,"firebaseui-input"),Ug(u,"firebaseui-input-invalid"),A&&Ug(A,"firebaseui-textfield-invalid"))}function ZC(u,b,A){xI(u,xp(CI,b=new UI(b))),$C(jI(u),b,"input",A)}function GI(u,b,A){xI(u,xp(CI,b=new HI(b))),$C(jI(u),b,"key",function(B){13==B.keyCode&&(B.stopPropagation(),B.preventDefault(),A(B))})}function Ra(u,b,A){xI(u,xp(CI,b=new HC(b))),$C(jI(u),b,"action",function(B){B.stopPropagation(),B.preventDefault(),A(B)})}function Ap(u){Ug(u,"firebaseui-hidden")}function Xc(u,b){b&&QF(u,b),Hg(u,"firebaseui-hidden")}function qC(u){return!BI(u,"firebaseui-hidden")&&"none"!=u.style.display}function KC(u){var A=(u=u||{}).disabled,B='<div class="firebaseui-textfield mdl-textfield mdl-js-textfield mdl-textfield--floating-label"><label class="mdl-textfield__label firebaseui-label" for="ui-sign-in-email-input">';return B=u.wc?B+"Enter new email address":B+"Email",B+='</label><input type="email" name="email" id="ui-sign-in-email-input" autocomplete="username" class="mdl-textfield__input firebaseui-input firebaseui-id-email" value="'+Yh(u.email??"")+'"'+(A?"disabled":"")+'></div><div class="firebaseui-error-wrapper"><p class="firebaseui-error firebaseui-text-input-error firebaseui-hidden firebaseui-id-email-error"></p></div>',gi(B)}function Hd(u){var b='<button type="submit" class="firebaseui-id-submit firebaseui-button mdl-button mdl-js-button mdl-button--raised mdl-button--colored">';return b=(u=(u=u||{}).label)?b+cr(u):b+"Next",gi(b+"</button>")}function XN(){var u=""+Hd({label:Wa("Sign In")});return gi(u)}function lG(){var u=""+Hd({label:Wa("Save")});return gi(u)}function mm(){var u=""+Hd({label:Wa("Continue")});return gi(u)}function cG(u){var b='<div class="firebaseui-new-password-component"><div class="firebaseui-textfield mdl-textfield mdl-js-textfield mdl-textfield--floating-label"><label class="mdl-textfield__label firebaseui-label" for="ui-sign-in-new-password-input">';return b=(u=(u=u||{}).label)?b+cr(u):b+"Choose password",gi(b+'</label><input type="password" name="newPassword" id="ui-sign-in-new-password-input" autocomplete="new-password" class="mdl-textfield__input firebaseui-input firebaseui-id-new-password"></div><a href="javascript:void(0)" class="firebaseui-input-floating-button firebaseui-id-password-toggle firebaseui-input-toggle-on firebaseui-input-toggle-blur"></a><div class="firebaseui-error-wrapper"><p class="firebaseui-error firebaseui-text-input-error firebaseui-hidden firebaseui-id-new-password-error"></p></div></div>')}function uG(){var b='<div class="firebaseui-textfield mdl-textfield mdl-js-textfield mdl-textfield--floating-label"><label class="mdl-textfield__label firebaseui-label" for="ui-sign-in-password-input">';return gi((b={}.current?b+"Current password":b+"Password")+'</label><input type="password" name="password" id="ui-sign-in-password-input" autocomplete="current-password" class="mdl-textfield__input firebaseui-input firebaseui-id-password"></div><div class="firebaseui-error-wrapper"><p class="firebaseui-error firebaseui-text-input-error firebaseui-hidden firebaseui-id-password-error"></p></div>')}function hG(){return gi('<a class="firebaseui-link firebaseui-id-secondary-link" href="javascript:void(0)">Trouble signing in?</a>')}function Mp(u){var b='<button class="firebaseui-id-secondary-link firebaseui-button mdl-button mdl-js-button mdl-button--primary">';return b=(u=(u=u||{}).label)?b+cr(u):b+"Cancel",gi(b+"</button>")}function Fu(u){var b="";return u.F&&u.D&&(b+='<ul class="firebaseui-tos-list firebaseui-tos"><li class="firebaseui-inline-list-item"><a href="javascript:void(0)" class="firebaseui-link firebaseui-tos-link" target="_blank">Terms of Service</a></li><li class="firebaseui-inline-list-item"><a href="javascript:void(0)" class="firebaseui-link firebaseui-pp-link" target="_blank">Privacy Policy</a></li></ul>'),gi(b)}function YC(u){var b="";return u.F&&u.D&&(b+='<p class="firebaseui-tos firebaseui-tospp-full-message">By continuing, you are indicating that you accept our <a href="javascript:void(0)" class="firebaseui-link firebaseui-tos-link" target="_blank">Terms of Service</a> and <a href="javascript:void(0)" class="firebaseui-link firebaseui-pp-link" target="_blank">Privacy Policy</a>.</p>'),gi(b)}function dG(u){return u='<div class="firebaseui-info-bar firebaseui-id-info-bar"><p class="firebaseui-info-bar-message">'+cr(u.message)+'&nbsp;&nbsp;<a href="javascript:void(0)" class="firebaseui-link firebaseui-id-dismiss-info-bar">Dismiss</a></p></div>',gi(u)}function pG(u){var b=u.content;return gi('<dialog class="mdl-dialog firebaseui-dialog firebaseui-id-dialog'+((u=u.Ab)?" "+Yh(u):"")+'">'+cr(b)+"</dialog>")}function fG(u){var b=u.message;return gi(pG({content:aH('<div class="firebaseui-dialog-icon-wrapper"><div class="'+Yh(u.Ma)+' firebaseui-dialog-icon"></div></div><div class="firebaseui-progress-dialog-message">'+cr(b)+"</div>")}))}function mG(u){for(var b='<div class="firebaseui-list-box-actions">',A=(u=u.items).length,B=0;B<A;B++){var K=u[B];b+='<button type="button" data-listboxid="'+Yh(K.id)+'" class="mdl-button firebaseui-id-list-box-dialog-button firebaseui-list-box-dialog-button">'+(K.Ma?'<div class="firebaseui-list-box-icon-wrapper"><div class="firebaseui-list-box-icon '+Yh(K.Ma)+'"></div></div>':"")+'<div class="firebaseui-list-box-label-wrapper">'+cr(K.label)+"</div></button>"}return b=""+pG({Ab:Wa("firebaseui-list-box-dialog"),content:aH(b+"</div>")}),gi(b)}function w2(u){return gi((u=u||{}).tb?'<div class="mdl-spinner mdl-spinner--single-color mdl-js-spinner is-active firebaseui-busy-indicator firebaseui-id-busy-indicator"></div>':'<div class="mdl-progress mdl-js-progress mdl-progress__indeterminate firebaseui-busy-indicator firebaseui-id-busy-indicator"></div>')}function s0(u,b){return zo((u=(u=u||{}).ga).S?u.S:b.hb[u.providerId]?""+b.hb[u.providerId]:u.providerId&&0==u.providerId.indexOf("saml.")||u.providerId&&0==u.providerId.indexOf("oidc.")?u.providerId.substring(5):""+u.providerId)}function e3(u){gG(u,"upgradeElement")}function t3(u){gG(u,"downgradeElements")}_n(JN),JN.prototype.a=0,Sn(Pw,Bl),(n=Pw.prototype).Lb=JN.Xa(),n.N=function(){return this.g},n.Za=function(u){if(this.Y&&this.Y!=u)throw Error("Method not supported");Pw.K.Za.call(this,u)},n.kb=function(){this.g=this.s.a.createElement("DIV")},n.render=function(u){if(this.na)throw Error("Component already rendered");this.g||this.kb(),u?u.insertBefore(this.g,null):this.s.a.body.appendChild(this.g),this.Y&&!this.Y.na||this.v()},n.v=function(){this.na=!0,QN(this,function(u){!u.na&&u.N()&&u.v()})},n.ya=function(){QN(this,function(u){u.na&&u.ya()}),this.L&&Jj(this.L),this.na=!1},n.o=function(){this.na&&this.ya(),this.L&&(this.L.m(),delete this.L),QN(this,function(u){u.m()}),this.g&&Cw(this.g),this.Y=this.g=this.oa=this.Ea=null,Pw.K.o.call(this)},n.removeChild=function(u,b){if(u){var A=Me(u)?u:u.cb||(u.cb=":"+(u.Lb.a++).toString(36));if(u=this.oa&&A&&(null!==(u=this.oa)&&A in u?u[A]:void 0)||null,A&&u){var B=this.oa;if(A in B&&delete B[A],zg(this.Ea,u),b&&(u.ya(),u.g&&Cw(u.g)),null==(b=u))throw Error("Unable to set parent component");b.Y=null,Pw.K.Za.call(b,null)}}if(!u)throw Error("Child is not in parent component");return u},dG.a="firebaseui.auth.soy2.element.infoBar",fG.a="firebaseui.auth.soy2.element.progressDialog",mG.a="firebaseui.auth.soy2.element.listBoxDialog",w2.a="firebaseui.auth.soy2.element.busyIndicator";var Jle=["mdl-js-textfield","mdl-js-progress","mdl-js-spinner","mdl-js-button"];function gG(u,b){u&&window.componentHandler&&window.componentHandler[b]&&Jle.forEach(function(A){BI(u,A)&&window.componentHandler[b](u),wc(YF(A,u),function(B){window.componentHandler[b](B)})})}function _G(u,b,A){if(x2.call(this),document.body.appendChild(u),u.showModal||window.dialogPolyfill.registerDialog(u),u.showModal(),e3(u),b&&Ra(this,u,function(X){var Se=u.getBoundingClientRect();(X.clientX<Se.left||Se.left+Se.width<X.clientX||X.clientY<Se.top||Se.top+Se.height<X.clientY)&&x2.call(this)}),!A){var B=this.N().parentElement||this.N().parentNode;if(B){var K=this;this.da=function(){if(u.open){var X=u.getBoundingClientRect().height,Se=B.getBoundingClientRect().height,et=B.getBoundingClientRect().top-document.body.getBoundingClientRect().top,Yt=B.getBoundingClientRect().left-document.body.getBoundingClientRect().left,Fn=u.getBoundingClientRect().width,Ai=B.getBoundingClientRect().width;u.style.top=(et+(Se-X)/2).toString()+"px",u.style.left=(X=Yt+(Ai-Fn)/2).toString()+"px",u.style.right=(document.body.getBoundingClientRect().width-X-Fn).toString()+"px"}else window.removeEventListener("resize",K.da)},this.da(),window.addEventListener("resize",this.da,!1)}}}function x2(){var u=n3.call(this);u&&(t3(u),u.open&&u.close(),Cw(u),this.da&&window.removeEventListener("resize",this.da))}function n3(){return JF("firebaseui-id-dialog")}function yG(){Cw(vG.call(this))}function vG(){return bo(this,"firebaseui-id-info-bar")}function bG(){return bo(this,"firebaseui-id-dismiss-info-bar")}var Qle={xa:{"google.com":"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg","github.com":"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/github.svg","facebook.com":"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/facebook.svg","twitter.com":"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/twitter.svg",password:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/mail.svg",phone:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/phone.svg",anonymous:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/anonymous.png","microsoft.com":"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/microsoft.svg","yahoo.com":"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/yahoo.svg","apple.com":"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/apple.png",saml:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/saml.svg",oidc:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/oidc.svg"},wa:{"google.com":"#ffffff","github.com":"#333333","facebook.com":"#3b5998","twitter.com":"#55acee",password:"#db4437",phone:"#02bd7e",anonymous:"#f4b400","microsoft.com":"#2F2F2F","yahoo.com":"#720E9E","apple.com":"#000000",saml:"#007bff",oidc:"#007bff"},hb:{"google.com":"Google","github.com":"GitHub","facebook.com":"Facebook","twitter.com":"Twitter",password:"Password",phone:"Phone",anonymous:"Guest","microsoft.com":"Microsoft","yahoo.com":"Yahoo","apple.com":"Apple"}};function i3(u,b,A){for(var B in ty.call(this,u,b),A)this[B]=A[B]}function xn(u,b,A,B,K){Pw.call(this,A),this.fb=u,this.eb=b,this.Fa=!1,this.Ga=B||null,this.A=this.ca=null,this.Z=BF(Qle),Tk(this.Z,K||{})}function xa(u){return u.N().parentElement||u.N().parentNode}function $I(u,b,A){GI(u,b,function(){A.focus()})}function JC(u,b,A){GI(u,b,function(){A()})}function wG(u,b,A){b=(u=u||{}).Va;var B=u.ia;return u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-sign-in"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in with email</h1></div><div class="firebaseui-card-content"><div class="firebaseui-relative-wrapper">'+KC(u)+'</div></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+(b?Mp(null):"")+Hd(null)+'</div></div><div class="firebaseui-card-footer">'+(B?YC(A):Fu(A))+"</div></form></div>",gi(u)}function xG(u,b,A){return b=(u=u||{}).ia,u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-password-sign-in"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in</h1></div><div class="firebaseui-card-content">'+KC(u)+uG()+'</div><div class="firebaseui-card-actions"><div class="firebaseui-form-links">'+hG()+'</div><div class="firebaseui-form-actions">'+XN()+'</div></div><div class="firebaseui-card-footer">'+(b?YC(A):Fu(A))+"</div></form></div>",gi(u)}function CG(u,b,A){var B=(u=u||{}).Tb;b=u.Ta;var K=u.ia,X='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-password-sign-up"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Create account</h1></div><div class="firebaseui-card-content">'+KC(u);return B?(u='<div class="firebaseui-textfield mdl-textfield mdl-js-textfield mdl-textfield--floating-label"><label class="mdl-textfield__label firebaseui-label" for="ui-sign-in-name-input">First &amp; last name</label><input type="text" name="name" id="ui-sign-in-name-input" autocomplete="name" class="mdl-textfield__input firebaseui-input firebaseui-id-name" value="'+Yh((u=(u=u||{}).name)??"")+'"></div><div class="firebaseui-error-wrapper"><p class="firebaseui-error firebaseui-text-input-error firebaseui-hidden firebaseui-id-name-error"></p></div>',u=gi(u)):u="",A=X+u+cG(null)+'</div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+(b?Mp(null):"")+lG()+'</div></div><div class="firebaseui-card-footer">'+(K?YC(A):Fu(A))+"</div></form></div>",gi(A)}function EG(u,b,A){return b=(u=u||{}).Ta,u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-password-recovery"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Recover password</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">Get instructions sent to this email that explain how to reset your password</p>'+KC(u)+'</div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+(b?Mp(null):"")+Hd({label:Wa("Send")})+'</div></div><div class="firebaseui-card-footer">'+Fu(A)+"</div></form></div>",gi(u)}function TG(u,b,A){b=u.G;var B="";return B+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-password-recovery-email-sent"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Check your email</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">'+(u="Follow the instructions sent to <strong>"+cr(u.email)+"</strong> to recover your password")+'</p></div><div class="firebaseui-card-actions">',b&&(B+='<div class="firebaseui-form-actions">'+Hd({label:Wa("Done")})+"</div>"),B+='</div><div class="firebaseui-card-footer">'+Fu(A)+"</div></div>",gi(B)}function SG(u,b,A){return gi('<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-callback"><div class="firebaseui-callback-indicator-container">'+w2(null)+"</div></div>")}function IG(u,b,A){return gi('<div class="firebaseui-container firebaseui-id-page-spinner">'+w2({tb:!0})+"</div>")}function DG(){return gi('<div class="firebaseui-container firebaseui-id-page-blank firebaseui-use-spinner"></div>')}function AG(u,b,A){return b="",b+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-link-sign-in-sent"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign-in email sent</h1></div><div class="firebaseui-card-content"><div class="firebaseui-email-sent"></div><p class="firebaseui-text">'+(u="A sign-in email with additional instructions was sent to <strong>"+cr(u.email)+"</strong>. Check your email to complete sign-in.")+'</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-links">'+gi('<a class="firebaseui-link firebaseui-id-trouble-getting-email-link" href="javascript:void(0)">Trouble getting email?</a>')+'</div><div class="firebaseui-form-actions">'+Mp({label:Wa("Back")})+'</div></div><div class="firebaseui-card-footer">'+Fu(A)+"</div></form></div>",gi(b)}function MG(u,b,A){return u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-not-received"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Trouble getting email?</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">Try these common fixes:<ul><li>Check if the email was marked as spam or filtered.</li><li>Check your internet connection.</li><li>Check that you did not misspell your email.</li><li>Check that your inbox space is not running out or other inbox settings related issues.</li></ul></p><p class="firebaseui-text">If the steps above didn\'t work, you can resend the email. Note that this will deactivate the link in the older email.</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-links">'+gi('<a class="firebaseui-link firebaseui-id-resend-email-link" href="javascript:void(0)">Resend</a>')+'</div><div class="firebaseui-form-actions">'+Mp({label:Wa("Back")})+'</div></div><div class="firebaseui-card-footer">'+Fu(A)+"</div></form></div>",gi(u)}function kG(u,b,A){return u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-link-sign-in-confirmation"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Confirm email</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">Confirm your email to complete sign in</p><div class="firebaseui-relative-wrapper">'+KC(u)+'</div></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+Mp(null)+Hd(null)+'</div></div><div class="firebaseui-card-footer">'+Fu(A)+"</div></form></div>",gi(u)}function RG(){var u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-different-device-error"><div class="firebaseui-card-header"><h1 class="firebaseui-title">New device or browser detected</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">Try opening the link using the same device or browser where you started the sign-in process.</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+Mp({label:Wa("Dismiss")})+"</div></div></div>";return gi(u)}function PG(){var u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-anonymous-user-mismatch"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Session ended</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">The session associated with this sign-in request has either expired or was cleared.</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+Mp({label:Wa("Dismiss")})+"</div></div></div>";return gi(u)}function OG(u,b,A){return b="",b+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-password-linking"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in</h1></div><div class="firebaseui-card-content"><h2 class="firebaseui-subtitle">You already have an account</h2><p class="firebaseui-text">'+(u="You\u2019ve already used <strong>"+cr(u.email)+"</strong> to sign in. Enter your password for that account.")+"</p>"+uG()+'</div><div class="firebaseui-card-actions"><div class="firebaseui-form-links">'+hG()+'</div><div class="firebaseui-form-actions">'+XN()+'</div></div><div class="firebaseui-card-footer">'+Fu(A)+"</div></form></div>",gi(b)}function LG(u,b,A){var B=u.email;return b="",u=Wa(u=""+s0(u,A)),b+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-link-sign-in-linking"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in</h1></div><div class="firebaseui-card-content"><h2 class="firebaseui-subtitle">You already have an account</h2><p class="firebaseui-text firebaseui-text-justify">'+(B="You\u2019ve already used <strong>"+cr(B)+"</strong>. You can connect your <strong>"+cr(u)+"</strong> account with <strong>"+cr(B)+"</strong> by signing in with email link below.")+'<p class="firebaseui-text firebaseui-text-justify">'+(u="For this flow to successfully connect your "+cr(u)+" account with this email, you have to open the link on the same device or browser.")+'</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+XN()+'</div></div><div class="firebaseui-card-footer">'+Fu(A)+"</div></form></div>",gi(b)}function FG(u,b,A){b="";var B=""+s0(u,A);return b+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-link-sign-in-linking-different-device"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text firebaseui-text-justify">'+(u="You originally intended to connect <strong>"+cr(B=Wa(B))+"</strong> to your email account but have opened the link on a different device where you are not signed in.")+'</p><p class="firebaseui-text firebaseui-text-justify">'+(B="If you still want to connect your <strong>"+cr(B)+"</strong> account, open the link on the same device where you started sign-in. Otherwise, tap Continue to sign-in on this device.")+'</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+mm()+'</div></div><div class="firebaseui-card-footer">'+Fu(A)+"</div></form></div>",gi(b)}function NG(u,b,A){var B=u.email;return b="",u=Wa(u=""+s0(u,A)),b+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-federated-linking"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in</h1></div><div class="firebaseui-card-content"><h2 class="firebaseui-subtitle">You already have an account</h2><p class="firebaseui-text">'+(B="You\u2019ve already used <strong>"+cr(B)+"</strong>. Sign in with "+cr(u)+" to continue.")+'</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+Hd({label:Wa("Sign in with "+u)})+'</div></div><div class="firebaseui-card-footer">'+Fu(A)+"</div></form></div>",gi(b)}function zG(u,b,A){var B=(u=u||{}).kc;b=u.yb,u=u.Eb;var K='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-unauthorized-user"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Not Authorized</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">';return K+=B?B="<strong>"+cr(B)+"</strong> is not authorized to view the requested page.":"User is not authorized to view the requested page.",K+="</p>",b&&(K+='<p class="firebaseui-text firebaseui-id-unauthorized-user-admin-email">'+(b="Please contact <strong>"+cr(b)+"</strong> for authorization.")+"</p>"),K+='</div><div class="firebaseui-card-actions"><div class="firebaseui-form-links">',u&&(K+='<a class="firebaseui-link firebaseui-id-unauthorized-user-help-link" href="javascript:void(0)" target="_blank">Learn More</a>'),K+='</div><div class="firebaseui-form-actions">'+Mp({label:Wa("Back")})+'</div></div><div class="firebaseui-card-footer">'+Fu(A)+"</div></form></div>",gi(K)}function BG(u,b,A){return b="",b+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-unsupported-provider"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">'+(u="To continue sign in with <strong>"+cr(u.email)+"</strong> on this device, you have to recover the password.")+'</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+Mp(null)+Hd({label:Wa("Recover password")})+'</div></div><div class="firebaseui-card-footer">'+Fu(A)+"</div></form></div>",gi(b)}function VG(u){var b="";return b+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-password-reset"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Reset your password</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">for <strong>'+cr(u.email)+"</strong></p>"+cG(function Uae(u){function b(){}var A={label:Wa("New password")};for(var B in b.prototype=u,u=new b,A)u[B]=A[B];return u}(u))+'</div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+lG()+"</div></div></form></div>",gi(b)}function UG(u){return u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-password-reset-success"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Password changed</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">You can now sign in with your new password</p></div><div class="firebaseui-card-actions">'+((u=u||{}).G?'<div class="firebaseui-form-actions">'+mm()+"</div>":"")+"</div></div>",gi(u)}function HG(u){return u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-password-reset-failure"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Try resetting your password again</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">Your request to reset your password has expired or the link has already been used</p></div><div class="firebaseui-card-actions">'+((u=u||{}).G?'<div class="firebaseui-form-actions">'+mm()+"</div>":"")+"</div></div>",gi(u)}function jG(u){var b=u.G,A="";return A+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-change-revoke-success"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Updated email address</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">'+(u="Your sign-in email address has been changed back to <strong>"+cr(u.email)+"</strong>.")+'</p><p class="firebaseui-text">If you didn\u2019t ask to change your sign-in email, it\u2019s possible someone is trying to access your account and you should <a class="firebaseui-link firebaseui-id-reset-password-link" href="javascript:void(0)">change your password right away</a>.</p></div><div class="firebaseui-card-actions">'+(b?'<div class="firebaseui-form-actions">'+mm()+"</div>":"")+"</div></form></div>",gi(A)}function GG(u){return u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-change-revoke-failure"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Unable to update your email address</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">There was a problem changing your sign-in email back.</p><p class="firebaseui-text">If you try again and still can\u2019t reset your email, try asking your administrator for help.</p></div><div class="firebaseui-card-actions">'+((u=u||{}).G?'<div class="firebaseui-form-actions">'+mm()+"</div>":"")+"</div></div>",gi(u)}function $G(u){return u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-verification-success"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Your email has been verified</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">You can now sign in with your new account</p></div><div class="firebaseui-card-actions">'+((u=u||{}).G?'<div class="firebaseui-form-actions">'+mm()+"</div>":"")+"</div></div>",gi(u)}function WG(u){return u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-verification-failure"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Try verifying your email again</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">Your request to verify your email has expired or the link has already been used</p></div><div class="firebaseui-card-actions">'+((u=u||{}).G?'<div class="firebaseui-form-actions">'+mm()+"</div>":"")+"</div></div>",gi(u)}function ZG(u){var b=u.G,A="";return A+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-verify-and-change-email-success"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Your email has been verified and changed</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">'+(u="You can now sign in with your new email <strong>"+cr(u.email)+"</strong>.")+'</p></div><div class="firebaseui-card-actions">'+(b?'<div class="firebaseui-form-actions">'+mm()+"</div>":"")+"</div></div>",gi(A)}function qG(u){return u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-verify-and-change-email-failure"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Try updating your email again</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">Your request to verify and update your email has expired or the link has already been used.</p></div><div class="firebaseui-card-actions">'+((u=u||{}).G?'<div class="firebaseui-form-actions">'+mm()+"</div>":"")+"</div></div>",gi(u)}function KG(u){var b=u.factorId,A=u.phoneNumber;u=u.G;var B='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-revert-second-factor-addition-success"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Removed second factor</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">';return B+="phone"===b?b="The <strong>"+cr(b)+" "+cr(A)+"</strong> was removed as a second authentication step.":"The device or app was removed as a second authentication step.",B+='</p><p class="firebaseui-text">If you don\'t recognize this device, someone might be trying to access your account. Consider <a class="firebaseui-link firebaseui-id-reset-password-link" href="javascript:void(0)">changing your password right away</a>.</p></div><div class="firebaseui-card-actions">'+(u?'<div class="firebaseui-form-actions">'+mm()+"</div>":"")+"</div></form></div>",gi(B)}function YG(u){return u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-revert-second-factor-addition-failure"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Couldn\'t remove your second factor</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">Something went wrong removing your second factor.</p><p class="firebaseui-text">Try removing it again. If that doesn\'t work, contact support for assistance.</p></div><div class="firebaseui-card-actions">'+((u=u||{}).G?'<div class="firebaseui-form-actions">'+mm()+"</div>":"")+"</div></div>",gi(u)}function JG(u){var b=u.zb;return u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-recoverable-error"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Error encountered</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">'+cr(u.errorMessage)+'</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">',b&&(u+=Hd({label:Wa("Retry")})),gi(u+"</div></div></div>")}function QG(u){return u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-unrecoverable-error"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Error encountered</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">'+cr(u.errorMessage)+"</p></div></div>",gi(u)}function XG(u,b,A){var B=u.Qb;return b="",b+='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-email-mismatch"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in</h1></div><div class="firebaseui-card-content"><h2 class="firebaseui-subtitle">'+(u="Continue with "+cr(u.jc)+"?")+'</h2><p class="firebaseui-text">'+(B="You originally wanted to sign in with "+cr(B))+'</p></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+Mp(null)+Hd({label:Wa("Continue")})+'</div></div><div class="firebaseui-card-footer">'+Fu(A)+"</div></form></div>",gi(b)}function e$(u,b,A){var B='<div class="firebaseui-container firebaseui-page-provider-sign-in firebaseui-id-page-provider-sign-in firebaseui-use-spinner"><div class="firebaseui-card-content"><form onsubmit="return false;"><ul class="firebaseui-idp-list">';b=(u=u.Sb).length;for(var K=0;K<b;K++){var X={ga:u[K]},Se=A,et=(X=X||{}).ga,Yt=X,Fn="";switch((Yt=Yt||{}).ga.providerId){case"google.com":Fn+="firebaseui-idp-google";break;case"github.com":Fn+="firebaseui-idp-github";break;case"facebook.com":Fn+="firebaseui-idp-facebook";break;case"twitter.com":Fn+="firebaseui-idp-twitter";break;case"phone":Fn+="firebaseui-idp-phone";break;case"anonymous":Fn+="firebaseui-idp-anonymous";break;case"password":Fn+="firebaseui-idp-password";break;default:Fn+="firebaseui-idp-generic"}Yt=(Yt='<button class="firebaseui-idp-button mdl-button mdl-js-button mdl-button--raised '+Yh(zo(Fn))+' firebaseui-id-idp-button" data-provider-id="'+Yh(et.providerId)+'" style="background-color:')+Yh(lH(zo((Fn=(Fn=(Fn=X)||{}).ga).ta?Fn.ta:Se.wa[Fn.providerId]?""+Se.wa[Fn.providerId]:0==Fn.providerId.indexOf("saml.")?""+Se.wa.saml:0==Fn.providerId.indexOf("oidc.")?""+Se.wa.oidc:""+Se.wa.password)))+'"><span class="firebaseui-idp-icon-wrapper"><img class="firebaseui-idp-icon" alt="" src="';var Ai=X;Fn=Se,Fn=Vae((Ai=(Ai=Ai||{}).ga).za?Ew(Ai.za):Fn.xa[Ai.providerId]?Ew(Fn.xa[Ai.providerId]):0==Ai.providerId.indexOf("saml.")?Ew(Fn.xa.saml):0==Ai.providerId.indexOf("oidc.")?Ew(Fn.xa.oidc):Ew(Fn.xa.password)),Yt=Yt+Yh(Ew(Fn))+'"></span>',"password"==et.providerId?(Yt+='<span class="firebaseui-idp-text firebaseui-idp-text-long">',Yt+=et.V?cr(et.V):et.S?X="Sign in with "+cr(s0(X,Se)):"Sign in with email",Yt+='</span><span class="firebaseui-idp-text firebaseui-idp-text-short">',Yt=et.S?Yt+cr(et.S):Yt+"Email",Yt+="</span>"):"phone"==et.providerId?(Yt+='<span class="firebaseui-idp-text firebaseui-idp-text-long">',Yt+=et.V?cr(et.V):et.S?X="Sign in with "+cr(s0(X,Se)):"Sign in with phone",Yt+='</span><span class="firebaseui-idp-text firebaseui-idp-text-short">',Yt=et.S?Yt+cr(et.S):Yt+"Phone",Yt+="</span>"):"anonymous"==et.providerId?(Yt+='<span class="firebaseui-idp-text firebaseui-idp-text-long">',Yt+=et.V?cr(et.V):et.S?X="Sign in with "+cr(s0(X,Se)):"Continue as guest",Yt+='</span><span class="firebaseui-idp-text firebaseui-idp-text-short">',Yt=et.S?Yt+cr(et.S):Yt+"Guest",Yt+="</span>"):(Yt+='<span class="firebaseui-idp-text firebaseui-idp-text-long">',Yt+=et.V?cr(et.V):Fn="Sign in with "+cr(s0(X,Se)),Yt+='</span><span class="firebaseui-idp-text firebaseui-idp-text-short">'+cr(et.S?et.S:s0(X,Se))+"</span>"),B+='<li class="firebaseui-list-item">'+(et=gi(Yt+"</button>"))+"</li>"}return B+='</ul></form></div><div class="firebaseui-card-footer firebaseui-provider-sign-in-footer">'+YC(A)+"</div></div>",gi(B)}function t$(u,b,A){var X,B=(u=u||{}).Gb,K=u.Va;return b=u.ia,u='<div class="firebaseui-phone-number"><button class="firebaseui-id-country-selector firebaseui-country-selector mdl-button mdl-js-button"><span class="firebaseui-flag firebaseui-country-selector-flag firebaseui-id-country-selector-flag"></span><span class="firebaseui-id-country-selector-code"></span></button><div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label firebaseui-textfield firebaseui-phone-input-wrapper"><label class="mdl-textfield__label firebaseui-label" for="ui-sign-in-phone-number-input">Phone number</label><input type="tel" name="phoneNumber" id="ui-sign-in-phone-number-input" class="mdl-textfield__input firebaseui-input firebaseui-id-phone-number" value="'+Yh((u=(u=u||{}).Aa)??"")+'"></div></div><div class="firebaseui-error-wrapper"><p class="firebaseui-error firebaseui-text-input-error firebaseui-hidden firebaseui-phone-number-error firebaseui-id-phone-number-error"></p></div>',X=(u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-phone-sign-in-start"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Enter your phone number</h1></div><div class="firebaseui-card-content"><div class="firebaseui-relative-wrapper">'+gi(u))+(X=B?gi('<div class="firebaseui-recaptcha-wrapper"><div class="firebaseui-recaptcha-container"></div><div class="firebaseui-error-wrapper firebaseui-recaptcha-error-wrapper"><p class="firebaseui-error firebaseui-hidden firebaseui-id-recaptcha-error"></p></div></div>'):"")+'</div></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+(K?Mp(null):"")+Hd({label:Wa("Verify")})+'</div></div><div class="firebaseui-card-footer">',b?(b='<p class="firebaseui-tos firebaseui-phone-tos">',A=gi((b=A.F&&A.D?b+'By tapping Verify, you are indicating that you accept our <a href="javascript:void(0)" class="firebaseui-link firebaseui-tos-link" target="_blank">Terms of Service</a> and <a href="javascript:void(0)" class="firebaseui-link firebaseui-pp-link" target="_blank">Privacy Policy</a>. An SMS may be sent. Message &amp; data rates may apply.':b+"By tapping Verify, an SMS may be sent. Message &amp; data rates may apply.")+"</p>")):A=gi('<p class="firebaseui-tos firebaseui-phone-sms-notice">By tapping Verify, an SMS may be sent. Message &amp; data rates may apply.</p>')+Fu(A),gi(X+A+"</div></form></div>")}function n$(u,b,A){var B="";return u='Enter the 6-digit code we sent to <a class="firebaseui-link firebaseui-change-phone-number-link firebaseui-id-change-phone-number-link" href="javascript:void(0)">&lrm;'+cr(b=(u=u||{}).phoneNumber)+"</a>",cr(b),b=B,A='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-phone-sign-in-finish"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Verify your phone number</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">'+u+"</p>"+(B=gi('<div class="firebaseui-textfield mdl-textfield mdl-js-textfield mdl-textfield--floating-label"><label class="mdl-textfield__label firebaseui-label" for="ui-sign-in-phone-confirmation-code-input">6-digit code</label><input type="number" name="phoneConfirmationCode" id="ui-sign-in-phone-confirmation-code-input" class="mdl-textfield__input firebaseui-input firebaseui-id-phone-confirmation-code"></div><div class="firebaseui-error-wrapper"><p class="firebaseui-error firebaseui-text-input-error firebaseui-hidden firebaseui-id-phone-confirmation-code-error"></p></div>'))+'</div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+Mp(null)+Hd({label:Wa("Continue")})+'</div></div><div class="firebaseui-card-footer">'+Fu(A)+"</div></form>",u=gi('<div class="firebaseui-resend-container"><span class="firebaseui-id-resend-countdown"></span><a href="javascript:void(0)" class="firebaseui-id-resend-link firebaseui-hidden firebaseui-link">Resend</a></div>'),gi(b+(A+u+"</div>"))}function i$(){return gi('<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-sign-out"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign Out</h1></div><div class="firebaseui-card-content"><p class="firebaseui-text">You are now successfully signed out.</p></div></div>')}function r$(u,b,A){var B='<div class="firebaseui-container firebaseui-page-select-tenant firebaseui-id-page-select-tenant"><div class="firebaseui-card-content"><form onsubmit="return false;"><ul class="firebaseui-tenant-list">';b=(u=u.ec).length;for(var K=0;K<b;K++){var X=u[K],Se="",et=cr(X.displayName),Yt=X.tenantId?X.tenantId:"top-level-project";Se+='<button class="firebaseui-tenant-button mdl-button mdl-js-button mdl-button--raised firebaseui-tenant-selection-'+Yh(Yt=Wa(Yt))+' firebaseui-id-tenant-selection-button"'+(X.tenantId?'data-tenant-id="'+Yh(X.tenantId)+'"':"")+'style="background-color:'+Yh(lH(X.ta))+'"><span class="firebaseui-idp-icon-wrapper"><img class="firebaseui-idp-icon" alt="" src="'+Yh(Ew(X.za))+'"></span><span class="firebaseui-idp-text firebaseui-idp-text-long">',Se+=X.V?cr(X.V):X="Sign in to "+cr(X.displayName),B+='<li class="firebaseui-list-item">'+(Se=gi(Se+'</span><span class="firebaseui-idp-text firebaseui-idp-text-short">'+et+"</span></button>"))+"</li>"}return B+='</ul></form></div><div class="firebaseui-card-footer firebaseui-provider-sign-in-footer">'+YC(A)+"</div></div>",gi(B)}function o$(u,b,A){return u='<div class="mdl-card mdl-shadow--2dp firebaseui-container firebaseui-id-page-provider-match-by-email"><form onsubmit="return false;"><div class="firebaseui-card-header"><h1 class="firebaseui-title">Sign in</h1></div><div class="firebaseui-card-content"><div class="firebaseui-relative-wrapper">'+KC(null)+'</div></div><div class="firebaseui-card-actions"><div class="firebaseui-form-actions">'+Hd(null)+'</div></div><div class="firebaseui-card-footer">'+YC(A)+"</div></form></div>",gi(u)}function xc(){return bo(this,"firebaseui-id-submit")}function Ul(){return bo(this,"firebaseui-id-secondary-link")}function eu(u,b){Ra(this,xc.call(this),function(B){u(B)});var A=Ul.call(this);A&&b&&Ra(this,A,function(B){b(B)})}function C2(){return bo(this,"firebaseui-id-password")}function E2(){return bo(this,"firebaseui-id-password-error")}function s$(){var u=C2.call(this),b=E2.call(this);ZC(this,u,function(){qC(b)&&(qa(u,!0),Ap(b))})}function a$(){var u=C2.call(this),b=E2.call(this);return Qc(u)?(qa(u,!0),Ap(b),b=!0):(qa(u,!1),Xc(b,zo("Enter your password").toString()),b=!1),b?Qc(u):null}function QC(u,b,A,B,K,X){xn.call(this,OG,{email:u},X,"passwordLinking",{F:B,D:K}),this.w=b,this.H=A}Sn(i3,ty),Sn(xn,Pw),(n=xn.prototype).kb=function(){var u=bI(this.fb,this.eb,this.Z,this.s);e3(u),this.g=u},n.v=function(){if(xn.K.v.call(this),xH(xa(this),new i3("pageEnter",xa(this),{pageId:this.Ga})),this.bb()&&this.Z.F){var u=this.Z.F;Ra(this,this.bb(),function(){u()})}if(this.ab()&&this.Z.D){var b=this.Z.D;Ra(this,this.ab(),function(){b()})}},n.ya=function(){xH(xa(this),new i3("pageExit",xa(this),{pageId:this.Ga})),xn.K.ya.call(this)},n.o=function(){window.clearTimeout(this.ca),this.eb=this.fb=this.ca=null,this.Fa=!1,this.A=null,t3(this.N()),xn.K.o.call(this)},n.I=function(u,b,A,B){function K(){if(X.T)return null;X.Fa=!1,window.clearTimeout(X.ca),X.ca=null,X.A&&(t3(X.A),Cw(X.A),X.A=null)}var X=this;return X.Fa?null:(function Xle(u){u.Fa=!0;var b=BI(u.N(),"firebaseui-use-spinner");u.ca=window.setTimeout(function(){u.N()&&null===u.A&&(u.A=bI(w2,{tb:b},null,u.s),u.N().appendChild(u.A),e3(u.A))},500)}(X),u.apply(null,b).then(A,B).then(K,K))},No(xn.prototype,{a:function(u){yG.call(this);var b=bI(dG,{message:u},null,this.s);this.N().appendChild(b),Ra(this,bG.call(this),function(){Cw(b)})},yc:yG,Ac:vG,zc:bG,$:function(u,b){u=bI(fG,{Ma:u,message:b},null,this.s),_G.call(this,u)},h:x2,Cb:n3,Cc:function(){return bo(this,"firebaseui-tos")},bb:function(){return bo(this,"firebaseui-tos-link")},ab:function(){return bo(this,"firebaseui-pp-link")},Dc:function(){return bo(this,"firebaseui-tos-list")}}),wG.a="firebaseui.auth.soy2.page.signIn",xG.a="firebaseui.auth.soy2.page.passwordSignIn",CG.a="firebaseui.auth.soy2.page.passwordSignUp",EG.a="firebaseui.auth.soy2.page.passwordRecovery",TG.a="firebaseui.auth.soy2.page.passwordRecoveryEmailSent",SG.a="firebaseui.auth.soy2.page.callback",IG.a="firebaseui.auth.soy2.page.spinner",DG.a="firebaseui.auth.soy2.page.blank",AG.a="firebaseui.auth.soy2.page.emailLinkSignInSent",MG.a="firebaseui.auth.soy2.page.emailNotReceived",kG.a="firebaseui.auth.soy2.page.emailLinkSignInConfirmation",RG.a="firebaseui.auth.soy2.page.differentDeviceError",PG.a="firebaseui.auth.soy2.page.anonymousUserMismatch",OG.a="firebaseui.auth.soy2.page.passwordLinking",LG.a="firebaseui.auth.soy2.page.emailLinkSignInLinking",FG.a="firebaseui.auth.soy2.page.emailLinkSignInLinkingDifferentDevice",NG.a="firebaseui.auth.soy2.page.federatedLinking",zG.a="firebaseui.auth.soy2.page.unauthorizedUser",BG.a="firebaseui.auth.soy2.page.unsupportedProvider",VG.a="firebaseui.auth.soy2.page.passwordReset",UG.a="firebaseui.auth.soy2.page.passwordResetSuccess",HG.a="firebaseui.auth.soy2.page.passwordResetFailure",jG.a="firebaseui.auth.soy2.page.emailChangeRevokeSuccess",GG.a="firebaseui.auth.soy2.page.emailChangeRevokeFailure",$G.a="firebaseui.auth.soy2.page.emailVerificationSuccess",WG.a="firebaseui.auth.soy2.page.emailVerificationFailure",ZG.a="firebaseui.auth.soy2.page.verifyAndChangeEmailSuccess",qG.a="firebaseui.auth.soy2.page.verifyAndChangeEmailFailure",KG.a="firebaseui.auth.soy2.page.revertSecondFactorAdditionSuccess",YG.a="firebaseui.auth.soy2.page.revertSecondFactorAdditionFailure",JG.a="firebaseui.auth.soy2.page.recoverableError",QG.a="firebaseui.auth.soy2.page.unrecoverableError",XG.a="firebaseui.auth.soy2.page.emailMismatch",e$.a="firebaseui.auth.soy2.page.providerSignIn",t$.a="firebaseui.auth.soy2.page.phoneSignInStart",n$.a="firebaseui.auth.soy2.page.phoneSignInFinish",i$.a="firebaseui.auth.soy2.page.signOut",r$.a="firebaseui.auth.soy2.page.selectTenant",o$.a="firebaseui.auth.soy2.page.providerMatchByEmail",E(QC,xn),QC.prototype.v=function(){this.P(),this.M(this.w,this.H),JC(this,this.i(),this.w),this.i().focus(),xn.prototype.v.call(this)},QC.prototype.o=function(){this.w=null,xn.prototype.o.call(this)},QC.prototype.j=function(){return Qc(bo(this,"firebaseui-id-email"))},No(QC.prototype,{i:C2,B:E2,P:s$,u:a$,ea:xc,ba:Ul,M:eu});var ece=/^[+a-zA-Z0-9_.!#$%&'*\/=?^`{|}~-]+@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,63}$/;function ry(){return bo(this,"firebaseui-id-email")}function a0(){return bo(this,"firebaseui-id-email-error")}function XC(u){var b=ry.call(this),A=a0.call(this);ZC(this,b,function(){qC(A)&&(qa(b,!0),Ap(A))}),u&&GI(this,b,function(){u()})}function eE(){return Ep(Qc(ry.call(this))||"")}function tE(){var u=ry.call(this),b=a0.call(this),A=Qc(u)||"";return A?ece.test(A)?(qa(u,!0),Ap(b),b=!0):(qa(u,!1),Xc(b,zo("That email address isn't correct").toString()),b=!1):(qa(u,!1),Xc(b,zo("Enter your email address to continue").toString()),b=!1),b?Ep(Qc(u)):null}function WI(u,b,A,B,K,X,Se){xn.call(this,xG,{email:A,ia:!!X},Se,"passwordSignIn",{F:B,D:K}),this.w=u,this.H=b}function as(u,b,A,B,K,X){xn.call(this,u,b,B,K||"notice",X),this.i=A||null}function T2(u,b,A,B,K){as.call(this,TG,{email:u,G:!!b},b,K,"passwordRecoveryEmailSent",{F:A,D:B})}function l$(u,b){as.call(this,$G,{G:!!u},u,b,"emailVerificationSuccess")}function c$(u,b){as.call(this,WG,{G:!!u},u,b,"emailVerificationFailure")}function u$(u,b,A){as.call(this,ZG,{email:u,G:!!b},b,A,"verifyAndChangeEmailSuccess")}function h$(u,b){as.call(this,qG,{G:!!u},u,b,"verifyAndChangeEmailFailure")}function d$(u,b){as.call(this,YG,{G:!!u},u,b,"revertSecondFactorAdditionFailure")}function p$(u){as.call(this,i$,void 0,void 0,u,"signOut")}function f$(u,b){as.call(this,UG,{G:!!u},u,b,"passwordResetSuccess")}function m$(u,b){as.call(this,HG,{G:!!u},u,b,"passwordResetFailure")}function g$(u,b){as.call(this,GG,{G:!!u},u,b,"emailChangeRevokeFailure")}function _$(u,b,A){as.call(this,JG,{errorMessage:u,zb:!!b},b,A,"recoverableError")}function y$(u,b){as.call(this,QG,{errorMessage:u},void 0,b,"unrecoverableError")}function ZI(u){if("auth/invalid-credential"===u.code&&u.message&&-1!==u.message.indexOf("error=consent_required"))return{code:"auth/user-cancelled"};if(u.message&&-1!==u.message.indexOf("HTTP Cloud Function returned an error:")){var b=JSON.parse(u.message.substring(u.message.indexOf("{"),u.message.lastIndexOf("}")+1));return{code:u.code,message:b&&b.error&&b.error.message||u.message}}return u}function oy(u,b,A,B){function K(Se){if(!Se.name||"cancel"!=Se.name){e:{var et=Se.message;try{var Yt=((JSON.parse(et).error||{}).message||"").toLowerCase().match(/invalid.+(access|id)_token/);if(Yt&&Yt.length){var Fn=!0;break e}}catch{}Fn=!1}if(Fn)Se=xa(b),b.m(),js(u,Se,void 0,zo("Your sign-in session has expired. Please try again.").toString());else{if(Fn=Se&&Se.message||"",Se.code){if("auth/email-already-in-use"==Se.code||"auth/credential-already-in-use"==Se.code)return;Fn=_s(Se)}b.a(Fn)}}}if(V$(u),B)return v$(u,A),Za();if(!A.credential)throw Error("No credential found!");if(!ao(u).currentUser&&!A.user)throw Error("User not logged in.");try{var X=function Rce(u,b){return wo(u),sy(u,function(A){if(u.j&&!u.j.isAnonymous&&p2(Tn(u))&&!ao(u).currentUser)return l0(u).then(function(){return"password"==b.credential.providerId&&(b.credential=null),b});if(A)return l0(u).then(function(){return A.linkWithCredential(b.credential)}).then(function(B){return b.user=B.user,b.credential=B.credential,b.operationType=B.operationType,b.additionalUserInfo=B.additionalUserInfo,b},function(B){if(B&&"auth/email-already-in-use"==B.code&&B.email&&B.credential)throw B;return c0(u,B,b.credential)});if(!b.user)throw Error('Internal error: An incompatible or outdated version of "firebase.js" may be used.');return l0(u).then(function(){return gm(u).updateCurrentUser(b.user)}).then(function(){return b.user=gm(u).currentUser,b.operationType="signIn",b.credential&&b.credential.providerId&&"password"==b.credential.providerId&&(b.credential=null),b})})}(u,A)}catch(Se){return Ip(Se.code||Se.message,Se),b.a(Se.code||Se.message),Za()}return A=X.then(function(Se){v$(u,Se)},K).then(void 0,K),Dr(u,X),Za(A)}function v$(u,b){if(!b.user)throw Error("No user found");var A=Uj(Tn(u));if(jN(Tn(u))&&A&&o0("Both signInSuccess and signInSuccessWithAuthResult callbacks are provided. Only signInSuccessWithAuthResult callback will be invoked."),A){A=Uj(Tn(u));var B=bj(rr(u))||void 0;Ud(PI,rr(u));var K=!1;VH()?((!A||A(b,B))&&(K=!0,SC(window.opener.location,S2(u,B))),A||window.close()):(!A||A(b,B))&&(K=!0,SC(window.location,S2(u,B))),K||u.reset()}else{A=b.user,b=b.credential,B=jN(Tn(u)),K=bj(rr(u))||void 0,Ud(PI,rr(u));var X=!1;VH()?((!B||B(A,b,K))&&(X=!0,SC(window.opener.location,S2(u,K))),B||window.close()):(!B||B(A,b,K))&&(X=!0,SC(window.location,S2(u,K))),X||u.reset()}}function S2(u,b){if(!(u=b||Tn(u).a.get("signInSuccessUrl")))throw Error("No redirect URL has been found. You must either specify a signInSuccessUrl in the configuration, pass in a redirect URL to the widget URL, or return false from the callback.");return u}function _s(u){var b={code:u.code},A="";switch((b=b||{}).code){case"auth/email-already-in-use":A+="The email address is already used by another account";break;case"auth/requires-recent-login":case"auth/user-token-expired":A+=function pH(){return zo("Please login again to perform this operation")}();break;case"auth/too-many-requests":A+="You have entered an incorrect password too many times. Please try again in a few minutes.";break;case"auth/user-cancelled":A+="Please authorize the required permissions to sign in to the application";break;case"auth/user-not-found":A+="That email address doesn't match an existing account";break;case"auth/weak-password":A+="Strong passwords have at least 6 characters and a mix of letters and numbers";break;case"auth/wrong-password":A+="The email and password you entered don't match";break;case"auth/network-request-failed":A+="A network error has occurred";break;case"auth/invalid-phone-number":A+=nN();break;case"auth/invalid-verification-code":A+=zo("Wrong code. Try again.");break;case"auth/code-expired":A+="This code is no longer valid";break;case"auth/expired-action-code":A+="This code has expired.";break;case"auth/invalid-action-code":A+="The action code is invalid. This can happen if the code is malformed, expired, or has already been used."}if(b=zo(A).toString())return b;try{return JSON.parse(u.message),Ip("Internal error: "+u.message,void 0),uH().toString()}catch{return u.message}}function qI(u,b,A,B){function K(){(function Ale(u,b){NC(Mw,{tenantId:u.a},b)})(new rj(u.h.tenantId||null),rr(u)),Dr(u,b.I(Zo(u.dc,u),[Yt],function(){if("file:"===(window.location&&window.location.protocol))return Dr(u,L$(u).then(function(Fn){b.m(),Ud(Mw,rr(u)),Ei("callback",u,et,Za(Fn))},X))},Se))}function X(Fn){if(Ud(Mw,rr(u)),!Fn.name||"cancel"!=Fn.name)switch(Fn=ZI(Fn),Fn.code){case"auth/popup-blocked":K();break;case"auth/popup-closed-by-user":case"auth/cancelled-popup-request":case"auth/credential-already-in-use":break;case"auth/network-request-failed":case"auth/too-many-requests":case"auth/user-cancelled":b.a(_s(Fn));break;case"auth/admin-restricted-operation":b.m(),Rw(Tn(u))?Ei("handleUnauthorizedUser",u,et,null,A):Ei("callback",u,et,IC(Fn));break;default:b.m(),Ei("callback",u,et,IC(Fn))}}function Se(Fn){Ud(Mw,rr(u)),Fn.name&&"cancel"==Fn.name||(Ip("signInWithRedirect: "+Fn.code,void 0),Fn=_s(Fn),"blank"==b.Ga&&HN(Tn(u))?(b.m(),Ei("providerSignIn",u,et,Fn)):b.a(Fn))}var et=xa(b),Yt=function tce(u,b,A){var B=zC[b]&&Gi.Z.auth[zC[b]]?new Gi.Z.auth[zC[b]]:0==b.indexOf("saml.")?new Gi.Z.auth.SAMLAuthProvider(b):new Gi.Z.auth.OAuthProvider(b);if(!B)throw Error("Invalid Firebase Auth provider!");var K=Fj(Tn(u),b);if(B.addScope)for(var X=0;X<K.length;X++)B.addScope(K[X]);return K=Nj(Tn(u),b)||{},A&&(u=b==Gi.Z.auth.GoogleAuthProvider.PROVIDER_ID?"login_hint":b==Gi.Z.auth.GithubAuthProvider.PROVIDER_ID?"login":(u=FI(Tn(u),b))&&u.Ob)&&(K[u]=A),B.setCustomParameters&&B.setCustomParameters(K),B}(u,A,B);Vj(Tn(u))==g2?K():Dr(u,function kce(u,b){return wo(u),sy(u,function(A){return A&&!Bg(rr(u))?A.linkWithPopup(b).then(function(B){return B},function(B){if(B&&"auth/email-already-in-use"==B.code&&B.email&&B.credential)throw B;return c0(u,B)}):ao(u).signInWithPopup(b)})}(u,Yt).then(function(Fn){b.m(),Ei("callback",u,et,Za(Fn))},X))}function I2(u){return 1==(u=BC(Tn(u))).length&&u[0]==Gi.Z.auth.EmailAuthProvider.PROVIDER_ID}function b$(u){return 1==(u=BC(Tn(u))).length&&u[0]==Gi.Z.auth.PhoneAuthProvider.PROVIDER_ID}function js(u,b,A,B){I2(u)?B?Ei("signIn",u,b,A,B):o3(u,b,A):u&&b$(u)&&!B?Ei("phoneSignInStart",u,b):u&&HN(Tn(u))&&!B?Ei("federatedRedirect",u,b,A):Ei("providerSignIn",u,b,B,A)}function w$(u,b,A,B){var K=xa(b);Dr(u,b.I(Zo(ao(u).fetchSignInMethodsForEmail,ao(u)),[A],function(X){b.m(),x$(u,K,X,A,B)},function(X){X=_s(X),b.a(X)}))}function x$(u,b,A,B,K,X){A.length||VC(Tn(u))&&!VC(Tn(u))?gs(A,Gi.Z.auth.EmailAuthProvider.EMAIL_PASSWORD_SIGN_IN_METHOD)?Ei("passwordSignIn",u,b,B,X):1==A.length&&A[0]===Gi.Z.auth.EmailAuthProvider.EMAIL_LINK_SIGN_IN_METHOD?VC(Tn(u))?Ei("sendEmailLinkForSignIn",u,b,B,function(){Ei("signIn",u,b)}):Ei("unsupportedProvider",u,b,B):(A=kj(A,BC(Tn(u))))?(wj(new AN(B),rr(u)),Ei("federatedSignIn",u,b,B,A,K)):Ei("unsupportedProvider",u,b,B):Lj(Tn(u))?Ei("handleUnauthorizedUser",u,b,B,Gi.Z.auth.EmailAuthProvider.PROVIDER_ID):VC(Tn(u))?Ei("sendEmailLinkForSignIn",u,b,B,function(){Ei("signIn",u,b)}):Ei("passwordSignUp",u,b,B,void 0,void 0,X)}function r3(u,b,A,B,K,X){var Se=xa(b);Dr(u,b.I(Zo(u.Ib,u),[A,X],function(){b.m(),Ei("emailLinkSignInSent",u,Se,A,B,X)},K))}function o3(u,b,A){A?Ei("prefilledEmailSignIn",u,b,A):Ei("signIn",u,b)}function KI(){return Dk(iy(),"oobCode")}function s3(){var u=Dk(iy(),"continueUrl");return u?function(){SC(window.location,u)}:null}function YI(u,b){xn.call(this,PG,void 0,b,"anonymousUserMismatch"),this.i=u}function D2(u){xn.call(this,SG,void 0,u,"callback")}function C$(u,b,A){if(A.user){var B={user:A.user,credential:A.credential,operationType:A.operationType,additionalUserInfo:A.additionalUserInfo},K=Bg(rr(u)),X=K&&K.g;if(X&&!function sce(u,b){if(b==u.email)return!0;if(u.providerData)for(var A=0;A<u.providerData.length;A++)if(b==u.providerData[A].email)return!0;return!1}(A.user,X))!function oce(u,b,A){var B=xa(b);Dr(u,l0(u).then(function(){b.m(),Ei("emailMismatch",u,B,A)},function(K){K.name&&"cancel"==K.name||(K=_s(K.code),b.a(K))}))}(u,b,B);else{var Se=K&&K.a;Se?Dr(u,A.user.linkWithCredential(Se).then(function(et){E$(u,b,B={user:et.user,credential:Se,operationType:et.operationType,additionalUserInfo:et.additionalUserInfo})},function(et){A2(u,b,et)})):E$(u,b,B)}}else A=xa(b),b.m(),Vg(rr(u)),js(u,A)}function E$(u,b,A){Vg(rr(u)),oy(u,b,A)}function A2(u,b,A){var B=xa(b);Vg(rr(u)),A=_s(A),b.m(),js(u,B,void 0,A)}function T$(u,b,A,B){var K=xa(b);Dr(u,ao(u).fetchSignInMethodsForEmail(A).then(function(X){b.m(),X.length?gs(X,Gi.Z.auth.EmailAuthProvider.EMAIL_PASSWORD_SIGN_IN_METHOD)?Ei("passwordLinking",u,K,A):1==X.length&&X[0]===Gi.Z.auth.EmailAuthProvider.EMAIL_LINK_SIGN_IN_METHOD?Ei("emailLinkSignInLinking",u,K,A):(X=kj(X,BC(Tn(u))))?Ei("federatedLinking",u,K,A,X,B):(Vg(rr(u)),Ei("unsupportedProvider",u,K,A)):(Vg(rr(u)),Ei("passwordRecovery",u,K,A,!1,hH().toString()))},function(X){A2(u,b,X)}))}function JI(u,b){xn.call(this,RG,void 0,b,"differentDeviceError"),this.i=u}function QI(u,b,A,B){xn.call(this,jG,{email:u,G:!!A},B,"emailChangeRevoke"),this.l=b,this.i=A||null}function XI(){return bo(this,"firebaseui-id-new-password")}function M2(){return bo(this,"firebaseui-id-password-toggle")}function ace(){this.Ra=!this.Ra;var u=M2.call(this),b=XI.call(this);this.Ra?(b.type="text",Ug(u,"firebaseui-input-toggle-off"),Hg(u,"firebaseui-input-toggle-on")):(b.type="password",Ug(u,"firebaseui-input-toggle-on"),Hg(u,"firebaseui-input-toggle-off")),b.focus()}function k2(){return bo(this,"firebaseui-id-new-password-error")}function S$(){this.Ra=!1;var u=XI.call(this);u.type="password";var b=k2.call(this);ZC(this,u,function(){qC(b)&&(qa(u,!0),Ap(b))});var A=M2.call(this);Ug(A,"firebaseui-input-toggle-on"),Hg(A,"firebaseui-input-toggle-off"),function Kle(u,b,A){xI(u,xp(CI,b=new jC(b))),$C(jI(u),b,"focusin",A)}(this,u,function(){Ug(A,"firebaseui-input-toggle-focus"),Hg(A,"firebaseui-input-toggle-blur")}),function Yle(u,b,A){xI(u,xp(CI,b=new jC(b))),$C(jI(u),b,"focusout",A)}(this,u,function(){Ug(A,"firebaseui-input-toggle-blur"),Hg(A,"firebaseui-input-toggle-focus")}),Ra(this,A,Zo(ace,this))}function I$(){var u=XI.call(this),b=k2.call(this);return Qc(u)?(qa(u,!0),Ap(b),b=!0):(qa(u,!1),Xc(b,zo("Enter your password").toString()),b=!1),b?Qc(u):null}function eD(u,b,A){xn.call(this,VG,{email:u},A,"passwordReset"),this.l=b}function tD(u,b,A,B,K){xn.call(this,KG,{factorId:u,phoneNumber:A||null,G:!!B},K,"revertSecondFactorAdditionSuccess"),this.l=b,this.i=B||null}function D$(u,b,A,B){"auth/weak-password"==(B&&B.code)?(u=_s(B),qa(A.i(),!1),Xc(A.w(),u),A.i().focus()):(A&&A.m(),(A=new m$).render(b),Vr(u,A))}function R2(u,b){try{var A="number"==typeof u.selectionStart}catch{A=!1}A?(u.selectionStart=b,u.selectionEnd=b):$a&&!ww("9")&&("textarea"==u.type&&(b=u.value.substring(0,b).replace(/(\r\n|\r|\n)/g,"\n").length),(u=u.createTextRange()).collapse(!0),u.move("character",b),u.select())}function nD(u,b,A,B,K,X){xn.call(this,kG,{email:A},X,"emailLinkSignInConfirmation",{F:B,D:K}),this.l=u,this.u=b}function iD(u,b,A,B,K){xn.call(this,FG,{ga:u},K,"emailLinkSignInLinkingDifferentDevice",{F:A,D:B}),this.i=b}function P2(u){xn.call(this,DG,void 0,u,"blank")}function a3(u,b,A,B,K){var X=new P2,Se=new bw(A),et=Se.a.a.get(zl.$a)||"",Yt=Se.a.a.get(zl.Sa)||"",Fn="1"===Se.a.a.get(zl.Qa),Ai=B5(Se),ls=Se.a.a.get(zl.PROVIDER_ID)||null;Se=Se.a.a.get(zl.vb)||null,U$(u,Se);var ym=!FC(LC,rr(u)),W$=B||function Mle(u,b){var A=null;if(b=FC(LC,b))try{var B=pj(u,b),K=JSON.parse(B);A=K&&K.email||null}catch{}return A}(Yt,rr(u)),gD=(B=function kle(u,b){var A=null;if(b=FC(OI,b))try{var B=pj(u,b);A=JSON.parse(B)}catch{}return ij(A||null)}(Yt,rr(u)))&&B.a;ls&&gD&&gD.providerId!==ls&&(gD=null),X.render(b),Vr(u,X),Dr(u,X.I(function(){var bf=Za(null);bf=Ai&&ym||ym&&Fn?IC(Error("anonymous-user-not-found")):function Dce(u,b){var A=B5(new bw(b));return A?(b=new Vl(function(B,K){var X=gm(u).onAuthStateChanged(function(Se){X(),Se&&Se.isAnonymous&&Se.uid===A?B(Se):K(Se&&Se.isAnonymous&&Se.uid!==A?Error("anonymous-user-mismatch"):Error("anonymous-user-not-found"))});Dr(u,X)}),Dr(u,b),b):Za(null)}(u,A).then(function(y3){if(ls&&!gD)throw Error("pending-credential-not-found");return y3});var _D=null;return bf.then(function(y3){return _D=y3,K?null:ao(u).checkActionCode(et)}).then(function(){return _D})},[],function(bf){W$?function dce(u,b,A,B,K,X){var Se=xa(b);b.$("mdl-spinner mdl-spinner--single-color mdl-js-spinner is-active firebaseui-progress-dialog-loading-icon",zo("Signing in...").toString());var et=null;K=(X?function Ace(u,b,A,B,K){wo(u);var X=K||null,Se=Gi.Z.auth.EmailAuthProvider.credentialWithLink(A,B);return A=X?ao(u).signInWithEmailLink(A,B).then(function(et){return et.user.linkWithCredential(X)}).then(function(){return l0(u)}).then(function(){return c0(u,{code:"auth/email-already-in-use"},X)}):ao(u).fetchSignInMethodsForEmail(A).then(function(et){return et.length?c0(u,{code:"auth/email-already-in-use"},Se):b.linkWithCredential(Se)}),Dr(u,A),A}(u,X,A,B,K):function Mce(u,b,A,B){wo(u);var X,K=B||null;return b=ao(u).signInWithEmailLink(b,A).then(function(Se){if(X={user:Se.user,credential:null,operationType:Se.operationType,additionalUserInfo:Se.additionalUserInfo},K)return Se.user.linkWithCredential(K).then(function(et){X={user:et.user,credential:K,operationType:X.operationType,additionalUserInfo:et.additionalUserInfo}})}).then(function(){l0(u)}).then(function(){return gm(u).updateCurrentUser(X.user)}).then(function(){return X.user=gm(u).currentUser,X}),Dr(u,b),b}(u,A,B,K)).then(function(Yt){Ud(OI,rr(u)),Ud(LC,rr(u)),b.h(),b.$("firebaseui-icon-done",zo("Signed in!").toString()),et=setTimeout(function(){b.h(),oy(u,b,Yt,!0)},1e3),Dr(u,function(){b&&(b.h(),b.m()),clearTimeout(et)})},function(Yt){if(b.h(),b.m(),!Yt.name||"cancel"!=Yt.name){var Fn=_s(Yt=ZI(Yt));"auth/email-already-in-use"==Yt.code||"auth/credential-already-in-use"==Yt.code?(Ud(OI,rr(u)),Ud(LC,rr(u))):"auth/invalid-email"==Yt.code?(Fn=zo("The email provided does not match the current sign-in session.").toString(),Ei("emailLinkConfirmation",u,Se,B,A$,null,Fn)):js(u,Se,A,Fn)}}),Dr(u,K)}(u,X,W$,A,gD,bf):Fn?(X.m(),Ei("differentDeviceError",u,b)):(X.m(),Ei("emailLinkConfirmation",u,b,A,A$))},function(bf){var _D=void 0;if(!bf||!bf.name||"cancel"!=bf.name)switch(X.m(),bf&&bf.message){case"anonymous-user-not-found":Ei("differentDeviceError",u,b);break;case"anonymous-user-mismatch":Ei("anonymousUserMismatch",u,b);break;case"pending-credential-not-found":Ei("emailLinkNewDeviceLinking",u,b,A,hce);break;default:bf&&(_D=_s(bf)),js(u,b,void 0,_D)}}))}function A$(u,b,A,B){a3(u,b,B,A,!0)}function hce(u,b,A){a3(u,b,A)}function rD(u,b,A,B,K,X){xn.call(this,LG,{email:u,ga:b},X,"emailLinkSignInLinking",{F:B,D:K}),this.i=A}function oD(u,b,A,B,K,X){xn.call(this,AG,{email:u},X,"emailLinkSignInSent",{F:B,D:K}),this.u=b,this.i=A}function sD(u,b,A,B,K,X,Se){xn.call(this,XG,{jc:u,Qb:b},Se,"emailMismatch",{F:K,D:X}),this.l=A,this.i=B}function nE(u,b,A,B,K){xn.call(this,MG,void 0,K,"emailNotReceived",{F:A,D:B}),this.l=u,this.i=b}function iE(u,b,A,B,K,X){xn.call(this,NG,{email:u,ga:b},X,"federatedLinking",{F:B,D:K}),this.i=A}function aD(u,b,A,B,K,X){xn.call(this,EG,{email:A,Ta:!!b},X,"passwordRecovery",{F:B,D:K}),this.l=u,this.u=b}function l3(){return bo(this,"firebaseui-id-name")}function c3(){return bo(this,"firebaseui-id-name-error")}function lD(u,b,A,B,K,X,Se,et,Yt){xn.call(this,CG,{email:B,Tb:u,name:K,Ta:!!A,ia:!!et},Yt,"passwordSignUp",{F:X,D:Se}),this.w=b,this.H=A,this.B=u}function u3(){return bo(this,"firebaseui-id-phone-confirmation-code")}function M$(){return bo(this,"firebaseui-id-phone-confirmation-code-error")}function k$(){return bo(this,"firebaseui-id-resend-countdown")}function rE(u,b,A,B,K,X,Se,et,Yt){xn.call(this,n$,{phoneNumber:K},Yt,"phoneSignInFinish",{F:Se,D:et}),this.jb=X,this.i=new _2(1e3),this.B=X,this.P=u,this.l=b,this.H=A,this.M=B}E(WI,xn),WI.prototype.v=function(){this.P(),this.ea(),this.ba(this.w,this.H),$I(this,this.l(),this.i()),JC(this,this.i(),this.w),Qc(this.l())?this.i().focus():this.l().focus(),xn.prototype.v.call(this)},WI.prototype.o=function(){this.H=this.w=null,xn.prototype.o.call(this)},No(WI.prototype,{l:ry,U:a0,P:XC,M:eE,j:tE,i:C2,B:E2,ea:s$,u:a$,ua:xc,pa:Ul,ba:eu}),Sn(as,xn),as.prototype.v=function(){this.i&&(this.u(this.i),this.l().focus()),as.K.v.call(this)},as.prototype.o=function(){this.i=null,as.K.o.call(this)},No(as.prototype,{l:xc,w:Ul,u:eu}),Sn(T2,as),Sn(l$,as),Sn(c$,as),Sn(u$,as),Sn(h$,as),Sn(d$,as),Sn(p$,as),Sn(f$,as),Sn(m$,as),Sn(g$,as),Sn(_$,as),Sn(y$,as),E(YI,xn),YI.prototype.v=function(){var u=this;Ra(this,this.l(),function(){u.i()}),this.l().focus(),xn.prototype.v.call(this)},YI.prototype.o=function(){this.i=null,xn.prototype.o.call(this)},No(YI.prototype,{l:Ul}),Qo.anonymousUserMismatch=function(u,b){var A=new YI(function(){A.m(),js(u,b)});A.render(b),Vr(u,A)},E(D2,xn),D2.prototype.I=function(u,b,A,B){return u.apply(null,b).then(A,B)},Qo.callback=function(u,b,A){var B=new D2;B.render(b),Vr(u,B),A=A||L$(u),Dr(u,A.then(function(K){C$(u,B,K)},function(K){if((K=ZI(K))&&("auth/account-exists-with-different-credential"==K.code||"auth/email-already-in-use"==K.code)&&K.email&&K.credential)wj(new AN(K.email,K.credential),rr(u)),T$(u,B,K.email);else if(K&&"auth/user-cancelled"==K.code){var X=Bg(rr(u)),Se=_s(K);X&&X.a?T$(u,B,X.g,Se):X?w$(u,B,X.g,Se):A2(u,B,K)}else K&&"auth/credential-already-in-use"==K.code||(K&&"auth/operation-not-supported-in-this-environment"==K.code&&I2(u)?C$(u,B,{user:null,credential:null}):K&&"auth/admin-restricted-operation"==K.code&&Rw(Tn(u))?(B.m(),Vg(rr(u)),Ei("handleUnauthorizedUser",u,b,null,null)):A2(u,B,K))}))},E(JI,xn),JI.prototype.v=function(){var u=this;Ra(this,this.l(),function(){u.i()}),this.l().focus(),xn.prototype.v.call(this)},JI.prototype.o=function(){this.i=null,xn.prototype.o.call(this)},No(JI.prototype,{l:Ul}),Qo.differentDeviceError=function(u,b){var A=new JI(function(){A.m(),js(u,b)});A.render(b),Vr(u,A)},E(QI,xn),QI.prototype.v=function(){var u=this;Ra(this,bo(this,"firebaseui-id-reset-password-link"),function(){u.l()}),this.i&&(this.w(this.i),this.u().focus()),xn.prototype.v.call(this)},QI.prototype.o=function(){this.l=this.i=null,xn.prototype.o.call(this)},No(QI.prototype,{u:xc,B:Ul,w:eu}),E(eD,xn),eD.prototype.v=function(){this.H(),this.B(this.l),JC(this,this.i(),this.l),this.i().focus(),xn.prototype.v.call(this)},eD.prototype.o=function(){this.l=null,xn.prototype.o.call(this)},No(eD.prototype,{i:XI,w:k2,M:M2,H:S$,u:I$,U:xc,P:Ul,B:eu}),E(tD,xn),tD.prototype.v=function(){var u=this;Ra(this,bo(this,"firebaseui-id-reset-password-link"),function(){u.l()}),this.i&&(this.w(this.i),this.u().focus()),xn.prototype.v.call(this)},tD.prototype.o=function(){this.l=this.i=null,xn.prototype.o.call(this)},No(tD.prototype,{u:xc,B:Ul,w:eu}),Qo.passwordReset=function(u,b,A,B){Dr(u,ao(u).verifyPasswordResetCode(A).then(function(K){var X=new eD(K,function(){!function lce(u,b,A,B,K){var X=A.u();X&&Dr(u,A.I(Zo(ao(u).confirmPasswordReset,ao(u)),[B,X],function(){A.m();var Se=new f$(K);Se.render(b),Vr(u,Se)},function(Se){D$(u,b,A,Se)}))}(u,b,X,A,B)});X.render(b),Vr(u,X)},function(){D$(u,b)}))},Qo.emailChangeRevocation=function(u,b,A){var B=null;Dr(u,ao(u).checkActionCode(A).then(function(K){return B=K.data.email,ao(u).applyActionCode(A)}).then(function(){!function cce(u,b,A){var B=new QI(A,function(){Dr(u,B.I(Zo(ao(u).sendPasswordResetEmail,ao(u)),[A],function(){B.m(),(B=new T2(A,void 0,hl(Tn(u)),dl(Tn(u)))).render(b),Vr(u,B)},function(){B.a(cH().toString())}))});B.render(b),Vr(u,B)}(u,b,B)},function(){var K=new g$;K.render(b),Vr(u,K)}))},Qo.emailVerification=function(u,b,A,B){Dr(u,ao(u).applyActionCode(A).then(function(){var K=new l$(B);K.render(b),Vr(u,K)},function(){var K=new c$;K.render(b),Vr(u,K)}))},Qo.revertSecondFactorAddition=function(u,b,A){var B=null,K=null;Dr(u,ao(u).checkActionCode(A).then(function(X){return B=X.data.email,K=X.data.multiFactorInfo,ao(u).applyActionCode(A)}).then(function(){!function uce(u,b,A,B){var K=new tD(B.factorId,function(){K.I(Zo(ao(u).sendPasswordResetEmail,ao(u)),[A],function(){K.m(),(K=new T2(A,void 0,hl(Tn(u)),dl(Tn(u)))).render(b),Vr(u,K)},function(){K.a(cH().toString())})},B.phoneNumber);K.render(b),Vr(u,K)}(u,b,B,K)},function(){var X=new d$;X.render(b),Vr(u,X)}))},Qo.verifyAndChangeEmail=function(u,b,A,B){var K=null;Dr(u,ao(u).checkActionCode(A).then(function(X){return K=X.data.email,ao(u).applyActionCode(A)}).then(function(){var X=new u$(K,B);X.render(b),Vr(u,X)},function(){var X=new h$;X.render(b),Vr(u,X)}))},E(nD,xn),nD.prototype.v=function(){this.w(this.l),this.B(this.l,this.u),this.i().focus(),R2(this.i(),(this.i().value||"").length),xn.prototype.v.call(this)},nD.prototype.o=function(){this.u=this.l=null,xn.prototype.o.call(this)},No(nD.prototype,{i:ry,M:a0,w:XC,H:eE,j:tE,U:xc,P:Ul,B:eu}),Qo.emailLinkConfirmation=function(u,b,A,B,K,X){var Se=new nD(function(){var et=Se.j();et?(Se.m(),B(u,b,et,A)):Se.i().focus()},function(){Se.m(),js(u,b,K||void 0)},K||void 0,hl(Tn(u)),dl(Tn(u)));Se.render(b),Vr(u,Se),X&&Se.a(X)},E(iD,xn),iD.prototype.v=function(){this.u(this.i),this.l().focus(),xn.prototype.v.call(this)},iD.prototype.o=function(){this.i=null,xn.prototype.o.call(this)},No(iD.prototype,{l:xc,u:eu}),Qo.emailLinkNewDeviceLinking=function(u,b,A,B){var K=new bw(A);if(A=K.a.a.get(zl.PROVIDER_ID)||null,V5(K,null),A){var X=new iD(FI(Tn(u),A),function(){X.m(),B(u,b,K.toString())},hl(Tn(u)),dl(Tn(u)));X.render(b),Vr(u,X)}else js(u,b)},E(P2,xn),Qo.emailLinkSignInCallback=a3,E(rD,xn),rD.prototype.v=function(){this.u(this.i),this.l().focus(),xn.prototype.v.call(this)},rD.prototype.o=function(){this.i=null,xn.prototype.o.call(this)},No(rD.prototype,{l:xc,u:eu}),Qo.emailLinkSignInLinking=function(u,b,A){var B=Bg(rr(u));if(Vg(rr(u)),B){var K=B.a.providerId,X=new rD(A,FI(Tn(u),K),function(){!function pce(u,b,A,B){var K=xa(b);r3(u,b,A,function(){js(u,K,A)},function(X){if(!X.name||"cancel"!=X.name){var Se=_s(X);X&&"auth/network-request-failed"==X.code?b.a(Se):(b.m(),js(u,K,A,Se))}},B)}(u,X,A,B)},hl(Tn(u)),dl(Tn(u)));X.render(b),Vr(u,X)}else js(u,b)},E(oD,xn),oD.prototype.v=function(){var u=this;Ra(this,this.l(),function(){u.i()}),Ra(this,bo(this,"firebaseui-id-trouble-getting-email-link"),function(){u.u()}),this.l().focus(),xn.prototype.v.call(this)},oD.prototype.o=function(){this.i=this.u=null,xn.prototype.o.call(this)},No(oD.prototype,{l:Ul}),Qo.emailLinkSignInSent=function(u,b,A,B,K){var X=new oD(A,function(){X.m(),Ei("emailNotReceived",u,b,A,B,K)},function(){X.m(),B()},hl(Tn(u)),dl(Tn(u)));X.render(b),Vr(u,X)},E(sD,xn),sD.prototype.v=function(){this.w(this.l,this.i),this.u().focus(),xn.prototype.v.call(this)},sD.prototype.o=function(){this.i=null,xn.prototype.o.call(this)},No(sD.prototype,{u:xc,B:Ul,w:eu}),Qo.emailMismatch=function(u,b,A){var B=Bg(rr(u));if(B){var K=new sD(A.user.email,B.g,function(){var X=K;Vg(rr(u)),oy(u,X,A)},function(){var X=A.credential.providerId,Se=xa(K);K.m(),Ei(B.a?"federatedLinking":"federatedSignIn",u,Se,B.g,X)},hl(Tn(u)),dl(Tn(u)));K.render(b),Vr(u,K)}else js(u,b)},E(nE,xn),nE.prototype.v=function(){var u=this;Ra(this,this.u(),function(){u.i()}),Ra(this,this.Da(),function(){u.l()}),this.u().focus(),xn.prototype.v.call(this)},nE.prototype.Da=function(){return bo(this,"firebaseui-id-resend-email-link")},nE.prototype.o=function(){this.i=this.l=null,xn.prototype.o.call(this)},No(nE.prototype,{u:Ul}),Qo.emailNotReceived=function(u,b,A,B,K){var X=new nE(function(){r3(u,X,A,B,function(Se){Se=_s(Se),X.a(Se)},K)},function(){X.m(),js(u,b,A)},hl(Tn(u)),dl(Tn(u)));X.render(b),Vr(u,X)},E(iE,xn),iE.prototype.v=function(){this.u(this.i),this.l().focus(),xn.prototype.v.call(this)},iE.prototype.o=function(){this.i=null,xn.prototype.o.call(this)},No(iE.prototype,{l:xc,u:eu}),Qo.federatedLinking=function(u,b,A,B,K){var X=Bg(rr(u));if(X&&X.a){var Se=new iE(A,FI(Tn(u),B),function(){qI(u,Se,B,A)},hl(Tn(u)),dl(Tn(u)));Se.render(b),Vr(u,Se),K&&Se.a(K)}else js(u,b)},Qo.federatedRedirect=function(u,b,A){var B=new P2;B.render(b),Vr(u,B),qI(u,B,b=BC(Tn(u))[0],A)},Qo.federatedSignIn=function(u,b,A,B,K){var X=new iE(A,FI(Tn(u),B),function(){qI(u,X,B,A)},hl(Tn(u)),dl(Tn(u)));X.render(b),Vr(u,X),K&&X.a(K)},Qo.passwordLinking=function(u,b,A){var B=Bg(rr(u));Vg(rr(u));var K=B&&B.a;if(K){var X=new QC(A,function(){!function fce(u,b,A,B){var K=b.u();K?Dr(u,b.I(Zo(u.Xb,u),[A,K],function(X){return X=X.user.linkWithCredential(B).then(function(Se){return oy(u,b,{user:Se.user,credential:B,operationType:Se.operationType,additionalUserInfo:Se.additionalUserInfo})}),Dr(u,X),X},function(X){if(!X.name||"cancel"!=X.name)switch(X.code){case"auth/wrong-password":qa(b.i(),!1),Xc(b.B(),_s(X));break;case"auth/too-many-requests":b.a(_s(X));break;default:Ip("signInWithEmailAndPassword: "+X.message,void 0),b.a(_s(X))}})):b.i().focus()}(u,X,A,K)},function(){X.m(),Ei("passwordRecovery",u,b,A)},hl(Tn(u)),dl(Tn(u)));X.render(b),Vr(u,X)}else js(u,b)},E(aD,xn),aD.prototype.v=function(){this.B(),this.H(this.l,this.u),Qc(this.i())||this.i().focus(),JC(this,this.i(),this.l),xn.prototype.v.call(this)},aD.prototype.o=function(){this.u=this.l=null,xn.prototype.o.call(this)},No(aD.prototype,{i:ry,w:a0,B:XC,M:eE,j:tE,U:xc,P:Ul,H:eu}),Qo.passwordRecovery=function(u,b,A,B,K){var X=new aD(function(){!function mce(u,b){var A=b.j();if(A){var B=xa(b);Dr(u,b.I(Zo(ao(u).sendPasswordResetEmail,ao(u)),[A],function(){b.m();var K=new T2(A,function(){K.m(),js(u,B)},hl(Tn(u)),dl(Tn(u)));K.render(B),Vr(u,K)},function(K){qa(b.i(),!1),Xc(b.w(),_s(K))}))}else b.i().focus()}(u,X)},B?void 0:function(){X.m(),js(u,b)},A,hl(Tn(u)),dl(Tn(u)));X.render(b),Vr(u,X),K&&X.a(K)},Qo.passwordSignIn=function(u,b,A,B){var K=new WI(function(){!function rce(u,b){var A=b.j(),B=b.u();if(A)if(B){var K=Gi.Z.auth.EmailAuthProvider.credential(A,B);Dr(u,b.I(Zo(u.bc,u),[A,B],function(X){return oy(u,b,{user:X.user,credential:K,operationType:X.operationType,additionalUserInfo:X.additionalUserInfo})},function(X){if(!X.name||"cancel"!=X.name)switch(X.code){case"auth/email-already-in-use":break;case"auth/email-exists":qa(b.l(),!1),Xc(b.U(),_s(X));break;case"auth/too-many-requests":case"auth/wrong-password":qa(b.i(),!1),Xc(b.B(),_s(X));break;default:Ip("verifyPassword: "+X.message,void 0),b.a(_s(X))}}))}else b.i().focus();else b.l().focus()}(u,K)},function(){var X=K.M();K.m(),Ei("passwordRecovery",u,b,X)},A,hl(Tn(u)),dl(Tn(u)),B);K.render(b),Vr(u,K)},E(lD,xn),lD.prototype.v=function(){this.ea(),this.B&&this.Ja(),this.ua(),this.pa(this.w,this.H),this.B?($I(this,this.i(),this.u()),$I(this,this.u(),this.l())):$I(this,this.i(),this.l()),this.w&&JC(this,this.l(),this.w),Qc(this.i())?this.B&&!Qc(this.u())?this.u().focus():this.l().focus():this.i().focus(),xn.prototype.v.call(this)},lD.prototype.o=function(){this.H=this.w=null,xn.prototype.o.call(this)},No(lD.prototype,{i:ry,U:a0,ea:XC,jb:eE,j:tE,u:l3,Bc:c3,Ja:function(){var u=l3.call(this),b=c3.call(this);ZC(this,u,function(){qC(b)&&(qa(u,!0),Ap(b))})},M:function(){var u=l3.call(this),b=c3.call(this),A=Qc(u);return qa(u,A=!/^[\s\xa0]*$/.test(null==A?"":String(A))),A?(Ap(b),b=!0):(Xc(b,zo("Enter your account name").toString()),b=!1),b?Ep(Qc(u)):null},l:XI,ba:k2,lb:M2,ua:S$,P:I$,Nb:xc,Mb:Ul,pa:eu}),Qo.passwordSignUp=function(u,b,A,B,K,X){var et=new lD(Bj(Tn(u)),function(){!function gce(u,b){var A=Bj(Tn(u)),B=b.j(),K=null;A&&(K=b.M());var X=b.P();if(B){if(A){if(!K)return void b.u().focus();K=bC(K)}if(X){var Se=Gi.Z.auth.EmailAuthProvider.credential(B,X);Dr(u,b.I(Zo(u.Yb,u),[B,X],function(et){var Yt={user:et.user,credential:Se,operationType:et.operationType,additionalUserInfo:et.additionalUserInfo};return A?(et=et.user.updateProfile({displayName:K}).then(function(){return oy(u,b,Yt)}),Dr(u,et),et):oy(u,b,Yt)},function(et){if(!et.name||"cancel"!=et.name){var Yt=ZI(et);switch(et=_s(Yt),Yt.code){case"auth/email-already-in-use":return function _ce(u,b,A,B){function K(){var Se=_s(B);qa(b.i(),!1),Xc(b.U(),Se),b.i().focus()}var X=ao(u).fetchSignInMethodsForEmail(A).then(function(Se){Se.length?K():(Se=xa(b),b.m(),Ei("passwordRecovery",u,Se,A,!1,hH().toString()))},function(){K()});return Dr(u,X),X}(u,b,B,Yt);case"auth/too-many-requests":et=zo("Too many account requests are coming from your IP address. Try again in a few minutes.").toString();case"auth/operation-not-allowed":case"auth/weak-password":qa(b.l(),!1),Xc(b.ba(),et);break;case"auth/admin-restricted-operation":Rw(Tn(u))?(et=xa(b),b.m(),Ei("handleUnauthorizedUser",u,et,B,Gi.Z.auth.EmailAuthProvider.PROVIDER_ID)):b.a(et);break;default:Ip(Yt="setAccountInfo: "+mj(Yt),void 0),b.a(et)}}}))}else b.l().focus()}else b.i().focus()}(u,et)},K?void 0:function Se(){et.m(),js(u,b)},A,B,hl(Tn(u)),dl(Tn(u)),X);et.render(b),Vr(u,et)},E(rE,xn),rE.prototype.v=function(){var u=this;this.U(this.jb),fm(this.i,"tick",this.w,!1,this),this.i.start(),Ra(this,bo(this,"firebaseui-id-change-phone-number-link"),function(){u.P()}),Ra(this,this.Da(),function(){u.M()}),this.Ja(this.l),this.ea(this.l,this.H),this.u().focus(),xn.prototype.v.call(this)},rE.prototype.o=function(){this.M=this.H=this.l=this.P=null,y2(this.i),Sw(this.i,"tick",this.w),this.i=null,xn.prototype.o.call(this)},rE.prototype.w=function(){--this.B,0<this.B?this.U(this.B):(y2(this.i),Sw(this.i,"tick",this.w),this.ua(),this.lb())},No(rE.prototype,{u:u3,pa:M$,Ja:function(u){var b=u3.call(this),A=M$.call(this);ZC(this,b,function(){qC(A)&&(qa(b,!0),Ap(A))}),u&&GI(this,b,function(){u()})},ba:function(){var u=Ep(Qc(u3.call(this))||"");return/^\d{6}$/.test(u)?u:null},Fb:k$,U:function(u){QF(k$.call(this),zo("Resend code in "+(9<u?"0:":"0:0")+u).toString())},ua:function(){Ap(this.Fb())},Da:function(){return bo(this,"firebaseui-id-resend-link")},lb:function(){Xc(this.Da())},Nb:xc,Mb:Ul,ea:eu}),Qo.phoneSignInFinish=function(u,b,A,B,K,X){var Se=new rE(function(){Se.m(),Ei("phoneSignInStart",u,b,A)},function(){!function yce(u,b,A,B){function K(Se){b.u().focus(),qa(b.u(),!1),Xc(b.pa(),Se)}var X=b.ba();X?(b.$("mdl-spinner mdl-spinner--single-color mdl-js-spinner is-active firebaseui-progress-dialog-loading-icon",zo("Verifying...").toString()),Dr(u,b.I(Zo(B.confirm,B),[X],function(Se){b.h(),b.$("firebaseui-icon-done",zo("Verified!").toString());var et=setTimeout(function(){b.h(),b.m();var Yt={user:gm(u).currentUser,credential:null,operationType:Se.operationType,additionalUserInfo:Se.additionalUserInfo};oy(u,b,Yt,!0)},1e3);Dr(u,function(){b&&b.h(),clearTimeout(et)})},function(Se){if(Se.name&&"cancel"==Se.name)b.h();else{var et=ZI(Se);switch(Se=_s(et),et.code){case"auth/credential-already-in-use":b.h();break;case"auth/code-expired":et=xa(b),b.h(),b.m(),Ei("phoneSignInStart",u,et,A,Se);break;case"auth/missing-verification-code":case"auth/invalid-verification-code":b.h(),K(Se);break;default:b.h(),b.a(Se)}}}))):K(zo("Wrong code. Try again.").toString())}(u,Se,A,K)},function(){Se.m(),js(u,b)},function(){Se.m(),Ei("phoneSignInStart",u,b,A)},VN(A),B,hl(Tn(u)),dl(Tn(u)));Se.render(b),Vr(u,Se),X&&Se.a(X)};var vce=!($a||so("Safari")&&!(j5()||so("Coast")||so("Opera")||so("Edge")||so("Firefox")||so("FxiOS")||so("Silk")||so("Android")));function O2(u,b){return/-[a-z]/.test(b)?null:vce&&u.dataset?!so("Android")||j5()||so("Firefox")||so("FxiOS")||so("Opera")||so("Silk")||b in u.dataset?void 0===(u=u.dataset[b])?null:u:null:u.getAttribute("data-"+String(b).replace(/([A-Z])/g,"-$1").toLowerCase())}function bce(u,b,A){var B=this;u=bI(mG,{items:u},null,this.s),_G.call(this,u,!0,!0),A&&(A=function wce(u,b){u=(u||document).getElementsByTagName("BUTTON");for(var A=0;A<u.length;A++)if(O2(u[A],"listboxid")===b)return u[A];return null}(u,A))&&(A.focus(),function qle(u,b){var A=(b=b||Pk(document))||Pk(document),B=sG(u),K=sG(A);if(!$a||9<=Number(_I)){Se=v2(A,"borderLeftWidth");var X=v2(A,"borderRightWidth");et=v2(A,"borderTopWidth"),Yt=v2(A,"borderBottomWidth"),X=new WC(parseFloat(et),parseFloat(X),parseFloat(Yt),parseFloat(Se))}else{var Se=b2(A,"borderLeft");X=b2(A,"borderRight");var et=b2(A,"borderTop"),Yt=b2(A,"borderBottom");X=new WC(et,X,Yt,Se)}A==Pk(document)?(Se=B.a-A.scrollLeft,B=B.g-A.scrollTop,!$a||10<=Number(_I)||(Se+=X.left,B+=X.top)):(Se=B.a-K.a-X.left,B=B.g-K.g-X.top),K=u.offsetWidth,X=u.offsetHeight,et=Kh&&!K&&!X,u=be(K)&&!et||!u.getBoundingClientRect?new KF(K,X):new KF((u=oG(u)).right-u.left,u.bottom-u.top),K=A.clientHeight-u.height,X=A.scrollLeft,et=A.scrollTop,A=new Xv(X+=Math.min(Se,Math.max(Se-(A.clientWidth-u.width),0)),et+=Math.min(B,Math.max(B-K,0))),b.scrollLeft=A.a,b.scrollTop=A.g}(A,u)),Ra(this,u,function(K){(K=(K=rH(K.target,"firebaseui-id-list-box-dialog-button"))&&O2(K,"listboxid"))&&(x2.call(B),b(K))})}function Ow(){return bo(this,"firebaseui-id-phone-number")}function R$(){return bo(this,"firebaseui-id-country-selector")}function h3(){return bo(this,"firebaseui-id-phone-number-error")}function xce(u,b){var K,A=u.a,B=d3("1-US-0",A);if(!(K=b&&d3(b,A)?b:B?"1-US-0":0<A.length?A[0].c:null))throw Error("No available default country");L2.call(this,K,u)}function d3(u,b){return!(!(u=kw(u))||!gs(b,u))}function p3(u){return"firebaseui-flag-"+u.f}function Ece(u){var b=this;bce.call(this,function Cce(u){return u.map(function(b){return{id:b.c,Ma:"firebaseui-flag "+p3(b),label:b.name+" \u200e+"+b.b}})}(u.a),function(A){L2.call(b,A,u,!0),b.O().focus()},this.Ba)}function L2(u,b,A){var B=kw(u);B&&(A&&(b=d2(b,A=Ep(Qc(Ow.call(this))||""))).length&&b[0].b!=B.b&&(A="+"+B.b+A.substr(b[0].b.length+1),$j(Ow.call(this),A)),b=kw(this.Ba),this.Ba=u,u=bo(this,"firebaseui-id-country-selector-flag"),b&&Hg(u,p3(b)),Ug(u,p3(B)),QF(bo(this,"firebaseui-id-country-selector-code"),"\u200e+"+B.b))}function cD(u,b,A,B,K,X,Se,et,Yt,Fn){xn.call(this,t$,{Gb:b,Aa:Yt||null,Va:!!A,ia:!!X},Fn,"phoneSignInStart",{F:B,D:K}),this.H=et||null,this.M=b,this.l=u,this.w=A||null,this.pa=Se||null}function P$(u,b,A,B){try{var K=b.U(qN)}catch{return}K?zI?(b.$("mdl-spinner mdl-spinner--single-color mdl-js-spinner is-active firebaseui-progress-dialog-loading-icon",zo("Verifying...").toString()),Dr(u,b.I(Zo(u.cc,u),[VN(K),A],function(X){var Se=xa(b);b.$("firebaseui-icon-done",zo("Code sent!").toString());var et=setTimeout(function(){b.h(),b.m(),Ei("phoneSignInFinish",u,Se,K,15,X)},1e3);Dr(u,function(){b&&b.h(),clearTimeout(et)})},function(X){if(b.h(),!X.name||"cancel"!=X.name){grecaptcha.reset(jj),zI=null;var Se=X&&X.message||"";if(X.code)switch(X.code){case"auth/too-many-requests":Se=zo("This phone number has been used too many times").toString();break;case"auth/invalid-phone-number":case"auth/missing-phone-number":return b.O().focus(),void Xc(b.B(),nN().toString());case"auth/admin-restricted-operation":if(Rw(Tn(u)))return X=xa(b),b.m(),void Ei("handleUnauthorizedUser",u,X,VN(K),Gi.Z.auth.PhoneAuthProvider.PROVIDER_ID);Se=_s(X);break;default:Se=_s(X)}b.a(Se)}}))):UC?Xc(b.u(),zo("Solve the reCAPTCHA").toString()):!UC&&B&&b.i().click():(b.O().focus(),Xc(b.B(),nN().toString()))}function uD(u,b,A,B,K){xn.call(this,e$,{Sb:b},K,"providerSignIn",{F:A,D:B}),this.i=u}function hD(u,b,A,B,K,X,Se){xn.call(this,wG,{email:A,Va:!!b,ia:!!X},Se,"signIn",{F:B,D:K}),this.i=u,this.u=b}function dD(u,b,A,B,K,X,Se){xn.call(this,zG,{kc:u,yb:A,Eb:!!B},Se,"unauthorizedUser",{F:K,D:X}),this.l=b,this.i=B}function pD(u,b,A,B,K,X){xn.call(this,BG,{email:u},X,"unsupportedProvider",{F:B,D:K}),this.l=b,this.i=A}function jg(u,b){this.$=!1;var A=f3(b);if(fD[A])throw Error('An AuthUI instance already exists for the key "'+A+'"');fD[A]=this,this.a=u,this.u=null,this.Y=!1,O$(this.a),this.h=Gi.Z.initializeApp({apiKey:u.app.options.apiKey,authDomain:u.app.options.authDomain},u.app.name+"-firebaseui-temp").auth(),(u=u.emulatorConfig)&&this.h.useEmulator(u.protocol+"://"+u.host+(null===(A=u.port)?"":":"+A),u.options),O$(this.h),this.h.setPersistence&&this.h.setPersistence(Gi.Z.auth.Auth.Persistence.SESSION),this.oa=b,this.ca=new Ple,this.g=this.T=this.i=this.J=this.O=null,this.s=[],this.Z=!1,this.l=vN.Xa(),this.j=this.C=null,this.da=this.A=!1}function O$(u){u&&u.INTERNAL&&u.INTERNAL.logFramework&&u.INTERNAL.logFramework("FirebaseUI-web")}E(cD,xn),cD.prototype.v=function(){this.ea(this.pa,this.H),this.P(this.l,this.w||void 0),this.M||$I(this,this.O(),this.i()),JC(this,this.i(),this.l),this.O().focus(),R2(this.O(),(this.O().value||"").length),xn.prototype.v.call(this)},cD.prototype.o=function(){this.w=this.l=null,xn.prototype.o.call(this)},No(cD.prototype,{Cb:n3,O:Ow,B:h3,ea:function(u,b,A){var B=this,K=Ow.call(this),X=R$.call(this),Se=h3.call(this),et=u||LI,Yt=et.a;if(0==Yt.length)throw Error("No available countries provided.");xce.call(B,et,b),Ra(this,X,function(){Ece.call(B,et)}),ZC(this,K,function(){qC(Se)&&(qa(K,!0),Ap(Se));var Fn=Ep(Qc(K)||""),Ai=kw(this.Ba),ls=d2(et,Fn);Fn=d3("1-US-0",Yt),ls.length&&ls[0].b!=Ai.b&&L2.call(B,"1"==(Ai=ls[0]).b&&Fn?"1-US-0":Ai.c,et)}),A&&GI(this,K,function(){A()})},U:function(u){var b=Ep(Qc(Ow.call(this))||""),A=(u=u||LI).a,B=d2(LI,b);if(B.length&&!gs(A,B[0]))throw $j(Ow.call(this)),Ow.call(this).focus(),Xc(h3.call(this),zo("The country code provided is not supported.").toString()),Error("The country code provided is not supported.");return A=kw(this.Ba),B.length&&B[0].b!=A.b&&L2.call(this,B[0].c,u),B.length&&(b=b.substr(B[0].b.length+1)),b?new Aj(this.Ba,b):null},Ja:R$,ba:function(){return bo(this,"firebaseui-recaptcha-container")},u:function(){return bo(this,"firebaseui-id-recaptcha-error")},i:xc,ua:Ul,P:eu}),Qo.phoneSignInStart=function(u,b,A,B){var K=function Ole(u){var b=null;if(f2(u).forEach(function(B){B.provider==Gi.Z.auth.PhoneAuthProvider.PROVIDER_ID&&si(B.recaptchaParameters)&&!Array.isArray(B.recaptchaParameters)&&(b=BF(B.recaptchaParameters))}),b){var A=[];Gle.forEach(function(B){typeof b[B]<"u"&&(A.push(B),delete b[B])}),A.length&&o0('The following provided "recaptchaParameters" keys are not allowed: '+A.join(", "))}return b}(Tn(u))||{};zI=null,UC=!(K&&"invisible"===K.size);var X=b$(u),Se=function Vle(u){var b=(u=Dp(u,Gi.Z.auth.PhoneAuthProvider.PROVIDER_ID))&&u.defaultCountry||null;b=b&&Sj(b);var A=null;return u&&"string"==typeof u.loginHint&&(A=Mj(u.loginHint)),b&&b[0]||A&&kw(A.a)||null}(Tn(u)),et=X?function Ble(u){var b=null;return(u=Dp(u,Gi.Z.auth.PhoneAuthProvider.PROVIDER_ID))&&"string"==typeof u.loginHint&&(b=Mj(u.loginHint)),u&&u.defaultNationalNumber||b&&b.Aa||null}(Tn(u)):null;Se=A&&A.a||Se&&Se.c||null,A=A&&A.Aa||et,(et=UN(Tn(u)))&&Dj(et),qN=et?new Tj(UN(Tn(u))):LI;var Yt=new cD(function(Ai){P$(u,Yt,Fn,!(!Ai||!Ai.keyCode))},UC,X?null:function(){Fn.clear(),Yt.m(),js(u,b)},hl(Tn(u)),dl(Tn(u)),X,qN,Se,A);Yt.render(b),Vr(u,Yt),B&&Yt.a(B),K.callback=function(Ai){Yt.u()&&Ap(Yt.u()),zI=Ai,UC||P$(u,Yt,Fn)},K["expired-callback"]=function(){zI=null};var Fn=new Gi.Z.auth.RecaptchaVerifier(UC?Yt.ba():Yt.i(),K,gm(u).app);Dr(u,Yt.I(Zo(Fn.render,Fn),[],function(Ai){jj=Ai},function(Ai){Ai.name&&"cancel"==Ai.name||(Ai=_s(Ai),Yt.m(),js(u,b,void 0,Ai))}))},Qo.prefilledEmailSignIn=function(u,b,A){var B=new P2;B.render(b),Vr(u,B),Dr(u,B.I(Zo(ao(u).fetchSignInMethodsForEmail,ao(u)),[A],function(K){B.m();var X=!(!I2(u)||!F$(u));x$(u,b,K,A,void 0,X)},function(K){K=_s(K),B.m(),Ei("signIn",u,b,A,K)}))},E(uD,xn),uD.prototype.v=function(){this.l(this.i),xn.prototype.v.call(this)},uD.prototype.o=function(){this.i=null,xn.prototype.o.call(this)},No(uD.prototype,{l:function(u){function b(Se){u(Se)}for(var A=this.g?YF("firebaseui-id-idp-button",this.g||this.s.a):[],B=0;B<A.length;B++){var K=A[B];Ra(this,K,xp(b,O2(K,"providerId")))}}}),Qo.providerSignIn=function(u,b,A,B){var K=new uD(function(X){X==Gi.Z.auth.EmailAuthProvider.PROVIDER_ID?(K.m(),o3(u,b,B)):X==Gi.Z.auth.PhoneAuthProvider.PROVIDER_ID?(K.m(),Ei("phoneSignInStart",u,b)):"anonymous"==X?function nce(u,b){Dr(u,b.I(Zo(u.$b,u),[],function(A){return b.m(),oy(u,b,A,!0)},function(A){A.name&&"cancel"==A.name||(Ip("ContinueAsGuest: "+A.code,void 0),A=_s(A),b.a(A))}))}(u,K):qI(u,K,X,B),wo(u),u.l.cancel()},Pj(Tn(u)),hl(Tn(u)),dl(Tn(u)));K.render(b),Vr(u,K),A&&K.a(A),function Ice(u){wo(u);try{$H(u.l,Oj(Tn(u)),function Tce(u){var b;return wo(u),(b=u.Z)||(b=!(!(u=Nj(u=Tn(u),Gi.Z.auth.GoogleAuthProvider.PROVIDER_ID))||"select_account"!==u.prompt)),b}(u)).then(function(b){return!!u.g&&function ice(u,b,A){if(A&&A.credential&&A.clientId===Oj(Tn(u))){if(Fj(Tn(u),Gi.Z.auth.GoogleAuthProvider.PROVIDER_ID).length){try{var K=JSON.parse(atob(A.credential.split(".")[1])).email}catch{}return qI(u,b,Gi.Z.auth.GoogleAuthProvider.PROVIDER_ID,K),Za(!0)}return function B(X){var Se=!1;return X=b.I(Zo(u.ac,u),[X],function(et){var Yt=xa(b);b.m(),Ei("callback",u,Yt,Za(et)),Se=!0},function(et){if(!(et.name&&"cancel"==et.name||et&&"auth/credential-already-in-use"==et.code))if(et&&"auth/email-already-in-use"==et.code&&et.email&&et.credential){var Yt=xa(b);b.m(),Ei("callback",u,Yt,IC(et))}else et&&"auth/admin-restricted-operation"==et.code&&Rw(Tn(u))?(et=xa(b),b.m(),Ei("handleUnauthorizedUser",u,et,null,Gi.Z.auth.GoogleAuthProvider.PROVIDER_ID)):(et=_s(et),b.a(et))}),Dr(u,X),X.then(function(){return Se},function(){return!1})}(Gi.Z.auth.GoogleAuthProvider.credential(A.credential))}return A&&b.a(zo("The selected credential for the authentication provider is not supported!").toString()),Za(!1)}(u,u.g,b)})}catch{}}(u)},Qo.sendEmailLinkForSignIn=function(u,b,A,B){var K=new D2;K.render(b),Vr(u,K),r3(u,K,A,B,function(X){K.m(),X&&"auth/admin-restricted-operation"==X.code&&Rw(Tn(u))?Ei("handleUnauthorizedUser",u,b,A,Gi.Z.auth.EmailAuthProvider.PROVIDER_ID):(X=_s(X),Ei("signIn",u,b,A,X))})},E(hD,xn),hD.prototype.v=function(){this.w(this.i),this.B(this.i,this.u||void 0),this.l().focus(),R2(this.l(),(this.l().value||"").length),xn.prototype.v.call(this)},hD.prototype.o=function(){this.u=this.i=null,xn.prototype.o.call(this)},No(hD.prototype,{l:ry,M:a0,w:XC,H:eE,j:tE,U:xc,P:Ul,B:eu}),Qo.signIn=function(u,b,A,B){var K=I2(u),X=new hD(function(){var Se=X,et=Se.j()||"";et&&w$(u,Se,et)},K?null:function(){X.m(),js(u,b,A)},A,hl(Tn(u)),dl(Tn(u)),K);X.render(b),Vr(u,X),B&&X.a(B)},E(dD,xn),dD.prototype.v=function(){var u=this,b=bo(this,"firebaseui-id-unauthorized-user-help-link");this.i&&b&&Ra(this,b,function(){u.i()}),Ra(this,this.u(),function(){u.l()}),this.u().focus(),xn.prototype.v.call(this)},dD.prototype.o=function(){this.i=this.l=null,xn.prototype.o.call(this)},No(dD.prototype,{u:Ul}),Qo.handleUnauthorizedUser=function(u,b,A,B){function K(){js(u,b)}B===Gi.Z.auth.EmailAuthProvider.PROVIDER_ID?K=function(){o3(u,b)}:B===Gi.Z.auth.PhoneAuthProvider.PROVIDER_ID&&(K=function(){Ei("phoneSignInStart",u,b)});var X=null,Se=null;B===Gi.Z.auth.EmailAuthProvider.PROVIDER_ID&&Lj(Tn(u))?(X=function Nle(u){return(u=Dp(u,Gi.Z.auth.EmailAuthProvider.PROVIDER_ID))&&u.disableSignUp&&u.disableSignUp.adminEmail||null}(Tn(u)),Se=function zle(u){if((u=Dp(u,Gi.Z.auth.EmailAuthProvider.PROVIDER_ID))&&u.disableSignUp){var b=u.disableSignUp.helpLink||null;if(b&&"string"==typeof b)return function(){AC(b)}}return null}(Tn(u))):Rw(Tn(u))&&(X=function Lle(u){return(u=u.a.get("adminRestrictedOperation"))&&u.adminEmail?u.adminEmail:null}(Tn(u)),Se=function Fle(u){if(u=u.a.get("adminRestrictedOperation")||null){var b=u.helpLink||null;if(b&&"string"==typeof b)return function(){AC(b)}}return null}(Tn(u)));var et=new dD(A,function(){et.m(),K()},X,Se,hl(Tn(u)),dl(Tn(u)));et.render(b),Vr(u,et)},E(pD,xn),pD.prototype.v=function(){this.w(this.l,this.i),this.u().focus(),xn.prototype.v.call(this)},pD.prototype.o=function(){this.i=this.l=null,xn.prototype.o.call(this)},No(pD.prototype,{u:xc,B:Ul,w:eu}),Qo.unsupportedProvider=function(u,b,A){var B=new pD(A,function(){B.m(),Ei("passwordRecovery",u,b,A)},function(){B.m(),js(u,b,A)},hl(Tn(u)),dl(Tn(u)));B.render(b),Vr(u,B)};var fD={};function f3(u){return u||"[DEFAULT]"}function L$(u){return wo(u),u.i||(u.i=sy(u,function(b){return b&&!Bg(rr(u))?Za(gm(u).getRedirectResult().then(function(A){return A},function(A){if(A&&"auth/email-already-in-use"==A.code&&A.email&&A.credential)throw A;return c0(u,A)})):Za(ao(u).getRedirectResult().then(function(A){return p2(Tn(u))&&!A.user&&u.j&&!u.j.isAnonymous?gm(u).getRedirectResult():A}))})),u.i}function Vr(u,b){wo(u),u.g=b}var oE=null;function ao(u){return wo(u),u.h}function gm(u){return wo(u),u.a}function rr(u){return wo(u),u.oa}function F$(u){return wo(u),u.O?u.O.emailHint:void 0}function N$(u){return"signIn"===((u=new bw(u)).a.a.get(zl.ub)||null)&&!!u.a.a.get(zl.$a)}function z$(u,b,A,B){wo(u),typeof u.a.languageCode<"u"&&(u.u=u.a.languageCode);var K="en".replace(/_/g,"-");u.a.languageCode=K,u.h.languageCode=K,u.Y=!0,typeof u.a.tenantId<"u"&&(u.h.tenantId=u.a.tenantId),u.ib(A),u.O=B||null;var X=se.document;u.C?u.C.then(function(){"complete"==X.readyState?F2(u,b):TI(window,"load",function(){F2(u,b)})}):"complete"==X.readyState?F2(u,b):TI(window,"load",function(){F2(u,b)})}function F2(u,b){var A=Gk(b,"Could not find the FirebaseUI widget element on the page.");if(A.setAttribute("lang","en".replace(/_/g,"-")),oE){var B=oE;wo(B),Bg(rr(B))&&o0("UI Widget is already rendered on the page and is pending some user interaction. Only one widget instance can be rendered per page. The previous instance has been automatically reset."),oE.reset()}if(oE=u,u.T=A,function Sce(u,b){u.L=null,u.J=new Hk(b),u.J.register(),fm(u.J,"pageEnter",function(A){if(u.L!=(A=A&&A.pageId)){var B=Tn(u);(B=NI(B).uiChanged||null)&&B(u.L,A),u.L=A}})}(u,A),h2(new kN)&&h2(new RN)){b=Gk(b,"Could not find the FirebaseUI widget element on the page."),A=(A=Dk(A=iy(),B=zN(Tn(u).a,"queryParameterForSignInSuccessUrl")))?Jv(Mk(A)).toString():null;e:{B=iy();var K=zj(Tn(u));for(X in B=Dk(B,K)||"",ZN)if(ZN[X].toLowerCase()==B.toLowerCase()){var X=ZN[X];break e}X="callback"}switch(X){case"callback":A&&(X=rr(u),NC(PI,A,X)),u.nb()?Ei("callback",u,b):js(u,b,F$(u));break;case"resetPassword":Ei("passwordReset",u,b,KI(),s3());break;case"recoverEmail":Ei("emailChangeRevocation",u,b,KI());break;case"revertSecondFactorAddition":Ei("revertSecondFactorAddition",u,b,KI());break;case"verifyEmail":Ei("emailVerification",u,b,KI(),s3());break;case"verifyAndChangeEmail":Ei("verifyAndChangeEmail",u,b,KI(),s3());break;case"signIn":Ei("emailLinkSignInCallback",u,b,iy()),H$();break;case"select":A&&(X=rr(u),NC(PI,A,X)),js(u,b);break;default:throw Error("Unhandled widget operation.")}(b=NI(b=Tn(u)).uiShown||null)&&b()}else b=Gk(b,"Could not find the FirebaseUI widget element on the page."),(X=new y$(zo("The browser you are using does not support Web Storage. Please try again in a different browser.").toString())).render(b),Vr(u,X);b=u.g&&"blank"==u.g.Ga&&HN(Tn(u)),LN(rr(u))&&!b&&(U$(u,(b=LN(rr(u))).a),Ud(Mw,rr(u)))}function sy(u,b){if(u.A)return b(B$(u));if(Dr(u,function(){u.A=!1}),p2(Tn(u))){var A=new Vl(function(B){Dr(u,u.a.onAuthStateChanged(function(K){u.j=K,u.A||(u.A=!0,B(b(B$(u))))}))});return Dr(u,A),A}return u.A=!0,b(null)}function B$(u){return wo(u),p2(Tn(u))&&u.j&&u.j.isAnonymous?u.j:null}function Dr(u,b){if(wo(u),b){u.s.push(b);var A=function(){!function pI(u,b){!function Ng(u,b){for(var A=Me(u)?u.split(""):u,B=u.length-1;0<=B;--B)B in A&&b.call(void 0,A[B],B,u)}(u,function(B,K){b.call(void 0,B,K,u)&&Lu(u,K)})}(u.s,function(B){return B==b})};"function"!=typeof b&&b.then(A,A)}}function V$(u){typeof u.a.languageCode<"u"&&u.Y&&(u.Y=!1,u.a.languageCode=u.u)}function U$(u,b){u.a.tenantId=b,u.h.tenantId=b}function Tn(u){return wo(u),u.ca}function wo(u){if(u.$)throw Error("AuthUI instance is deleted!")}function H$(){var u=iy();if(N$(u)){for(var b in u=new bw(u),zl)zl.hasOwnProperty(b)&&vw(u.a.a,zl[b]);b={state:"signIn",mode:"emailLink",operation:"clear"},se.history&&se.history.replaceState&&se.history.replaceState(b,se.document.title,u.toString())}}function l0(u){return wo(u),ao(u).signOut()}function c0(u,b,A){if(wo(u),b&&b.code&&("auth/email-already-in-use"==b.code||"auth/credential-already-in-use"==b.code)){var B=Hj(Tn(u));return Za().then(function(){return B(new wI("anonymous-upgrade-merge-conflict",null,A||b.credential))}).then(function(){throw u.g&&(u.g.m(),u.g=null),b})}return IC(b)}function mD(u,b,A,B){xn.call(this,o$,void 0,B,"providerMatchByEmail",{F:b,D:A}),this.i=u}function N2(u,b,A,B,K){xn.call(this,r$,{ec:b},K,"selectTenant",{F:A,D:B}),this.i=u}function m3(u){xn.call(this,IG,void 0,u,"spinner")}function Oce(u){for(var b in this.a=new FN,ul(this.a,"authDomain"),ul(this.a,"displayMode",B2),ul(this.a,"tenants"),ul(this.a,"callbacks"),ul(this.a,"tosUrl"),ul(this.a,"privacyPolicyUrl"),u)if(u.hasOwnProperty(b))try{NN(this.a,b,u[b])}catch{Ip('Invalid config: "'+b+'"',void 0)}}function z2(u){return u.a.get("callbacks")||{}}function j$(u){var b=u.a.get("tosUrl")||null;if(u=u.a.get("privacyPolicyUrl")||null,b&&!u&&o0("Privacy Policy URL is missing, the link will not be displayed."),b&&u){if("function"==typeof b)return b;if("string"==typeof b)return function(){AC(b)}}return null}function G$(u){var b=u.a.get("tosUrl")||null,A=u.a.get("privacyPolicyUrl")||null;if(A&&!b&&o0("Terms of Service URL is missing, the link will not be displayed."),b&&A){if("function"==typeof A)return A;if("string"==typeof A)return function(){AC(A)}}return null}function g3(u,b){if(!(u=u.a.get("tenants"))||!u.hasOwnProperty(b)&&!u.hasOwnProperty(V2))throw Error("Invalid tenant configuration!")}function $$(u,b,A){if(!(u=u.a.get("tenants")))throw Error("Invalid tenant configuration!");var B=[];if(!(u=u[b]||u[V2]))return Ip("Invalid tenant configuration: "+b+" is not configured!",void 0),B;if(!(b=u.signInOptions))throw Error("Invalid tenant configuration: signInOptions are invalid!");return b.forEach(function(K){if("string"==typeof K)B.push(K);else if("string"==typeof K.provider){var X=K.hd;X&&A?(X instanceof RegExp?X:new RegExp("@"+X.replace(".","\\.")+"$")).test(A)&&B.push(K.provider):B.push(K.provider)}else Ip(K="Invalid tenant configuration: signInOption "+JSON.stringify(K)+" is invalid!",void 0)}),B}(n=jg.prototype).nb=function(){return wo(this),!!LN(rr(this))||N$(iy())},n.start=function(u,b){z$(this,u,b)},n.Db=function(){wo(this),this.Z=!0},n.reset=function(){wo(this);var u=this;this.T&&this.T.removeAttribute("lang"),this.J&&function ole(u){var b=uN(u.N());Sp[b]&&Sp[b].length&&(function vC(u,b){e:{for(var A=u.length,B=Me(u)?u.split(""):u,K=0;K<A;K++)if(K in B&&b.call(void 0,B[K],K,u)){b=K;break e}b=-1}0<=b&&Lu(u,b)}(Sp[b],function(A){return A==u}),Sp[b].length||delete Sp[b])}(this.J),V$(this),this.O=null,H$(),Ud(Mw,rr(this)),wo(this),this.l.cancel(),this.i=Za({user:null,credential:null}),oE==this&&(oE=null),this.T=null;for(var b=0;b<this.s.length;b++)"function"==typeof this.s[b]?this.s[b]():this.s[b].cancel&&this.s[b].cancel();this.s=[],Vg(rr(this)),this.g&&(this.g.m(),this.g=null),this.L=null,this.h&&(this.C=l0(this).then(function(){u.C=null},function(){u.C=null}))},n.ib=function(u){wo(this);var A,b=this.ca;for(A in u)try{NN(b.a,A,u[A])}catch{Ip('Invalid config: "'+A+'"',void 0)}Iae&&NN(b.a,"popupMode",!1),UN(b),!this.da&&jN(Tn(this))&&(o0("signInSuccess callback is deprecated. Please use signInSuccessWithAuthResult callback instead."),this.da=!0)},n.Wb=function(){wo(this);var u=Tn(this),b=zN(u.a,"widgetUrl");u=zj(u);for(var K,A=b.search(L5),B=0,X=[];0<=(K=O5(b,B,u,A));)X.push(b.substring(B,K)),B=Math.min(b.indexOf("&",K)+1||A,A);X.push(b.substr(B)),b=X.join("").replace(gae,"$1"),(u+=A="="+encodeURIComponent("select"))?(0>(A=b.indexOf("#"))&&(A=b.length),0>(B=b.indexOf("?"))||B>A?(B=A,K=""):K=b.substring(B+1,A),A=(b=[b.substr(0,B),K,b.substr(A)])[1],b[1]=u?A?A+"&"+u:u:A,A=b[0]+(b[1]?"?"+b[1]:"")+b[2]):A=b,Tn(this).a.get("popupMode")?(A=A||"about:blank",(u={width:500,height:600,top:0<(u=(window.screen.availHeight-600)/2)?u:0,left:0<(b=(window.screen.availWidth-500)/2)?b:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1}).target=u.target||A.target||"google_popup",u.width=u.width||690,u.height=u.height||500,(u=BH(A,u))&&u.focus()):SC(window.location,A)},n.Wa=function(){var u=this;return wo(this),this.h.app.delete().then(function(){var b=f3(rr(u));delete fD[b],u.reset(),u.$=!0})},n.Ib=function(u,b){wo(this);var A=this,B=function dle(){for(var u=32,b=[];0<u;)b.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),u--;return b.join("")}();if(!VC(Tn(this)))return IC(Error("Email link sign-in should be enabled to trigger email sending."));var K=function Hle(u){if(VC(u)){var b={url:iy(),handleCodeInApp:!0};(u=Dp(u,Gi.Z.auth.EmailAuthProvider.PROVIDER_ID))&&"function"==typeof u.emailLinkSignIn&&Tk(b,u.emailLinkSignIn()),u=b.url;var A=iy();A instanceof Zv||(A=jF(A)),u instanceof Zv||(u=jF(u));var B=A;A=new Zv(B);var K=!!u.j;K?VF(A,u.j):K=!!u.A,K?A.A=u.A:K=!!u.h,K?A.h=u.h:K=null!=u.C;var X=u.g;if(K)UF(A,u.C);else if(K=!!u.g)if("/"!=X.charAt(0)&&(B.h&&!B.g?X="/"+X:-1!=(B=A.g.lastIndexOf("/"))&&(X=A.g.substr(0,B+1)+X)),".."==X||"."==X)X="";else if(-1!=X.indexOf("./")||-1!=X.indexOf("/.")){B=0==X.lastIndexOf("/",0),X=X.split("/");for(var Se=[],et=0;et<X.length;){var Yt=X[et++];"."==Yt?B&&et==X.length&&Se.push(""):".."==Yt?((1<Se.length||1==Se.length&&""!=Se[0])&&Se.pop(),B&&et==X.length&&Se.push("")):(Se.push(Yt),B=!0)}X=Se.join("/")}return K?A.g=X:K=""!==u.a.toString(),K?HF(A,z5(u.a)):K=!!u.s,K&&(A.s=u.s),b.url=A.toString(),b}return null}(Tn(this)),X=new bw(K.url);return function Cae(u,b){b?u.a.a.set(zl.Sa,b):vw(u.a.a,zl.Sa)}(X,B),b&&b.a&&(function Rle(u,b,A){NC(OI,dj(u,JSON.stringify(nj(b))),A)}(B,b,rr(this)),V5(X,b.a.providerId)),function Eae(u,b){null!==b?u.a.a.set(zl.Qa,b?"1":"0"):vw(u.a.a,zl.Qa)}(X,function Ule(u){return!(!(u=Dp(u,Gi.Z.auth.EmailAuthProvider.PROVIDER_ID))||!u.forceSameDevice)}(Tn(this))),sy(this,function(Se){return Se&&((Se=Se.uid)?X.a.a.set(zl.Pa,Se):vw(X.a.a,zl.Pa)),K.url=X.toString(),ao(A).sendSignInLinkToEmail(u,K)}).then(function(){var Se=rr(A),et={};et.email=u,NC(LC,dj(B,JSON.stringify(et)),Se)},function(Se){throw Ud(OI,rr(A)),Ud(LC,rr(A)),Se})},n.bc=function(u,b){wo(this);var A=this;return ao(this).signInWithEmailAndPassword(u,b).then(function(B){return sy(A,function(K){return K?l0(A).then(function(){return c0(A,{code:"auth/email-already-in-use"},Gi.Z.auth.EmailAuthProvider.credential(u,b))}):B})})},n.Yb=function(u,b){wo(this);var A=this;return sy(this,function(B){if(B){var K=Gi.Z.auth.EmailAuthProvider.credential(u,b);return B.linkWithCredential(K)}return ao(A).createUserWithEmailAndPassword(u,b)})},n.ac=function(u){wo(this);var b=this;return sy(this,function(A){return A?A.linkWithCredential(u).then(function(B){return B},function(B){if(B&&"auth/email-already-in-use"==B.code&&B.email&&B.credential)throw B;return c0(b,B,u)}):ao(b).signInWithCredential(u)})},n.dc=function(u){wo(this);var b=this,A=this.i;return this.i=null,sy(this,function(B){return B&&!Bg(rr(b))?B.linkWithRedirect(u):ao(b).signInWithRedirect(u)}).then(function(){},function(B){throw b.i=A,B})},n.cc=function(u,b){wo(this);var A=this;return sy(this,function(B){return B?B.linkWithPhoneNumber(u,b).then(function(K){return new wN(K,function(X){if("auth/credential-already-in-use"==X.code)return c0(A,X);throw X})}):gm(A).signInWithPhoneNumber(u,b).then(function(K){return new wN(K)})})},n.$b=function(){return wo(this),gm(this).signInAnonymously()},n.Xb=function(u,b){return wo(this),ao(this).signInWithEmailAndPassword(u,b)},E(mD,xn),mD.prototype.v=function(){this.u(this.i),this.w(this.i),this.l().focus(),R2(this.l(),(this.l().value||"").length),xn.prototype.v.call(this)},mD.prototype.o=function(){this.i=null,xn.prototype.o.call(this)},No(mD.prototype,{l:ry,H:a0,u:XC,B:eE,j:tE,M:xc,w:eu}),E(N2,xn),N2.prototype.v=function(){(function Pce(u,b){function A(et){b(et)}for(var B=u.g?YF("firebaseui-id-tenant-selection-button",u.g||u.s.a):[],K=0;K<B.length;K++){var X=B[K];Ra(u,X,xp(A,O2(X,"tenantId")))}})(this,this.i),xn.prototype.v.call(this)},N2.prototype.o=function(){this.i=null,xn.prototype.o.call(this)},E(m3,xn);var zce=["immediateFederatedRedirect","privacyPolicyUrl","signInFlow","signInOptions","tosUrl"],B2="optionFirst",_3={pc:B2,oc:"identifierFirst"},V2="*";function _m(u,b){var A=this;this.s=Gk(u),this.a={},Object.keys(b).forEach(function(B){A.a[B]=new Oce(b[B])}),this.ob=this.g=this.A=this.h=this.i=this.j=null,Object.defineProperty(this,"languageCode",{get:function(){return this.ob},set:function(B){this.ob=B||null},enumerable:!1})}function u0(u){u.j&&u.j.reset(),u.mb(),u.g&&u.g.m()}(n=_m.prototype).Ub=function(u,b){var A=this;u0(this);var B=u.apiKey;return new Vl(function(K,X){if(A.a.hasOwnProperty(B)){var Se=z2(A.a[B]).selectTenantUiHidden||null;if(function Lce(u){for(var b in u=u.a.get("displayMode"),_3)if(_3[b]===u)return _3[b];return B2}(A.a[B])===B2){var et=[];b.forEach(function(Ai){Ai=Ai||"_";var ls=A.a[B].a.get("tenants");if(!ls)throw Error("Invalid tenant configuration!");(ls=ls[Ai]||ls[V2])?Ai={tenantId:"_"!==Ai?Ai:null,V:ls.fullLabel||null,displayName:ls.displayName,za:ls.iconUrl,ta:ls.buttonColor}:(Ip("Invalid tenant configuration: "+Ai+" is not configured!",void 0),Ai=null),Ai&&et.push(Ai)});var Yt=function(Ai){Ai={tenantId:Ai,providerIds:$$(A.a[B],Ai||"_")},K(Ai)};if(1===et.length)return void Yt(et[0].tenantId);A.g=new N2(function(Ai){u0(A),Se&&Se(),Yt(Ai)},et,j$(A.a[B]),G$(A.a[B]))}else A.g=new mD(function(){var Ai=A.g.j();if(Ai){for(var ls=0;ls<b.length;ls++){var ym=$$(A.a[B],b[ls]||"_",Ai);if(0!==ym.length)return Ai={tenantId:b[ls],providerIds:ym,email:Ai},u0(A),Se&&Se(),void K(Ai)}A.g.a(dH({code:"no-matching-tenant-for-email"}).toString())}},j$(A.a[B]),G$(A.a[B]));A.g.render(A.s),(X=z2(A.a[B]).selectTenantUiShown||null)&&X()}else{var Fn=Error("Invalid project configuration: API key is invalid!");Fn.code="invalid-configuration",A.pb(Fn),X(Fn)}})},n.Pb=function(u,b){if(!this.a.hasOwnProperty(u))throw Error("Invalid project configuration: API key is invalid!");var A=b||void 0;g3(this.a[u],b||"_");try{this.i=Gi.Z.app(A).auth()}catch{var B=this.a[u].a.get("authDomain");if(!B)throw Error("Invalid project configuration: authDomain is required!");(u=Gi.Z.initializeApp({apiKey:u,authDomain:B},A)).auth().tenantId=b,this.i=u.auth()}return this.i},n.Zb=function(u,b){var A=this;return new Vl(function(B,K){function X(ls,ym){A.j=new jg(u),z$(A.j,A.s,ls,ym)}var Se=u.app.options.apiKey;A.a.hasOwnProperty(Se)||K(Error("Invalid project configuration: API key is invalid!"));var et=function Fce(u,b,A){return u=function Nce(u,b){var A=zce,B=void 0===B?{}:B;return g3(u,b),function ple(u,b,A){return A=void 0===A?{}:A,Object.keys(u).filter(function(B){return b.includes(B)}).reduce(function(B,K){return B[K]=u[K],B},A)}((u=u.a.get("tenants"))[b]||u[V2],A,B)}(u,b),(b=u.signInOptions)&&A&&(b=b.filter(function(B){return A.includes("string"==typeof B?B:B.provider)}),u.signInOptions=b),u}(A.a[Se],u.tenantId||"_",b&&b.providerIds);u0(A),K={signInSuccessWithAuthResult:function(ls){return B(ls),!1}};var Ai,Yt=z2(A.a[Se]).signInUiShown||null,Fn=!1;K.uiChanged=function(ls,ym){null===ls&&"callback"===ym?((ls=JF("firebaseui-id-page-callback",A.s))&&Ap(ls),A.h=new m3,A.h.render(A.s)):Fn||null===ls&&"spinner"===ym||"blank"===ym||(A.h&&(A.h.m(),A.h=null),Fn=!0,Yt&&Yt(u.tenantId))},et.callbacks=K,et.credentialHelper="none",b&&b.email&&(Ai={emailHint:b.email}),A.j?A.j.Wa().then(function(){X(et,Ai)}):X(et,Ai)})},n.reset=function(){var u=this;return Za().then(function(){u.j&&u.j.Wa()}).then(function(){u.j=null,u0(u)})},n.Vb=function(){var u=this;this.h||this.A||(this.A=window.setTimeout(function(){u0(u),u.h=new m3,u.g=u.h,u.h.render(u.s),u.A=null},500))},n.mb=function(){window.clearTimeout(this.A),this.A=null,this.h&&(this.h.m(),this.h=null)},n.Bb=function(){return u0(this),this.g=new p$,this.g.render(this.s),Za()},n.pb=function(u){var B,b=this,A=dH({code:u.code}).toString()||u.message;u0(this),u.retry&&"function"==typeof u.retry&&(B=function(){b.reset(),u.retry()}),this.g=new _$(A,B),this.g.render(this.s)},n.Rb=function(u){var b=this;return Za().then(function(){var A=b.i&&b.i.app.options.apiKey;if(!b.a.hasOwnProperty(A))throw Error("Invalid project configuration: API key is invalid!");if(g3(b.a[A],u.tenantId||"_"),!b.i.currentUser||b.i.currentUser.uid!==u.uid)throw Error("The user being processed does not match the signed in user!");return(A=z2(b.a[A]).beforeSignInSuccess||null)?A(u):u}).then(function(A){if(A.uid!==u.uid)throw Error("User with mismatching UID returned.");return A})},Hs("firebaseui.auth.FirebaseUiHandler",_m),Hs("firebaseui.auth.FirebaseUiHandler.prototype.selectTenant",_m.prototype.Ub),Hs("firebaseui.auth.FirebaseUiHandler.prototype.getAuth",_m.prototype.Pb),Hs("firebaseui.auth.FirebaseUiHandler.prototype.startSignIn",_m.prototype.Zb),Hs("firebaseui.auth.FirebaseUiHandler.prototype.reset",_m.prototype.reset),Hs("firebaseui.auth.FirebaseUiHandler.prototype.showProgressBar",_m.prototype.Vb),Hs("firebaseui.auth.FirebaseUiHandler.prototype.hideProgressBar",_m.prototype.mb),Hs("firebaseui.auth.FirebaseUiHandler.prototype.completeSignOut",_m.prototype.Bb),Hs("firebaseui.auth.FirebaseUiHandler.prototype.handleError",_m.prototype.pb),Hs("firebaseui.auth.FirebaseUiHandler.prototype.processUser",_m.prototype.Rb),Hs("firebaseui.auth.AuthUI",jg),Hs("firebaseui.auth.AuthUI.getInstance",function(u){return u=f3(u),fD[u]?fD[u]:null}),Hs("firebaseui.auth.AuthUI.prototype.disableAutoSignIn",jg.prototype.Db),Hs("firebaseui.auth.AuthUI.prototype.start",jg.prototype.start),Hs("firebaseui.auth.AuthUI.prototype.setConfig",jg.prototype.ib),Hs("firebaseui.auth.AuthUI.prototype.signIn",jg.prototype.Wb),Hs("firebaseui.auth.AuthUI.prototype.reset",jg.prototype.reset),Hs("firebaseui.auth.AuthUI.prototype.delete",jg.prototype.Wa),Hs("firebaseui.auth.AuthUI.prototype.isPendingRedirect",jg.prototype.nb),Hs("firebaseui.auth.AuthUIError",wI),Hs("firebaseui.auth.AuthUIError.prototype.toJSON",wI.prototype.toJSON),Hs("firebaseui.auth.CredentialHelper.GOOGLE_YOLO",GN),Hs("firebaseui.auth.CredentialHelper.NONE",m2),Hs("firebaseui.auth.AnonymousAuthProvider.PROVIDER_ID","anonymous"),Vl.prototype.catch=Vl.prototype.Ca,Vl.prototype.finally=Vl.prototype.fc}).apply(typeof global<"u"?global:typeof self<"u"?self:window)}.apply(typeof global<"u"?global:typeof self<"u"?self:window),typeof window<"u"&&(window.dialogPolyfill=s7());var TU=firebaseui.auth;let SU=(()=>{class n{constructor(e,i,r,a){const g=(0,qc.on)(e,a,i),E=r;if(!window.firebaseUiInstance){const O=g.auth();if(E){const j=E[0].startsWith("http")?E[0]:`http://${E.join(":")}`;O.useEmulator(j)}window.firebaseUiInstance=new TU.AuthUI(O)}this.firebaseUiInstance=window.firebaseUiInstance}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(qc.Dh),o.LFG(qc.xv,8),o.LFG(z_,8),o.LFG(o.R0b))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})(),a7=(()=>{class n{constructor(e,i,r,a,g){this.angularFireAuth=e,this._firebaseUiConfig=i,this._firebaseUiConfig_Feature=r,this.ngZone=a,this.firebaseUIService=g,this.signInSuccessWithAuthResultCallback=new o.vpe,this.signInFailureCallback=new o.vpe,this.uiShownCallback=new o.vpe}get firebaseUiConfig(){return{...this._firebaseUiConfig,...this._firebaseUiConfig_Feature}}ngOnInit(){this.subscription=this.angularFireAuth.authState.subscribe(e=>{if(e&&e.isAnonymous||!e){if(0===this.firebaseUiConfig.signInOptions.length)throw new Error("There must be at least one AuthProvider.");this.firebaseUIPopup()}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}getUIAuthConfig(){return this.firebaseUiConfig.callbacks||(this._firebaseUiConfig[n.COMPUTED_CALLBACKS]=!0,this._firebaseUiConfig.callbacks=this.getCallbacks()),this.firebaseUiConfig}firebaseUIPopup(){const e=this.firebaseUIService.firebaseUiInstance,i=this.getUIAuthConfig();let r=!1;i[n.COMPUTED_CALLBACKS]&&(r=!0,delete i[n.COMPUTED_CALLBACKS]),e.start("#firebaseui-auth-container",i),r&&(this._firebaseUiConfig.callbacks=null)}getCallbacks(){return{signInSuccessWithAuthResult:(a,g)=>(this.ngZone.run(()=>{this.signInSuccessWithAuthResultCallback.emit({authResult:a,redirectUrl:g})}),this.firebaseUiConfig.signInSuccessUrl),signInFailure:a=>(this.ngZone.run(()=>{this.signInFailureCallback.emit({code:a.code,credential:a.credential})}),Promise.reject()),uiShown:()=>{this.ngZone.run(()=>{this.uiShownCallback.emit()})}}}}return n.COMPUTED_CALLBACKS="COMPUTED_CALLBACKS",n.\u0275fac=function(e){return new(e||n)(o.Y36(fb),o.Y36("firebaseUIAuthConfig"),o.Y36("firebaseUIAuthConfigFeature"),o.Y36(o.R0b),o.Y36(SU))},n.\u0275cmp=o.Xpm({type:n,selectors:[["firebase-ui"]],outputs:{signInSuccessWithAuthResultCallback:"signInSuccessWithAuthResult",signInFailureCallback:"signInFailure",uiShownCallback:"uiShown"},decls:1,vars:0,consts:[["id","firebaseui-auth-container"]],template:function(e,i){1&e&&o._UZ(0,"div",0)},encapsulation:2}),n})();const l7=Gi.Z,c7=pe;let u7=(()=>{class n{static forRoot(e){return{ngModule:n,providers:[{provide:"firebaseUIAuthConfig",useValue:e},{provide:"firebaseUIAuthConfigFeature",useValue:{}}]}}static forFeature(e){return{ngModule:n,providers:[{provide:"firebaseUIAuthConfigFeature",useValue:e}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({providers:[SU],imports:[tr]}),n})();class $h extends Es.x{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:i}=this;if(t)throw e;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}var h7=Ee(233),IU=Ee(5032);function p7(n,t,e,i,r){return(a,g)=>{let E=e,O=t,j=0;a.subscribe((0,P.x)(g,Y=>{const se=j++;O=E?n(O,Y,se):(E=!0,Y),i&&g.next(O)},r&&(()=>{E&&g.next(O),g.complete()})))}}function J1(n,t){return(0,k.e)(p7(n,t,arguments.length>=2,!0))}function DU(n,t=am.y){return n=n??m7,(0,k.e)((e,i)=>{let r,a=!0;e.subscribe((0,P.x)(i,g=>{const E=t(g);(a||!n(r,E))&&(a=!1,r=E,i.next(g))}))})}function m7(n,t){return n===t}const TS={};function g7(n,t){if(TS[n]=(TS[n]||0)+1,"function"==typeof t)return pL(n,(...i)=>({...t(...i),type:n}));switch(t?t._as:"empty"){case"empty":return pL(n,()=>({type:n}));case"props":return pL(n,i=>({...i,type:n}));default:throw new Error("Unexpected config.")}}function pL(n,t){return Object.defineProperty(t,"type",{value:n,writable:!1})}function AU(n){const{source:t,events:e}=n;return Object.keys(e).reduce((i,r)=>({...i,[_7(r)]:g7(y7(t,r),e[r])}),{})}function _7(n){return n.trim().toLowerCase().split(" ").map((t,e)=>0===e?t:function fL(n){return n.charAt(0).toUpperCase()+n.substring(1)}(t)).join("")}function y7(n,t){return`[${n}] ${t}`}const MU="@ngrx/store/init";let tw=(()=>{class n extends $h{constructor(){super({type:MU})}next(e){if("function"==typeof e)throw new TypeError("\n        Dispatch expected an object, instead it received a function.\n        If you're using the createAction function, make sure to invoke the function\n        before dispatching the action. For example, someAction should be someAction().");if(typeof e>"u")throw new TypeError("Actions must be objects");if(typeof e.type>"u")throw new TypeError("Actions must have a type property");super.next(e)}complete(){}ngOnDestroy(){super.complete()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();const v7=[tw],mL=new o.OlP("@ngrx/store Internal Root Guard"),kU=new o.OlP("@ngrx/store Internal Initial State"),gL=new o.OlP("@ngrx/store Initial State"),RU=new o.OlP("@ngrx/store Reducer Factory"),PU=new o.OlP("@ngrx/store Internal Reducer Factory Provider"),OU=new o.OlP("@ngrx/store Initial Reducers"),_L=new o.OlP("@ngrx/store Internal Initial Reducers"),LU=new o.OlP("@ngrx/store Store Features"),FU=new o.OlP("@ngrx/store Internal Store Reducers"),yL=new o.OlP("@ngrx/store Internal Feature Reducers"),NU=new o.OlP("@ngrx/store Internal Feature Configs"),vL=new o.OlP("@ngrx/store Internal Store Features"),zU=new o.OlP("@ngrx/store Internal Feature Reducers Token"),bL=new o.OlP("@ngrx/store Feature Reducers"),BU=new o.OlP("@ngrx/store User Provided Meta Reducers"),VM=new o.OlP("@ngrx/store Meta Reducers"),VU=new o.OlP("@ngrx/store Internal Resolved Meta Reducers"),UU=new o.OlP("@ngrx/store User Runtime Checks Config"),HU=new o.OlP("@ngrx/store Internal User Runtime Checks Config"),SS=new o.OlP("@ngrx/store Internal Runtime Checks"),IS=new o.OlP("@ngrx/store Check if Action types are unique");function xL(n,t={}){const e=Object.keys(n),i={};for(let a=0;a<e.length;a++){const g=e[a];"function"==typeof n[g]&&(i[g]=n[g])}const r=Object.keys(i);return function(g,E){g=void 0===g?t:g;let O=!1;const j={};for(let Y=0;Y<r.length;Y++){const se=r[Y],Me=g[se],Ge=(0,i[se])(Me,E);j[se]=Ge,O=O||Ge!==Me}return O?j:g}}function GU(...n){return function(t){if(0===n.length)return t;const e=n[n.length-1];return n.slice(0,-1).reduceRight((r,a)=>a(r),e(t))}}function $U(n,t){return Array.isArray(t)&&t.length>0&&(n=GU.apply(null,[...t,n])),(e,i)=>{const r=n(e);return(a,g)=>r(a=void 0===a?i:a,g)}}new o.OlP("@ngrx/store Root Store Provider"),new o.OlP("@ngrx/store Feature State Provider");class UM extends w.y{}class WU extends tw{}let DS=(()=>{class n extends $h{constructor(e,i,r,a){super(a(r,i)),this.dispatcher=e,this.initialState=i,this.reducers=r,this.reducerFactory=a}get currentReducers(){return this.reducers}addFeature(e){this.addFeatures([e])}addFeatures(e){const i=e.reduce((r,{reducers:a,reducerFactory:g,metaReducers:E,initialState:O,key:j})=>{const Y="function"==typeof a?function w7(n){const t=Array.isArray(n)&&n.length>0?GU(...n):e=>e;return(e,i)=>(e=t(e),(r,a)=>e(r=void 0===r?i:r,a))}(E)(a,O):$U(g,E)(a,O);return r[j]=Y,r},{});this.addReducers(i)}removeFeature(e){this.removeFeatures([e])}removeFeatures(e){this.removeReducers(e.map(i=>i.key))}addReducer(e,i){this.addReducers({[e]:i})}addReducers(e){this.reducers={...this.reducers,...e},this.updateReducers(Object.keys(e))}removeReducer(e){this.removeReducers([e])}removeReducers(e){e.forEach(i=>{this.reducers=function b7(n,t){return Object.keys(n).filter(e=>e!==t).reduce((e,i)=>Object.assign(e,{[i]:n[i]}),{})}(this.reducers,i)}),this.updateReducers(e)}updateReducers(e){this.next(this.reducerFactory(this.reducers,this.initialState)),this.dispatcher.next({type:"@ngrx/store/update-reducers",features:e})}ngOnDestroy(){this.complete()}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(WU),o.LFG(gL),o.LFG(OU),o.LFG(RU))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();const C7=[DS,{provide:UM,useExisting:DS},{provide:WU,useExisting:tw}];let HM=(()=>{class n extends Es.x{ngOnDestroy(){this.complete()}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=o.n5z(n)))(i||n)}}(),n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();const E7=[HM];class ZU extends w.y{}let qU=(()=>{class n extends $h{constructor(e,i,r,a){super(a);const E=e.pipe((0,sm.Q)(h7.N)).pipe(function d7(...n){const t=(0,Oo.jO)(n);return(0,k.e)((e,i)=>{const r=n.length,a=new Array(r);let g=n.map(()=>!1),E=!1;for(let O=0;O<r;O++)(0,oi.Xf)(n[O]).subscribe((0,P.x)(i,j=>{a[O]=j,!E&&!g[O]&&(g[O]=!0,(E=g.every(am.y))&&(g=null))},IU.Z));e.subscribe((0,P.x)(i,O=>{if(E){const j=[O,...a];i.next(t?t(...j):j)}}))})}(i)),j=E.pipe(J1(T7,{state:a}));this.stateSubscription=j.subscribe(({state:Y,action:se})=>{this.next(Y),r.next(se)})}ngOnDestroy(){this.stateSubscription.unsubscribe(),this.complete()}}return n.INIT=MU,n.\u0275fac=function(e){return new(e||n)(o.LFG(tw),o.LFG(UM),o.LFG(HM),o.LFG(gL))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();function T7(n={state:void 0},[t,e]){const{state:i}=n;return{state:e(i,t),action:t}}const S7=[qU,{provide:ZU,useExisting:qU}];let Q1=(()=>{class n extends w.y{constructor(e,i,r){super(),this.actionsObserver=i,this.reducerManager=r,this.source=e}select(e,...i){return D7.call(null,e,...i)(this)}lift(e){const i=new n(this,this.actionsObserver,this.reducerManager);return i.operator=e,i}dispatch(e){this.actionsObserver.next(e)}next(e){this.actionsObserver.next(e)}error(e){this.actionsObserver.error(e)}complete(){this.actionsObserver.complete()}addReducer(e,i){this.reducerManager.addReducer(e,i)}removeReducer(e){this.reducerManager.removeReducer(e)}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(ZU),o.LFG(tw),o.LFG(DS))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();const I7=[Q1];function D7(n,t,...e){return function(r){let a;if("string"==typeof n){const g=[t,...e].filter(Boolean);a=r.pipe(function f7(...n){const t=n.length;if(0===t)throw new Error("list of properties cannot be empty.");return(0,M.U)(e=>{let i=e;for(let r=0;r<t;r++){const a=i?.[n[r]];if(!(typeof a<"u"))return;i=a}return i})}(n,...g))}else{if("function"!=typeof n)throw new TypeError(`Unexpected type '${typeof n}' in select operator, expected 'string' or 'function'`);a=r.pipe((0,M.U)(g=>n(g,t)))}return a.pipe(DU())}}const CL="https://ngrx.io/guide/store/configuration/runtime-checks";function KU(n){return void 0===n}function YU(n){return null===n}function JU(n){return Array.isArray(n)}function QU(n){return"object"==typeof n&&null!==n}function EL(n){return"function"==typeof n}function TL(n,t){return n===t}function F7(n,t,e){for(let i=0;i<n.length;i++)if(!e(n[i],t[i]))return!0;return!1}function SL(n,t=TL,e=TL){let a,i=null,r=null;return{memoized:function j(){if(void 0!==a)return a.result;if(!i)return r=n.apply(null,arguments),i=arguments,r;if(!F7(arguments,i,t))return r;const Y=n.apply(null,arguments);return i=arguments,e(r,Y)?r:(r=Y,Y)},reset:function g(){i=null,r=null},setResult:function E(Y){a={result:Y}},clearResult:function O(){a=void 0}}}function N7(n,t,e,i){if(void 0===e){const a=t.map(g=>g(n));return i.memoized.apply(null,a)}const r=t.map(a=>a(n,e));return i.memoized.apply(null,[...r,e])}function IL(n){return function t6(...n){return function z7(n,t={stateFn:N7}){return function(...e){let i=e;if(Array.isArray(i[0])){const[Y,...se]=i;i=[...Y,...se]}else 1===i.length&&function B7(n){return!!n&&"object"==typeof n&&Object.values(n).every(t=>"function"==typeof t)}(i[0])&&(i=function V7(n){const t=Object.values(n),e=Object.keys(n);return[...t,(...r)=>e.reduce((a,g,E)=>({...a,[g]:r[E]}),{})]}(i[0]));const r=i.slice(0,i.length-1),a=i[i.length-1],g=r.filter(Y=>Y.release&&"function"==typeof Y.release),E=n(function(...Y){return a.apply(null,Y)}),O=SL(function(Y,se){return t.stateFn.apply(null,[Y,r,se,E])});return Object.assign(O.memoized,{release:function j(){O.reset(),E.reset(),g.forEach(Y=>Y.release())},projector:E.memoized,setResult:O.setResult,clearResult:O.clearResult})}}(SL)(...n)}(t=>{const e=t[n];return(0,o.X6Q)()&&!(n in t)&&console.warn(`@ngrx/store: The feature name "${n}" does not exist in the state, therefore createFeatureSelector cannot access it.  Be sure it is imported in a loaded module using StoreModule.forRoot('${n}', ...) or StoreModule.forFeature('${n}', ...).  If the default state is intended to be undefined, as is the case with router state, this development-only warning message can be ignored.`),e},t=>t)}function j7(n){return n instanceof o.OlP?(0,o.f3M)(n):n}function G7(n,t){return t.map((e,i)=>{if(n[i]instanceof o.OlP){const r=(0,o.f3M)(n[i]);return{key:e.key,reducerFactory:r.reducerFactory?r.reducerFactory:xL,metaReducers:r.metaReducers?r.metaReducers:[],initialState:r.initialState}}return e})}function $7(n){return n.map(t=>t instanceof o.OlP?(0,o.f3M)(t):t)}function DL(n){return"function"==typeof n?n():n}function W7(n,t){return n.concat(t)}function Z7(){if((0,o.f3M)(Q1,{optional:!0,skipSelf:!0}))throw new TypeError("The root Store has been provided more than once. Feature modules should provide feature states instead.");return"guarded"}function AL(n){Object.freeze(n);const t=EL(n);return Object.getOwnPropertyNames(n).forEach(e=>{if(!e.startsWith("\u0275")&&function O7(n,t){return Object.prototype.hasOwnProperty.call(n,t)}(n,e)&&(!t||"caller"!==e&&"callee"!==e&&"arguments"!==e)){const i=n[e];(QU(i)||EL(i))&&!Object.isFrozen(i)&&AL(i)}}),n}function ML(n,t=[]){return(KU(n)||YU(n))&&0===t.length?{path:["root"],value:n}:Object.keys(n).reduce((i,r)=>{if(i)return i;const a=n[r];return function P7(n){return EL(n)&&n.hasOwnProperty("\u0275cmp")}(a)?i:!(KU(a)||YU(a)||function k7(n){return"number"==typeof n}(a)||function M7(n){return"boolean"==typeof n}(a)||function A7(n){return"string"==typeof n}(a)||JU(a))&&(function XU(n){if(!function R7(n){return QU(n)&&!JU(n)}(n))return!1;const t=Object.getPrototypeOf(n);return t===Object.prototype||null===t}(a)?ML(a,[...t,r]):{path:[...t,r],value:a})},!1)}function n6(n,t){if(!1===n)return;const e=n.path.join("."),i=new Error(`Detected unserializable ${t} at "${e}". ${CL}#strict${t}serializability`);throw i.value=n.value,i.unserializablePath=e,i}function J7(n){return(0,o.X6Q)()?{strictStateSerializability:!1,strictActionSerializability:!1,strictStateImmutability:!0,strictActionImmutability:!0,strictActionWithinNgZone:!1,strictActionTypeUniqueness:!1,...n}:{strictStateSerializability:!1,strictActionSerializability:!1,strictStateImmutability:!1,strictActionImmutability:!1,strictActionWithinNgZone:!1,strictActionTypeUniqueness:!1}}function Q7({strictActionSerializability:n,strictStateSerializability:t}){return e=>n||t?function K7(n,t){return function(e,i){t.action(i)&&n6(ML(i),"action");const r=n(e,i);return t.state()&&n6(ML(r),"state"),r}}(e,{action:i=>n&&!kL(i),state:()=>t}):e}function X7({strictActionImmutability:n,strictStateImmutability:t}){return e=>n||t?function q7(n,t){return function(e,i){const r=t.action(i)?AL(i):i,a=n(e,r);return t.state()?AL(a):a}}(e,{action:i=>n&&!kL(i),state:()=>t}):e}function kL(n){return n.type.startsWith("@ngrx")}function e9({strictActionWithinNgZone:n}){return t=>n?function Y7(n,t){return function(e,i){if(t.action(i)&&!o.R0b.isInAngularZone())throw new Error(`Action '${i.type}' running outside NgZone. ${CL}#strictactionwithinngzone`);return n(e,i)}}(t,{action:e=>n&&!kL(e)}):t}function t9(n){return[{provide:HU,useValue:n},{provide:UU,useFactory:n9,deps:[HU]},{provide:SS,deps:[UU],useFactory:J7},{provide:VM,multi:!0,deps:[SS],useFactory:X7},{provide:VM,multi:!0,deps:[SS],useFactory:Q7},{provide:VM,multi:!0,deps:[SS],useFactory:e9}]}function r6(){return[{provide:IS,multi:!0,deps:[SS],useFactory:r9}]}function n9(n){return n}function r9(n){if(!n.strictActionTypeUniqueness)return;const t=Object.entries(TS).filter(([,e])=>e>1).map(([e])=>e);if(t.length)throw new Error(`Action types are registered more than once, ${t.map(e=>`"${e}"`).join(", ")}. ${CL}#strictactiontypeuniqueness`)}function o6(n={},t={}){return[{provide:mL,useFactory:Z7},{provide:kU,useValue:t.initialState},{provide:gL,useFactory:DL,deps:[kU]},{provide:_L,useValue:n},{provide:FU,useExisting:n instanceof o.OlP?n:_L},{provide:OU,deps:[_L,[new o.tBr(FU)]],useFactory:j7},{provide:BU,useValue:t.metaReducers?t.metaReducers:[]},{provide:VU,deps:[VM,BU],useFactory:W7},{provide:PU,useValue:t.reducerFactory?t.reducerFactory:xL},{provide:RU,deps:[PU,VU],useFactory:$U},v7,C7,E7,S7,I7,t9(t.runtimeChecks),r6()]}function s6(n,t,e={}){return[{provide:NU,multi:!0,useValue:n instanceof Object?{}:e},{provide:LU,multi:!0,useValue:{key:n instanceof Object?n.name:n,reducerFactory:e instanceof o.OlP||!e.reducerFactory?xL:e.reducerFactory,metaReducers:e instanceof o.OlP||!e.metaReducers?[]:e.metaReducers,initialState:e instanceof o.OlP||!e.initialState?void 0:e.initialState}},{provide:vL,deps:[NU,LU],useFactory:G7},{provide:yL,multi:!0,useValue:n instanceof Object?n.reducer:t},{provide:zU,multi:!0,useExisting:t instanceof o.OlP?t:yL},{provide:bL,multi:!0,deps:[yL,[new o.tBr(zU)]],useFactory:$7},r6()]}let a6=(()=>{class n{constructor(e,i,r,a,g,E){}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(tw),o.LFG(UM),o.LFG(HM),o.LFG(Q1),o.LFG(mL,8),o.LFG(IS,8))},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({}),n})(),c9=(()=>{class n{constructor(e,i,r,a,g){this.features=e,this.featureReducers=i,this.reducerManager=r;const E=e.map((O,j)=>{const se=i.shift()[j];return{...O,reducers:se,initialState:DL(O.initialState)}});r.addFeatures(E)}ngOnDestroy(){this.reducerManager.removeFeatures(this.features)}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(vL),o.LFG(bL),o.LFG(DS),o.LFG(a6),o.LFG(IS,8))},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({}),n})(),u9=(()=>{class n{static forRoot(e,i){return{ngModule:a6,providers:[...o6(e,i)]}}static forFeature(e,i,r={}){return{ngModule:c9,providers:[...s6(e,i,r)]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({}),n})();function RL(...n){return{reducer:n.pop(),types:n.map(i=>i.type)}}function l6(n,...t){const e=new Map;for(const i of t)for(const r of i.types){const a=e.get(r);e.set(r,a?(E,O)=>i.reducer(a(E,O),O):i.reducer)}return function(i=n,r){const a=e.get(r.type);return a?a(i,r):i}}var h9=Ee(1144);const d9=["addListener","removeListener"],p9=["addEventListener","removeEventListener"],f9=["on","off"];function Hv(n,t,e,i){if((0,_.m)(e)&&(i=e,e=void 0),i)return Hv(n,t,e).pipe(Ia(i));const[r,a]=function _9(n){return(0,_.m)(n.addEventListener)&&(0,_.m)(n.removeEventListener)}(n)?p9.map(g=>E=>n[g](t,E,e)):function m9(n){return(0,_.m)(n.addListener)&&(0,_.m)(n.removeListener)}(n)?d9.map(c6(n,t)):function g9(n){return(0,_.m)(n.on)&&(0,_.m)(n.off)}(n)?f9.map(c6(n,t)):[];if(!r&&(0,h9.z)(n))return(0,h.z)(g=>Hv(g,t,e))((0,oi.Xf)(n));if(!r)throw new TypeError("Invalid event target");return new w.y(g=>{const E=(...O)=>g.next(1<O.length?O:O[0]);return r(E),()=>a(E)})}function c6(n,t){return e=>i=>n[e](t,i)}function PL(n){return(0,k.e)((t,e)=>{(0,oi.Xf)(n).subscribe((0,P.x)(e,()=>e.complete(),IU.Z)),!e.closed&&t.subscribe(e)})}var y9=Ee(655);const OL=["*"],v9=["cellTemplate"];function b9(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"label",4)(1,"input",5),o.NdJ("click",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onCheckboxChange(r))}),o.qZA()()}if(2&n){const e=o.oxw();o.xp6(1),o.Q6J("checked",e.isSelected)}}function w9(n,t){1&n&&o._UZ(0,"i",11)}function x9(n,t){1&n&&o._UZ(0,"i",12)}function C9(n,t){1&n&&o._UZ(0,"i",13)}function E9(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"button",7),o.NdJ("click",function(){o.CHM(e);const r=o.oxw(2);return o.KtG(r.onTreeAction())}),o.TgZ(1,"span"),o.YNc(2,w9,1,0,"i",8),o.YNc(3,x9,1,0,"i",9),o.YNc(4,C9,1,0,"i",10),o.qZA()()}if(2&n){const e=o.oxw(2);o.Q6J("disabled","disabled"===e.treeStatus),o.xp6(2),o.Q6J("ngIf","loading"===e.treeStatus),o.xp6(1),o.Q6J("ngIf","collapsed"===e.treeStatus),o.xp6(1),o.Q6J("ngIf","expanded"===e.treeStatus||"disabled"===e.treeStatus)}}function T9(n,t){}const S9=function(n){return{cellContext:n}};function I9(n,t){if(1&n&&o.YNc(0,T9,0,0,"ng-template",14),2&n){const e=o.oxw(2);o.Q6J("ngTemplateOutlet",e.column.treeToggleTemplate)("ngTemplateOutletContext",o.VKq(2,S9,e.cellContext))}}function D9(n,t){if(1&n&&(o.ynx(0),o.YNc(1,E9,5,4,"button",6),o.YNc(2,I9,1,4,null,2),o.BQk()),2&n){const e=o.oxw();o.xp6(1),o.Q6J("ngIf",!e.column.treeToggleTemplate),o.xp6(1),o.Q6J("ngIf",e.column.treeToggleTemplate)}}function A9(n,t){if(1&n&&o._UZ(0,"span",15),2&n){const e=o.oxw();o.Q6J("title",e.sanitizedValue)("innerHTML",e.value,o.oJD)}}function M9(n,t){}function k9(n,t){if(1&n&&o.YNc(0,M9,0,0,"ng-template",14,16,o.W1O),2&n){const e=o.oxw();o.Q6J("ngTemplateOutlet",e.column.cellTemplate)("ngTemplateOutletContext",e.cellContext)}}function R9(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"datatable-body-cell",3),o.NdJ("activate",function(r){const g=o.CHM(e).index,E=o.oxw(2);return o.KtG(E.onActivate(r,g))})("treeAction",function(){o.CHM(e);const r=o.oxw(2);return o.KtG(r.onTreeAction())}),o.qZA()}if(2&n){const e=t.$implicit,i=o.oxw(2);o.Q6J("row",i.row)("group",i.group)("expanded",i.expanded)("isSelected",i.isSelected)("rowIndex",i.rowIndex)("column",e)("rowHeight",i.rowHeight)("displayCheck",i.displayCheck)("treeStatus",i.treeStatus)}}function P9(n,t){if(1&n&&(o.TgZ(0,"div",1),o.YNc(1,R9,1,9,"datatable-body-cell",2),o.qZA()),2&n){const e=t.$implicit,i=o.oxw();o.Gre("datatable-row-",e.type," datatable-row-group"),o.Q6J("ngStyle",i._groupStyles[e.type]),o.xp6(1),o.Q6J("ngForOf",e.columns)("ngForTrackBy",i.columnTrackingFn)}}function O9(n,t){if(1&n&&o._UZ(0,"datatable-body-row",1),2&n){const e=o.oxw();o.Q6J("innerWidth",e.innerWidth)("offsetX",e.offsetX)("columns",e._internalColumns)("rowHeight",e.rowHeight)("row",e.summaryRow)("rowIndex",-1)}}function L9(n,t){}function F9(n,t){if(1&n&&o.YNc(0,L9,0,0,"ng-template",4),2&n){const e=o.oxw(2);o.Q6J("ngTemplateOutlet",e.groupHeader.template)("ngTemplateOutletContext",e.groupContext)}}function N9(n,t){if(1&n&&(o.TgZ(0,"div",3),o.YNc(1,F9,1,2,null,1),o.qZA()),2&n){const e=o.oxw();o.Q6J("ngStyle",e.getGroupHeaderStyle()),o.xp6(1),o.Q6J("ngIf",e.groupHeader&&e.groupHeader.template)}}function z9(n,t){1&n&&o.Hsn(0,0,["*ngIf","(groupHeader && groupHeader.template && expanded) || !groupHeader || !groupHeader.template"])}function B9(n,t){}function V9(n,t){if(1&n&&o.YNc(0,B9,0,0,"ng-template",4),2&n){const e=o.oxw(2);o.Q6J("ngTemplateOutlet",e.rowDetail.template)("ngTemplateOutletContext",e.rowContext)}}function U9(n,t){if(1&n&&(o.TgZ(0,"div",5),o.YNc(1,V9,1,2,null,1),o.qZA()),2&n){const e=o.oxw();o.Udp("height",e.detailRowHeight,"px"),o.xp6(1),o.Q6J("ngIf",e.rowDetail&&e.rowDetail.template)}}function H9(n,t){1&n&&o._UZ(0,"datatable-progress")}function j9(n,t){if(1&n&&o._UZ(0,"datatable-summary-row",9),2&n){const e=o.oxw(2);o.Q6J("rowHeight",e.summaryHeight)("offsetX",e.offsetX)("innerWidth",e.innerWidth)("rows",e.rows)("columns",e.columns)}}function G9(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"datatable-body-row",13),o.NdJ("treeAction",function(){o.CHM(e);const r=o.oxw().$implicit,a=o.oxw(2);return o.KtG(a.onTreeAction(r))})("activate",function(r){o.CHM(e);const a=o.oxw().index,g=o.oxw(2),E=o.MAs(2);return o.KtG(E.onActivate(r,g.indexes.first+a))}),o.qZA()}if(2&n){const e=o.oxw().$implicit,i=o.oxw(2),r=o.MAs(2);o.Q6J("isSelected",r.getRowSelected(e))("innerWidth",i.innerWidth)("offsetX",i.offsetX)("columns",i.columns)("rowHeight",i.getRowHeight(e))("row",e)("rowIndex",i.getRowIndex(e))("expanded",i.getRowExpanded(e))("rowClass",i.rowClass)("displayCheck",i.displayCheck)("treeStatus",e&&e.treeStatus)}}function $9(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"datatable-body-row",15),o.NdJ("activate",function(r){const g=o.CHM(e).index;o.oxw(4);const E=o.MAs(2);return o.KtG(E.onActivate(r,g))}),o.qZA()}if(2&n){const e=t.$implicit,i=o.oxw(2).$implicit,r=o.oxw(2),a=o.MAs(2);o.Q6J("isSelected",a.getRowSelected(e))("innerWidth",r.innerWidth)("offsetX",r.offsetX)("columns",r.columns)("rowHeight",r.getRowHeight(e))("row",e)("group",i.value)("rowIndex",r.getRowIndex(e))("expanded",r.getRowExpanded(e))("rowClass",r.rowClass)}}function W9(n,t){if(1&n&&o.YNc(0,$9,1,10,"datatable-body-row",14),2&n){const e=o.oxw().$implicit,i=o.oxw(2);o.Q6J("ngForOf",e.value)("ngForTrackBy",i.rowTrackingFn)}}function Z9(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"datatable-row-wrapper",10),o.NdJ("rowContextmenu",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.rowContextmenu.emit(r))}),o.YNc(1,G9,1,11,"datatable-body-row",11),o.YNc(2,W9,1,2,"ng-template",null,12,o.W1O),o.qZA()}if(2&n){const e=t.$implicit,i=t.index,r=o.MAs(3),a=o.oxw(2);o.Q6J("groupedRows",a.groupedRows)("innerWidth",a.innerWidth)("ngStyle",a.getRowsStyles(e))("rowDetail",a.rowDetail)("groupHeader",a.groupHeader)("offsetX",a.offsetX)("detailRowHeight",a.getDetailRowHeight(e&&e[i],i))("row",e)("expanded",a.getRowExpanded(e))("rowIndex",a.getRowIndex(e&&e[i])),o.xp6(1),o.Q6J("ngIf",!a.groupedRows)("ngIfElse",r)}}function q9(n,t){if(1&n&&o._UZ(0,"datatable-summary-row",16),2&n){const e=o.oxw(2);o.Q6J("ngStyle",e.getBottomSummaryRowStyles())("rowHeight",e.summaryHeight)("offsetX",e.offsetX)("innerWidth",e.innerWidth)("rows",e.rows)("columns",e.columns)}}function K9(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"datatable-scroller",5),o.NdJ("scroll",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onBodyScroll(r))}),o.YNc(1,j9,1,5,"datatable-summary-row",6),o.YNc(2,Z9,4,12,"datatable-row-wrapper",7),o.YNc(3,q9,1,6,"datatable-summary-row",8),o.qZA()}if(2&n){const e=o.oxw();o.Q6J("scrollbarV",e.scrollbarV)("scrollbarH",e.scrollbarH)("scrollHeight",e.scrollHeight)("scrollWidth",null==e.columnGroupWidths?null:e.columnGroupWidths.total),o.xp6(1),o.Q6J("ngIf",e.summaryRow&&"top"===e.summaryPosition),o.xp6(1),o.Q6J("ngForOf",e.temp)("ngForTrackBy",e.rowTrackingFn),o.xp6(1),o.Q6J("ngIf",e.summaryRow&&"bottom"===e.summaryPosition)}}function Y9(n,t){if(1&n&&o._UZ(0,"div",17),2&n){const e=o.oxw();o.Q6J("innerHTML",e.emptyMessage,o.oJD)}}function J9(n,t){}function Q9(n,t){if(1&n&&o.YNc(0,J9,0,0,"ng-template",5),2&n){const e=o.oxw();o.Q6J("ngTemplateOutlet",e.targetMarkerTemplate)("ngTemplateOutletContext",e.targetMarkerContext)}}function X9(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"label",6)(1,"input",7),o.NdJ("change",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.select.emit(!r.allRowsSelected))}),o.qZA()()}if(2&n){const e=o.oxw();o.xp6(1),o.Q6J("checked",e.allRowsSelected)}}function eK(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"span",8)(1,"span",9),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.onSort())}),o.qZA()()}if(2&n){const e=o.oxw();o.xp6(1),o.Q6J("innerHTML",e.name,o.oJD)}}function tK(n,t){}function nK(n,t){if(1&n&&o.YNc(0,tK,0,0,"ng-template",5),2&n){const e=o.oxw();o.Q6J("ngTemplateOutlet",e.column.headerTemplate)("ngTemplateOutletContext",e.cellContext)}}function iK(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"datatable-header-cell",4),o.NdJ("resize",function(r){const g=o.CHM(e).$implicit,E=o.oxw(2);return o.KtG(E.onColumnResized(r,g))})("longPressStart",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onLongPressStart(r))})("longPressEnd",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onLongPressEnd(r))})("sort",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onSort(r))})("select",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.select.emit(r))})("columnContextmenu",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.columnContextmenu.emit(r))}),o.qZA()}if(2&n){const e=t.$implicit,i=o.oxw(2);o.Q6J("resizeEnabled",e.resizeable)("pressModel",e)("pressEnabled",i.reorderable&&e.draggable)("dragX",i.reorderable&&e.draggable&&e.dragging)("dragY",!1)("dragModel",e)("dragEventTarget",i.dragEventTarget)("headerHeight",i.headerHeight)("isTarget",e.isTarget)("targetMarkerTemplate",i.targetMarkerTemplate)("targetMarkerContext",e.targetMarkerContext)("column",e)("sortType",i.sortType)("sorts",i.sorts)("selectionType",i.selectionType)("sortAscendingIcon",i.sortAscendingIcon)("sortDescendingIcon",i.sortDescendingIcon)("sortUnsetIcon",i.sortUnsetIcon)("allRowsSelected",i.allRowsSelected)}}function rK(n,t){if(1&n&&(o.TgZ(0,"div",2),o.YNc(1,iK,1,19,"datatable-header-cell",3),o.qZA()),2&n){const e=t.$implicit,i=o.oxw();o.Tol("datatable-row-"+e.type),o.Q6J("ngStyle",i._styleByGroup[e.type]),o.xp6(1),o.Q6J("ngForOf",e.columns)("ngForTrackBy",i.columnTrackingFn)}}function oK(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"li",6)(1,"a",7),o.NdJ("click",function(){const a=o.CHM(e).$implicit,g=o.oxw();return o.KtG(g.selectPage(a.number))}),o._uU(2),o.qZA()()}if(2&n){const e=t.$implicit,i=o.oxw();o.ekj("active",e.number===i.page),o.uIk("aria-label","page "+e.number),o.xp6(2),o.hij(" ",e.text," ")}}function sK(n,t){}const aK=function(n,t,e,i,r){return{rowCount:n,pageSize:t,selectedCount:e,curPage:i,offset:r}};function lK(n,t){if(1&n&&o.YNc(0,sK,0,0,"ng-template",4),2&n){const e=o.oxw();o.Q6J("ngTemplateOutlet",e.footerTemplate.template)("ngTemplateOutletContext",o.qbA(2,aK,e.rowCount,e.pageSize,e.selectedCount,e.curPage,e.offset))}}function cK(n,t){if(1&n&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&n){const e=o.oxw(2);o.xp6(1),o.AsE(" ",null==e.selectedCount?null:e.selectedCount.toLocaleString()," ",e.selectedMessage," / ")}}function uK(n,t){if(1&n&&(o.TgZ(0,"div",5),o.YNc(1,cK,2,2,"span",1),o._uU(2),o.qZA()),2&n){const e=o.oxw();o.xp6(1),o.Q6J("ngIf",e.selectedMessage),o.xp6(1),o.AsE(" ",null==e.rowCount?null:e.rowCount.toLocaleString()," ",e.totalMessage," ")}}function hK(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"datatable-pager",6),o.NdJ("change",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.page.emit(r))}),o.qZA()}if(2&n){const e=o.oxw();o.Q6J("pagerLeftArrowIcon",e.pagerLeftArrowIcon)("pagerRightArrowIcon",e.pagerRightArrowIcon)("pagerPreviousIcon",e.pagerPreviousIcon)("pagerNextIcon",e.pagerNextIcon)("page",e.curPage)("size",e.pageSize)("count",e.rowCount)("hidden",!e.isVisible)}}const dK=function(n){return{"selected-count":n}};function pK(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"datatable-header",4),o.NdJ("sort",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onColumnSort(r))})("resize",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onColumnResize(r))})("reorder",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onColumnReorder(r))})("select",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onHeaderSelect(r))})("columnContextmenu",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onColumnContextmenu(r))}),o.ALo(1,"async"),o.qZA()}if(2&n){const e=o.oxw();o.Q6J("sorts",e.sorts)("sortType",e.sortType)("scrollbarH",e.scrollbarH)("innerWidth",e._innerWidth)("offsetX",o.lcZ(1,15,e._offsetX))("dealsWithGroup",void 0!==e.groupedRows)("columns",e._internalColumns)("headerHeight",e.headerHeight)("reorderable",e.reorderable)("targetMarkerTemplate",e.targetMarkerTemplate)("sortAscendingIcon",e.cssClasses.sortAscending)("sortDescendingIcon",e.cssClasses.sortDescending)("sortUnsetIcon",e.cssClasses.sortUnset)("allRowsSelected",e.allRowsSelected)("selectionType",e.selectionType)}}function fK(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"datatable-footer",5),o.NdJ("page",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onFooterPage(r))}),o.qZA()}if(2&n){const e=o.oxw();o.Q6J("rowCount",e.rowCount)("pageSize",e.pageSize)("offset",e.offset)("footerHeight",e.footerHeight)("footerTemplate",e.footer)("totalMessage",e.messages.totalMessage)("pagerLeftArrowIcon",e.cssClasses.pagerLeftArrow)("pagerRightArrowIcon",e.cssClasses.pagerRightArrow)("pagerPreviousIcon",e.cssClasses.pagerPrevious)("selectedCount",e.selected.length)("selectedMessage",!!e.selectionType&&e.messages.selectedMessage)("pagerNextIcon",e.cssClasses.pagerNext)}}let LL=(()=>{class n{constructor(e){this.document=e,this.width=this.getWidth()}getWidth(){const e=this.document.createElement("div");e.style.visibility="hidden",e.style.width="100px",e.style.msOverflowStyle="scrollbar",this.document.body.appendChild(e);const i=e.offsetWidth;e.style.overflow="scroll";const r=this.document.createElement("div");r.style.width="100%",e.appendChild(r);const a=r.offsetWidth;return e.parentNode.removeChild(e),i-a}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(y))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})(),u6=(()=>{class n{getDimensions(e){return e.getBoundingClientRect()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})(),FL=(()=>{class n{constructor(){this.columnInputChanges=new Es.x}get columnInputChanges$(){return this.columnInputChanges.asObservable()}onInputChange(){this.columnInputChanges.next()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})(),mK=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.Rgc))},n.\u0275dir=o.lG2({type:n,selectors:[["","ngx-datatable-footer-template",""]]}),n})(),gK=(()=>{class n{constructor(e,i){this.element=e,this.zone=i,this.isVisible=!1,this.visible=new o.vpe}ngOnInit(){this.runCheck()}ngOnDestroy(){clearTimeout(this.timeout)}onVisibilityChange(){this.zone.run(()=>{this.isVisible=!0,this.visible.emit(!0)})}runCheck(){const e=()=>{const{offsetHeight:i,offsetWidth:r}=this.element.nativeElement;i&&r?(clearTimeout(this.timeout),this.onVisibilityChange()):(clearTimeout(this.timeout),this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>e(),50)}))};this.timeout=setTimeout(()=>e())}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.SBq),o.Y36(o.R0b))},n.\u0275dir=o.lG2({type:n,selectors:[["","visibilityObserver",""]],hostVars:2,hostBindings:function(e,i){2&e&&o.ekj("visible",i.isVisible)},outputs:{visible:"visible"}}),n})(),h6=(()=>{class n{constructor(e){this.dragX=!0,this.dragY=!0,this.dragStart=new o.vpe,this.dragging=new o.vpe,this.dragEnd=new o.vpe,this.isDragging=!1,this.element=e.nativeElement}ngOnChanges(e){e.dragEventTarget&&e.dragEventTarget.currentValue&&this.dragModel.dragging&&this.onMousedown(e.dragEventTarget.currentValue)}ngOnDestroy(){this._destroySubscription()}onMouseup(e){this.isDragging&&(this.isDragging=!1,this.element.classList.remove("dragging"),this.subscription&&(this._destroySubscription(),this.dragEnd.emit({event:e,element:this.element,model:this.dragModel})))}onMousedown(e){if(e.target.classList.contains("draggable")&&(this.dragX||this.dragY)){e.preventDefault(),this.isDragging=!0;const r={x:e.clientX,y:e.clientY},a=Hv(document,"mouseup");this.subscription=a.subscribe(E=>this.onMouseup(E));const g=Hv(document,"mousemove").pipe(PL(a)).subscribe(E=>this.move(E,r));this.subscription.add(g),this.dragStart.emit({event:e,element:this.element,model:this.dragModel})}}move(e,i){if(!this.isDragging)return;const a=e.clientY-i.y;this.dragX&&(this.element.style.left=e.clientX-i.x+"px"),this.dragY&&(this.element.style.top=`${a}px`),this.element.classList.add("dragging"),this.dragging.emit({event:e,element:this.element,model:this.dragModel})}_destroySubscription(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0)}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.SBq))},n.\u0275dir=o.lG2({type:n,selectors:[["","draggable",""]],inputs:{dragEventTarget:"dragEventTarget",dragModel:"dragModel",dragX:"dragX",dragY:"dragY"},outputs:{dragStart:"dragStart",dragging:"dragging",dragEnd:"dragEnd"},features:[o.TTD]}),n})(),_K=(()=>{class n{constructor(e,i){this.renderer=i,this.resizeEnabled=!0,this.resize=new o.vpe,this.resizing=!1,this.element=e.nativeElement}ngAfterViewInit(){const e=this.renderer;this.resizeHandle=e.createElement("span"),e.addClass(this.resizeHandle,this.resizeEnabled?"resize-handle":"resize-handle--not-resizable"),e.appendChild(this.element,this.resizeHandle)}ngOnDestroy(){this._destroySubscription(),this.renderer.destroyNode?this.renderer.destroyNode(this.resizeHandle):this.resizeHandle&&this.renderer.removeChild(this.renderer.parentNode(this.resizeHandle),this.resizeHandle)}onMouseup(){this.resizing=!1,this.subscription&&!this.subscription.closed&&(this._destroySubscription(),this.resize.emit(this.element.clientWidth))}onMousedown(e){const i=e.target.classList.contains("resize-handle"),r=this.element.clientWidth,a=e.screenX;if(i){e.stopPropagation(),this.resizing=!0;const g=Hv(document,"mouseup");this.subscription=g.subscribe(O=>this.onMouseup());const E=Hv(document,"mousemove").pipe(PL(g)).subscribe(O=>this.move(O,r,a));this.subscription.add(E)}}move(e,i,r){const g=i+(e.screenX-r);(!this.minWidth||g>=this.minWidth)&&(!this.maxWidth||g<=this.maxWidth)&&(this.element.style.width=`${g}px`)}_destroySubscription(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0)}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.SBq),o.Y36(o.Qsj))},n.\u0275dir=o.lG2({type:n,selectors:[["","resizeable",""]],hostVars:2,hostBindings:function(e,i){1&e&&o.NdJ("mousedown",function(a){return i.onMousedown(a)}),2&e&&o.ekj("resizeable",i.resizeEnabled)},inputs:{resizeEnabled:"resizeEnabled",minWidth:"minWidth",maxWidth:"maxWidth"},outputs:{resize:"resize"}}),n})(),yK=(()=>{class n{constructor(e,i){this.document=i,this.reorder=new o.vpe,this.targetChanged=new o.vpe,this.differ=e.find({}).create()}ngAfterContentInit(){this.updateSubscriptions(),this.draggables.changes.subscribe(this.updateSubscriptions.bind(this))}ngOnDestroy(){this.draggables.forEach(e=>{e.dragStart.unsubscribe(),e.dragging.unsubscribe(),e.dragEnd.unsubscribe()})}updateSubscriptions(){const e=this.differ.diff(this.createMapDiffs());if(e){const i=({currentValue:a,previousValue:g})=>{r({previousValue:g}),a&&(a.dragStart.subscribe(this.onDragStart.bind(this)),a.dragging.subscribe(this.onDragging.bind(this)),a.dragEnd.subscribe(this.onDragEnd.bind(this)))},r=({previousValue:a})=>{a&&(a.dragStart.unsubscribe(),a.dragging.unsubscribe(),a.dragEnd.unsubscribe())};e.forEachAddedItem(i),e.forEachRemovedItem(r)}}onDragStart(){this.positions={};let e=0;for(const i of this.draggables.toArray()){const r=i.element,a=parseInt(r.offsetLeft.toString(),0);this.positions[i.dragModel.prop]={left:a,right:a+parseInt(r.offsetWidth.toString(),0),index:e++,element:r}}}onDragging({model:i,event:r}){const a=this.positions[i.prop],g=this.isTarget(i,r);g?this.lastDraggingIndex!==g.i&&(this.targetChanged.emit({prevIndex:this.lastDraggingIndex,newIndex:g.i,initialIndex:a.index}),this.lastDraggingIndex=g.i):this.lastDraggingIndex!==a.index&&(this.targetChanged.emit({prevIndex:this.lastDraggingIndex,initialIndex:a.index}),this.lastDraggingIndex=a.index)}onDragEnd({element:e,model:i,event:r}){const a=this.positions[i.prop],g=this.isTarget(i,r);g&&this.reorder.emit({prevIndex:a.index,newIndex:g.i,model:i}),this.lastDraggingIndex=void 0,e.style.left="auto"}isTarget(e,i){let r=0;const E=this.document.elementsFromPoint(i.x||i.clientX,i.y||i.clientY);for(const O in this.positions){const j=this.positions[O];if(e.prop!==O&&E.find(Y=>Y===j.element))return{pos:j,i:r};r++}}createMapDiffs(){return this.draggables.toArray().reduce((e,i)=>(e[i.dragModel.$$id]=i,e),{})}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.aQg),o.Y36(y))},n.\u0275dir=o.lG2({type:n,selectors:[["","orderable",""]],contentQueries:function(e,i,r){if(1&e&&o.Suo(r,h6,5),2&e){let a;o.iGM(a=o.CRH())&&(i.draggables=a)}},outputs:{reorder:"reorder",targetChanged:"targetChanged"}}),n})(),vK=(()=>{class n{constructor(){this.pressEnabled=!0,this.duration=500,this.longPressStart=new o.vpe,this.longPressing=new o.vpe,this.longPressEnd=new o.vpe,this.mouseX=0,this.mouseY=0}get press(){return this.pressing}get isLongPress(){return this.isLongPressing}onMouseDown(e){if(1!==e.which||!this.pressEnabled||e.target.classList.contains("resize-handle"))return;this.mouseX=e.clientX,this.mouseY=e.clientY,this.pressing=!0,this.isLongPressing=!1;const r=Hv(document,"mouseup");this.subscription=r.subscribe(a=>this.onMouseup()),this.timeout=setTimeout(()=>{this.isLongPressing=!0,this.longPressStart.emit({event:e,model:this.pressModel}),this.subscription.add(Hv(document,"mousemove").pipe(PL(r)).subscribe(a=>this.onMouseMove(a))),this.loop(e)},this.duration),this.loop(e)}onMouseMove(e){if(this.pressing&&!this.isLongPressing){const i=Math.abs(e.clientX-this.mouseX)>10,r=Math.abs(e.clientY-this.mouseY)>10;(i||r)&&this.endPress()}}loop(e){this.isLongPressing&&(this.timeout=setTimeout(()=>{this.longPressing.emit({event:e,model:this.pressModel}),this.loop(e)},50))}endPress(){clearTimeout(this.timeout),this.isLongPressing=!1,this.pressing=!1,this._destroySubscription(),this.longPressEnd.emit({model:this.pressModel})}onMouseup(){this.endPress()}ngOnDestroy(){this._destroySubscription()}_destroySubscription(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=o.lG2({type:n,selectors:[["","long-press",""]],hostVars:4,hostBindings:function(e,i){1&e&&o.NdJ("mousedown",function(a){return i.onMouseDown(a)}),2&e&&o.ekj("press",i.press)("longpress",i.isLongPress)},inputs:{pressEnabled:"pressEnabled",pressModel:"pressModel",duration:"duration"},outputs:{longPressStart:"longPressStart",longPressing:"longPressing",longPressEnd:"longPressEnd"}}),n})(),d6=(()=>{class n{constructor(e,i,r){this.ngZone=e,this.renderer=r,this.scrollbarV=!1,this.scrollbarH=!1,this.scroll=new o.vpe,this.scrollYPos=0,this.scrollXPos=0,this.prevScrollYPos=0,this.prevScrollXPos=0,this._scrollEventListener=null,this.element=i.nativeElement}ngOnInit(){if(this.scrollbarV||this.scrollbarH){const e=this.renderer;this.parentElement=e.parentNode(e.parentNode(this.element)),this._scrollEventListener=this.onScrolled.bind(this),this.parentElement.addEventListener("scroll",this._scrollEventListener)}}ngOnDestroy(){this._scrollEventListener&&(this.parentElement.removeEventListener("scroll",this._scrollEventListener),this._scrollEventListener=null)}setOffset(e){this.parentElement&&(this.parentElement.scrollTop=e)}onScrolled(e){const i=e.currentTarget;requestAnimationFrame(()=>{this.scrollYPos=i.scrollTop,this.scrollXPos=i.scrollLeft,this.updateOffset()})}updateOffset(){let e;this.scrollYPos<this.prevScrollYPos?e="down":this.scrollYPos>this.prevScrollYPos&&(e="up"),this.scroll.emit({direction:e,scrollYPos:this.scrollYPos,scrollXPos:this.scrollXPos}),this.prevScrollYPos=this.scrollYPos,this.prevScrollXPos=this.scrollXPos}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.R0b),o.Y36(o.SBq),o.Y36(o.Qsj))},n.\u0275cmp=o.Xpm({type:n,selectors:[["datatable-scroller"]],hostAttrs:[1,"datatable-scroll"],hostVars:4,hostBindings:function(e,i){2&e&&o.Udp("height",i.scrollHeight,"px")("width",i.scrollWidth,"px")},inputs:{scrollbarV:"scrollbarV",scrollbarH:"scrollbarH",scrollHeight:"scrollHeight",scrollWidth:"scrollWidth"},outputs:{scroll:"scroll"},ngContentSelectors:OL,decls:1,vars:0,template:function(e,i){1&e&&(o.F$t(),o.Hsn(0))},encapsulation:2,changeDetection:0}),n})(),bK=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.Rgc))},n.\u0275dir=o.lG2({type:n,selectors:[["","ngx-datatable-group-header-template",""]]}),n})(),wK=(()=>{class n{constructor(){this.rowHeight=0,this.toggle=new o.vpe}get template(){return this._templateInput||this._templateQuery}toggleExpandGroup(e){this.toggle.emit({type:"group",value:e})}expandAllGroups(){this.toggle.emit({type:"all",value:!0})}collapseAllGroups(){this.toggle.emit({type:"all",value:!1})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=o.lG2({type:n,selectors:[["ngx-datatable-group-header"]],contentQueries:function(e,i,r){if(1&e&&o.Suo(r,bK,7,o.Rgc),2&e){let a;o.iGM(a=o.CRH())&&(i._templateQuery=a.first)}},inputs:{rowHeight:"rowHeight",_templateInput:["template","_templateInput"]},outputs:{toggle:"toggle"}}),n})();function xK(){return""}function NL(n){return null==n?xK:"number"==typeof n?CK:-1!==n.indexOf(".")?TK:EK}function CK(n,t){return null==n?"":n&&null!=t?n[t]??"":n}function EK(n,t){return null==n?"":n&&t?n[t]??"":n}function TK(n,t){if(null==n)return"";if(!n||!t)return n;let e=n[t];if(void 0!==e)return e;e=n;const i=t.split(".");if(i.length)for(let r=0;r<i.length;r++)if(e=e[i[r]],null==e)return"";return e}function X1(n){return n&&(t=>NL(n)(t,n))}function zL(n,t,e){if(t&&e){const i={},r=n.length;let a=null;i[0]=new p6;const g=n.reduce((O,j)=>{const Y=e(j);return-1===O.indexOf(Y)&&O.push(Y),O},[]);for(let O=0;O<r;O++)i[e(n[O])]=new p6(n[O]);for(let O=0;O<r;O++){a=i[e(n[O])];let j=0;const Y=t(a.row);Y&&g.indexOf(Y)>-1&&(j=Y),a.parent=i[j],a.row.level=a.parent.row.level+1,a.parent.children.push(a)}let E=[];return i[0].flatten(function(){E=[...E,this.row]},!0),E}return n}class p6{constructor(t=null){t||(t={level:-1,treeStatus:"expanded"}),this.row=t,this.parent=null,this.children=[]}flatten(t,e){if("expanded"===this.row.treeStatus)for(let i=0,r=this.children.length;i<r;i++){const a=this.children[i];t.apply(a,Array.prototype.slice.call(arguments,2)),e&&a.flatten.apply(a,arguments)}}}function BL(n){return(n=(n=(n=n.replace(/[^a-zA-Z0-9 ]/g," ")).replace(/([a-z](?=[A-Z]))/g,"$1 ")).replace(/([^a-zA-Z0-9 ])|^[0-9]+/g,"").trim().toLowerCase()).replace(/([ 0-9]+)([a-zA-Z])/g,function(t,e,i){return e.trim()+i.toUpperCase()})}function SK(n){return n.replace(/([A-Z])/g,t=>` ${t}`).replace(/^./,t=>t.toUpperCase())}function f6(n){if(!n)return;let t=!1;for(const e of n)e.$$id||(e.$$id=("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)),AS(e.prop)&&e.name&&(e.prop=BL(e.name)),e.$$valueGetter||(e.$$valueGetter=NL(e.prop)),!AS(e.prop)&&AS(e.name)&&(e.name=SK(String(e.prop))),AS(e.prop)&&AS(e.name)&&(e.name=""),e.hasOwnProperty("resizeable")||(e.resizeable=!0),e.hasOwnProperty("sortable")||(e.sortable=!0),e.hasOwnProperty("draggable")||(e.draggable=!0),e.hasOwnProperty("canAutoResize")||(e.canAutoResize=!0),e.hasOwnProperty("width")||(e.width=150),e.hasOwnProperty("isTreeColumn")&&e.isTreeColumn&&!t?t=!0:e.isTreeColumn=!1}function AS(n){return null==n}var eC=(()=>(function(n){n.standard="standard",n.flex="flex",n.force="force"}(eC||(eC={})),eC))(),Vd=(()=>(function(n){n.single="single",n.multi="multi",n.multiClick="multiClick",n.cell="cell",n.checkbox="checkbox"}(Vd||(Vd={})),Vd))(),tC=(()=>(function(n){n.single="single",n.multi="multi"}(tC||(tC={})),tC))(),MS=(()=>(function(n){n.header="header",n.body="body"}(MS||(MS={})),MS))();let AK=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.Rgc))},n.\u0275dir=o.lG2({type:n,selectors:[["","ngx-datatable-header-template",""]]}),n})(),m6=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.Rgc))},n.\u0275dir=o.lG2({type:n,selectors:[["","ngx-datatable-cell-template",""]]}),n})(),MK=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.Rgc))},n.\u0275dir=o.lG2({type:n,selectors:[["","ngx-datatable-tree-toggle",""]]}),n})(),g6=(()=>{class n{constructor(e){this.columnChangesService=e,this.isFirstChange=!0}get cellTemplate(){return this._cellTemplateInput||this._cellTemplateQuery}get headerTemplate(){return this._headerTemplateInput||this._headerTemplateQuery}get treeToggleTemplate(){return this._treeToggleTemplateInput||this._treeToggleTemplateQuery}ngOnChanges(){this.isFirstChange?this.isFirstChange=!1:this.columnChangesService.onInputChange()}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(FL))},n.\u0275dir=o.lG2({type:n,selectors:[["ngx-datatable-column"]],contentQueries:function(e,i,r){if(1&e&&(o.Suo(r,m6,7,o.Rgc),o.Suo(r,AK,7,o.Rgc),o.Suo(r,MK,7,o.Rgc)),2&e){let a;o.iGM(a=o.CRH())&&(i._cellTemplateQuery=a.first),o.iGM(a=o.CRH())&&(i._headerTemplateQuery=a.first),o.iGM(a=o.CRH())&&(i._treeToggleTemplateQuery=a.first)}},inputs:{name:"name",prop:"prop",frozenLeft:"frozenLeft",frozenRight:"frozenRight",flexGrow:"flexGrow",resizeable:"resizeable",comparator:"comparator",pipe:"pipe",sortable:"sortable",draggable:"draggable",canAutoResize:"canAutoResize",minWidth:"minWidth",width:"width",maxWidth:"maxWidth",checkboxable:"checkboxable",headerCheckboxable:"headerCheckboxable",headerClass:"headerClass",cellClass:"cellClass",isTreeColumn:"isTreeColumn",treeLevelIndent:"treeLevelIndent",summaryFunc:"summaryFunc",summaryTemplate:"summaryTemplate",_cellTemplateInput:["cellTemplate","_cellTemplateInput"],_headerTemplateInput:["headerTemplate","_headerTemplateInput"],_treeToggleTemplateInput:["treeToggleTemplate","_treeToggleTemplateInput"]},features:[o.TTD]}),n})(),kK=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.Rgc))},n.\u0275dir=o.lG2({type:n,selectors:[["","ngx-datatable-row-detail-template",""]]}),n})(),RK=(()=>{class n{constructor(){this.rowHeight=0,this.toggle=new o.vpe}get template(){return this._templateInput||this._templateQuery}toggleExpandRow(e){this.toggle.emit({type:"row",value:e})}expandAllRows(){this.toggle.emit({type:"all",value:!0})}collapseAllRows(){this.toggle.emit({type:"all",value:!1})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=o.lG2({type:n,selectors:[["ngx-datatable-row-detail"]],contentQueries:function(e,i,r){if(1&e&&o.Suo(r,kK,7,o.Rgc),2&e){let a;o.iGM(a=o.CRH())&&(i._templateQuery=a.first)}},inputs:{rowHeight:"rowHeight",_templateInput:["template","_templateInput"]},outputs:{toggle:"toggle"}}),n})(),PK=(()=>{class n{get template(){return this._templateInput||this._templateQuery}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=o.lG2({type:n,selectors:[["ngx-datatable-footer"]],contentQueries:function(e,i,r){if(1&e&&o.Suo(r,mK,5,o.Rgc),2&e){let a;o.iGM(a=o.CRH())&&(i._templateQuery=a.first)}},inputs:{footerHeight:"footerHeight",totalMessage:"totalMessage",selectedMessage:"selectedMessage",pagerLeftArrowIcon:"pagerLeftArrowIcon",pagerRightArrowIcon:"pagerRightArrowIcon",pagerPreviousIcon:"pagerPreviousIcon",pagerNextIcon:"pagerNextIcon",_templateInput:["template","_templateInput"]}}),n})();function nw(n){const t={left:[],center:[],right:[]};if(n)for(const e of n)e.frozenLeft?t.left.push(e):e.frozenRight?t.right.push(e):t.center.push(e);return t}function kS(n,t){return{left:jM(n.left),center:jM(n.center),right:jM(n.right),total:Math.floor(jM(t))}}function jM(n,t){let e=0;if(n)for(const i of n)e+=parseFloat(t&&i[t]?i[t]:i.width);return e}function _6(n){const t=[],e=nw(n);return t.push({type:"left",columns:e.left}),t.push({type:"center",columns:e.center}),t.push({type:"right",columns:e.right}),t}class LK{constructor(){this.treeArray=[]}clearCache(){this.treeArray=[]}initCache(t){const{rows:e,rowHeight:i,detailRowHeight:r,externalVirtual:a,rowCount:g,rowIndexes:E,rowExpansions:O}=t,j="function"==typeof i,Y="function"==typeof r;if(!j&&isNaN(i))throw new Error(`Row Height cache initialization failed. Please ensure that 'rowHeight' is a\n        valid number or function value: (${i}) when 'scrollbarV' is enabled.`);if(!Y&&isNaN(r))throw new Error(`Row Height cache initialization failed. Please ensure that 'detailRowHeight' is a\n        valid number or function value: (${r}) when 'scrollbarV' is enabled.`);const se=a?g:e.length;this.treeArray=new Array(se);for(let be=0;be<se;++be)this.treeArray[be]=0;for(let be=0;be<se;++be){const Me=e[be];let Ge=i;j&&(Ge=i(Me));const _t=O.has(Me);Me&&_t&&(Ge+=Y?r(Me,E.get(Me)):r),this.update(be,Ge)}}getRowIndex(t){return 0===t?0:this.calcRowIndex(t)}update(t,e){if(!this.treeArray.length)throw new Error(`Update at index ${t} with value ${e} failed:\n        Row Height cache not initialized.`);const i=this.treeArray.length;for(t|=0;t<i;)this.treeArray[t]+=e,t|=t+1}query(t){if(!this.treeArray.length)throw new Error(`query at index ${t} failed: Fenwick tree array not initialized.`);let e=0;for(t|=0;t>=0;)e+=this.treeArray[t],t=(t&t+1)-1;return e}queryBetween(t,e){return this.query(e)-this.query(t-1)}calcRowIndex(t){if(!this.treeArray.length)return 0;let e=-1;const i=this.treeArray.length;for(let a=Math.pow(2,i.toString(2).length-1);0!==a;a>>=1){const g=e+a;g<i&&t>=this.treeArray[g]&&(t-=this.treeArray[g],e=g)}return e+1}}const GM={},y6=typeof document<"u"?document.createElement("div").style:void 0,VL=function(){const n=typeof window<"u"?window.getComputedStyle(document.documentElement,""):void 0,t=typeof n<"u"?Array.prototype.slice.call(n).join("").match(/-(moz|webkit|ms)-/):null,e=null!==t?t[1]:void 0,i=typeof e<"u"?"WebKit|Moz|MS|O".match(new RegExp("("+e+")","i"))[1]:void 0;return i?{dom:i,lowercase:e,css:`-${e}-`,js:e[0].toUpperCase()+e.substr(1)}:void 0}();function $M(n){const t=BL(n);return GM[t]||(void 0!==VL&&void 0!==y6[VL.css+n]?GM[t]=VL.css+n:void 0!==y6[n]&&(GM[t]=n)),GM[t]}const UL=typeof window<"u"?$M("transform"):void 0,FK=typeof window<"u"?$M("backfaceVisibility"):void 0,NK=typeof window<"u"?!!$M("transform"):void 0,zK=typeof window<"u"?!!$M("perspective"):void 0,v6=typeof window<"u"?window.navigator.userAgent:"Chrome",BK=/Safari\//.test(v6)&&!/Chrome\//.test(v6);function jv(n,t,e){typeof UL<"u"&&NK?!BK&&zK?(n[UL]=`translate3d(${t}px, ${e}px, 0)`,n[FK]="hidden"):n[BL(UL)]=`translate(${t}px, ${e}px)`:(n.top=`${e}px`,n.left=`${t}px`)}let VK=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=o.Xpm({type:n,selectors:[["datatable-progress"]],decls:3,vars:0,consts:[["role","progressbar",1,"progress-linear"],[1,"container"],[1,"bar"]],template:function(e,i){1&e&&(o.TgZ(0,"div",0)(1,"div",1),o._UZ(2,"div",2),o.qZA()())},encapsulation:2,changeDetection:0}),n})();function HL(n,t,e){const i=e(t,n);return i>-1?n.splice(i,1):n.push(t),n}var wa=(()=>(function(n){n[n.up=38]="up",n[n.down=40]="down",n[n.return=13]="return",n[n.escape=27]="escape",n[n.left=37]="left",n[n.right=39]="right"}(wa||(wa={})),wa))();let HK=(()=>{class n{constructor(){this.activate=new o.vpe,this.select=new o.vpe}selectRow(e,i,r){if(!this.selectEnabled)return;const a=this.selectionType===Vd.checkbox,E=this.selectionType===Vd.multiClick;let O=[];O=this.selectionType===Vd.multi||a||E?e.shiftKey?function UK(n,t,e,i,r){const a=e<i;for(let g=0;g<t.length;g++){let Y={start:0,end:0};Y=a?{start:e,end:i}:{start:i,end:e+1},(a&&g<=i&&g>=e||!a&&g>=i&&g<=e)&&g>=Y.start&&g<=Y.end&&n.push(t[g])}return n}([],this.rows,i,this.prevIndex,this.getRowSelectedIdx.bind(this)):HL(e.ctrlKey||e.metaKey||E||a?[...this.selected]:[],r,this.getRowSelectedIdx.bind(this)):HL([],r,this.getRowSelectedIdx.bind(this)),"function"==typeof this.selectCheck&&(O=O.filter(this.selectCheck.bind(this))),this.selected.splice(0,this.selected.length),this.selected.push(...O),this.prevIndex=i,this.select.emit({selected:O})}onActivate(e,i){const{type:r,event:a,row:g}=e,E=this.selectionType===Vd.checkbox;!E&&("click"===r||"dblclick"===r)||E&&"checkbox"===r?this.selectRow(a,i,g):"keydown"===r&&(a.keyCode===wa.return?this.selectRow(a,i,g):this.onKeyboardFocus(e)),this.activate.emit(e)}onKeyboardFocus(e){const{keyCode:i}=e.event;if(i===wa.up||i===wa.down||i===wa.right||i===wa.left){const a=this.selectionType===Vd.cell;e.cellElement&&a?a&&this.focusCell(e.cellElement,e.rowElement,i,e.cellIndex):this.focusRow(e.rowElement,i)}}focusRow(e,i){const r=this.getPrevNextRow(e,i);r&&r.focus()}getPrevNextRow(e,i){const r=e.parentElement;if(r){let a;if(i===wa.up?a=r.previousElementSibling:i===wa.down&&(a=r.nextElementSibling),a&&a.children.length)return a.children[0]}}focusCell(e,i,r,a){let g;if(r===wa.left)g=e.previousElementSibling;else if(r===wa.right)g=e.nextElementSibling;else if(r===wa.up||r===wa.down){const E=this.getPrevNextRow(i,r);if(E){const O=E.getElementsByClassName("datatable-body-cell");O.length&&(g=O[a])}}g&&g.focus()}getRowSelected(e){return this.getRowSelectedIdx(e,this.selected)>-1}getRowSelectedIdx(e,i){if(!i||!i.length)return-1;const r=this.rowIdentity(e);return i.findIndex(a=>this.rowIdentity(a)===r)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=o.Xpm({type:n,selectors:[["datatable-selection"]],inputs:{rows:"rows",selected:"selected",selectEnabled:"selectEnabled",selectionType:"selectionType",rowIdentity:"rowIdentity",selectCheck:"selectCheck"},outputs:{activate:"activate",select:"select"},ngContentSelectors:OL,decls:1,vars:0,template:function(e,i){1&e&&(o.F$t(),o.Hsn(0))},encapsulation:2,changeDetection:0}),n})();var Wh=(()=>(function(n){n.asc="asc",n.desc="desc"}(Wh||(Wh={})),Wh))();let jK=(()=>{class n{constructor(e,i){this.cd=i,this.activate=new o.vpe,this.treeAction=new o.vpe,this.isFocused=!1,this.onCheckboxChangeFn=this.onCheckboxChange.bind(this),this.activateFn=this.activate.emit.bind(this.activate),this.cellContext={onCheckboxChangeFn:this.onCheckboxChangeFn,activateFn:this.activateFn,row:this.row,group:this.group,value:this.value,column:this.column,rowHeight:this.rowHeight,isSelected:this.isSelected,rowIndex:this.rowIndex,treeStatus:this.treeStatus,onTreeAction:this.onTreeAction.bind(this)},this._element=e.nativeElement}set group(e){this._group=e,this.cellContext.group=e,this.checkValueUpdates(),this.cd.markForCheck()}get group(){return this._group}set rowHeight(e){this._rowHeight=e,this.cellContext.rowHeight=e,this.checkValueUpdates(),this.cd.markForCheck()}get rowHeight(){return this._rowHeight}set isSelected(e){this._isSelected=e,this.cellContext.isSelected=e,this.cd.markForCheck()}get isSelected(){return this._isSelected}set expanded(e){this._expanded=e,this.cellContext.expanded=e,this.cd.markForCheck()}get expanded(){return this._expanded}set rowIndex(e){this._rowIndex=e,this.cellContext.rowIndex=e,this.checkValueUpdates(),this.cd.markForCheck()}get rowIndex(){return this._rowIndex}set column(e){this._column=e,this.cellContext.column=e,this.checkValueUpdates(),this.cd.markForCheck()}get column(){return this._column}set row(e){this._row=e,this.cellContext.row=e,this.checkValueUpdates(),this.cd.markForCheck()}get row(){return this._row}set sorts(e){this._sorts=e,this.calcSortDir=this.calcSortDir(e)}get sorts(){return this._sorts}set treeStatus(e){this._treeStatus="collapsed"!==e&&"expanded"!==e&&"loading"!==e&&"disabled"!==e?"collapsed":e,this.cellContext.treeStatus=this._treeStatus,this.checkValueUpdates(),this.cd.markForCheck()}get treeStatus(){return this._treeStatus}get columnCssClasses(){let e="datatable-body-cell";if(this.column.cellClass)if("string"==typeof this.column.cellClass)e+=" "+this.column.cellClass;else if("function"==typeof this.column.cellClass){const i=this.column.cellClass({row:this.row,group:this.group,column:this.column,value:this.value,rowHeight:this.rowHeight});if("string"==typeof i)e+=" "+i;else if("object"==typeof i){const r=Object.keys(i);for(const a of r)!0===i[a]&&(e+=` ${a}`)}}return this.sortDir||(e+=" sort-active"),this.isFocused&&(e+=" active"),this.sortDir===Wh.asc&&(e+=" sort-asc"),this.sortDir===Wh.desc&&(e+=" sort-desc"),e}get width(){return this.column.width}get minWidth(){return this.column.minWidth}get maxWidth(){return this.column.maxWidth}get height(){const e=this.rowHeight;return isNaN(e)?e:e+"px"}ngDoCheck(){this.checkValueUpdates()}ngOnDestroy(){this.cellTemplate&&this.cellTemplate.clear()}checkValueUpdates(){let e="";if(this.row&&this.column){const i=this.column.$$valueGetter(this.row,this.column.prop),r=this.column.pipe;r?e=r.transform(i):void 0!==e&&(e=i)}else e="";this.value!==e&&(this.value=e,this.cellContext.value=e,this.sanitizedValue=null!=e?this.stripHtml(e):e,this.cd.markForCheck())}onFocus(){this.isFocused=!0}onBlur(){this.isFocused=!1}onClick(e){this.activate.emit({type:"click",event:e,row:this.row,group:this.group,rowHeight:this.rowHeight,column:this.column,value:this.value,cellElement:this._element})}onDblClick(e){this.activate.emit({type:"dblclick",event:e,row:this.row,group:this.group,rowHeight:this.rowHeight,column:this.column,value:this.value,cellElement:this._element})}onKeyDown(e){const i=e.keyCode;(i===wa.return||i===wa.down||i===wa.up||i===wa.left||i===wa.right)&&e.target===this._element&&(e.preventDefault(),e.stopPropagation(),this.activate.emit({type:"keydown",event:e,row:this.row,group:this.group,rowHeight:this.rowHeight,column:this.column,value:this.value,cellElement:this._element}))}onCheckboxChange(e){this.activate.emit({type:"checkbox",event:e,row:this.row,group:this.group,rowHeight:this.rowHeight,column:this.column,value:this.value,cellElement:this._element,treeStatus:"collapsed"})}calcSortDir(e){if(!e)return;const i=e.find(r=>r.prop===this.column.prop);return i?i.dir:void 0}stripHtml(e){return e.replace?e.replace(/<\/?[^>]+(>|$)/g,""):e}onTreeAction(){this.treeAction.emit(this.row)}calcLeftMargin(e,i){return e.isTreeColumn?i.level*(null!=e.treeLevelIndent?e.treeLevelIndent:50):0}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.SBq),o.Y36(o.sBO))},n.\u0275cmp=o.Xpm({type:n,selectors:[["datatable-body-cell"]],viewQuery:function(e,i){if(1&e&&o.Gf(v9,7,o.s_b),2&e){let r;o.iGM(r=o.CRH())&&(i.cellTemplate=r.first)}},hostVars:10,hostBindings:function(e,i){1&e&&o.NdJ("focus",function(){return i.onFocus()})("blur",function(){return i.onBlur()})("click",function(a){return i.onClick(a)})("dblclick",function(a){return i.onDblClick(a)})("keydown",function(a){return i.onKeyDown(a)}),2&e&&(o.Tol(i.columnCssClasses),o.Udp("width",i.width,"px")("min-width",i.minWidth,"px")("max-width",i.maxWidth,"px")("height",i.height))},inputs:{displayCheck:"displayCheck",group:"group",rowHeight:"rowHeight",isSelected:"isSelected",expanded:"expanded",rowIndex:"rowIndex",column:"column",row:"row",sorts:"sorts",treeStatus:"treeStatus"},outputs:{activate:"activate",treeAction:"treeAction"},decls:5,vars:6,consts:[[1,"datatable-body-cell-label"],["class","datatable-checkbox",4,"ngIf"],[4,"ngIf"],[3,"title","innerHTML",4,"ngIf"],[1,"datatable-checkbox"],["type","checkbox",3,"checked","click"],["class","datatable-tree-button",3,"disabled","click",4,"ngIf"],[1,"datatable-tree-button",3,"disabled","click"],["class","icon datatable-icon-collapse",4,"ngIf"],["class","icon datatable-icon-up",4,"ngIf"],["class","icon datatable-icon-down",4,"ngIf"],[1,"icon","datatable-icon-collapse"],[1,"icon","datatable-icon-up"],[1,"icon","datatable-icon-down"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"title","innerHTML"],["cellTemplate",""]],template:function(e,i){1&e&&(o.TgZ(0,"div",0),o.YNc(1,b9,2,1,"label",1),o.YNc(2,D9,3,2,"ng-container",2),o.YNc(3,A9,1,2,"span",3),o.YNc(4,k9,2,2,null,2),o.qZA()),2&e&&(o.Udp("margin-left",i.calcLeftMargin(i.column,i.row),"px"),o.xp6(1),o.Q6J("ngIf",i.column.checkboxable&&(!i.displayCheck||i.displayCheck(i.row,i.column,i.value))),o.xp6(1),o.Q6J("ngIf",i.column.isTreeColumn),o.xp6(1),o.Q6J("ngIf",!i.column.cellTemplate),o.xp6(1),o.Q6J("ngIf",i.column.cellTemplate))},dependencies:[Zn,Ki],encapsulation:2,changeDetection:0}),n})(),b6=(()=>{class n{constructor(e,i,r,a){this.differs=e,this.scrollbarHelper=i,this.cd=r,this.treeStatus="collapsed",this.activate=new o.vpe,this.treeAction=new o.vpe,this._groupStyles={left:{},center:{},right:{}},this._element=a.nativeElement,this._rowDiffer=e.find({}).create()}set columns(e){this._columns=e,this.recalculateColumns(e),this.buildStylesByGroup()}get columns(){return this._columns}set innerWidth(e){if(this._columns){const i=nw(this._columns);this._columnGroupWidths=kS(i,this._columns)}this._innerWidth=e,this.recalculateColumns(),this.buildStylesByGroup()}get innerWidth(){return this._innerWidth}set offsetX(e){this._offsetX=e,this.buildStylesByGroup()}get offsetX(){return this._offsetX}get cssClass(){let e="datatable-body-row";if(this.isSelected&&(e+=" active"),this.rowIndex%2!=0&&(e+=" datatable-row-odd"),this.rowIndex%2==0&&(e+=" datatable-row-even"),this.rowClass){const i=this.rowClass(this.row);if("string"==typeof i)e+=` ${i}`;else if("object"==typeof i){const r=Object.keys(i);for(const a of r)!0===i[a]&&(e+=` ${a}`)}}return e}get columnsTotalWidths(){return this._columnGroupWidths.total}ngDoCheck(){this._rowDiffer.diff(this.row)&&this.cd.markForCheck()}trackByGroups(e,i){return i.type}columnTrackingFn(e,i){return i.$$id}buildStylesByGroup(){this._groupStyles.left=this.calcStylesByGroup("left"),this._groupStyles.center=this.calcStylesByGroup("center"),this._groupStyles.right=this.calcStylesByGroup("right"),this.cd.markForCheck()}calcStylesByGroup(e){const i=this._columnGroupWidths,r=this.offsetX,a={width:`${i[e]}px`};if("left"===e)jv(a,r,0);else if("right"===e){const g=parseInt(this.innerWidth+"",0);jv(a,-1*(i.total-g-r+this.scrollbarHelper.width),0)}return a}onActivate(e,i){e.cellIndex=i,e.rowElement=this._element,this.activate.emit(e)}onKeyDown(e){const i=e.keyCode;(i===wa.return||i===wa.down||i===wa.up||i===wa.left||i===wa.right)&&e.target===this._element&&(e.preventDefault(),e.stopPropagation(),this.activate.emit({type:"keydown",event:e,row:this.row,rowElement:this._element}))}onMouseenter(e){this.activate.emit({type:"mouseenter",event:e,row:this.row,rowElement:this._element})}recalculateColumns(e=this.columns){this._columns=e;const i=nw(this._columns);this._columnsByPin=_6(this._columns),this._columnGroupWidths=kS(i,this._columns)}onTreeAction(){this.treeAction.emit()}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.aQg),o.Y36(LL,4),o.Y36(o.sBO),o.Y36(o.SBq))},n.\u0275cmp=o.Xpm({type:n,selectors:[["datatable-body-row"]],hostVars:6,hostBindings:function(e,i){1&e&&o.NdJ("keydown",function(a){return i.onKeyDown(a)})("mouseenter",function(a){return i.onMouseenter(a)}),2&e&&(o.Tol(i.cssClass),o.Udp("height",i.rowHeight,"px")("width",i.columnsTotalWidths,"px"))},inputs:{columns:"columns",innerWidth:"innerWidth",expanded:"expanded",rowClass:"rowClass",row:"row",group:"group",isSelected:"isSelected",rowIndex:"rowIndex",displayCheck:"displayCheck",treeStatus:"treeStatus",offsetX:"offsetX",rowHeight:"rowHeight"},outputs:{activate:"activate",treeAction:"treeAction"},decls:1,vars:2,consts:[[3,"class","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngStyle"],["role","cell","tabindex","-1",3,"row","group","expanded","isSelected","rowIndex","column","rowHeight","displayCheck","treeStatus","activate","treeAction",4,"ngFor","ngForOf","ngForTrackBy"],["role","cell","tabindex","-1",3,"row","group","expanded","isSelected","rowIndex","column","rowHeight","displayCheck","treeStatus","activate","treeAction"]],template:function(e,i){1&e&&o.YNc(0,P9,2,6,"div",0),2&e&&o.Q6J("ngForOf",i._columnsByPin)("ngForTrackBy",i.trackByGroups)},dependencies:[jK,Hn,qr],encapsulation:2,changeDetection:0}),n})();function GK(n){const t=n.filter(e=>!!e);return!t.length||t.some(e=>"number"!=typeof e)?null:t.reduce((e,i)=>e+i)}function $K(n){return null}let WK=(()=>{class n{constructor(){this.summaryRow={}}ngOnChanges(){!this.columns||!this.rows||(this.updateInternalColumns(),this.updateValues())}updateInternalColumns(){this._internalColumns=this.columns.map(e=>({...e,cellTemplate:e.summaryTemplate}))}updateValues(){this.summaryRow={},this.columns.filter(e=>!e.summaryTemplate).forEach(e=>{const i=this.rows.map(a=>a[e.prop]),r=this.getSummaryFunction(e);this.summaryRow[e.prop]=e.pipe?e.pipe.transform(r(i)):r(i)})}getSummaryFunction(e){return void 0===e.summaryFunc?GK:null===e.summaryFunc?$K:e.summaryFunc}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=o.Xpm({type:n,selectors:[["datatable-summary-row"]],hostAttrs:[1,"datatable-summary-row"],inputs:{rows:"rows",columns:"columns",rowHeight:"rowHeight",offsetX:"offsetX",innerWidth:"innerWidth"},features:[o.TTD],decls:1,vars:1,consts:[["tabindex","-1",3,"innerWidth","offsetX","columns","rowHeight","row","rowIndex",4,"ngIf"],["tabindex","-1",3,"innerWidth","offsetX","columns","rowHeight","row","rowIndex"]],template:function(e,i){1&e&&o.YNc(0,O9,1,6,"datatable-body-row",0),2&e&&o.Q6J("ngIf",i.summaryRow&&i._internalColumns)},dependencies:[b6,Zn],encapsulation:2}),n})(),ZK=(()=>{class n{constructor(e,i){this.cd=e,this.differs=i,this.rowContextmenu=new o.vpe(!1),this._expanded=!1,this.groupContext={group:this.row,expanded:this.expanded,rowIndex:this.rowIndex},this.rowContext={row:this.row,expanded:this.expanded,rowIndex:this.rowIndex},this.rowDiffer=i.find({}).create()}set rowIndex(e){this._rowIndex=e,this.rowContext.rowIndex=e,this.groupContext.rowIndex=e,this.cd.markForCheck()}get rowIndex(){return this._rowIndex}set expanded(e){this._expanded=e,this.groupContext.expanded=e,this.rowContext.expanded=e,this.cd.markForCheck()}get expanded(){return this._expanded}ngDoCheck(){this.rowDiffer.diff(this.row)&&(this.rowContext.row=this.row,this.groupContext.group=this.row,this.cd.markForCheck())}onContextmenu(e){this.rowContextmenu.emit({event:e,row:this.row})}getGroupHeaderStyle(){const e={};return e.transform="translate3d("+this.offsetX+"px, 0px, 0px)",e["backface-visibility"]="hidden",e.width=this.innerWidth,e}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.sBO),o.Y36(o.aQg))},n.\u0275cmp=o.Xpm({type:n,selectors:[["datatable-row-wrapper"]],hostAttrs:[1,"datatable-row-wrapper"],hostBindings:function(e,i){1&e&&o.NdJ("contextmenu",function(a){return i.onContextmenu(a)})},inputs:{innerWidth:"innerWidth",rowDetail:"rowDetail",groupHeader:"groupHeader",offsetX:"offsetX",detailRowHeight:"detailRowHeight",row:"row",groupedRows:"groupedRows",rowIndex:"rowIndex",expanded:"expanded"},outputs:{rowContextmenu:"rowContextmenu"},ngContentSelectors:OL,decls:3,vars:3,consts:[["class","datatable-group-header",3,"ngStyle",4,"ngIf"],[4,"ngIf"],["class","datatable-row-detail",3,"height",4,"ngIf"],[1,"datatable-group-header",3,"ngStyle"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"datatable-row-detail"]],template:function(e,i){1&e&&(o.F$t(),o.YNc(0,N9,2,2,"div",0),o.YNc(1,z9,1,0,"ng-content",1),o.YNc(2,U9,2,3,"div",2)),2&e&&(o.Q6J("ngIf",i.groupHeader&&i.groupHeader.template),o.xp6(1),o.Q6J("ngIf",i.groupHeader&&i.groupHeader.template&&i.expanded||!i.groupHeader||!i.groupHeader.template),o.xp6(1),o.Q6J("ngIf",i.rowDetail&&i.rowDetail.template&&i.expanded))},dependencies:[Zn,qr,Ki],encapsulation:2,changeDetection:0}),n})(),w6=(()=>{class n{constructor(e){this.cd=e,this.selected=[],this.scroll=new o.vpe,this.page=new o.vpe,this.activate=new o.vpe,this.select=new o.vpe,this.detailToggle=new o.vpe,this.rowContextmenu=new o.vpe(!1),this.treeAction=new o.vpe,this.rowHeightsCache=new LK,this.temp=[],this.offsetY=0,this.indexes={},this.rowIndexes=new WeakMap,this.rowExpansions=[],this.getDetailRowHeight=(i,r)=>{if(!this.rowDetail)return 0;const a=this.rowDetail.rowHeight;return"function"==typeof a?a(i,r):a},this.rowTrackingFn=(i,r)=>{const a=this.getRowIndex(r);return this.trackByProp?r[this.trackByProp]:a}}set pageSize(e){this._pageSize=e,this.recalcLayout()}get pageSize(){return this._pageSize}set rows(e){this._rows=e,this.recalcLayout()}get rows(){return this._rows}set columns(e){this._columns=e;const i=nw(e);this.columnGroupWidths=kS(i,e)}get columns(){return this._columns}set offset(e){this._offset=e,(!this.scrollbarV||this.scrollbarV&&!this.virtualization)&&this.recalcLayout()}get offset(){return this._offset}set rowCount(e){this._rowCount=e,this.recalcLayout()}get rowCount(){return this._rowCount}get bodyWidth(){return this.scrollbarH?this.innerWidth+"px":"100%"}set bodyHeight(e){this._bodyHeight=this.scrollbarV?e+"px":"auto",this.recalcLayout()}get bodyHeight(){return this._bodyHeight}get selectEnabled(){return!!this.selectionType}get scrollHeight(){if(this.scrollbarV&&this.virtualization&&this.rowCount)return this.rowHeightsCache.query(this.rowCount-1)}ngOnInit(){this.rowDetail&&(this.listener=this.rowDetail.toggle.subscribe(({type:e,value:i})=>{"row"===e&&this.toggleRowExpansion(i),"all"===e&&this.toggleAllRows(i),this.updateIndexes(),this.updateRows(),this.cd.markForCheck()})),this.groupHeader&&(this.listener=this.groupHeader.toggle.subscribe(({type:e,value:i})=>{"group"===e&&this.toggleRowExpansion(i),"all"===e&&this.toggleAllRows(i),this.updateIndexes(),this.updateRows(),this.cd.markForCheck()}))}ngOnDestroy(){(this.rowDetail||this.groupHeader)&&this.listener.unsubscribe()}updateOffsetY(e){this.scroller&&(this.scrollbarV&&this.virtualization&&e?e=this.rowHeightsCache.query(this.pageSize*e-1):this.scrollbarV&&!this.virtualization&&(e=0),this.scroller.setOffset(e||0))}onBodyScroll(e){const i=e.scrollYPos,r=e.scrollXPos;(this.offsetY!==i||this.offsetX!==r)&&this.scroll.emit({offsetY:i,offsetX:r}),this.offsetY=i,this.offsetX=r,this.updateIndexes(),this.updatePage(e.direction),this.updateRows()}updatePage(e){let i=this.indexes.first/this.pageSize;"up"===e?i=Math.ceil(i):"down"===e&&(i=Math.floor(i)),void 0!==e&&!isNaN(i)&&this.page.emit({offset:i})}updateRows(){const{first:e,last:i}=this.indexes;let r=e,a=0;const g=[];if(this.groupedRows){let E=3;for(1===this.groupedRows.length&&(E=this.groupedRows[0].value.length);r<i&&r<this.groupedRows.length;){const O=this.groupedRows[r];this.rowIndexes.set(O,r),O.value&&O.value.forEach((j,Y)=>{this.rowIndexes.set(j,`${r}-${Y}`)}),g[a]=O,a++,r++}}else for(;r<i&&r<this.rowCount;){const E=this.rows[r];E&&(this.rowIndexes.set(E,r),g[a]=E),a++,r++}this.temp=g}getRowHeight(e){return"function"==typeof this.rowHeight?this.rowHeight(e):this.rowHeight}getGroupHeight(e){let i=0;if(e.value)for(let r=0;r<e.value.length;r++)i+=this.getRowAndDetailHeight(e.value[r]);return i}getRowAndDetailHeight(e){let i=this.getRowHeight(e);return this.getRowExpanded(e)&&(i+=this.getDetailRowHeight(e)),i}getRowsStyles(e){const i={};if(this.groupedRows&&(i.width=this.columnGroupWidths.total),this.scrollbarV&&this.virtualization){let r=0;if(this.groupedRows){const g=e[e.length-1];r=g?this.getRowIndex(g):0}else r=this.getRowIndex(e);jv(i,0,this.rowHeightsCache.query(r-1))}return i}getBottomSummaryRowStyles(){if(!this.scrollbarV||!this.rows||!this.rows.length)return null;const e={position:"absolute"};return jv(e,0,this.rowHeightsCache.query(this.rows.length-1)),e}hideIndicator(){setTimeout(()=>this.loadingIndicator=!1,500)}updateIndexes(){let e=0,i=0;if(this.scrollbarV)if(this.virtualization){const r=parseInt(this.bodyHeight,0);e=this.rowHeightsCache.getRowIndex(this.offsetY),i=this.rowHeightsCache.getRowIndex(r+this.offsetY)+1}else e=0,i=this.rowCount;else this.externalPaging||(e=Math.max(this.offset*this.pageSize,0)),i=Math.min(e+this.pageSize,this.rowCount);this.indexes={first:e,last:i}}refreshRowHeightCache(){if(this.scrollbarV&&(!this.scrollbarV||this.virtualization)&&(this.rowHeightsCache.clearCache(),this.rows&&this.rows.length)){const e=new Set;for(const i of this.rows)this.getRowExpanded(i)&&e.add(i);this.rowHeightsCache.initCache({rows:this.rows,rowHeight:this.rowHeight,detailRowHeight:this.getDetailRowHeight,externalVirtual:this.scrollbarV&&this.externalPaging,rowCount:this.rowCount,rowIndexes:this.rowIndexes,rowExpansions:e})}}getAdjustedViewPortIndex(){const e=this.indexes.first;return this.scrollbarV&&this.virtualization&&this.rowHeightsCache.query(e-1)<=this.offsetY?e-1:e}toggleRowExpansion(e){const i=this.getAdjustedViewPortIndex(),r=this.getRowExpandedIdx(e,this.rowExpansions),a=r>-1;if(this.scrollbarV&&this.virtualization){const g=this.getDetailRowHeight(e)*(a?-1:1),E=this.getRowIndex(e);this.rowHeightsCache.update(E,g)}a?this.rowExpansions.splice(r,1):this.rowExpansions.push(e),this.detailToggle.emit({rows:[e],currentIndex:i})}toggleAllRows(e){this.rowExpansions=[];const i=this.getAdjustedViewPortIndex();if(e)for(const r of this.rows)this.rowExpansions.push(r);this.scrollbarV&&this.recalcLayout(),this.detailToggle.emit({rows:this.rows,currentIndex:i})}recalcLayout(){this.refreshRowHeightCache(),this.updateIndexes(),this.updateRows()}columnTrackingFn(e,i){return i.$$id}stylesByGroup(e){const i=this.columnGroupWidths,r=this.offsetX,a={width:`${i[e]}px`};if("left"===e)jv(a,r,0);else if("right"===e){const g=parseInt(this.innerWidth+"",0);jv(a,-1*(i.total-g-r),0)}return a}getRowExpanded(e){if(0===this.rowExpansions.length&&this.groupExpansionDefault)for(const i of this.groupedRows)this.rowExpansions.push(i);return this.getRowExpandedIdx(e,this.rowExpansions)>-1}getRowExpandedIdx(e,i){if(!i||!i.length)return-1;const r=this.rowIdentity(e);return i.findIndex(a=>this.rowIdentity(a)===r)}getRowIndex(e){return this.rowIndexes.get(e)||0}onTreeAction(e){this.treeAction.emit({row:e})}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.sBO))},n.\u0275cmp=o.Xpm({type:n,selectors:[["datatable-body"]],viewQuery:function(e,i){if(1&e&&o.Gf(d6,5),2&e){let r;o.iGM(r=o.CRH())&&(i.scroller=r.first)}},hostAttrs:[1,"datatable-body"],hostVars:4,hostBindings:function(e,i){2&e&&o.Udp("width",i.bodyWidth)("height",i.bodyHeight)},inputs:{scrollbarV:"scrollbarV",scrollbarH:"scrollbarH",loadingIndicator:"loadingIndicator",externalPaging:"externalPaging",rowHeight:"rowHeight",offsetX:"offsetX",emptyMessage:"emptyMessage",selectionType:"selectionType",selected:"selected",rowIdentity:"rowIdentity",rowDetail:"rowDetail",groupHeader:"groupHeader",selectCheck:"selectCheck",displayCheck:"displayCheck",trackByProp:"trackByProp",rowClass:"rowClass",groupedRows:"groupedRows",groupExpansionDefault:"groupExpansionDefault",innerWidth:"innerWidth",groupRowsBy:"groupRowsBy",virtualization:"virtualization",summaryRow:"summaryRow",summaryPosition:"summaryPosition",summaryHeight:"summaryHeight",pageSize:"pageSize",rows:"rows",columns:"columns",offset:"offset",rowCount:"rowCount",bodyHeight:"bodyHeight"},outputs:{scroll:"scroll",page:"page",activate:"activate",select:"select",detailToggle:"detailToggle",rowContextmenu:"rowContextmenu",treeAction:"treeAction"},decls:5,vars:9,consts:[[4,"ngIf"],[3,"selected","rows","selectCheck","selectEnabled","selectionType","rowIdentity","select","activate"],["selector",""],[3,"scrollbarV","scrollbarH","scrollHeight","scrollWidth","scroll",4,"ngIf"],["class","empty-row",3,"innerHTML",4,"ngIf"],[3,"scrollbarV","scrollbarH","scrollHeight","scrollWidth","scroll"],[3,"rowHeight","offsetX","innerWidth","rows","columns",4,"ngIf"],[3,"groupedRows","innerWidth","ngStyle","rowDetail","groupHeader","offsetX","detailRowHeight","row","expanded","rowIndex","rowContextmenu",4,"ngFor","ngForOf","ngForTrackBy"],["role","row",3,"ngStyle","rowHeight","offsetX","innerWidth","rows","columns",4,"ngIf"],[3,"rowHeight","offsetX","innerWidth","rows","columns"],[3,"groupedRows","innerWidth","ngStyle","rowDetail","groupHeader","offsetX","detailRowHeight","row","expanded","rowIndex","rowContextmenu"],["role","row","tabindex","-1",3,"isSelected","innerWidth","offsetX","columns","rowHeight","row","rowIndex","expanded","rowClass","displayCheck","treeStatus","treeAction","activate",4,"ngIf","ngIfElse"],["groupedRowsTemplate",""],["role","row","tabindex","-1",3,"isSelected","innerWidth","offsetX","columns","rowHeight","row","rowIndex","expanded","rowClass","displayCheck","treeStatus","treeAction","activate"],["role","row","tabindex","-1",3,"isSelected","innerWidth","offsetX","columns","rowHeight","row","group","rowIndex","expanded","rowClass","activate",4,"ngFor","ngForOf","ngForTrackBy"],["role","row","tabindex","-1",3,"isSelected","innerWidth","offsetX","columns","rowHeight","row","group","rowIndex","expanded","rowClass","activate"],["role","row",3,"ngStyle","rowHeight","offsetX","innerWidth","rows","columns"],[1,"empty-row",3,"innerHTML"]],template:function(e,i){1&e&&(o.YNc(0,H9,1,0,"datatable-progress",0),o.TgZ(1,"datatable-selection",1,2),o.NdJ("select",function(a){return i.select.emit(a)})("activate",function(a){return i.activate.emit(a)}),o.YNc(3,K9,4,8,"datatable-scroller",3),o.YNc(4,Y9,1,1,"div",4),o.qZA()),2&e&&(o.Q6J("ngIf",i.loadingIndicator),o.xp6(1),o.Q6J("selected",i.selected)("rows",i.rows)("selectCheck",i.selectCheck)("selectEnabled",i.selectEnabled)("selectionType",i.selectionType)("rowIdentity",i.rowIdentity),o.xp6(2),o.Q6J("ngIf",null==i.rows?null:i.rows.length),o.xp6(1),o.Q6J("ngIf",!(null!=i.rows&&i.rows.length||i.loadingIndicator)))},dependencies:[VK,HK,d6,WK,ZK,b6,Zn,Hn,qr],encapsulation:2,changeDetection:0}),n})();function KK(n,t){if((null===n||typeof n>"u")&&(n=0),(null===t||typeof t>"u")&&(t=0),n instanceof Date&&t instanceof Date){if(n<t)return-1;if(n>t)return 1}else if(isNaN(parseFloat(n))||!isFinite(n)||isNaN(parseFloat(t))||!isFinite(t)){if(n=String(n),t=String(t),n.toLowerCase()<t.toLowerCase())return-1;if(n.toLowerCase()>t.toLowerCase())return 1}else{if(parseFloat(n)<parseFloat(t))return-1;if(parseFloat(n)>parseFloat(t))return 1}return 0}let JK=(()=>{class n{constructor(e){this.cd=e,this.sort=new o.vpe,this.select=new o.vpe,this.columnContextmenu=new o.vpe(!1),this.sortFn=this.onSort.bind(this),this.selectFn=this.select.emit.bind(this.select),this.cellContext={column:this.column,sortDir:this.sortDir,sortFn:this.sortFn,allRowsSelected:this.allRowsSelected,selectFn:this.selectFn}}set allRowsSelected(e){this._allRowsSelected=e,this.cellContext.allRowsSelected=e}get allRowsSelected(){return this._allRowsSelected}set column(e){this._column=e,this.cellContext.column=e,this.cd.markForCheck()}get column(){return this._column}set sorts(e){this._sorts=e,this.sortDir=this.calcSortDir(e),this.cellContext.sortDir=this.sortDir,this.sortClass=this.calcSortClass(this.sortDir),this.cd.markForCheck()}get sorts(){return this._sorts}get columnCssClasses(){let e="datatable-header-cell";if(this.column.sortable&&(e+=" sortable"),this.column.resizeable&&(e+=" resizeable"),this.column.headerClass)if("string"==typeof this.column.headerClass)e+=" "+this.column.headerClass;else if("function"==typeof this.column.headerClass){const r=this.column.headerClass({column:this.column});if("string"==typeof r)e+=r;else if("object"==typeof r){const a=Object.keys(r);for(const g of a)!0===r[g]&&(e+=` ${g}`)}}const i=this.sortDir;return i&&(e+=` sort-active sort-${i}`),e}get name(){return void 0===this.column.headerTemplate?this.column.name:void 0}get minWidth(){return this.column.minWidth}get maxWidth(){return this.column.maxWidth}get width(){return this.column.width}get isCheckboxable(){return this.column.checkboxable&&this.column.headerCheckboxable&&this.selectionType===Vd.checkbox}onContextmenu(e){this.columnContextmenu.emit({event:e,column:this.column})}ngOnInit(){this.sortClass=this.calcSortClass(this.sortDir)}calcSortDir(e){if(e&&this.column){const i=e.find(r=>r.prop===this.column.prop);if(i)return i.dir}}onSort(){if(!this.column.sortable)return;const e=function qK(n,t){return n===tC.single?t===Wh.asc?Wh.desc:Wh.asc:t?t===Wh.asc?Wh.desc:void 0:Wh.asc}(this.sortType,this.sortDir);this.sort.emit({column:this.column,prevValue:this.sortDir,newValue:e})}calcSortClass(e){if(this.cellContext.column.sortable)return e===Wh.asc?`sort-btn sort-asc ${this.sortAscendingIcon}`:e===Wh.desc?`sort-btn sort-desc ${this.sortDescendingIcon}`:`sort-btn ${this.sortUnsetIcon}`}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.sBO))},n.\u0275cmp=o.Xpm({type:n,selectors:[["datatable-header-cell"]],hostAttrs:[1,"datatable-header-cell"],hostVars:11,hostBindings:function(e,i){1&e&&o.NdJ("contextmenu",function(a){return i.onContextmenu(a)}),2&e&&(o.uIk("title",i.name),o.Tol(i.columnCssClasses),o.Udp("height",i.headerHeight,"px")("min-width",i.minWidth,"px")("max-width",i.maxWidth,"px")("width",i.width,"px"))},inputs:{sortType:"sortType",sortAscendingIcon:"sortAscendingIcon",sortDescendingIcon:"sortDescendingIcon",sortUnsetIcon:"sortUnsetIcon",isTarget:"isTarget",targetMarkerTemplate:"targetMarkerTemplate",targetMarkerContext:"targetMarkerContext",allRowsSelected:"allRowsSelected",selectionType:"selectionType",column:"column",headerHeight:"headerHeight",sorts:"sorts"},outputs:{sort:"sort",select:"select",columnContextmenu:"columnContextmenu"},decls:6,vars:6,consts:[[1,"datatable-header-cell-template-wrap"],[4,"ngIf"],["class","datatable-checkbox",4,"ngIf"],["class","datatable-header-cell-wrapper",4,"ngIf"],[3,"click"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"datatable-checkbox"],["type","checkbox",3,"checked","change"],[1,"datatable-header-cell-wrapper"],[1,"datatable-header-cell-label","draggable",3,"innerHTML","click"]],template:function(e,i){1&e&&(o.TgZ(0,"div",0),o.YNc(1,Q9,1,2,null,1),o.YNc(2,X9,2,1,"label",2),o.YNc(3,eK,2,1,"span",3),o.YNc(4,nK,1,2,null,1),o.TgZ(5,"span",4),o.NdJ("click",function(){return i.onSort()}),o.qZA()()),2&e&&(o.xp6(1),o.Q6J("ngIf",i.isTarget),o.xp6(1),o.Q6J("ngIf",i.isCheckboxable),o.xp6(1),o.Q6J("ngIf",!i.column.headerTemplate),o.xp6(1),o.Q6J("ngIf",i.column.headerTemplate),o.xp6(1),o.Tol(i.sortClass))},dependencies:[Zn,Ki],encapsulation:2,changeDetection:0}),n})(),x6=(()=>{class n{constructor(e){this.cd=e,this.sort=new o.vpe,this.reorder=new o.vpe,this.resize=new o.vpe,this.select=new o.vpe,this.columnContextmenu=new o.vpe(!1),this._columnGroupWidths={total:100},this._styleByGroup={left:{},center:{},right:{}},this.destroyed=!1}set innerWidth(e){this._innerWidth=e,setTimeout(()=>{if(this._columns){const i=nw(this._columns);this._columnGroupWidths=kS(i,this._columns),this.setStylesByGroup()}})}get innerWidth(){return this._innerWidth}set headerHeight(e){this._headerHeight="auto"!==e?`${e}px`:e}get headerHeight(){return this._headerHeight}set columns(e){this._columns=e;const i=nw(e);this._columnsByPin=_6(e),setTimeout(()=>{this._columnGroupWidths=kS(i,e),this.setStylesByGroup()})}get columns(){return this._columns}set offsetX(e){this._offsetX=e,this.setStylesByGroup()}get offsetX(){return this._offsetX}ngOnDestroy(){this.destroyed=!0}onLongPressStart({event:e,model:i}){i.dragging=!0,this.dragEventTarget=e}onLongPressEnd({event:e,model:i}){this.dragEventTarget=e,setTimeout(()=>{const r=this._columns.find(a=>a.$$id===i.$$id);r&&(r.dragging=!1)},5)}get headerWidth(){return this.scrollbarH?this.innerWidth+"px":"100%"}trackByGroups(e,i){return i.type}columnTrackingFn(e,i){return i.$$id}onColumnResized(e,i){e<=i.minWidth?e=i.minWidth:e>=i.maxWidth&&(e=i.maxWidth),this.resize.emit({column:i,prevValue:i.width,newValue:e})}onColumnReordered({prevIndex:e,newIndex:i,model:r}){const a=this.getColumn(i);a.isTarget=!1,a.targetMarkerContext=void 0,this.reorder.emit({column:r,prevValue:e,newValue:i})}onTargetChanged({prevIndex:e,newIndex:i,initialIndex:r}){if(e||0===e){const a=this.getColumn(e);a.isTarget=!1,a.targetMarkerContext=void 0}if(i||0===i){const a=this.getColumn(i);a.isTarget=!0,r!==i&&(a.targetMarkerContext={class:"targetMarker ".concat(r>i?"dragFromRight":"dragFromLeft")})}}getColumn(e){const i=this._columnsByPin[0].columns.length;if(e<i)return this._columnsByPin[0].columns[e];const r=this._columnsByPin[1].columns.length;return e<i+r?this._columnsByPin[1].columns[e-i]:this._columnsByPin[2].columns[e-i-r]}onSort({column:e,prevValue:i,newValue:r}){if(e.dragging)return;const a=this.calcNewSorts(e,i,r);this.sort.emit({sorts:a,column:e,prevValue:i,newValue:r})}calcNewSorts(e,i,r){let a=0;this.sorts||(this.sorts=[]);const g=this.sorts.map((E,O)=>((E={...E}).prop===e.prop&&(a=O),E));return void 0===r?g.splice(a,1):i?g[a].dir=r:(this.sortType===tC.single&&g.splice(0,this.sorts.length),g.push({dir:r,prop:e.prop})),g}setStylesByGroup(){this._styleByGroup.left=this.calcStylesByGroup("left"),this._styleByGroup.center=this.calcStylesByGroup("center"),this._styleByGroup.right=this.calcStylesByGroup("right"),this.destroyed||this.cd.detectChanges()}calcStylesByGroup(e){const i=this._columnGroupWidths,a={width:`${i[e]}px`};return"center"===e?jv(a,-1*this.offsetX,0):"right"===e&&jv(a,-1*(i.total-this.innerWidth),0),a}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.sBO))},n.\u0275cmp=o.Xpm({type:n,selectors:[["datatable-header"]],hostAttrs:[1,"datatable-header"],hostVars:4,hostBindings:function(e,i){2&e&&o.Udp("height",i.headerHeight)("width",i.headerWidth)},inputs:{sortAscendingIcon:"sortAscendingIcon",sortDescendingIcon:"sortDescendingIcon",sortUnsetIcon:"sortUnsetIcon",scrollbarH:"scrollbarH",dealsWithGroup:"dealsWithGroup",targetMarkerTemplate:"targetMarkerTemplate",innerWidth:"innerWidth",sorts:"sorts",sortType:"sortType",allRowsSelected:"allRowsSelected",selectionType:"selectionType",reorderable:"reorderable",headerHeight:"headerHeight",columns:"columns",offsetX:"offsetX"},outputs:{sort:"sort",reorder:"reorder",resize:"resize",select:"select",columnContextmenu:"columnContextmenu"},decls:2,vars:4,consts:[["role","row","orderable","",1,"datatable-header-inner",3,"reorder","targetChanged"],[3,"class","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngStyle"],["role","columnheader","resizeable","","long-press","","draggable","",3,"resizeEnabled","pressModel","pressEnabled","dragX","dragY","dragModel","dragEventTarget","headerHeight","isTarget","targetMarkerTemplate","targetMarkerContext","column","sortType","sorts","selectionType","sortAscendingIcon","sortDescendingIcon","sortUnsetIcon","allRowsSelected","resize","longPressStart","longPressEnd","sort","select","columnContextmenu",4,"ngFor","ngForOf","ngForTrackBy"],["role","columnheader","resizeable","","long-press","","draggable","",3,"resizeEnabled","pressModel","pressEnabled","dragX","dragY","dragModel","dragEventTarget","headerHeight","isTarget","targetMarkerTemplate","targetMarkerContext","column","sortType","sorts","selectionType","sortAscendingIcon","sortDescendingIcon","sortUnsetIcon","allRowsSelected","resize","longPressStart","longPressEnd","sort","select","columnContextmenu"]],template:function(e,i){1&e&&(o.TgZ(0,"div",0),o.NdJ("reorder",function(a){return i.onColumnReordered(a)})("targetChanged",function(a){return i.onTargetChanged(a)}),o.YNc(1,rK,2,5,"div",1),o.qZA()),2&e&&(o.Udp("width",i._columnGroupWidths.total,"px"),o.xp6(1),o.Q6J("ngForOf",i._columnsByPin)("ngForTrackBy",i.trackByGroups))},dependencies:[JK,yK,Hn,qr,_K,vK,h6],encapsulation:2,changeDetection:0}),n})();function QK(n,t,e){e=e||{};let i,r,a,g=null,E=0;function O(){E=!1===e.leading?0:+new Date,g=null,a=n.apply(i,r)}return function(){const j=+new Date;!E&&!1===e.leading&&(E=j);const Y=t-(j-E);return i=this,r=arguments,Y<=0?(clearTimeout(g),g=null,E=j,a=n.apply(i,r)):!g&&!1!==e.trailing&&(g=setTimeout(O,Y)),a}}function XK(n,t){return function(i,r,a){return{configurable:!0,enumerable:a.enumerable,get:function(){return Object.defineProperty(this,r,{configurable:!0,enumerable:a.enumerable,value:QK(a.value,n,t)}),this[r]}}}}function rY(n,t){for(const e of t){const i=n.indexOf(e);n.splice(i,1)}}function C6(n,t=300){let e=0;for(const i of n)e+=i.width||t;return e}let oY=(()=>{class n{constructor(){this.change=new o.vpe,this._count=0,this._page=1,this._size=0}set size(e){this._size=e,this.pages=this.calcPages()}get size(){return this._size}set count(e){this._count=e,this.pages=this.calcPages()}get count(){return this._count}set page(e){this._page=e,this.pages=this.calcPages()}get page(){return this._page}get totalPages(){const e=this.size<1?1:Math.ceil(this.count/this.size);return Math.max(e||0,1)}canPrevious(){return this.page>1}canNext(){return this.page<this.totalPages}prevPage(){this.selectPage(this.page-1)}nextPage(){this.selectPage(this.page+1)}selectPage(e){e>0&&e<=this.totalPages&&e!==this.page&&(this.page=e,this.change.emit({page:e}))}calcPages(e){const i=[];let r=1,a=this.totalPages;e=e||this.page,5<this.totalPages&&(r=e-Math.floor(2.5),a=e+Math.floor(2.5),r<1?(r=1,a=Math.min(r+5-1,this.totalPages)):a>this.totalPages&&(r=Math.max(this.totalPages-5+1,1),a=this.totalPages));for(let O=r;O<=a;O++)i.push({number:O,text:O});return i}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=o.Xpm({type:n,selectors:[["datatable-pager"]],hostAttrs:[1,"datatable-pager"],inputs:{pagerLeftArrowIcon:"pagerLeftArrowIcon",pagerRightArrowIcon:"pagerRightArrowIcon",pagerPreviousIcon:"pagerPreviousIcon",pagerNextIcon:"pagerNextIcon",size:"size",count:"count",page:"page"},outputs:{change:"change"},decls:14,vars:21,consts:[[1,"pager"],["role","button","aria-label","go to first page","href","javascript:void(0)",3,"click"],["role","button","aria-label","go to previous page","href","javascript:void(0)",3,"click"],["role","button","class","pages",3,"active",4,"ngFor","ngForOf"],["role","button","aria-label","go to next page","href","javascript:void(0)",3,"click"],["role","button","aria-label","go to last page","href","javascript:void(0)",3,"click"],["role","button",1,"pages"],["href","javascript:void(0)",3,"click"]],template:function(e,i){1&e&&(o.TgZ(0,"ul",0)(1,"li")(2,"a",1),o.NdJ("click",function(){return i.selectPage(1)}),o._UZ(3,"i"),o.qZA()(),o.TgZ(4,"li")(5,"a",2),o.NdJ("click",function(){return i.prevPage()}),o._UZ(6,"i"),o.qZA()(),o.YNc(7,oK,3,4,"li",3),o.TgZ(8,"li")(9,"a",4),o.NdJ("click",function(){return i.nextPage()}),o._UZ(10,"i"),o.qZA()(),o.TgZ(11,"li")(12,"a",5),o.NdJ("click",function(){return i.selectPage(i.totalPages)}),o._UZ(13,"i"),o.qZA()()()),2&e&&(o.xp6(1),o.ekj("disabled",!i.canPrevious()),o.xp6(2),o.Tol(i.pagerPreviousIcon),o.xp6(1),o.ekj("disabled",!i.canPrevious()),o.xp6(2),o.Tol(i.pagerLeftArrowIcon),o.xp6(1),o.Q6J("ngForOf",i.pages),o.xp6(1),o.ekj("disabled",!i.canNext()),o.xp6(2),o.Tol(i.pagerRightArrowIcon),o.xp6(1),o.ekj("disabled",!i.canNext()),o.xp6(2),o.Tol(i.pagerNextIcon))},dependencies:[Hn],encapsulation:2,changeDetection:0}),n})(),sY=(()=>{class n{constructor(){this.selectedCount=0,this.page=new o.vpe}get isVisible(){return this.rowCount/this.pageSize>1}get curPage(){return this.offset+1}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=o.Xpm({type:n,selectors:[["datatable-footer"]],hostAttrs:[1,"datatable-footer"],inputs:{footerHeight:"footerHeight",rowCount:"rowCount",pageSize:"pageSize",offset:"offset",pagerLeftArrowIcon:"pagerLeftArrowIcon",pagerRightArrowIcon:"pagerRightArrowIcon",pagerPreviousIcon:"pagerPreviousIcon",pagerNextIcon:"pagerNextIcon",totalMessage:"totalMessage",footerTemplate:"footerTemplate",selectedCount:"selectedCount",selectedMessage:"selectedMessage"},outputs:{page:"page"},decls:4,vars:8,consts:[[1,"datatable-footer-inner",3,"ngClass"],[4,"ngIf"],["class","page-count",4,"ngIf"],[3,"pagerLeftArrowIcon","pagerRightArrowIcon","pagerPreviousIcon","pagerNextIcon","page","size","count","hidden","change",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"page-count"],[3,"pagerLeftArrowIcon","pagerRightArrowIcon","pagerPreviousIcon","pagerNextIcon","page","size","count","hidden","change"]],template:function(e,i){1&e&&(o.TgZ(0,"div",0),o.YNc(1,lK,1,8,null,1),o.YNc(2,uK,3,3,"div",2),o.YNc(3,hK,1,8,"datatable-pager",3),o.qZA()),2&e&&(o.Udp("height",i.footerHeight,"px"),o.Q6J("ngClass",o.VKq(6,dK,i.selectedMessage)),o.xp6(1),o.Q6J("ngIf",i.footerTemplate),o.xp6(1),o.Q6J("ngIf",!i.footerTemplate),o.xp6(1),o.Q6J("ngIf",!i.footerTemplate))},dependencies:[oY,Pi,Zn,Ki],encapsulation:2,changeDetection:0}),n})(),aY=(()=>{class n{constructor(e,i,r,a,g,E,O){this.scrollbarHelper=e,this.dimensionsHelper=i,this.cd=r,this.columnChangesService=E,this.configuration=O,this.selected=[],this.scrollbarV=!1,this.scrollbarH=!1,this.rowHeight=30,this.columnMode=eC.standard,this.headerHeight=30,this.footerHeight=0,this.externalPaging=!1,this.externalSorting=!1,this.loadingIndicator=!1,this.reorderable=!0,this.swapColumns=!0,this.sortType=tC.single,this.sorts=[],this.cssClasses={sortAscending:"datatable-icon-up",sortDescending:"datatable-icon-down",sortUnset:"datatable-icon-sort-unset",pagerLeftArrow:"datatable-icon-left",pagerRightArrow:"datatable-icon-right",pagerPrevious:"datatable-icon-prev",pagerNext:"datatable-icon-skip"},this.messages={emptyMessage:"No data to display",totalMessage:"total",selectedMessage:"selected"},this.groupExpansionDefault=!1,this.selectAllRowsOnPage=!1,this.virtualization=!0,this.summaryRow=!1,this.summaryHeight=30,this.summaryPosition="top",this.scroll=new o.vpe,this.activate=new o.vpe,this.select=new o.vpe,this.sort=new o.vpe,this.page=new o.vpe,this.reorder=new o.vpe,this.resize=new o.vpe,this.tableContextmenu=new o.vpe(!1),this.treeAction=new o.vpe,this.rowCount=0,this._offsetX=new $h(0),this._count=0,this._offset=0,this._subscriptions=[],this.rowIdentity=j=>this._groupRowsBy?j.key:j,this.element=a.nativeElement,this.rowDiffer=g.find({}).create(),this.configuration&&this.configuration.messages&&(this.messages={...this.configuration.messages})}set rows(e){this._rows=e,e&&(this._internalRows=[...e]),this.externalSorting||this.sortInternalRows(),this._internalRows=zL(this._internalRows,X1(this.treeFromRelation),X1(this.treeToRelation)),this.recalculate(),this._rows&&this._groupRowsBy&&(this.groupedRows=this.groupArrayBy(this._rows,this._groupRowsBy)),this.cd.markForCheck()}get rows(){return this._rows}set groupRowsBy(e){e&&(this._groupRowsBy=e,this._rows&&this._groupRowsBy&&(this.groupedRows=this.groupArrayBy(this._rows,this._groupRowsBy)))}get groupRowsBy(){return this._groupRowsBy}set columns(e){e&&(this._internalColumns=[...e],f6(this._internalColumns),this.recalculateColumns()),this._columns=e}get columns(){return this._columns}set limit(e){this._limit=e,this.recalculate()}get limit(){return this._limit}set count(e){this._count=e,this.recalculate()}get count(){return this._count}set offset(e){this._offset=e}get offset(){return Math.max(Math.min(this._offset,Math.ceil(this.rowCount/this.pageSize)-1),0)}get isFixedHeader(){const e=this.headerHeight;return"string"!=typeof e||"auto"!==e}get isFixedRow(){return"auto"!==this.rowHeight}get isVertScroll(){return this.scrollbarV}get isVirtualized(){return this.virtualization}get isHorScroll(){return this.scrollbarH}get isSelectable(){return void 0!==this.selectionType}get isCheckboxSelection(){return this.selectionType===Vd.checkbox}get isCellSelection(){return this.selectionType===Vd.cell}get isSingleSelection(){return this.selectionType===Vd.single}get isMultiSelection(){return this.selectionType===Vd.multi}get isMultiClickSelection(){return this.selectionType===Vd.multiClick}set columnTemplates(e){this._columnTemplates=e,this.translateColumns(e)}get columnTemplates(){return this._columnTemplates}get allRowsSelected(){let e=this.rows&&this.selected&&this.selected.length===this.rows.length;if(this.bodyComponent&&this.selectAllRowsOnPage){const i=this.bodyComponent.indexes;e=this.selected.length===i.last-i.first}return this.selected&&this.rows&&0!==this.rows.length&&e}ngOnInit(){this.recalculate()}ngAfterViewInit(){this.externalSorting||this.sortInternalRows(),!(typeof requestAnimationFrame>"u")&&requestAnimationFrame(()=>{this.recalculate(),this.externalPaging&&this.scrollbarV&&this.page.emit({count:this.count,pageSize:this.pageSize,limit:this.limit,offset:0})})}ngAfterContentInit(){this.columnTemplates.changes.subscribe(e=>this.translateColumns(e)),this.listenForColumnInputChanges()}translateColumns(e){if(e){const i=e.toArray();i.length&&(this._internalColumns=function DK(n){const t=[];for(const e of n){const i={},r=Object.getOwnPropertyNames(e);for(const a of r)i[a]=e[a];e.headerTemplate&&(i.headerTemplate=e.headerTemplate),e.cellTemplate&&(i.cellTemplate=e.cellTemplate),e.summaryFunc&&(i.summaryFunc=e.summaryFunc),e.summaryTemplate&&(i.summaryTemplate=e.summaryTemplate),t.push(i)}return t}(i),f6(this._internalColumns),this.recalculateColumns(),this.sortInternalRows(),this.cd.markForCheck())}}groupArrayBy(e,i){const r=new Map;return e.forEach(E=>{const O=E[i];r.has(O)?r.get(O).push(E):r.set(O,[E])}),Array.from(r,E=>((E,O)=>({key:E,value:O}))(E[0],E[1]))}ngDoCheck(){this.rowDiffer.diff(this.rows)&&(this.externalSorting?this._internalRows=[...this.rows]:this.sortInternalRows(),this._internalRows=zL(this._internalRows,X1(this.treeFromRelation),X1(this.treeToRelation)),this.recalculatePages(),this.cd.markForCheck())}recalculate(){this.recalculateDims(),this.recalculateColumns(),this.cd.markForCheck()}onWindowResize(){this.recalculate()}recalculateColumns(e=this._internalColumns,i=-1,r=this.scrollbarH){if(!e)return;let a=this._innerWidth;return this.scrollbarV&&(a-=this.scrollbarHelper.width),this.columnMode===eC.force?function iY(n,t,e,i,r=300){const a=n.slice(e+1,n.length).filter(be=>!1!==be.canAutoResize);for(const be of a)be.$$oldWidth||(be.$$oldWidth=be.width);let g=0,E=!1,O=C6(n,r),j=t-O;const Y=[];do{g=j/a.length,E=O>=t;for(const be of a){if(E&&i)be.width=be.$$oldWidth||be.width||r;else{const Me=(be.width||r)+g;be.minWidth&&Me<be.minWidth?(be.width=be.minWidth,Y.push(be)):be.maxWidth&&Me>be.maxWidth?(be.width=be.maxWidth,Y.push(be)):be.width=Me}be.width=Math.max(0,be.width)}O=C6(n),j=t-O,rY(a,Y)}while(j>1&&0!==a.length)}(e,a,i,r):this.columnMode===eC.flex&&function tY(n,t){const e=function OK(n,t){let e=0;for(const i of n)e+=t&&i[t]?i[t]:i.width;return e}(n),i=function eY(n){let t=0;for(const e of n)t+=e.flexGrow||0;return t}(n),r=nw(n);e!==t&&function nY(n,t,e){for(const a in n)for(const g of n[a])g.canAutoResize?g.width=0:(t-=g.width,e-=g.flexGrow?g.flexGrow:0);const i={};let r=t;do{const a=r/e;r=0;for(const g in n)for(const E of n[g])if(E.canAutoResize&&!i[E.prop]){const O=E.width+E.flexGrow*a;void 0!==E.minWidth&&O<E.minWidth?(r+=O-E.minWidth,E.width=E.minWidth,i[E.prop]=!0):E.width=O}}while(0!==r)}(r,t,i)}(e,a),e}recalculateDims(){const e=this.dimensionsHelper.getDimensions(this.element);if(this._innerWidth=Math.floor(e.width),this.scrollbarV){let i=e.height;this.headerHeight&&(i-=this.headerHeight),this.footerHeight&&(i-=this.footerHeight),this.bodyHeight=i}this.recalculatePages()}recalculatePages(){this.pageSize=this.calcPageSize(),this.rowCount=this.calcRowCount()}onBodyPage({offset:e}){this.externalPaging&&!this.virtualization||(this.offset=e,this.page.emit({count:this.count,pageSize:this.pageSize,limit:this.limit,offset:this.offset}))}onBodyScroll(e){this._offsetX.next(e.offsetX),this.scroll.emit(e),this.cd.detectChanges()}onFooterPage(e){this.offset=e.page-1,this.bodyComponent.updateOffsetY(this.offset),this.page.emit({count:this.count,pageSize:this.pageSize,limit:this.limit,offset:this.offset}),this.selectAllRowsOnPage&&(this.selected=[],this.select.emit({selected:this.selected}))}calcPageSize(e=this.rows){if(this.scrollbarV&&this.virtualization){const i=Math.ceil(this.bodyHeight/this.rowHeight);return Math.max(i,0)}return void 0!==this.limit?this.limit:e?e.length:0}calcRowCount(e=this.rows){return this.externalPaging?this.count:e?this.groupedRows?this.groupedRows.length:null!=this.treeFromRelation&&null!=this.treeToRelation?this._internalRows.length:e.length:0}onColumnContextmenu({event:e,column:i}){this.tableContextmenu.emit({event:e,type:MS.header,content:i})}onRowContextmenu({event:e,row:i}){this.tableContextmenu.emit({event:e,type:MS.body,content:i})}onColumnResize({column:e,newValue:i}){if(void 0===e)return;let r;const a=this._internalColumns.map((g,E)=>((g={...g}).$$id===e.$$id&&(r=E,g.width=i,g.$$oldWidth=i),g));this.recalculateColumns(a,r),this._internalColumns=a,this.resize.emit({column:e,newValue:i})}onColumnReorder({column:e,newValue:i,prevValue:r}){const a=this._internalColumns.map(g=>({...g}));if(this.swapColumns){const g=a[i];a[i]=e,a[r]=g}else if(i>r){const g=a[r];for(let E=r;E<i;E++)a[E]=a[E+1];a[i]=g}else{const g=a[r];for(let E=r;E>i;E--)a[E]=a[E-1];a[i]=g}this._internalColumns=a,this.reorder.emit({column:e,newValue:i,prevValue:r})}onColumnSort(e){this.selectAllRowsOnPage&&(this.selected=[],this.select.emit({selected:this.selected})),this.sorts=e.sorts,!1===this.externalSorting&&this.sortInternalRows(),this._internalRows=zL(this._internalRows,X1(this.treeFromRelation),X1(this.treeToRelation)),this.offset=0,this.bodyComponent.updateOffsetY(this.offset),this.sort.emit(e)}onHeaderSelect(e){if(this.bodyComponent&&this.selectAllRowsOnPage){const i=this.bodyComponent.indexes.first,r=this.bodyComponent.indexes.last,a=this.selected.length===r-i;this.selected=[],a||this.selected.push(...this._internalRows.slice(i,r))}else{const i=this.selected.length===this.rows.length;this.selected=[],i||this.selected.push(...this.rows)}this.select.emit({selected:this.selected})}onBodySelect(e){this.select.emit(e)}onTreeAction(e){const i=e.row,r=this._rows.findIndex(a=>a[this.treeToRelation]===e.row[this.treeToRelation]);this.treeAction.emit({row:i,rowIndex:r})}ngOnDestroy(){this._subscriptions.forEach(e=>e.unsubscribe())}listenForColumnInputChanges(){this._subscriptions.push(this.columnChangesService.columnInputChanges$.subscribe(()=>{this.columnTemplates&&this.columnTemplates.notifyOnChanges()}))}sortInternalRows(){this._internalRows=function YK(n,t,e){if(!n)return[];if(!e||!e.length||!t)return[...n];const i=new Map;n.forEach((E,O)=>i.set(E,O));const r=[...n],a=t.reduce((E,O)=>(O.comparator&&"function"==typeof O.comparator&&(E[O.prop]=O.comparator),E),{}),g=e.map(E=>{const O=E.prop;return{prop:O,dir:E.dir,valueGetter:NL(O),compareFn:a[O]||KK}});return r.sort(function(E,O){for(const j of g){const{prop:Y,valueGetter:se}=j,be=se(E,Y),Me=se(O,Y),Ge=j.dir!==Wh.desc?j.compareFn(be,Me,E,O,j.dir):-j.compareFn(be,Me,E,O,j.dir);if(0!==Ge)return Ge}return i.has(E)&&i.has(O)?i.get(E)<i.get(O)?-1:1:0})}(this._internalRows,this._internalColumns,this.sorts)}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(LL,4),o.Y36(u6,4),o.Y36(o.sBO),o.Y36(o.SBq),o.Y36(o.aQg),o.Y36(FL),o.Y36("configuration",8))},n.\u0275cmp=o.Xpm({type:n,selectors:[["ngx-datatable"]],contentQueries:function(e,i,r){if(1&e&&(o.Suo(r,RK,5),o.Suo(r,wK,5),o.Suo(r,PK,5),o.Suo(r,g6,4)),2&e){let a;o.iGM(a=o.CRH())&&(i.rowDetail=a.first),o.iGM(a=o.CRH())&&(i.groupHeader=a.first),o.iGM(a=o.CRH())&&(i.footer=a.first),o.iGM(a=o.CRH())&&(i.columnTemplates=a)}},viewQuery:function(e,i){if(1&e&&(o.Gf(w6,5),o.Gf(x6,5)),2&e){let r;o.iGM(r=o.CRH())&&(i.bodyComponent=r.first),o.iGM(r=o.CRH())&&(i.headerComponent=r.first)}},hostAttrs:[1,"ngx-datatable"],hostVars:22,hostBindings:function(e,i){1&e&&o.NdJ("resize",function(){return i.onWindowResize()},!1,o.Jf7),2&e&&o.ekj("fixed-header",i.isFixedHeader)("fixed-row",i.isFixedRow)("scroll-vertical",i.isVertScroll)("virtualized",i.isVirtualized)("scroll-horz",i.isHorScroll)("selectable",i.isSelectable)("checkbox-selection",i.isCheckboxSelection)("cell-selection",i.isCellSelection)("single-selection",i.isSingleSelection)("multi-selection",i.isMultiSelection)("multi-click-selection",i.isMultiClickSelection)},inputs:{targetMarkerTemplate:"targetMarkerTemplate",rows:"rows",groupRowsBy:"groupRowsBy",groupedRows:"groupedRows",columns:"columns",selected:"selected",scrollbarV:"scrollbarV",scrollbarH:"scrollbarH",rowHeight:"rowHeight",columnMode:"columnMode",headerHeight:"headerHeight",footerHeight:"footerHeight",externalPaging:"externalPaging",externalSorting:"externalSorting",limit:"limit",count:"count",offset:"offset",loadingIndicator:"loadingIndicator",selectionType:"selectionType",reorderable:"reorderable",swapColumns:"swapColumns",sortType:"sortType",sorts:"sorts",cssClasses:"cssClasses",messages:"messages",rowClass:"rowClass",selectCheck:"selectCheck",displayCheck:"displayCheck",groupExpansionDefault:"groupExpansionDefault",trackByProp:"trackByProp",selectAllRowsOnPage:"selectAllRowsOnPage",virtualization:"virtualization",treeFromRelation:"treeFromRelation",treeToRelation:"treeToRelation",summaryRow:"summaryRow",summaryHeight:"summaryHeight",summaryPosition:"summaryPosition",rowIdentity:"rowIdentity"},outputs:{scroll:"scroll",activate:"activate",select:"select",sort:"sort",page:"page",reorder:"reorder",resize:"resize",tableContextmenu:"tableContextmenu",treeAction:"treeAction"},decls:5,vars:34,consts:[["role","table","visibilityObserver","",3,"visible"],["role","rowgroup",3,"sorts","sortType","scrollbarH","innerWidth","offsetX","dealsWithGroup","columns","headerHeight","reorderable","targetMarkerTemplate","sortAscendingIcon","sortDescendingIcon","sortUnsetIcon","allRowsSelected","selectionType","sort","resize","reorder","select","columnContextmenu",4,"ngIf"],["role","rowgroup",3,"groupRowsBy","groupedRows","rows","groupExpansionDefault","scrollbarV","scrollbarH","virtualization","loadingIndicator","externalPaging","rowHeight","rowCount","offset","trackByProp","columns","pageSize","offsetX","rowDetail","groupHeader","selected","innerWidth","bodyHeight","selectionType","emptyMessage","rowIdentity","rowClass","selectCheck","displayCheck","summaryRow","summaryHeight","summaryPosition","page","activate","rowContextmenu","select","scroll","treeAction"],[3,"rowCount","pageSize","offset","footerHeight","footerTemplate","totalMessage","pagerLeftArrowIcon","pagerRightArrowIcon","pagerPreviousIcon","selectedCount","selectedMessage","pagerNextIcon","page",4,"ngIf"],["role","rowgroup",3,"sorts","sortType","scrollbarH","innerWidth","offsetX","dealsWithGroup","columns","headerHeight","reorderable","targetMarkerTemplate","sortAscendingIcon","sortDescendingIcon","sortUnsetIcon","allRowsSelected","selectionType","sort","resize","reorder","select","columnContextmenu"],[3,"rowCount","pageSize","offset","footerHeight","footerTemplate","totalMessage","pagerLeftArrowIcon","pagerRightArrowIcon","pagerPreviousIcon","selectedCount","selectedMessage","pagerNextIcon","page"]],template:function(e,i){1&e&&(o.TgZ(0,"div",0),o.NdJ("visible",function(){return i.recalculate()}),o.YNc(1,pK,2,17,"datatable-header",1),o.TgZ(2,"datatable-body",2),o.NdJ("page",function(a){return i.onBodyPage(a)})("activate",function(a){return i.activate.emit(a)})("rowContextmenu",function(a){return i.onRowContextmenu(a)})("select",function(a){return i.onBodySelect(a)})("scroll",function(a){return i.onBodyScroll(a)})("treeAction",function(a){return i.onTreeAction(a)}),o.ALo(3,"async"),o.qZA(),o.YNc(4,fK,1,12,"datatable-footer",3),o.qZA()),2&e&&(o.xp6(1),o.Q6J("ngIf",i.headerHeight),o.xp6(1),o.Q6J("groupRowsBy",i.groupRowsBy)("groupedRows",i.groupedRows)("rows",i._internalRows)("groupExpansionDefault",i.groupExpansionDefault)("scrollbarV",i.scrollbarV)("scrollbarH",i.scrollbarH)("virtualization",i.virtualization)("loadingIndicator",i.loadingIndicator)("externalPaging",i.externalPaging)("rowHeight",i.rowHeight)("rowCount",i.rowCount)("offset",i.offset)("trackByProp",i.trackByProp)("columns",i._internalColumns)("pageSize",i.pageSize)("offsetX",o.lcZ(3,32,i._offsetX))("rowDetail",i.rowDetail)("groupHeader",i.groupHeader)("selected",i.selected)("innerWidth",i._innerWidth)("bodyHeight",i.bodyHeight)("selectionType",i.selectionType)("emptyMessage",i.messages.emptyMessage)("rowIdentity",i.rowIdentity)("rowClass",i.rowClass)("selectCheck",i.selectCheck)("displayCheck",i.displayCheck)("summaryRow",i.summaryRow)("summaryHeight",i.summaryHeight)("summaryPosition",i.summaryPosition),o.xp6(2),o.Q6J("ngIf",i.footerHeight))},dependencies:[x6,w6,sY,gK,Zn,Qi],styles:[".ngx-datatable{display:block;overflow:hidden;justify-content:center;position:relative;transform:translate(0)}.ngx-datatable [hidden]{display:none!important}.ngx-datatable *,.ngx-datatable *:before,.ngx-datatable *:after{box-sizing:border-box}.ngx-datatable.scroll-vertical .datatable-body{overflow-y:auto}.ngx-datatable.scroll-vertical.virtualized .datatable-body .datatable-row-wrapper{position:absolute}.ngx-datatable.scroll-horz .datatable-body{overflow-x:auto;-webkit-overflow-scrolling:touch}.ngx-datatable.fixed-header .datatable-header .datatable-header-inner{white-space:nowrap}.ngx-datatable.fixed-header .datatable-header .datatable-header-inner .datatable-header-cell{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ngx-datatable.fixed-row .datatable-scroll,.ngx-datatable.fixed-row .datatable-scroll .datatable-body-row{white-space:nowrap}.ngx-datatable.fixed-row .datatable-scroll .datatable-body-row .datatable-body-cell,.ngx-datatable.fixed-row .datatable-scroll .datatable-body-row .datatable-body-group-cell{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.ngx-datatable .datatable-body-row,.ngx-datatable .datatable-row-center,.ngx-datatable .datatable-header-inner{display:flex;flex-direction:row;-o-flex-flow:row;flex-flow:row}.ngx-datatable .datatable-body-cell,.ngx-datatable .datatable-header-cell{overflow-x:hidden;vertical-align:top;display:inline-block;line-height:1.625}.ngx-datatable .datatable-body-cell:focus,.ngx-datatable .datatable-header-cell:focus{outline:none}.ngx-datatable .datatable-row-left,.ngx-datatable .datatable-row-right{z-index:9}.ngx-datatable .datatable-row-left,.ngx-datatable .datatable-row-center,.ngx-datatable .datatable-row-group,.ngx-datatable .datatable-row-right{position:relative}.ngx-datatable .datatable-header{display:block;overflow:hidden}.ngx-datatable .datatable-header .datatable-header-inner{align-items:stretch;-webkit-align-items:stretch}.ngx-datatable .datatable-header .datatable-header-cell{position:relative;display:inline-block}.ngx-datatable .datatable-header .datatable-header-cell.sortable .datatable-header-cell-wrapper{cursor:pointer}.ngx-datatable .datatable-header .datatable-header-cell.longpress .datatable-header-cell-wrapper{cursor:move}.ngx-datatable .datatable-header .datatable-header-cell .sort-btn{line-height:100%;vertical-align:middle;display:inline-block;cursor:pointer}.ngx-datatable .datatable-header .datatable-header-cell .resize-handle,.ngx-datatable .datatable-header .datatable-header-cell .resize-handle--not-resizable{display:inline-block;position:absolute;right:0;top:0;bottom:0;width:5px;padding:0 4px;visibility:hidden}.ngx-datatable .datatable-header .datatable-header-cell .resize-handle{cursor:ew-resize}.ngx-datatable .datatable-header .datatable-header-cell.resizeable:hover .resize-handle,.ngx-datatable .datatable-header .datatable-header-cell:hover .resize-handle--not-resizable{visibility:visible}.ngx-datatable .datatable-header .datatable-header-cell .targetMarker{position:absolute;top:0;bottom:0}.ngx-datatable .datatable-header .datatable-header-cell .targetMarker.dragFromLeft{right:0}.ngx-datatable .datatable-header .datatable-header-cell .targetMarker.dragFromRight{left:0}.ngx-datatable .datatable-header .datatable-header-cell .datatable-header-cell-template-wrap{height:inherit}.ngx-datatable .datatable-body{position:relative;z-index:10;display:block}.ngx-datatable .datatable-body .datatable-scroll{display:inline-block}.ngx-datatable .datatable-body .datatable-row-detail{overflow-y:hidden}.ngx-datatable .datatable-body .datatable-row-wrapper{display:flex;flex-direction:column}.ngx-datatable .datatable-body .datatable-body-row{outline:none}.ngx-datatable .datatable-body .datatable-body-row>div{display:flex}.ngx-datatable .datatable-footer{display:block;width:100%;overflow:auto}.ngx-datatable .datatable-footer .datatable-footer-inner{display:flex;align-items:center;width:100%}.ngx-datatable .datatable-footer .selected-count .page-count{flex:1 1 40%}.ngx-datatable .datatable-footer .selected-count .datatable-pager{flex:1 1 60%}.ngx-datatable .datatable-footer .page-count{flex:1 1 20%}.ngx-datatable .datatable-footer .datatable-pager{flex:1 1 80%;text-align:right}.ngx-datatable .datatable-footer .datatable-pager .pager,.ngx-datatable .datatable-footer .datatable-pager .pager li{padding:0;margin:0;display:inline-block;list-style:none}.ngx-datatable .datatable-footer .datatable-pager .pager li,.ngx-datatable .datatable-footer .datatable-pager .pager li a{outline:none}.ngx-datatable .datatable-footer .datatable-pager .pager li a{cursor:pointer;display:inline-block}.ngx-datatable .datatable-footer .datatable-pager .pager li.disabled a{cursor:not-allowed}\n"],encapsulation:2,changeDetection:0}),(0,y9.gn)([XK(5)],n.prototype,"onWindowResize",null),n})(),lY=(()=>{class n{static forRoot(e){return{ngModule:n,providers:[{provide:"configuration",useValue:e}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({providers:[LL,u6,FL],imports:[[tr]]}),n})();typeof document<"u"&&!document.elementsFromPoint&&(document.elementsFromPoint=function cY(n,t){const e=[],i=[];let r,a,g;for(;(r=document.elementFromPoint(n,t))&&-1===e.indexOf(r)&&null!=r;)e.push(r),i.push({value:r.style.getPropertyValue("pointer-events"),priority:r.style.getPropertyPriority("pointer-events")}),r.style.setProperty("pointer-events","none","important");for(a=i.length;g=i[--a];)e[a].style.setProperty("pointer-events",g.value?g.value:"",g.priority);return e});var nC=Ee(9898),uY=Ee.t(nC,2);class E6 extends Es.x{constructor(){super(...arguments),this._value=null,this._hasValue=!1,this._isComplete=!1}_checkFinalizedStatuses(t){const{hasError:e,_hasValue:i,_value:r,thrownError:a,isStopped:g,_isComplete:E}=this;e?t.error(a):(g||E)&&(i&&t.next(r),t.complete())}next(t){this.isStopped||(this._value=t,this._hasValue=!0)}complete(){const{_hasValue:t,_value:e,_isComplete:i}=this;i||(this._isComplete=!0,t&&super.next(e),super.complete())}}var Gv=Ee(727);const dY=["content"],pY=["*"],fY=["container"],S6=new o.OlP("MapboxApiKey");let WM=(()=>{class n{constructor(e,i){this.zone=e,this.MAPBOX_API_KEY=i,this.mapCreated=new E6,this.mapLoaded=new E6,this.markersToRemove=[],this.popupsToRemove=[],this.imageIdsToRemove=[],this.subscription=new Gv.w0,this.mapCreated$=this.mapCreated.asObservable(),this.mapLoaded$=this.mapLoaded.asObservable()}setup(e){this.zone.onStable.pipe(Bh()).subscribe(()=>{e.customMapboxApiUrl&&this.assign(uY,"config.API_URL",e.customMapboxApiUrl),this.createMap({...e.mapOptions,accessToken:e.accessToken||this.MAPBOX_API_KEY||""}),this.hookEvents(e.mapEvents),this.mapEvents=e.mapEvents,this.mapCreated.next(void 0),this.mapCreated.complete()})}destroyMap(){this.mapInstance&&(this.subscription.unsubscribe(),this.mapInstance.remove())}updateProjection(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setProjection(e)})}updateMinZoom(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinZoom(e)})}updateMaxZoom(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxZoom(e)})}updateMinPitch(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinPitch(e)})}updateMaxPitch(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxPitch(e)})}updateRenderWorldCopies(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setRenderWorldCopies(e)})}updateScrollZoom(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.scrollZoom.enable():this.mapInstance.scrollZoom.disable()})}updateDragRotate(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.dragRotate.enable():this.mapInstance.dragRotate.disable()})}updateTouchPitch(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.touchPitch.enable():this.mapInstance.touchPitch.disable()})}updateTouchZoomRotate(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.touchZoomRotate.enable():this.mapInstance.touchZoomRotate.disable()})}updateDoubleClickZoom(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.doubleClickZoom.enable():this.mapInstance.doubleClickZoom.disable()})}updateKeyboard(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.keyboard.enable():this.mapInstance.keyboard.disable()})}updateDragPan(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.dragPan.enable():this.mapInstance.dragPan.disable()})}updateBoxZoom(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.boxZoom.enable():this.mapInstance.boxZoom.disable()})}updateStyle(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setStyle(e)})}updateMaxBounds(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxBounds(e)})}changeCanvasCursor(e){this.mapInstance.getCanvasContainer().style.cursor=e}queryRenderedFeatures(e,i){return this.mapInstance.queryRenderedFeatures(e,i)}panTo(e,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.panTo(e,i)})}move(e,i,r,a,g,E){return this.zone.runOutsideAngular(()=>{this.mapInstance[e]({...i,zoom:r??this.mapInstance.getZoom(),center:a??this.mapInstance.getCenter(),bearing:g??this.mapInstance.getBearing(),pitch:E??this.mapInstance.getPitch()})})}addLayer(e,i,r){this.zone.runOutsideAngular(()=>{Object.keys(e.layerOptions).forEach(a=>{void 0===e.layerOptions[a]&&delete e.layerOptions[a]}),this.mapInstance.addLayer(e.layerOptions,r),i&&((e.layerEvents.layerClick.observed||e.layerEvents.click.observed)&&this.mapInstance.on("click",e.layerOptions.id,a=>{this.zone.run(()=>{e.layerEvents.layerClick.emit(a),e.layerEvents.click.emit(a)})}),(e.layerEvents.layerDblClick.observed||e.layerEvents.dblClick.observed)&&this.mapInstance.on("dblclick",e.layerOptions.id,a=>{this.zone.run(()=>{e.layerEvents.layerDblClick.emit(a),e.layerEvents.dblClick.emit(a)})}),(e.layerEvents.layerMouseDown.observed||e.layerEvents.mouseDown.observed)&&this.mapInstance.on("mousedown",e.layerOptions.id,a=>{this.zone.run(()=>{e.layerEvents.layerMouseDown.emit(a),e.layerEvents.mouseDown.emit(a)})}),(e.layerEvents.layerMouseUp.observed||e.layerEvents.mouseUp.observed)&&this.mapInstance.on("mouseup",e.layerOptions.id,a=>{this.zone.run(()=>{e.layerEvents.layerMouseUp.emit(a),e.layerEvents.mouseUp.emit(a)})}),(e.layerEvents.layerMouseEnter.observed||e.layerEvents.mouseEnter.observed)&&this.mapInstance.on("mouseenter",e.layerOptions.id,a=>{this.zone.run(()=>{e.layerEvents.layerMouseEnter.emit(a),e.layerEvents.mouseEnter.emit(a)})}),(e.layerEvents.layerMouseLeave.observed||e.layerEvents.mouseLeave.observed)&&this.mapInstance.on("mouseleave",e.layerOptions.id,a=>{this.zone.run(()=>{e.layerEvents.layerMouseLeave.emit(a),e.layerEvents.mouseLeave.emit(a)})}),(e.layerEvents.layerMouseMove.observed||e.layerEvents.mouseMove.observed)&&this.mapInstance.on("mousemove",e.layerOptions.id,a=>{this.zone.run(()=>{e.layerEvents.layerMouseMove.emit(a),e.layerEvents.mouseMove.emit(a)})}),(e.layerEvents.layerMouseOver.observed||e.layerEvents.mouseOver.observed)&&this.mapInstance.on("mouseover",e.layerOptions.id,a=>{this.zone.run(()=>{e.layerEvents.layerMouseOver.emit(a),e.layerEvents.mouseOver.emit(a)})}),(e.layerEvents.layerMouseOut.observed||e.layerEvents.mouseOut.observed)&&this.mapInstance.on("mouseout",e.layerOptions.id,a=>{this.zone.run(()=>{e.layerEvents.layerMouseOut.emit(a),e.layerEvents.mouseOut.emit(a)})}),(e.layerEvents.layerContextMenu.observed||e.layerEvents.contextMenu.observed)&&this.mapInstance.on("contextmenu",e.layerOptions.id,a=>{this.zone.run(()=>{e.layerEvents.layerContextMenu.emit(a),e.layerEvents.contextMenu.emit(a)})}),(e.layerEvents.layerTouchStart.observed||e.layerEvents.touchStart.observed)&&this.mapInstance.on("touchstart",e.layerOptions.id,a=>{this.zone.run(()=>{e.layerEvents.layerTouchStart.emit(a),e.layerEvents.touchStart.emit(a)})}),(e.layerEvents.layerTouchEnd.observed||e.layerEvents.touchEnd.observed)&&this.mapInstance.on("touchend",e.layerOptions.id,a=>{this.zone.run(()=>{e.layerEvents.layerTouchEnd.emit(a),e.layerEvents.touchEnd.emit(a)})}),(e.layerEvents.layerTouchCancel.observed||e.layerEvents.touchCancel.observed)&&this.mapInstance.on("touchcancel",e.layerOptions.id,a=>{this.zone.run(()=>{e.layerEvents.layerTouchCancel.emit(a),e.layerEvents.touchCancel.emit(a)})}))})}removeLayer(e){this.zone.runOutsideAngular(()=>{null!=this.mapInstance.getLayer(e)&&this.mapInstance.removeLayer(e)})}addMarker(e){const i={offset:e.markersOptions.offset,anchor:e.markersOptions.anchor,draggable:!!e.markersOptions.draggable,rotationAlignment:e.markersOptions.rotationAlignment,pitchAlignment:e.markersOptions.pitchAlignment,clickTolerance:e.markersOptions.clickTolerance};e.markersOptions.element.childNodes.length>0&&(i.element=e.markersOptions.element);const r=new nC.Marker(i);return(e.markersEvents.markerDragStart.observed||e.markersEvents.dragStart.observed)&&r.on("dragstart",g=>{if(g){const{target:E}=g;this.zone.run(()=>{e.markersEvents.markerDragStart.emit(E),e.markersEvents.dragStart.emit(E)})}}),(e.markersEvents.markerDrag.observed||e.markersEvents.drag.observed)&&r.on("drag",g=>{if(g){const{target:E}=g;this.zone.run(()=>{e.markersEvents.markerDrag.emit(E),e.markersEvents.drag.emit(E)})}}),(e.markersEvents.markerDragEnd.observed||e.markersEvents.dragEnd.observed)&&r.on("dragend",g=>{if(g){const{target:E}=g;this.zone.run(()=>{e.markersEvents.markerDragEnd.emit(E),e.markersEvents.dragEnd.emit(E)})}}),r.setLngLat(e.markersOptions.feature?e.markersOptions.feature.geometry.coordinates:e.markersOptions.lngLat),this.zone.runOutsideAngular(()=>(r.addTo(this.mapInstance),r))}removeMarker(e){this.markersToRemove.push(e)}createPopup(e,i){return this.zone.runOutsideAngular(()=>{Object.keys(e.popupOptions).forEach(a=>void 0===e.popupOptions[a]&&delete e.popupOptions[a]);const r=new nC.Popup(e.popupOptions);return r.setDOMContent(i),(e.popupEvents.popupClose.observed||e.popupEvents.close.observed)&&r.on("close",()=>{this.zone.run(()=>{e.popupEvents.popupClose.emit(),e.popupEvents.close.emit()})}),(e.popupEvents.popupOpen.observed||e.popupEvents.open.observed)&&r.on("open",()=>{this.zone.run(()=>{e.popupEvents.popupOpen.emit(),e.popupEvents.open.emit()})}),r})}addPopupToMap(e,i,r=!1){return this.zone.runOutsideAngular(()=>{r&&e._listeners&&delete e._listeners.open,e.setLngLat(i),e.addTo(this.mapInstance)})}addPopupToMarker(e,i){return this.zone.runOutsideAngular(()=>{e.setPopup(i)})}removePopupFromMap(e,i=!1){i&&e._listeners&&delete e._listeners.close,this.popupsToRemove.push(e)}removePopupFromMarker(e){return this.zone.runOutsideAngular(()=>{e.setPopup(void 0)})}addControl(e,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.addControl(e,i)})}removeControl(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.removeControl(e)})}loadAndAddImage(e,i,r){var a=this;return(0,ve.Z)(function*(){return a.zone.runOutsideAngular(()=>new Promise((g,E)=>{a.mapInstance.loadImage(i,(O,j)=>{O?E(O):(a.addImage(e,j,r),g())})}))})()}addImage(e,i,r){return this.zone.runOutsideAngular(()=>{this.mapInstance.addImage(e,i,r)})}removeImage(e){this.imageIdsToRemove.push(e)}addSource(e,i){return this.zone.runOutsideAngular(()=>{Object.keys(i).forEach(r=>void 0===i[r]&&delete i[r]),this.mapInstance.addSource(e,i)})}getSource(e){return this.mapInstance.getSource(e)}removeSource(e){this.zone.runOutsideAngular(()=>{this.findLayersBySourceId(e).forEach(i=>this.mapInstance.removeLayer(i.id)),this.mapInstance.removeSource(e)})}setAllLayerPaintProperty(e,i){return this.zone.runOutsideAngular(()=>{Object.keys(i).forEach(r=>{this.mapInstance.setPaintProperty(e,r,i[r])})})}setAllLayerLayoutProperty(e,i){return this.zone.runOutsideAngular(()=>{Object.keys(i).forEach(r=>{this.mapInstance.setLayoutProperty(e,r,i[r])})})}setLayerFilter(e,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.setFilter(e,i)})}setLayerBefore(e,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.moveLayer(e,i)})}setLayerZoomRange(e,i,r){return this.zone.runOutsideAngular(()=>{this.mapInstance.setLayerZoomRange(e,i||0,r||20)})}fitBounds(e,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitBounds(e,i)})}fitScreenCoordinates(e,i,r){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitScreenCoordinates(e[0],e[1],i,r)})}applyChanges(){this.zone.runOutsideAngular(()=>{this.removeMarkers(),this.removePopups(),this.removeImages()})}createMap(e){o.R0b.assertNotInAngularZone(),Object.keys(e).forEach(r=>{void 0===e[r]&&delete e[r]}),this.mapInstance=new nC.Map(e),window&&/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)&&this.mapInstance.setStyle(e.style),this.subscription.add(this.zone.onMicrotaskEmpty.subscribe(()=>this.applyChanges()))}removeMarkers(){for(const e of this.markersToRemove)e.remove();this.markersToRemove=[]}removePopups(){for(const e of this.popupsToRemove)e.remove();this.popupsToRemove=[]}removeImages(){for(const e of this.imageIdsToRemove)this.mapInstance.removeImage(e);this.imageIdsToRemove=[]}findLayersBySourceId(e){const i=this.mapInstance.getStyle().layers;return null==i?[]:i.filter(r=>"source"in r&&r.source===e)}hookEvents(e){this.mapInstance.on("load",i=>{this.mapLoaded.next(void 0),this.mapLoaded.complete(),this.zone.run(()=>{e.mapLoad.emit(i.target),e.load.emit(i.target)})}),(e.mapResize.observed||e.resize.observed)&&this.mapInstance.on("resize",i=>this.zone.run(()=>{e.mapResize.emit(i),e.resize.emit(i)})),(e.mapRemove.observed||e.remove.observed)&&this.mapInstance.on("remove",i=>this.zone.run(()=>{e.mapRemove.emit(i),e.remove.emit(i)})),(e.mapMouseDown.observed||e.mouseDown.observed)&&this.mapInstance.on("mousedown",i=>this.zone.run(()=>{e.mapMouseDown.emit(i),e.mouseDown.emit(i)})),(e.mapMouseUp.observed||e.mouseUp.observed)&&this.mapInstance.on("mouseup",i=>this.zone.run(()=>{e.mapMouseUp.emit(i),e.mouseUp.emit(i)})),(e.mapMouseMove.observed||e.mouseMove.observed)&&this.mapInstance.on("mousemove",i=>this.zone.run(()=>{e.mapMouseMove.emit(i),e.mouseMove.emit(i)})),(e.mapClick.observed||e.click.observed)&&this.mapInstance.on("click",i=>this.zone.run(()=>{e.mapClick.emit(i),e.click.emit(i)})),(e.mapDblClick.observed||e.dblClick.observed)&&this.mapInstance.on("dblclick",i=>this.zone.run(()=>{e.mapDblClick.emit(i),e.dblClick.emit(i)})),(e.mapMouseOver.observed||e.mouseOver.observed)&&this.mapInstance.on("mouseover",i=>this.zone.run(()=>{e.mapMouseOver.emit(i),e.mouseOver.emit(i)})),(e.mapMouseOut.observed||e.mouseOut.observed)&&this.mapInstance.on("mouseout",i=>this.zone.run(()=>{e.mapMouseOut.emit(i),e.mouseOut.emit(i)})),(e.mapContextMenu.observed||e.contextMenu.observed)&&this.mapInstance.on("contextmenu",i=>this.zone.run(()=>{e.mapContextMenu.emit(i),e.contextMenu.emit(i)})),(e.mapTouchStart.observed||e.touchStart.observed)&&this.mapInstance.on("touchstart",i=>this.zone.run(()=>{e.mapTouchStart.emit(i),e.touchStart.emit(i)})),(e.mapTouchEnd.observed||e.touchEnd.observed)&&this.mapInstance.on("touchend",i=>this.zone.run(()=>{e.mapTouchEnd.emit(i),e.touchEnd.emit(i)})),(e.mapTouchMove.observed||e.touchMove.observed)&&this.mapInstance.on("touchmove",i=>this.zone.run(()=>{e.mapTouchMove.emit(i),e.touchMove.emit(i)})),(e.mapTouchCancel.observed||e.touchCancel.observed)&&this.mapInstance.on("touchcancel",i=>this.zone.run(()=>{e.mapTouchCancel.emit(i),e.touchCancel.emit(i)})),(e.mapWheel.observed||e.wheel.observed)&&this.mapInstance.on("wheel",i=>this.zone.run(()=>{e.mapWheel.emit(i),e.wheel.emit(i)})),e.moveStart.observed&&this.mapInstance.on("movestart",i=>this.zone.run(()=>e.moveStart.emit(i))),e.move.observed&&this.mapInstance.on("move",i=>this.zone.run(()=>e.move.emit(i))),e.moveEnd.observed&&this.mapInstance.on("moveend",i=>this.zone.run(()=>e.moveEnd.emit(i))),(e.mapDragStart.observed||e.dragStart.observed)&&this.mapInstance.on("dragstart",i=>this.zone.run(()=>{e.mapDragStart.emit(i),e.dragStart.emit(i)})),(e.mapDrag.observed||e.drag.observed)&&this.mapInstance.on("drag",i=>this.zone.run(()=>{e.mapDrag.emit(i),e.drag.emit(i)})),(e.mapDragEnd.observed||e.dragEnd.observed)&&this.mapInstance.on("dragend",i=>this.zone.run(()=>{e.mapDragEnd.emit(i),e.dragEnd.emit(i)})),e.zoomStart.observed&&this.mapInstance.on("zoomstart",i=>this.zone.run(()=>e.zoomStart.emit(i))),e.zoomEvt.observed&&this.mapInstance.on("zoom",i=>this.zone.run(()=>e.zoomEvt.emit(i))),e.zoomEnd.observed&&this.mapInstance.on("zoomend",i=>this.zone.run(()=>e.zoomEnd.emit(i))),e.rotateStart.observed&&this.mapInstance.on("rotatestart",i=>this.zone.run(()=>e.rotateStart.emit(i))),e.rotate.observed&&this.mapInstance.on("rotate",i=>this.zone.run(()=>e.rotate.emit(i))),e.rotateEnd.observed&&this.mapInstance.on("rotateend",i=>this.zone.run(()=>e.rotateEnd.emit(i))),e.pitchStart.observed&&this.mapInstance.on("pitchstart",i=>this.zone.run(()=>e.pitchStart.emit(i))),e.pitchEvt.observed&&this.mapInstance.on("pitch",i=>this.zone.run(()=>e.pitchEvt.emit(i))),e.pitchEnd.observed&&this.mapInstance.on("pitchend",i=>this.zone.run(()=>e.pitchEnd.emit(i))),e.boxZoomStart.observed&&this.mapInstance.on("boxzoomstart",i=>this.zone.run(()=>e.boxZoomStart.emit(i))),e.boxZoomEnd.observed&&this.mapInstance.on("boxzoomend",i=>this.zone.run(()=>e.boxZoomEnd.emit(i))),e.boxZoomCancel.observed&&this.mapInstance.on("boxzoomcancel",i=>this.zone.run(()=>e.boxZoomCancel.emit(i))),e.webGlContextLost.observed&&this.mapInstance.on("webglcontextlost",i=>this.zone.run(()=>e.webGlContextLost.emit(i))),e.webGlContextRestored.observed&&this.mapInstance.on("webglcontextrestored",i=>this.zone.run(()=>e.webGlContextRestored.emit(i))),e.render.observed&&this.mapInstance.on("render",i=>this.zone.run(()=>e.render.emit(i))),(e.mapError.observed||e.error.observed)&&this.mapInstance.on("error",i=>this.zone.run(()=>{e.mapError.emit(i),e.error.emit(i)})),e.data.observed&&this.mapInstance.on("data",i=>this.zone.run(()=>e.data.emit(i))),e.styleData.observed&&this.mapInstance.on("styledata",i=>this.zone.run(()=>e.styleData.emit(i))),e.sourceData.observed&&this.mapInstance.on("sourcedata",i=>this.zone.run(()=>e.sourceData.emit(i))),e.dataLoading.observed&&this.mapInstance.on("dataloading",i=>this.zone.run(()=>e.dataLoading.emit(i))),e.styleDataLoading.observed&&this.mapInstance.on("styledataloading",i=>this.zone.run(()=>e.styleDataLoading.emit(i))),e.sourceDataLoading.observed&&this.mapInstance.on("sourcedataloading",i=>this.zone.run(()=>e.sourceDataLoading.emit(i))),e.styleImageMissing.observed&&this.mapInstance.on("styleimagemissing",i=>this.zone.run(()=>e.styleImageMissing.emit(i))),e.idle.observed&&this.mapInstance.on("idle",i=>this.zone.run(()=>e.idle.emit(i)))}assign(e,i,r){if("string"==typeof i&&(i=i.split(".")),i.length>1){const a=i.shift();this.assign(e[a]="[object Object]"===Object.prototype.toString.call(e[a])?e[a]:{},i,r)}else e[i[0]]=r}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(o.R0b),o.LFG(S6,8))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();class vY{constructor(t){this.container=t}onAdd(){return this.container}onRemove(){return this.container.parentNode.removeChild(this.container)}getDefaultPosition(){return"top-right"}}let I6=(()=>{class n{constructor(e){this.mapService=e,this.controlAdded=!1}ngAfterContentInit(){this.content.nativeElement.childNodes.length&&(this.control=new vY(this.content.nativeElement),this.mapService.mapCreated$.subscribe(()=>{this.mapService.addControl(this.control,this.position),this.controlAdded=!0}))}ngOnDestroy(){this.controlAdded&&this.mapService.removeControl(this.control)}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(WM))},n.\u0275cmp=o.Xpm({type:n,selectors:[["mgl-control"]],viewQuery:function(e,i){if(1&e&&o.Gf(dY,7),2&e){let r;o.iGM(r=o.CRH())&&(i.content=r.first)}},inputs:{position:"position"},ngContentSelectors:pY,decls:3,vars:0,consts:[[1,"mapboxgl-ctrl"],["content",""]],template:function(e,i){1&e&&(o.F$t(),o.TgZ(0,"div",0,1),o.Hsn(2),o.qZA())},encapsulation:2,changeDetection:0}),n})(),bY=(()=>{class n{constructor(e,i){this.mapService=e,this.controlComponent=i}ngAfterContentInit(){this.mapService.mapCreated$.subscribe(()=>{if(this.controlComponent.control)throw new Error("Another control is already set for this control");const e={};void 0!==this.showCompass&&(e.showCompass=this.showCompass),void 0!==this.showZoom&&(e.showZoom=this.showZoom),this.controlComponent.control=new nC.NavigationControl(e),this.mapService.addControl(this.controlComponent.control,this.controlComponent.position)})}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(WM),o.Y36(I6,1))},n.\u0275dir=o.lG2({type:n,selectors:[["","mglNavigation",""]],inputs:{showCompass:"showCompass",showZoom:"showZoom"}}),n})();const wY=(n,t,e)=>{console.warn(`[ngx-mapbox-gl]: ${n}: ${t} is deprecated, please use ${e} instead.`)};let xY=(()=>{class n{constructor(e){this.mapService=e,this.movingMethod="flyTo",this.mapResize=new o.vpe,this.mapRemove=new o.vpe,this.mapMouseDown=new o.vpe,this.mapMouseUp=new o.vpe,this.mapMouseMove=new o.vpe,this.mapClick=new o.vpe,this.mapDblClick=new o.vpe,this.mapMouseOver=new o.vpe,this.mapMouseOut=new o.vpe,this.mapContextMenu=new o.vpe,this.mapTouchStart=new o.vpe,this.mapTouchEnd=new o.vpe,this.mapTouchMove=new o.vpe,this.mapTouchCancel=new o.vpe,this.mapWheel=new o.vpe,this.moveStart=new o.vpe,this.move=new o.vpe,this.moveEnd=new o.vpe,this.mapDragStart=new o.vpe,this.mapDrag=new o.vpe,this.mapDragEnd=new o.vpe,this.zoomStart=new o.vpe,this.zoomEvt=new o.vpe,this.zoomEnd=new o.vpe,this.rotateStart=new o.vpe,this.rotate=new o.vpe,this.rotateEnd=new o.vpe,this.pitchStart=new o.vpe,this.pitchEvt=new o.vpe,this.pitchEnd=new o.vpe,this.boxZoomStart=new o.vpe,this.boxZoomEnd=new o.vpe,this.boxZoomCancel=new o.vpe,this.webGlContextLost=new o.vpe,this.webGlContextRestored=new o.vpe,this.mapLoad=new o.vpe,this.idle=new o.vpe,this.render=new o.vpe,this.mapError=new o.vpe,this.data=new o.vpe,this.styleData=new o.vpe,this.sourceData=new o.vpe,this.dataLoading=new o.vpe,this.styleDataLoading=new o.vpe,this.sourceDataLoading=new o.vpe,this.styleImageMissing=new o.vpe,this.resize=new o.vpe,this.remove=new o.vpe,this.mouseDown=new o.vpe,this.mouseUp=new o.vpe,this.mouseMove=new o.vpe,this.click=new o.vpe,this.dblClick=new o.vpe,this.mouseOver=new o.vpe,this.mouseOut=new o.vpe,this.contextMenu=new o.vpe,this.touchStart=new o.vpe,this.touchEnd=new o.vpe,this.touchMove=new o.vpe,this.touchCancel=new o.vpe,this.wheel=new o.vpe,this.dragStart=new o.vpe,this.drag=new o.vpe,this.dragEnd=new o.vpe,this.load=new o.vpe,this.error=new o.vpe}get mapInstance(){return this.mapService.mapInstance}ngAfterViewInit(){this.warnDeprecatedOutputs(),this.mapService.setup({accessToken:this.accessToken,customMapboxApiUrl:this.customMapboxApiUrl,mapOptions:{collectResourceTiming:this.collectResourceTiming,container:this.mapContainer.nativeElement,crossSourceCollisions:this.crossSourceCollisions,fadeDuration:this.fadeDuration,minZoom:this.minZoom,maxZoom:this.maxZoom,minPitch:this.minPitch,maxPitch:this.maxPitch,style:this.style,hash:this.hash,interactive:this.interactive,bearingSnap:this.bearingSnap,pitchWithRotate:this.pitchWithRotate,clickTolerance:this.clickTolerance,attributionControl:this.attributionControl,logoPosition:this.logoPosition,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,refreshExpiredTiles:this.refreshExpiredTiles,maxBounds:this.maxBounds,scrollZoom:this.scrollZoom,boxZoom:this.boxZoom,dragRotate:this.dragRotate,dragPan:this.dragPan,keyboard:this.keyboard,doubleClickZoom:this.doubleClickZoom,touchPitch:this.touchPitch,touchZoomRotate:this.touchZoomRotate,trackResize:this.trackResize,center:this.center,zoom:this.zoom,bearing:this.bearing,pitch:this.pitch,renderWorldCopies:this.renderWorldCopies,maxTileCacheSize:this.maxTileCacheSize,localIdeographFontFamily:this.localIdeographFontFamily,transformRequest:this.transformRequest,bounds:this.bounds?this.bounds:this.fitBounds,fitBoundsOptions:this.fitBoundsOptions,antialias:this.antialias,locale:this.locale,projection:this.projection},mapEvents:this}),this.cursorStyle&&this.mapService.changeCanvasCursor(this.cursorStyle)}ngOnDestroy(){this.mapService.destroyMap()}ngOnChanges(e){var i=this;return(0,ve.Z)(function*(){yield function hY(n,t){const e="object"==typeof t;return new Promise((i,r)=>{let g,a=!1;n.subscribe({next:E=>{g=E,a=!0},error:r,complete:()=>{a?i(g):e?i(t.defaultValue):r(new mg)}})})}(i.mapService.mapCreated$),e.cursorStyle&&!e.cursorStyle.isFirstChange()&&i.mapService.changeCanvasCursor(e.cursorStyle.currentValue),e.projection&&!e.projection.isFirstChange()&&i.mapService.updateProjection(e.projection.currentValue),e.minZoom&&!e.minZoom.isFirstChange()&&i.mapService.updateMinZoom(e.minZoom.currentValue),e.maxZoom&&!e.maxZoom.isFirstChange()&&i.mapService.updateMaxZoom(e.maxZoom.currentValue),e.minPitch&&!e.minPitch.isFirstChange()&&i.mapService.updateMinPitch(e.minPitch.currentValue),e.maxPitch&&!e.maxPitch.isFirstChange()&&i.mapService.updateMaxPitch(e.maxPitch.currentValue),e.renderWorldCopies&&!e.renderWorldCopies.isFirstChange()&&i.mapService.updateRenderWorldCopies(e.renderWorldCopies.currentValue),e.scrollZoom&&!e.scrollZoom.isFirstChange()&&i.mapService.updateScrollZoom(e.scrollZoom.currentValue),e.dragRotate&&!e.dragRotate.isFirstChange()&&i.mapService.updateDragRotate(e.dragRotate.currentValue),e.touchPitch&&!e.touchPitch.isFirstChange()&&i.mapService.updateTouchPitch(e.touchPitch.currentValue),e.touchZoomRotate&&!e.touchZoomRotate.isFirstChange()&&i.mapService.updateTouchZoomRotate(e.touchZoomRotate.currentValue),e.doubleClickZoom&&!e.doubleClickZoom.isFirstChange()&&i.mapService.updateDoubleClickZoom(e.doubleClickZoom.currentValue),e.keyboard&&!e.keyboard.isFirstChange()&&i.mapService.updateKeyboard(e.keyboard.currentValue),e.dragPan&&!e.dragPan.isFirstChange()&&i.mapService.updateDragPan(e.dragPan.currentValue),e.boxZoom&&!e.boxZoom.isFirstChange()&&i.mapService.updateBoxZoom(e.boxZoom.currentValue),e.style&&!e.style.isFirstChange()&&i.mapService.updateStyle(e.style.currentValue),e.maxBounds&&!e.maxBounds.isFirstChange()&&i.mapService.updateMaxBounds(e.maxBounds.currentValue),e.fitBounds&&e.fitBounds.currentValue&&!e.fitBounds.isFirstChange()&&i.mapService.fitBounds(e.fitBounds.currentValue,i.fitBoundsOptions),e.fitScreenCoordinates&&e.fitScreenCoordinates.currentValue&&((i.center||i.zoom||i.pitch||i.fitBounds)&&e.fitScreenCoordinates.isFirstChange()&&console.warn("[ngx-mapbox-gl] center / zoom / pitch / fitBounds inputs are being overridden by fitScreenCoordinates input"),i.mapService.fitScreenCoordinates(e.fitScreenCoordinates.currentValue,i.bearing?i.bearing[0]:0,i.movingOptions)),!i.centerWithPanTo||!e.center||e.center.isFirstChange()||e.zoom||e.bearing||e.pitch?(e.center&&!e.center.isFirstChange()||e.zoom&&!e.zoom.isFirstChange()||e.bearing&&!e.bearing.isFirstChange()&&!e.fitScreenCoordinates||e.pitch&&!e.pitch.isFirstChange())&&i.mapService.move(i.movingMethod,i.movingOptions,e.zoom&&i.zoom?i.zoom[0]:void 0,e.center?i.center:void 0,e.bearing&&i.bearing?i.bearing[0]:void 0,e.pitch&&i.pitch?i.pitch[0]:void 0):i.mapService.panTo(i.center,i.panToOptions)})()}warnDeprecatedOutputs(){const e=wY.bind(void 0,n.name);this.resize.observed&&e("resize","mapResize"),this.remove.observed&&e("remove","mapRemove"),this.mouseDown.observed&&e("mouseDown","mapMouseDown"),this.mouseUp.observed&&e("mouseUp","mapMouseUp"),this.mouseMove.observed&&e("mouseMove","mapMouseMove"),this.click.observed&&e("click","mapClick"),this.dblClick.observed&&e("dblClick","mapDblClick"),this.mouseOver.observed&&e("mouseOver","mapMouseOver"),this.mouseOut.observed&&e("mouseOut","mapMouseOut"),this.contextMenu.observed&&e("contextMenu","mapContextMenu"),this.touchStart.observed&&e("touchStart","mapTouchStart"),this.touchEnd.observed&&e("touchEnd","mapTouchEnd"),this.touchMove.observed&&e("touchMove","mapTouchMove"),this.touchCancel.observed&&e("touchCancel","mapTouchCancel"),this.wheel.observed&&e("wheel","mapWheel"),this.dragStart.observed&&e("dragStart","mapDragStart"),this.drag.observed&&e("drag","mapDrag"),this.dragEnd.observed&&e("dragEnd","mapDragEnd"),this.load.observed&&e("load","mapLoad"),this.error.observed&&e("error","mapError")}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(WM))},n.\u0275cmp=o.Xpm({type:n,selectors:[["mgl-map"]],viewQuery:function(e,i){if(1&e&&o.Gf(fY,7),2&e){let r;o.iGM(r=o.CRH())&&(i.mapContainer=r.first)}},inputs:{accessToken:"accessToken",collectResourceTiming:"collectResourceTiming",crossSourceCollisions:"crossSourceCollisions",customMapboxApiUrl:"customMapboxApiUrl",fadeDuration:"fadeDuration",hash:"hash",refreshExpiredTiles:"refreshExpiredTiles",failIfMajorPerformanceCaveat:"failIfMajorPerformanceCaveat",bearingSnap:"bearingSnap",interactive:"interactive",pitchWithRotate:"pitchWithRotate",clickTolerance:"clickTolerance",attributionControl:"attributionControl",logoPosition:"logoPosition",maxTileCacheSize:"maxTileCacheSize",localIdeographFontFamily:"localIdeographFontFamily",preserveDrawingBuffer:"preserveDrawingBuffer",trackResize:"trackResize",transformRequest:"transformRequest",bounds:"bounds",antialias:"antialias",locale:"locale",minZoom:"minZoom",maxZoom:"maxZoom",minPitch:"minPitch",maxPitch:"maxPitch",scrollZoom:"scrollZoom",dragRotate:"dragRotate",touchPitch:"touchPitch",touchZoomRotate:"touchZoomRotate",doubleClickZoom:"doubleClickZoom",keyboard:"keyboard",dragPan:"dragPan",boxZoom:"boxZoom",style:"style",center:"center",maxBounds:"maxBounds",zoom:"zoom",bearing:"bearing",pitch:"pitch",fitBoundsOptions:"fitBoundsOptions",renderWorldCopies:"renderWorldCopies",projection:"projection",movingMethod:"movingMethod",movingOptions:"movingOptions",fitBounds:"fitBounds",fitScreenCoordinates:"fitScreenCoordinates",centerWithPanTo:"centerWithPanTo",panToOptions:"panToOptions",cursorStyle:"cursorStyle"},outputs:{mapResize:"mapResize",mapRemove:"mapRemove",mapMouseDown:"mapMouseDown",mapMouseUp:"mapMouseUp",mapMouseMove:"mapMouseMove",mapClick:"mapClick",mapDblClick:"mapDblClick",mapMouseOver:"mapMouseOver",mapMouseOut:"mapMouseOut",mapContextMenu:"mapContextMenu",mapTouchStart:"mapTouchStart",mapTouchEnd:"mapTouchEnd",mapTouchMove:"mapTouchMove",mapTouchCancel:"mapTouchCancel",mapWheel:"mapWheel",moveStart:"moveStart",move:"move",moveEnd:"moveEnd",mapDragStart:"mapDragStart",mapDrag:"mapDrag",mapDragEnd:"mapDragEnd",zoomStart:"zoomStart",zoomEvt:"zoomEvt",zoomEnd:"zoomEnd",rotateStart:"rotateStart",rotate:"rotate",rotateEnd:"rotateEnd",pitchStart:"pitchStart",pitchEvt:"pitchEvt",pitchEnd:"pitchEnd",boxZoomStart:"boxZoomStart",boxZoomEnd:"boxZoomEnd",boxZoomCancel:"boxZoomCancel",webGlContextLost:"webGlContextLost",webGlContextRestored:"webGlContextRestored",mapLoad:"mapLoad",idle:"idle",render:"render",mapError:"mapError",data:"data",styleData:"styleData",sourceData:"sourceData",dataLoading:"dataLoading",styleDataLoading:"styleDataLoading",sourceDataLoading:"sourceDataLoading",styleImageMissing:"styleImageMissing",resize:"resize",remove:"remove",mouseDown:"mouseDown",mouseUp:"mouseUp",mouseMove:"mouseMove",click:"click",dblClick:"dblClick",mouseOver:"mouseOver",mouseOut:"mouseOut",contextMenu:"contextMenu",touchStart:"touchStart",touchEnd:"touchEnd",touchMove:"touchMove",touchCancel:"touchCancel",wheel:"wheel",dragStart:"dragStart",drag:"drag",dragEnd:"dragEnd",load:"load",error:"error"},features:[o._Bn([WM]),o.TTD],decls:2,vars:0,consts:[["container",""]],template:function(e,i){1&e&&o._UZ(0,"div",null,0)},styles:["[_nghost-%COMP%]{display:block}div[_ngcontent-%COMP%]{height:100%;width:100%}"],changeDetection:0}),n})(),CY=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:S6,useValue:e.accessToken}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr]}),n})();var EY=Ee(9672);function D6(...n){const t=(0,Oo.yG)(n),e=(0,Oo.jO)(n),{args:i,keys:r}=mn(n);if(0===i.length)return(0,Qr.D)([],t);const a=new w.y(function TY(n,t,e=am.y){return i=>{A6(t,()=>{const{length:r}=n,a=new Array(r);let g=r,E=r;for(let O=0;O<r;O++)A6(t,()=>{const j=(0,Qr.D)(n[O],t);let Y=!1;j.subscribe((0,P.x)(i,se=>{a[O]=se,Y||(Y=!0,E--),E||i.next(e(a.slice()))},()=>{--g||i.complete()}))},i)},i)}}(i,t,r?g=>jc(r,g):am.y));return e?a.pipe(Ia(e)):a}function A6(n,t,e){n?(0,EY.f)(e,n,t):t()}var RS=Ee(8189);function jL(...n){return function SY(){return(0,RS.J)(1)}()((0,Qr.D)(n,(0,Oo.yG)(n)))}function M6(n){return new w.y(t=>{(0,oi.Xf)(n()).subscribe(t)})}var IY=Ee(9635);function PS(n,t){const e=(0,_.m)(n)?n:()=>n,i=r=>r.error(e());return new w.y(t?r=>t.schedule(i,0,r):i)}function GL(){return(0,k.e)((n,t)=>{let e=null;n._refCount++;const i=(0,P.x)(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const r=n._connection,a=e;e=null,r&&(!a||r===a)&&r.unsubscribe(),t.unsubscribe()});n.subscribe(i),i.closed||(e=n.connect())})}class k6 extends w.y{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,(0,k.A)(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new Gv.w0;const e=this.getSubject();t.add(this.source.subscribe((0,P.x)(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),t.closed&&(this._connection=null,t=Gv.w0.EMPTY)}return t}refCount(){return GL()(this)}}function ZM(...n){const t=(0,Oo.yG)(n);return(0,k.e)((e,i)=>{(t?jL(n,e,t):jL(n,e)).subscribe(i)})}var dh=Ee(8505);function $v(n){return(0,k.e)((t,e)=>{let a,i=null,r=!1;i=t.subscribe((0,P.x)(e,void 0,void 0,g=>{a=(0,oi.Xf)(n(g,$v(n)(t))),i?(i.unsubscribe(),i=null,a.subscribe(e)):r=!0})),r&&(i.unsubscribe(),i=null,a.subscribe(e))})}function $L(n){return n<=0?()=>Su.E:(0,k.e)((t,e)=>{let i=[];t.subscribe((0,P.x)(e,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)e.next(r);e.complete()},void 0,()=>{i=null}))})}function R6(n,t){const e=arguments.length>=2;return i=>i.pipe(n?I((r,a)=>n(r,a,i)):am.y,$L(1),e?gg(t):ev(()=>new mg))}function WL(n){return(0,k.e)((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}const Tr="primary",OS=Symbol("RouteTitle");class MY{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function iC(n){return new MY(n)}function kY(n,t,e){const i=e.path.split("/");if(i.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||i.length<n.length))return null;const r={};for(let a=0;a<i.length;a++){const g=i[a],E=n[a];if(g.startsWith(":"))r[g.substring(1)]=E;else if(g!==E.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function Og(n,t){const e=n?Object.keys(n):void 0,i=t?Object.keys(t):void 0;if(!e||!i||e.length!=i.length)return!1;let r;for(let a=0;a<e.length;a++)if(r=e[a],!P6(n[r],t[r]))return!1;return!0}function P6(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),i=[...t].sort();return e.every((r,a)=>i[a]===r)}return n===t}function O6(n){return Array.prototype.concat.apply([],n)}function L6(n){return n.length>0?n[n.length-1]:null}function Ru(n,t){for(const e in n)n.hasOwnProperty(e)&&t(n[e],e)}function Wv(n){return(0,o.CqO)(n)?n:(0,o.QGY)(n)?(0,Qr.D)(Promise.resolve(n)):qn(n)}const qM=!1,PY={exact:function z6(n,t,e){if(!rw(n.segments,t.segments)||!KM(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const i in t.children)if(!n.children[i]||!z6(n.children[i],t.children[i],e))return!1;return!0},subset:B6},F6={exact:function OY(n,t){return Og(n,t)},subset:function LY(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>P6(n[e],t[e]))},ignored:()=>!0};function N6(n,t,e){return PY[e.paths](n.root,t.root,e.matrixParams)&&F6[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function B6(n,t,e){return V6(n,t,t.segments,e)}function V6(n,t,e,i){if(n.segments.length>e.length){const r=n.segments.slice(0,e.length);return!(!rw(r,e)||t.hasChildren()||!KM(r,e,i))}if(n.segments.length===e.length){if(!rw(n.segments,e)||!KM(n.segments,e,i))return!1;for(const r in t.children)if(!n.children[r]||!B6(n.children[r],t.children[r],i))return!1;return!0}{const r=e.slice(0,n.segments.length),a=e.slice(n.segments.length);return!!(rw(n.segments,r)&&KM(n.segments,r,i)&&n.children[Tr])&&V6(n.children[Tr],t,a,i)}}function KM(n,t,e){return t.every((i,r)=>F6[e](n[r].parameters,i.parameters))}class iw{constructor(t=new Yr([],{}),e={},i=null){this.root=t,this.queryParams=e,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=iC(this.queryParams)),this._queryParamMap}toString(){return zY.serialize(this)}}class Yr{constructor(t,e){this.segments=t,this.children=e,this.parent=null,Ru(e,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return YM(this)}}class LS{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=iC(this.parameters)),this._parameterMap}toString(){return j6(this)}}function rw(n,t){return n.length===t.length&&n.every((e,i)=>e.path===t[i].path)}let FS=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:function(){return new ZL},providedIn:"root"}),n})();class ZL{parse(t){const e=new ZY(t);return new iw(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${NS(t.root,!0)}`,i=function UY(n){const t=Object.keys(n).map(e=>{const i=n[e];return Array.isArray(i)?i.map(r=>`${JM(e)}=${JM(r)}`).join("&"):`${JM(e)}=${JM(i)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams),r="string"==typeof t.fragment?`#${function BY(n){return encodeURI(n)}(t.fragment)}`:"";return`${e}${i}${r}`}}const zY=new ZL;function YM(n){return n.segments.map(t=>j6(t)).join("/")}function NS(n,t){if(!n.hasChildren())return YM(n);if(t){const e=n.children[Tr]?NS(n.children[Tr],!1):"",i=[];return Ru(n.children,(r,a)=>{a!==Tr&&i.push(`${a}:${NS(r,!1)}`)}),i.length>0?`${e}(${i.join("//")})`:e}{const e=function NY(n,t){let e=[];return Ru(n.children,(i,r)=>{r===Tr&&(e=e.concat(t(i,r)))}),Ru(n.children,(i,r)=>{r!==Tr&&(e=e.concat(t(i,r)))}),e}(n,(i,r)=>r===Tr?[NS(n.children[Tr],!1)]:[`${r}:${NS(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Tr]?`${YM(n)}/${e[0]}`:`${YM(n)}/(${e.join("//")})`}}function U6(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function JM(n){return U6(n).replace(/%3B/gi,";")}function qL(n){return U6(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function QM(n){return decodeURIComponent(n)}function H6(n){return QM(n.replace(/\+/g,"%20"))}function j6(n){return`${qL(n.path)}${function VY(n){return Object.keys(n).map(t=>`;${qL(t)}=${qL(n[t])}`).join("")}(n.parameters)}`}const HY=/^[^\/()?;=#]+/;function XM(n){const t=n.match(HY);return t?t[0]:""}const jY=/^[^=?&#]+/,$Y=/^[^&#]+/;class ZY{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Yr([],{}):new Yr([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(i[Tr]=new Yr(t,e)),i}parseSegment(){const t=XM(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new o.vHH(4009,qM);return this.capture(t),new LS(QM(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=XM(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const r=XM(this.remaining);r&&(i=r,this.capture(i))}t[QM(e)]=QM(i)}parseQueryParam(t){const e=function GY(n){const t=n.match(jY);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const g=function WY(n){const t=n.match($Y);return t?t[0]:""}(this.remaining);g&&(i=g,this.capture(i))}const r=H6(e),a=H6(i);if(t.hasOwnProperty(r)){let g=t[r];Array.isArray(g)||(g=[g],t[r]=g),g.push(a)}else t[r]=a}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=XM(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new o.vHH(4010,qM);let a;i.indexOf(":")>-1?(a=i.slice(0,i.indexOf(":")),this.capture(a),this.capture(":")):t&&(a=Tr);const g=this.parseChildren();e[a]=1===Object.keys(g).length?g[Tr]:new Yr([],g),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new o.vHH(4011,qM)}}function KL(n){return n.segments.length>0?new Yr([],{[Tr]:n}):n}function ek(n){const t={};for(const i of Object.keys(n.children)){const a=ek(n.children[i]);(a.segments.length>0||a.hasChildren())&&(t[i]=a)}return function qY(n){if(1===n.numberOfChildren&&n.children[Tr]){const t=n.children[Tr];return new Yr(n.segments.concat(t.segments),t.children)}return n}(new Yr(n.segments,t))}function ow(n){return n instanceof iw}function JY(n,t,e,i,r){if(0===e.length)return rC(t.root,t.root,t.root,i,r);const a=function W6(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new $6(!0,0,n);let t=0,e=!1;const i=n.reduce((r,a,g)=>{if("object"==typeof a&&null!=a){if(a.outlets){const E={};return Ru(a.outlets,(O,j)=>{E[j]="string"==typeof O?O.split("/"):O}),[...r,{outlets:E}]}if(a.segmentPath)return[...r,a.segmentPath]}return"string"!=typeof a?[...r,a]:0===g?(a.split("/").forEach((E,O)=>{0==O&&"."===E||(0==O&&""===E?e=!0:".."===E?t++:""!=E&&r.push(E))}),r):[...r,a]},[]);return new $6(e,t,i)}(e);return a.toRoot()?rC(t.root,t.root,new Yr([],{}),i,r):function g(O){const j=function XY(n,t,e,i){if(n.isAbsolute)return new oC(t.root,!0,0);if(-1===i)return new oC(e,e===t.root,0);return function Z6(n,t,e){let i=n,r=t,a=e;for(;a>r;){if(a-=r,i=i.parent,!i)throw new o.vHH(4005,!1);r=i.segments.length}return new oC(i,!1,r-a)}(e,i+(zS(n.commands[0])?0:1),n.numberOfDoubleDots)}(a,t,n.snapshot?._urlSegment,O),Y=j.processChildren?sC(j.segmentGroup,j.index,a.commands):JL(j.segmentGroup,j.index,a.commands);return rC(t.root,j.segmentGroup,Y,i,r)}(n.snapshot?._lastPathIndex)}function zS(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function BS(n){return"object"==typeof n&&null!=n&&n.outlets}function rC(n,t,e,i,r){let g,a={};i&&Ru(i,(O,j)=>{a[j]=Array.isArray(O)?O.map(Y=>`${Y}`):`${O}`}),g=n===t?e:G6(n,t,e);const E=KL(ek(g));return new iw(E,a,r)}function G6(n,t,e){const i={};return Ru(n.children,(r,a)=>{i[a]=r===t?e:G6(r,t,e)}),new Yr(n.segments,i)}class $6{constructor(t,e,i){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=i,t&&i.length>0&&zS(i[0]))throw new o.vHH(4003,!1);const r=i.find(BS);if(r&&r!==L6(i))throw new o.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class oC{constructor(t,e,i){this.segmentGroup=t,this.processChildren=e,this.index=i}}function JL(n,t,e){if(n||(n=new Yr([],{})),0===n.segments.length&&n.hasChildren())return sC(n,t,e);const i=function tJ(n,t,e){let i=0,r=t;const a={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=e.length)return a;const g=n.segments[r],E=e[i];if(BS(E))break;const O=`${E}`,j=i<e.length-1?e[i+1]:null;if(r>0&&void 0===O)break;if(O&&j&&"object"==typeof j&&void 0===j.outlets){if(!K6(O,j,g))return a;i+=2}else{if(!K6(O,{},g))return a;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,t,e),r=e.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const a=new Yr(n.segments.slice(0,i.pathIndex),{});return a.children[Tr]=new Yr(n.segments.slice(i.pathIndex),n.children),sC(a,0,r)}return i.match&&0===r.length?new Yr(n.segments,{}):i.match&&!n.hasChildren()?QL(n,t,e):i.match?sC(n,0,r):QL(n,t,e)}function sC(n,t,e){if(0===e.length)return new Yr(n.segments,{});{const i=function eJ(n){return BS(n[0])?n[0].outlets:{[Tr]:n}}(e),r={};return!i[Tr]&&n.children[Tr]&&1===n.numberOfChildren&&0===n.children[Tr].segments.length?sC(n.children[Tr],t,e):(Ru(i,(a,g)=>{"string"==typeof a&&(a=[a]),null!==a&&(r[g]=JL(n.children[g],t,a))}),Ru(n.children,(a,g)=>{void 0===i[g]&&(r[g]=a)}),new Yr(n.segments,r))}}function QL(n,t,e){const i=n.segments.slice(0,t);let r=0;for(;r<e.length;){const a=e[r];if(BS(a)){const O=nJ(a.outlets);return new Yr(i,O)}if(0===r&&zS(e[0])){i.push(new LS(n.segments[t].path,q6(e[0]))),r++;continue}const g=BS(a)?a.outlets[Tr]:`${a}`,E=r<e.length-1?e[r+1]:null;g&&E&&zS(E)?(i.push(new LS(g,q6(E))),r+=2):(i.push(new LS(g,{})),r++)}return new Yr(i,{})}function nJ(n){const t={};return Ru(n,(e,i)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[i]=QL(new Yr([],{}),0,e))}),t}function q6(n){const t={};return Ru(n,(e,i)=>t[i]=`${e}`),t}function K6(n,t,e){return n==e.path&&Og(t,e.parameters)}const VS="imperative";class Lg{constructor(t,e){this.id=t,this.url=e}}class XL extends Lg{constructor(t,e,i="imperative",r=null){super(t,e),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class sw extends Lg{constructor(t,e,i){super(t,e),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class tk extends Lg{constructor(t,e,i,r){super(t,e),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Y6 extends Lg{constructor(t,e,i,r){super(t,e),this.reason=i,this.code=r,this.type=16}}class J6 extends Lg{constructor(t,e,i,r){super(t,e),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class iJ extends Lg{constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class rJ extends Lg{constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class oJ extends Lg{constructor(t,e,i,r,a){super(t,e),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=a,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class sJ extends Lg{constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class aJ extends Lg{constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class lJ{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class cJ{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class uJ{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hJ{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dJ{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class pJ{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Q6{constructor(t,e,i){this.routerEvent=t,this.position=e,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let mJ=(()=>{class n{createUrlTree(e,i,r,a,g,E){return JY(e||i.root,r,a,g,E)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})(),gJ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:function(t){return mJ.\u0275fac(t)},providedIn:"root"}),n})();class X6{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=eF(t,this._root);return e?e.children.map(i=>i.value):[]}firstChild(t){const e=eF(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=tF(t,this._root);return e.length<2?[]:e[e.length-2].children.map(r=>r.value).filter(r=>r!==t)}pathFromRoot(t){return tF(t,this._root).map(e=>e.value)}}function eF(n,t){if(n===t.value)return t;for(const e of t.children){const i=eF(n,e);if(i)return i}return null}function tF(n,t){if(n===t.value)return[t];for(const e of t.children){const i=tF(n,e);if(i.length)return i.unshift(t),i}return[]}class X_{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function aC(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class e4 extends X6{constructor(t,e){super(t),this.snapshot=e,nF(this,t)}toString(){return this.snapshot.toString()}}function t4(n,t){const e=function _J(n,t){const g=new nk([],{},{},"",{},Tr,t,null,n.root,-1,{});return new i4("",new X_(g,[]))}(n,t),i=new $h([new LS("",{})]),r=new $h({}),a=new $h({}),g=new $h({}),E=new $h(""),O=new lC(i,r,g,E,a,Tr,t,e.root);return O.snapshot=e.root,new e4(new X_(O,[]),e)}class lC{constructor(t,e,i,r,a,g,E,O){this.url=t,this.params=e,this.queryParams=i,this.fragment=r,this.data=a,this.outlet=g,this.component=E,this.title=this.data?.pipe((0,M.U)(j=>j[OS]))??qn(void 0),this._futureSnapshot=O}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,M.U)(t=>iC(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,M.U)(t=>iC(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function n4(n,t="emptyOnly"){const e=n.pathFromRoot;let i=0;if("always"!==t)for(i=e.length-1;i>=1;){const r=e[i],a=e[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(a.component)break;i--}}return function yJ(n){return n.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(i))}class nk{get title(){return this.data?.[OS]}constructor(t,e,i,r,a,g,E,O,j,Y,se){this.url=t,this.params=e,this.queryParams=i,this.fragment=r,this.data=a,this.outlet=g,this.component=E,this.routeConfig=O,this._urlSegment=j,this._lastPathIndex=Y,this._resolve=se}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=iC(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=iC(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class i4 extends X6{constructor(t,e){super(e),this.url=t,nF(this,e)}toString(){return r4(this._root)}}function nF(n,t){t.value._routerState=n,t.children.forEach(e=>nF(n,e))}function r4(n){const t=n.children.length>0?` { ${n.children.map(r4).join(", ")} } `:"";return`${n.value}${t}`}function iF(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,Og(t.queryParams,e.queryParams)||n.queryParams.next(e.queryParams),t.fragment!==e.fragment&&n.fragment.next(e.fragment),Og(t.params,e.params)||n.params.next(e.params),function RY(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!Og(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.url.next(e.url),Og(t.data,e.data)||n.data.next(e.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function rF(n,t){const e=Og(n.params,t.params)&&function FY(n,t){return rw(n,t)&&n.every((e,i)=>Og(e.parameters,t[i].parameters))}(n.url,t.url);return e&&!(!n.parent!=!t.parent)&&(!n.parent||rF(n.parent,t.parent))}function US(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const i=e.value;i._futureSnapshot=t.value;const r=function bJ(n,t,e){return t.children.map(i=>{for(const r of e.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return US(n,i,r);return US(n,i)})}(n,t,e);return new X_(i,r)}{if(n.shouldAttach(t.value)){const a=n.retrieve(t.value);if(null!==a){const g=a.route;return g.value._futureSnapshot=t.value,g.children=t.children.map(E=>US(n,E)),g}}const i=function wJ(n){return new lC(new $h(n.url),new $h(n.params),new $h(n.queryParams),new $h(n.fragment),new $h(n.data),n.outlet,n.component,n)}(t.value),r=t.children.map(a=>US(n,a));return new X_(i,r)}}const oF="ngNavigationCancelingError";function o4(n,t){const{redirectTo:e,navigationBehaviorOptions:i}=ow(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,r=s4(!1,0,t);return r.url=e,r.navigationBehaviorOptions=i,r}function s4(n,t,e){const i=new Error("NavigationCancelingError: "+(n||""));return i[oF]=!0,i.cancellationCode=t,e&&(i.url=e),i}function a4(n){return l4(n)&&ow(n.url)}function l4(n){return n&&n[oF]}class xJ{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new HS,this.attachRef=null}}let HS=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(e,i){const r=this.getOrCreateContext(e);r.outlet=i,this.contexts.set(e,r)}onChildOutletDestroyed(e){const i=this.getContext(e);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let i=this.getContext(e);return i||(i=new xJ,this.contexts.set(e,i)),i}getContext(e){return this.contexts.get(e)||null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const ik=!1;let sF=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Tr,this.activateEvents=new o.vpe,this.deactivateEvents=new o.vpe,this.attachEvents=new o.vpe,this.detachEvents=new o.vpe,this.parentContexts=(0,o.f3M)(HS),this.location=(0,o.f3M)(o.s_b),this.changeDetector=(0,o.f3M)(o.sBO),this.environmentInjector=(0,o.f3M)(o.lqb)}ngOnChanges(e){if(e.name){const{firstChange:i,previousValue:r}=e.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new o.vHH(4012,ik);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new o.vHH(4012,ik);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new o.vHH(4012,ik);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,i){this.activated=e,this._activatedRoute=i,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,i){if(this.isActivated)throw new o.vHH(4013,ik);this._activatedRoute=e;const r=this.location,g=e.snapshot.component,E=this.parentContexts.getOrCreateContext(this.name).children,O=new CJ(e,E,r.injector);if(i&&function EJ(n){return!!n.resolveComponentFactory}(i)){const j=i.resolveComponentFactory(g);this.activated=r.createComponent(j,r.length,O)}else this.activated=r.createComponent(g,{index:r.length,injector:O,environmentInjector:i??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=o.lG2({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[o.TTD]}),n})();class CJ{constructor(t,e,i){this.route=t,this.childContexts=e,this.parent=i}get(t,e){return t===lC?this.route:t===HS?this.childContexts:this.parent.get(t,e)}}let aF=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=o.Xpm({type:n,selectors:[["ng-component"]],standalone:!0,features:[o.jDz],decls:1,vars:0,template:function(e,i){1&e&&o._UZ(0,"router-outlet")},dependencies:[sF],encapsulation:2}),n})();function c4(n,t){return n.providers&&!n._injector&&(n._injector=(0,o.MMx)(n.providers,t,`Route: ${n.path}`)),n._injector??t}function cF(n){const t=n.children&&n.children.map(cF),e=t?{...n,children:t}:{...n};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==Tr&&(e.component=aF),e}function gf(n){return n.outlet||Tr}function u4(n,t){const e=n.filter(i=>gf(i)===t);return e.push(...n.filter(i=>gf(i)!==t)),e}function jS(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class AJ{constructor(t,e,i,r){this.routeReuseStrategy=t,this.futureState=e,this.currState=i,this.forwardEvent=r}activate(t){const e=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,i,t),iF(this.futureState.root),this.activateChildRoutes(e,i,t)}deactivateChildRoutes(t,e,i){const r=aC(e);t.children.forEach(a=>{const g=a.value.outlet;this.deactivateRoutes(a,r[g],i),delete r[g]}),Ru(r,(a,g)=>{this.deactivateRouteAndItsChildren(a,i)})}deactivateRoutes(t,e,i){const r=t.value,a=e?e.value:null;if(r===a)if(r.component){const g=i.getContext(r.outlet);g&&this.deactivateChildRoutes(t,e,g.children)}else this.deactivateChildRoutes(t,e,i);else a&&this.deactivateRouteAndItsChildren(e,i)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const i=e.getContext(t.value.outlet),r=i&&t.value.component?i.children:e,a=aC(t);for(const g of Object.keys(a))this.deactivateRouteAndItsChildren(a[g],r);if(i&&i.outlet){const g=i.outlet.detach(),E=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:g,route:t,contexts:E})}}deactivateRouteAndOutlet(t,e){const i=e.getContext(t.value.outlet),r=i&&t.value.component?i.children:e,a=aC(t);for(const g of Object.keys(a))this.deactivateRouteAndItsChildren(a[g],r);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(t,e,i){const r=aC(e);t.children.forEach(a=>{this.activateRoutes(a,r[a.value.outlet],i),this.forwardEvent(new pJ(a.value.snapshot))}),t.children.length&&this.forwardEvent(new hJ(t.value.snapshot))}activateRoutes(t,e,i){const r=t.value,a=e?e.value:null;if(iF(r),r===a)if(r.component){const g=i.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,g.children)}else this.activateChildRoutes(t,e,i);else if(r.component){const g=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const E=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),g.children.onOutletReAttached(E.contexts),g.attachRef=E.componentRef,g.route=E.route.value,g.outlet&&g.outlet.attach(E.componentRef,E.route.value),iF(E.route.value),this.activateChildRoutes(t,null,g.children)}else{const E=jS(r.snapshot),O=E?.get(o._Vd)??null;g.attachRef=null,g.route=r,g.resolver=O,g.injector=E,g.outlet&&g.outlet.activateWith(r,g.injector),this.activateChildRoutes(t,null,g.children)}}else this.activateChildRoutes(t,null,i)}}class h4{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class rk{constructor(t,e){this.component=t,this.route=e}}function MJ(n,t,e){const i=n._root;return GS(i,t?t._root:null,e,[i.value])}function cC(n,t){const e=Symbol(),i=t.get(n,e);return i===e?"function"!=typeof n||(0,o.Z0I)(n)?t.get(n):n:i}function GS(n,t,e,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const a=aC(t);return n.children.forEach(g=>{(function RJ(n,t,e,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const a=n.value,g=t?t.value:null,E=e?e.getContext(n.value.outlet):null;if(g&&a.routeConfig===g.routeConfig){const O=function PJ(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!rw(n.url,t.url);case"pathParamsOrQueryParamsChange":return!rw(n.url,t.url)||!Og(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!rF(n,t)||!Og(n.queryParams,t.queryParams);default:return!rF(n,t)}}(g,a,a.routeConfig.runGuardsAndResolvers);O?r.canActivateChecks.push(new h4(i)):(a.data=g.data,a._resolvedData=g._resolvedData),GS(n,t,a.component?E?E.children:null:e,i,r),O&&E&&E.outlet&&E.outlet.isActivated&&r.canDeactivateChecks.push(new rk(E.outlet.component,g))}else g&&$S(t,E,r),r.canActivateChecks.push(new h4(i)),GS(n,null,a.component?E?E.children:null:e,i,r)})(g,a[g.value.outlet],e,i.concat([g.value]),r),delete a[g.value.outlet]}),Ru(a,(g,E)=>$S(g,e.getContext(E),r)),r}function $S(n,t,e){const i=aC(n),r=n.value;Ru(i,(a,g)=>{$S(a,r.component?t?t.children.getContext(g):null:t,e)}),e.canDeactivateChecks.push(new rk(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}function WS(n){return"function"==typeof n}function uF(n){return n instanceof mg||"EmptyError"===n?.name}const ok=Symbol("INITIAL_VALUE");function uC(){return Yo(n=>D6(n.map(t=>t.pipe(cf(1),ZM(ok)))).pipe((0,M.U)(t=>{for(const e of t)if(!0!==e){if(e===ok)return ok;if(!1===e||e instanceof iw)return e}return!0}),I(t=>t!==ok),cf(1)))}function d4(n){return(0,IY.z)((0,dh.b)(t=>{if(ow(t))throw o4(0,t)}),(0,M.U)(t=>!0===t))}const hF={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function p4(n,t,e,i,r){const a=dF(n,t,e);return a.matched?function YJ(n,t,e,i){const r=t.canMatch;return r&&0!==r.length?qn(r.map(g=>{const E=cC(g,n);return Wv(function BJ(n){return n&&WS(n.canMatch)}(E)?E.canMatch(t,e):n.runInContext(()=>E(t,e)))})).pipe(uC(),d4()):qn(!0)}(i=c4(t,i),t,e).pipe((0,M.U)(g=>!0===g?a:{...hF})):qn(a)}function dF(n,t,e){if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?{...hF}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const r=(t.matcher||kY)(e,n,t);if(!r)return{...hF};const a={};Ru(r.posParams,(E,O)=>{a[O]=E.path});const g=r.consumed.length>0?{...a,...r.consumed[r.consumed.length-1].parameters}:a;return{matched:!0,consumedSegments:r.consumed,remainingSegments:e.slice(r.consumed.length),parameters:g,positionalParamSegments:r.posParams??{}}}function sk(n,t,e,i){if(e.length>0&&function XJ(n,t,e){return e.some(i=>ak(n,t,i)&&gf(i)!==Tr)}(n,e,i)){const a=new Yr(t,function QJ(n,t,e,i){const r={};r[Tr]=i,i._sourceSegment=n,i._segmentIndexShift=t.length;for(const a of e)if(""===a.path&&gf(a)!==Tr){const g=new Yr([],{});g._sourceSegment=n,g._segmentIndexShift=t.length,r[gf(a)]=g}return r}(n,t,i,new Yr(e,n.children)));return a._sourceSegment=n,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:[]}}if(0===e.length&&function eQ(n,t,e){return e.some(i=>ak(n,t,i))}(n,e,i)){const a=new Yr(n.segments,function JJ(n,t,e,i,r){const a={};for(const g of i)if(ak(n,e,g)&&!r[gf(g)]){const E=new Yr([],{});E._sourceSegment=n,E._segmentIndexShift=t.length,a[gf(g)]=E}return{...r,...a}}(n,t,e,i,n.children));return a._sourceSegment=n,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:e}}const r=new Yr(n.segments,n.children);return r._sourceSegment=n,r._segmentIndexShift=t.length,{segmentGroup:r,slicedSegments:e}}function ak(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function f4(n,t,e,i){return!!(gf(n)===i||i!==Tr&&ak(t,e,n))&&("**"===n.path||dF(t,n,e).matched)}function m4(n,t,e){return 0===t.length&&!n.children[e]}const lk=!1;class ck{constructor(t){this.segmentGroup=t||null}}class g4{constructor(t){this.urlTree=t}}function ZS(n){return PS(new ck(n))}function _4(n){return PS(new g4(n))}class rQ{constructor(t,e,i,r,a){this.injector=t,this.configLoader=e,this.urlSerializer=i,this.urlTree=r,this.config=a,this.allowRedirects=!0}apply(){const t=sk(this.urlTree.root,[],[],this.config).segmentGroup,e=new Yr(t.segments,t.children);return this.expandSegmentGroup(this.injector,this.config,e,Tr).pipe((0,M.U)(a=>this.createUrlTree(ek(a),this.urlTree.queryParams,this.urlTree.fragment))).pipe($v(a=>{if(a instanceof g4)return this.allowRedirects=!1,this.match(a.urlTree);throw a instanceof ck?this.noMatchError(a):a}))}match(t){return this.expandSegmentGroup(this.injector,this.config,t.root,Tr).pipe((0,M.U)(r=>this.createUrlTree(ek(r),t.queryParams,t.fragment))).pipe($v(r=>{throw r instanceof ck?this.noMatchError(r):r}))}noMatchError(t){return new o.vHH(4002,lk)}createUrlTree(t,e,i){const r=KL(t);return new iw(r,e,i)}expandSegmentGroup(t,e,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(t,e,i).pipe((0,M.U)(a=>new Yr([],a))):this.expandSegment(t,i,e,i.segments,r,!0)}expandChildren(t,e,i){const r=[];for(const a of Object.keys(i.children))"primary"===a?r.unshift(a):r.push(a);return(0,Qr.D)(r).pipe(T(a=>{const g=i.children[a],E=u4(e,a);return this.expandSegmentGroup(t,E,g,a).pipe((0,M.U)(O=>({segment:O,outlet:a})))}),J1((a,g)=>(a[g.outlet]=g.segment,a),{}),R6())}expandSegment(t,e,i,r,a,g){return(0,Qr.D)(i).pipe(T(E=>this.expandSegmentAgainstRoute(t,e,i,E,r,a,g).pipe($v(j=>{if(j instanceof ck)return qn(null);throw j}))),Bh(E=>!!E),$v((E,O)=>{if(uF(E))return m4(e,r,a)?qn(new Yr([],{})):ZS(e);throw E}))}expandSegmentAgainstRoute(t,e,i,r,a,g,E){return f4(r,e,a,g)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,e,r,a,g):E&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,i,r,a,g):ZS(e):ZS(e)}expandSegmentAgainstRouteUsingRedirect(t,e,i,r,a,g){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,i,r,g):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,r,a,g)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,i,r){const a=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?_4(a):this.lineralizeSegments(i,a).pipe((0,h.z)(g=>{const E=new Yr(g,{});return this.expandSegment(t,E,e,g,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,r,a,g){const{matched:E,consumedSegments:O,remainingSegments:j,positionalParamSegments:Y}=dF(e,r,a);if(!E)return ZS(e);const se=this.applyRedirectCommands(O,r.redirectTo,Y);return r.redirectTo.startsWith("/")?_4(se):this.lineralizeSegments(r,se).pipe((0,h.z)(be=>this.expandSegment(t,e,i,be.concat(j),g,!1)))}matchSegmentAgainstRoute(t,e,i,r,a){return"**"===i.path?(t=c4(i,t),i.loadChildren?(i._loadedRoutes?qn({routes:i._loadedRoutes,injector:i._loadedInjector}):this.configLoader.loadChildren(t,i)).pipe((0,M.U)(E=>(i._loadedRoutes=E.routes,i._loadedInjector=E.injector,new Yr(r,{})))):qn(new Yr(r,{}))):p4(e,i,r,t).pipe(Yo(({matched:g,consumedSegments:E,remainingSegments:O})=>g?this.getChildConfig(t=i._injector??t,i,r).pipe((0,h.z)(Y=>{const se=Y.injector??t,be=Y.routes,{segmentGroup:Me,slicedSegments:Ge}=sk(e,E,O,be),_t=new Yr(Me.segments,Me.children);if(0===Ge.length&&_t.hasChildren())return this.expandChildren(se,be,_t).pipe((0,M.U)(Bn=>new Yr(E,Bn)));if(0===be.length&&0===Ge.length)return qn(new Yr(E,{}));const Dt=gf(i)===a;return this.expandSegment(se,_t,be,Ge,Dt?Tr:a,!0).pipe((0,M.U)(Ln=>new Yr(E.concat(Ln.segments),Ln.children)))})):ZS(e)))}getChildConfig(t,e,i){return e.children?qn({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?qn({routes:e._loadedRoutes,injector:e._loadedInjector}):function KJ(n,t,e,i){const r=t.canLoad;return void 0===r||0===r.length?qn(!0):qn(r.map(g=>{const E=cC(g,n);return Wv(function LJ(n){return n&&WS(n.canLoad)}(E)?E.canLoad(t,e):n.runInContext(()=>E(t,e)))})).pipe(uC(),d4())}(t,e,i).pipe((0,h.z)(r=>r?this.configLoader.loadChildren(t,e).pipe((0,dh.b)(a=>{e._loadedRoutes=a.routes,e._loadedInjector=a.injector})):function nQ(n){return PS(s4(lk,3))}())):qn({routes:[],injector:t})}lineralizeSegments(t,e){let i=[],r=e.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return qn(i);if(r.numberOfChildren>1||!r.children[Tr])return PS(new o.vHH(4e3,lk));r=r.children[Tr]}}applyRedirectCommands(t,e,i){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,i)}applyRedirectCreateUrlTree(t,e,i,r){const a=this.createSegmentGroup(t,e.root,i,r);return new iw(a,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const i={};return Ru(t,(r,a)=>{if("string"==typeof r&&r.startsWith(":")){const E=r.substring(1);i[a]=e[E]}else i[a]=r}),i}createSegmentGroup(t,e,i,r){const a=this.createSegments(t,e.segments,i,r);let g={};return Ru(e.children,(E,O)=>{g[O]=this.createSegmentGroup(t,E,i,r)}),new Yr(a,g)}createSegments(t,e,i,r){return e.map(a=>a.path.startsWith(":")?this.findPosParam(t,a,r):this.findOrReturn(a,i))}findPosParam(t,e,i){const r=i[e.path.substring(1)];if(!r)throw new o.vHH(4001,lk);return r}findOrReturn(t,e){let i=0;for(const r of e){if(r.path===t.path)return e.splice(i),r;i++}return t}}class sQ{}class cQ{constructor(t,e,i,r,a,g,E){this.injector=t,this.rootComponentType=e,this.config=i,this.urlTree=r,this.url=a,this.paramsInheritanceStrategy=g,this.urlSerializer=E}recognize(){const t=sk(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,Tr).pipe((0,M.U)(e=>{if(null===e)return null;const i=new nk([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Tr,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new X_(i,e),a=new i4(this.url,r);return this.inheritParamsAndData(a._root),a}))}inheritParamsAndData(t){const e=t.value,i=n4(e,this.paramsInheritanceStrategy);e.params=Object.freeze(i.params),e.data=Object.freeze(i.data),t.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(t,e,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(t,e,i):this.processSegment(t,e,i,i.segments,r)}processChildren(t,e,i){return(0,Qr.D)(Object.keys(i.children)).pipe(T(r=>{const a=i.children[r],g=u4(e,r);return this.processSegmentGroup(t,g,a,r)}),J1((r,a)=>r&&a?(r.push(...a),r):null),function DY(n,t=!1){return(0,k.e)((e,i)=>{let r=0;e.subscribe((0,P.x)(i,a=>{const g=n(a,r++);(g||t)&&i.next(a),!g&&i.complete()}))})}(r=>null!==r),gg(null),R6(),(0,M.U)(r=>{if(null===r)return null;const a=v4(r);return function uQ(n){n.sort((t,e)=>t.value.outlet===Tr?-1:e.value.outlet===Tr?1:t.value.outlet.localeCompare(e.value.outlet))}(a),a}))}processSegment(t,e,i,r,a){return(0,Qr.D)(e).pipe(T(g=>this.processSegmentAgainstRoute(g._injector??t,g,i,r,a)),Bh(g=>!!g),$v(g=>{if(uF(g))return m4(i,r,a)?qn([]):qn(null);throw g}))}processSegmentAgainstRoute(t,e,i,r,a){if(e.redirectTo||!f4(e,i,r,a))return qn(null);let g;if("**"===e.path){const E=r.length>0?L6(r).parameters:{},O=w4(i)+r.length;g=qn({snapshot:new nk(r,E,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,x4(e),gf(e),e.component??e._loadedComponent??null,e,b4(i),O,C4(e)),consumedSegments:[],remainingSegments:[]})}else g=p4(i,e,r,t).pipe((0,M.U)(({matched:E,consumedSegments:O,remainingSegments:j,parameters:Y})=>{if(!E)return null;const se=w4(i)+O.length;return{snapshot:new nk(O,Y,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,x4(e),gf(e),e.component??e._loadedComponent??null,e,b4(i),se,C4(e)),consumedSegments:O,remainingSegments:j}}));return g.pipe(Yo(E=>{if(null===E)return qn(null);const{snapshot:O,consumedSegments:j,remainingSegments:Y}=E;t=e._injector??t;const se=e._loadedInjector??t,be=function hQ(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(e),{segmentGroup:Me,slicedSegments:Ge}=sk(i,j,Y,be.filter(Dt=>void 0===Dt.redirectTo));if(0===Ge.length&&Me.hasChildren())return this.processChildren(se,be,Me).pipe((0,M.U)(Dt=>null===Dt?null:[new X_(O,Dt)]));if(0===be.length&&0===Ge.length)return qn([new X_(O,[])]);const _t=gf(e)===a;return this.processSegment(se,be,Me,Ge,_t?Tr:a).pipe((0,M.U)(Dt=>null===Dt?null:[new X_(O,Dt)]))}))}}function dQ(n){const t=n.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function v4(n){const t=[],e=new Set;for(const i of n){if(!dQ(i)){t.push(i);continue}const r=t.find(a=>i.value.routeConfig===a.value.routeConfig);void 0!==r?(r.children.push(...i.children),e.add(r)):t.push(i)}for(const i of e){const r=v4(i.children);t.push(new X_(i.value,r))}return t.filter(i=>!e.has(i))}function b4(n){let t=n;for(;t._sourceSegment;)t=t._sourceSegment;return t}function w4(n){let t=n,e=t._segmentIndexShift??0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift??0;return e-1}function x4(n){return n.data||{}}function C4(n){return n.resolve||{}}function E4(n){return"string"==typeof n.title||null===n.title}function pF(n){return Yo(t=>{const e=n(t);return e?(0,Qr.D)(e).pipe((0,M.U)(()=>t)):qn(t)})}const hC=new o.OlP("ROUTES");let fF=(()=>{class n{constructor(e,i){this.injector=e,this.compiler=i,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return qn(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const i=Wv(e.loadComponent()).pipe((0,M.U)(S4),(0,dh.b)(a=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=a}),WL(()=>{this.componentLoaders.delete(e)})),r=new k6(i,()=>new Es.x).pipe(GL());return this.componentLoaders.set(e,r),r}loadChildren(e,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return qn({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const a=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe((0,M.U)(E=>{this.onLoadEndListener&&this.onLoadEndListener(i);let O,j,Y=!1;Array.isArray(E)?j=E:(O=E.create(e).injector,j=O6(O.get(hC,[],o.XFs.Self|o.XFs.Optional)));return{routes:j.map(cF),injector:O}}),WL(()=>{this.childrenLoaders.delete(i)})),g=new k6(a,()=>new Es.x).pipe(GL());return this.childrenLoaders.set(i,g),g}loadModuleFactoryOrRoutes(e){return Wv(e()).pipe((0,M.U)(S4),(0,h.z)(r=>r instanceof o.YKP||Array.isArray(r)?qn(r):(0,Qr.D)(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(o.zs3),o.LFG(o.Sil))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function S4(n){return function wQ(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let hk=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Es.x,this.configLoader=(0,o.f3M)(fF),this.environmentInjector=(0,o.f3M)(o.lqb),this.urlSerializer=(0,o.f3M)(FS),this.rootContexts=(0,o.f3M)(HS),this.navigationId=0,this.afterPreactivation=()=>qn(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new cJ(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new lJ(r))}complete(){this.transitions?.complete()}handleNavigationRequest(e){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...e,id:i})}setupNavigations(e){return this.transitions=new $h({id:0,targetPageId:0,currentUrlTree:e.currentUrlTree,currentRawUrl:e.currentUrlTree,extractedUrl:e.urlHandlingStrategy.extract(e.currentUrlTree),urlAfterRedirects:e.urlHandlingStrategy.extract(e.currentUrlTree),rawUrl:e.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:VS,restoredState:null,currentSnapshot:e.routerState.snapshot,targetSnapshot:null,currentRouterState:e.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(I(i=>0!==i.id),(0,M.U)(i=>({...i,extractedUrl:e.urlHandlingStrategy.extract(i.rawUrl)})),Yo(i=>{let r=!1,a=!1;return qn(i).pipe((0,dh.b)(g=>{this.currentNavigation={id:g.id,initialUrl:g.rawUrl,extractedUrl:g.extractedUrl,trigger:g.source,extras:g.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Yo(g=>{const E=e.browserUrlTree.toString(),O=!e.navigated||g.extractedUrl.toString()!==E||E!==e.currentUrlTree.toString();if(!O&&"reload"!==(g.extras.onSameUrlNavigation??e.onSameUrlNavigation)){const Y="";return this.events.next(new Y6(g.id,e.serializeUrl(i.rawUrl),Y,0)),e.rawUrlTree=g.rawUrl,g.resolve(null),Su.E}if(e.urlHandlingStrategy.shouldProcessUrl(g.rawUrl))return I4(g.source)&&(e.browserUrlTree=g.extractedUrl),qn(g).pipe(Yo(Y=>{const se=this.transitions?.getValue();return this.events.next(new XL(Y.id,this.urlSerializer.serialize(Y.extractedUrl),Y.source,Y.restoredState)),se!==this.transitions?.getValue()?Su.E:Promise.resolve(Y)}),function oQ(n,t,e,i){return Yo(r=>function iQ(n,t,e,i,r){return new rQ(n,t,e,i,r).apply()}(n,t,e,r.extractedUrl,i).pipe((0,M.U)(a=>({...r,urlAfterRedirects:a}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,e.config),(0,dh.b)(Y=>{this.currentNavigation={...this.currentNavigation,finalUrl:Y.urlAfterRedirects},i.urlAfterRedirects=Y.urlAfterRedirects}),function fQ(n,t,e,i,r){return(0,h.z)(a=>function lQ(n,t,e,i,r,a,g="emptyOnly"){return new cQ(n,t,e,i,r,g,a).recognize().pipe(Yo(E=>null===E?function aQ(n){return new w.y(t=>t.error(n))}(new sQ):qn(E)))}(n,t,e,a.urlAfterRedirects,i.serialize(a.urlAfterRedirects),i,r).pipe((0,M.U)(g=>({...a,targetSnapshot:g}))))}(this.environmentInjector,this.rootComponentType,e.config,this.urlSerializer,e.paramsInheritanceStrategy),(0,dh.b)(Y=>{if(i.targetSnapshot=Y.targetSnapshot,"eager"===e.urlUpdateStrategy){if(!Y.extras.skipLocationChange){const be=e.urlHandlingStrategy.merge(Y.urlAfterRedirects,Y.rawUrl);e.setBrowserUrl(be,Y)}e.browserUrlTree=Y.urlAfterRedirects}const se=new iJ(Y.id,this.urlSerializer.serialize(Y.extractedUrl),this.urlSerializer.serialize(Y.urlAfterRedirects),Y.targetSnapshot);this.events.next(se)}));if(O&&e.urlHandlingStrategy.shouldProcessUrl(e.rawUrlTree)){const{id:Y,extractedUrl:se,source:be,restoredState:Me,extras:Ge}=g,_t=new XL(Y,this.urlSerializer.serialize(se),be,Me);this.events.next(_t);const Dt=t4(se,this.rootComponentType).snapshot;return qn(i={...g,targetSnapshot:Dt,urlAfterRedirects:se,extras:{...Ge,skipLocationChange:!1,replaceUrl:!1}})}{const Y="";return this.events.next(new Y6(g.id,e.serializeUrl(i.extractedUrl),Y,1)),e.rawUrlTree=g.rawUrl,g.resolve(null),Su.E}}),(0,dh.b)(g=>{const E=new rJ(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot);this.events.next(E)}),(0,M.U)(g=>i={...g,guards:MJ(g.targetSnapshot,g.currentSnapshot,this.rootContexts)}),function UJ(n,t){return(0,h.z)(e=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:a,canDeactivateChecks:g}}=e;return 0===g.length&&0===a.length?qn({...e,guardsResult:!0}):function HJ(n,t,e,i){return(0,Qr.D)(n).pipe((0,h.z)(r=>function qJ(n,t,e,i,r){const a=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return a&&0!==a.length?qn(a.map(E=>{const O=jS(t)??r,j=cC(E,O);return Wv(function zJ(n){return n&&WS(n.canDeactivate)}(j)?j.canDeactivate(n,t,e,i):O.runInContext(()=>j(n,t,e,i))).pipe(Bh())})).pipe(uC()):qn(!0)}(r.component,r.route,e,t,i)),Bh(r=>!0!==r,!0))}(g,i,r,n).pipe((0,h.z)(E=>E&&function OJ(n){return"boolean"==typeof n}(E)?function jJ(n,t,e,i){return(0,Qr.D)(t).pipe(T(r=>jL(function $J(n,t){return null!==n&&t&&t(new uJ(n)),qn(!0)}(r.route.parent,i),function GJ(n,t){return null!==n&&t&&t(new dJ(n)),qn(!0)}(r.route,i),function ZJ(n,t,e){const i=t[t.length-1],a=t.slice(0,t.length-1).reverse().map(g=>function kJ(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(g)).filter(g=>null!==g).map(g=>M6(()=>qn(g.guards.map(O=>{const j=jS(g.node)??e,Y=cC(O,j);return Wv(function NJ(n){return n&&WS(n.canActivateChild)}(Y)?Y.canActivateChild(i,n):j.runInContext(()=>Y(i,n))).pipe(Bh())})).pipe(uC())));return qn(a).pipe(uC())}(n,r.path,e),function WJ(n,t,e){const i=t.routeConfig?t.routeConfig.canActivate:null;if(!i||0===i.length)return qn(!0);const r=i.map(a=>M6(()=>{const g=jS(t)??e,E=cC(a,g);return Wv(function FJ(n){return n&&WS(n.canActivate)}(E)?E.canActivate(t,n):g.runInContext(()=>E(t,n))).pipe(Bh())}));return qn(r).pipe(uC())}(n,r.route,e))),Bh(r=>!0!==r,!0))}(i,a,n,t):qn(E)),(0,M.U)(E=>({...e,guardsResult:E})))})}(this.environmentInjector,g=>this.events.next(g)),(0,dh.b)(g=>{if(i.guardsResult=g.guardsResult,ow(g.guardsResult))throw o4(0,g.guardsResult);const E=new oJ(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot,!!g.guardsResult);this.events.next(E)}),I(g=>!!g.guardsResult||(e.restoreHistory(g),this.cancelNavigationTransition(g,"",3),!1)),pF(g=>{if(g.guards.canActivateChecks.length)return qn(g).pipe((0,dh.b)(E=>{const O=new sJ(E.id,this.urlSerializer.serialize(E.extractedUrl),this.urlSerializer.serialize(E.urlAfterRedirects),E.targetSnapshot);this.events.next(O)}),Yo(E=>{let O=!1;return qn(E).pipe(function mQ(n,t){return(0,h.z)(e=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=e;if(!r.length)return qn(e);let a=0;return(0,Qr.D)(r).pipe(T(g=>function gQ(n,t,e,i){const r=n.routeConfig,a=n._resolve;return void 0!==r?.title&&!E4(r)&&(a[OS]=r.title),function _Q(n,t,e,i){const r=function yQ(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return qn({});const a={};return(0,Qr.D)(r).pipe((0,h.z)(g=>function vQ(n,t,e,i){const r=jS(t)??i,a=cC(n,r);return Wv(a.resolve?a.resolve(t,e):r.runInContext(()=>a(t,e)))}(n[g],t,e,i).pipe(Bh(),(0,dh.b)(E=>{a[g]=E}))),$L(1),function AY(n){return(0,M.U)(()=>n)}(a),$v(g=>uF(g)?Su.E:PS(g)))}(a,n,t,i).pipe((0,M.U)(g=>(n._resolvedData=g,n.data=n4(n,e).resolve,r&&E4(r)&&(n.data[OS]=r.title),null)))}(g.route,i,n,t)),(0,dh.b)(()=>a++),$L(1),(0,h.z)(g=>a===r.length?qn(e):Su.E))})}(e.paramsInheritanceStrategy,this.environmentInjector),(0,dh.b)({next:()=>O=!0,complete:()=>{O||(e.restoreHistory(E),this.cancelNavigationTransition(E,"",2))}}))}),(0,dh.b)(E=>{const O=new aJ(E.id,this.urlSerializer.serialize(E.extractedUrl),this.urlSerializer.serialize(E.urlAfterRedirects),E.targetSnapshot);this.events.next(O)}))}),pF(g=>{const E=O=>{const j=[];O.routeConfig?.loadComponent&&!O.routeConfig._loadedComponent&&j.push(this.configLoader.loadComponent(O.routeConfig).pipe((0,dh.b)(Y=>{O.component=Y}),(0,M.U)(()=>{})));for(const Y of O.children)j.push(...E(Y));return j};return D6(E(g.targetSnapshot.root)).pipe(gg(),cf(1))}),pF(()=>this.afterPreactivation()),(0,M.U)(g=>{const E=function vJ(n,t,e){const i=US(n,t._root,e?e._root:void 0);return new e4(i,t)}(e.routeReuseStrategy,g.targetSnapshot,g.currentRouterState);return i={...g,targetRouterState:E}}),(0,dh.b)(g=>{e.currentUrlTree=g.urlAfterRedirects,e.rawUrlTree=e.urlHandlingStrategy.merge(g.urlAfterRedirects,g.rawUrl),e.routerState=g.targetRouterState,"deferred"===e.urlUpdateStrategy&&(g.extras.skipLocationChange||e.setBrowserUrl(e.rawUrlTree,g),e.browserUrlTree=g.urlAfterRedirects)}),((n,t,e)=>(0,M.U)(i=>(new AJ(t,i.targetRouterState,i.currentRouterState,e).activate(n),i)))(this.rootContexts,e.routeReuseStrategy,g=>this.events.next(g)),(0,dh.b)({next:g=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,e.navigated=!0,this.events.next(new sw(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(e.currentUrlTree))),e.titleStrategy?.updateTitle(g.targetRouterState.snapshot),g.resolve(!0)},complete:()=>{r=!0}}),WL(()=>{r||a||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),$v(g=>{if(a=!0,l4(g)){a4(g)||(e.navigated=!0,e.restoreHistory(i,!0));const E=new tk(i.id,this.urlSerializer.serialize(i.extractedUrl),g.message,g.cancellationCode);if(this.events.next(E),a4(g)){const O=e.urlHandlingStrategy.merge(g.url,e.rawUrlTree),j={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===e.urlUpdateStrategy||I4(i.source)};e.scheduleNavigation(O,VS,null,j,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{e.restoreHistory(i,!0);const E=new J6(i.id,this.urlSerializer.serialize(i.extractedUrl),g,i.targetSnapshot??void 0);this.events.next(E);try{i.resolve(e.errorHandler(g))}catch(O){i.reject(O)}}return Su.E}))}))}cancelNavigationTransition(e,i,r){const a=new tk(e.id,this.urlSerializer.serialize(e.extractedUrl),i,r);this.events.next(a),e.resolve(!1)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function I4(n){return n!==VS}let D4=(()=>{class n{buildTitle(e){let i,r=e.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(a=>a.outlet===Tr);return i}getResolvedTitleForRoute(e){return e.data[OS]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:function(){return(0,o.f3M)(xQ)},providedIn:"root"}),n})(),xQ=(()=>{class n extends D4{constructor(e){super(),this.title=e}updateTitle(e){const i=this.buildTitle(e);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(Yd))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),CQ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:function(){return(0,o.f3M)(TQ)},providedIn:"root"}),n})();class EQ{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}let TQ=(()=>{class n extends EQ{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=o.n5z(n)))(i||n)}}(),n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const dk=new o.OlP("",{providedIn:"root",factory:()=>({})});let IQ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:function(){return(0,o.f3M)(DQ)},providedIn:"root"}),n})(),DQ=(()=>{class n{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,i){return e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function AQ(n){throw n}function MQ(n,t,e){return t.parse("/")}const kQ={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},RQ={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let vp=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,o.f3M)(o.c2e),this.isNgZoneEnabled=!1,this.options=(0,o.f3M)(dk,{optional:!0})||{},this.errorHandler=this.options.errorHandler||AQ,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||MQ,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,o.f3M)(IQ),this.routeReuseStrategy=(0,o.f3M)(CQ),this.urlCreationStrategy=(0,o.f3M)(gJ),this.titleStrategy=(0,o.f3M)(D4),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=O6((0,o.f3M)(hC,{optional:!0})??[]),this.navigationTransitions=(0,o.f3M)(hk),this.urlSerializer=(0,o.f3M)(FS),this.location=(0,o.f3M)(st),this.isNgZoneEnabled=(0,o.f3M)(o.R0b)instanceof o.R0b&&o.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new iw,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=t4(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(e=>{this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const e=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),VS,e)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const i="popstate"===e.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(e.url,i,e.state)},0)}))}navigateToSyncWithBrowser(e,i,r){const a={replaceUrl:!0},g=r?.navigationId?r:null;if(r){const O={...r};delete O.navigationId,delete O.\u0275routerPageId,0!==Object.keys(O).length&&(a.state=O)}const E=this.parseUrl(e);this.scheduleNavigation(E,i,g,a)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(e){this.config=e.map(cF),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,i={}){const{relativeTo:r,queryParams:a,fragment:g,queryParamsHandling:E,preserveFragment:O}=i,j=O?this.currentUrlTree.fragment:g;let Y=null;switch(E){case"merge":Y={...this.currentUrlTree.queryParams,...a};break;case"preserve":Y=this.currentUrlTree.queryParams;break;default:Y=a||null}return null!==Y&&(Y=this.removeEmptyProps(Y)),this.urlCreationStrategy.createUrlTree(r,this.routerState,this.currentUrlTree,e,Y,j??null)}navigateByUrl(e,i={skipLocationChange:!1}){const r=ow(e)?e:this.parseUrl(e),a=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(a,VS,null,i)}navigate(e,i={skipLocationChange:!1}){return function PQ(n){for(let t=0;t<n.length;t++){if(null==n[t])throw new o.vHH(4008,!1)}}(e),this.navigateByUrl(this.createUrlTree(e,i),i)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let i;try{i=this.urlSerializer.parse(e)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,e)}return i}isActive(e,i){let r;if(r=!0===i?{...kQ}:!1===i?{...RQ}:i,ow(e))return N6(this.currentUrlTree,e,r);const a=this.parseUrl(e);return N6(this.currentUrlTree,a,r)}removeEmptyProps(e){return Object.keys(e).reduce((i,r)=>{const a=e[r];return null!=a&&(i[r]=a),i},{})}scheduleNavigation(e,i,r,a,g){if(this.disposed)return Promise.resolve(!1);let E,O,j,Y;return g?(E=g.resolve,O=g.reject,j=g.promise):j=new Promise((se,be)=>{E=se,O=be}),Y="computed"===this.canceledNavigationResolution?r&&r.\u0275routerPageId?r.\u0275routerPageId:a.replaceUrl||a.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:Y,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:a,resolve:E,reject:O,promise:j,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),j.catch(se=>Promise.reject(se))}setBrowserUrl(e,i){const r=this.urlSerializer.serialize(e),a={...i.extras.state,...this.generateNgRouterState(i.id,i.targetPageId)};this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",a):this.location.go(r,"",a)}restoreHistory(e,i=!1){if("computed"===this.canceledNavigationResolution){const r=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===r?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===r&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(r)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,i){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:i}:{navigationId:e}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),pk=(()=>{class n{constructor(e,i,r,a,g,E){this.router=e,this.route=i,this.tabIndexAttribute=r,this.renderer=a,this.el=g,this.locationStrategy=E,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new Es.x;const O=g.nativeElement.tagName;this.isAnchorElement="A"===O||"AREA"===O,this.isAnchorElement?this.subscription=e.events.subscribe(j=>{j instanceof sw&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(e){this._preserveFragment=(0,o.D6c)(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=(0,o.D6c)(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=(0,o.D6c)(e)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(e){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(e,i,r,a,g){return!!(null===this.urlTree||this.isAnchorElement&&(0!==e||i||r||a||g||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const e=null===this.href?null:(0,o.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",e)}applyAttributeValue(e,i){const r=this.renderer,a=this.el.nativeElement;null!==i?r.setAttribute(a,e,i):r.removeAttribute(a,e)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(vp),o.Y36(lC),o.$8M("tabindex"),o.Y36(o.Qsj),o.Y36(o.SBq),o.Y36(Je))},n.\u0275dir=o.lG2({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(e,i){1&e&&o.NdJ("click",function(a){return i.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),2&e&&o.uIk("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[o.TTD]}),n})();class M4{}let FQ=(()=>{class n{constructor(e,i,r,a,g){this.router=e,this.injector=r,this.preloadingStrategy=a,this.loader=g}setUpPreloading(){this.subscription=this.router.events.pipe(I(e=>e instanceof sw),T(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,i){const r=[];for(const a of i){a.providers&&!a._injector&&(a._injector=(0,o.MMx)(a.providers,e,`Route: ${a.path}`));const g=a._injector??e,E=a._loadedInjector??g;a.loadChildren&&!a._loadedRoutes&&void 0===a.canLoad||a.loadComponent&&!a._loadedComponent?r.push(this.preloadConfig(g,a)):(a.children||a._loadedRoutes)&&r.push(this.processRoutes(E,a.children??a._loadedRoutes))}return(0,Qr.D)(r).pipe((0,RS.J)())}preloadConfig(e,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(e,i):qn(null);const a=r.pipe((0,h.z)(g=>null===g?qn(void 0):(i._loadedRoutes=g.routes,i._loadedInjector=g.injector,this.processRoutes(g.injector??e,g.routes))));if(i.loadComponent&&!i._loadedComponent){const g=this.loader.loadComponent(i);return(0,Qr.D)([a,g]).pipe((0,RS.J)())}return a})}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(vp),o.LFG(o.Sil),o.LFG(o.lqb),o.LFG(M4),o.LFG(fF))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const mF=new o.OlP("");let k4=(()=>{class n{constructor(e,i,r,a,g={}){this.urlSerializer=e,this.transitions=i,this.viewportScroller=r,this.zone=a,this.options=g,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},g.scrollPositionRestoration=g.scrollPositionRestoration||"disabled",g.anchorScrolling=g.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof XL?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof sw&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof Q6&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Q6(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(e){o.$Z()},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})();function aw(n,t){return{\u0275kind:n,\u0275providers:t}}function P4(){const n=(0,o.f3M)(o.zs3);return t=>{const e=n.get(o.z2F);if(t!==e.components[0])return;const i=n.get(vp),r=n.get(O4);1===n.get(_F)&&i.initialNavigation(),n.get(L4,null,o.XFs.Optional)?.setUpPreloading(),n.get(mF,null,o.XFs.Optional)?.init(),i.resetRootComponentType(e.componentTypes[0]),r.closed||(r.next(),r.unsubscribe())}}const O4=new o.OlP("",{factory:()=>new Es.x}),_F=new o.OlP("",{providedIn:"root",factory:()=>1});const L4=new o.OlP("");function UQ(n){return aw(0,[{provide:L4,useExisting:FQ},{provide:M4,useExisting:n}])}const F4=new o.OlP("ROUTER_FORROOT_GUARD"),HQ=[st,{provide:FS,useClass:ZL},vp,HS,{provide:lC,useFactory:function R4(n){return n.routerState.root},deps:[vp]},fF,[]];function jQ(){return new o.PXZ("Router",vp)}let N4=(()=>{class n{constructor(e){}static forRoot(e,i){return{ngModule:n,providers:[HQ,[],{provide:hC,multi:!0,useValue:e},{provide:F4,useFactory:ZQ,deps:[[vp,new o.FiY,new o.tp0]]},{provide:dk,useValue:i||{}},i?.useHash?{provide:Je,useClass:Jt}:{provide:Je,useClass:Ot},{provide:mF,useFactory:()=>{const n=(0,o.f3M)(Vu),t=(0,o.f3M)(o.R0b),e=(0,o.f3M)(dk),i=(0,o.f3M)(hk),r=(0,o.f3M)(FS);return e.scrollOffset&&n.setOffset(e.scrollOffset),new k4(r,i,n,t,e)}},i?.preloadingStrategy?UQ(i.preloadingStrategy).\u0275providers:[],{provide:o.PXZ,multi:!0,useFactory:jQ},i?.initialNavigation?qQ(i):[],[{provide:z4,useFactory:P4},{provide:o.tb,multi:!0,useExisting:z4}]]}}static forChild(e){return{ngModule:n,providers:[{provide:hC,multi:!0,useValue:e}]}}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(F4,8))},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[aF]}),n})();function ZQ(n){return"guarded"}function qQ(n){return["disabled"===n.initialNavigation?aw(3,[{provide:o.ip1,multi:!0,useFactory:()=>{const t=(0,o.f3M)(vp);return()=>{t.setUpLocationChangeListener()}}},{provide:_F,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?aw(2,[{provide:_F,useValue:0},{provide:o.ip1,multi:!0,deps:[o.zs3],useFactory:t=>{const e=t.get(qe,Promise.resolve());return()=>e.then(()=>new Promise(r=>{const a=t.get(vp),g=t.get(O4);(function i(r){t.get(vp).events.pipe(I(g=>g instanceof sw||g instanceof tk||g instanceof J6),(0,M.U)(g=>g instanceof sw||g instanceof tk&&(0===g.code||1===g.code)&&null),I(g=>null!==g),cf(1)).subscribe(()=>{r()})})(()=>{r(!0)}),t.get(hk).afterPreactivation=()=>(r(!0),g.closed?qn(void 0):g),a.initialNavigation()}))}}]).\u0275providers:[]]}const z4=new o.OlP("");var KS=(()=>(function(n){n.Scheduled="scheduled",n.Available="available",n.Unknown="unknown"}(KS||(KS={})),KS))(),ey=(()=>(function(n){n.Empty="empty",n.Disabled="disabled",n.Full="full",n.Partial="partial"}(ey||(ey={})),ey))();class pC{constructor(t){this.http=t}getFiles(){return this.http.get("./assets/data/files.json").pipe((0,M.U)(e=>e.data))}}pC.\u0275fac=function(t){return new(t||pC)(o.LFG(yt))},pC.\u0275prov=o.Yz7({token:pC,factory:pC.\u0275fac,providedIn:"root"});class ti{static equals(t,e,i){return i?this.resolveFieldData(t,i)===this.resolveFieldData(e,i):this.equalsByValue(t,e)}static equalsByValue(t,e){if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e){var a,g,E,i=Array.isArray(t),r=Array.isArray(e);if(i&&r){if((g=t.length)!=e.length)return!1;for(a=g;0!=a--;)if(!this.equalsByValue(t[a],e[a]))return!1;return!0}if(i!=r)return!1;var O=t instanceof Date,j=e instanceof Date;if(O!=j)return!1;if(O&&j)return t.getTime()==e.getTime();var Y=t instanceof RegExp,se=e instanceof RegExp;if(Y!=se)return!1;if(Y&&se)return t.toString()==e.toString();var be=Object.keys(t);if((g=be.length)!==Object.keys(e).length)return!1;for(a=g;0!=a--;)if(!Object.prototype.hasOwnProperty.call(e,be[a]))return!1;for(a=g;0!=a--;)if(!this.equalsByValue(t[E=be[a]],e[E]))return!1;return!0}return t!=t&&e!=e}static resolveFieldData(t,e){if(t&&e){if(this.isFunction(e))return e(t);if(-1==e.indexOf("."))return t[e];{let i=e.split("."),r=t;for(let a=0,g=i.length;a<g;++a){if(null==r)return null;r=r[i[a]]}return r}}return null}static isFunction(t){return!!(t&&t.constructor&&t.call&&t.apply)}static reorderArray(t,e,i){t&&e!==i&&(i>=t.length&&(i%=t.length,e%=t.length),t.splice(i,0,t.splice(e,1)[0]))}static insertIntoOrderedArray(t,e,i,r){if(i.length>0){let a=!1;for(let g=0;g<i.length;g++)if(this.findIndexInList(i[g],r)>e){i.splice(g,0,t),a=!0;break}a||i.push(t)}else i.push(t)}static findIndexInList(t,e){let i=-1;if(e)for(let r=0;r<e.length;r++)if(e[r]==t){i=r;break}return i}static contains(t,e){if(null!=t&&e&&e.length)for(let i of e)if(this.equals(t,i))return!0;return!1}static removeAccents(t){return t&&t.search(/[\xC0-\xFF]/g)>-1&&(t=t.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),t}static isEmpty(t){return null==t||""===t||Array.isArray(t)&&0===t.length||!(t instanceof Date)&&"object"==typeof t&&0===Object.keys(t).length}static isNotEmpty(t){return!this.isEmpty(t)}static compare(t,e,i,r=1){let a=-1;const g=this.isEmpty(t),E=this.isEmpty(e);return a=g&&E?0:g?r:E?-r:"string"==typeof t&&"string"==typeof e?t.localeCompare(e,i,{numeric:!0}):t<e?-1:t>e?1:0,a}static sort(t,e,i=1,r,a=1){return(1===a?i:a)*ti.compare(t,e,r,i)}static merge(t,e){if(null!=t||null!=e)return null!=t&&"object"!=typeof t||null!=e&&"object"!=typeof e?null!=t&&"string"!=typeof t||null!=e&&"string"!=typeof e?e||t:[t||"",e||""].join(" "):{...t||{},...e||{}}}}var B4=0;function YS(){return"pr_id_"+ ++B4}var _f=function YQ(){let n=[];const r=a=>a&&parseInt(a.style.zIndex,10)||0;return{get:r,set:(a,g,E)=>{g&&(g.style.zIndex=String(((a,g)=>{let E=n.length>0?n[n.length-1]:{key:a,value:g},O=E.value+(E.key===a?0:g)+1;return n.push({key:a,value:O}),O})(a,E)))},clear:a=>{a&&((a=>{n=n.filter(g=>g.value!==a)})(r(a)),a.style.zIndex="")},getCurrent:()=>n.length>0?n[n.length-1].value:0}}();const V4=["*"];let Pu=(()=>{class n{}return n.STARTS_WITH="startsWith",n.CONTAINS="contains",n.NOT_CONTAINS="notContains",n.ENDS_WITH="endsWith",n.EQUALS="equals",n.NOT_EQUALS="notEquals",n.IN="in",n.LESS_THAN="lt",n.LESS_THAN_OR_EQUAL_TO="lte",n.GREATER_THAN="gt",n.GREATER_THAN_OR_EQUAL_TO="gte",n.BETWEEN="between",n.IS="is",n.IS_NOT="isNot",n.BEFORE="before",n.AFTER="after",n.DATE_IS="dateIs",n.DATE_IS_NOT="dateIsNot",n.DATE_BEFORE="dateBefore",n.DATE_AFTER="dateAfter",n})(),U4=(()=>{class n{}return n.AND="and",n.OR="or",n})(),H4=(()=>{class n{constructor(){this.filters={startsWith:(e,i,r)=>{if(null==i||""===i.trim())return!0;if(null==e)return!1;let a=ti.removeAccents(i.toString()).toLocaleLowerCase(r);return ti.removeAccents(e.toString()).toLocaleLowerCase(r).slice(0,a.length)===a},contains:(e,i,r)=>{if(null==i||"string"==typeof i&&""===i.trim())return!0;if(null==e)return!1;let a=ti.removeAccents(i.toString()).toLocaleLowerCase(r);return-1!==ti.removeAccents(e.toString()).toLocaleLowerCase(r).indexOf(a)},notContains:(e,i,r)=>{if(null==i||"string"==typeof i&&""===i.trim())return!0;if(null==e)return!1;let a=ti.removeAccents(i.toString()).toLocaleLowerCase(r);return-1===ti.removeAccents(e.toString()).toLocaleLowerCase(r).indexOf(a)},endsWith:(e,i,r)=>{if(null==i||""===i.trim())return!0;if(null==e)return!1;let a=ti.removeAccents(i.toString()).toLocaleLowerCase(r),g=ti.removeAccents(e.toString()).toLocaleLowerCase(r);return-1!==g.indexOf(a,g.length-a.length)},equals:(e,i,r)=>null==i||"string"==typeof i&&""===i.trim()||null!=e&&(e.getTime&&i.getTime?e.getTime()===i.getTime():ti.removeAccents(e.toString()).toLocaleLowerCase(r)==ti.removeAccents(i.toString()).toLocaleLowerCase(r)),notEquals:(e,i,r)=>!(null==i||"string"==typeof i&&""===i.trim()||null!=e&&(e.getTime&&i.getTime?e.getTime()===i.getTime():ti.removeAccents(e.toString()).toLocaleLowerCase(r)==ti.removeAccents(i.toString()).toLocaleLowerCase(r))),in:(e,i)=>{if(null==i||0===i.length)return!0;for(let r=0;r<i.length;r++)if(ti.equals(e,i[r]))return!0;return!1},between:(e,i)=>null==i||null==i[0]||null==i[1]||null!=e&&(e.getTime?i[0].getTime()<=e.getTime()&&e.getTime()<=i[1].getTime():i[0]<=e&&e<=i[1]),lt:(e,i,r)=>null==i||null!=e&&(e.getTime&&i.getTime?e.getTime()<i.getTime():e<i),lte:(e,i,r)=>null==i||null!=e&&(e.getTime&&i.getTime?e.getTime()<=i.getTime():e<=i),gt:(e,i,r)=>null==i||null!=e&&(e.getTime&&i.getTime?e.getTime()>i.getTime():e>i),gte:(e,i,r)=>null==i||null!=e&&(e.getTime&&i.getTime?e.getTime()>=i.getTime():e>=i),is:(e,i,r)=>this.filters.equals(e,i,r),isNot:(e,i,r)=>this.filters.notEquals(e,i,r),before:(e,i,r)=>this.filters.lt(e,i,r),after:(e,i,r)=>this.filters.gt(e,i,r),dateIs:(e,i)=>null==i||null!=e&&e.toDateString()===i.toDateString(),dateIsNot:(e,i)=>null==i||null!=e&&e.toDateString()!==i.toDateString(),dateBefore:(e,i)=>null==i||null!=e&&e.getTime()<i.getTime(),dateAfter:(e,i)=>null==i||null!=e&&e.getTime()>i.getTime()}}filter(e,i,r,a,g){let E=[];if(e)for(let O of e)for(let j of i){let Y=ti.resolveFieldData(O,j);if(this.filters[a](Y,r,g)){E.push(O);break}}return E}register(e,i){this.filters[e]=i}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),fk=(()=>{class n{constructor(){this.clickSource=new Es.x,this.clickObservable=this.clickSource.asObservable()}add(e){e&&this.clickSource.next(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),lw=(()=>{class n{constructor(){this.ripple=!1,this.overlayOptions={},this.filterMatchModeOptions={text:[Pu.STARTS_WITH,Pu.CONTAINS,Pu.NOT_CONTAINS,Pu.ENDS_WITH,Pu.EQUALS,Pu.NOT_EQUALS],numeric:[Pu.EQUALS,Pu.NOT_EQUALS,Pu.LESS_THAN,Pu.LESS_THAN_OR_EQUAL_TO,Pu.GREATER_THAN,Pu.GREATER_THAN_OR_EQUAL_TO],date:[Pu.DATE_IS,Pu.DATE_IS_NOT,Pu.DATE_BEFORE,Pu.DATE_AFTER]},this.translation={startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",is:"Is",isNot:"Is not",before:"Before",after:"After",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dateFormat:"mm/dd/yy",firstDayOfWeek:0,today:"Today",weekHeader:"Wk",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyMessage:"No results found",emptyFilterMessage:"No results found"},this.zIndex={modal:1100,overlay:1e3,menu:1e3,tooltip:1100},this.translationSource=new Es.x,this.translationObserver=this.translationSource.asObservable()}getTranslation(e){return this.translation[e]}setTranslation(e){this.translation={...this.translation,...e},this.translationSource.next(this.translation)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),JQ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=o.Xpm({type:n,selectors:[["p-header"]],ngContentSelectors:V4,decls:1,vars:0,template:function(e,i){1&e&&(o.F$t(),o.Hsn(0))},encapsulation:2}),n})(),QQ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=o.Xpm({type:n,selectors:[["p-footer"]],ngContentSelectors:V4,decls:1,vars:0,template:function(e,i){1&e&&(o.F$t(),o.Hsn(0))},encapsulation:2}),n})(),bp=(()=>{class n{constructor(e){this.template=e}getType(){return this.name}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.Rgc))},n.\u0275dir=o.lG2({type:n,selectors:[["","pTemplate",""]],inputs:{type:"type",name:["pTemplate","name"]}}),n})(),yf=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr]}),n})(),wp=(()=>{class n{}return n.STARTS_WITH="startsWith",n.CONTAINS="contains",n.NOT_CONTAINS="notContains",n.ENDS_WITH="endsWith",n.EQUALS="equals",n.NOT_EQUALS="notEquals",n.NO_FILTER="noFilter",n.LT="lt",n.LTE="lte",n.GT="gt",n.GTE="gte",n.IS="is",n.IS_NOT="isNot",n.BEFORE="before",n.AFTER="after",n.CLEAR="clear",n.APPLY="apply",n.MATCH_ALL="matchAll",n.MATCH_ANY="matchAny",n.ADD_RULE="addRule",n.REMOVE_RULE="removeRule",n.ACCEPT="accept",n.REJECT="reject",n.CHOOSE="choose",n.UPLOAD="upload",n.CANCEL="cancel",n.DAY_NAMES="dayNames",n.DAY_NAMES_SHORT="dayNamesShort",n.DAY_NAMES_MIN="dayNamesMin",n.MONTH_NAMES="monthNames",n.MONTH_NAMES_SHORT="monthNamesShort",n.FIRST_DAY_OF_WEEK="firstDayOfWeek",n.TODAY="today",n.WEEK_HEADER="weekHeader",n.WEAK="weak",n.MEDIUM="medium",n.STRONG="strong",n.PASSWORD_PROMPT="passwordPrompt",n.EMPTY_MESSAGE="emptyMessage",n.EMPTY_FILTER_MESSAGE="emptyFilterMessage",n})(),pt=(()=>{class n{static addClass(e,i){e&&i&&(e.classList?e.classList.add(i):e.className+=" "+i)}static addMultipleClasses(e,i){if(e&&i)if(e.classList){let r=i.trim().split(" ");for(let a=0;a<r.length;a++)e.classList.add(r[a])}else{let r=i.split(" ");for(let a=0;a<r.length;a++)e.className+=" "+r[a]}}static removeClass(e,i){e&&i&&(e.classList?e.classList.remove(i):e.className=e.className.replace(new RegExp("(^|\\b)"+i.split(" ").join("|")+"(\\b|$)","gi")," "))}static hasClass(e,i){return!(!e||!i)&&(e.classList?e.classList.contains(i):new RegExp("(^| )"+i+"( |$)","gi").test(e.className))}static siblings(e){return Array.prototype.filter.call(e.parentNode.children,function(i){return i!==e})}static find(e,i){return Array.from(e.querySelectorAll(i))}static findSingle(e,i){return e?e.querySelector(i):null}static index(e){let i=e.parentNode.childNodes,r=0;for(var a=0;a<i.length;a++){if(i[a]==e)return r;1==i[a].nodeType&&r++}return-1}static indexWithinGroup(e,i){let r=e.parentNode?e.parentNode.childNodes:[],a=0;for(var g=0;g<r.length;g++){if(r[g]==e)return a;r[g].attributes&&r[g].attributes[i]&&1==r[g].nodeType&&a++}return-1}static appendOverlay(e,i,r="self"){"self"!==r&&e&&i&&this.appendChild(e,i)}static alignOverlay(e,i,r="self",a=!0){e&&i&&(a&&(e.style.minWidth||(e.style.minWidth=n.getOuterWidth(i)+"px")),"self"===r?this.relativePosition(e,i):this.absolutePosition(e,i))}static relativePosition(e,i){const r=_t=>{if(_t)return"relative"===getComputedStyle(_t).getPropertyValue("position")?_t:r(_t.parentElement)},a=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),g=i.offsetHeight,E=i.getBoundingClientRect(),O=this.getWindowScrollTop(),j=this.getWindowScrollLeft(),Y=this.getViewport(),be=r(e)?.getBoundingClientRect()||{top:-1*O,left:-1*j};let Me,Ge;E.top+g+a.height>Y.height?(Me=E.top-be.top-a.height,e.style.transformOrigin="bottom",E.top+Me<0&&(Me=-1*E.top)):(Me=g+E.top-be.top,e.style.transformOrigin="top"),Ge=a.width>Y.width?-1*(E.left-be.left):E.left-be.left+a.width>Y.width?-1*(E.left-be.left+a.width-Y.width):E.left-be.left,e.style.top=Me+"px",e.style.left=Ge+"px"}static absolutePosition(e,i){const r=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),a=r.height,g=r.width,E=i.offsetHeight,O=i.offsetWidth,j=i.getBoundingClientRect(),Y=this.getWindowScrollTop(),se=this.getWindowScrollLeft(),be=this.getViewport();let Me,Ge;j.top+E+a>be.height?(Me=j.top+Y-a,e.style.transformOrigin="bottom",Me<0&&(Me=Y)):(Me=E+j.top+Y,e.style.transformOrigin="top"),Ge=j.left+g>be.width?Math.max(0,j.left+se+O-g):j.left+se,e.style.top=Me+"px",e.style.left=Ge+"px"}static getParents(e,i=[]){return null===e.parentNode?i:this.getParents(e.parentNode,i.concat([e.parentNode]))}static getScrollableParents(e){let i=[];if(e){let r=this.getParents(e);const a=/(auto|scroll)/,g=E=>{let O=window.getComputedStyle(E,null);return a.test(O.getPropertyValue("overflow"))||a.test(O.getPropertyValue("overflowX"))||a.test(O.getPropertyValue("overflowY"))};for(let E of r){let O=1===E.nodeType&&E.dataset.scrollselectors;if(O){let j=O.split(",");for(let Y of j){let se=this.findSingle(E,Y);se&&g(se)&&i.push(se)}}9!==E.nodeType&&g(E)&&i.push(E)}}return i}static getHiddenElementOuterHeight(e){e.style.visibility="hidden",e.style.display="block";let i=e.offsetHeight;return e.style.display="none",e.style.visibility="visible",i}static getHiddenElementOuterWidth(e){e.style.visibility="hidden",e.style.display="block";let i=e.offsetWidth;return e.style.display="none",e.style.visibility="visible",i}static getHiddenElementDimensions(e){let i={};return e.style.visibility="hidden",e.style.display="block",i.width=e.offsetWidth,i.height=e.offsetHeight,e.style.display="none",e.style.visibility="visible",i}static scrollInView(e,i){let r=getComputedStyle(e).getPropertyValue("borderTopWidth"),a=r?parseFloat(r):0,g=getComputedStyle(e).getPropertyValue("paddingTop"),E=g?parseFloat(g):0,O=e.getBoundingClientRect(),Y=i.getBoundingClientRect().top+document.body.scrollTop-(O.top+document.body.scrollTop)-a-E,se=e.scrollTop,be=e.clientHeight,Me=this.getOuterHeight(i);Y<0?e.scrollTop=se+Y:Y+Me>be&&(e.scrollTop=se+Y-be+Me)}static fadeIn(e,i){e.style.opacity=0;let r=+new Date,a=0,g=function(){a=+e.style.opacity.replace(",",".")+((new Date).getTime()-r)/i,e.style.opacity=a,r=+new Date,+a<1&&(window.requestAnimationFrame&&requestAnimationFrame(g)||setTimeout(g,16))};g()}static fadeOut(e,i){var r=1,E=50/i;let O=setInterval(()=>{(r-=E)<=0&&(r=0,clearInterval(O)),e.style.opacity=r},50)}static getWindowScrollTop(){let e=document.documentElement;return(window.pageYOffset||e.scrollTop)-(e.clientTop||0)}static getWindowScrollLeft(){let e=document.documentElement;return(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}static matches(e,i){var r=Element.prototype;return(r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||function(g){return-1!==[].indexOf.call(document.querySelectorAll(g),this)}).call(e,i)}static getOuterWidth(e,i){let r=e.offsetWidth;if(i){let a=getComputedStyle(e);r+=parseFloat(a.marginLeft)+parseFloat(a.marginRight)}return r}static getHorizontalPadding(e){let i=getComputedStyle(e);return parseFloat(i.paddingLeft)+parseFloat(i.paddingRight)}static getHorizontalMargin(e){let i=getComputedStyle(e);return parseFloat(i.marginLeft)+parseFloat(i.marginRight)}static innerWidth(e){let i=e.offsetWidth,r=getComputedStyle(e);return i+=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static width(e){let i=e.offsetWidth,r=getComputedStyle(e);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static getInnerHeight(e){let i=e.offsetHeight,r=getComputedStyle(e);return i+=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom),i}static getOuterHeight(e,i){let r=e.offsetHeight;if(i){let a=getComputedStyle(e);r+=parseFloat(a.marginTop)+parseFloat(a.marginBottom)}return r}static getHeight(e){let i=e.offsetHeight,r=getComputedStyle(e);return i-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth),i}static getWidth(e){let i=e.offsetWidth,r=getComputedStyle(e);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth),i}static getViewport(){let e=window,i=document,r=i.documentElement,a=i.getElementsByTagName("body")[0];return{width:e.innerWidth||r.clientWidth||a.clientWidth,height:e.innerHeight||r.clientHeight||a.clientHeight}}static getOffset(e){var i=e.getBoundingClientRect();return{top:i.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:i.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}static replaceElementWith(e,i){let r=e.parentNode;if(!r)throw"Can't replace element";return r.replaceChild(i,e)}static getUserAgent(){return navigator.userAgent}static isIE(){var e=window.navigator.userAgent;return e.indexOf("MSIE ")>0||(e.indexOf("Trident/")>0?(e.indexOf("rv:"),!0):e.indexOf("Edge/")>0)}static isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}static isAndroid(){return/(android)/i.test(navigator.userAgent)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static appendChild(e,i){if(this.isElement(i))i.appendChild(e);else{if(!i.el||!i.el.nativeElement)throw"Cannot append "+i+" to "+e;i.el.nativeElement.appendChild(e)}}static removeChild(e,i){if(this.isElement(i))i.removeChild(e);else{if(!i.el||!i.el.nativeElement)throw"Cannot remove "+e+" from "+i;i.el.nativeElement.removeChild(e)}}static removeElement(e){"remove"in Element.prototype?e.remove():e.parentNode.removeChild(e)}static isElement(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}static calculateScrollbarWidth(e){if(e){let i=getComputedStyle(e);return e.offsetWidth-e.clientWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.borderRightWidth)}{if(null!==this.calculatedScrollbarWidth)return this.calculatedScrollbarWidth;let i=document.createElement("div");i.className="p-scrollbar-measure",document.body.appendChild(i);let r=i.offsetWidth-i.clientWidth;return document.body.removeChild(i),this.calculatedScrollbarWidth=r,r}}static calculateScrollbarHeight(){if(null!==this.calculatedScrollbarHeight)return this.calculatedScrollbarHeight;let e=document.createElement("div");e.className="p-scrollbar-measure",document.body.appendChild(e);let i=e.offsetHeight-e.clientHeight;return document.body.removeChild(e),this.calculatedScrollbarWidth=i,i}static invokeElementMethod(e,i,r){e[i].apply(e,r)}static clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}}static getBrowser(){if(!this.browser){let e=this.resolveUserAgent();this.browser={},e.browser&&(this.browser[e.browser]=!0,this.browser.version=e.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser}static resolveUserAgent(){let e=navigator.userAgent.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:i[1]||"",version:i[2]||"0"}}static isInteger(e){return Number.isInteger?Number.isInteger(e):"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}static isHidden(e){return!e||null===e.offsetParent}static isVisible(e){return e&&null!=e.offsetParent}static isExist(e){return null!==e&&typeof e<"u"&&e.nodeName&&e.parentNode}static focus(e,i){e&&document.activeElement!==e&&e.focus(i)}static getFocusableElements(e){let i=n.find(e,'button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]):not(.p-disabled)'),r=[];for(let a of i)(a.offsetWidth||a.offsetHeight||a.getClientRects().length)&&r.push(a);return r}static getNextFocusableElement(e,i=!1){const r=n.getFocusableElements(e);let a=0;if(r&&r.length>0){const g=r.indexOf(r[0].ownerDocument.activeElement);i?a=-1==g||0===g?r.length-1:g-1:-1!=g&&g!==r.length-1&&(a=g+1)}return r[a]}static generateZIndex(){return this.zindex=this.zindex||999,++this.zindex}static getSelection(){return window.getSelection?window.getSelection().toString():document.getSelection?document.getSelection().toString():document.selection?document.selection.createRange().text:null}static getTargetElement(e,i){if(!e)return null;switch(e){case"document":return document;case"window":return window;case"@next":return i?.nextElementSibling;case"@prev":return i?.previousElementSibling;case"@parent":return i?.parentElement;case"@grandparent":return i?.parentElement.parentElement;default:const r=typeof e;if("string"===r)return document.querySelector(e);if("object"===r&&e.hasOwnProperty("nativeElement"))return this.isExist(e.nativeElement)?e.nativeElement:void 0;const g=(E=e)&&E.constructor&&E.call&&E.apply?e():e;return g&&9===g.nodeType||this.isExist(g)?g:null}var E}}return n.zindex=1e3,n.calculatedScrollbarWidth=null,n.calculatedScrollbarHeight=null,n})();class yF{constructor(t,e=(()=>{})){this.element=t,this.listener=e}bindScrollListener(){this.scrollableParents=pt.getScrollableParents(this.element);for(let t=0;t<this.scrollableParents.length;t++)this.scrollableParents[t].addEventListener("scroll",this.listener)}unbindScrollListener(){if(this.scrollableParents)for(let t=0;t<this.scrollableParents.length;t++)this.scrollableParents[t].removeEventListener("scroll",this.listener)}destroy(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}}let cw=(()=>{class n{constructor(e,i,r){this.el=e,this.zone=i,this.config=r}ngAfterViewInit(){this.config&&this.config.ripple&&this.zone.runOutsideAngular(()=>{this.create(),this.mouseDownListener=this.onMouseDown.bind(this),this.el.nativeElement.addEventListener("mousedown",this.mouseDownListener)})}onMouseDown(e){let i=this.getInk();if(!i||"none"===getComputedStyle(i,null).display)return;if(pt.removeClass(i,"p-ink-active"),!pt.getHeight(i)&&!pt.getWidth(i)){let E=Math.max(pt.getOuterWidth(this.el.nativeElement),pt.getOuterHeight(this.el.nativeElement));i.style.height=E+"px",i.style.width=E+"px"}let r=pt.getOffset(this.el.nativeElement),a=e.pageX-r.left+document.body.scrollTop-pt.getWidth(i)/2,g=e.pageY-r.top+document.body.scrollLeft-pt.getHeight(i)/2;i.style.top=g+"px",i.style.left=a+"px",pt.addClass(i,"p-ink-active"),this.timeout=setTimeout(()=>{let E=this.getInk();E&&pt.removeClass(E,"p-ink-active")},401)}getInk(){const e=this.el.nativeElement.children;for(let i=0;i<e.length;i++)if("string"==typeof e[i].className&&-1!==e[i].className.indexOf("p-ink"))return e[i];return null}resetInk(){let e=this.getInk();e&&pt.removeClass(e,"p-ink-active")}onAnimationEnd(e){this.timeout&&clearTimeout(this.timeout),pt.removeClass(e.currentTarget,"p-ink-active")}create(){let e=document.createElement("span");e.className="p-ink",this.el.nativeElement.appendChild(e),this.animationListener=this.onAnimationEnd.bind(this),e.addEventListener("animationend",this.animationListener)}remove(){let e=this.getInk();e&&(this.el.nativeElement.removeEventListener("mousedown",this.mouseDownListener),e.removeEventListener("animationend",this.animationListener),pt.removeElement(e))}ngOnDestroy(){this.config&&this.config.ripple&&this.remove()}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.SBq),o.Y36(o.R0b),o.Y36(lw,8))},n.\u0275dir=o.lG2({type:n,selectors:[["","pRipple",""]],hostAttrs:[1,"p-ripple","p-element"]}),n})(),uw=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr]}),n})();function XQ(n,t){1&n&&o.GkF(0)}const eX=function(n,t,e,i){return{"p-button-icon":!0,"p-button-icon-left":n,"p-button-icon-right":t,"p-button-icon-top":e,"p-button-icon-bottom":i}};function tX(n,t){if(1&n&&o._UZ(0,"span",4),2&n){const e=o.oxw();o.Tol(e.loading?"p-button-loading-icon "+e.loadingIcon:e.icon),o.Q6J("ngClass",o.l5B(4,eX,"left"===e.iconPos&&e.label,"right"===e.iconPos&&e.label,"top"===e.iconPos&&e.label,"bottom"===e.iconPos&&e.label)),o.uIk("aria-hidden",!0)}}function nX(n,t){if(1&n&&(o.TgZ(0,"span",5),o._uU(1),o.qZA()),2&n){const e=o.oxw();o.uIk("aria-hidden",e.icon&&!e.label),o.xp6(1),o.Oqu(e.label)}}function iX(n,t){if(1&n&&(o.TgZ(0,"span",4),o._uU(1),o.qZA()),2&n){const e=o.oxw();o.Tol(e.badgeClass),o.Q6J("ngClass",e.badgeStyleClass()),o.xp6(1),o.Oqu(e.badge)}}const rX=function(n,t,e,i,r){return{"p-button p-component":!0,"p-button-icon-only":n,"p-button-vertical":t,"p-disabled":e,"p-button-loading":i,"p-button-loading-label-only":r}},oX=["*"],hw={button:"p-button",component:"p-component",iconOnly:"p-button-icon-only",disabled:"p-disabled",loading:"p-button-loading",labelOnly:"p-button-loading-label-only"};let vF=(()=>{class n{constructor(e){this.el=e,this.iconPos="left",this.loadingIcon="pi pi-spinner pi-spin",this._loading=!1,this._internalClasses=Object.values(hw)}get label(){return this._label}set label(e){this._label=e,this.initialized&&(this.updateLabel(),this.updateIcon(),this.setStyleClass())}get icon(){return this._icon}set icon(e){this._icon=e,this.initialized&&(this.updateIcon(),this.setStyleClass())}get loading(){return this._loading}set loading(e){this._loading=e,this.initialized&&(this.updateIcon(),this.setStyleClass())}get htmlElement(){return this.el.nativeElement}ngAfterViewInit(){pt.addMultipleClasses(this.htmlElement,this.getStyleClass().join(" ")),this.createIcon(),this.createLabel(),this.initialized=!0}getStyleClass(){const e=[hw.button,hw.component];return this.icon&&!this.label&&ti.isEmpty(this.htmlElement.textContent)&&e.push(hw.iconOnly),this.loading&&(e.push(hw.disabled,hw.loading),!this.icon&&this.label&&e.push(hw.labelOnly)),e}setStyleClass(){const e=this.getStyleClass();this.htmlElement.classList.remove(...this._internalClasses),this.htmlElement.classList.add(...e)}createLabel(){if(this.label){let e=document.createElement("span");this.icon&&!this.label&&e.setAttribute("aria-hidden","true"),e.className="p-button-label",e.appendChild(document.createTextNode(this.label)),this.htmlElement.appendChild(e)}}createIcon(){if(this.icon||this.loading){let e=document.createElement("span");e.className="p-button-icon",e.setAttribute("aria-hidden","true");let i=this.label?"p-button-icon-"+this.iconPos:null;i&&pt.addClass(e,i);let r=this.getIconClass();r&&pt.addMultipleClasses(e,r),this.htmlElement.insertBefore(e,this.htmlElement.firstChild)}}updateLabel(){let e=pt.findSingle(this.htmlElement,".p-button-label");this.label?e?e.textContent=this.label:this.createLabel():e&&this.htmlElement.removeChild(e)}updateIcon(){let e=pt.findSingle(this.htmlElement,".p-button-icon");this.icon||this.loading?e?e.className=this.iconPos?"p-button-icon p-button-icon-"+this.iconPos+" "+this.getIconClass():"p-button-icon "+this.getIconClass():this.createIcon():e&&this.htmlElement.removeChild(e)}getIconClass(){return this.loading?"p-button-loading-icon "+this.loadingIcon:this._icon}ngOnDestroy(){this.initialized=!1}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.SBq))},n.\u0275dir=o.lG2({type:n,selectors:[["","pButton",""]],hostAttrs:[1,"p-element"],inputs:{iconPos:"iconPos",loadingIcon:"loadingIcon",label:"label",icon:"icon",loading:"loading"}}),n})(),sX=(()=>{class n{constructor(){this.type="button",this.iconPos="left",this.loading=!1,this.loadingIcon="pi pi-spinner pi-spin",this.onClick=new o.vpe,this.onFocus=new o.vpe,this.onBlur=new o.vpe}ngAfterContentInit(){this.templates.forEach(e=>{e.getType(),this.contentTemplate=e.template})}badgeStyleClass(){return{"p-badge p-component":!0,"p-badge-no-gutter":this.badge&&1===String(this.badge).length}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=o.Xpm({type:n,selectors:[["p-button"]],contentQueries:function(e,i,r){if(1&e&&o.Suo(r,bp,4),2&e){let a;o.iGM(a=o.CRH())&&(i.templates=a)}},hostAttrs:[1,"p-element"],inputs:{type:"type",iconPos:"iconPos",icon:"icon",badge:"badge",label:"label",disabled:"disabled",loading:"loading",loadingIcon:"loadingIcon",style:"style",styleClass:"styleClass",badgeClass:"badgeClass",ariaLabel:"ariaLabel"},outputs:{onClick:"onClick",onFocus:"onFocus",onBlur:"onBlur"},ngContentSelectors:oX,decls:6,vars:17,consts:[["pRipple","",3,"ngStyle","disabled","ngClass","click","focus","blur"],[4,"ngTemplateOutlet"],[3,"ngClass","class",4,"ngIf"],["class","p-button-label",4,"ngIf"],[3,"ngClass"],[1,"p-button-label"]],template:function(e,i){1&e&&(o.F$t(),o.TgZ(0,"button",0),o.NdJ("click",function(a){return i.onClick.emit(a)})("focus",function(a){return i.onFocus.emit(a)})("blur",function(a){return i.onBlur.emit(a)}),o.Hsn(1),o.YNc(2,XQ,1,0,"ng-container",1),o.YNc(3,tX,1,9,"span",2),o.YNc(4,nX,2,2,"span",3),o.YNc(5,iX,2,4,"span",2),o.qZA()),2&e&&(o.Tol(i.styleClass),o.Q6J("ngStyle",i.style)("disabled",i.disabled||i.loading)("ngClass",o.qbA(11,rX,i.icon&&!i.label,("top"===i.iconPos||"bottom"===i.iconPos)&&i.label,i.disabled||i.loading,i.loading,i.loading&&!i.icon&&i.label)),o.uIk("type",i.type)("aria-label",i.ariaLabel),o.xp6(2),o.Q6J("ngTemplateOutlet",i.contentTemplate),o.xp6(1),o.Q6J("ngIf",!i.contentTemplate&&(i.icon||i.loading)),o.xp6(1),o.Q6J("ngIf",!i.contentTemplate&&i.label),o.xp6(1),o.Q6J("ngIf",!i.contentTemplate&&i.badge))},dependencies:[Pi,Zn,Ki,qr,cw],encapsulation:2,changeDetection:0}),n})(),dw=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr,uw]}),n})(),aX=(()=>{class n{constructor(e){this.el=e}onkeydown(e){if(!0!==this.pFocusTrapDisabled){e.preventDefault();const i=pt.getNextFocusableElement(this.el.nativeElement,e.shiftKey);i&&(i.focus(),i.select?.())}}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.SBq))},n.\u0275dir=o.lG2({type:n,selectors:[["","pFocusTrap",""]],hostAttrs:[1,"p-element"],hostBindings:function(e,i){1&e&&o.NdJ("keydown.tab",function(a){return i.onkeydown(a)})("keydown.shift.tab",function(a){return i.onkeydown(a)})},inputs:{pFocusTrapDisabled:"pFocusTrapDisabled"}}),n})(),lX=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr]}),n})();const cX=["titlebar"],uX=["content"],hX=["footer"];function dX(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",11),o.NdJ("mousedown",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.initResize(r))}),o.qZA()}}function pX(n,t){if(1&n&&(o.TgZ(0,"span",18),o._uU(1),o.qZA()),2&n){const e=o.oxw(4);o.uIk("id",e.id+"-label"),o.xp6(1),o.Oqu(e.header)}}function fX(n,t){if(1&n&&(o.TgZ(0,"span",18),o.Hsn(1,1),o.qZA()),2&n){const e=o.oxw(4);o.uIk("id",e.id+"-label")}}function mX(n,t){1&n&&o.GkF(0)}const gX=function(){return{"p-dialog-header-icon p-dialog-header-maximize p-link":!0}};function _X(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"button",19),o.NdJ("click",function(){o.CHM(e);const r=o.oxw(4);return o.KtG(r.maximize())})("keydown.enter",function(){o.CHM(e);const r=o.oxw(4);return o.KtG(r.maximize())}),o._UZ(1,"span",20),o.qZA()}if(2&n){const e=o.oxw(4);o.Q6J("ngClass",o.DdM(2,gX)),o.xp6(1),o.Q6J("ngClass",e.maximized?e.minimizeIcon:e.maximizeIcon)}}const yX=function(){return{"p-dialog-header-icon p-dialog-header-close p-link":!0}};function vX(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"button",21),o.NdJ("click",function(r){o.CHM(e);const a=o.oxw(4);return o.KtG(a.close(r))})("keydown.enter",function(r){o.CHM(e);const a=o.oxw(4);return o.KtG(a.close(r))}),o._UZ(1,"span",22),o.qZA()}if(2&n){const e=o.oxw(4);o.Q6J("ngClass",o.DdM(4,yX)),o.uIk("aria-label",e.closeAriaLabel)("tabindex",e.closeTabindex),o.xp6(1),o.Q6J("ngClass",e.closeIcon)}}function bX(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",12,13),o.NdJ("mousedown",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.initDrag(r))}),o.YNc(2,pX,2,2,"span",14),o.YNc(3,fX,2,1,"span",14),o.YNc(4,mX,1,0,"ng-container",9),o.TgZ(5,"div",15),o.YNc(6,_X,2,3,"button",16),o.YNc(7,vX,2,5,"button",17),o.qZA()()}if(2&n){const e=o.oxw(3);o.xp6(2),o.Q6J("ngIf",!e.headerFacet&&!e.headerTemplate),o.xp6(1),o.Q6J("ngIf",e.headerFacet),o.xp6(1),o.Q6J("ngTemplateOutlet",e.headerTemplate),o.xp6(2),o.Q6J("ngIf",e.maximizable),o.xp6(1),o.Q6J("ngIf",e.closable)}}function wX(n,t){1&n&&o.GkF(0)}function xX(n,t){1&n&&o.GkF(0)}function CX(n,t){if(1&n&&(o.TgZ(0,"div",23,24),o.Hsn(2,2),o.YNc(3,xX,1,0,"ng-container",9),o.qZA()),2&n){const e=o.oxw(3);o.xp6(3),o.Q6J("ngTemplateOutlet",e.footerTemplate)}}const EX=function(n,t,e,i){return{"p-dialog p-component":!0,"p-dialog-rtl":n,"p-dialog-draggable":t,"p-dialog-resizable":e,"p-dialog-maximized":i}},TX=function(n,t){return{transform:n,transition:t}},SX=function(n){return{value:"visible",params:n}};function IX(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",3,4),o.NdJ("@animation.start",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onAnimationStart(r))})("@animation.done",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onAnimationEnd(r))}),o.YNc(2,dX,1,0,"div",5),o.YNc(3,bX,8,5,"div",6),o.TgZ(4,"div",7,8),o.Hsn(6),o.YNc(7,wX,1,0,"ng-container",9),o.qZA(),o.YNc(8,CX,4,1,"div",10),o.qZA()}if(2&n){const e=o.oxw(2);o.Tol(e.styleClass),o.Q6J("ngClass",o.l5B(15,EX,e.rtl,e.draggable,e.resizable,e.maximized))("ngStyle",e.style)("pFocusTrapDisabled",!1===e.focusTrap)("@animation",o.VKq(23,SX,o.WLB(20,TX,e.transformOptions,e.transitionOptions))),o.uIk("aria-labelledby",e.id+"-label"),o.xp6(2),o.Q6J("ngIf",e.resizable),o.xp6(1),o.Q6J("ngIf",e.showHeader),o.xp6(1),o.Tol(e.contentStyleClass),o.Q6J("ngClass","p-dialog-content")("ngStyle",e.contentStyle),o.xp6(3),o.Q6J("ngTemplateOutlet",e.contentTemplate),o.xp6(1),o.Q6J("ngIf",e.footerFacet||e.footerTemplate)}}const DX=function(n,t,e,i,r,a,g,E,O,j){return{"p-dialog-mask":!0,"p-component-overlay p-component-overlay-enter":n,"p-dialog-mask-scrollblocker":t,"p-dialog-left":e,"p-dialog-right":i,"p-dialog-top":r,"p-dialog-top-left":a,"p-dialog-top-right":g,"p-dialog-bottom":E,"p-dialog-bottom-left":O,"p-dialog-bottom-right":j}};function AX(n,t){if(1&n&&(o.TgZ(0,"div",1),o.YNc(1,IX,9,25,"div",2),o.qZA()),2&n){const e=o.oxw();o.Tol(e.maskStyleClass),o.Q6J("ngClass",o.rFY(4,DX,[e.modal,e.modal||e.blockScroll,"left"===e.position,"right"===e.position,"top"===e.position,"topleft"===e.position||"top-left"===e.position,"topright"===e.position||"top-right"===e.position,"bottom"===e.position,"bottomleft"===e.position||"bottom-left"===e.position,"bottomright"===e.position||"bottom-right"===e.position])),o.xp6(1),o.Q6J("ngIf",e.visible)}}const MX=["*",[["p-header"]],[["p-footer"]]],kX=["*","p-header","p-footer"],RX=Ay([Ti({transform:"{{transform}}",opacity:0}),ih("{{transition}}")]),PX=Ay([ih("{{transition}}",Ti({transform:"{{transform}}",opacity:0}))]);let OX=(()=>{class n{constructor(e,i,r,a,g){this.el=e,this.renderer=i,this.zone=r,this.cd=a,this.config=g,this.draggable=!0,this.resizable=!0,this.closeOnEscape=!0,this.closable=!0,this.showHeader=!0,this.blockScroll=!1,this.autoZIndex=!0,this.baseZIndex=0,this.minX=0,this.minY=0,this.focusOnShow=!0,this.keepInViewport=!0,this.focusTrap=!0,this.transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)",this.closeIcon="pi pi-times",this.closeTabindex="-1",this.minimizeIcon="pi pi-window-minimize",this.maximizeIcon="pi pi-window-maximize",this.onShow=new o.vpe,this.onHide=new o.vpe,this.visibleChange=new o.vpe,this.onResizeInit=new o.vpe,this.onResizeEnd=new o.vpe,this.onDragEnd=new o.vpe,this.onMaximize=new o.vpe,this.id=YS(),this._style={},this._position="center",this.transformOptions="scale(0.7)"}get positionLeft(){return 0}set positionLeft(e){console.log("positionLeft property is deprecated.")}get positionTop(){return 0}set positionTop(e){console.log("positionTop property is deprecated.")}get responsive(){return!1}set responsive(e){console.log("Responsive property is deprecated.")}get breakpoint(){return 649}set breakpoint(e){console.log("Breakpoint property is not utilized and deprecated, use breakpoints or CSS media queries instead.")}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"header":this.headerTemplate=e.template;break;case"content":default:this.contentTemplate=e.template;break;case"footer":this.footerTemplate=e.template}})}ngOnInit(){this.breakpoints&&this.createStyle()}get visible(){return this._visible}set visible(e){this._visible=e,this._visible&&!this.maskVisible&&(this.maskVisible=!0)}get style(){return this._style}set style(e){e&&(this._style={...e},this.originalStyle=e)}get position(){return this._position}set position(e){switch(this._position=e,e){case"topleft":case"bottomleft":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"topright":case"bottomright":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)"}}focus(){let e=pt.findSingle(this.container,"[autofocus]");e&&this.zone.runOutsideAngular(()=>{setTimeout(()=>e.focus(),5)})}close(e){this.visibleChange.emit(!1),e.preventDefault()}enableModality(){this.closable&&this.dismissableMask&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",e=>{this.wrapper&&this.wrapper.isSameNode(e.target)&&this.close(e)})),this.modal&&pt.addClass(document.body,"p-overflow-hidden")}disableModality(){this.wrapper&&(this.dismissableMask&&this.unbindMaskClickListener(),this.modal&&pt.removeClass(document.body,"p-overflow-hidden"),this.cd.destroyed||this.cd.detectChanges())}maximize(){this.maximized=!this.maximized,!this.modal&&!this.blockScroll&&(this.maximized?pt.addClass(document.body,"p-overflow-hidden"):pt.removeClass(document.body,"p-overflow-hidden")),this.onMaximize.emit({maximized:this.maximized})}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}moveOnTop(){this.autoZIndex&&(_f.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}createStyle(){if(!this.styleElement){this.styleElement=document.createElement("style"),this.styleElement.type="text/css",document.head.appendChild(this.styleElement);let e="";for(let i in this.breakpoints)e+=`\n                    @media screen and (max-width: ${i}) {\n                        .p-dialog[${this.id}] {\n                            width: ${this.breakpoints[i]} !important;\n                        }\n                    }\n                `;this.styleElement.innerHTML=e}}initDrag(e){pt.hasClass(e.target,"p-dialog-header-icon")||pt.hasClass(e.target.parentElement,"p-dialog-header-icon")||this.draggable&&(this.dragging=!0,this.lastPageX=e.pageX,this.lastPageY=e.pageY,this.container.style.margin="0",pt.addClass(document.body,"p-unselectable-text"))}onKeydown(e){if(this.focusTrap&&9===e.which){e.preventDefault();let i=pt.getFocusableElements(this.container);if(i&&i.length>0)if(i[0].ownerDocument.activeElement){let r=i.indexOf(i[0].ownerDocument.activeElement);e.shiftKey?-1==r||0===r?i[i.length-1].focus():i[r-1].focus():-1==r||r===i.length-1?i[0].focus():i[r+1].focus()}else i[0].focus()}}onDrag(e){if(this.dragging){let i=pt.getOuterWidth(this.container),r=pt.getOuterHeight(this.container),a=e.pageX-this.lastPageX,g=e.pageY-this.lastPageY,E=this.container.getBoundingClientRect(),O=E.left+a,j=E.top+g,Y=pt.getViewport();this.container.style.position="fixed",this.keepInViewport?(O>=this.minX&&O+i<Y.width&&(this._style.left=O+"px",this.lastPageX=e.pageX,this.container.style.left=O+"px"),j>=this.minY&&j+r<Y.height&&(this._style.top=j+"px",this.lastPageY=e.pageY,this.container.style.top=j+"px")):(this.lastPageX=e.pageX,this.container.style.left=O+"px",this.lastPageY=e.pageY,this.container.style.top=j+"px")}}endDrag(e){this.dragging&&(this.dragging=!1,pt.removeClass(document.body,"p-unselectable-text"),this.cd.detectChanges(),this.onDragEnd.emit(e))}resetPosition(){this.container.style.position="",this.container.style.left="",this.container.style.top="",this.container.style.margin=""}center(){this.resetPosition()}initResize(e){this.resizable&&(this.resizing=!0,this.lastPageX=e.pageX,this.lastPageY=e.pageY,pt.addClass(document.body,"p-unselectable-text"),this.onResizeInit.emit(e))}onResize(e){if(this.resizing){let i=e.pageX-this.lastPageX,r=e.pageY-this.lastPageY,a=pt.getOuterWidth(this.container),g=pt.getOuterHeight(this.container),E=pt.getOuterHeight(this.contentViewChild.nativeElement),O=a+i,j=g+r,Y=this.container.style.minWidth,se=this.container.style.minHeight,be=this.container.getBoundingClientRect(),Me=pt.getViewport();(!parseInt(this.container.style.top)||!parseInt(this.container.style.left))&&(O+=i,j+=r),(!Y||O>parseInt(Y))&&be.left+O<Me.width&&(this._style.width=O+"px",this.container.style.width=this._style.width),(!se||j>parseInt(se))&&be.top+j<Me.height&&(this.contentViewChild.nativeElement.style.height=E+j-g+"px",this._style.height&&(this._style.height=j+"px",this.container.style.height=this._style.height)),this.lastPageX=e.pageX,this.lastPageY=e.pageY}}resizeEnd(e){this.resizing&&(this.resizing=!1,pt.removeClass(document.body,"p-unselectable-text"),this.onResizeEnd.emit(e))}bindGlobalListeners(){this.draggable&&(this.bindDocumentDragListener(),this.bindDocumentDragEndListener()),this.resizable&&this.bindDocumentResizeListeners(),this.closeOnEscape&&this.closable&&this.bindDocumentEscapeListener()}unbindGlobalListeners(){this.unbindDocumentDragListener(),this.unbindDocumentDragEndListener(),this.unbindDocumentResizeListeners(),this.unbindDocumentEscapeListener()}bindDocumentDragListener(){this.zone.runOutsideAngular(()=>{this.documentDragListener=this.onDrag.bind(this),window.document.addEventListener("mousemove",this.documentDragListener)})}unbindDocumentDragListener(){this.documentDragListener&&(window.document.removeEventListener("mousemove",this.documentDragListener),this.documentDragListener=null)}bindDocumentDragEndListener(){this.zone.runOutsideAngular(()=>{this.documentDragEndListener=this.endDrag.bind(this),window.document.addEventListener("mouseup",this.documentDragEndListener)})}unbindDocumentDragEndListener(){this.documentDragEndListener&&(window.document.removeEventListener("mouseup",this.documentDragEndListener),this.documentDragEndListener=null)}bindDocumentResizeListeners(){this.zone.runOutsideAngular(()=>{this.documentResizeListener=this.onResize.bind(this),this.documentResizeEndListener=this.resizeEnd.bind(this),window.document.addEventListener("mousemove",this.documentResizeListener),window.document.addEventListener("mouseup",this.documentResizeEndListener)})}unbindDocumentResizeListeners(){this.documentResizeListener&&this.documentResizeEndListener&&(window.document.removeEventListener("mousemove",this.documentResizeListener),window.document.removeEventListener("mouseup",this.documentResizeEndListener),this.documentResizeListener=null,this.documentResizeEndListener=null)}bindDocumentEscapeListener(){this.documentEscapeListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","keydown",i=>{27==i.which&&this.close(i)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}appendContainer(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.wrapper):pt.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.container&&this.appendTo&&this.el.nativeElement.appendChild(this.wrapper)}onAnimationStart(e){switch(e.toState){case"visible":this.container=e.element,this.wrapper=this.container.parentElement,this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.container.setAttribute(this.id,""),this.modal&&this.enableModality(),!this.modal&&this.blockScroll&&pt.addClass(document.body,"p-overflow-hidden"),this.focusOnShow&&this.focus();break;case"void":this.wrapper&&this.modal&&pt.addClass(this.wrapper,"p-component-overlay-leave")}}onAnimationEnd(e){switch(e.toState){case"void":this.onContainerDestroy(),this.onHide.emit({}),this.cd.markForCheck();break;case"visible":this.onShow.emit({})}}onContainerDestroy(){this.unbindGlobalListeners(),this.dragging=!1,this.maskVisible=!1,this.maximized&&(pt.removeClass(document.body,"p-overflow-hidden"),this.maximized=!1),this.modal&&this.disableModality(),this.blockScroll&&pt.removeClass(document.body,"p-overflow-hidden"),this.container&&this.autoZIndex&&_f.clear(this.container),this.container=null,this.wrapper=null,this._style=this.originalStyle?{...this.originalStyle}:{}}destroyStyle(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)}ngOnDestroy(){this.container&&(this.restoreAppend(),this.onContainerDestroy()),this.destroyStyle()}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.SBq),o.Y36(o.Qsj),o.Y36(o.R0b),o.Y36(o.sBO),o.Y36(lw))},n.\u0275cmp=o.Xpm({type:n,selectors:[["p-dialog"]],contentQueries:function(e,i,r){if(1&e&&(o.Suo(r,JQ,5),o.Suo(r,QQ,5),o.Suo(r,bp,4)),2&e){let a;o.iGM(a=o.CRH())&&(i.headerFacet=a.first),o.iGM(a=o.CRH())&&(i.footerFacet=a.first),o.iGM(a=o.CRH())&&(i.templates=a)}},viewQuery:function(e,i){if(1&e&&(o.Gf(cX,5),o.Gf(uX,5),o.Gf(hX,5)),2&e){let r;o.iGM(r=o.CRH())&&(i.headerViewChild=r.first),o.iGM(r=o.CRH())&&(i.contentViewChild=r.first),o.iGM(r=o.CRH())&&(i.footerViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{header:"header",draggable:"draggable",resizable:"resizable",positionLeft:"positionLeft",positionTop:"positionTop",contentStyle:"contentStyle",contentStyleClass:"contentStyleClass",modal:"modal",closeOnEscape:"closeOnEscape",dismissableMask:"dismissableMask",rtl:"rtl",closable:"closable",responsive:"responsive",appendTo:"appendTo",breakpoints:"breakpoints",styleClass:"styleClass",maskStyleClass:"maskStyleClass",showHeader:"showHeader",breakpoint:"breakpoint",blockScroll:"blockScroll",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",minX:"minX",minY:"minY",focusOnShow:"focusOnShow",maximizable:"maximizable",keepInViewport:"keepInViewport",focusTrap:"focusTrap",transitionOptions:"transitionOptions",closeIcon:"closeIcon",closeAriaLabel:"closeAriaLabel",closeTabindex:"closeTabindex",minimizeIcon:"minimizeIcon",maximizeIcon:"maximizeIcon",visible:"visible",style:"style",position:"position"},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange",onResizeInit:"onResizeInit",onResizeEnd:"onResizeEnd",onDragEnd:"onDragEnd",onMaximize:"onMaximize"},ngContentSelectors:kX,decls:1,vars:1,consts:[[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","class","pFocusTrapDisabled",4,"ngIf"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","pFocusTrapDisabled"],["container",""],["class","p-resizable-handle","style","z-index: 90;",3,"mousedown",4,"ngIf"],["class","p-dialog-header",3,"mousedown",4,"ngIf"],[3,"ngClass","ngStyle"],["content",""],[4,"ngTemplateOutlet"],["class","p-dialog-footer",4,"ngIf"],[1,"p-resizable-handle",2,"z-index","90",3,"mousedown"],[1,"p-dialog-header",3,"mousedown"],["titlebar",""],["class","p-dialog-title",4,"ngIf"],[1,"p-dialog-header-icons"],["type","button","tabindex","-1","pRipple","",3,"ngClass","click","keydown.enter",4,"ngIf"],["type","button","pRipple","",3,"ngClass","click","keydown.enter",4,"ngIf"],[1,"p-dialog-title"],["type","button","tabindex","-1","pRipple","",3,"ngClass","click","keydown.enter"],[1,"p-dialog-header-maximize-icon",3,"ngClass"],["type","button","pRipple","",3,"ngClass","click","keydown.enter"],[1,"p-dialog-header-close-icon",3,"ngClass"],[1,"p-dialog-footer"],["footer",""]],template:function(e,i){1&e&&(o.F$t(MX),o.YNc(0,AX,2,15,"div",0)),2&e&&o.Q6J("ngIf",i.maskVisible)},dependencies:[Pi,Zn,Ki,qr,aX,cw],styles:[".p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translateZ(0)}.p-dialog-maximized{transition:none;transform:none;width:100vw!important;height:100vh!important;top:0!important;left:0!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}\n"],encapsulation:2,data:{animation:[l_("animation",[Ph("void => visible",[u_(RX)]),Ph("visible => void",[u_(PX)])])]},changeDetection:0}),n})(),j4=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr,lX,uw,yf]}),n})();const LX=["container"],FX=["inputfield"],NX=["contentWrapper"];function zX(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"i",8),o.NdJ("click",function(){o.CHM(e);const r=o.oxw(2);return o.KtG(r.clear())}),o.qZA()}}function BX(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"button",9),o.NdJ("click",function(r){o.CHM(e),o.oxw();const a=o.MAs(1),g=o.oxw();return o.KtG(g.onButtonClick(r,a))}),o.qZA()}if(2&n){const e=o.oxw(2);o.Q6J("icon",e.icon)("disabled",e.disabled),o.uIk("aria-label",e.iconAriaLabel)}}function VX(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"input",4,5),o.NdJ("focus",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onInputFocus(r))})("keydown",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onInputKeydown(r))})("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.onInputClick())})("blur",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onInputBlur(r))})("input",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onUserInput(r))}),o.qZA(),o.YNc(2,zX,1,0,"i",6),o.YNc(3,BX,1,3,"button",7)}if(2&n){const e=o.oxw();o.Tol(e.inputStyleClass),o.Q6J("value",e.inputFieldValue)("readonly",e.readonlyInput)("ngStyle",e.inputStyle)("placeholder",e.placeholder||"")("disabled",e.disabled)("ngClass","p-inputtext p-component"),o.uIk("id",e.inputId)("name",e.name)("required",e.required)("aria-required",e.required)("tabindex",e.tabindex)("inputmode",e.touchUI?"off":null)("aria-labelledby",e.ariaLabelledBy),o.xp6(2),o.Q6J("ngIf",e.showClear&&!e.disabled&&null!=e.value),o.xp6(1),o.Q6J("ngIf",e.showIcon)}}function UX(n,t){1&n&&o.GkF(0)}function HX(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"button",30),o.NdJ("keydown",function(r){o.CHM(e);const a=o.oxw(4);return o.KtG(a.onContainerButtonKeydown(r))})("click",function(r){o.CHM(e);const a=o.oxw(4);return o.KtG(a.onPrevButtonClick(r))}),o._UZ(1,"span",31),o.qZA()}}function jX(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"button",32),o.NdJ("click",function(r){o.CHM(e);const a=o.oxw(4);return o.KtG(a.switchToMonthView(r))})("keydown",function(r){o.CHM(e);const a=o.oxw(4);return o.KtG(a.onContainerButtonKeydown(r))}),o._uU(1),o.qZA()}if(2&n){const e=o.oxw().$implicit,i=o.oxw(3);o.Q6J("disabled",i.switchViewButtonDisabled()),o.xp6(1),o.hij(" ",i.getMonthName(e.month)," ")}}function GX(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"button",33),o.NdJ("click",function(r){o.CHM(e);const a=o.oxw(4);return o.KtG(a.switchToYearView(r))})("keydown",function(r){o.CHM(e);const a=o.oxw(4);return o.KtG(a.onContainerButtonKeydown(r))}),o._uU(1),o.qZA()}if(2&n){const e=o.oxw().$implicit,i=o.oxw(3);o.Q6J("disabled",i.switchViewButtonDisabled()),o.xp6(1),o.hij(" ",i.getYear(e)," ")}}function $X(n,t){if(1&n&&(o.ynx(0),o._uU(1),o.BQk()),2&n){const e=o.oxw(5);o.xp6(1),o.AsE("",e.yearPickerValues()[0]," - ",e.yearPickerValues()[e.yearPickerValues().length-1],"")}}function WX(n,t){1&n&&o.GkF(0)}const G4=function(n){return{$implicit:n}};function ZX(n,t){if(1&n&&(o.TgZ(0,"span",34),o.YNc(1,$X,2,2,"ng-container",13),o.YNc(2,WX,1,0,"ng-container",35),o.qZA()),2&n){const e=o.oxw(4);o.xp6(1),o.Q6J("ngIf",!e.decadeTemplate),o.xp6(1),o.Q6J("ngTemplateOutlet",e.decadeTemplate)("ngTemplateOutletContext",o.VKq(3,G4,e.yearPickerValues))}}function qX(n,t){if(1&n&&(o.TgZ(0,"th",41)(1,"span"),o._uU(2),o.qZA()()),2&n){const e=o.oxw(5);o.xp6(2),o.Oqu(e.getTranslation("weekHeader"))}}function KX(n,t){if(1&n&&(o.TgZ(0,"th",42)(1,"span"),o._uU(2),o.qZA()()),2&n){const e=t.$implicit;o.xp6(2),o.Oqu(e)}}function YX(n,t){if(1&n&&(o.TgZ(0,"td",45)(1,"span",46),o._uU(2),o.qZA()()),2&n){const e=o.oxw().index,i=o.oxw(2).$implicit;o.xp6(2),o.hij(" ",i.weekNumbers[e]," ")}}function JX(n,t){if(1&n&&(o.ynx(0),o._uU(1),o.BQk()),2&n){const e=o.oxw(2).$implicit;o.xp6(1),o.Oqu(e.day)}}function QX(n,t){1&n&&o.GkF(0)}const $4=function(n,t){return{"p-highlight":n,"p-disabled":t}};function XX(n,t){if(1&n){const e=o.EpF();o.ynx(0),o.TgZ(1,"span",48),o.NdJ("click",function(r){o.CHM(e);const a=o.oxw().$implicit,g=o.oxw(6);return o.KtG(g.onDateSelect(r,a))})("keydown",function(r){o.CHM(e);const a=o.oxw().$implicit,g=o.oxw(3).index,E=o.oxw(3);return o.KtG(E.onDateCellKeydown(r,a,g))}),o.YNc(2,JX,2,1,"ng-container",13),o.YNc(3,QX,1,0,"ng-container",35),o.qZA(),o.BQk()}if(2&n){const e=o.oxw().$implicit,i=o.oxw(6);o.xp6(1),o.Q6J("ngClass",o.WLB(4,$4,i.isSelected(e),!e.selectable)),o.xp6(1),o.Q6J("ngIf",!i.dateTemplate),o.xp6(1),o.Q6J("ngTemplateOutlet",i.dateTemplate)("ngTemplateOutletContext",o.VKq(7,G4,e))}}const eee=function(n,t){return{"p-datepicker-other-month":n,"p-datepicker-today":t}};function tee(n,t){if(1&n&&(o.TgZ(0,"td",47),o.YNc(1,XX,4,9,"ng-container",13),o.qZA()),2&n){const e=t.$implicit,i=o.oxw(6);o.Q6J("ngClass",o.WLB(2,eee,e.otherMonth,e.today)),o.xp6(1),o.Q6J("ngIf",!e.otherMonth||i.showOtherMonths)}}function nee(n,t){if(1&n&&(o.TgZ(0,"tr"),o.YNc(1,YX,3,1,"td",43),o.YNc(2,tee,2,5,"td",44),o.qZA()),2&n){const e=t.$implicit,i=o.oxw(5);o.xp6(1),o.Q6J("ngIf",i.showWeek),o.xp6(1),o.Q6J("ngForOf",e)}}function iee(n,t){if(1&n&&(o.TgZ(0,"div",36)(1,"table",37)(2,"thead")(3,"tr"),o.YNc(4,qX,3,1,"th",38),o.YNc(5,KX,3,1,"th",39),o.qZA()(),o.TgZ(6,"tbody"),o.YNc(7,nee,3,2,"tr",40),o.qZA()()()),2&n){const e=o.oxw().$implicit,i=o.oxw(3);o.xp6(4),o.Q6J("ngIf",i.showWeek),o.xp6(1),o.Q6J("ngForOf",i.weekDays),o.xp6(2),o.Q6J("ngForOf",e.dates)}}function ree(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",20)(1,"div",21),o.YNc(2,HX,2,0,"button",22),o.TgZ(3,"div",23),o.YNc(4,jX,2,2,"button",24),o.YNc(5,GX,2,2,"button",25),o.YNc(6,ZX,3,5,"span",26),o.qZA(),o.TgZ(7,"button",27),o.NdJ("keydown",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.onContainerButtonKeydown(r))})("click",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.onNextButtonClick(r))}),o._UZ(8,"span",28),o.qZA()(),o.YNc(9,iee,8,3,"div",29),o.qZA()}if(2&n){const e=t.index,i=o.oxw(3);o.xp6(2),o.Q6J("ngIf",0===e),o.xp6(2),o.Q6J("ngIf","date"===i.currentView),o.xp6(1),o.Q6J("ngIf","year"!==i.currentView),o.xp6(1),o.Q6J("ngIf","year"===i.currentView),o.xp6(1),o.Udp("display",1===i.numberOfMonths||e===i.numberOfMonths-1?"inline-flex":"none"),o.xp6(2),o.Q6J("ngIf","date"===i.currentView)}}function oee(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"span",51),o.NdJ("click",function(r){const g=o.CHM(e).index,E=o.oxw(4);return o.KtG(E.onMonthSelect(r,g))})("keydown",function(r){const g=o.CHM(e).index,E=o.oxw(4);return o.KtG(E.onMonthCellKeydown(r,g))}),o._uU(1),o.qZA()}if(2&n){const e=t.$implicit,i=t.index,r=o.oxw(4);o.Q6J("ngClass",o.WLB(2,$4,r.isMonthSelected(i),r.isMonthDisabled(i))),o.xp6(1),o.hij(" ",e," ")}}function see(n,t){if(1&n&&(o.TgZ(0,"div",49),o.YNc(1,oee,2,5,"span",50),o.qZA()),2&n){const e=o.oxw(3);o.xp6(1),o.Q6J("ngForOf",e.monthPickerValues())}}const aee=function(n){return{"p-highlight":n}};function lee(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"span",54),o.NdJ("click",function(r){const g=o.CHM(e).$implicit,E=o.oxw(4);return o.KtG(E.onYearSelect(r,g))})("keydown",function(r){const g=o.CHM(e).$implicit,E=o.oxw(4);return o.KtG(E.onYearCellKeydown(r,g))}),o._uU(1),o.qZA()}if(2&n){const e=t.$implicit,i=o.oxw(4);o.Q6J("ngClass",o.VKq(2,aee,i.isYearSelected(e))),o.xp6(1),o.hij(" ",e," ")}}function cee(n,t){if(1&n&&(o.TgZ(0,"div",52),o.YNc(1,lee,2,4,"span",53),o.qZA()),2&n){const e=o.oxw(3);o.xp6(1),o.Q6J("ngForOf",e.yearPickerValues())}}function uee(n,t){if(1&n&&(o.ynx(0),o.TgZ(1,"div",16),o.YNc(2,ree,10,7,"div",17),o.qZA(),o.YNc(3,see,2,1,"div",18),o.YNc(4,cee,2,1,"div",19),o.BQk()),2&n){const e=o.oxw(2);o.xp6(2),o.Q6J("ngForOf",e.months),o.xp6(1),o.Q6J("ngIf","month"===e.currentView),o.xp6(1),o.Q6J("ngIf","year"===e.currentView)}}function hee(n,t){1&n&&(o.ynx(0),o._uU(1,"0"),o.BQk())}function dee(n,t){1&n&&(o.ynx(0),o._uU(1,"0"),o.BQk())}function pee(n,t){if(1&n&&(o.TgZ(0,"div",60)(1,"span"),o._uU(2),o.qZA()()),2&n){const e=o.oxw(3);o.xp6(2),o.Oqu(e.timeSeparator)}}function fee(n,t){1&n&&(o.ynx(0),o._uU(1,"0"),o.BQk())}function mee(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",65)(1,"button",57),o.NdJ("keydown",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.onContainerButtonKeydown(r))})("keydown.enter",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.incrementSecond(r))})("keydown.space",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.incrementSecond(r))})("mousedown",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.onTimePickerElementMouseDown(r,2,1))})("mouseup",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.onTimePickerElementMouseUp(r))})("keyup.enter",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.onTimePickerElementMouseUp(r))})("keyup.space",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.onTimePickerElementMouseUp(r))})("mouseleave",function(){o.CHM(e);const r=o.oxw(3);return o.KtG(r.onTimePickerElementMouseLeave())}),o._UZ(2,"span",58),o.qZA(),o.TgZ(3,"span"),o.YNc(4,fee,2,0,"ng-container",13),o._uU(5),o.qZA(),o.TgZ(6,"button",57),o.NdJ("keydown",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.onContainerButtonKeydown(r))})("keydown.enter",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.decrementSecond(r))})("keydown.space",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.decrementSecond(r))})("mousedown",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.onTimePickerElementMouseDown(r,2,-1))})("mouseup",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.onTimePickerElementMouseUp(r))})("keyup.enter",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.onTimePickerElementMouseUp(r))})("keyup.space",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.onTimePickerElementMouseUp(r))})("mouseleave",function(){o.CHM(e);const r=o.oxw(3);return o.KtG(r.onTimePickerElementMouseLeave())}),o._UZ(7,"span",59),o.qZA()()}if(2&n){const e=o.oxw(3);o.xp6(4),o.Q6J("ngIf",e.currentSecond<10),o.xp6(1),o.Oqu(e.currentSecond)}}function gee(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",66)(1,"button",67),o.NdJ("keydown",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.onContainerButtonKeydown(r))})("click",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.toggleAMPM(r))})("keydown.enter",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.toggleAMPM(r))}),o._UZ(2,"span",58),o.qZA(),o.TgZ(3,"span"),o._uU(4),o.qZA(),o.TgZ(5,"button",67),o.NdJ("keydown",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.onContainerButtonKeydown(r))})("click",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.toggleAMPM(r))})("keydown.enter",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.toggleAMPM(r))}),o._UZ(6,"span",59),o.qZA()()}if(2&n){const e=o.oxw(3);o.xp6(4),o.Oqu(e.pm?"PM":"AM")}}function _ee(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",55)(1,"div",56)(2,"button",57),o.NdJ("keydown",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onContainerButtonKeydown(r))})("keydown.enter",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.incrementHour(r))})("keydown.space",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.incrementHour(r))})("mousedown",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onTimePickerElementMouseDown(r,0,1))})("mouseup",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onTimePickerElementMouseUp(r))})("keyup.enter",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onTimePickerElementMouseUp(r))})("keyup.space",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onTimePickerElementMouseUp(r))})("mouseleave",function(){o.CHM(e);const r=o.oxw(2);return o.KtG(r.onTimePickerElementMouseLeave())}),o._UZ(3,"span",58),o.qZA(),o.TgZ(4,"span"),o.YNc(5,hee,2,0,"ng-container",13),o._uU(6),o.qZA(),o.TgZ(7,"button",57),o.NdJ("keydown",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onContainerButtonKeydown(r))})("keydown.enter",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.decrementHour(r))})("keydown.space",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.decrementHour(r))})("mousedown",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onTimePickerElementMouseDown(r,0,-1))})("mouseup",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onTimePickerElementMouseUp(r))})("keyup.enter",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onTimePickerElementMouseUp(r))})("keyup.space",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onTimePickerElementMouseUp(r))})("mouseleave",function(){o.CHM(e);const r=o.oxw(2);return o.KtG(r.onTimePickerElementMouseLeave())}),o._UZ(8,"span",59),o.qZA()(),o.TgZ(9,"div",60)(10,"span"),o._uU(11),o.qZA()(),o.TgZ(12,"div",61)(13,"button",57),o.NdJ("keydown",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onContainerButtonKeydown(r))})("keydown.enter",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.incrementMinute(r))})("keydown.space",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.incrementMinute(r))})("mousedown",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onTimePickerElementMouseDown(r,1,1))})("mouseup",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onTimePickerElementMouseUp(r))})("keyup.enter",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onTimePickerElementMouseUp(r))})("keyup.space",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onTimePickerElementMouseUp(r))})("mouseleave",function(){o.CHM(e);const r=o.oxw(2);return o.KtG(r.onTimePickerElementMouseLeave())}),o._UZ(14,"span",58),o.qZA(),o.TgZ(15,"span"),o.YNc(16,dee,2,0,"ng-container",13),o._uU(17),o.qZA(),o.TgZ(18,"button",57),o.NdJ("keydown",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onContainerButtonKeydown(r))})("keydown.enter",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.decrementMinute(r))})("keydown.space",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.decrementMinute(r))})("mousedown",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onTimePickerElementMouseDown(r,1,-1))})("mouseup",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onTimePickerElementMouseUp(r))})("keyup.enter",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onTimePickerElementMouseUp(r))})("keyup.space",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onTimePickerElementMouseUp(r))})("mouseleave",function(){o.CHM(e);const r=o.oxw(2);return o.KtG(r.onTimePickerElementMouseLeave())}),o._UZ(19,"span",59),o.qZA()(),o.YNc(20,pee,3,1,"div",62),o.YNc(21,mee,8,2,"div",63),o.YNc(22,gee,7,1,"div",64),o.qZA()}if(2&n){const e=o.oxw(2);o.xp6(5),o.Q6J("ngIf",e.currentHour<10),o.xp6(1),o.Oqu(e.currentHour),o.xp6(5),o.Oqu(e.timeSeparator),o.xp6(5),o.Q6J("ngIf",e.currentMinute<10),o.xp6(1),o.Oqu(e.currentMinute),o.xp6(3),o.Q6J("ngIf",e.showSeconds),o.xp6(1),o.Q6J("ngIf",e.showSeconds),o.xp6(1),o.Q6J("ngIf","12"==e.hourFormat)}}const W4=function(n){return[n]};function yee(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",68)(1,"button",69),o.NdJ("keydown",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onContainerButtonKeydown(r))})("click",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onTodayButtonClick(r))}),o.qZA(),o.TgZ(2,"button",69),o.NdJ("keydown",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onContainerButtonKeydown(r))})("click",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onClearButtonClick(r))}),o.qZA()()}if(2&n){const e=o.oxw(2);o.xp6(1),o.Q6J("label",e.getTranslation("today"))("ngClass",o.VKq(4,W4,e.todayButtonStyleClass)),o.xp6(1),o.Q6J("label",e.getTranslation("clear"))("ngClass",o.VKq(6,W4,e.clearButtonStyleClass))}}function vee(n,t){1&n&&o.GkF(0)}const bee=function(n,t,e,i,r,a){return{"p-datepicker p-component":!0,"p-datepicker-inline":n,"p-disabled":t,"p-datepicker-timeonly":e,"p-datepicker-multiple-month":i,"p-datepicker-monthpicker":r,"p-datepicker-touch-ui":a}},Z4=function(n,t){return{showTransitionParams:n,hideTransitionParams:t}},wee=function(n){return{value:"visibleTouchUI",params:n}},xee=function(n){return{value:"visible",params:n}};function Cee(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",10,11),o.NdJ("@overlayAnimation.start",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onOverlayAnimationStart(r))})("@overlayAnimation.done",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onOverlayAnimationDone(r))})("click",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onOverlayClick(r))}),o.Hsn(2),o.YNc(3,UX,1,0,"ng-container",12),o.YNc(4,uee,5,3,"ng-container",13),o.YNc(5,_ee,23,8,"div",14),o.YNc(6,yee,3,8,"div",15),o.Hsn(7,1),o.YNc(8,vee,1,0,"ng-container",12),o.qZA()}if(2&n){const e=o.oxw();o.Tol(e.panelStyleClass),o.Q6J("ngStyle",e.panelStyle)("ngClass",o.HTZ(11,bee,e.inline,e.disabled,e.timeOnly,e.numberOfMonths>1,"month"===e.view,e.touchUI))("@overlayAnimation",e.touchUI?o.VKq(21,wee,o.WLB(18,Z4,e.showTransitionOptions,e.hideTransitionOptions)):o.VKq(26,xee,o.WLB(23,Z4,e.showTransitionOptions,e.hideTransitionOptions)))("@.disabled",!0===e.inline),o.xp6(3),o.Q6J("ngTemplateOutlet",e.headerTemplate),o.xp6(1),o.Q6J("ngIf",!e.timeOnly),o.xp6(1),o.Q6J("ngIf",(e.showTime||e.timeOnly)&&"date"===e.currentView),o.xp6(1),o.Q6J("ngIf",e.showButtonBar),o.xp6(2),o.Q6J("ngTemplateOutlet",e.footerTemplate)}}const Eee=[[["p-header"]],[["p-footer"]]],Tee=function(n,t,e,i){return{"p-calendar":!0,"p-calendar-w-btn":n,"p-calendar-timeonly":t,"p-calendar-disabled":e,"p-focus":i}},See=["p-header","p-footer"],Iee={provide:xs,useExisting:(0,o.Gpc)(()=>Dee),multi:!0};let Dee=(()=>{class n{constructor(e,i,r,a,g,E){this.el=e,this.renderer=i,this.cd=r,this.zone=a,this.config=g,this.overlayService=E,this.multipleSeparator=",",this.rangeSeparator="-",this.inline=!1,this.showOtherMonths=!0,this.icon="pi pi-calendar",this.shortYearCutoff="+10",this.hourFormat="24",this.stepHour=1,this.stepMinute=1,this.stepSecond=1,this.showSeconds=!1,this.showOnFocus=!0,this.showWeek=!1,this.showClear=!1,this.dataType="date",this.selectionMode="single",this.todayButtonStyleClass="p-button-text",this.clearButtonStyleClass="p-button-text",this.autoZIndex=!0,this.baseZIndex=0,this.keepInvalid=!1,this.hideOnDateTimeSelect=!0,this.timeSeparator=":",this.focusTrap=!0,this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.onFocus=new o.vpe,this.onBlur=new o.vpe,this.onClose=new o.vpe,this.onSelect=new o.vpe,this.onClear=new o.vpe,this.onInput=new o.vpe,this.onTodayClick=new o.vpe,this.onClearClick=new o.vpe,this.onMonthChange=new o.vpe,this.onYearChange=new o.vpe,this.onClickOutside=new o.vpe,this.onShow=new o.vpe,this.onModelChange=()=>{},this.onModelTouched=()=>{},this.inputFieldValue=null,this.navigationState=null,this._numberOfMonths=1,this._view="date",this.convertTo24Hour=function(O,j){return"12"==this.hourFormat?12===O?j?12:0:j?O+12:O:O}}set content(e){this.contentViewChild=e,this.contentViewChild&&(this.isMonthNavigate?(Promise.resolve(null).then(()=>this.updateFocus()),this.isMonthNavigate=!1):this.focus||this.initFocusableCell())}get view(){return this._view}set view(e){this._view=e,this.currentView=this._view}get defaultDate(){return this._defaultDate}set defaultDate(e){if(this._defaultDate=e,this.initialized){const i=e||new Date;this.currentMonth=i.getMonth(),this.currentYear=i.getFullYear(),this.initTime(i),this.createMonths(this.currentMonth,this.currentYear)}}get minDate(){return this._minDate}set minDate(e){this._minDate=e,null!=this.currentMonth&&null!=this.currentMonth&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=e,null!=this.currentMonth&&null!=this.currentMonth&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get disabledDates(){return this._disabledDates}set disabledDates(e){this._disabledDates=e,null!=this.currentMonth&&null!=this.currentMonth&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get disabledDays(){return this._disabledDays}set disabledDays(e){this._disabledDays=e,null!=this.currentMonth&&null!=this.currentMonth&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get yearRange(){return this._yearRange}set yearRange(e){if(this._yearRange=e,e){const i=e.split(":"),r=parseInt(i[0]),a=parseInt(i[1]);this.populateYearOptions(r,a)}}get showTime(){return this._showTime}set showTime(e){this._showTime=e,void 0===this.currentHour&&this.initTime(this.value||new Date),this.updateInputfield()}get locale(){return this._locale}get responsiveOptions(){return this._responsiveOptions}set responsiveOptions(e){this._responsiveOptions=e,this.destroyResponsiveStyleElement(),this.createResponsiveStyle()}get numberOfMonths(){return this._numberOfMonths}set numberOfMonths(e){this._numberOfMonths=e,this.destroyResponsiveStyleElement(),this.createResponsiveStyle()}get firstDayOfWeek(){return this._firstDayOfWeek}set firstDayOfWeek(e){this._firstDayOfWeek=e,this.createWeekDays()}set locale(e){console.warn("Locale property has no effect, use new i18n API instead.")}ngOnInit(){this.attributeSelector=YS();const e=this.defaultDate||new Date;this.createResponsiveStyle(),this.currentMonth=e.getMonth(),this.currentYear=e.getFullYear(),this.currentView=this.view,"date"===this.view&&(this.createWeekDays(),this.initTime(e),this.createMonths(this.currentMonth,this.currentYear),this.ticksTo1970=24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.createWeekDays(),this.cd.markForCheck()}),this.initialized=!0}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"date":default:this.dateTemplate=e.template;break;case"decade":this.decadeTemplate=e.template;break;case"disabledDate":this.disabledDateTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template}})}ngAfterViewInit(){this.inline&&(this.contentViewChild&&this.contentViewChild.nativeElement.setAttribute(this.attributeSelector,""),this.disabled||(this.initFocusableCell(),1===this.numberOfMonths&&(this.contentViewChild.nativeElement.style.width=pt.getOuterWidth(this.containerViewChild.nativeElement)+"px")))}getTranslation(e){return this.config.getTranslation(e)}populateYearOptions(e,i){this.yearOptions=[];for(let r=e;r<=i;r++)this.yearOptions.push(r)}createWeekDays(){this.weekDays=[];let e=this.getFirstDateOfWeek(),i=this.getTranslation(wp.DAY_NAMES_MIN);for(let r=0;r<7;r++)this.weekDays.push(i[e]),e=6==e?0:++e}monthPickerValues(){let e=[];for(let i=0;i<=11;i++)e.push(this.config.getTranslation("monthNamesShort")[i]);return e}yearPickerValues(){let e=[],i=this.currentYear-this.currentYear%10;for(let r=0;r<10;r++)e.push(i+r);return e}createMonths(e,i){this.months=this.months=[];for(let r=0;r<this.numberOfMonths;r++){let a=e+r,g=i;a>11&&(a=a%11-1,g=i+1),this.months.push(this.createMonth(a,g))}}getWeekNumber(e){let i=new Date(e.getTime());i.setDate(i.getDate()+4-(i.getDay()||7));let r=i.getTime();return i.setMonth(0),i.setDate(1),Math.floor(Math.round((r-i.getTime())/864e5)/7)+1}createMonth(e,i){let r=[],a=this.getFirstDayOfMonthIndex(e,i),g=this.getDaysCountInMonth(e,i),E=this.getDaysCountInPrevMonth(e,i),O=1,j=new Date,Y=[],se=Math.ceil((g+a)/7);for(let be=0;be<se;be++){let Me=[];if(0==be){for(let _t=E-a+1;_t<=E;_t++){let Dt=this.getPreviousMonthAndYear(e,i);Me.push({day:_t,month:Dt.month,year:Dt.year,otherMonth:!0,today:this.isToday(j,_t,Dt.month,Dt.year),selectable:this.isSelectable(_t,Dt.month,Dt.year,!0)})}let Ge=7-Me.length;for(let _t=0;_t<Ge;_t++)Me.push({day:O,month:e,year:i,today:this.isToday(j,O,e,i),selectable:this.isSelectable(O,e,i,!1)}),O++}else for(let Ge=0;Ge<7;Ge++){if(O>g){let _t=this.getNextMonthAndYear(e,i);Me.push({day:O-g,month:_t.month,year:_t.year,otherMonth:!0,today:this.isToday(j,O-g,_t.month,_t.year),selectable:this.isSelectable(O-g,_t.month,_t.year,!0)})}else Me.push({day:O,month:e,year:i,today:this.isToday(j,O,e,i),selectable:this.isSelectable(O,e,i,!1)});O++}this.showWeek&&Y.push(this.getWeekNumber(new Date(Me[0].year,Me[0].month,Me[0].day))),r.push(Me)}return{month:e,year:i,dates:r,weekNumbers:Y}}initTime(e){this.pm=e.getHours()>11,this.showTime?(this.currentMinute=e.getMinutes(),this.currentSecond=e.getSeconds(),this.setCurrentHourPM(e.getHours())):this.timeOnly&&(this.currentMinute=0,this.currentHour=0,this.currentSecond=0)}navBackward(e){this.disabled?e.preventDefault():(this.isMonthNavigate=!0,"month"===this.currentView?(this.decrementYear(),setTimeout(()=>{this.updateFocus()},1)):"year"===this.currentView?(this.decrementDecade(),setTimeout(()=>{this.updateFocus()},1)):(0===this.currentMonth?(this.currentMonth=11,this.decrementYear()):this.currentMonth--,this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)))}navForward(e){this.disabled?e.preventDefault():(this.isMonthNavigate=!0,"month"===this.currentView?(this.incrementYear(),setTimeout(()=>{this.updateFocus()},1)):"year"===this.currentView?(this.incrementDecade(),setTimeout(()=>{this.updateFocus()},1)):(11===this.currentMonth?(this.currentMonth=0,this.incrementYear()):this.currentMonth++,this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)))}decrementYear(){if(this.currentYear--,this.yearNavigator&&this.currentYear<this.yearOptions[0]){let e=this.yearOptions[this.yearOptions.length-1]-this.yearOptions[0];this.populateYearOptions(this.yearOptions[0]-e,this.yearOptions[this.yearOptions.length-1]-e)}}decrementDecade(){this.currentYear=this.currentYear-10}incrementDecade(){this.currentYear=this.currentYear+10}incrementYear(){if(this.currentYear++,this.yearNavigator&&this.currentYear>this.yearOptions[this.yearOptions.length-1]){let e=this.yearOptions[this.yearOptions.length-1]-this.yearOptions[0];this.populateYearOptions(this.yearOptions[0]+e,this.yearOptions[this.yearOptions.length-1]+e)}}switchToMonthView(e){this.setCurrentView("month"),e.preventDefault()}switchToYearView(e){this.setCurrentView("year"),e.preventDefault()}onDateSelect(e,i){!this.disabled&&i.selectable?(this.isMultipleSelection()&&this.isSelected(i)?(this.value=this.value.filter((r,a)=>!this.isDateEquals(r,i)),0===this.value.length&&(this.value=null),this.updateModel(this.value)):this.shouldSelectDate(i)&&this.selectDate(i),this.isSingleSelection()&&this.hideOnDateTimeSelect&&setTimeout(()=>{e.preventDefault(),this.hideOverlay(),this.mask&&this.disableModality(),this.cd.markForCheck()},150),this.updateInputfield(),e.preventDefault()):e.preventDefault()}shouldSelectDate(e){return!this.isMultipleSelection()||null==this.maxDateCount||this.maxDateCount>(this.value?this.value.length:0)}onMonthSelect(e,i){"month"===this.view?this.onDateSelect(e,{year:this.currentYear,month:i,day:1,selectable:!0}):(this.currentMonth=i,this.createMonths(this.currentMonth,this.currentYear),this.setCurrentView("date"),this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}))}onYearSelect(e,i){"year"===this.view?this.onDateSelect(e,{year:i,month:0,day:1,selectable:!0}):(this.currentYear=i,this.setCurrentView("month"),this.onYearChange.emit({month:this.currentMonth+1,year:this.currentYear}))}updateInputfield(){let e="";if(this.value)if(this.isSingleSelection())e=this.formatDateTime(this.value);else if(this.isMultipleSelection())for(let i=0;i<this.value.length;i++)e+=this.formatDateTime(this.value[i]),i!==this.value.length-1&&(e+=this.multipleSeparator+" ");else if(this.isRangeSelection()&&this.value&&this.value.length){let r=this.value[1];e=this.formatDateTime(this.value[0]),r&&(e+=" "+this.rangeSeparator+" "+this.formatDateTime(r))}this.inputFieldValue=e,this.updateFilledState(),this.inputfieldViewChild&&this.inputfieldViewChild.nativeElement&&(this.inputfieldViewChild.nativeElement.value=this.inputFieldValue)}formatDateTime(e){let i=this.keepInvalid?e:null;return this.isValidDate(e)&&(this.timeOnly?i=this.formatTime(e):(i=this.formatDate(e,this.getDateFormat()),this.showTime&&(i+=" "+this.formatTime(e)))),i}setCurrentHourPM(e){"12"==this.hourFormat?(this.pm=e>11,this.currentHour=e>=12?12==e?12:e-12:0==e?12:e):this.currentHour=e}setCurrentView(e){this.currentView=e,this.cd.detectChanges(),this.alignOverlay()}selectDate(e){let i=new Date(e.year,e.month,e.day);if(this.showTime&&(i.setHours("12"==this.hourFormat?12===this.currentHour?this.pm?12:0:this.pm?this.currentHour+12:this.currentHour:this.currentHour),i.setMinutes(this.currentMinute),i.setSeconds(this.currentSecond)),this.minDate&&this.minDate>i&&(i=this.minDate,this.setCurrentHourPM(i.getHours()),this.currentMinute=i.getMinutes(),this.currentSecond=i.getSeconds()),this.maxDate&&this.maxDate<i&&(i=this.maxDate,this.setCurrentHourPM(i.getHours()),this.currentMinute=i.getMinutes(),this.currentSecond=i.getSeconds()),this.isSingleSelection())this.updateModel(i);else if(this.isMultipleSelection())this.updateModel(this.value?[...this.value,i]:[i]);else if(this.isRangeSelection())if(this.value&&this.value.length){let r=this.value[0],a=this.value[1];!a&&i.getTime()>=r.getTime()?a=i:(r=i,a=null),this.updateModel([r,a])}else this.updateModel([i,null]);this.onSelect.emit(i)}updateModel(e){if(this.value=e,"date"==this.dataType)this.onModelChange(this.value);else if("string"==this.dataType)if(this.isSingleSelection())this.onModelChange(this.formatDateTime(this.value));else{let i=null;this.value&&(i=this.value.map(r=>this.formatDateTime(r))),this.onModelChange(i)}}getFirstDayOfMonthIndex(e,i){let r=new Date;r.setDate(1),r.setMonth(e),r.setFullYear(i);let a=r.getDay()+this.getSundayIndex();return a>=7?a-7:a}getDaysCountInMonth(e,i){return 32-this.daylightSavingAdjust(new Date(i,e,32)).getDate()}getDaysCountInPrevMonth(e,i){let r=this.getPreviousMonthAndYear(e,i);return this.getDaysCountInMonth(r.month,r.year)}getPreviousMonthAndYear(e,i){let r,a;return 0===e?(r=11,a=i-1):(r=e-1,a=i),{month:r,year:a}}getNextMonthAndYear(e,i){let r,a;return 11===e?(r=0,a=i+1):(r=e+1,a=i),{month:r,year:a}}getSundayIndex(){let e=this.getFirstDateOfWeek();return e>0?7-e:0}isSelected(e){if(!this.value)return!1;if(this.isSingleSelection())return this.isDateEquals(this.value,e);if(this.isMultipleSelection()){let i=!1;for(let r of this.value)if(i=this.isDateEquals(r,e),i)break;return i}return this.isRangeSelection()?this.value[1]?this.isDateEquals(this.value[0],e)||this.isDateEquals(this.value[1],e)||this.isDateBetween(this.value[0],this.value[1],e):this.isDateEquals(this.value[0],e):void 0}isComparable(){return null!=this.value&&"string"!=typeof this.value}isMonthSelected(e){if(this.isComparable()&&!this.isMultipleSelection()){const[i,r]=this.isRangeSelection()?this.value:[this.value,this.value],a=new Date(this.currentYear,e,1);return a>=i&&a<=(r??i)}return!1}isMonthDisabled(e){for(let i=1;i<this.getDaysCountInMonth(e,this.currentYear)+1;i++)if(this.isSelectable(i,e,this.currentYear,!1))return!1;return!0}isYearSelected(e){if(this.isComparable()){let i=this.isRangeSelection()?this.value[0]:this.value;return!this.isMultipleSelection()&&i.getFullYear()===e}return!1}isDateEquals(e,i){return!!(e&&e instanceof Date)&&e.getDate()===i.day&&e.getMonth()===i.month&&e.getFullYear()===i.year}isDateBetween(e,i,r){if(e&&i){let g=new Date(r.year,r.month,r.day);return e.getTime()<=g.getTime()&&i.getTime()>=g.getTime()}return!1}isSingleSelection(){return"single"===this.selectionMode}isRangeSelection(){return"range"===this.selectionMode}isMultipleSelection(){return"multiple"===this.selectionMode}isToday(e,i,r,a){return e.getDate()===i&&e.getMonth()===r&&e.getFullYear()===a}isSelectable(e,i,r,a){let g=!0,E=!0,O=!0,j=!0;return!(a&&!this.selectOtherMonths)&&(this.minDate&&(this.minDate.getFullYear()>r||this.minDate.getFullYear()===r&&(this.minDate.getMonth()>i||this.minDate.getMonth()===i&&this.minDate.getDate()>e))&&(g=!1),this.maxDate&&(this.maxDate.getFullYear()<r||this.maxDate.getFullYear()===r&&(this.maxDate.getMonth()<i||this.maxDate.getMonth()===i&&this.maxDate.getDate()<e))&&(E=!1),this.disabledDates&&(O=!this.isDateDisabled(e,i,r)),this.disabledDays&&(j=!this.isDayDisabled(e,i,r)),g&&E&&O&&j)}isDateDisabled(e,i,r){if(this.disabledDates)for(let a of this.disabledDates)if(a.getFullYear()===r&&a.getMonth()===i&&a.getDate()===e)return!0;return!1}isDayDisabled(e,i,r){if(this.disabledDays){let g=new Date(r,i,e).getDay();return-1!==this.disabledDays.indexOf(g)}return!1}onInputFocus(e){this.focus=!0,this.showOnFocus&&this.showOverlay(),this.onFocus.emit(e)}onInputClick(){this.showOnFocus&&!this.overlayVisible&&this.showOverlay()}onInputBlur(e){this.focus=!1,this.onBlur.emit(e),this.keepInvalid||this.updateInputfield(),this.onModelTouched()}onButtonClick(e,i){this.overlayVisible?this.hideOverlay():(i.focus(),this.showOverlay())}clear(){this.inputFieldValue=null,this.value=null,this.onModelChange(this.value),this.onClear.emit()}onOverlayClick(e){this.overlayService.add({originalEvent:e,target:this.el.nativeElement})}getMonthName(e){return this.config.getTranslation("monthNames")[e]}getYear(e){return"month"===this.currentView?this.currentYear:e.year}switchViewButtonDisabled(){return this.numberOfMonths>1||this.disabled}onPrevButtonClick(e){this.navigationState={backward:!0,button:!0},this.navBackward(e)}onNextButtonClick(e){this.navigationState={backward:!1,button:!0},this.navForward(e)}onContainerButtonKeydown(e){switch(e.which){case 9:this.inline||this.trapFocus(e);break;case 27:this.overlayVisible=!1,e.preventDefault()}}onInputKeydown(e){this.isKeydown=!0,40===e.keyCode&&this.contentViewChild?this.trapFocus(e):27===e.keyCode||13===e.keyCode?this.overlayVisible&&(this.overlayVisible=!1,e.preventDefault()):9===e.keyCode&&this.contentViewChild&&(pt.getFocusableElements(this.contentViewChild.nativeElement).forEach(i=>i.tabIndex="-1"),this.overlayVisible&&(this.overlayVisible=!1))}onDateCellKeydown(e,i,r){const a=e.currentTarget,g=a.parentElement;switch(e.which){case 40:{a.tabIndex="-1";let E=pt.index(g),O=g.parentElement.nextElementSibling;O?pt.hasClass(O.children[E].children[0],"p-disabled")?(this.navigationState={backward:!1},this.navForward(e)):(O.children[E].children[0].tabIndex="0",O.children[E].children[0].focus()):(this.navigationState={backward:!1},this.navForward(e)),e.preventDefault();break}case 38:{a.tabIndex="-1";let E=pt.index(g),O=g.parentElement.previousElementSibling;if(O){let j=O.children[E].children[0];pt.hasClass(j,"p-disabled")?(this.navigationState={backward:!0},this.navBackward(e)):(j.tabIndex="0",j.focus())}else this.navigationState={backward:!0},this.navBackward(e);e.preventDefault();break}case 37:{a.tabIndex="-1";let E=g.previousElementSibling;if(E){let O=E.children[0];pt.hasClass(O,"p-disabled")||pt.hasClass(O.parentElement,"p-datepicker-weeknumber")?this.navigateToMonth(!0,r):(O.tabIndex="0",O.focus())}else this.navigateToMonth(!0,r);e.preventDefault();break}case 39:{a.tabIndex="-1";let E=g.nextElementSibling;if(E){let O=E.children[0];pt.hasClass(O,"p-disabled")?this.navigateToMonth(!1,r):(O.tabIndex="0",O.focus())}else this.navigateToMonth(!1,r);e.preventDefault();break}case 13:case 32:this.onDateSelect(e,i),e.preventDefault();break;case 27:this.overlayVisible=!1,e.preventDefault();break;case 9:this.inline||this.trapFocus(e)}}onMonthCellKeydown(e,i){const r=e.currentTarget;switch(e.which){case 38:case 40:{r.tabIndex="-1";var a=r.parentElement.children,g=pt.index(r);let E=a[40===e.which?g+3:g-3];E&&(E.tabIndex="0",E.focus()),e.preventDefault();break}case 37:{r.tabIndex="-1";let E=r.previousElementSibling;E?(E.tabIndex="0",E.focus()):(this.navigationState={backward:!0},this.navBackward(e)),e.preventDefault();break}case 39:{r.tabIndex="-1";let E=r.nextElementSibling;E?(E.tabIndex="0",E.focus()):(this.navigationState={backward:!1},this.navForward(e)),e.preventDefault();break}case 13:this.onMonthSelect(e,i),e.preventDefault();break;case 13:case 32:case 27:this.overlayVisible=!1,e.preventDefault();break;case 9:this.inline||this.trapFocus(e)}}onYearCellKeydown(e,i){const r=e.currentTarget;switch(e.which){case 38:case 40:{r.tabIndex="-1";var a=r.parentElement.children,g=pt.index(r);let E=a[40===e.which?g+2:g-2];E&&(E.tabIndex="0",E.focus()),e.preventDefault();break}case 37:{r.tabIndex="-1";let E=r.previousElementSibling;E?(E.tabIndex="0",E.focus()):(this.navigationState={backward:!0},this.navBackward(e)),e.preventDefault();break}case 39:{r.tabIndex="-1";let E=r.nextElementSibling;E?(E.tabIndex="0",E.focus()):(this.navigationState={backward:!1},this.navForward(e)),e.preventDefault();break}case 13:case 32:this.onYearSelect(e,i),e.preventDefault();break;case 27:this.overlayVisible=!1,e.preventDefault();break;case 9:this.trapFocus(e)}}navigateToMonth(e,i){if(e)if(1===this.numberOfMonths||0===i)this.navigationState={backward:!0},this.navBackward(event);else{let a=pt.find(this.contentViewChild.nativeElement.children[i-1],".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)"),g=a[a.length-1];g.tabIndex="0",g.focus()}else if(1===this.numberOfMonths||i===this.numberOfMonths-1)this.navigationState={backward:!1},this.navForward(event);else{let a=pt.findSingle(this.contentViewChild.nativeElement.children[i+1],".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)");a.tabIndex="0",a.focus()}}updateFocus(){let e;if(this.navigationState){if(this.navigationState.button)this.initFocusableCell(),this.navigationState.backward?pt.findSingle(this.contentViewChild.nativeElement,".p-datepicker-prev").focus():pt.findSingle(this.contentViewChild.nativeElement,".p-datepicker-next").focus();else{if(this.navigationState.backward){let i;i=pt.find(this.contentViewChild.nativeElement,"month"===this.currentView?".p-monthpicker .p-monthpicker-month:not(.p-disabled)":"year"===this.currentView?".p-yearpicker .p-yearpicker-year:not(.p-disabled)":".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)"),i&&i.length>0&&(e=i[i.length-1])}else e=pt.findSingle(this.contentViewChild.nativeElement,"month"===this.currentView?".p-monthpicker .p-monthpicker-month:not(.p-disabled)":"year"===this.currentView?".p-yearpicker .p-yearpicker-year:not(.p-disabled)":".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)");e&&(e.tabIndex="0",e.focus())}this.navigationState=null}else this.initFocusableCell()}initFocusableCell(){const e=this.contentViewChild?.nativeElement;let i;if("month"===this.currentView){let r=pt.find(e,".p-monthpicker .p-monthpicker-month:not(.p-disabled)"),a=pt.findSingle(e,".p-monthpicker .p-monthpicker-month.p-highlight");r.forEach(g=>g.tabIndex=-1),i=a||r[0],0===r.length&&pt.find(e,'.p-monthpicker .p-monthpicker-month.p-disabled[tabindex = "0"]').forEach(E=>E.tabIndex=-1)}else if("year"===this.currentView){let r=pt.find(e,".p-yearpicker .p-yearpicker-year:not(.p-disabled)"),a=pt.findSingle(e,".p-yearpicker .p-yearpicker-year.p-highlight");r.forEach(g=>g.tabIndex=-1),i=a||r[0],0===r.length&&pt.find(e,'.p-yearpicker .p-yearpicker-year.p-disabled[tabindex = "0"]').forEach(E=>E.tabIndex=-1)}else if(i=pt.findSingle(e,"span.p-highlight"),!i){let r=pt.findSingle(e,"td.p-datepicker-today span:not(.p-disabled):not(.p-ink)");i=r||pt.findSingle(e,".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)")}i&&(i.tabIndex="0",!this.preventFocus&&(!this.navigationState||!this.navigationState.button)&&setTimeout(()=>{this.disabled||i.focus()},1),this.preventFocus=!1)}trapFocus(e){let i=pt.getFocusableElements(this.contentViewChild.nativeElement);if(i&&i.length>0)if(i[0].ownerDocument.activeElement){let r=i.indexOf(i[0].ownerDocument.activeElement);if(e.shiftKey)if(-1==r||0===r)if(this.focusTrap)i[i.length-1].focus();else{if(-1===r)return this.hideOverlay();if(0===r)return}else i[r-1].focus();else if(-1==r||r===i.length-1){if(!this.focusTrap&&-1!=r)return this.hideOverlay();i[0].focus()}else i[r+1].focus()}else i[0].focus();e.preventDefault()}onMonthDropdownChange(e){this.currentMonth=parseInt(e),this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)}onYearDropdownChange(e){this.currentYear=parseInt(e),this.onYearChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)}validateTime(e,i,r,a){let g=this.value;const E=this.convertTo24Hour(e,a);this.isRangeSelection()&&(g=this.value[1]||this.value[0]),this.isMultipleSelection()&&(g=this.value[this.value.length-1]);const O=g?g.toDateString():null;return!(this.minDate&&O&&this.minDate.toDateString()===O&&(this.minDate.getHours()>E||this.minDate.getHours()===E&&(this.minDate.getMinutes()>i||this.minDate.getMinutes()===i&&this.minDate.getSeconds()>r))||this.maxDate&&O&&this.maxDate.toDateString()===O&&(this.maxDate.getHours()<E||this.maxDate.getHours()===E&&(this.maxDate.getMinutes()<i||this.maxDate.getMinutes()===i&&this.maxDate.getSeconds()<r)))}incrementHour(e){let r=this.currentHour+this.stepHour,a=this.pm;"24"==this.hourFormat?r=r>=24?r-24:r:"12"==this.hourFormat&&(this.currentHour<12&&r>11&&(a=!this.pm),r=r>=13?r-12:r),this.validateTime(r,this.currentMinute,this.currentSecond,a)&&(this.currentHour=r,this.pm=a),e.preventDefault()}onTimePickerElementMouseDown(e,i,r){this.disabled||(this.repeat(e,null,i,r),e.preventDefault())}onTimePickerElementMouseUp(e){this.disabled||(this.clearTimePickerTimer(),this.updateTime())}onTimePickerElementMouseLeave(){!this.disabled&&this.timePickerTimer&&(this.clearTimePickerTimer(),this.updateTime())}repeat(e,i,r,a){let g=i||500;switch(this.clearTimePickerTimer(),this.timePickerTimer=setTimeout(()=>{this.repeat(e,100,r,a),this.cd.markForCheck()},g),r){case 0:1===a?this.incrementHour(e):this.decrementHour(e);break;case 1:1===a?this.incrementMinute(e):this.decrementMinute(e);break;case 2:1===a?this.incrementSecond(e):this.decrementSecond(e)}this.updateInputfield()}clearTimePickerTimer(){this.timePickerTimer&&(clearTimeout(this.timePickerTimer),this.timePickerTimer=null)}decrementHour(e){let i=this.currentHour-this.stepHour,r=this.pm;"24"==this.hourFormat?i=i<0?24+i:i:"12"==this.hourFormat&&(12===this.currentHour&&(r=!this.pm),i=i<=0?12+i:i),this.validateTime(i,this.currentMinute,this.currentSecond,r)&&(this.currentHour=i,this.pm=r),e.preventDefault()}incrementMinute(e){let i=this.currentMinute+this.stepMinute;i=i>59?i-60:i,this.validateTime(this.currentHour,i,this.currentSecond,this.pm)&&(this.currentMinute=i),e.preventDefault()}decrementMinute(e){let i=this.currentMinute-this.stepMinute;i=i<0?60+i:i,this.validateTime(this.currentHour,i,this.currentSecond,this.pm)&&(this.currentMinute=i),e.preventDefault()}incrementSecond(e){let i=this.currentSecond+this.stepSecond;i=i>59?i-60:i,this.validateTime(this.currentHour,this.currentMinute,i,this.pm)&&(this.currentSecond=i),e.preventDefault()}decrementSecond(e){let i=this.currentSecond-this.stepSecond;i=i<0?60+i:i,this.validateTime(this.currentHour,this.currentMinute,i,this.pm)&&(this.currentSecond=i),e.preventDefault()}updateTime(){let e=this.value;this.isRangeSelection()&&(e=this.value[1]||this.value[0]),this.isMultipleSelection()&&(e=this.value[this.value.length-1]),e=e?new Date(e.getTime()):new Date,e.setHours("12"==this.hourFormat?12===this.currentHour?this.pm?12:0:this.pm?this.currentHour+12:this.currentHour:this.currentHour),e.setMinutes(this.currentMinute),e.setSeconds(this.currentSecond),this.isRangeSelection()&&(e=this.value[1]?[this.value[0],e]:[e,null]),this.isMultipleSelection()&&(e=[...this.value.slice(0,-1),e]),this.updateModel(e),this.onSelect.emit(e),this.updateInputfield()}toggleAMPM(e){const i=!this.pm;this.validateTime(this.currentHour,this.currentMinute,this.currentSecond,i)&&(this.pm=i,this.updateTime()),e.preventDefault()}onUserInput(e){if(!this.isKeydown)return;this.isKeydown=!1;let i=e.target.value;try{let r=this.parseValueFromString(i);this.isValidSelection(r)&&(this.updateModel(r),this.updateUI())}catch{this.updateModel(this.keepInvalid?i:null)}this.filled=null!=i&&i.length,this.onInput.emit(e)}isValidSelection(e){let i=!0;return this.isSingleSelection()?this.isSelectable(e.getDate(),e.getMonth(),e.getFullYear(),!1)||(i=!1):e.every(r=>this.isSelectable(r.getDate(),r.getMonth(),r.getFullYear(),!1))&&this.isRangeSelection()&&(i=e.length>1&&e[1]>e[0]),i}parseValueFromString(e){if(!e||0===e.trim().length)return null;let i;if(this.isSingleSelection())i=this.parseDateTime(e);else if(this.isMultipleSelection()){let r=e.split(this.multipleSeparator);i=[];for(let a of r)i.push(this.parseDateTime(a.trim()))}else if(this.isRangeSelection()){let r=e.split(" "+this.rangeSeparator+" ");i=[];for(let a=0;a<r.length;a++)i[a]=this.parseDateTime(r[a].trim())}return i}parseDateTime(e){let i,r=e.split(" ");if(this.timeOnly)i=new Date,this.populateTime(i,r[0],r[1]);else{const a=this.getDateFormat();if(this.showTime){let g="12"==this.hourFormat?r.pop():null,E=r.pop();i=this.parseDate(r.join(" "),a),this.populateTime(i,E,g)}else i=this.parseDate(e,a)}return i}populateTime(e,i,r){if("12"==this.hourFormat&&!r)throw"Invalid Time";this.pm="PM"===r||"pm"===r;let a=this.parseTime(i);e.setHours(a.hour),e.setMinutes(a.minute),e.setSeconds(a.second)}isValidDate(e){return e instanceof Date&&ti.isNotEmpty(e)}updateUI(){let e=this.value;Array.isArray(e)&&(e=e[0]);let i=this.defaultDate&&this.isValidDate(this.defaultDate)&&!this.value?this.defaultDate:e&&this.isValidDate(e)?e:new Date;this.currentMonth=i.getMonth(),this.currentYear=i.getFullYear(),this.createMonths(this.currentMonth,this.currentYear),(this.showTime||this.timeOnly)&&(this.setCurrentHourPM(i.getHours()),this.currentMinute=i.getMinutes(),this.currentSecond=i.getSeconds())}showOverlay(){this.overlayVisible||(this.updateUI(),this.touchUI||(this.preventFocus=!0),this.overlayVisible=!0)}hideOverlay(){this.overlayVisible=!1,this.clearTimePickerTimer(),this.touchUI&&this.disableModality(),this.cd.markForCheck()}toggle(){this.inline||(this.overlayVisible?this.hideOverlay():(this.showOverlay(),this.inputfieldViewChild.nativeElement.focus()))}onOverlayAnimationStart(e){switch(e.toState){case"visible":case"visibleTouchUI":this.inline||(this.overlay=e.element,this.overlay.setAttribute(this.attributeSelector,""),this.appendOverlay(),this.updateFocus(),this.autoZIndex&&(this.touchUI?_f.set("modal",this.overlay,this.baseZIndex||this.config.zIndex.modal):_f.set("overlay",this.overlay,this.baseZIndex||this.config.zIndex.overlay)),this.alignOverlay(),this.onShow.emit(e));break;case"void":this.onOverlayHide(),this.onClose.emit(e)}}onOverlayAnimationDone(e){switch(e.toState){case"visible":case"visibleTouchUI":this.inline||(this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener());break;case"void":this.autoZIndex&&_f.clear(e.element)}}appendOverlay(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.overlay):pt.appendChild(this.overlay,this.appendTo))}restoreOverlayAppend(){this.overlay&&this.appendTo&&this.el.nativeElement.appendChild(this.overlay)}alignOverlay(){this.touchUI?this.enableModality(this.overlay):this.overlay&&(this.appendTo?("date"===this.view?(this.overlay.style.width=pt.getOuterWidth(this.overlay)+"px",this.overlay.style.minWidth=pt.getOuterWidth(this.inputfieldViewChild.nativeElement)+"px"):this.overlay.style.width=pt.getOuterWidth(this.inputfieldViewChild.nativeElement)+"px",pt.absolutePosition(this.overlay,this.inputfieldViewChild.nativeElement)):pt.relativePosition(this.overlay,this.inputfieldViewChild.nativeElement))}enableModality(e){this.mask||this.touchUI||(this.mask=document.createElement("div"),this.mask.style.zIndex=String(parseInt(e.style.zIndex)-1),pt.addMultipleClasses(this.mask,"p-component-overlay p-datepicker-mask p-datepicker-mask-scrollblocker p-component-overlay p-component-overlay-enter"),this.maskClickListener=this.renderer.listen(this.mask,"click",r=>{this.disableModality()}),document.body.appendChild(this.mask),pt.addClass(document.body,"p-overflow-hidden"))}disableModality(){this.mask&&(pt.addClass(this.mask,"p-component-overlay-leave"),this.animationEndListener=this.destroyMask.bind(this),this.mask.addEventListener("animationend",this.animationEndListener))}destroyMask(){if(!this.mask)return;document.body.removeChild(this.mask);let i,e=document.body.children;for(let r=0;r<e.length;r++)if(pt.hasClass(e[r],"p-datepicker-mask-scrollblocker")){i=!0;break}i||pt.removeClass(document.body,"p-overflow-hidden"),this.unbindAnimationEndListener(),this.unbindMaskClickListener(),this.mask=null}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}unbindAnimationEndListener(){this.animationEndListener&&this.mask&&(this.mask.removeEventListener("animationend",this.animationEndListener),this.animationEndListener=null)}writeValue(e){if(this.value=e,this.value&&"string"==typeof this.value)try{this.value=this.parseValueFromString(this.value)}catch{this.keepInvalid&&(this.value=e)}this.updateInputfield(),this.updateUI(),this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}getDateFormat(){return this.dateFormat||this.getTranslation("dateFormat")}getFirstDateOfWeek(){return this._firstDayOfWeek||this.getTranslation(wp.FIRST_DAY_OF_WEEK)}formatDate(e,i){if(!e)return"";let r;const a=Y=>{const se=r+1<i.length&&i.charAt(r+1)===Y;return se&&r++,se},g=(Y,se,be)=>{let Me=""+se;if(a(Y))for(;Me.length<be;)Me="0"+Me;return Me},E=(Y,se,be,Me)=>a(Y)?Me[se]:be[se];let O="",j=!1;if(e)for(r=0;r<i.length;r++)if(j)"'"!==i.charAt(r)||a("'")?O+=i.charAt(r):j=!1;else switch(i.charAt(r)){case"d":O+=g("d",e.getDate(),2);break;case"D":O+=E("D",e.getDay(),this.getTranslation(wp.DAY_NAMES_SHORT),this.getTranslation(wp.DAY_NAMES));break;case"o":O+=g("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":O+=g("m",e.getMonth()+1,2);break;case"M":O+=E("M",e.getMonth(),this.getTranslation(wp.MONTH_NAMES_SHORT),this.getTranslation(wp.MONTH_NAMES));break;case"y":O+=a("y")?e.getFullYear():(e.getFullYear()%100<10?"0":"")+e.getFullYear()%100;break;case"@":O+=e.getTime();break;case"!":O+=1e4*e.getTime()+this.ticksTo1970;break;case"'":a("'")?O+="'":j=!0;break;default:O+=i.charAt(r)}return O}formatTime(e){if(!e)return"";let i="",r=e.getHours(),a=e.getMinutes(),g=e.getSeconds();return"12"==this.hourFormat&&r>11&&12!=r&&(r-=12),i+="12"==this.hourFormat&&0===r?12:r<10?"0"+r:r,i+=":",i+=a<10?"0"+a:a,this.showSeconds&&(i+=":",i+=g<10?"0"+g:g),"12"==this.hourFormat&&(i+=e.getHours()>11?" PM":" AM"),i}parseTime(e){let i=e.split(":");if(i.length!==(this.showSeconds?3:2))throw"Invalid time";let a=parseInt(i[0]),g=parseInt(i[1]),E=this.showSeconds?parseInt(i[2]):null;if(isNaN(a)||isNaN(g)||a>23||g>59||"12"==this.hourFormat&&a>12||this.showSeconds&&(isNaN(E)||E>59))throw"Invalid time";return"12"==this.hourFormat&&(12!==a&&this.pm?a+=12:!this.pm&&12===a&&(a-=12)),{hour:a,minute:g,second:E}}parseDate(e,i){if(null==i||null==e)throw"Invalid arguments";if(""===(e="object"==typeof e?e.toString():e+""))return null;let r,a,g,Ge,E=0,O="string"!=typeof this.shortYearCutoff?this.shortYearCutoff:(new Date).getFullYear()%100+parseInt(this.shortYearCutoff,10),j=-1,Y=-1,se=-1,be=-1,Me=!1,_t=Bn=>{let Un=r+1<i.length&&i.charAt(r+1)===Bn;return Un&&r++,Un},Dt=Bn=>{let Un=_t(Bn),ii="@"===Bn?14:"!"===Bn?20:"y"===Bn&&Un?4:"o"===Bn?3:2,_r=new RegExp("^\\d{"+("y"===Bn?ii:1)+","+ii+"}"),Ds=e.substring(E).match(_r);if(!Ds)throw"Missing number at position "+E;return E+=Ds[0].length,parseInt(Ds[0],10)},_n=(Bn,Un,ii)=>{let si=-1,_r=_t(Bn)?ii:Un,Ds=[];for(let ka=0;ka<_r.length;ka++)Ds.push([ka,_r[ka]]);Ds.sort((ka,Ou)=>-(ka[1].length-Ou[1].length));for(let ka=0;ka<Ds.length;ka++){let Ou=Ds[ka][1];if(e.substr(E,Ou.length).toLowerCase()===Ou.toLowerCase()){si=Ds[ka][0],E+=Ou.length;break}}if(-1!==si)return si+1;throw"Unknown name at position "+E},Ln=()=>{if(e.charAt(E)!==i.charAt(r))throw"Unexpected literal at position "+E;E++};for("month"===this.view&&(se=1),r=0;r<i.length;r++)if(Me)"'"!==i.charAt(r)||_t("'")?Ln():Me=!1;else switch(i.charAt(r)){case"d":se=Dt("d");break;case"D":_n("D",this.getTranslation(wp.DAY_NAMES_SHORT),this.getTranslation(wp.DAY_NAMES));break;case"o":be=Dt("o");break;case"m":Y=Dt("m");break;case"M":Y=_n("M",this.getTranslation(wp.MONTH_NAMES_SHORT),this.getTranslation(wp.MONTH_NAMES));break;case"y":j=Dt("y");break;case"@":Ge=new Date(Dt("@")),j=Ge.getFullYear(),Y=Ge.getMonth()+1,se=Ge.getDate();break;case"!":Ge=new Date((Dt("!")-this.ticksTo1970)/1e4),j=Ge.getFullYear(),Y=Ge.getMonth()+1,se=Ge.getDate();break;case"'":_t("'")?Ln():Me=!0;break;default:Ln()}if(E<e.length&&(g=e.substr(E),!/^\s+/.test(g)))throw"Extra/unparsed characters found in date: "+g;if(-1===j?j=(new Date).getFullYear():j<100&&(j+=(new Date).getFullYear()-(new Date).getFullYear()%100+(j<=O?0:-100)),be>-1)for(Y=1,se=be;a=this.getDaysCountInMonth(j,Y-1),!(se<=a);)Y++,se-=a;if("year"===this.view&&(Y=-1===Y?1:Y,se=-1===se?1:se),Ge=this.daylightSavingAdjust(new Date(j,Y-1,se)),Ge.getFullYear()!==j||Ge.getMonth()+1!==Y||Ge.getDate()!==se)throw"Invalid date";return Ge}daylightSavingAdjust(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null}updateFilledState(){this.filled=this.inputFieldValue&&""!=this.inputFieldValue}onTodayButtonClick(e){let i=new Date,r={day:i.getDate(),month:i.getMonth(),year:i.getFullYear(),otherMonth:i.getMonth()!==this.currentMonth||i.getFullYear()!==this.currentYear,today:!0,selectable:!0};this.onDateSelect(e,r),this.onTodayClick.emit(e)}onClearButtonClick(e){this.updateModel(null),this.updateInputfield(),this.hideOverlay(),this.onClearClick.emit(e)}createResponsiveStyle(){if(this.numberOfMonths>1&&this.responsiveOptions){this.responsiveStyleElement||(this.responsiveStyleElement=document.createElement("style"),this.responsiveStyleElement.type="text/css",document.body.appendChild(this.responsiveStyleElement));let e="";if(this.responsiveOptions){let i=[...this.responsiveOptions].filter(r=>!(!r.breakpoint||!r.numMonths)).sort((r,a)=>-1*r.breakpoint.localeCompare(a.breakpoint,void 0,{numeric:!0}));for(let r=0;r<i.length;r++){let{breakpoint:a,numMonths:g}=i[r],E=`\n                        .p-datepicker[${this.attributeSelector}] .p-datepicker-group:nth-child(${g}) .p-datepicker-next {\n                            display: inline-flex !important;\n                        }\n                    `;for(let O=g;O<this.numberOfMonths;O++)E+=`\n                            .p-datepicker[${this.attributeSelector}] .p-datepicker-group:nth-child(${O+1}) {\n                                display: none !important;\n                            }\n                        `;e+=`\n                        @media screen and (max-width: ${a}) {\n                            ${E}\n                        }\n                    `}}this.responsiveStyleElement.innerHTML=e}}destroyResponsiveStyleElement(){this.responsiveStyleElement&&(this.responsiveStyleElement.remove(),this.responsiveStyleElement=null)}bindDocumentClickListener(){this.documentClickListener||this.zone.runOutsideAngular(()=>{this.documentClickListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","mousedown",i=>{this.isOutsideClicked(i)&&this.overlayVisible&&this.zone.run(()=>{this.hideOverlay(),this.onClickOutside.emit(i),this.cd.markForCheck()})})})}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){!this.documentResizeListener&&!this.touchUI&&(this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener))}unbindDocumentResizeListener(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new yF(this.containerViewChild.nativeElement,()=>{this.overlayVisible&&this.hideOverlay()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}isOutsideClicked(e){return!(this.el.nativeElement.isSameNode(e.target)||this.isNavIconClicked(e)||this.el.nativeElement.contains(e.target)||this.overlay&&this.overlay.contains(e.target))}isNavIconClicked(e){return pt.hasClass(e.target,"p-datepicker-prev")||pt.hasClass(e.target,"p-datepicker-prev-icon")||pt.hasClass(e.target,"p-datepicker-next")||pt.hasClass(e.target,"p-datepicker-next-icon")}onWindowResize(){this.overlayVisible&&!pt.isTouchDevice()&&this.hideOverlay()}onOverlayHide(){this.currentView=this.view,this.mask&&this.destroyMask(),this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.overlay=null}ngOnDestroy(){this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.translationSubscription&&this.translationSubscription.unsubscribe(),this.overlay&&this.autoZIndex&&_f.clear(this.overlay),this.destroyResponsiveStyleElement(),this.clearTimePickerTimer(),this.restoreOverlayAppend(),this.onOverlayHide()}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.SBq),o.Y36(o.Qsj),o.Y36(o.sBO),o.Y36(o.R0b),o.Y36(lw),o.Y36(fk))},n.\u0275cmp=o.Xpm({type:n,selectors:[["p-calendar"]],contentQueries:function(e,i,r){if(1&e&&o.Suo(r,bp,4),2&e){let a;o.iGM(a=o.CRH())&&(i.templates=a)}},viewQuery:function(e,i){if(1&e&&(o.Gf(LX,5),o.Gf(FX,5),o.Gf(NX,5)),2&e){let r;o.iGM(r=o.CRH())&&(i.containerViewChild=r.first),o.iGM(r=o.CRH())&&(i.inputfieldViewChild=r.first),o.iGM(r=o.CRH())&&(i.content=r.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:6,hostBindings:function(e,i){2&e&&o.ekj("p-inputwrapper-filled",i.filled)("p-inputwrapper-focus",i.focus)("p-calendar-clearable",i.showClear&&!i.disabled)},inputs:{style:"style",styleClass:"styleClass",inputStyle:"inputStyle",inputId:"inputId",name:"name",inputStyleClass:"inputStyleClass",placeholder:"placeholder",ariaLabelledBy:"ariaLabelledBy",iconAriaLabel:"iconAriaLabel",disabled:"disabled",dateFormat:"dateFormat",multipleSeparator:"multipleSeparator",rangeSeparator:"rangeSeparator",inline:"inline",showOtherMonths:"showOtherMonths",selectOtherMonths:"selectOtherMonths",showIcon:"showIcon",icon:"icon",appendTo:"appendTo",readonlyInput:"readonlyInput",shortYearCutoff:"shortYearCutoff",monthNavigator:"monthNavigator",yearNavigator:"yearNavigator",hourFormat:"hourFormat",timeOnly:"timeOnly",stepHour:"stepHour",stepMinute:"stepMinute",stepSecond:"stepSecond",showSeconds:"showSeconds",required:"required",showOnFocus:"showOnFocus",showWeek:"showWeek",showClear:"showClear",dataType:"dataType",selectionMode:"selectionMode",maxDateCount:"maxDateCount",showButtonBar:"showButtonBar",todayButtonStyleClass:"todayButtonStyleClass",clearButtonStyleClass:"clearButtonStyleClass",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",panelStyleClass:"panelStyleClass",panelStyle:"panelStyle",keepInvalid:"keepInvalid",hideOnDateTimeSelect:"hideOnDateTimeSelect",touchUI:"touchUI",timeSeparator:"timeSeparator",focusTrap:"focusTrap",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",tabindex:"tabindex",view:"view",defaultDate:"defaultDate",minDate:"minDate",maxDate:"maxDate",disabledDates:"disabledDates",disabledDays:"disabledDays",yearRange:"yearRange",showTime:"showTime",responsiveOptions:"responsiveOptions",numberOfMonths:"numberOfMonths",firstDayOfWeek:"firstDayOfWeek",locale:"locale"},outputs:{onFocus:"onFocus",onBlur:"onBlur",onClose:"onClose",onSelect:"onSelect",onClear:"onClear",onInput:"onInput",onTodayClick:"onTodayClick",onClearClick:"onClearClick",onMonthChange:"onMonthChange",onYearChange:"onYearChange",onClickOutside:"onClickOutside",onShow:"onShow"},features:[o._Bn([Iee])],ngContentSelectors:See,decls:4,vars:11,consts:[[3,"ngClass","ngStyle"],["container",""],[3,"ngIf"],[3,"class","ngStyle","ngClass","click",4,"ngIf"],["type","text","autocomplete","off",3,"value","readonly","ngStyle","placeholder","disabled","ngClass","focus","keydown","click","blur","input"],["inputfield",""],["class","p-calendar-clear-icon pi pi-times",3,"click",4,"ngIf"],["type","button","pButton","","pRipple","","class","p-datepicker-trigger","tabindex","0",3,"icon","disabled","click",4,"ngIf"],[1,"p-calendar-clear-icon","pi","pi-times",3,"click"],["type","button","pButton","","pRipple","","tabindex","0",1,"p-datepicker-trigger",3,"icon","disabled","click"],[3,"ngStyle","ngClass","click"],["contentWrapper",""],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","p-timepicker",4,"ngIf"],["class","p-datepicker-buttonbar",4,"ngIf"],[1,"p-datepicker-group-container"],["class","p-datepicker-group",4,"ngFor","ngForOf"],["class","p-monthpicker",4,"ngIf"],["class","p-yearpicker",4,"ngIf"],[1,"p-datepicker-group"],[1,"p-datepicker-header"],["class","p-datepicker-prev p-link","type","button","pRipple","",3,"keydown","click",4,"ngIf"],[1,"p-datepicker-title"],["type","button","class","p-datepicker-month p-link",3,"disabled","click","keydown",4,"ngIf"],["type","button","class","p-datepicker-year p-link",3,"disabled","click","keydown",4,"ngIf"],["class","p-datepicker-decade",4,"ngIf"],["type","button","pRipple","",1,"p-datepicker-next","p-link",3,"keydown","click"],[1,"p-datepicker-next-icon","pi","pi-chevron-right"],["class","p-datepicker-calendar-container",4,"ngIf"],["type","button","pRipple","",1,"p-datepicker-prev","p-link",3,"keydown","click"],[1,"p-datepicker-prev-icon","pi","pi-chevron-left"],["type","button",1,"p-datepicker-month","p-link",3,"disabled","click","keydown"],["type","button",1,"p-datepicker-year","p-link",3,"disabled","click","keydown"],[1,"p-datepicker-decade"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-datepicker-calendar-container"],[1,"p-datepicker-calendar"],["class","p-datepicker-weekheader p-disabled",4,"ngIf"],["scope","col",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"p-datepicker-weekheader","p-disabled"],["scope","col"],["class","p-datepicker-weeknumber",4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"p-datepicker-weeknumber"],[1,"p-disabled"],[3,"ngClass"],["draggable","false","pRipple","",3,"ngClass","click","keydown"],[1,"p-monthpicker"],["class","p-monthpicker-month","pRipple","",3,"ngClass","click","keydown",4,"ngFor","ngForOf"],["pRipple","",1,"p-monthpicker-month",3,"ngClass","click","keydown"],[1,"p-yearpicker"],["class","p-yearpicker-year","pRipple","",3,"ngClass","click","keydown",4,"ngFor","ngForOf"],["pRipple","",1,"p-yearpicker-year",3,"ngClass","click","keydown"],[1,"p-timepicker"],[1,"p-hour-picker"],["type","button","pRipple","",1,"p-link",3,"keydown","keydown.enter","keydown.space","mousedown","mouseup","keyup.enter","keyup.space","mouseleave"],[1,"pi","pi-chevron-up"],[1,"pi","pi-chevron-down"],[1,"p-separator"],[1,"p-minute-picker"],["class","p-separator",4,"ngIf"],["class","p-second-picker",4,"ngIf"],["class","p-ampm-picker",4,"ngIf"],[1,"p-second-picker"],[1,"p-ampm-picker"],["type","button","pRipple","",1,"p-link",3,"keydown","click","keydown.enter"],[1,"p-datepicker-buttonbar"],["type","button","pButton","","pRipple","",3,"label","ngClass","keydown","click"]],template:function(e,i){1&e&&(o.F$t(Eee),o.TgZ(0,"span",0,1),o.YNc(2,VX,4,17,"ng-template",2),o.YNc(3,Cee,9,28,"div",3),o.qZA()),2&e&&(o.Tol(i.styleClass),o.Q6J("ngClass",o.l5B(6,Tee,i.showIcon,i.timeOnly,i.disabled,i.focus))("ngStyle",i.style),o.xp6(2),o.Q6J("ngIf",!i.inline),o.xp6(1),o.Q6J("ngIf",i.inline||i.overlayVisible))},dependencies:[Pi,Hn,Zn,Ki,qr,vF,cw],styles:[".p-calendar{position:relative;display:inline-flex;max-width:100%}.p-calendar .p-inputtext{flex:1 1 auto;width:1%}.p-calendar-w-btn .p-inputtext{border-top-right-radius:0;border-bottom-right-radius:0}.p-calendar-w-btn .p-datepicker-trigger{border-top-left-radius:0;border-bottom-left-radius:0}.p-fluid .p-calendar{display:flex}.p-fluid .p-calendar .p-inputtext{width:1%}.p-calendar .p-datepicker{min-width:100%}.p-datepicker{width:auto;position:absolute;top:0;left:0}.p-datepicker-inline{display:inline-block;position:static;overflow-x:auto}.p-datepicker-header{display:flex;align-items:center;justify-content:space-between}.p-datepicker-header .p-datepicker-title{margin:0 auto}.p-datepicker-prev,.p-datepicker-next{cursor:pointer;display:inline-flex;justify-content:center;align-items:center;overflow:hidden;position:relative}.p-datepicker-multiple-month .p-datepicker-group-container .p-datepicker-group{flex:1 1 auto}.p-datepicker-multiple-month .p-datepicker-group-container{display:flex}.p-datepicker table{width:100%;border-collapse:collapse}.p-datepicker td>span{display:flex;justify-content:center;align-items:center;cursor:pointer;margin:0 auto;overflow:hidden;position:relative}.p-monthpicker-month{width:33.3%;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden;position:relative}.p-datepicker-buttonbar{display:flex;justify-content:space-between;align-items:center}.p-timepicker{display:flex;justify-content:center;align-items:center}.p-timepicker button{display:flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden;position:relative}.p-timepicker>div{display:flex;align-items:center;flex-direction:column}.p-datepicker-touch-ui,.p-calendar .p-datepicker-touch-ui{position:fixed;top:50%;left:50%;min-width:80vw;transform:translate(-50%,-50%)}.p-yearpicker-year{width:50%;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden;position:relative}.p-calendar-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-calendar-clearable{position:relative}\n"],encapsulation:2,data:{animation:[l_("overlayAnimation",[c_("visibleTouchUI",Ti({transform:"translate(-50%,-50%)",opacity:1})),Ph("void => visible",[Ti({opacity:0,transform:"scaleY(0.8)"}),ih("{{showTransitionParams}}",Ti({opacity:1,transform:"*"}))]),Ph("visible => void",[ih("{{hideTransitionParams}}",Ti({opacity:0}))]),Ph("void => visibleTouchUI",[Ti({opacity:0,transform:"translate3d(-50%, -40%, 0) scale(0.9)"}),ih("{{showTransitionParams}}")]),Ph("visibleTouchUI => void",[ih("{{hideTransitionParams}}",Ti({opacity:0,transform:"translate3d(-50%, -40%, 0) scale(0.9)"}))])])]},changeDetection:0}),n})(),Aee=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr,dw,yf,uw,dw,yf]}),n})(),q4=(()=>{class n{constructor(e){this.host=e,this.focused=!1}ngAfterViewChecked(){if(!this.focused&&this.autofocus){const e=pt.getFocusableElements(this.host.nativeElement);0===e.length&&this.host.nativeElement.focus(),e.length>0&&e[0].focus(),this.focused=!0}}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.SBq))},n.\u0275dir=o.lG2({type:n,selectors:[["","pAutoFocus",""]],hostAttrs:[1,"p-element"],inputs:{autofocus:"autofocus"}}),n})(),bF=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr]}),n})();const Mee=["overlay"],kee=["content"];function Ree(n,t){1&n&&o.GkF(0)}const Pee=function(n,t,e){return{showTransitionParams:n,hideTransitionParams:t,transform:e}},Oee=function(n){return{value:"visible",params:n}},Lee=function(n){return{mode:n}},Fee=function(n){return{$implicit:n}};function Nee(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",1,3),o.NdJ("click",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onOverlayContentClick(r))})("@overlayContentAnimation.start",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onOverlayContentAnimationStart(r))})("@overlayContentAnimation.done",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onOverlayContentAnimationDone(r))}),o.Hsn(2),o.YNc(3,Ree,1,0,"ng-container",4),o.qZA()}if(2&n){const e=o.oxw(2);o.Tol(e.contentStyleClass),o.Q6J("ngStyle",e.contentStyle)("ngClass","p-overlay-content")("@overlayContentAnimation",o.VKq(11,Oee,o.kEZ(7,Pee,e.showTransitionOptions,e.hideTransitionOptions,e.transformOptions[e.modal?e.overlayResponsiveDirection:"default"]))),o.xp6(3),o.Q6J("ngTemplateOutlet",e.contentTemplate)("ngTemplateOutletContext",o.VKq(15,Fee,o.VKq(13,Lee,e.overlayMode)))}}const zee=function(n,t,e,i,r,a,g,E,O,j,Y,se,be,Me){return{"p-overlay p-component":!0,"p-overlay-modal p-component-overlay p-component-overlay-enter":n,"p-overlay-center":t,"p-overlay-top":e,"p-overlay-top-start":i,"p-overlay-top-end":r,"p-overlay-bottom":a,"p-overlay-bottom-start":g,"p-overlay-bottom-end":E,"p-overlay-left":O,"p-overlay-left-start":j,"p-overlay-left-end":Y,"p-overlay-right":se,"p-overlay-right-start":be,"p-overlay-right-end":Me}};function Bee(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",1,2),o.NdJ("click",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onOverlayClick(r))}),o.YNc(2,Nee,4,17,"div",0),o.qZA()}if(2&n){const e=o.oxw();o.Tol(e.styleClass),o.Q6J("ngStyle",e.style)("ngClass",o.rFY(5,zee,[e.modal,e.modal&&"center"===e.overlayResponsiveDirection,e.modal&&"top"===e.overlayResponsiveDirection,e.modal&&"top-start"===e.overlayResponsiveDirection,e.modal&&"top-end"===e.overlayResponsiveDirection,e.modal&&"bottom"===e.overlayResponsiveDirection,e.modal&&"bottom-start"===e.overlayResponsiveDirection,e.modal&&"bottom-end"===e.overlayResponsiveDirection,e.modal&&"left"===e.overlayResponsiveDirection,e.modal&&"left-start"===e.overlayResponsiveDirection,e.modal&&"left-end"===e.overlayResponsiveDirection,e.modal&&"right"===e.overlayResponsiveDirection,e.modal&&"right-start"===e.overlayResponsiveDirection,e.modal&&"right-end"===e.overlayResponsiveDirection])),o.xp6(2),o.Q6J("ngIf",e.visible)}}const Vee=["*"],Uee={provide:xs,useExisting:(0,o.Gpc)(()=>wF),multi:!0},Hee=Ay([Ti({transform:"{{transform}}",opacity:0}),ih("{{showTransitionParams}}")]),jee=Ay([ih("{{hideTransitionParams}}",Ti({transform:"{{transform}}",opacity:0}))]);let wF=(()=>{class n{constructor(e,i,r,a,g,E){this.document=e,this.el=i,this.renderer=r,this.config=a,this.overlayService=g,this.zone=E,this.visibleChange=new o.vpe,this.onBeforeShow=new o.vpe,this.onShow=new o.vpe,this.onBeforeHide=new o.vpe,this.onHide=new o.vpe,this.onAnimationStart=new o.vpe,this.onAnimationDone=new o.vpe,this._visible=!1,this.modalVisible=!1,this.isOverlayClicked=!1,this.isOverlayContentClicked=!1,this.transformOptions={default:"scaleY(0.8)",center:"scale(0.7)",top:"translate3d(0px, -100%, 0px)","top-start":"translate3d(0px, -100%, 0px)","top-end":"translate3d(0px, -100%, 0px)",bottom:"translate3d(0px, 100%, 0px)","bottom-start":"translate3d(0px, 100%, 0px)","bottom-end":"translate3d(0px, 100%, 0px)",left:"translate3d(-100%, 0px, 0px)","left-start":"translate3d(-100%, 0px, 0px)","left-end":"translate3d(-100%, 0px, 0px)",right:"translate3d(100%, 0px, 0px)","right-start":"translate3d(100%, 0px, 0px)","right-end":"translate3d(100%, 0px, 0px)"},this.window=this.document.defaultView}get visible(){return this._visible}set visible(e){this._visible=e,this._visible&&!this.modalVisible&&(this.modalVisible=!0)}get mode(){return this._mode||this.overlayOptions?.mode}set mode(e){this._mode=e}get style(){return ti.merge(this._style,this.modal?this.overlayResponsiveOptions?.style:this.overlayOptions?.style)}set style(e){this._style=e}get styleClass(){return ti.merge(this._styleClass,this.modal?this.overlayResponsiveOptions?.styleClass:this.overlayOptions?.styleClass)}set styleClass(e){this._styleClass=e}get contentStyle(){return ti.merge(this._contentStyle,this.modal?this.overlayResponsiveOptions?.contentStyle:this.overlayOptions?.contentStyle)}set contentStyle(e){this._contentStyle=e}get contentStyleClass(){return ti.merge(this._contentStyleClass,this.modal?this.overlayResponsiveOptions?.contentStyleClass:this.overlayOptions?.contentStyleClass)}set contentStyleClass(e){this._contentStyleClass=e}get target(){const e=this._target||this.overlayOptions?.target;return void 0===e?"@prev":e}set target(e){this._target=e}get appendTo(){return this._appendTo||this.overlayOptions?.appendTo}set appendTo(e){this._appendTo=e}get autoZIndex(){const e=this._autoZIndex||this.overlayOptions?.autoZIndex;return void 0===e||e}set autoZIndex(e){this._autoZIndex=e}get baseZIndex(){const e=this._baseZIndex||this.overlayOptions?.baseZIndex;return void 0===e?0:e}set baseZIndex(e){this._baseZIndex=e}get showTransitionOptions(){const e=this._showTransitionOptions||this.overlayOptions?.showTransitionOptions;return void 0===e?".12s cubic-bezier(0, 0, 0.2, 1)":e}set showTransitionOptions(e){this._showTransitionOptions=e}get hideTransitionOptions(){const e=this._hideTransitionOptions||this.overlayOptions?.hideTransitionOptions;return void 0===e?".1s linear":e}set hideTransitionOptions(e){this._hideTransitionOptions=e}get listener(){return this._listener||this.overlayOptions?.listener}set listener(e){this._listener=e}get responsive(){return this._responsive||this.overlayOptions?.responsive}set responsive(e){this._responsive=e}get options(){return this._options}set options(e){this._options=e}get modal(){return"modal"===this.mode||this.overlayResponsiveOptions&&this.window?.matchMedia(this.overlayResponsiveOptions.media?.replace("@media","")||`(max-width: ${this.overlayResponsiveOptions.breakpoint})`).matches}get overlayMode(){return this.mode||(this.modal?"modal":"overlay")}get overlayOptions(){return{...this.config?.overlayOptions,...this.options}}get overlayResponsiveOptions(){return{...this.overlayOptions?.responsive,...this.responsive}}get overlayResponsiveDirection(){return this.overlayResponsiveOptions?.direction||"center"}get overlayEl(){return this.overlayViewChild?.nativeElement}get contentEl(){return this.contentViewChild?.nativeElement}get targetEl(){return pt.getTargetElement(this.target,this.el?.nativeElement)}ngAfterContentInit(){this.templates?.forEach(e=>{e.getType(),this.contentTemplate=e.template})}show(e,i=!1){this.onVisibleChange(!0),this.handleEvents("onShow",{overlay:e||this.overlayEl,target:this.targetEl,mode:this.overlayMode}),i&&pt.focus(this.targetEl),this.modal&&pt.addClass(this.document?.body,"p-overflow-hidden")}hide(e,i=!1){this.visible&&(this.onVisibleChange(!1),this.handleEvents("onHide",{overlay:e||this.overlayEl,target:this.targetEl,mode:this.overlayMode}),i&&pt.focus(this.targetEl),this.modal&&pt.removeClass(this.document?.body,"p-overflow-hidden"))}alignOverlay(){!this.modal&&pt.alignOverlay(this.overlayEl,this.targetEl,this.appendTo)}onVisibleChange(e){this._visible=e,this.visibleChange.emit(e)}onOverlayClick(e){this.isOverlayClicked=!0}onOverlayContentClick(e){this.overlayService.add({originalEvent:e,target:this.targetEl}),this.isOverlayContentClicked=!0}onOverlayContentAnimationStart(e){switch(e.toState){case"visible":this.handleEvents("onBeforeShow",{overlay:this.overlayEl,target:this.targetEl,mode:this.overlayMode}),this.autoZIndex&&_f.set(this.overlayMode,this.overlayEl,this.baseZIndex+this.config?.zIndex[this.overlayMode]),pt.appendOverlay(this.overlayEl,"body"===this.appendTo?this.document.body:this.appendTo,this.appendTo),this.alignOverlay();break;case"void":this.handleEvents("onBeforeHide",{overlay:this.overlayEl,target:this.targetEl,mode:this.overlayMode}),this.modal&&pt.addClass(this.overlayEl,"p-component-overlay-leave")}this.handleEvents("onAnimationStart",e)}onOverlayContentAnimationDone(e){const i=this.overlayEl||e.element.parentElement;switch(e.toState){case"visible":this.show(i,!0),this.bindListeners();break;case"void":this.hide(i,!0),this.unbindListeners(),pt.appendOverlay(this.overlayEl,this.targetEl,this.appendTo),_f.clear(i),this.modalVisible=!1}this.handleEvents("onAnimationDone",e)}handleEvents(e,i){this[e].emit(i),this.options&&this.options[e]&&this.options[e](i),this.config?.overlayOptions&&this.config?.overlayOptions[e]&&this.config?.overlayOptions[e](i)}bindListeners(){this.bindScrollListener(),this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindDocumentKeyboardListener()}unbindListeners(){this.unbindScrollListener(),this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindDocumentKeyboardListener()}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new yF(this.targetEl,e=>{(!this.listener||this.listener(e,{type:"scroll",mode:this.overlayMode,valid:!0}))&&this.hide(e,!0)})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}bindDocumentClickListener(){this.documentClickListener||(this.documentClickListener=this.renderer.listen(this.document,"click",e=>{const r=!(this.targetEl&&(this.targetEl.isSameNode(e.target)||!this.isOverlayClicked&&this.targetEl.contains(e.target))||this.isOverlayContentClicked);(this.listener?this.listener(e,{type:"outside",mode:this.overlayMode,valid:3!==e.which&&r}):r)&&this.hide(e),this.isOverlayClicked=this.isOverlayContentClicked=!1}))}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){this.documentResizeListener||(this.documentResizeListener=this.renderer.listen(this.window,"resize",e=>{(this.listener?this.listener(e,{type:"resize",mode:this.overlayMode,valid:!pt.isTouchDevice()}):!pt.isTouchDevice())&&this.hide(e,!0)}))}unbindDocumentResizeListener(){this.documentResizeListener&&(this.documentResizeListener(),this.documentResizeListener=null)}bindDocumentKeyboardListener(){this.documentKeyboardListener||this.zone.runOutsideAngular(()=>{this.documentKeyboardListener=this.renderer.listen(this.window,"keydown",e=>{this.overlayOptions.hideOnEscape&&27===e.keyCode&&(this.listener?this.listener(e,{type:"keydown",mode:this.overlayMode,valid:!pt.isTouchDevice()}):!pt.isTouchDevice())&&this.zone.run(()=>{this.hide(e,!0)})})})}unbindDocumentKeyboardListener(){this.documentKeyboardListener&&(this.documentKeyboardListener(),this.documentKeyboardListener=null)}ngOnDestroy(){this.hide(this.overlayEl,!0),this.overlayEl&&(pt.appendOverlay(this.overlayEl,this.targetEl,this.appendTo),_f.clear(this.overlayEl)),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.unbindListeners()}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(y),o.Y36(o.SBq),o.Y36(o.Qsj),o.Y36(lw),o.Y36(fk),o.Y36(o.R0b))},n.\u0275cmp=o.Xpm({type:n,selectors:[["p-overlay"]],contentQueries:function(e,i,r){if(1&e&&o.Suo(r,bp,4),2&e){let a;o.iGM(a=o.CRH())&&(i.templates=a)}},viewQuery:function(e,i){if(1&e&&(o.Gf(Mee,5),o.Gf(kee,5)),2&e){let r;o.iGM(r=o.CRH())&&(i.overlayViewChild=r.first),o.iGM(r=o.CRH())&&(i.contentViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{visible:"visible",mode:"mode",style:"style",styleClass:"styleClass",contentStyle:"contentStyle",contentStyleClass:"contentStyleClass",target:"target",appendTo:"appendTo",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",listener:"listener",responsive:"responsive",options:"options"},outputs:{visibleChange:"visibleChange",onBeforeShow:"onBeforeShow",onShow:"onShow",onBeforeHide:"onBeforeHide",onHide:"onHide",onAnimationStart:"onAnimationStart",onAnimationDone:"onAnimationDone"},features:[o._Bn([Uee])],ngContentSelectors:Vee,decls:1,vars:1,consts:[[3,"ngStyle","class","ngClass","click",4,"ngIf"],[3,"ngStyle","ngClass","click"],["overlay",""],["content",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,i){1&e&&(o.F$t(),o.YNc(0,Bee,3,20,"div",0)),2&e&&o.Q6J("ngIf",i.modalVisible)},dependencies:[Pi,Zn,Ki,qr],styles:[".p-overlay{position:absolute;top:0;left:0}.p-overlay-modal{display:flex;align-items:center;justify-content:center;position:fixed;top:0;left:0;width:100%;height:100%}.p-overlay-content{transform-origin:inherit}.p-overlay-modal>.p-overlay-content{z-index:1;width:90%}.p-overlay-top{align-items:flex-start}.p-overlay-top-start{align-items:flex-start;justify-content:flex-start}.p-overlay-top-end{align-items:flex-start;justify-content:flex-end}.p-overlay-bottom{align-items:flex-end}.p-overlay-bottom-start{align-items:flex-end;justify-content:flex-start}.p-overlay-bottom-end{align-items:flex-end;justify-content:flex-end}.p-overlay-left{justify-content:flex-start}.p-overlay-left-start{justify-content:flex-start;align-items:flex-start}.p-overlay-left-end{justify-content:flex-start;align-items:flex-end}.p-overlay-right{justify-content:flex-end}.p-overlay-right-start{justify-content:flex-end;align-items:flex-start}.p-overlay-right-end{justify-content:flex-end;align-items:flex-end}\n"],encapsulation:2,data:{animation:[l_("overlayContentAnimation",[Ph(":enter",[u_(Hee)]),Ph(":leave",[u_(jee)])])]},changeDetection:0}),n})(),mk=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr,yf,yf]}),n})();const Gee=["element"],$ee=["content"];function Wee(n,t){1&n&&o.GkF(0)}const xF=function(n,t){return{$implicit:n,options:t}};function Zee(n,t){if(1&n&&(o.ynx(0),o.YNc(1,Wee,1,0,"ng-container",7),o.BQk()),2&n){const e=o.oxw(2);o.xp6(1),o.Q6J("ngTemplateOutlet",e.contentTemplate)("ngTemplateOutletContext",o.WLB(2,xF,e.loadedItems,e.getContentOptions()))}}function qee(n,t){1&n&&o.GkF(0)}function Kee(n,t){if(1&n&&(o.ynx(0),o.YNc(1,qee,1,0,"ng-container",7),o.BQk()),2&n){const e=t.$implicit,i=t.index,r=o.oxw(3);o.xp6(1),o.Q6J("ngTemplateOutlet",r.itemTemplate)("ngTemplateOutletContext",o.WLB(2,xF,e,r.getOptions(i)))}}const Yee=function(n){return{"p-scroller-loading":n}};function Jee(n,t){if(1&n&&(o.TgZ(0,"div",8,9),o.YNc(2,Kee,2,5,"ng-container",10),o.qZA()),2&n){const e=o.oxw(2);o.Q6J("ngClass",o.VKq(4,Yee,e.d_loading))("ngStyle",e.contentStyle),o.xp6(2),o.Q6J("ngForOf",e.loadedItems)("ngForTrackBy",e._trackBy||e.index)}}function Qee(n,t){if(1&n&&o._UZ(0,"div",11),2&n){const e=o.oxw(2);o.Q6J("ngStyle",e.spacerStyle)}}function Xee(n,t){1&n&&o.GkF(0)}const ete=function(n){return{numCols:n}},K4=function(n){return{options:n}};function tte(n,t){if(1&n&&(o.ynx(0),o.YNc(1,Xee,1,0,"ng-container",7),o.BQk()),2&n){const e=t.index,i=o.oxw(4);o.xp6(1),o.Q6J("ngTemplateOutlet",i.loaderTemplate)("ngTemplateOutletContext",o.VKq(4,K4,i.getLoaderOptions(e,i.both&&o.VKq(2,ete,i._numItemsInViewport.cols))))}}function nte(n,t){if(1&n&&(o.ynx(0),o.YNc(1,tte,2,6,"ng-container",14),o.BQk()),2&n){const e=o.oxw(3);o.xp6(1),o.Q6J("ngForOf",e.loaderArr)}}function ite(n,t){1&n&&o.GkF(0)}const rte=function(){return{styleClass:"p-scroller-loading-icon"}};function ote(n,t){if(1&n&&(o.ynx(0),o.YNc(1,ite,1,0,"ng-container",7),o.BQk()),2&n){const e=o.oxw(4);o.xp6(1),o.Q6J("ngTemplateOutlet",e.loaderIconTemplate)("ngTemplateOutletContext",o.VKq(3,K4,o.DdM(2,rte)))}}function ste(n,t){1&n&&o._UZ(0,"i",16)}function ate(n,t){if(1&n&&(o.YNc(0,ote,2,5,"ng-container",0),o.YNc(1,ste,1,0,"ng-template",null,15,o.W1O)),2&n){const e=o.MAs(2),i=o.oxw(3);o.Q6J("ngIf",i.loaderIconTemplate)("ngIfElse",e)}}const lte=function(n){return{"p-component-overlay":n}};function cte(n,t){if(1&n&&(o.TgZ(0,"div",12),o.YNc(1,nte,2,1,"ng-container",0),o.YNc(2,ate,3,2,"ng-template",null,13,o.W1O),o.qZA()),2&n){const e=o.MAs(3),i=o.oxw(2);o.Q6J("ngClass",o.VKq(3,lte,!i.loaderTemplate)),o.xp6(1),o.Q6J("ngIf",i.loaderTemplate)("ngIfElse",e)}}const ute=function(n,t,e){return{"p-scroller":!0,"p-scroller-inline":n,"p-both-scroll":t,"p-horizontal-scroll":e}};function hte(n,t){if(1&n){const e=o.EpF();o.ynx(0),o.TgZ(1,"div",2,3),o.NdJ("scroll",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onContainerScroll(r))}),o.YNc(3,Zee,2,5,"ng-container",0),o.YNc(4,Jee,3,6,"ng-template",null,4,o.W1O),o.YNc(6,Qee,1,1,"div",5),o.YNc(7,cte,4,5,"div",6),o.qZA(),o.BQk()}if(2&n){const e=o.MAs(5),i=o.oxw();o.xp6(1),o.Tol(i._styleClass),o.Q6J("ngStyle",i._style)("ngClass",o.kEZ(10,ute,i.inline,i.both,i.horizontal)),o.uIk("id",i._id)("tabindex",i.tabindex),o.xp6(2),o.Q6J("ngIf",i.contentTemplate)("ngIfElse",e),o.xp6(3),o.Q6J("ngIf",i._showSpacer),o.xp6(1),o.Q6J("ngIf",!i.loaderDisabled&&i._showLoader&&i.d_loading)}}function dte(n,t){1&n&&o.GkF(0)}const pte=function(n,t){return{rows:n,columns:t}};function fte(n,t){if(1&n&&(o.ynx(0),o.YNc(1,dte,1,0,"ng-container",7),o.BQk()),2&n){const e=o.oxw(2);o.xp6(1),o.Q6J("ngTemplateOutlet",e.contentTemplate)("ngTemplateOutletContext",o.WLB(5,xF,e.items,o.WLB(2,pte,e._items,e.loadedColumns)))}}function mte(n,t){if(1&n&&(o.Hsn(0),o.YNc(1,fte,2,8,"ng-container",17)),2&n){const e=o.oxw();o.xp6(1),o.Q6J("ngIf",e.contentTemplate)}}const gte=["*"];let CF=(()=>{class n{constructor(e,i){this.cd=e,this.zone=i,this.onLazyLoad=new o.vpe,this.onScroll=new o.vpe,this.onScrollIndexChange=new o.vpe,this._tabindex=0,this._itemSize=0,this._orientation="vertical",this._step=0,this._delay=0,this._resizeDelay=10,this._appendOnly=!1,this._inline=!1,this._lazy=!1,this._disabled=!1,this._loaderDisabled=!1,this._showSpacer=!0,this._showLoader=!1,this._autoSize=!1,this.d_loading=!1,this.first=0,this.last=0,this.page=0,this.isRangeChanged=!1,this.numItemsInViewport=0,this.lastScrollPos=0,this.lazyLoadState={},this.loaderArr=[],this.spacerStyle={},this.contentStyle={},this.initialized=!1}get id(){return this._id}set id(e){this._id=e}get style(){return this._style}set style(e){this._style=e}get styleClass(){return this._styleClass}set styleClass(e){this._styleClass=e}get tabindex(){return this._tabindex}set tabindex(e){this._tabindex=e}get items(){return this._items}set items(e){this._items=e}get itemSize(){return this._itemSize}set itemSize(e){this._itemSize=e}get scrollHeight(){return this._scrollHeight}set scrollHeight(e){this._scrollHeight=e}get scrollWidth(){return this._scrollWidth}set scrollWidth(e){this._scrollWidth=e}get orientation(){return this._orientation}set orientation(e){this._orientation=e}get step(){return this._step}set step(e){this._step=e}get delay(){return this._delay}set delay(e){this._delay=e}get resizeDelay(){return this._resizeDelay}set resizeDelay(e){this._resizeDelay=e}get appendOnly(){return this._appendOnly}set appendOnly(e){this._appendOnly=e}get inline(){return this._inline}set inline(e){this._inline=e}get lazy(){return this._lazy}set lazy(e){this._lazy=e}get disabled(){return this._disabled}set disabled(e){this._disabled=e}get loaderDisabled(){return this._loaderDisabled}set loaderDisabled(e){this._loaderDisabled=e}get columns(){return this._columns}set columns(e){this._columns=e}get showSpacer(){return this._showSpacer}set showSpacer(e){this._showSpacer=e}get showLoader(){return this._showLoader}set showLoader(e){this._showLoader=e}get numToleratedItems(){return this._numToleratedItems}set numToleratedItems(e){this._numToleratedItems=e}get loading(){return this._loading}set loading(e){this._loading=e}get autoSize(){return this._autoSize}set autoSize(e){this._autoSize=e}get trackBy(){return this._trackBy}set trackBy(e){this._trackBy=e}get options(){return this._options}set options(e){this._options=e,e&&"object"==typeof e&&Object.entries(e).forEach(([i,r])=>this[`_${i}`]!==r&&(this[`_${i}`]=r))}get vertical(){return"vertical"===this._orientation}get horizontal(){return"horizontal"===this._orientation}get both(){return"both"===this._orientation}get loadedItems(){return this._items&&!this.d_loading?this.both?this._items.slice(this._appendOnly?0:this.first.rows,this.last.rows).map(e=>this._columns?e:e.slice(this._appendOnly?0:this.first.cols,this.last.cols)):this.horizontal&&this._columns?this._items:this._items.slice(this._appendOnly?0:this.first,this.last):[]}get loadedRows(){return this.d_loading?this._loaderDisabled?this.loaderArr:[]:this.loadedItems}get loadedColumns(){return this._columns&&(this.both||this.horizontal)?this.d_loading&&this._loaderDisabled?this.both?this.loaderArr[0]:this.loaderArr:this._columns.slice(this.both?this.first.cols:this.first,this.both?this.last.cols:this.last):this._columns}get isPageChanged(){return!this._step||this.page!==this.getPageByFirst()}ngOnInit(){this.setInitialState()}ngOnChanges(e){let i=!1;if(e.loading){const{previousValue:r,currentValue:a}=e.loading;this.lazy&&r!==a&&a!==this.d_loading&&(this.d_loading=a,i=!0)}if(e.orientation&&(this.lastScrollPos=this.both?{top:0,left:0}:0),e.numToleratedItems){const{previousValue:r,currentValue:a}=e.numToleratedItems;r!==a&&a!==this.d_numToleratedItems&&(this.d_numToleratedItems=a)}if(e.options){const{previousValue:r,currentValue:a}=e.options;this.lazy&&r?.loading!==a?.loading&&a?.loading!==this.d_loading&&(this.d_loading=a.loading,i=!0),r?.numToleratedItems!==a?.numToleratedItems&&a?.numToleratedItems!==this.d_numToleratedItems&&(this.d_numToleratedItems=a.numToleratedItems)}this.initialized&&!i&&(e.items?.previousValue?.length!==e.items?.currentValue?.length||e.itemSize||e.scrollHeight||e.scrollWidth)&&(this.init(),this.calculateAutoSize())}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"content":this.contentTemplate=e.template;break;case"item":default:this.itemTemplate=e.template;break;case"loader":this.loaderTemplate=e.template;break;case"loadericon":this.loaderIconTemplate=e.template}})}ngAfterViewInit(){this.viewInit()}ngAfterViewChecked(){this.initialized||this.viewInit()}ngOnDestroy(){this.unbindResizeListener(),this.contentEl=null,this.initialized=!1}viewInit(){pt.isVisible(this.elementViewChild?.nativeElement)&&(this.setInitialState(),this.setContentEl(this.contentEl),this.init(),this.defaultWidth=pt.getWidth(this.elementViewChild.nativeElement),this.defaultHeight=pt.getHeight(this.elementViewChild.nativeElement),this.defaultContentWidth=pt.getWidth(this.contentEl),this.defaultContentHeight=pt.getHeight(this.contentEl),this.initialized=!0)}init(){this._disabled||(this.setSize(),this.calculateOptions(),this.setSpacerSize(),this.bindResizeListener(),this.cd.detectChanges())}setContentEl(e){this.contentEl=e||this.contentViewChild?.nativeElement||pt.findSingle(this.elementViewChild?.nativeElement,".p-scroller-content")}setInitialState(){this.first=this.both?{rows:0,cols:0}:0,this.last=this.both?{rows:0,cols:0}:0,this.numItemsInViewport=this.both?{rows:0,cols:0}:0,this.lastScrollPos=this.both?{top:0,left:0}:0,this.d_loading=this._loading||!1,this.d_numToleratedItems=this._numToleratedItems,this.loaderArr=[],this.spacerStyle={},this.contentStyle={}}getElementRef(){return this.elementViewChild}getPageByFirst(){return Math.floor((this.first+4*this.d_numToleratedItems)/(this._step||1))}scrollTo(e){this.lastScrollPos=this.both?{top:0,left:0}:0,this.elementViewChild?.nativeElement?.scrollTo(e)}scrollToIndex(e,i="auto"){const{numToleratedItems:r}=this.calculateNumItems(),a=this.getContentPosition(),g=(Y=0,se)=>Y<=se?0:Y,E=(Y,se,be)=>Y*se+be,O=(Y=0,se=0)=>this.scrollTo({left:Y,top:se,behavior:i});let j=0;this.both?(j={rows:g(e[0],r[0]),cols:g(e[1],r[1])},O(E(j.cols,this._itemSize[1],a.left),E(j.rows,this._itemSize[0],a.top))):(j=g(e,r),this.horizontal?O(E(j,this._itemSize,a.left),0):O(0,E(j,this._itemSize,a.top))),this.isRangeChanged=this.first!==j,this.first=j}scrollInView(e,i,r="auto"){if(i){const{first:a,viewport:g}=this.getRenderedRange(),E=(Y=0,se=0)=>this.scrollTo({left:Y,top:se,behavior:r}),j="to-end"===i;if("to-start"===i){if(this.both)g.first.rows-a.rows>e[0]?E(g.first.cols*this._itemSize[1],(g.first.rows-1)*this._itemSize[0]):g.first.cols-a.cols>e[1]&&E((g.first.cols-1)*this._itemSize[1],g.first.rows*this._itemSize[0]);else if(g.first-a>e){const Y=(g.first-1)*this._itemSize;this.horizontal?E(Y,0):E(0,Y)}}else if(j)if(this.both)g.last.rows-a.rows<=e[0]+1?E(g.first.cols*this._itemSize[1],(g.first.rows+1)*this._itemSize[0]):g.last.cols-a.cols<=e[1]+1&&E((g.first.cols+1)*this._itemSize[1],g.first.rows*this._itemSize[0]);else if(g.last-a<=e+1){const Y=(g.first+1)*this._itemSize;this.horizontal?E(Y,0):E(0,Y)}}else this.scrollToIndex(e,r)}getRenderedRange(){const e=(a,g)=>Math.floor(a/(g||a));let i=this.first,r=0;if(this.elementViewChild?.nativeElement){const{scrollTop:a,scrollLeft:g}=this.elementViewChild.nativeElement;this.both?(i={rows:e(a,this._itemSize[0]),cols:e(g,this._itemSize[1])},r={rows:i.rows+this.numItemsInViewport.rows,cols:i.cols+this.numItemsInViewport.cols}):(i=e(this.horizontal?g:a,this._itemSize),r=i+this.numItemsInViewport)}return{first:this.first,last:this.last,viewport:{first:i,last:r}}}calculateNumItems(){const e=this.getContentPosition(),i=this.elementViewChild?.nativeElement?this.elementViewChild.nativeElement.offsetWidth-e.left:0,r=this.elementViewChild?.nativeElement?this.elementViewChild.nativeElement.offsetHeight-e.top:0,a=(j,Y)=>Math.ceil(j/(Y||j)),g=j=>Math.ceil(j/2),E=this.both?{rows:a(r,this._itemSize[0]),cols:a(i,this._itemSize[1])}:a(this.horizontal?i:r,this._itemSize);return{numItemsInViewport:E,numToleratedItems:this.d_numToleratedItems||(this.both?[g(E.rows),g(E.cols)]:g(E))}}calculateOptions(){const{numItemsInViewport:e,numToleratedItems:i}=this.calculateNumItems(),r=(E,O,j,Y=!1)=>this.getLast(E+O+(E<j?2:3)*j,Y),a=this.first,g=this.both?{rows:r(this.first.rows,e.rows,i[0]),cols:r(this.first.cols,e.cols,i[1],!0)}:r(this.first,e,i);this.last=g,this.numItemsInViewport=e,this.d_numToleratedItems=i,this.showLoader&&(this.loaderArr=this.both?Array.from({length:e.rows}).map(()=>Array.from({length:e.cols})):Array.from({length:e})),this._lazy&&Promise.resolve().then(()=>{this.lazyLoadState={first:this._step?this.both?{rows:0,cols:a.cols}:0:a,last:Math.min(this._step?this._step:this.last,this.items.length)},this.handleEvents("onLazyLoad",this.lazyLoadState)})}calculateAutoSize(){this._autoSize&&!this.d_loading&&Promise.resolve().then(()=>{if(this.contentEl){this.contentEl.style.minHeight=this.contentEl.style.minWidth="auto",this.contentEl.style.position="relative",this.elementViewChild.nativeElement.style.contain="none";const[e,i]=[pt.getWidth(this.contentEl),pt.getHeight(this.contentEl)];e!==this.defaultContentWidth&&(this.elementViewChild.nativeElement.style.width=""),i!==this.defaultContentHeight&&(this.elementViewChild.nativeElement.style.height="");const[r,a]=[pt.getWidth(this.elementViewChild.nativeElement),pt.getHeight(this.elementViewChild.nativeElement)];(this.both||this.horizontal)&&(this.elementViewChild.nativeElement.style.width=r<this.defaultWidth?r+"px":this._scrollWidth||this.defaultWidth+"px"),(this.both||this.vertical)&&(this.elementViewChild.nativeElement.style.height=a<this.defaultHeight?a+"px":this._scrollHeight||this.defaultHeight+"px"),this.contentEl.style.minHeight=this.contentEl.style.minWidth="",this.contentEl.style.position="",this.elementViewChild.nativeElement.style.contain=""}})}getLast(e=0,i=!1){return this._items?Math.min(i?(this._columns||this._items[0]).length:this._items.length,e):0}getContentPosition(){if(this.contentEl){const e=getComputedStyle(this.contentEl),i=parseFloat(e.paddingLeft)+Math.max(parseFloat(e.left)||0,0),r=parseFloat(e.paddingRight)+Math.max(parseFloat(e.right)||0,0),a=parseFloat(e.paddingTop)+Math.max(parseFloat(e.top)||0,0),g=parseFloat(e.paddingBottom)+Math.max(parseFloat(e.bottom)||0,0);return{left:i,right:r,top:a,bottom:g,x:i+r,y:a+g}}return{left:0,right:0,top:0,bottom:0,x:0,y:0}}setSize(){if(this.elementViewChild?.nativeElement){const e=this.elementViewChild.nativeElement.parentElement.parentElement,i=this._scrollWidth||`${this.elementViewChild.nativeElement.offsetWidth||e.offsetWidth}px`,r=this._scrollHeight||`${this.elementViewChild.nativeElement.offsetHeight||e.offsetHeight}px`,a=(g,E)=>this.elementViewChild.nativeElement.style[g]=E;this.both||this.horizontal?(a("height",r),a("width",i)):a("height",r)}}setSpacerSize(){if(this._items){const e=this.getContentPosition(),i=(r,a,g,E=0)=>this.spacerStyle={...this.spacerStyle,[`${r}`]:(a||[]).length*g+E+"px"};this.both?(i("height",this._items,this._itemSize[0],e.y),i("width",this._columns||this._items[1],this._itemSize[1],e.x)):this.horizontal?i("width",this._columns||this._items,this._itemSize,e.x):i("height",this._items,this._itemSize,e.y)}}setContentPosition(e){if(this.contentEl&&!this._appendOnly){const i=e?e.first:this.first,r=(g,E)=>g*E,a=(g=0,E=0)=>this.contentStyle={...this.contentStyle,transform:`translate3d(${g}px, ${E}px, 0)`};if(this.both)a(r(i.cols,this._itemSize[1]),r(i.rows,this._itemSize[0]));else{const g=r(i,this._itemSize);this.horizontal?a(g,0):a(0,g)}}}onScrollPositionChange(e){const i=e.target,r=this.getContentPosition(),a=(Dt,_n)=>Dt?Dt>_n?Dt-_n:Dt:0,g=(Dt,_n)=>Math.floor(Dt/(_n||Dt)),E=(Dt,_n,Ln,Bn,Un,ii)=>Dt<=Un?Un:ii?Ln-Bn-Un:_n+Un-1,O=(Dt,_n,Ln,Bn,Un,ii,si)=>Dt<=ii?0:Math.max(0,si?Dt<_n?Ln:Dt-ii:Dt>_n?Ln:Dt-2*ii),j=(Dt,_n,Ln,Bn,Un,ii=!1)=>{let si=_n+Bn+2*Un;return Dt>=Un&&(si+=Un+1),this.getLast(si,ii)},Y=a(i.scrollTop,r.top),se=a(i.scrollLeft,r.left);let be=this.both?{rows:0,cols:0}:0,Me=this.last,Ge=!1,_t=this.lastScrollPos;if(this.both){const Dt=this.lastScrollPos.top<=Y,_n=this.lastScrollPos.left<=se;if(!this._appendOnly||this._appendOnly&&(Dt||_n)){const Ln={rows:g(Y,this._itemSize[0]),cols:g(se,this._itemSize[1])},Bn={rows:E(Ln.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],Dt),cols:E(Ln.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],_n)};be={rows:O(Ln.rows,Bn.rows,this.first.rows,0,0,this.d_numToleratedItems[0],Dt),cols:O(Ln.cols,Bn.cols,this.first.cols,0,0,this.d_numToleratedItems[1],_n)},Me={rows:j(Ln.rows,be.rows,0,this.numItemsInViewport.rows,this.d_numToleratedItems[0]),cols:j(Ln.cols,be.cols,0,this.numItemsInViewport.cols,this.d_numToleratedItems[1],!0)},Ge=be.rows!==this.first.rows||Me.rows!==this.last.rows||be.cols!==this.first.cols||Me.cols!==this.last.cols||this.isRangeChanged,_t={top:Y,left:se}}}else{const Dt=this.horizontal?se:Y,_n=this.lastScrollPos<=Dt;if(!this._appendOnly||this._appendOnly&&_n){const Ln=g(Dt,this._itemSize);be=O(Ln,E(Ln,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,_n),this.first,0,0,this.d_numToleratedItems,_n),Me=j(Ln,be,0,this.numItemsInViewport,this.d_numToleratedItems),Ge=be!==this.first||Me!==this.last||this.isRangeChanged,_t=Dt}}return{first:be,last:Me,isRangeChanged:Ge,scrollPos:_t}}onScrollChange(e){const{first:i,last:r,isRangeChanged:a,scrollPos:g}=this.onScrollPositionChange(e);if(a){const E={first:i,last:r};if(this.setContentPosition(E),this.first=i,this.last=r,this.lastScrollPos=g,this.handleEvents("onScrollIndexChange",E),this._lazy&&this.isPageChanged){const O={first:this._step?Math.min(this.getPageByFirst()*this._step,this.items.length-this._step):i,last:Math.min(this._step?(this.getPageByFirst()+1)*this._step:r,this.items.length)};(this.lazyLoadState.first!==O.first||this.lazyLoadState.last!==O.last)&&this.handleEvents("onLazyLoad",O),this.lazyLoadState=O}}}onContainerScroll(e){if(this.handleEvents("onScroll",{originalEvent:e}),this._delay&&this.isPageChanged){if(this.scrollTimeout&&clearTimeout(this.scrollTimeout),!this.d_loading&&this.showLoader){const{isRangeChanged:i}=this.onScrollPositionChange(e);(i||this._step&&this.isPageChanged)&&(this.d_loading=!0,this.cd.detectChanges())}this.scrollTimeout=setTimeout(()=>{this.onScrollChange(e),this.d_loading&&this.showLoader&&(!this._lazy||void 0===this._loading)&&(this.d_loading=!1,this.page=this.getPageByFirst(),this.cd.detectChanges())},this._delay)}else!this.d_loading&&this.onScrollChange(e)}bindResizeListener(){this.windowResizeListener||this.zone.runOutsideAngular(()=>{this.windowResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.windowResizeListener),window.addEventListener("orientationchange",this.windowResizeListener)})}unbindResizeListener(){this.windowResizeListener&&(window.removeEventListener("resize",this.windowResizeListener),window.removeEventListener("orientationchange",this.windowResizeListener),this.windowResizeListener=null)}onWindowResize(){this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>{if(pt.isVisible(this.elementViewChild?.nativeElement)){const[e,i]=[pt.getWidth(this.elementViewChild.nativeElement),pt.getHeight(this.elementViewChild.nativeElement)],[r,a]=[e!==this.defaultWidth,i!==this.defaultHeight];(this.both?r||a:this.horizontal?r:this.vertical&&a)&&this.zone.run(()=>{this.d_numToleratedItems=this._numToleratedItems,this.defaultWidth=e,this.defaultHeight=i,this.defaultContentWidth=pt.getWidth(this.contentEl),this.defaultContentHeight=pt.getHeight(this.contentEl),this.init()})}},this._resizeDelay)}handleEvents(e,i){return this.options&&this.options[e]?this.options[e](i):this[e].emit(i)}getContentOptions(){return{contentStyleClass:"p-scroller-content "+(this.d_loading?"p-scroller-loading":""),items:this.loadedItems,getItemOptions:e=>this.getOptions(e),loading:this.d_loading,getLoaderOptions:(e,i)=>this.getLoaderOptions(e,i),itemSize:this._itemSize,rows:this.loadedRows,columns:this.loadedColumns,spacerStyle:this.spacerStyle,contentStyle:this.contentStyle,vertical:this.vertical,horizontal:this.horizontal,both:this.both}}getOptions(e){const i=(this._items||[]).length,r=this.both?this.first.rows+e:this.first+e;return{index:r,count:i,first:0===r,last:r===i-1,even:r%2==0,odd:r%2!=0}}getLoaderOptions(e,i){const r=this.loaderArr.length;return{index:e,count:r,first:0===e,last:e===r-1,even:e%2==0,odd:e%2!=0,...i}}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.sBO),o.Y36(o.R0b))},n.\u0275cmp=o.Xpm({type:n,selectors:[["p-scroller"]],contentQueries:function(e,i,r){if(1&e&&o.Suo(r,bp,4),2&e){let a;o.iGM(a=o.CRH())&&(i.templates=a)}},viewQuery:function(e,i){if(1&e&&(o.Gf(Gee,5),o.Gf($ee,5)),2&e){let r;o.iGM(r=o.CRH())&&(i.elementViewChild=r.first),o.iGM(r=o.CRH())&&(i.contentViewChild=r.first)}},hostAttrs:[1,"p-scroller-viewport","p-element"],inputs:{id:"id",style:"style",styleClass:"styleClass",tabindex:"tabindex",items:"items",itemSize:"itemSize",scrollHeight:"scrollHeight",scrollWidth:"scrollWidth",orientation:"orientation",step:"step",delay:"delay",resizeDelay:"resizeDelay",appendOnly:"appendOnly",inline:"inline",lazy:"lazy",disabled:"disabled",loaderDisabled:"loaderDisabled",columns:"columns",showSpacer:"showSpacer",showLoader:"showLoader",numToleratedItems:"numToleratedItems",loading:"loading",autoSize:"autoSize",trackBy:"trackBy",options:"options"},outputs:{onLazyLoad:"onLazyLoad",onScroll:"onScroll",onScrollIndexChange:"onScrollIndexChange"},features:[o.TTD],ngContentSelectors:gte,decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["disabledContainer",""],[3,"ngStyle","ngClass","scroll"],["element",""],["buildInContent",""],["class","p-scroller-spacer",3,"ngStyle",4,"ngIf"],["class","p-scroller-loader",3,"ngClass",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-scroller-content",3,"ngClass","ngStyle"],["content",""],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"p-scroller-spacer",3,"ngStyle"],[1,"p-scroller-loader",3,"ngClass"],["buildInLoader",""],[4,"ngFor","ngForOf"],["buildInLoaderIcon",""],[1,"p-scroller-loading-icon","pi","pi-spinner","pi-spin"],[4,"ngIf"]],template:function(e,i){if(1&e&&(o.F$t(),o.YNc(0,hte,8,14,"ng-container",0),o.YNc(1,mte,2,1,"ng-template",null,1,o.W1O)),2&e){const r=o.MAs(2);o.Q6J("ngIf",!i._disabled)("ngIfElse",r)}},dependencies:[Pi,Hn,Zn,Ki,qr],styles:["p-scroller{flex:1;outline:0 none}.p-scroller{position:relative;overflow:auto;contain:strict;transform:translateZ(0);will-change:scroll-position;outline:0 none}.p-scroller-content{position:absolute;top:0;left:0;min-height:100%;min-width:100%;will-change:transform}.p-scroller-spacer{position:absolute;top:0;left:0;height:1px;width:1px;transform-origin:0 0;pointer-events:none}.p-scroller-loader{position:sticky;top:0;left:0;width:100%;height:100%}.p-scroller-loader.p-component-overlay{display:flex;align-items:center;justify-content:center}.p-scroller-loading-icon{font-size:2rem}.p-scroller-inline .p-scroller-content{position:static}\n"],encapsulation:2}),n})(),fC=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr]}),n})(),_te=(()=>{class n{constructor(e,i,r,a,g){this.el=e,this.zone=i,this.config=r,this.renderer=a,this.changeDetector=g,this.escape=!0,this.autoHide=!0,this.fitContent=!0,this._tooltipOptions={tooltipPosition:"right",tooltipEvent:"hover",appendTo:"body",tooltipZIndex:"auto",escape:!0,positionTop:0,positionLeft:0,autoHide:!0}}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this.deactivate()}ngAfterViewInit(){this.zone.runOutsideAngular(()=>{if("hover"===this.getOption("tooltipEvent"))this.mouseEnterListener=this.onMouseEnter.bind(this),this.mouseLeaveListener=this.onMouseLeave.bind(this),this.clickListener=this.onInputClick.bind(this),this.el.nativeElement.addEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.addEventListener("click",this.clickListener),this.el.nativeElement.addEventListener("mouseleave",this.mouseLeaveListener);else if("focus"===this.getOption("tooltipEvent")){this.focusListener=this.onFocus.bind(this),this.blurListener=this.onBlur.bind(this);let e=this.getTarget(this.el.nativeElement);e.addEventListener("focus",this.focusListener),e.addEventListener("blur",this.blurListener)}})}ngOnChanges(e){e.tooltipPosition&&this.setOption({tooltipPosition:e.tooltipPosition.currentValue}),e.tooltipEvent&&this.setOption({tooltipEvent:e.tooltipEvent.currentValue}),e.appendTo&&this.setOption({appendTo:e.appendTo.currentValue}),e.positionStyle&&this.setOption({positionStyle:e.positionStyle.currentValue}),e.tooltipStyleClass&&this.setOption({tooltipStyleClass:e.tooltipStyleClass.currentValue}),e.tooltipZIndex&&this.setOption({tooltipZIndex:e.tooltipZIndex.currentValue}),e.escape&&this.setOption({escape:e.escape.currentValue}),e.showDelay&&this.setOption({showDelay:e.showDelay.currentValue}),e.hideDelay&&this.setOption({hideDelay:e.hideDelay.currentValue}),e.life&&this.setOption({life:e.life.currentValue}),e.positionTop&&this.setOption({positionTop:e.positionTop.currentValue}),e.positionLeft&&this.setOption({positionLeft:e.positionLeft.currentValue}),e.disabled&&this.setOption({disabled:e.disabled.currentValue}),e.text&&(this.setOption({tooltipLabel:e.text.currentValue}),this.active&&(e.text.currentValue?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide())),e.autoHide&&this.setOption({autoHide:e.autoHide.currentValue}),e.tooltipOptions&&(this._tooltipOptions={...this._tooltipOptions,...e.tooltipOptions.currentValue},this.deactivate(),this.active&&(this.getOption("tooltipLabel")?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide()))}isAutoHide(){return this.getOption("autoHide")}onMouseEnter(e){!this.container&&!this.showTimeout&&this.activate()}onMouseLeave(e){(this.isAutoHide()||!(pt.hasClass(e.toElement,"p-tooltip")||pt.hasClass(e.toElement,"p-tooltip-arrow")||pt.hasClass(e.toElement,"p-tooltip-text")||pt.hasClass(e.relatedTarget,"p-tooltip")))&&this.deactivate()}onFocus(e){this.activate()}onBlur(e){this.deactivate()}onInputClick(e){this.deactivate()}activate(){if(this.active=!0,this.clearHideTimeout(),this.getOption("showDelay")?this.showTimeout=setTimeout(()=>{this.show()},this.getOption("showDelay")):this.show(),this.getOption("life")){let e=this.getOption("showDelay")?this.getOption("life")+this.getOption("showDelay"):this.getOption("life");this.hideTimeout=setTimeout(()=>{this.hide()},e)}}deactivate(){this.active=!1,this.clearShowTimeout(),this.getOption("hideDelay")?(this.clearHideTimeout(),this.hideTimeout=setTimeout(()=>{this.hide()},this.getOption("hideDelay"))):this.hide()}create(){this.container&&(this.clearHideTimeout(),this.remove()),this.container=document.createElement("div");let e=document.createElement("div");e.className="p-tooltip-arrow",this.container.appendChild(e),this.tooltipText=document.createElement("div"),this.tooltipText.className="p-tooltip-text",this.updateText(),this.getOption("positionStyle")&&(this.container.style.position=this.getOption("positionStyle")),this.container.appendChild(this.tooltipText),"body"===this.getOption("appendTo")?document.body.appendChild(this.container):"target"===this.getOption("appendTo")?pt.appendChild(this.container,this.el.nativeElement):pt.appendChild(this.container,this.getOption("appendTo")),this.container.style.display="inline-block",this.fitContent&&(this.container.style.width="fit-content"),this.isAutoHide()||this.bindContainerMouseleaveListener()}bindContainerMouseleaveListener(){this.containerMouseleaveListener||(this.containerMouseleaveListener=this.renderer.listen(this.container??this.container.nativeElement,"mouseleave",i=>{this.deactivate()}))}unbindContainerMouseleaveListener(){this.containerMouseleaveListener&&(this.bindContainerMouseleaveListener(),this.containerMouseleaveListener=null)}show(){!this.getOption("tooltipLabel")||this.getOption("disabled")||(this.create(),this.align(),pt.fadeIn(this.container,250),"auto"===this.getOption("tooltipZIndex")?_f.set("tooltip",this.container,this.config.zIndex.tooltip):this.container.style.zIndex=this.getOption("tooltipZIndex"),this.bindDocumentResizeListener(),this.bindScrollListener())}hide(){"auto"===this.getOption("tooltipZIndex")&&_f.clear(this.container),this.remove()}updateText(){this.getOption("escape")?(this.tooltipText.innerHTML="",this.tooltipText.appendChild(document.createTextNode(this.getOption("tooltipLabel")))):this.tooltipText.innerHTML=this.getOption("tooltipLabel")}align(){switch(this.getOption("tooltipPosition")){case"top":this.alignTop(),this.isOutOfBounds()&&(this.alignBottom(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"bottom":this.alignBottom(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"left":this.alignLeft(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()));break;case"right":this.alignRight(),this.isOutOfBounds()&&(this.alignLeft(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()))}}getHostOffset(){if("body"===this.getOption("appendTo")||"target"===this.getOption("appendTo")){let e=this.el.nativeElement.getBoundingClientRect();return{left:e.left+pt.getWindowScrollLeft(),top:e.top+pt.getWindowScrollTop()}}return{left:0,top:0}}alignRight(){this.preAlign("right");let e=this.getHostOffset(),i=e.left+pt.getOuterWidth(this.el.nativeElement),r=e.top+(pt.getOuterHeight(this.el.nativeElement)-pt.getOuterHeight(this.container))/2;this.container.style.left=i+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}alignLeft(){this.preAlign("left");let e=this.getHostOffset(),i=e.left-pt.getOuterWidth(this.container),r=e.top+(pt.getOuterHeight(this.el.nativeElement)-pt.getOuterHeight(this.container))/2;this.container.style.left=i+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}alignTop(){this.preAlign("top");let e=this.getHostOffset(),i=e.left+(pt.getOuterWidth(this.el.nativeElement)-pt.getOuterWidth(this.container))/2,r=e.top-pt.getOuterHeight(this.container);this.container.style.left=i+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}alignBottom(){this.preAlign("bottom");let e=this.getHostOffset(),i=e.left+(pt.getOuterWidth(this.el.nativeElement)-pt.getOuterWidth(this.container))/2,r=e.top+pt.getOuterHeight(this.el.nativeElement);this.container.style.left=i+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}setOption(e){this._tooltipOptions={...this._tooltipOptions,...e}}getOption(e){return this._tooltipOptions[e]}getTarget(e){return pt.hasClass(e,"p-inputwrapper")?pt.findSingle(e,"input"):e}preAlign(e){this.container.style.left="-999px",this.container.style.top="-999px";let i="p-tooltip p-component p-tooltip-"+e;this.container.className=this.getOption("tooltipStyleClass")?i+" "+this.getOption("tooltipStyleClass"):i}isOutOfBounds(){let e=this.container.getBoundingClientRect(),i=e.top,r=e.left,a=pt.getOuterWidth(this.container),g=pt.getOuterHeight(this.container),E=pt.getViewport();return r+a>E.width||r<0||i<0||i+g>E.height}onWindowResize(e){this.hide()}bindDocumentResizeListener(){this.zone.runOutsideAngular(()=>{this.resizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.resizeListener)})}unbindDocumentResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new yF(this.el.nativeElement,()=>{this.container&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}unbindEvents(){if("hover"===this.getOption("tooltipEvent"))this.el.nativeElement.removeEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.removeEventListener("mouseleave",this.mouseLeaveListener),this.el.nativeElement.removeEventListener("click",this.clickListener);else if("focus"===this.getOption("tooltipEvent")){let e=this.getTarget(this.el.nativeElement);e.removeEventListener("focus",this.focusListener),e.removeEventListener("blur",this.blurListener)}this.unbindDocumentResizeListener()}remove(){this.container&&this.container.parentElement&&("body"===this.getOption("appendTo")?document.body.removeChild(this.container):"target"===this.getOption("appendTo")?this.el.nativeElement.removeChild(this.container):pt.removeChild(this.container,this.getOption("appendTo"))),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.unbindContainerMouseleaveListener(),this.clearTimeouts(),this.container=null,this.scrollHandler=null}clearShowTimeout(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null)}clearHideTimeout(){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout()}ngOnDestroy(){this.unbindEvents(),this.container&&_f.clear(this.container),this.remove(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null)}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.SBq),o.Y36(o.R0b),o.Y36(lw),o.Y36(o.Qsj),o.Y36(o.sBO))},n.\u0275dir=o.lG2({type:n,selectors:[["","pTooltip",""]],hostAttrs:[1,"p-element"],inputs:{tooltipPosition:"tooltipPosition",tooltipEvent:"tooltipEvent",appendTo:"appendTo",positionStyle:"positionStyle",tooltipStyleClass:"tooltipStyleClass",tooltipZIndex:"tooltipZIndex",escape:"escape",showDelay:"showDelay",hideDelay:"hideDelay",life:"life",positionTop:"positionTop",positionLeft:"positionLeft",autoHide:"autoHide",fitContent:"fitContent",text:["pTooltip","text"],disabled:["tooltipDisabled","disabled"],tooltipOptions:"tooltipOptions"},features:[o.TTD]}),n})(),yte=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr]}),n})();function vte(n,t){if(1&n&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&n){const e=o.oxw();let i;o.xp6(1),o.Oqu(null!==(i=e.label)&&void 0!==i?i:"empty")}}function bte(n,t){1&n&&o.GkF(0)}const JS=function(n){return{height:n}},wte=function(n,t){return{"p-dropdown-item":!0,"p-highlight":n,"p-disabled":t}},EF=function(n){return{$implicit:n}},xte=["container"],Cte=["filter"],Ete=["in"],Tte=["editableInput"],Ste=["items"],Ite=["scroller"],Dte=["overlay"];function Ate(n,t){if(1&n&&(o.ynx(0),o._uU(1),o.BQk()),2&n){const e=o.oxw(2);o.xp6(1),o.Oqu(e.label||"empty")}}function Mte(n,t){1&n&&o.GkF(0)}const kte=function(n){return{"p-dropdown-label p-inputtext":!0,"p-dropdown-label-empty":n}};function Rte(n,t){if(1&n&&(o.TgZ(0,"span",14),o.YNc(1,Ate,2,1,"ng-container",15),o.YNc(2,Mte,1,0,"ng-container",16),o.qZA()),2&n){const e=o.oxw();o.Q6J("ngClass",o.VKq(9,kte,null==e.label||0===e.label.length))("pTooltip",e.tooltip)("tooltipPosition",e.tooltipPosition)("positionStyle",e.tooltipPositionStyle)("tooltipStyleClass",e.tooltipStyleClass),o.uIk("id",e.labelId),o.xp6(1),o.Q6J("ngIf",!e.selectedItemTemplate),o.xp6(1),o.Q6J("ngTemplateOutlet",e.selectedItemTemplate)("ngTemplateOutletContext",o.VKq(11,EF,e.selectedOption))}}const Pte=function(n){return{"p-dropdown-label p-inputtext p-placeholder":!0,"p-dropdown-label-empty":n}};function Ote(n,t){if(1&n&&(o.TgZ(0,"span",17),o._uU(1),o.qZA()),2&n){const e=o.oxw();o.Q6J("ngClass",o.VKq(2,Pte,null==e.placeholder||0===e.placeholder.length)),o.xp6(1),o.Oqu(e.placeholder||"empty")}}function Lte(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"input",18,19),o.NdJ("input",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onEditableInputChange(r))})("focus",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onEditableInputFocus(r))})("blur",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onInputBlur(r))}),o.qZA()}if(2&n){const e=o.oxw();o.Q6J("disabled",e.disabled),o.uIk("maxlength",e.maxlength)("placeholder",e.placeholder)("aria-expanded",e.overlayVisible)}}function Fte(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"i",20),o.NdJ("click",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.clear(r))}),o.qZA()}}function Nte(n,t){1&n&&o.GkF(0)}function zte(n,t){1&n&&o.GkF(0)}const Y4=function(n){return{options:n}};function Bte(n,t){if(1&n&&(o.ynx(0),o.YNc(1,zte,1,0,"ng-container",16),o.BQk()),2&n){const e=o.oxw(3);o.xp6(1),o.Q6J("ngTemplateOutlet",e.filterTemplate)("ngTemplateOutletContext",o.VKq(2,Y4,e.filterOptions))}}function Vte(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",30)(1,"input",31,32),o.NdJ("keydown.enter",function(r){return r.preventDefault()})("keydown",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.onKeydown(r,!1))})("input",function(r){o.CHM(e);const a=o.oxw(3);return o.KtG(a.onFilterInputChange(r))}),o.qZA(),o._UZ(3,"span",33),o.qZA()}if(2&n){const e=o.oxw(3);o.xp6(1),o.Q6J("value",e.filterValue||""),o.uIk("placeholder",e.filterPlaceholder)("aria-label",e.ariaFilterLabel)("aria-activedescendant",e.overlayVisible?"p-highlighted-option":e.labelId)}}function Ute(n,t){if(1&n&&(o.TgZ(0,"div",27),o.NdJ("click",function(i){return i.stopPropagation()}),o.YNc(1,Bte,2,4,"ng-container",28),o.YNc(2,Vte,4,4,"ng-template",null,29,o.W1O),o.qZA()),2&n){const e=o.MAs(3),i=o.oxw(2);o.xp6(1),o.Q6J("ngIf",i.filterTemplate)("ngIfElse",e)}}function Hte(n,t){1&n&&o.GkF(0)}const J4=function(n,t){return{$implicit:n,options:t}};function jte(n,t){if(1&n&&o.YNc(0,Hte,1,0,"ng-container",16),2&n){const e=t.$implicit,i=t.options;o.oxw(2);const r=o.MAs(7);o.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",o.WLB(2,J4,e,i))}}function Gte(n,t){1&n&&o.GkF(0)}function $te(n,t){if(1&n&&o.YNc(0,Gte,1,0,"ng-container",16),2&n){const e=t.options,i=o.oxw(4);o.Q6J("ngTemplateOutlet",i.loaderTemplate)("ngTemplateOutletContext",o.VKq(2,Y4,e))}}function Wte(n,t){1&n&&(o.ynx(0),o.YNc(1,$te,1,4,"ng-template",36),o.BQk())}function Zte(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"p-scroller",34,35),o.NdJ("onLazyLoad",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onLazyLoad.emit(r))}),o.YNc(2,jte,1,5,"ng-template",13),o.YNc(3,Wte,2,0,"ng-container",15),o.qZA()}if(2&n){const e=o.oxw(2);o.Akn(o.VKq(8,JS,e.scrollHeight)),o.Q6J("items",e.optionsToDisplay)("itemSize",e.virtualScrollItemSize||e._itemSize)("autoSize",!0)("lazy",e.lazy)("options",e.virtualScrollOptions),o.xp6(3),o.Q6J("ngIf",e.loaderTemplate)}}function qte(n,t){1&n&&o.GkF(0)}const Kte=function(){return{}};function Yte(n,t){if(1&n&&(o.ynx(0),o.YNc(1,qte,1,0,"ng-container",16),o.BQk()),2&n){o.oxw();const e=o.MAs(7),i=o.oxw();o.xp6(1),o.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",o.WLB(3,J4,i.optionsToDisplay,o.DdM(2,Kte)))}}function Jte(n,t){if(1&n&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&n){const e=o.oxw().$implicit,i=o.oxw(4);o.xp6(1),o.Oqu(i.getOptionGroupLabel(e)||"empty")}}function Qte(n,t){1&n&&o.GkF(0)}function Xte(n,t){1&n&&o.GkF(0)}const Q4=function(n,t){return{$implicit:n,selectedOption:t}};function ene(n,t){if(1&n&&(o.TgZ(0,"li",42),o.YNc(1,Jte,2,1,"span",15),o.YNc(2,Qte,1,0,"ng-container",16),o.qZA(),o.YNc(3,Xte,1,0,"ng-container",16)),2&n){const e=t.$implicit,i=o.oxw(2).options,r=o.MAs(5),a=o.oxw(2);o.Q6J("ngStyle",o.VKq(6,JS,i.itemSize+"px")),o.xp6(1),o.Q6J("ngIf",!a.groupTemplate),o.xp6(1),o.Q6J("ngTemplateOutlet",a.groupTemplate)("ngTemplateOutletContext",o.VKq(8,EF,e)),o.xp6(1),o.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",o.WLB(10,Q4,a.getOptionGroupChildren(e),a.selectedOption))}}function tne(n,t){if(1&n&&(o.ynx(0),o.YNc(1,ene,4,13,"ng-template",41),o.BQk()),2&n){const e=o.oxw().$implicit;o.xp6(1),o.Q6J("ngForOf",e)}}function nne(n,t){1&n&&o.GkF(0)}function ine(n,t){if(1&n&&(o.ynx(0),o.YNc(1,nne,1,0,"ng-container",16),o.BQk()),2&n){const e=o.oxw().$implicit,i=o.MAs(5),r=o.oxw(2);o.xp6(1),o.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",o.WLB(2,Q4,e,r.selectedOption))}}function rne(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"p-dropdownItem",43),o.NdJ("onClick",function(r){o.CHM(e);const a=o.oxw(4);return o.KtG(a.onItemClick(r))}),o.qZA()}if(2&n){const e=t.$implicit,i=o.oxw().selectedOption,r=o.oxw(3);o.Q6J("option",e)("selected",i==e)("label",r.getOptionLabel(e))("disabled",r.isOptionDisabled(e))("template",r.itemTemplate)}}function one(n,t){1&n&&o.YNc(0,rne,1,5,"ng-template",41),2&n&&o.Q6J("ngForOf",t.$implicit)}function sne(n,t){if(1&n&&(o.ynx(0),o._uU(1),o.BQk()),2&n){const e=o.oxw(4);o.xp6(1),o.hij(" ",e.emptyFilterMessageLabel," ")}}function ane(n,t){1&n&&o.GkF(0,null,45)}function lne(n,t){if(1&n&&(o.TgZ(0,"li",44),o.YNc(1,sne,2,1,"ng-container",28),o.YNc(2,ane,2,0,"ng-container",22),o.qZA()),2&n){const e=o.oxw().options,i=o.oxw(2);o.Q6J("ngStyle",o.VKq(4,JS,e.itemSize+"px")),o.xp6(1),o.Q6J("ngIf",!i.emptyFilterTemplate&&!i.emptyTemplate)("ngIfElse",i.emptyFilter),o.xp6(1),o.Q6J("ngTemplateOutlet",i.emptyFilterTemplate||i.emptyTemplate)}}function cne(n,t){if(1&n&&(o.ynx(0),o._uU(1),o.BQk()),2&n){const e=o.oxw(4);o.xp6(1),o.hij(" ",e.emptyMessageLabel," ")}}function une(n,t){1&n&&o.GkF(0,null,46)}function hne(n,t){if(1&n&&(o.TgZ(0,"li",44),o.YNc(1,cne,2,1,"ng-container",28),o.YNc(2,une,2,0,"ng-container",22),o.qZA()),2&n){const e=o.oxw().options,i=o.oxw(2);o.Q6J("ngStyle",o.VKq(4,JS,e.itemSize+"px")),o.xp6(1),o.Q6J("ngIf",!i.emptyTemplate)("ngIfElse",i.empty),o.xp6(1),o.Q6J("ngTemplateOutlet",i.emptyTemplate)}}function dne(n,t){if(1&n&&(o.TgZ(0,"ul",37,38),o.YNc(2,tne,2,1,"ng-container",15),o.YNc(3,ine,2,5,"ng-container",15),o.YNc(4,one,1,1,"ng-template",null,39,o.W1O),o.YNc(6,lne,3,6,"li",40),o.YNc(7,hne,3,6,"li",40),o.qZA()),2&n){const e=t.options,i=o.oxw(2);o.Akn(e.contentStyle),o.Q6J("ngClass",e.contentStyleClass),o.uIk("id",i.listId),o.xp6(2),o.Q6J("ngIf",i.group),o.xp6(1),o.Q6J("ngIf",!i.group),o.xp6(3),o.Q6J("ngIf",i.filterValue&&i.isEmpty()),o.xp6(1),o.Q6J("ngIf",!i.filterValue&&i.isEmpty())}}function pne(n,t){1&n&&o.GkF(0)}function fne(n,t){if(1&n&&(o.TgZ(0,"div",21),o.YNc(1,Nte,1,0,"ng-container",22),o.YNc(2,Ute,4,2,"div",23),o.TgZ(3,"div",24),o.YNc(4,Zte,4,10,"p-scroller",25),o.YNc(5,Yte,2,6,"ng-container",15),o.YNc(6,dne,8,8,"ng-template",null,26,o.W1O),o.qZA(),o.YNc(8,pne,1,0,"ng-container",22),o.qZA()),2&n){const e=o.oxw();o.Tol(e.panelStyleClass),o.Q6J("ngClass","p-dropdown-panel p-component")("ngStyle",e.panelStyle),o.xp6(1),o.Q6J("ngTemplateOutlet",e.headerTemplate),o.xp6(1),o.Q6J("ngIf",e.filter),o.xp6(1),o.Udp("max-height",e.virtualScroll?"auto":e.scrollHeight||"auto"),o.xp6(1),o.Q6J("ngIf",e.virtualScroll),o.xp6(1),o.Q6J("ngIf",!e.virtualScroll),o.xp6(3),o.Q6J("ngTemplateOutlet",e.footerTemplate)}}const mne=function(n,t,e,i){return{"p-dropdown p-component":!0,"p-disabled":n,"p-dropdown-open":t,"p-focus":e,"p-dropdown-clearable":i}},gne={provide:xs,useExisting:(0,o.Gpc)(()=>X4),multi:!0};let _ne=(()=>{class n{constructor(){this.onClick=new o.vpe}onOptionClick(e){this.onClick.emit({originalEvent:e,option:this.option})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=o.Xpm({type:n,selectors:[["p-dropdownItem"]],hostAttrs:[1,"p-element"],inputs:{option:"option",selected:"selected",label:"label",disabled:"disabled",visible:"visible",itemSize:"itemSize",template:"template"},outputs:{onClick:"onClick"},decls:3,vars:15,consts:[["role","option","pRipple","",3,"ngStyle","id","ngClass","click"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,i){1&e&&(o.TgZ(0,"li",0),o.NdJ("click",function(a){return i.onOptionClick(a)}),o.YNc(1,vte,2,1,"span",1),o.YNc(2,bte,1,0,"ng-container",2),o.qZA()),2&e&&(o.Q6J("ngStyle",o.VKq(8,JS,i.itemSize+"px"))("id",i.selected?"p-highlighted-option":"")("ngClass",o.WLB(10,wte,i.selected,i.disabled)),o.uIk("aria-label",i.label)("aria-selected",i.selected),o.xp6(1),o.Q6J("ngIf",!i.template),o.xp6(1),o.Q6J("ngTemplateOutlet",i.template)("ngTemplateOutletContext",o.VKq(13,EF,i.option)))},dependencies:[Pi,Zn,Ki,qr,cw],encapsulation:2}),n})(),X4=(()=>{class n{constructor(e,i,r,a,g,E){this.el=e,this.renderer=i,this.cd=r,this.zone=a,this.filterService=g,this.config=E,this.scrollHeight="200px",this.resetFilterOnHide=!1,this.dropdownIcon="pi pi-chevron-down",this.optionGroupChildren="items",this.autoDisplayFirst=!0,this.emptyFilterMessage="",this.emptyMessage="",this.lazy=!1,this.filterMatchMode="contains",this.tooltip="",this.tooltipPosition="right",this.tooltipPositionStyle="absolute",this.autofocusFilter=!0,this.overlayDirection="end",this.onChange=new o.vpe,this.onFilter=new o.vpe,this.onFocus=new o.vpe,this.onBlur=new o.vpe,this.onClick=new o.vpe,this.onShow=new o.vpe,this.onHide=new o.vpe,this.onClear=new o.vpe,this.onLazyLoad=new o.vpe,this.onModelChange=()=>{},this.onModelTouched=()=>{},this.id=YS()}get disabled(){return this._disabled}set disabled(e){e&&(this.focused=!1,this.overlayVisible&&this.hide()),this._disabled=e,this.cd.destroyed||this.cd.detectChanges()}get itemSize(){return this._itemSize}set itemSize(e){this._itemSize=e,console.warn("The itemSize property is deprecated, use virtualScrollItemSize property instead.")}get autoZIndex(){return this._autoZIndex}set autoZIndex(e){this._autoZIndex=e,console.warn("The autoZIndex property is deprecated since v14.2.0, use overlayOptions property instead.")}get baseZIndex(){return this._baseZIndex}set baseZIndex(e){this._baseZIndex=e,console.warn("The baseZIndex property is deprecated since v14.2.0, use overlayOptions property instead.")}get showTransitionOptions(){return this._showTransitionOptions}set showTransitionOptions(e){this._showTransitionOptions=e,console.warn("The showTransitionOptions property is deprecated since v14.2.0, use overlayOptions property instead.")}get hideTransitionOptions(){return this._hideTransitionOptions}set hideTransitionOptions(e){this._hideTransitionOptions=e,console.warn("The hideTransitionOptions property is deprecated since v14.2.0, use overlayOptions property instead.")}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"item":default:this.itemTemplate=e.template;break;case"selectedItem":this.selectedItemTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"filter":this.filterTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"emptyfilter":this.emptyFilterTemplate=e.template;break;case"empty":this.emptyTemplate=e.template;break;case"group":this.groupTemplate=e.template;break;case"loader":this.loaderTemplate=e.template}})}ngOnInit(){this.optionsToDisplay=this.options,this.updateSelectedOption(null),this.labelId=this.id+"_label",this.listId=this.id+"_list",this.filterBy&&(this.filterOptions={filter:e=>this.onFilterInputChange(e),reset:()=>this.resetFilter()})}get options(){return this._options}set options(e){this._options=e,this.optionsToDisplay=this._options,this.updateSelectedOption(this.value),this.selectedOption=this.findOption(this.value,this.optionsToDisplay),!this.selectedOption&&ti.isNotEmpty(this.value)&&!this.editable&&(this.value=null,this.onModelChange(this.value)),this.optionsChanged=!0,this._filterValue&&this._filterValue.length&&this.activateFilter()}get filterValue(){return this._filterValue}set filterValue(e){this._filterValue=e,this.activateFilter()}ngAfterViewInit(){this.editable&&this.updateEditableLabel()}get label(){return"number"==typeof this.selectedOption&&(this.selectedOption=this.selectedOption.toString()),this.selectedOption?this.getOptionLabel(this.selectedOption):null}get emptyMessageLabel(){return this.emptyMessage||this.config.getTranslation(wp.EMPTY_MESSAGE)}get emptyFilterMessageLabel(){return this.emptyFilterMessage||this.config.getTranslation(wp.EMPTY_FILTER_MESSAGE)}get filled(){return"string"==typeof this.value?!!this.value:this.value||null!=this.value||null!=this.value}get isVisibleClearIcon(){return null!=this.value&&""!==this.value&&this.showClear&&!this.disabled}updateEditableLabel(){this.editableInputViewChild&&this.editableInputViewChild.nativeElement&&(this.editableInputViewChild.nativeElement.value=this.selectedOption?this.getOptionLabel(this.selectedOption):this.value||"")}getOptionLabel(e){return this.optionLabel?ti.resolveFieldData(e,this.optionLabel):e&&void 0!==e.label?e.label:e}getOptionValue(e){return this.optionValue?ti.resolveFieldData(e,this.optionValue):!this.optionLabel&&e&&void 0!==e.value?e.value:e}isOptionDisabled(e){return this.optionDisabled?ti.resolveFieldData(e,this.optionDisabled):!(!e||void 0===e.disabled)&&e.disabled}getOptionGroupLabel(e){return this.optionGroupLabel?ti.resolveFieldData(e,this.optionGroupLabel):e&&void 0!==e.label?e.label:e}getOptionGroupChildren(e){return this.optionGroupChildren?ti.resolveFieldData(e,this.optionGroupChildren):e.items}onItemClick(e){const i=e.option;this.isOptionDisabled(i)||(this.selectItem(e.originalEvent,i),this.accessibleViewChild.nativeElement.focus({preventScroll:!0})),setTimeout(()=>{this.hide()},1)}selectItem(e,i){this.selectedOption!=i&&(this.selectedOption=i,this.value=this.getOptionValue(i),this.onModelChange(this.value),this.updateEditableLabel(),this.onChange.emit({originalEvent:e,value:this.value}))}ngAfterViewChecked(){if(this.optionsChanged&&this.overlayVisible&&(this.optionsChanged=!1,this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.overlayViewChild&&this.overlayViewChild.alignOverlay()},1)})),this.selectedOptionUpdated&&this.itemsWrapper){let e=pt.findSingle(this.overlayViewChild.overlayViewChild.nativeElement,"li.p-highlight");e&&pt.scrollInView(this.itemsWrapper,e),this.selectedOptionUpdated=!1}}writeValue(e){this.filter&&this.resetFilter(),this.value=e,this.updateSelectedOption(e),this.updateEditableLabel(),this.cd.markForCheck()}resetFilter(){this._filterValue=null,this.filterViewChild&&this.filterViewChild.nativeElement&&(this.filterViewChild.nativeElement.value=""),this.optionsToDisplay=this.options}updateSelectedOption(e){this.selectedOption=this.findOption(e,this.optionsToDisplay),this.autoDisplayFirst&&!this.placeholder&&!this.selectedOption&&this.optionsToDisplay&&this.optionsToDisplay.length&&!this.editable&&(this.selectedOption=this.group?this.optionsToDisplay[0].items[0]:this.optionsToDisplay[0],this.value=this.getOptionValue(this.selectedOption),this.onModelChange(this.value)),this.selectedOptionUpdated=!0}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}onMouseclick(e){this.disabled||this.readonly||this.isInputClick(e)||(this.onClick.emit(e),this.accessibleViewChild.nativeElement.focus({preventScroll:!0}),this.overlayVisible?this.hide():this.show(),this.cd.detectChanges())}isInputClick(e){return pt.hasClass(e.target,"p-dropdown-clear-icon")||e.target.isSameNode(this.accessibleViewChild.nativeElement)||this.editableInputViewChild&&e.target.isSameNode(this.editableInputViewChild.nativeElement)}isEmpty(){return!this.optionsToDisplay||this.optionsToDisplay&&0===this.optionsToDisplay.length}onEditableInputFocus(e){this.focused=!0,this.hide(),this.onFocus.emit(e)}onEditableInputChange(e){this.value=e.target.value,this.updateSelectedOption(this.value),this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value})}show(){this.overlayVisible=!0,this.cd.markForCheck()}onOverlayAnimationStart(e){if("visible"===e.toState){if(this.itemsWrapper=pt.findSingle(this.overlayViewChild.overlayViewChild.nativeElement,this.virtualScroll?".p-scroller":".p-dropdown-items-wrapper"),this.virtualScroll&&this.scroller.setContentEl(this.itemsViewChild.nativeElement),this.options&&this.options.length)if(this.virtualScroll){const i=this.selectedOption?this.findOptionIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1;-1!==i&&this.scroller.scrollToIndex(i)}else{let i=pt.findSingle(this.itemsWrapper,".p-dropdown-item.p-highlight");i&&i.scrollIntoView({block:"nearest",inline:"center"})}this.filterViewChild&&this.filterViewChild.nativeElement&&(this.preventModelTouched=!0,this.autofocusFilter&&this.filterViewChild.nativeElement.focus()),this.onShow.emit(e)}"void"===e.toState&&(this.itemsWrapper=null,this.onModelTouched(),this.onHide.emit(e))}hide(){this.overlayVisible=!1,this.filter&&this.resetFilterOnHide&&this.resetFilter(),this.cd.markForCheck()}onInputFocus(e){this.focused=!0,this.onFocus.emit(e)}onInputBlur(e){this.focused=!1,this.onBlur.emit(e),this.preventModelTouched||this.onModelTouched(),this.preventModelTouched=!1}findPrevEnabledOption(e){let i;if(this.optionsToDisplay&&this.optionsToDisplay.length){for(let r=e-1;0<=r;r--){let a=this.optionsToDisplay[r];if(!this.isOptionDisabled(a)){i=a;break}}if(!i)for(let r=this.optionsToDisplay.length-1;r>=e;r--){let a=this.optionsToDisplay[r];if(!this.isOptionDisabled(a)){i=a;break}}}return i}findNextEnabledOption(e){let i;if(this.optionsToDisplay&&this.optionsToDisplay.length){for(let r=e+1;r<this.optionsToDisplay.length;r++){let a=this.optionsToDisplay[r];if(!this.isOptionDisabled(a)){i=a;break}}if(!i)for(let r=0;r<e;r++){let a=this.optionsToDisplay[r];if(!this.isOptionDisabled(a)){i=a;break}}}return i}onKeydown(e,i){if(!this.readonly&&this.optionsToDisplay&&null!==this.optionsToDisplay.length)switch(e.which){case 40:if(!this.overlayVisible&&e.altKey)this.show();else if(this.group){let r=this.selectedOption?this.findOptionGroupIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1;if(-1!==r){let a=r.itemIndex+1;a<this.getOptionGroupChildren(this.optionsToDisplay[r.groupIndex]).length?(this.selectItem(e,this.getOptionGroupChildren(this.optionsToDisplay[r.groupIndex])[a]),this.selectedOptionUpdated=!0):this.optionsToDisplay[r.groupIndex+1]&&(this.selectItem(e,this.getOptionGroupChildren(this.optionsToDisplay[r.groupIndex+1])[0]),this.selectedOptionUpdated=!0)}else this.optionsToDisplay&&this.optionsToDisplay.length>0&&this.selectItem(e,this.getOptionGroupChildren(this.optionsToDisplay[0])[0])}else{let r=this.selectedOption?this.findOptionIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1,a=this.findNextEnabledOption(r);a&&(this.selectItem(e,a),this.selectedOptionUpdated=!0)}e.preventDefault();break;case 38:if(this.group){let r=this.selectedOption?this.findOptionGroupIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1;if(-1!==r){let a=r.itemIndex-1;if(a>=0)this.selectItem(e,this.getOptionGroupChildren(this.optionsToDisplay[r.groupIndex])[a]),this.selectedOptionUpdated=!0;else if(a<0){let g=this.optionsToDisplay[r.groupIndex-1];g&&(this.selectItem(e,this.getOptionGroupChildren(g)[this.getOptionGroupChildren(g).length-1]),this.selectedOptionUpdated=!0)}}}else{let r=this.selectedOption?this.findOptionIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1,a=this.findPrevEnabledOption(r);a&&(this.selectItem(e,a),this.selectedOptionUpdated=!0)}e.preventDefault();break;case 32:i&&(this.overlayVisible?this.hide():this.show(),e.preventDefault());break;case 13:this.overlayVisible&&(!this.filter||this.optionsToDisplay&&this.optionsToDisplay.length>0)?this.hide():this.overlayVisible||this.show(),e.preventDefault();break;case 27:case 9:this.hide();break;default:i&&!e.metaKey&&17!==e.which&&this.search(e)}}search(e){this.searchTimeout&&clearTimeout(this.searchTimeout);const i=e.key;let r;if(this.previousSearchChar=this.currentSearchChar,this.currentSearchChar=i,this.searchValue=this.previousSearchChar===this.currentSearchChar?this.currentSearchChar:this.searchValue?this.searchValue+i:i,this.group){let a=this.selectedOption?this.findOptionGroupIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):{groupIndex:0,itemIndex:0};r=this.searchOptionWithinGroup(a)}else{let a=this.selectedOption?this.findOptionIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1;r=this.searchOption(++a)}r&&!this.isOptionDisabled(r)&&(this.selectItem(e,r),this.selectedOptionUpdated=!0),this.searchTimeout=setTimeout(()=>{this.searchValue=null},250)}searchOption(e){let i;return this.searchValue&&(i=this.searchOptionInRange(e,this.optionsToDisplay.length),i||(i=this.searchOptionInRange(0,e))),i}searchOptionInRange(e,i){for(let r=e;r<i;r++){let a=this.optionsToDisplay[r];if(this.getOptionLabel(a).toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))&&!this.isOptionDisabled(a))return a}return null}searchOptionWithinGroup(e){if(this.searchValue){for(let r=e.groupIndex;r<this.optionsToDisplay.length;r++)for(let a=e.groupIndex===r?e.itemIndex+1:0;a<this.getOptionGroupChildren(this.optionsToDisplay[r]).length;a++){let g=this.getOptionGroupChildren(this.optionsToDisplay[r])[a];if(this.getOptionLabel(g).toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))&&!this.isOptionDisabled(g))return g}for(let r=0;r<=e.groupIndex;r++)for(let a=0;a<(e.groupIndex===r?e.itemIndex:this.getOptionGroupChildren(this.optionsToDisplay[r]).length);a++){let g=this.getOptionGroupChildren(this.optionsToDisplay[r])[a];if(this.getOptionLabel(g).toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))&&!this.isOptionDisabled(g))return g}}return null}findOptionIndex(e,i){let r=-1;if(i)for(let a=0;a<i.length;a++)if(null==e&&null==this.getOptionValue(i[a])||ti.equals(e,this.getOptionValue(i[a]),this.dataKey)){r=a;break}return r}findOptionGroupIndex(e,i){let r,a;if(i)for(let g=0;g<i.length&&(r=g,a=this.findOptionIndex(e,this.getOptionGroupChildren(i[g])),-1===a);g++);return-1!==a?{groupIndex:r,itemIndex:a}:-1}findOption(e,i,r){if(this.group&&!r){let a;if(i&&i.length)for(let g of i)if(a=this.findOption(e,this.getOptionGroupChildren(g),!0),a)break;return a}{let a=this.findOptionIndex(e,i);return-1!=a?i[a]:null}}onFilterInputChange(e){let i=e.target.value;i&&i.length?(this._filterValue=i,this.activateFilter()):(this._filterValue=null,this.optionsToDisplay=this.options),this.virtualScroll&&this.scroller.scrollToIndex(0),this.optionsChanged=!0,this.onFilter.emit({originalEvent:e,filter:this._filterValue})}activateFilter(){let e=(this.filterBy||this.optionLabel||"label").split(",");if(this.options&&this.options.length){if(this.group){let i=[];for(let r of this.options){let a=this.filterService.filter(this.getOptionGroupChildren(r),e,this.filterValue,this.filterMatchMode,this.filterLocale);a&&a.length&&i.push({...r,[this.optionGroupChildren]:a})}this.optionsToDisplay=i}else this.optionsToDisplay=this.filterService.filter(this.options,e,this.filterValue,this.filterMatchMode,this.filterLocale);this.optionsChanged=!0}}applyFocus(){this.editable?pt.findSingle(this.el.nativeElement,".p-dropdown-label.p-inputtext").focus():pt.findSingle(this.el.nativeElement,"input[readonly]").focus()}focus(){this.applyFocus()}clear(e){this.value=null,this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value}),this.updateSelectedOption(this.value),this.updateEditableLabel(),this.onClear.emit(e)}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.SBq),o.Y36(o.Qsj),o.Y36(o.sBO),o.Y36(o.R0b),o.Y36(H4),o.Y36(lw))},n.\u0275cmp=o.Xpm({type:n,selectors:[["p-dropdown"]],contentQueries:function(e,i,r){if(1&e&&o.Suo(r,bp,4),2&e){let a;o.iGM(a=o.CRH())&&(i.templates=a)}},viewQuery:function(e,i){if(1&e&&(o.Gf(xte,5),o.Gf(Cte,5),o.Gf(Ete,5),o.Gf(Tte,5),o.Gf(Ste,5),o.Gf(Ite,5),o.Gf(Dte,5)),2&e){let r;o.iGM(r=o.CRH())&&(i.containerViewChild=r.first),o.iGM(r=o.CRH())&&(i.filterViewChild=r.first),o.iGM(r=o.CRH())&&(i.accessibleViewChild=r.first),o.iGM(r=o.CRH())&&(i.editableInputViewChild=r.first),o.iGM(r=o.CRH())&&(i.itemsViewChild=r.first),o.iGM(r=o.CRH())&&(i.scroller=r.first),o.iGM(r=o.CRH())&&(i.overlayViewChild=r.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:4,hostBindings:function(e,i){2&e&&o.ekj("p-inputwrapper-filled",i.filled)("p-inputwrapper-focus",i.focused||i.overlayVisible)},inputs:{scrollHeight:"scrollHeight",filter:"filter",name:"name",style:"style",panelStyle:"panelStyle",styleClass:"styleClass",panelStyleClass:"panelStyleClass",readonly:"readonly",required:"required",editable:"editable",appendTo:"appendTo",tabindex:"tabindex",placeholder:"placeholder",filterPlaceholder:"filterPlaceholder",filterLocale:"filterLocale",inputId:"inputId",selectId:"selectId",dataKey:"dataKey",filterBy:"filterBy",autofocus:"autofocus",resetFilterOnHide:"resetFilterOnHide",dropdownIcon:"dropdownIcon",optionLabel:"optionLabel",optionValue:"optionValue",optionDisabled:"optionDisabled",optionGroupLabel:"optionGroupLabel",optionGroupChildren:"optionGroupChildren",autoDisplayFirst:"autoDisplayFirst",group:"group",showClear:"showClear",emptyFilterMessage:"emptyFilterMessage",emptyMessage:"emptyMessage",lazy:"lazy",virtualScroll:"virtualScroll",virtualScrollItemSize:"virtualScrollItemSize",virtualScrollOptions:"virtualScrollOptions",overlayOptions:"overlayOptions",ariaFilterLabel:"ariaFilterLabel",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",filterMatchMode:"filterMatchMode",maxlength:"maxlength",tooltip:"tooltip",tooltipPosition:"tooltipPosition",tooltipPositionStyle:"tooltipPositionStyle",tooltipStyleClass:"tooltipStyleClass",autofocusFilter:"autofocusFilter",overlayDirection:"overlayDirection",disabled:"disabled",itemSize:"itemSize",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",options:"options",filterValue:"filterValue"},outputs:{onChange:"onChange",onFilter:"onFilter",onFocus:"onFocus",onBlur:"onBlur",onClick:"onClick",onShow:"onShow",onHide:"onHide",onClear:"onClear",onLazyLoad:"onLazyLoad"},features:[o._Bn([gne])],decls:14,vars:32,consts:[[3,"ngClass","ngStyle","click"],["container",""],[1,"p-hidden-accessible"],["type","text","readonly","","aria-haspopup","listbox","aria-haspopup","listbox","pAutoFocus","","role","combobox",3,"disabled","autofocus","focus","blur","keydown"],["in",""],[3,"ngClass","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass",4,"ngIf"],[3,"ngClass",4,"ngIf"],["type","text","class","p-dropdown-label p-inputtext","aria-haspopup","listbox",3,"disabled","input","focus","blur",4,"ngIf"],["class","p-dropdown-clear-icon pi pi-times",3,"click",4,"ngIf"],["role","button","aria-label","dropdown trigger","aria-haspopup","listbox",1,"p-dropdown-trigger"],[1,"p-dropdown-trigger-icon",3,"ngClass"],[3,"visible","options","target","appendTo","autoZIndex","baseZIndex","showTransitionOptions","hideTransitionOptions","visibleChange","onAnimationStart","onHide"],["overlay",""],["pTemplate","content"],[3,"ngClass","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass"],["type","text","aria-haspopup","listbox",1,"p-dropdown-label","p-inputtext",3,"disabled","input","focus","blur"],["editableInput",""],[1,"p-dropdown-clear-icon","pi","pi-times",3,"click"],[3,"ngClass","ngStyle"],[4,"ngTemplateOutlet"],["class","p-dropdown-header",3,"click",4,"ngIf"],[1,"p-dropdown-items-wrapper"],[3,"items","style","itemSize","autoSize","lazy","options","onLazyLoad",4,"ngIf"],["buildInItems",""],[1,"p-dropdown-header",3,"click"],[4,"ngIf","ngIfElse"],["builtInFilterElement",""],[1,"p-dropdown-filter-container"],["type","text","autocomplete","off",1,"p-dropdown-filter","p-inputtext","p-component",3,"value","keydown.enter","keydown","input"],["filter",""],[1,"p-dropdown-filter-icon","pi","pi-search"],[3,"items","itemSize","autoSize","lazy","options","onLazyLoad"],["scroller",""],["pTemplate","loader"],["role","listbox",1,"p-dropdown-items",3,"ngClass"],["items",""],["itemslist",""],["class","p-dropdown-empty-message",3,"ngStyle",4,"ngIf"],["ngFor","",3,"ngForOf"],[1,"p-dropdown-item-group",3,"ngStyle"],[3,"option","selected","label","disabled","template","onClick"],[1,"p-dropdown-empty-message",3,"ngStyle"],["emptyFilter",""],["empty",""]],template:function(e,i){1&e&&(o.TgZ(0,"div",0,1),o.NdJ("click",function(a){return i.onMouseclick(a)}),o.TgZ(2,"div",2)(3,"input",3,4),o.NdJ("focus",function(a){return i.onInputFocus(a)})("blur",function(a){return i.onInputBlur(a)})("keydown",function(a){return i.onKeydown(a,!0)}),o.qZA()(),o.YNc(5,Rte,3,13,"span",5),o.YNc(6,Ote,2,4,"span",6),o.YNc(7,Lte,2,4,"input",7),o.YNc(8,Fte,1,0,"i",8),o.TgZ(9,"div",9),o._UZ(10,"span",10),o.qZA(),o.TgZ(11,"p-overlay",11,12),o.NdJ("visibleChange",function(a){return i.overlayVisible=a})("onAnimationStart",function(a){return i.onOverlayAnimationStart(a)})("onHide",function(){return i.hide()}),o.YNc(13,fne,9,11,"ng-template",13),o.qZA()()),2&e&&(o.Tol(i.styleClass),o.Q6J("ngClass",o.l5B(27,mne,i.disabled,i.overlayVisible,i.focused,i.showClear&&!i.disabled))("ngStyle",i.style),o.xp6(3),o.Q6J("disabled",i.disabled)("autofocus",i.autofocus),o.uIk("id",i.inputId)("placeholder",i.placeholder)("aria-label",i.ariaLabel)("aria-expanded",!1)("aria-labelledby",i.ariaLabelledBy)("tabindex",i.tabindex)("aria-activedescendant",i.overlayVisible?i.labelId:null),o.xp6(2),o.Q6J("ngIf",!i.editable&&null!=i.label),o.xp6(1),o.Q6J("ngIf",!i.editable&&null==i.label),o.xp6(1),o.Q6J("ngIf",i.editable),o.xp6(1),o.Q6J("ngIf",i.isVisibleClearIcon),o.xp6(1),o.uIk("aria-expanded",i.overlayVisible),o.xp6(1),o.Q6J("ngClass",i.dropdownIcon),o.xp6(1),o.Q6J("visible",i.overlayVisible)("options",i.overlayOptions)("target","@parent")("appendTo",i.appendTo)("autoZIndex",i.autoZIndex)("baseZIndex",i.baseZIndex)("showTransitionOptions",i.showTransitionOptions)("hideTransitionOptions",i.hideTransitionOptions))},dependencies:[Pi,Hn,Zn,Ki,qr,wF,bp,_te,CF,q4,_ne],styles:[".p-dropdown{display:inline-flex;cursor:pointer;position:relative;-webkit-user-select:none;user-select:none}.p-dropdown-clear-icon{position:absolute;top:50%;margin-top:-.5rem}.p-dropdown-trigger{display:flex;align-items:center;justify-content:center;flex-shrink:0}.p-dropdown-label{display:block;white-space:nowrap;overflow:hidden;flex:1 1 auto;width:1%;text-overflow:ellipsis;cursor:pointer}.p-dropdown-label-empty{overflow:hidden;visibility:hidden}input.p-dropdown-label{cursor:default}.p-dropdown-items-wrapper{overflow:auto}.p-dropdown-item{cursor:pointer;font-weight:400;white-space:nowrap;position:relative;overflow:hidden}.p-dropdown-items{margin:0;padding:0;list-style-type:none}.p-dropdown-filter{width:100%}.p-dropdown-filter-container{position:relative}.p-dropdown-filter-icon{position:absolute;top:50%;margin-top:-.5rem}.p-fluid .p-dropdown{display:flex}.p-fluid .p-dropdown .p-dropdown-label{width:1%}\n"],encapsulation:2,changeDetection:0}),n})(),TF=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr,mk,yf,yte,uw,fC,bF,mk,yf,fC]}),n})(),yne=(()=>{class n{constructor(e,i,r){this.el=e,this.ngModel=i,this.cd=r}ngAfterViewInit(){this.updateFilledState(),this.cd.detectChanges()}ngDoCheck(){this.updateFilledState()}onInput(e){this.updateFilledState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length||this.ngModel&&this.ngModel.model}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.SBq),o.Y36(Bm,8),o.Y36(o.sBO))},n.\u0275dir=o.lG2({type:n,selectors:[["","pInputText",""]],hostAttrs:[1,"p-inputtext","p-component","p-element"],hostVars:2,hostBindings:function(e,i){1&e&&o.NdJ("input",function(a){return i.onInput(a)}),2&e&&o.ekj("p-filled",i.filled)}}),n})(),SF=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr]}),n})();const vne=["input"];function bne(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"i",6),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.clear())}),o.qZA()}}const e5=function(){return{"p-inputnumber-button p-inputnumber-button-up":!0}},t5=function(){return{"p-inputnumber-button p-inputnumber-button-down":!0}};function wne(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"span",7)(1,"button",8),o.NdJ("mousedown",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onUpButtonMouseDown(r))})("mouseup",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.onUpButtonMouseUp())})("mouseleave",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.onUpButtonMouseLeave())})("keydown",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onUpButtonKeyDown(r))})("keyup",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.onUpButtonKeyUp())}),o.qZA(),o.TgZ(2,"button",8),o.NdJ("mousedown",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onDownButtonMouseDown(r))})("mouseup",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.onDownButtonMouseUp())})("mouseleave",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.onDownButtonMouseLeave())})("keydown",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onDownButtonKeyDown(r))})("keyup",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.onDownButtonKeyUp())}),o.qZA()()}if(2&n){const e=o.oxw();o.xp6(1),o.Tol(e.incrementButtonClass),o.Q6J("ngClass",o.DdM(10,e5))("icon",e.incrementButtonIcon)("disabled",e.disabled),o.xp6(1),o.Tol(e.decrementButtonClass),o.Q6J("ngClass",o.DdM(11,t5))("icon",e.decrementButtonIcon)("disabled",e.disabled)}}function xne(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"button",8),o.NdJ("mousedown",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onUpButtonMouseDown(r))})("mouseup",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.onUpButtonMouseUp())})("mouseleave",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.onUpButtonMouseLeave())})("keydown",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onUpButtonKeyDown(r))})("keyup",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.onUpButtonKeyUp())}),o.qZA()}if(2&n){const e=o.oxw();o.Tol(e.incrementButtonClass),o.Q6J("ngClass",o.DdM(5,e5))("icon",e.incrementButtonIcon)("disabled",e.disabled)}}function Cne(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"button",8),o.NdJ("mousedown",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onDownButtonMouseDown(r))})("mouseup",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.onDownButtonMouseUp())})("mouseleave",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.onDownButtonMouseLeave())})("keydown",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onDownButtonKeyDown(r))})("keyup",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.onDownButtonKeyUp())}),o.qZA()}if(2&n){const e=o.oxw();o.Tol(e.decrementButtonClass),o.Q6J("ngClass",o.DdM(5,t5))("icon",e.decrementButtonIcon)("disabled",e.disabled)}}const Ene=function(n,t,e){return{"p-inputnumber p-component":!0,"p-inputnumber-buttons-stacked":n,"p-inputnumber-buttons-horizontal":t,"p-inputnumber-buttons-vertical":e}},Tne={provide:xs,useExisting:(0,o.Gpc)(()=>n5),multi:!0};let n5=(()=>{class n{constructor(e,i){this.el=e,this.cd=i,this.showButtons=!1,this.format=!0,this.buttonLayout="stacked",this.incrementButtonIcon="pi pi-angle-up",this.decrementButtonIcon="pi pi-angle-down",this.readonly=!1,this.step=1,this.allowEmpty=!0,this.mode="decimal",this.useGrouping=!0,this.showClear=!1,this.onInput=new o.vpe,this.onFocus=new o.vpe,this.onBlur=new o.vpe,this.onKeyDown=new o.vpe,this.onClear=new o.vpe,this.onModelChange=()=>{},this.onModelTouched=()=>{},this.groupChar="",this.prefixChar="",this.suffixChar=""}get disabled(){return this._disabled}set disabled(e){e&&(this.focused=!1),this._disabled=e,this.timer&&this.clearTimer()}ngOnChanges(e){["locale","localeMatcher","mode","currency","currencyDisplay","useGrouping","minFractionDigits","maxFractionDigits","prefix","suffix"].some(r=>!!e[r])&&this.updateConstructParser()}ngOnInit(){this.constructParser(),this.initialized=!0}getOptions(){return{localeMatcher:this.localeMatcher,style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,useGrouping:this.useGrouping,minimumFractionDigits:this.minFractionDigits,maximumFractionDigits:this.maxFractionDigits}}constructParser(){this.numberFormat=new Intl.NumberFormat(this.locale,this.getOptions());const e=[...new Intl.NumberFormat(this.locale,{useGrouping:!1}).format(9876543210)].reverse(),i=new Map(e.map((r,a)=>[r,a]));this._numeral=new RegExp(`[${e.join("")}]`,"g"),this._group=this.getGroupingExpression(),this._minusSign=this.getMinusSignExpression(),this._currency=this.getCurrencyExpression(),this._decimal=this.getDecimalExpression(),this._suffix=this.getSuffixExpression(),this._prefix=this.getPrefixExpression(),this._index=r=>i.get(r)}updateConstructParser(){this.initialized&&this.constructParser()}escapeRegExp(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}getDecimalExpression(){const e=new Intl.NumberFormat(this.locale,{...this.getOptions(),useGrouping:!1});return new RegExp(`[${e.format(1.1).replace(this._currency,"").trim().replace(this._numeral,"")}]`,"g")}getGroupingExpression(){const e=new Intl.NumberFormat(this.locale,{useGrouping:!0});return this.groupChar=e.format(1e6).trim().replace(this._numeral,"").charAt(0),new RegExp(`[${this.groupChar}]`,"g")}getMinusSignExpression(){const e=new Intl.NumberFormat(this.locale,{useGrouping:!1});return new RegExp(`[${e.format(-1).trim().replace(this._numeral,"")}]`,"g")}getCurrencyExpression(){if(this.currency){const e=new Intl.NumberFormat(this.locale,{style:"currency",currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});return new RegExp(`[${e.format(1).replace(/\s/g,"").replace(this._numeral,"").replace(this._group,"")}]`,"g")}return new RegExp("[]","g")}getPrefixExpression(){if(this.prefix)this.prefixChar=this.prefix;else{const e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay});this.prefixChar=e.format(1).split("1")[0]}return new RegExp(`${this.escapeRegExp(this.prefixChar||"")}`,"g")}getSuffixExpression(){if(this.suffix)this.suffixChar=this.suffix;else{const e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});this.suffixChar=e.format(1).split("1")[1]}return new RegExp(`${this.escapeRegExp(this.suffixChar||"")}`,"g")}formatValue(e){if(null!=e){if("-"===e)return e;if(this.format){let r=new Intl.NumberFormat(this.locale,this.getOptions()).format(e);return this.prefix&&(r=this.prefix+r),this.suffix&&(r+=this.suffix),r}return e.toString()}return""}parseValue(e){let i=e.replace(this._suffix,"").replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").replace(this._group,"").replace(this._minusSign,"-").replace(this._decimal,".").replace(this._numeral,this._index);if(i){if("-"===i)return i;let r=+i;return isNaN(r)?null:r}return null}repeat(e,i,r){if(this.readonly)return;let a=i||500;this.clearTimer(),this.timer=setTimeout(()=>{this.repeat(e,40,r)},a),this.spin(e,r)}spin(e,i){let r=this.step*i,a=this.parseValue(this.input.nativeElement.value)||0,g=this.validateValue(a+r);this.maxlength&&this.maxlength<this.formatValue(g).length||(this.updateInput(g,null,"spin",null),this.updateModel(e,g),this.handleOnInput(e,a,g))}clear(){this.value=null,this.onModelChange(this.value),this.onClear.emit()}onUpButtonMouseDown(e){this.input.nativeElement.focus(),this.repeat(e,null,1),e.preventDefault()}onUpButtonMouseUp(){this.clearTimer()}onUpButtonMouseLeave(){this.clearTimer()}onUpButtonKeyDown(e){(32===e.keyCode||13===e.keyCode)&&this.repeat(e,null,1)}onUpButtonKeyUp(){this.clearTimer()}onDownButtonMouseDown(e){this.input.nativeElement.focus(),this.repeat(e,null,-1),e.preventDefault()}onDownButtonMouseUp(){this.clearTimer()}onDownButtonMouseLeave(){this.clearTimer()}onDownButtonKeyUp(){this.clearTimer()}onDownButtonKeyDown(e){(32===e.keyCode||13===e.keyCode)&&this.repeat(e,null,-1)}onUserInput(e){this.readonly||(this.isSpecialChar&&(e.target.value=this.lastValue),this.isSpecialChar=!1)}onInputKeyDown(e){if(this.readonly)return;if(this.lastValue=e.target.value,e.shiftKey||e.altKey)return void(this.isSpecialChar=!0);let i=e.target.selectionStart,r=e.target.selectionEnd,a=e.target.value,g=null;switch(e.altKey&&e.preventDefault(),e.which){case 38:this.spin(e,1),e.preventDefault();break;case 40:this.spin(e,-1),e.preventDefault();break;case 37:this.isNumeralChar(a.charAt(i-1))||e.preventDefault();break;case 39:this.isNumeralChar(a.charAt(i))||e.preventDefault();break;case 13:g=this.validateValue(this.parseValue(this.input.nativeElement.value)),this.input.nativeElement.value=this.formatValue(g),this.input.nativeElement.setAttribute("aria-valuenow",g),this.updateModel(e,g);break;case 8:if(e.preventDefault(),i===r){const E=a.charAt(i-1),{decimalCharIndex:O,decimalCharIndexWithoutPrefix:j}=this.getDecimalCharIndexes(a);if(this.isNumeralChar(E)){const Y=this.getDecimalLength(a);if(this._group.test(E))this._group.lastIndex=0,g=a.slice(0,i-2)+a.slice(i-1);else if(this._decimal.test(E))this._decimal.lastIndex=0,Y?this.input.nativeElement.setSelectionRange(i-1,i-1):g=a.slice(0,i-1)+a.slice(i);else if(O>0&&i>O){const se=this.isDecimalMode()&&(this.minFractionDigits||0)<Y?"":"0";g=a.slice(0,i-1)+se+a.slice(i)}else 1===j?(g=a.slice(0,i-1)+"0"+a.slice(i),g=this.parseValue(g)>0?g:""):g=a.slice(0,i-1)+a.slice(i)}this.updateValue(e,g,null,"delete-single")}else g=this.deleteRange(a,i,r),this.updateValue(e,g,null,"delete-range");break;case 46:if(e.preventDefault(),i===r){const E=a.charAt(i),{decimalCharIndex:O,decimalCharIndexWithoutPrefix:j}=this.getDecimalCharIndexes(a);if(this.isNumeralChar(E)){const Y=this.getDecimalLength(a);if(this._group.test(E))this._group.lastIndex=0,g=a.slice(0,i)+a.slice(i+2);else if(this._decimal.test(E))this._decimal.lastIndex=0,Y?this.input.nativeElement.setSelectionRange(i+1,i+1):g=a.slice(0,i)+a.slice(i+1);else if(O>0&&i>O){const se=this.isDecimalMode()&&(this.minFractionDigits||0)<Y?"":"0";g=a.slice(0,i)+se+a.slice(i+1)}else 1===j?(g=a.slice(0,i)+"0"+a.slice(i+1),g=this.parseValue(g)>0?g:""):g=a.slice(0,i)+a.slice(i+1)}this.updateValue(e,g,null,"delete-back-single")}else g=this.deleteRange(a,i,r),this.updateValue(e,g,null,"delete-range")}this.onKeyDown.emit(e)}onInputKeyPress(e){if(this.readonly)return;let i=e.which||e.keyCode,r=String.fromCharCode(i);const a=this.isDecimalSign(r),g=this.isMinusSign(r);13!=i&&e.preventDefault(),(48<=i&&i<=57||g||a)&&this.insert(e,r,{isDecimalSign:a,isMinusSign:g})}onPaste(e){if(!this.disabled&&!this.readonly){e.preventDefault();let i=(e.clipboardData||window.clipboardData).getData("Text");if(i){let r=this.parseValue(i);null!=r&&this.insert(e,r.toString())}}}allowMinusSign(){return null==this.min||this.min<0}isMinusSign(e){return!(!this._minusSign.test(e)&&"-"!==e||(this._minusSign.lastIndex=0,0))}isDecimalSign(e){return!!this._decimal.test(e)&&(this._decimal.lastIndex=0,!0)}isDecimalMode(){return"decimal"===this.mode}getDecimalCharIndexes(e){let i=e.search(this._decimal);this._decimal.lastIndex=0;const a=e.replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").search(this._decimal);return this._decimal.lastIndex=0,{decimalCharIndex:i,decimalCharIndexWithoutPrefix:a}}getCharIndexes(e){const i=e.search(this._decimal);this._decimal.lastIndex=0;const r=e.search(this._minusSign);this._minusSign.lastIndex=0;const a=e.search(this._suffix);this._suffix.lastIndex=0;const g=e.search(this._currency);return this._currency.lastIndex=0,{decimalCharIndex:i,minusCharIndex:r,suffixCharIndex:a,currencyCharIndex:g}}insert(e,i,r={isDecimalSign:!1,isMinusSign:!1}){const a=i.search(this._minusSign);if(this._minusSign.lastIndex=0,!this.allowMinusSign()&&-1!==a)return;let g=this.input.nativeElement.selectionStart,E=this.input.nativeElement.selectionEnd,O=this.input.nativeElement.value.trim();const{decimalCharIndex:j,minusCharIndex:Y,suffixCharIndex:se,currencyCharIndex:be}=this.getCharIndexes(O);let Me;if(r.isMinusSign)0===g&&(Me=O,(-1===Y||0!==E)&&(Me=this.insertText(O,i,0,E)),this.updateValue(e,Me,i,"insert"));else if(r.isDecimalSign)j>0&&g===j?this.updateValue(e,O,i,"insert"):(j>g&&j<E||-1===j&&this.maxFractionDigits)&&(Me=this.insertText(O,i,g,E),this.updateValue(e,Me,i,"insert"));else{const Ge=this.numberFormat.resolvedOptions().maximumFractionDigits,_t=g!==E?"range-insert":"insert";if(j>0&&g>j){if(g+i.length-(j+1)<=Ge){const Dt=be>=g?be-1:se>=g?se:O.length;Me=O.slice(0,g)+i+O.slice(g+i.length,Dt)+O.slice(Dt),this.updateValue(e,Me,i,_t)}}else Me=this.insertText(O,i,g,E),this.updateValue(e,Me,i,_t)}}insertText(e,i,r,a){if(2===("."===i?i:i.split(".")).length){const E=e.slice(r,a).search(this._decimal);return this._decimal.lastIndex=0,E>0?e.slice(0,r)+this.formatValue(i)+e.slice(a):e||this.formatValue(i)}return a-r===e.length?this.formatValue(i):0===r?i+e.slice(a):a===e.length?e.slice(0,r)+i:e.slice(0,r)+i+e.slice(a)}deleteRange(e,i,r){let a;return a=r-i===e.length?"":0===i?e.slice(r):r===e.length?e.slice(0,i):e.slice(0,i)+e.slice(r),a}initCursor(){let e=this.input.nativeElement.selectionStart,i=this.input.nativeElement.value,r=i.length,a=null,g=(this.prefixChar||"").length;i=i.replace(this._prefix,""),e-=g;let E=i.charAt(e);if(this.isNumeralChar(E))return e+g;let O=e-1;for(;O>=0;){if(E=i.charAt(O),this.isNumeralChar(E)){a=O+g;break}O--}if(null!==a)this.input.nativeElement.setSelectionRange(a+1,a+1);else{for(O=e;O<r;){if(E=i.charAt(O),this.isNumeralChar(E)){a=O+g;break}O++}null!==a&&this.input.nativeElement.setSelectionRange(a,a)}return a||0}onInputClick(){!this.readonly&&this.input.nativeElement.value!==pt.getSelection()&&this.initCursor()}isNumeralChar(e){return!(1!==e.length||!(this._numeral.test(e)||this._decimal.test(e)||this._group.test(e)||this._minusSign.test(e))||(this.resetRegex(),0))}resetRegex(){this._numeral.lastIndex=0,this._decimal.lastIndex=0,this._group.lastIndex=0,this._minusSign.lastIndex=0}updateValue(e,i,r,a){let g=this.input.nativeElement.value,E=null;null!=i&&(E=this.parseValue(i),E=E||this.allowEmpty?E:0,this.updateInput(E,r,a,i),this.handleOnInput(e,g,E))}handleOnInput(e,i,r){this.isValueChanged(i,r)&&this.onInput.emit({originalEvent:e,value:r,formattedValue:i})}isValueChanged(e,i){return null===i&&null!==e||null!=i&&i!==("string"==typeof e?this.parseValue(e):e)}validateValue(e){return"-"===e||null==e?null:null!=this.min&&e<this.min?this.min:null!=this.max&&e>this.max?this.max:e}updateInput(e,i,r,a){i=i||"";let g=this.input.nativeElement.value,E=this.formatValue(e),O=g.length;if(E!==a&&(E=this.concatValues(E,a)),0===O){this.input.nativeElement.value=E,this.input.nativeElement.setSelectionRange(0,0);const Y=this.initCursor()+i.length;this.input.nativeElement.setSelectionRange(Y,Y)}else{let j=this.input.nativeElement.selectionStart,Y=this.input.nativeElement.selectionEnd;if(this.maxlength&&this.maxlength<E.length)return;this.input.nativeElement.value=E;let se=E.length;if("range-insert"===r){const be=this.parseValue((g||"").slice(0,j)),Ge=(null!==be?be.toString():"").split("").join(`(${this.groupChar})?`),_t=new RegExp(Ge,"g");_t.test(E);const Dt=i.split("").join(`(${this.groupChar})?`),_n=new RegExp(Dt,"g");_n.test(E.slice(_t.lastIndex)),Y=_t.lastIndex+_n.lastIndex,this.input.nativeElement.setSelectionRange(Y,Y)}else if(se===O)"insert"===r||"delete-back-single"===r?this.input.nativeElement.setSelectionRange(Y+1,Y+1):"delete-single"===r?this.input.nativeElement.setSelectionRange(Y-1,Y-1):("delete-range"===r||"spin"===r)&&this.input.nativeElement.setSelectionRange(Y,Y);else if("delete-back-single"===r){let be=g.charAt(Y-1),Me=g.charAt(Y),Ge=O-se,_t=this._group.test(Me);_t&&1===Ge?Y+=1:!_t&&this.isNumeralChar(be)&&(Y+=-1*Ge+1),this._group.lastIndex=0,this.input.nativeElement.setSelectionRange(Y,Y)}else if("-"===g&&"insert"===r){this.input.nativeElement.setSelectionRange(0,0);const Me=this.initCursor()+i.length+1;this.input.nativeElement.setSelectionRange(Me,Me)}else Y+=se-O,this.input.nativeElement.setSelectionRange(Y,Y)}this.input.nativeElement.setAttribute("aria-valuenow",e)}concatValues(e,i){if(e&&i){let r=i.search(this._decimal);return this._decimal.lastIndex=0,this.suffixChar?e.replace(this.suffixChar,"").split(this._decimal)[0]+i.replace(this.suffixChar,"").slice(r)+this.suffixChar:-1!==r?e.split(this._decimal)[0]+i.slice(r):e}return e}getDecimalLength(e){if(e){const i=e.split(this._decimal);if(2===i.length)return i[1].replace(this._suffix,"").trim().replace(/\s/g,"").replace(this._currency,"").length}return 0}onInputFocus(e){this.focused=!0,this.onFocus.emit(e)}onInputBlur(e){this.focused=!1;let i=this.validateValue(this.parseValue(this.input.nativeElement.value));this.input.nativeElement.value=this.formatValue(i),this.input.nativeElement.setAttribute("aria-valuenow",i),this.updateModel(e,i),this.onBlur.emit(e)}formattedValue(){return this.formatValue(this.value||this.allowEmpty?this.value:0)}updateModel(e,i){this.value!==i&&(this.value=i,this.onModelChange(i)),this.onModelTouched()}writeValue(e){this.value=e,this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}get filled(){return null!=this.value&&this.value.toString().length>0}clearTimer(){this.timer&&clearInterval(this.timer)}getFormatter(){return this.numberFormat}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.SBq),o.Y36(o.sBO))},n.\u0275cmp=o.Xpm({type:n,selectors:[["p-inputNumber"]],viewQuery:function(e,i){if(1&e&&o.Gf(vne,5),2&e){let r;o.iGM(r=o.CRH())&&(i.input=r.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:6,hostBindings:function(e,i){2&e&&o.ekj("p-inputwrapper-filled",i.filled)("p-inputwrapper-focus",i.focused)("p-inputnumber-clearable",i.showClear&&"vertical"!=i.buttonLayout)},inputs:{showButtons:"showButtons",format:"format",buttonLayout:"buttonLayout",inputId:"inputId",styleClass:"styleClass",style:"style",placeholder:"placeholder",size:"size",maxlength:"maxlength",tabindex:"tabindex",title:"title",ariaLabel:"ariaLabel",ariaRequired:"ariaRequired",name:"name",required:"required",autocomplete:"autocomplete",min:"min",max:"max",incrementButtonClass:"incrementButtonClass",decrementButtonClass:"decrementButtonClass",incrementButtonIcon:"incrementButtonIcon",decrementButtonIcon:"decrementButtonIcon",readonly:"readonly",step:"step",allowEmpty:"allowEmpty",locale:"locale",localeMatcher:"localeMatcher",mode:"mode",currency:"currency",currencyDisplay:"currencyDisplay",useGrouping:"useGrouping",minFractionDigits:"minFractionDigits",maxFractionDigits:"maxFractionDigits",prefix:"prefix",suffix:"suffix",inputStyle:"inputStyle",inputStyleClass:"inputStyleClass",showClear:"showClear",disabled:"disabled"},outputs:{onInput:"onInput",onFocus:"onFocus",onBlur:"onBlur",onKeyDown:"onKeyDown",onClear:"onClear"},features:[o._Bn([Tne]),o.TTD],decls:7,vars:32,consts:[[3,"ngClass","ngStyle"],["pInputText","","inputmode","decimal",3,"ngClass","ngStyle","value","disabled","readonly","input","keydown","keypress","paste","click","focus","blur"],["input",""],["class","p-inputnumber-clear-icon pi pi-times",3,"click",4,"ngIf"],["class","p-inputnumber-button-group",4,"ngIf"],["type","button","pButton","","tabindex","-1",3,"ngClass","class","icon","disabled","mousedown","mouseup","mouseleave","keydown","keyup",4,"ngIf"],[1,"p-inputnumber-clear-icon","pi","pi-times",3,"click"],[1,"p-inputnumber-button-group"],["type","button","pButton","","tabindex","-1",3,"ngClass","icon","disabled","mousedown","mouseup","mouseleave","keydown","keyup"]],template:function(e,i){1&e&&(o.TgZ(0,"span",0)(1,"input",1,2),o.NdJ("input",function(a){return i.onUserInput(a)})("keydown",function(a){return i.onInputKeyDown(a)})("keypress",function(a){return i.onInputKeyPress(a)})("paste",function(a){return i.onPaste(a)})("click",function(){return i.onInputClick()})("focus",function(a){return i.onInputFocus(a)})("blur",function(a){return i.onInputBlur(a)}),o.qZA(),o.YNc(3,bne,1,0,"i",3),o.YNc(4,wne,3,12,"span",4),o.YNc(5,xne,1,6,"button",5),o.YNc(6,Cne,1,6,"button",5),o.qZA()),2&e&&(o.Tol(i.styleClass),o.Q6J("ngClass",o.kEZ(28,Ene,i.showButtons&&"stacked"===i.buttonLayout,i.showButtons&&"horizontal"===i.buttonLayout,i.showButtons&&"vertical"===i.buttonLayout))("ngStyle",i.style),o.xp6(1),o.Tol(i.inputStyleClass),o.Q6J("ngClass","p-inputnumber-input")("ngStyle",i.inputStyle)("value",i.formattedValue())("disabled",i.disabled)("readonly",i.readonly),o.uIk("placeholder",i.placeholder)("title",i.title)("id",i.inputId)("size",i.size)("name",i.name)("autocomplete",i.autocomplete)("maxlength",i.maxlength)("tabindex",i.tabindex)("aria-label",i.ariaLabel)("aria-required",i.ariaRequired)("required",i.required)("min",i.min)("max",i.max),o.xp6(2),o.Q6J("ngIf","vertical"!=i.buttonLayout&&i.showClear&&i.value),o.xp6(1),o.Q6J("ngIf",i.showButtons&&"stacked"===i.buttonLayout),o.xp6(1),o.Q6J("ngIf",i.showButtons&&"stacked"!==i.buttonLayout),o.xp6(1),o.Q6J("ngIf",i.showButtons&&"stacked"!==i.buttonLayout))},dependencies:[Pi,Zn,qr,yne,vF],styles:["p-inputnumber,.p-inputnumber{display:inline-flex}.p-inputnumber-button{display:flex;align-items:center;justify-content:center;flex:0 0 auto}.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button .p-button-label,.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button .p-button-label{display:none}.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-up{border-top-left-radius:0;border-bottom-left-radius:0;border-bottom-right-radius:0;padding:0}.p-inputnumber-buttons-stacked .p-inputnumber-input{border-top-right-radius:0;border-bottom-right-radius:0}.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-down{border-top-left-radius:0;border-top-right-radius:0;border-bottom-left-radius:0;padding:0}.p-inputnumber-buttons-stacked .p-inputnumber-button-group{display:flex;flex-direction:column}.p-inputnumber-buttons-stacked .p-inputnumber-button-group .p-button.p-inputnumber-button{flex:1 1 auto}.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-up{order:3;border-top-left-radius:0;border-bottom-left-radius:0}.p-inputnumber-buttons-horizontal .p-inputnumber-input{order:2;border-radius:0}.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-down{order:1;border-top-right-radius:0;border-bottom-right-radius:0}.p-inputnumber-buttons-vertical{flex-direction:column}.p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-up{order:1;border-bottom-left-radius:0;border-bottom-right-radius:0;width:100%}.p-inputnumber-buttons-vertical .p-inputnumber-input{order:2;border-radius:0;text-align:center}.p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-down{order:3;border-top-left-radius:0;border-top-right-radius:0;width:100%}.p-inputnumber-input{flex:1 1 auto}.p-fluid p-inputnumber,.p-fluid .p-inputnumber{width:100%}.p-fluid .p-inputnumber .p-inputnumber-input{width:1%}.p-fluid .p-inputnumber-buttons-vertical .p-inputnumber-input{width:100%}.p-inputnumber-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-inputnumber-clearable{position:relative}\n"],encapsulation:2,changeDetection:0}),n})(),IF=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr,SF,dw]}),n})();function Sne(n,t){1&n&&o.GkF(0)}const DF=function(n){return{$implicit:n}};function Ine(n,t){if(1&n&&(o.TgZ(0,"div",15),o.YNc(1,Sne,1,0,"ng-container",16),o.qZA()),2&n){const e=o.oxw(2);o.xp6(1),o.Q6J("ngTemplateOutlet",e.templateLeft)("ngTemplateOutletContext",o.VKq(2,DF,e.paginatorState))}}function Dne(n,t){if(1&n&&(o.TgZ(0,"span",17),o._uU(1),o.qZA()),2&n){const e=o.oxw(2);o.xp6(1),o.Oqu(e.currentPageReport)}}const gk=function(n){return{"p-disabled":n}};function Ane(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"button",18),o.NdJ("click",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.changePageToFirst(r))}),o._UZ(1,"span",19),o.qZA()}if(2&n){const e=o.oxw(2);o.Q6J("disabled",e.isFirstPage()||e.empty())("ngClass",o.VKq(2,gk,e.isFirstPage()||e.empty()))}}const Mne=function(n){return{"p-highlight":n}};function kne(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"button",22),o.NdJ("click",function(r){const g=o.CHM(e).$implicit,E=o.oxw(3);return o.KtG(E.onPageLinkClick(r,g-1))}),o._uU(1),o.qZA()}if(2&n){const e=t.$implicit,i=o.oxw(3);o.Q6J("ngClass",o.VKq(2,Mne,e-1==i.getPage())),o.xp6(1),o.hij(" ",e," ")}}function Rne(n,t){if(1&n&&(o.TgZ(0,"span",20),o.YNc(1,kne,2,4,"button",21),o.qZA()),2&n){const e=o.oxw(2);o.xp6(1),o.Q6J("ngForOf",e.pageLinks)}}function Pne(n,t){if(1&n&&o._uU(0),2&n){const e=o.oxw(3);o.Oqu(e.currentPageReport)}}function One(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"p-dropdown",23),o.NdJ("onChange",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onPageDropdownChange(r))}),o.YNc(1,Pne,1,1,"ng-template",24),o.qZA()}if(2&n){const e=o.oxw(2);o.Q6J("options",e.pageItems)("ngModel",e.getPage())("disabled",e.empty())("appendTo",e.dropdownAppendTo)("scrollHeight",e.dropdownScrollHeight)}}function Lne(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"button",25),o.NdJ("click",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.changePageToLast(r))}),o._UZ(1,"span",26),o.qZA()}if(2&n){const e=o.oxw(2);o.Q6J("disabled",e.isLastPage()||e.empty())("ngClass",o.VKq(2,gk,e.isLastPage()||e.empty()))}}function Fne(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"p-inputNumber",27),o.NdJ("ngModelChange",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.changePage(r-1))}),o.qZA()}if(2&n){const e=o.oxw(2);o.Q6J("ngModel",e.currentPage())("disabled",e.empty())}}function Nne(n,t){1&n&&o.GkF(0)}function zne(n,t){if(1&n&&o.YNc(0,Nne,1,0,"ng-container",16),2&n){const e=t.$implicit,i=o.oxw(4);o.Q6J("ngTemplateOutlet",i.dropdownItemTemplate)("ngTemplateOutletContext",o.VKq(2,DF,e))}}function Bne(n,t){1&n&&(o.ynx(0),o.YNc(1,zne,1,4,"ng-template",30),o.BQk())}function Vne(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"p-dropdown",28),o.NdJ("ngModelChange",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.rows=r)})("onChange",function(r){o.CHM(e);const a=o.oxw(2);return o.KtG(a.onRppChange(r))}),o.YNc(1,Bne,2,0,"ng-container",29),o.qZA()}if(2&n){const e=o.oxw(2);o.Q6J("options",e.rowsPerPageItems)("ngModel",e.rows)("disabled",e.empty())("appendTo",e.dropdownAppendTo)("scrollHeight",e.dropdownScrollHeight),o.xp6(1),o.Q6J("ngIf",e.dropdownItemTemplate)}}function Une(n,t){1&n&&o.GkF(0)}function Hne(n,t){if(1&n&&(o.TgZ(0,"div",31),o.YNc(1,Une,1,0,"ng-container",16),o.qZA()),2&n){const e=o.oxw(2);o.xp6(1),o.Q6J("ngTemplateOutlet",e.templateRight)("ngTemplateOutletContext",o.VKq(2,DF,e.paginatorState))}}function jne(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",1),o.YNc(1,Ine,2,4,"div",2),o.YNc(2,Dne,2,1,"span",3),o.YNc(3,Ane,2,4,"button",4),o.TgZ(4,"button",5),o.NdJ("click",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.changePageToPrev(r))}),o._UZ(5,"span",6),o.qZA(),o.YNc(6,Rne,2,1,"span",7),o.YNc(7,One,2,5,"p-dropdown",8),o.TgZ(8,"button",9),o.NdJ("click",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.changePageToNext(r))}),o._UZ(9,"span",10),o.qZA(),o.YNc(10,Lne,2,4,"button",11),o.YNc(11,Fne,1,2,"p-inputNumber",12),o.YNc(12,Vne,2,6,"p-dropdown",13),o.YNc(13,Hne,2,4,"div",14),o.qZA()}if(2&n){const e=o.oxw();o.Tol(e.styleClass),o.Q6J("ngStyle",e.style)("ngClass","p-paginator p-component"),o.xp6(1),o.Q6J("ngIf",e.templateLeft),o.xp6(1),o.Q6J("ngIf",e.showCurrentPageReport),o.xp6(1),o.Q6J("ngIf",e.showFirstLastIcon),o.xp6(1),o.Q6J("disabled",e.isFirstPage()||e.empty())("ngClass",o.VKq(17,gk,e.isFirstPage()||e.empty())),o.xp6(2),o.Q6J("ngIf",e.showPageLinks),o.xp6(1),o.Q6J("ngIf",e.showJumpToPageDropdown),o.xp6(1),o.Q6J("disabled",e.isLastPage()||e.empty())("ngClass",o.VKq(19,gk,e.isLastPage()||e.empty())),o.xp6(2),o.Q6J("ngIf",e.showFirstLastIcon),o.xp6(1),o.Q6J("ngIf",e.showJumpToPageInput),o.xp6(1),o.Q6J("ngIf",e.rowsPerPageOptions),o.xp6(1),o.Q6J("ngIf",e.templateRight)}}let Gne=(()=>{class n{constructor(e){this.cd=e,this.pageLinkSize=5,this.onPageChange=new o.vpe,this.alwaysShow=!0,this.dropdownScrollHeight="200px",this.currentPageReportTemplate="{currentPage} of {totalPages}",this.showFirstLastIcon=!0,this.totalRecords=0,this.rows=0,this.showPageLinks=!0,this._first=0,this._page=0}ngOnInit(){this.updatePaginatorState()}ngOnChanges(e){e.totalRecords&&(this.updatePageLinks(),this.updatePaginatorState(),this.updateFirst(),this.updateRowsPerPageOptions()),e.first&&(this._first=e.first.currentValue,this.updatePageLinks(),this.updatePaginatorState()),e.rows&&(this.updatePageLinks(),this.updatePaginatorState()),e.rowsPerPageOptions&&this.updateRowsPerPageOptions()}get first(){return this._first}set first(e){this._first=e}updateRowsPerPageOptions(){if(this.rowsPerPageOptions){this.rowsPerPageItems=[];for(let e of this.rowsPerPageOptions)"object"==typeof e&&e.showAll?this.rowsPerPageItems.unshift({label:e.showAll,value:this.totalRecords}):this.rowsPerPageItems.push({label:String(e),value:e})}}isFirstPage(){return 0===this.getPage()}isLastPage(){return this.getPage()===this.getPageCount()-1}getPageCount(){return Math.ceil(this.totalRecords/this.rows)}calculatePageLinkBoundaries(){let e=this.getPageCount(),i=Math.min(this.pageLinkSize,e),r=Math.max(0,Math.ceil(this.getPage()-i/2)),a=Math.min(e-1,r+i-1);return r=Math.max(0,r-(this.pageLinkSize-(a-r+1))),[r,a]}updatePageLinks(){this.pageLinks=[];let e=this.calculatePageLinkBoundaries(),r=e[1];for(let a=e[0];a<=r;a++)this.pageLinks.push(a+1);if(this.showJumpToPageDropdown){this.pageItems=[];for(let a=0;a<this.getPageCount();a++)this.pageItems.push({label:String(a+1),value:a})}}changePage(e){var i=this.getPageCount();if(e>=0&&e<i){this._first=this.rows*e;var r={page:e,first:this.first,rows:this.rows,pageCount:i};this.updatePageLinks(),this.onPageChange.emit(r),this.updatePaginatorState()}}updateFirst(){const e=this.getPage();e>0&&this.totalRecords&&this.first>=this.totalRecords&&Promise.resolve(null).then(()=>this.changePage(e-1))}getPage(){return Math.floor(this.first/this.rows)}changePageToFirst(e){this.isFirstPage()||this.changePage(0),e.preventDefault()}changePageToPrev(e){this.changePage(this.getPage()-1),e.preventDefault()}changePageToNext(e){this.changePage(this.getPage()+1),e.preventDefault()}changePageToLast(e){this.isLastPage()||this.changePage(this.getPageCount()-1),e.preventDefault()}onPageLinkClick(e,i){this.changePage(i),e.preventDefault()}onRppChange(e){this.changePage(this.getPage())}onPageDropdownChange(e){this.changePage(e.value)}updatePaginatorState(){this.paginatorState={page:this.getPage(),pageCount:this.getPageCount(),rows:this.rows,first:this.first,totalRecords:this.totalRecords}}empty(){return 0===this.getPageCount()}currentPage(){return this.getPageCount()>0?this.getPage()+1:0}get currentPageReport(){return this.currentPageReportTemplate.replace("{currentPage}",String(this.currentPage())).replace("{totalPages}",String(this.getPageCount())).replace("{first}",String(this.totalRecords>0?this._first+1:0)).replace("{last}",String(Math.min(this._first+this.rows,this.totalRecords))).replace("{rows}",String(this.rows)).replace("{totalRecords}",String(this.totalRecords))}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.sBO))},n.\u0275cmp=o.Xpm({type:n,selectors:[["p-paginator"]],hostAttrs:[1,"p-element"],inputs:{pageLinkSize:"pageLinkSize",style:"style",styleClass:"styleClass",alwaysShow:"alwaysShow",templateLeft:"templateLeft",templateRight:"templateRight",dropdownAppendTo:"dropdownAppendTo",dropdownScrollHeight:"dropdownScrollHeight",currentPageReportTemplate:"currentPageReportTemplate",showCurrentPageReport:"showCurrentPageReport",showFirstLastIcon:"showFirstLastIcon",totalRecords:"totalRecords",rows:"rows",rowsPerPageOptions:"rowsPerPageOptions",showJumpToPageDropdown:"showJumpToPageDropdown",showJumpToPageInput:"showJumpToPageInput",showPageLinks:"showPageLinks",dropdownItemTemplate:"dropdownItemTemplate",first:"first"},outputs:{onPageChange:"onPageChange"},features:[o.TTD],decls:1,vars:1,consts:[[3,"class","ngStyle","ngClass",4,"ngIf"],[3,"ngStyle","ngClass"],["class","p-paginator-left-content",4,"ngIf"],["class","p-paginator-current",4,"ngIf"],["type","button","pRipple","","class","p-paginator-first p-paginator-element p-link",3,"disabled","ngClass","click",4,"ngIf"],["type","button","pRipple","",1,"p-paginator-prev","p-paginator-element","p-link",3,"disabled","ngClass","click"],[1,"p-paginator-icon","pi","pi-angle-left"],["class","p-paginator-pages",4,"ngIf"],["styleClass","p-paginator-page-options",3,"options","ngModel","disabled","appendTo","scrollHeight","onChange",4,"ngIf"],["type","button","pRipple","",1,"p-paginator-next","p-paginator-element","p-link",3,"disabled","ngClass","click"],[1,"p-paginator-icon","pi","pi-angle-right"],["type","button","pRipple","","class","p-paginator-last p-paginator-element p-link",3,"disabled","ngClass","click",4,"ngIf"],["class","p-paginator-page-input",3,"ngModel","disabled","ngModelChange",4,"ngIf"],["styleClass","p-paginator-rpp-options",3,"options","ngModel","disabled","appendTo","scrollHeight","ngModelChange","onChange",4,"ngIf"],["class","p-paginator-right-content",4,"ngIf"],[1,"p-paginator-left-content"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-paginator-current"],["type","button","pRipple","",1,"p-paginator-first","p-paginator-element","p-link",3,"disabled","ngClass","click"],[1,"p-paginator-icon","pi","pi-angle-double-left"],[1,"p-paginator-pages"],["type","button","class","p-paginator-page p-paginator-element p-link","pRipple","",3,"ngClass","click",4,"ngFor","ngForOf"],["type","button","pRipple","",1,"p-paginator-page","p-paginator-element","p-link",3,"ngClass","click"],["styleClass","p-paginator-page-options",3,"options","ngModel","disabled","appendTo","scrollHeight","onChange"],["pTemplate","selectedItem"],["type","button","pRipple","",1,"p-paginator-last","p-paginator-element","p-link",3,"disabled","ngClass","click"],[1,"p-paginator-icon","pi","pi-angle-double-right"],[1,"p-paginator-page-input",3,"ngModel","disabled","ngModelChange"],["styleClass","p-paginator-rpp-options",3,"options","ngModel","disabled","appendTo","scrollHeight","ngModelChange","onChange"],[4,"ngIf"],["pTemplate","item"],[1,"p-paginator-right-content"]],template:function(e,i){1&e&&o.YNc(0,jne,14,21,"div",0),2&e&&o.Q6J("ngIf",!!i.alwaysShow||i.pageLinks&&i.pageLinks.length>1)},dependencies:[Pi,Hn,Zn,Ki,qr,X4,bp,n5,my,Bm,cw],styles:[".p-paginator{display:flex;align-items:center;justify-content:center;flex-wrap:wrap}.p-paginator-left-content{margin-right:auto}.p-paginator-right-content{margin-left:auto}.p-paginator-page,.p-paginator-next,.p-paginator-last,.p-paginator-first,.p-paginator-prev,.p-paginator-current{cursor:pointer;display:inline-flex;align-items:center;justify-content:center;line-height:1;-webkit-user-select:none;user-select:none;overflow:hidden;position:relative}.p-paginator-element:focus{z-index:1;position:relative}\n"],encapsulation:2,changeDetection:0}),n})(),$ne=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr,TF,IF,Uf,yf,uw,TF,IF,Uf,yf]}),n})();function Wne(n,t){if(1&n&&o._UZ(0,"span",8),2&n){const e=o.oxw(2).$implicit;o.Tol(e.icon),o.Q6J("ngClass","p-button-icon p-button-icon-left")}}function Zne(n,t){if(1&n&&(o.ynx(0),o.YNc(1,Wne,1,3,"span",6),o.TgZ(2,"span",7),o._uU(3),o.qZA(),o.BQk()),2&n){const e=o.oxw().$implicit,i=o.oxw();o.xp6(1),o.Q6J("ngIf",e.icon),o.xp6(2),o.Oqu(i.getOptionLabel(e))}}function qne(n,t){1&n&&o.GkF(0)}const Kne=function(n,t){return{$implicit:n,index:t}};function Yne(n,t){if(1&n&&o.YNc(0,qne,1,0,"ng-container",9),2&n){const e=o.oxw(),i=e.$implicit,r=e.index,a=o.oxw();o.Q6J("ngTemplateOutlet",a.itemTemplate)("ngTemplateOutletContext",o.WLB(2,Kne,i,r))}}const Jne=function(n,t,e){return{"p-highlight":n,"p-disabled":t,"p-button-icon-only":e}};function Qne(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",2,3),o.NdJ("click",function(r){const a=o.CHM(e),g=a.$implicit,E=a.index,O=o.oxw();return o.KtG(O.onItemClick(r,g,E))})("keydown.enter",function(r){const a=o.CHM(e),g=a.$implicit,E=a.index,O=o.oxw();return o.KtG(O.onItemClick(r,g,E))})("blur",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.onBlur())}),o.YNc(2,Zne,4,2,"ng-container",4),o.YNc(3,Yne,1,5,"ng-template",null,5,o.W1O),o.qZA()}if(2&n){const e=t.$implicit,i=o.MAs(4),r=o.oxw();o.Tol(e.styleClass),o.Q6J("ngClass",o.kEZ(10,Jne,r.isSelected(e),r.disabled||r.isOptionDisabled(e),e.icon&&!r.getOptionLabel(e))),o.uIk("aria-pressed",r.isSelected(e))("title",e.title)("aria-label",e.label)("tabindex",r.disabled?null:r.tabindex)("aria-labelledby",r.getOptionLabel(e)),o.xp6(2),o.Q6J("ngIf",!r.itemTemplate)("ngIfElse",i)}}const Xne={provide:xs,useExisting:(0,o.Gpc)(()=>eie),multi:!0};let eie=(()=>{class n{constructor(e){this.cd=e,this.tabindex=0,this.onOptionClick=new o.vpe,this.onChange=new o.vpe,this.onModelChange=()=>{},this.onModelTouched=()=>{}}getOptionLabel(e){return this.optionLabel?ti.resolveFieldData(e,this.optionLabel):null!=e.label?e.label:e}getOptionValue(e){return this.optionValue?ti.resolveFieldData(e,this.optionValue):this.optionLabel||void 0===e.value?e:e.value}isOptionDisabled(e){return this.optionDisabled?ti.resolveFieldData(e,this.optionDisabled):void 0!==e.disabled&&e.disabled}writeValue(e){this.value=e,this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}onItemClick(e,i,r){if(!this.disabled&&!this.isOptionDisabled(i)){if(this.multiple)this.isSelected(i)?this.removeOption(i):this.value=[...this.value||[],this.getOptionValue(i)],this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value});else{let a=this.getOptionValue(i);this.value!==a&&(this.value=this.getOptionValue(i),this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value}))}this.onOptionClick.emit({originalEvent:e,option:i,index:r})}}onBlur(){this.onModelTouched()}removeOption(e){this.value=this.value.filter(i=>!ti.equals(i,this.getOptionValue(e),this.dataKey))}isSelected(e){let i=!1,r=this.getOptionValue(e);if(this.multiple){if(this.value&&this.value instanceof Array)for(let a of this.value)if(ti.equals(a,r,this.dataKey)){i=!0;break}}else i=ti.equals(this.getOptionValue(e),this.value,this.dataKey);return i}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.sBO))},n.\u0275cmp=o.Xpm({type:n,selectors:[["p-selectButton"]],contentQueries:function(e,i,r){if(1&e&&o.Suo(r,o.Rgc,5),2&e){let a;o.iGM(a=o.CRH())&&(i.itemTemplate=a.first)}},hostAttrs:[1,"p-element"],inputs:{options:"options",optionLabel:"optionLabel",optionValue:"optionValue",optionDisabled:"optionDisabled",tabindex:"tabindex",multiple:"multiple",style:"style",styleClass:"styleClass",ariaLabelledBy:"ariaLabelledBy",disabled:"disabled",dataKey:"dataKey"},outputs:{onOptionClick:"onOptionClick",onChange:"onChange"},features:[o._Bn([Xne])],decls:2,vars:5,consts:[["role","group",3,"ngClass","ngStyle"],["class","p-button p-component","role","button","pRipple","",3,"class","ngClass","click","keydown.enter","blur",4,"ngFor","ngForOf"],["role","button","pRipple","",1,"p-button","p-component",3,"ngClass","click","keydown.enter","blur"],["btn",""],[4,"ngIf","ngIfElse"],["customcontent",""],[3,"ngClass","class",4,"ngIf"],[1,"p-button-label"],[3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,i){1&e&&(o.TgZ(0,"div",0),o.YNc(1,Qne,5,14,"div",1),o.qZA()),2&e&&(o.Tol(i.styleClass),o.Q6J("ngClass","p-selectbutton p-buttonset p-component")("ngStyle",i.style),o.xp6(1),o.Q6J("ngForOf",i.options))},dependencies:[Pi,Hn,Zn,Ki,qr,cw],styles:['.p-button{margin:0;display:inline-flex;cursor:pointer;-webkit-user-select:none;user-select:none;align-items:center;vertical-align:bottom;text-align:center;overflow:hidden;position:relative}.p-button-label{flex:1 1 auto}.p-button-icon-right{order:1}.p-button:disabled{cursor:default}.p-button-icon-only{justify-content:center}.p-button-icon-only:after{content:"p";visibility:hidden;clip:rect(0 0 0 0);width:0}.p-button-vertical{flex-direction:column}.p-button-icon-bottom{order:2}.p-buttonset .p-button{margin:0}.p-buttonset .p-button:not(:last-child){border-right:0 none}.p-buttonset .p-button:not(:first-of-type):not(:last-of-type){border-radius:0}.p-buttonset .p-button:first-of-type{border-top-right-radius:0;border-bottom-right-radius:0}.p-buttonset .p-button:last-of-type{border-top-left-radius:0;border-bottom-left-radius:0}.p-buttonset .p-button:focus{position:relative;z-index:1}\n'],encapsulation:2,changeDetection:0}),n})(),tie=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr,uw]}),n})();const nie=function(n,t,e){return{"p-checkbox-label-active":n,"p-disabled":t,"p-checkbox-label-focus":e}};function iie(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"label",7),o.NdJ("click",function(r){o.CHM(e);const a=o.oxw(),g=o.MAs(3);return o.KtG(a.onClick(r,g))}),o._uU(1),o.qZA()}if(2&n){const e=o.oxw();o.Q6J("ngClass",o.kEZ(3,nie,null!=e.value,e.disabled,e.focused)),o.uIk("for",e.inputId),o.xp6(1),o.Oqu(e.label)}}const rie=function(n,t){return{"p-checkbox p-component":!0,"p-checkbox-disabled":n,"p-checkbox-focused":t}},oie=function(n,t,e){return{"p-highlight":n,"p-disabled":t,"p-focus":e}},sie={provide:xs,useExisting:(0,o.Gpc)(()=>aie),multi:!0};let aie=(()=>{class n{constructor(e){this.cd=e,this.checkboxTrueIcon="pi pi-check",this.checkboxFalseIcon="pi pi-times",this.onChange=new o.vpe,this.onModelChange=()=>{},this.onModelTouched=()=>{}}onClick(e,i){!this.disabled&&!this.readonly&&(this.toggle(e),this.focused=!0,i.focus())}onKeydown(e){32==e.keyCode&&e.preventDefault()}onKeyup(e){32==e.keyCode&&!this.readonly&&(this.toggle(e),e.preventDefault())}toggle(e){null==this.value||null==this.value?this.value=!0:1==this.value?this.value=!1:0==this.value&&(this.value=null),this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value})}onFocus(){this.focused=!0}onBlur(){this.focused=!1,this.onModelTouched()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}writeValue(e){this.value=e,this.cd.markForCheck()}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.sBO))},n.\u0275cmp=o.Xpm({type:n,selectors:[["p-triStateCheckbox"]],hostAttrs:[1,"p-element"],inputs:{disabled:"disabled",name:"name",ariaLabelledBy:"ariaLabelledBy",tabindex:"tabindex",inputId:"inputId",style:"style",styleClass:"styleClass",label:"label",readonly:"readonly",checkboxTrueIcon:"checkboxTrueIcon",checkboxFalseIcon:"checkboxFalseIcon"},outputs:{onChange:"onChange"},features:[o._Bn([sie])],decls:7,vars:21,consts:[[3,"ngStyle","ngClass"],[1,"p-hidden-accessible"],["type","text","inputmode","none",3,"name","readonly","disabled","keyup","keydown","focus","blur"],["input",""],["role","checkbox",1,"p-checkbox-box",3,"ngClass","click"],[1,"p-checkbox-icon",3,"ngClass"],["class","p-checkbox-label",3,"ngClass","click",4,"ngIf"],[1,"p-checkbox-label",3,"ngClass","click"]],template:function(e,i){if(1&e){const r=o.EpF();o.TgZ(0,"div",0)(1,"div",1)(2,"input",2,3),o.NdJ("keyup",function(g){return i.onKeyup(g)})("keydown",function(g){return i.onKeydown(g)})("focus",function(){return i.onFocus()})("blur",function(){return i.onBlur()}),o.qZA()(),o.TgZ(4,"div",4),o.NdJ("click",function(g){o.CHM(r);const E=o.MAs(3);return o.KtG(i.onClick(g,E))}),o._UZ(5,"span",5),o.qZA()(),o.YNc(6,iie,2,7,"label",6)}2&e&&(o.Tol(i.styleClass),o.Q6J("ngStyle",i.style)("ngClass",o.WLB(14,rie,i.disabled,i.focused)),o.xp6(2),o.Q6J("name",i.name)("readonly",i.readonly)("disabled",i.disabled),o.uIk("id",i.inputId)("tabindex",i.tabindex)("aria-labelledby",i.ariaLabelledBy),o.xp6(2),o.Q6J("ngClass",o.kEZ(17,oie,null!=i.value,i.disabled,i.focused)),o.uIk("aria-checked",!0===i.value),o.xp6(1),o.Q6J("ngClass",!0===i.value?i.checkboxTrueIcon:!1===i.value?i.checkboxFalseIcon:""),o.xp6(1),o.Q6J("ngIf",i.label))},dependencies:[Pi,Zn,qr],encapsulation:2,changeDetection:0}),n})(),lie=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr]}),n})();const cie=["container"],uie=["resizeHelper"],hie=["reorderIndicatorUp"],die=["reorderIndicatorDown"],pie=["wrapper"],fie=["table"],mie=["thead"],gie=["tfoot"],_ie=["scroller"];function yie(n,t){if(1&n&&(o.TgZ(0,"div",15),o._UZ(1,"i"),o.qZA()),2&n){const e=o.oxw();o.xp6(1),o.Tol("p-datatable-loading-icon pi-spin "+e.loadingIcon)}}function vie(n,t){1&n&&o.GkF(0)}function bie(n,t){if(1&n&&(o.TgZ(0,"div",16),o.YNc(1,vie,1,0,"ng-container",17),o.qZA()),2&n){const e=o.oxw();o.xp6(1),o.Q6J("ngTemplateOutlet",e.captionTemplate)}}function wie(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"p-paginator",18),o.NdJ("onPageChange",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onPageChange(r))}),o.qZA()}if(2&n){const e=o.oxw();o.Q6J("rows",e.rows)("first",e.first)("totalRecords",e.totalRecords)("pageLinkSize",e.pageLinks)("alwaysShow",e.alwaysShowPaginator)("rowsPerPageOptions",e.rowsPerPageOptions)("templateLeft",e.paginatorLeftTemplate)("templateRight",e.paginatorRightTemplate)("dropdownAppendTo",e.paginatorDropdownAppendTo)("dropdownScrollHeight",e.paginatorDropdownScrollHeight)("currentPageReportTemplate",e.currentPageReportTemplate)("showFirstLastIcon",e.showFirstLastIcon)("dropdownItemTemplate",e.paginatorDropdownItemTemplate)("showCurrentPageReport",e.showCurrentPageReport)("showJumpToPageDropdown",e.showJumpToPageDropdown)("showJumpToPageInput",e.showJumpToPageInput)("showPageLinks",e.showPageLinks)}}function xie(n,t){1&n&&o.GkF(0)}const r5=function(n,t){return{$implicit:n,options:t}};function Cie(n,t){if(1&n&&o.YNc(0,xie,1,0,"ng-container",22),2&n){const e=t.$implicit,i=t.options;o.oxw(2);const r=o.MAs(10);o.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",o.WLB(2,r5,e,i))}}const Eie=function(n){return{height:n}};function Tie(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"p-scroller",19,20),o.NdJ("onLazyLoad",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onLazyItemLoad(r))}),o.YNc(2,Cie,1,5,"ng-template",21),o.qZA()}if(2&n){const e=o.oxw();o.Akn(o.VKq(15,Eie,"flex"!==e.scrollHeight?e.scrollHeight:void 0)),o.Q6J("items",e.processedData)("columns",e.columns)("scrollHeight","flex"!==e.scrollHeight?void 0:"100%")("itemSize",e.virtualScrollItemSize||e._virtualRowHeight)("step",e.rows)("delay",e.lazy?e.virtualScrollDelay:0)("inline",!0)("lazy",e.lazy)("loaderDisabled",!0)("showSpacer",!1)("showLoader",e.loadingBodyTemplate)("options",e.virtualScrollOptions)("autoSize",!0)}}function Sie(n,t){1&n&&o.GkF(0)}const Iie=function(n){return{columns:n}};function Die(n,t){if(1&n&&(o.ynx(0),o.YNc(1,Sie,1,0,"ng-container",22),o.BQk()),2&n){const e=o.oxw(),i=o.MAs(10);o.xp6(1),o.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",o.WLB(4,r5,e.processedData,o.VKq(2,Iie,e.columns)))}}function Aie(n,t){1&n&&o.GkF(0)}function Mie(n,t){1&n&&o.GkF(0)}function kie(n,t){if(1&n&&o._UZ(0,"tbody",31),2&n){const e=o.oxw().options,i=o.oxw();o.Q6J("value",i.frozenValue)("frozenRows",!0)("pTableBody",e.columns)("pTableBodyTemplate",i.frozenBodyTemplate)("frozen",!0)}}function Rie(n,t){if(1&n&&o._UZ(0,"tbody",32),2&n){const e=o.oxw().options;o.Akn("height: calc("+e.spacerStyle.height+" - "+e.rows.length*e.itemSize+"px);")}}function Pie(n,t){1&n&&o.GkF(0)}const QS=function(n){return{$implicit:n}};function Oie(n,t){if(1&n&&(o.TgZ(0,"tfoot",33,34),o.YNc(2,Pie,1,0,"ng-container",22),o.qZA()),2&n){const e=o.oxw().options,i=o.oxw();o.xp6(2),o.Q6J("ngTemplateOutlet",i.footerGroupedTemplate||i.footerTemplate)("ngTemplateOutletContext",o.VKq(2,QS,e.columns))}}const Lie=function(n,t,e){return{"p-datatable-table":!0,"p-datatable-scrollable-table":n,"p-datatable-resizable-table":t,"p-datatable-resizable-table-fit":e}};function Fie(n,t){if(1&n&&(o.TgZ(0,"table",23,24),o.YNc(2,Aie,1,0,"ng-container",22),o.TgZ(3,"thead",25,26),o.YNc(5,Mie,1,0,"ng-container",22),o.qZA(),o.YNc(6,kie,1,5,"tbody",27),o._UZ(7,"tbody",28),o.YNc(8,Rie,1,2,"tbody",29),o.YNc(9,Oie,3,4,"tfoot",30),o.qZA()),2&n){const e=t.options,i=o.oxw();o.Akn(i.tableStyle),o.Tol(i.tableStyleClass),o.Q6J("ngClass",o.kEZ(20,Lie,i.scrollable,i.resizableColumns,i.resizableColumns&&"fit"===i.columnResizeMode)),o.uIk("id",i.id+"-table"),o.xp6(2),o.Q6J("ngTemplateOutlet",i.colGroupTemplate)("ngTemplateOutletContext",o.VKq(24,QS,e.columns)),o.xp6(3),o.Q6J("ngTemplateOutlet",i.headerGroupedTemplate||i.headerTemplate)("ngTemplateOutletContext",o.VKq(26,QS,e.columns)),o.xp6(1),o.Q6J("ngIf",i.frozenValue||i.frozenBodyTemplate),o.xp6(1),o.Akn(e.contentStyle),o.Q6J("ngClass",e.contentStyleClass)("value",i.dataToRender(e.rows))("pTableBody",e.columns)("pTableBodyTemplate",i.bodyTemplate)("scrollerOptions",e),o.xp6(1),o.Q6J("ngIf",e.spacerStyle),o.xp6(1),o.Q6J("ngIf",i.footerGroupedTemplate||i.footerTemplate)}}function Nie(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"p-paginator",35),o.NdJ("onPageChange",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onPageChange(r))}),o.qZA()}if(2&n){const e=o.oxw();o.Q6J("rows",e.rows)("first",e.first)("totalRecords",e.totalRecords)("pageLinkSize",e.pageLinks)("alwaysShow",e.alwaysShowPaginator)("rowsPerPageOptions",e.rowsPerPageOptions)("templateLeft",e.paginatorLeftTemplate)("templateRight",e.paginatorRightTemplate)("dropdownAppendTo",e.paginatorDropdownAppendTo)("dropdownScrollHeight",e.paginatorDropdownScrollHeight)("currentPageReportTemplate",e.currentPageReportTemplate)("showFirstLastIcon",e.showFirstLastIcon)("dropdownItemTemplate",e.paginatorDropdownItemTemplate)("showCurrentPageReport",e.showCurrentPageReport)("showJumpToPageDropdown",e.showJumpToPageDropdown)("showJumpToPageInput",e.showJumpToPageInput)("showPageLinks",e.showPageLinks)}}function zie(n,t){1&n&&o.GkF(0)}function Bie(n,t){if(1&n&&(o.TgZ(0,"div",36),o.YNc(1,zie,1,0,"ng-container",17),o.qZA()),2&n){const e=o.oxw();o.xp6(1),o.Q6J("ngTemplateOutlet",e.summaryTemplate)}}function Vie(n,t){1&n&&o._UZ(0,"div",37,38)}function Uie(n,t){1&n&&o._UZ(0,"span",39,40)}function Hie(n,t){1&n&&o._UZ(0,"span",41,42)}const jie=function(n,t,e){return{"p-datatable p-component":!0,"p-datatable-hoverable-rows":n,"p-datatable-scrollable":t,"p-datatable-flex-scrollable":e}},Gie=function(n){return{maxHeight:n}},$ie=["pTableBody",""];function Wie(n,t){1&n&&o.GkF(0)}const AF=function(n,t,e,i,r){return{$implicit:n,rowIndex:t,columns:e,editing:i,frozen:r}};function Zie(n,t){if(1&n&&(o.ynx(0,3),o.YNc(1,Wie,1,0,"ng-container",4),o.BQk()),2&n){const e=o.oxw(),i=e.$implicit,r=e.index,a=o.oxw(2);o.xp6(1),o.Q6J("ngTemplateOutlet",a.dt.groupHeaderTemplate)("ngTemplateOutletContext",o.qbA(2,AF,i,a.getRowIndex(r),a.columns,"row"===a.dt.editMode&&a.dt.isRowEditing(i),a.frozen))}}function qie(n,t){1&n&&o.GkF(0)}function Kie(n,t){if(1&n&&(o.ynx(0),o.YNc(1,qie,1,0,"ng-container",4),o.BQk()),2&n){const e=o.oxw(),i=e.$implicit,r=e.index,a=o.oxw(2);o.xp6(1),o.Q6J("ngTemplateOutlet",i?a.template:a.dt.loadingBodyTemplate)("ngTemplateOutletContext",o.qbA(2,AF,i,a.getRowIndex(r),a.columns,"row"===a.dt.editMode&&a.dt.isRowEditing(i),a.frozen))}}function Yie(n,t){1&n&&o.GkF(0)}const Jie=function(n,t,e,i,r,a,g){return{$implicit:n,rowIndex:t,columns:e,editing:i,frozen:r,rowgroup:a,rowspan:g}};function Qie(n,t){if(1&n&&(o.ynx(0),o.YNc(1,Yie,1,0,"ng-container",4),o.BQk()),2&n){const e=o.oxw(),i=e.$implicit,r=e.index,a=o.oxw(2);o.xp6(1),o.Q6J("ngTemplateOutlet",i?a.template:a.dt.loadingBodyTemplate)("ngTemplateOutletContext",o.Hh0(2,Jie,i,a.getRowIndex(r),a.columns,"row"===a.dt.editMode&&a.dt.isRowEditing(i),a.frozen,a.shouldRenderRowspan(a.value,i,r),a.calculateRowGroupSize(a.value,i,r)))}}function Xie(n,t){1&n&&o.GkF(0)}function ere(n,t){if(1&n&&(o.ynx(0,3),o.YNc(1,Xie,1,0,"ng-container",4),o.BQk()),2&n){const e=o.oxw(),i=e.$implicit,r=e.index,a=o.oxw(2);o.xp6(1),o.Q6J("ngTemplateOutlet",a.dt.groupFooterTemplate)("ngTemplateOutletContext",o.qbA(2,AF,i,a.getRowIndex(r),a.columns,"row"===a.dt.editMode&&a.dt.isRowEditing(i),a.frozen))}}function tre(n,t){if(1&n&&(o.YNc(0,Zie,2,8,"ng-container",2),o.YNc(1,Kie,2,8,"ng-container",0),o.YNc(2,Qie,2,10,"ng-container",0),o.YNc(3,ere,2,8,"ng-container",2)),2&n){const e=t.$implicit,i=t.index,r=o.oxw(2);o.Q6J("ngIf",r.dt.groupHeaderTemplate&&!r.dt.virtualScroll&&"subheader"===r.dt.rowGroupMode&&r.shouldRenderRowGroupHeader(r.value,e,i)),o.xp6(1),o.Q6J("ngIf","rowspan"!==r.dt.rowGroupMode),o.xp6(1),o.Q6J("ngIf","rowspan"===r.dt.rowGroupMode),o.xp6(1),o.Q6J("ngIf",r.dt.groupFooterTemplate&&!r.dt.virtualScroll&&"subheader"===r.dt.rowGroupMode&&r.shouldRenderRowGroupFooter(r.value,e,i))}}function nre(n,t){if(1&n&&(o.ynx(0),o.YNc(1,tre,4,4,"ng-template",1),o.BQk()),2&n){const e=o.oxw();o.xp6(1),o.Q6J("ngForOf",e.value)("ngForTrackBy",e.dt.rowTrackBy)}}function ire(n,t){1&n&&o.GkF(0)}const _k=function(n,t,e,i,r,a){return{$implicit:n,rowIndex:t,columns:e,expanded:i,editing:r,frozen:a}};function rre(n,t){if(1&n&&(o.ynx(0),o.YNc(1,ire,1,0,"ng-container",4),o.BQk()),2&n){const e=o.oxw(),i=e.$implicit,r=e.index,a=o.oxw(2);o.xp6(1),o.Q6J("ngTemplateOutlet",a.template)("ngTemplateOutletContext",o.HTZ(2,_k,i,a.getRowIndex(r),a.columns,a.dt.isRowExpanded(i),"row"===a.dt.editMode&&a.dt.isRowEditing(i),a.frozen))}}function ore(n,t){1&n&&o.GkF(0)}function sre(n,t){if(1&n&&(o.ynx(0,3),o.YNc(1,ore,1,0,"ng-container",4),o.BQk()),2&n){const e=o.oxw(),i=e.$implicit,r=e.index,a=o.oxw(2);o.xp6(1),o.Q6J("ngTemplateOutlet",a.dt.groupHeaderTemplate)("ngTemplateOutletContext",o.HTZ(2,_k,i,a.getRowIndex(r),a.columns,a.dt.isRowExpanded(i),"row"===a.dt.editMode&&a.dt.isRowEditing(i),a.frozen))}}function are(n,t){1&n&&o.GkF(0)}function lre(n,t){1&n&&o.GkF(0)}function cre(n,t){if(1&n&&(o.ynx(0,3),o.YNc(1,lre,1,0,"ng-container",4),o.BQk()),2&n){const e=o.oxw(2),i=e.$implicit,r=e.index,a=o.oxw(2);o.xp6(1),o.Q6J("ngTemplateOutlet",a.dt.groupFooterTemplate)("ngTemplateOutletContext",o.HTZ(2,_k,i,a.getRowIndex(r),a.columns,a.dt.isRowExpanded(i),"row"===a.dt.editMode&&a.dt.isRowEditing(i),a.frozen))}}const o5=function(n,t,e,i){return{$implicit:n,rowIndex:t,columns:e,frozen:i}};function ure(n,t){if(1&n&&(o.ynx(0),o.YNc(1,are,1,0,"ng-container",4),o.YNc(2,cre,2,9,"ng-container",2),o.BQk()),2&n){const e=o.oxw(),i=e.$implicit,r=e.index,a=o.oxw(2);o.xp6(1),o.Q6J("ngTemplateOutlet",a.dt.expandedRowTemplate)("ngTemplateOutletContext",o.l5B(3,o5,i,a.getRowIndex(r),a.columns,a.frozen)),o.xp6(1),o.Q6J("ngIf",a.dt.groupFooterTemplate&&"subheader"===a.dt.rowGroupMode&&a.shouldRenderRowGroupFooter(a.value,i,a.getRowIndex(r)))}}function hre(n,t){if(1&n&&(o.YNc(0,rre,2,9,"ng-container",0),o.YNc(1,sre,2,9,"ng-container",2),o.YNc(2,ure,3,8,"ng-container",0)),2&n){const e=t.$implicit,i=t.index,r=o.oxw(2);o.Q6J("ngIf",!r.dt.groupHeaderTemplate),o.xp6(1),o.Q6J("ngIf",r.dt.groupHeaderTemplate&&"subheader"===r.dt.rowGroupMode&&r.shouldRenderRowGroupHeader(r.value,e,r.getRowIndex(i))),o.xp6(1),o.Q6J("ngIf",r.dt.isRowExpanded(e))}}function dre(n,t){if(1&n&&(o.ynx(0),o.YNc(1,hre,3,3,"ng-template",1),o.BQk()),2&n){const e=o.oxw();o.xp6(1),o.Q6J("ngForOf",e.value)("ngForTrackBy",e.dt.rowTrackBy)}}function pre(n,t){1&n&&o.GkF(0)}function fre(n,t){1&n&&o.GkF(0)}function mre(n,t){if(1&n&&(o.ynx(0),o.YNc(1,fre,1,0,"ng-container",4),o.BQk()),2&n){const e=o.oxw(),i=e.$implicit,r=e.index,a=o.oxw(2);o.xp6(1),o.Q6J("ngTemplateOutlet",a.dt.frozenExpandedRowTemplate)("ngTemplateOutletContext",o.l5B(2,o5,i,a.getRowIndex(r),a.columns,a.frozen))}}function gre(n,t){if(1&n&&(o.YNc(0,pre,1,0,"ng-container",4),o.YNc(1,mre,2,7,"ng-container",0)),2&n){const e=t.$implicit,i=t.index,r=o.oxw(2);o.Q6J("ngTemplateOutlet",r.template)("ngTemplateOutletContext",o.HTZ(3,_k,e,r.getRowIndex(i),r.columns,r.dt.isRowExpanded(e),"row"===r.dt.editMode&&r.dt.isRowEditing(e),r.frozen)),o.xp6(1),o.Q6J("ngIf",r.dt.isRowExpanded(e))}}function _re(n,t){if(1&n&&(o.ynx(0),o.YNc(1,gre,2,10,"ng-template",1),o.BQk()),2&n){const e=o.oxw();o.xp6(1),o.Q6J("ngForOf",e.value)("ngForTrackBy",e.dt.rowTrackBy)}}function yre(n,t){1&n&&o.GkF(0)}const s5=function(n,t){return{$implicit:n,frozen:t}};function vre(n,t){if(1&n&&(o.ynx(0),o.YNc(1,yre,1,0,"ng-container",4),o.BQk()),2&n){const e=o.oxw();o.xp6(1),o.Q6J("ngTemplateOutlet",e.dt.loadingBodyTemplate)("ngTemplateOutletContext",o.WLB(2,s5,e.columns,e.frozen))}}function bre(n,t){1&n&&o.GkF(0)}function wre(n,t){if(1&n&&(o.ynx(0),o.YNc(1,bre,1,0,"ng-container",4),o.BQk()),2&n){const e=o.oxw();o.xp6(1),o.Q6J("ngTemplateOutlet",e.dt.emptyMessageTemplate)("ngTemplateOutletContext",o.WLB(2,s5,e.columns,e.frozen))}}const Ere=function(n,t){return{"p-checkbox-focused":n,"p-checkbox-disabled":t}},Tre=function(n,t,e){return{"p-checkbox-box p-component":!0,"p-highlight":n,"p-focus":t,"p-disabled":e}},Sre=function(n){return{"pi pi-check":n}};let XS=(()=>{class n{constructor(){this.sortSource=new Es.x,this.selectionSource=new Es.x,this.contextMenuSource=new Es.x,this.valueSource=new Es.x,this.totalRecordsSource=new Es.x,this.columnsSource=new Es.x,this.resetSource=new Es.x,this.sortSource$=this.sortSource.asObservable(),this.selectionSource$=this.selectionSource.asObservable(),this.contextMenuSource$=this.contextMenuSource.asObservable(),this.valueSource$=this.valueSource.asObservable(),this.totalRecordsSource$=this.totalRecordsSource.asObservable(),this.columnsSource$=this.columnsSource.asObservable(),this.resetSource$=this.resetSource.asObservable()}onSort(e){this.sortSource.next(e)}onSelectionChange(){this.selectionSource.next(null)}onResetChange(){this.resetSource.next(null)}onContextMenu(e){this.contextMenuSource.next(e)}onValueChange(e){this.valueSource.next(e)}onTotalRecordsChange(e){this.totalRecordsSource.next(e)}onColumnsChange(e){this.columnsSource.next(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac}),n})(),yk=(()=>{class n{constructor(e,i,r,a,g,E){this.el=e,this.zone=i,this.tableService=r,this.cd=a,this.filterService=g,this.overlayService=E,this.pageLinks=5,this.alwaysShowPaginator=!0,this.paginatorPosition="bottom",this.paginatorDropdownScrollHeight="200px",this.currentPageReportTemplate="{currentPage} of {totalPages}",this.showFirstLastIcon=!0,this.showPageLinks=!0,this.defaultSortOrder=1,this.sortMode="single",this.resetPageOnSort=!0,this.selectAllChange=new o.vpe,this.selectionChange=new o.vpe,this.contextMenuSelectionChange=new o.vpe,this.contextMenuSelectionMode="separate",this.rowTrackBy=(O,j)=>j,this.lazy=!1,this.lazyLoadOnInit=!0,this.compareSelectionBy="deepEquals",this.csvSeparator=",",this.exportFilename="download",this.filters={},this.filterDelay=300,this.expandedRowKeys={},this.editingRowKeys={},this.rowExpandMode="multiple",this.scrollDirection="vertical",this.virtualScrollDelay=250,this.columnResizeMode="fit",this.loadingIcon="pi pi-spinner",this.showLoader=!0,this.showInitialSortBadge=!0,this.stateStorage="session",this.editMode="cell",this.groupRowsByOrder=1,this.responsiveLayout="scroll",this.breakpoint="960px",this.onRowSelect=new o.vpe,this.onRowUnselect=new o.vpe,this.onPage=new o.vpe,this.onSort=new o.vpe,this.onFilter=new o.vpe,this.onLazyLoad=new o.vpe,this.onRowExpand=new o.vpe,this.onRowCollapse=new o.vpe,this.onContextMenuSelect=new o.vpe,this.onColResize=new o.vpe,this.onColReorder=new o.vpe,this.onRowReorder=new o.vpe,this.onEditInit=new o.vpe,this.onEditComplete=new o.vpe,this.onEditCancel=new o.vpe,this.onHeaderCheckboxToggle=new o.vpe,this.sortFunction=new o.vpe,this.firstChange=new o.vpe,this.rowsChange=new o.vpe,this.onStateSave=new o.vpe,this.onStateRestore=new o.vpe,this._virtualRowHeight=28,this._value=[],this._totalRecords=0,this._first=0,this.selectionKeys={},this._sortOrder=1,this._selectAll=null,this.columnResizing=!1,this.rowGroupHeaderStyleObject={},this.id=YS()}get responsive(){return this._responsive}set responsive(e){this._responsive=e,console.warn("responsive propery is deprecated as table is always responsive with scrollable behavior.")}get virtualRowHeight(){return this._virtualRowHeight}set virtualRowHeight(e){this._virtualRowHeight=e,console.warn("The virtualRowHeight property is deprecated, use virtualScrollItemSize property instead.")}ngOnInit(){this.lazy&&this.lazyLoadOnInit&&(this.virtualScroll||this.onLazyLoad.emit(this.createLazyLoadMetadata()),this.restoringFilter&&(this.restoringFilter=!1)),"stack"===this.responsiveLayout&&!this.scrollable&&this.createResponsiveStyle(),this.initialized=!0}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"caption":this.captionTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"headergrouped":this.headerGroupedTemplate=e.template;break;case"body":this.bodyTemplate=e.template;break;case"loadingbody":this.loadingBodyTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"footergrouped":this.footerGroupedTemplate=e.template;break;case"summary":this.summaryTemplate=e.template;break;case"colgroup":this.colGroupTemplate=e.template;break;case"rowexpansion":this.expandedRowTemplate=e.template;break;case"groupheader":this.groupHeaderTemplate=e.template;break;case"rowspan":this.rowspanTemplate=e.template;break;case"groupfooter":this.groupFooterTemplate=e.template;break;case"frozenrows":this.frozenRowsTemplate=e.template;break;case"frozenheader":this.frozenHeaderTemplate=e.template;break;case"frozenbody":this.frozenBodyTemplate=e.template;break;case"frozenfooter":this.frozenFooterTemplate=e.template;break;case"frozencolgroup":this.frozenColGroupTemplate=e.template;break;case"frozenrowexpansion":this.frozenExpandedRowTemplate=e.template;break;case"emptymessage":this.emptyMessageTemplate=e.template;break;case"paginatorleft":this.paginatorLeftTemplate=e.template;break;case"paginatorright":this.paginatorRightTemplate=e.template;break;case"paginatordropdownitem":this.paginatorDropdownItemTemplate=e.template}})}ngAfterViewInit(){this.isStateful()&&this.resizableColumns&&this.restoreColumnWidths()}ngOnChanges(e){e.value&&(this.isStateful()&&!this.stateRestored&&this.restoreState(),this._value=e.value.currentValue,this.lazy||(this.totalRecords=this._value?this._value.length:0,"single"==this.sortMode&&(this.sortField||this.groupRowsBy)?this.sortSingle():"multiple"==this.sortMode&&(this.multiSortMeta||this.groupRowsBy)?this.sortMultiple():this.hasFilter()&&this._filter()),this.tableService.onValueChange(e.value.currentValue)),e.columns&&(this._columns=e.columns.currentValue,this.tableService.onColumnsChange(e.columns.currentValue),this._columns&&this.isStateful()&&this.reorderableColumns&&!this.columnOrderStateRestored&&this.restoreColumnOrder()),e.sortField&&(this._sortField=e.sortField.currentValue,(!this.lazy||this.initialized)&&"single"===this.sortMode&&this.sortSingle()),e.groupRowsBy&&(!this.lazy||this.initialized)&&"single"===this.sortMode&&this.sortSingle(),e.sortOrder&&(this._sortOrder=e.sortOrder.currentValue,(!this.lazy||this.initialized)&&"single"===this.sortMode&&this.sortSingle()),e.groupRowsByOrder&&(!this.lazy||this.initialized)&&"single"===this.sortMode&&this.sortSingle(),e.multiSortMeta&&(this._multiSortMeta=e.multiSortMeta.currentValue,"multiple"===this.sortMode&&(this.initialized||!this.lazy&&!this.virtualScroll)&&this.sortMultiple()),e.selection&&(this._selection=e.selection.currentValue,this.preventSelectionSetterPropagation||(this.updateSelectionKeys(),this.tableService.onSelectionChange()),this.preventSelectionSetterPropagation=!1),e.selectAll&&(this._selectAll=e.selectAll.currentValue,this.preventSelectionSetterPropagation||(this.updateSelectionKeys(),this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()),this.preventSelectionSetterPropagation=!1)}get value(){return this._value}set value(e){this._value=e}get columns(){return this._columns}set columns(e){this._columns=e}get first(){return this._first}set first(e){this._first=e}get rows(){return this._rows}set rows(e){this._rows=e}get totalRecords(){return this._totalRecords}set totalRecords(e){this._totalRecords=e,this.tableService.onTotalRecordsChange(this._totalRecords)}get sortField(){return this._sortField}set sortField(e){this._sortField=e}get sortOrder(){return this._sortOrder}set sortOrder(e){this._sortOrder=e}get multiSortMeta(){return this._multiSortMeta}set multiSortMeta(e){this._multiSortMeta=e}get selection(){return this._selection}set selection(e){this._selection=e}get selectAll(){return this._selection}set selectAll(e){this._selection=e}get processedData(){return this.filteredValue||this.value||[]}dataToRender(e){const i=e||this.processedData;if(i&&this.paginator){const r=this.lazy?0:this.first;return i.slice(r,r+this.rows)}return i}updateSelectionKeys(){if(this.dataKey&&this._selection)if(this.selectionKeys={},Array.isArray(this._selection))for(let e of this._selection)this.selectionKeys[String(ti.resolveFieldData(e,this.dataKey))]=1;else this.selectionKeys[String(ti.resolveFieldData(this._selection,this.dataKey))]=1}onPageChange(e){this.first=e.first,this.rows=e.rows,this.onPage.emit({first:this.first,rows:this.rows}),this.lazy&&this.onLazyLoad.emit(this.createLazyLoadMetadata()),this.firstChange.emit(this.first),this.rowsChange.emit(this.rows),this.tableService.onValueChange(this.value),this.isStateful()&&this.saveState(),this.anchorRowIndex=null,this.scrollable&&this.resetScrollTop()}sort(e){let i=e.originalEvent;if("single"===this.sortMode&&(this._sortOrder=this.sortField===e.field?-1*this.sortOrder:this.defaultSortOrder,this._sortField=e.field,this.resetPageOnSort&&(this._first=0,this.firstChange.emit(this._first),this.scrollable&&this.resetScrollTop()),this.sortSingle()),"multiple"===this.sortMode){let r=i.metaKey||i.ctrlKey,a=this.getSortMeta(e.field);a?r?a.order=-1*a.order:(this._multiSortMeta=[{field:e.field,order:-1*a.order}],this.resetPageOnSort&&(this._first=0,this.firstChange.emit(this._first),this.scrollable&&this.resetScrollTop())):((!r||!this.multiSortMeta)&&(this._multiSortMeta=[],this.resetPageOnSort&&(this._first=0,this.firstChange.emit(this._first))),this._multiSortMeta.push({field:e.field,order:this.defaultSortOrder})),this.sortMultiple()}this.isStateful()&&this.saveState(),this.anchorRowIndex=null}sortSingle(){let e=this.sortField||this.groupRowsBy,i=this.sortField?this.sortOrder:this.groupRowsByOrder;if(this.groupRowsBy&&this.sortField&&this.groupRowsBy!==this.sortField)return this._multiSortMeta=[this.getGroupRowsMeta(),{field:this.sortField,order:this.sortOrder}],void this.sortMultiple();if(e&&i){this.restoringSort&&(this.restoringSort=!1),this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.value&&(this.customSort?this.sortFunction.emit({data:this.value,mode:this.sortMode,field:e,order:i}):(this.value.sort((a,g)=>{let E=ti.resolveFieldData(a,e),O=ti.resolveFieldData(g,e),j=null;return j=null==E&&null!=O?-1:null!=E&&null==O?1:null==E&&null==O?0:"string"==typeof E&&"string"==typeof O?E.localeCompare(O):E<O?-1:E>O?1:0,i*j}),this._value=[...this.value]),this.hasFilter()&&this._filter());let r={field:e,order:i};this.onSort.emit(r),this.tableService.onSort(r)}}sortMultiple(){this.groupRowsBy&&(this._multiSortMeta?this.multiSortMeta[0].field!==this.groupRowsBy&&(this._multiSortMeta=[this.getGroupRowsMeta(),...this._multiSortMeta]):this._multiSortMeta=[this.getGroupRowsMeta()]),this.multiSortMeta&&(this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.value&&(this.customSort?this.sortFunction.emit({data:this.value,mode:this.sortMode,multiSortMeta:this.multiSortMeta}):(this.value.sort((e,i)=>this.multisortField(e,i,this.multiSortMeta,0)),this._value=[...this.value]),this.hasFilter()&&this._filter()),this.onSort.emit({multisortmeta:this.multiSortMeta}),this.tableService.onSort(this.multiSortMeta))}multisortField(e,i,r,a){const g=ti.resolveFieldData(e,r[a].field),E=ti.resolveFieldData(i,r[a].field);return 0===ti.compare(g,E,this.filterLocale)?r.length-1>a?this.multisortField(e,i,r,a+1):0:this.compareValuesOnSort(g,E,r[a].order)}compareValuesOnSort(e,i,r){return ti.sort(e,i,r,this.filterLocale,this.sortOrder)}getSortMeta(e){if(this.multiSortMeta&&this.multiSortMeta.length)for(let i=0;i<this.multiSortMeta.length;i++)if(this.multiSortMeta[i].field===e)return this.multiSortMeta[i];return null}isSorted(e){if("single"===this.sortMode)return this.sortField&&this.sortField===e;if("multiple"===this.sortMode){let i=!1;if(this.multiSortMeta)for(let r=0;r<this.multiSortMeta.length;r++)if(this.multiSortMeta[r].field==e){i=!0;break}return i}}handleRowClick(e){let i=e.originalEvent.target,r=i.nodeName,a=i.parentElement&&i.parentElement.nodeName;if("INPUT"!=r&&"BUTTON"!=r&&"A"!=r&&"INPUT"!=a&&"BUTTON"!=a&&"A"!=a&&!pt.hasClass(e.originalEvent.target,"p-clickable")){if(this.selectionMode){let g=e.rowData,E=e.rowIndex;if(this.preventSelectionSetterPropagation=!0,this.isMultipleSelectionMode()&&e.originalEvent.shiftKey&&null!=this.anchorRowIndex)pt.clearSelection(),null!=this.rangeRowIndex&&this.clearSelectionRange(e.originalEvent),this.rangeRowIndex=E,this.selectRange(e.originalEvent,E);else{let O=this.isSelected(g);if(!O&&!this.isRowSelectable(g,E))return;let j=!this.rowTouched&&this.metaKeySelection,Y=this.dataKey?String(ti.resolveFieldData(g,this.dataKey)):null;if(this.anchorRowIndex=E,this.rangeRowIndex=E,j){let se=e.originalEvent.metaKey||e.originalEvent.ctrlKey;if(O&&se){if(this.isSingleSelectionMode())this._selection=null,this.selectionKeys={},this.selectionChange.emit(null);else{let be=this.findIndexInSelection(g);this._selection=this.selection.filter((Me,Ge)=>Ge!=be),this.selectionChange.emit(this.selection),Y&&delete this.selectionKeys[Y]}this.onRowUnselect.emit({originalEvent:e.originalEvent,data:g,type:"row"})}else this.isSingleSelectionMode()?(this._selection=g,this.selectionChange.emit(g),Y&&(this.selectionKeys={},this.selectionKeys[Y]=1)):this.isMultipleSelectionMode()&&(se?this._selection=this.selection||[]:(this._selection=[],this.selectionKeys={}),this._selection=[...this.selection,g],this.selectionChange.emit(this.selection),Y&&(this.selectionKeys[Y]=1)),this.onRowSelect.emit({originalEvent:e.originalEvent,data:g,type:"row",index:E})}else if("single"===this.selectionMode)O?(this._selection=null,this.selectionKeys={},this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,data:g,type:"row",index:E})):(this._selection=g,this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,data:g,type:"row",index:E}),Y&&(this.selectionKeys={},this.selectionKeys[Y]=1));else if("multiple"===this.selectionMode)if(O){let se=this.findIndexInSelection(g);this._selection=this.selection.filter((be,Me)=>Me!=se),this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,data:g,type:"row",index:E}),Y&&delete this.selectionKeys[Y]}else this._selection=this.selection?[...this.selection,g]:[g],this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,data:g,type:"row",index:E}),Y&&(this.selectionKeys[Y]=1)}this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()}this.rowTouched=!1}}handleRowTouchEnd(e){this.rowTouched=!0}handleRowRightClick(e){if(this.contextMenu){const i=e.rowData,r=e.rowIndex;if("separate"===this.contextMenuSelectionMode)this.contextMenuSelection=i,this.contextMenuSelectionChange.emit(i),this.onContextMenuSelect.emit({originalEvent:e.originalEvent,data:i,index:e.rowIndex}),this.contextMenu.show(e.originalEvent),this.tableService.onContextMenu(i);else if("joint"===this.contextMenuSelectionMode){this.preventSelectionSetterPropagation=!0;let a=this.isSelected(i),g=this.dataKey?String(ti.resolveFieldData(i,this.dataKey)):null;if(!a){if(!this.isRowSelectable(i,r))return;this.isSingleSelectionMode()?(this.selection=i,this.selectionChange.emit(i),g&&(this.selectionKeys={},this.selectionKeys[g]=1)):this.isMultipleSelectionMode()&&(this._selection=this.selection?[...this.selection,i]:[i],this.selectionChange.emit(this.selection),g&&(this.selectionKeys[g]=1))}this.tableService.onSelectionChange(),this.contextMenu.show(e.originalEvent),this.onContextMenuSelect.emit({originalEvent:e,data:i,index:e.rowIndex})}}}selectRange(e,i){let r,a;this.anchorRowIndex>i?(r=i,a=this.anchorRowIndex):this.anchorRowIndex<i?(r=this.anchorRowIndex,a=i):(r=i,a=i),this.lazy&&this.paginator&&(r-=this.first,a-=this.first);let g=[];for(let E=r;E<=a;E++){let O=this.filteredValue?this.filteredValue[E]:this.value[E];if(!this.isSelected(O)){if(!this.isRowSelectable(O,i))continue;g.push(O),this._selection=[...this.selection,O];let j=this.dataKey?String(ti.resolveFieldData(O,this.dataKey)):null;j&&(this.selectionKeys[j]=1)}}this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e,data:g,type:"row"})}clearSelectionRange(e){let i,r;this.rangeRowIndex>this.anchorRowIndex?(i=this.anchorRowIndex,r=this.rangeRowIndex):this.rangeRowIndex<this.anchorRowIndex?(i=this.rangeRowIndex,r=this.anchorRowIndex):(i=this.rangeRowIndex,r=this.rangeRowIndex);for(let a=i;a<=r;a++){let g=this.value[a],E=this.findIndexInSelection(g);this._selection=this.selection.filter((j,Y)=>Y!=E);let O=this.dataKey?String(ti.resolveFieldData(g,this.dataKey)):null;O&&delete this.selectionKeys[O],this.onRowUnselect.emit({originalEvent:e,data:g,type:"row"})}}isSelected(e){return!(!e||!this.selection)&&(this.dataKey?void 0!==this.selectionKeys[ti.resolveFieldData(e,this.dataKey)]:this.selection instanceof Array?this.findIndexInSelection(e)>-1:this.equals(e,this.selection))}findIndexInSelection(e){let i=-1;if(this.selection&&this.selection.length)for(let r=0;r<this.selection.length;r++)if(this.equals(e,this.selection[r])){i=r;break}return i}isRowSelectable(e,i){return!(this.rowSelectable&&!this.rowSelectable({data:e,index:i}))}toggleRowWithRadio(e,i){if(this.preventSelectionSetterPropagation=!0,this.selection!=i){if(!this.isRowSelectable(i,e.rowIndex))return;this._selection=i,this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:i,type:"radiobutton"}),this.dataKey&&(this.selectionKeys={},this.selectionKeys[String(ti.resolveFieldData(i,this.dataKey))]=1)}else this._selection=null,this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:i,type:"radiobutton"});this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()}toggleRowWithCheckbox(e,i){this.selection=this.selection||[];let r=this.isSelected(i),a=this.dataKey?String(ti.resolveFieldData(i,this.dataKey)):null;if(this.preventSelectionSetterPropagation=!0,r){let g=this.findIndexInSelection(i);this._selection=this.selection.filter((E,O)=>O!=g),this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:i,type:"checkbox"}),a&&delete this.selectionKeys[a]}else{if(!this.isRowSelectable(i,e.rowIndex))return;this._selection=this.selection?[...this.selection,i]:[i],this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:i,type:"checkbox"}),a&&(this.selectionKeys[a]=1)}this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()}toggleRowsWithCheckbox(e,i){if(null!==this._selectAll)this.selectAllChange.emit({originalEvent:e,checked:i});else{const r=this.selectionPageOnly?this.dataToRender(this.processedData):this.processedData;let a=this.selectionPageOnly&&this._selection?this._selection.filter(g=>!r.some(E=>this.equals(g,E))):[];i&&(a=this.frozenValue?[...a,...this.frozenValue,...r]:[...a,...r],a=this.rowSelectable?a.filter((g,E)=>this.rowSelectable({data:g,index:E})):a),this._selection=a,this.preventSelectionSetterPropagation=!0,this.updateSelectionKeys(),this.selectionChange.emit(this._selection),this.tableService.onSelectionChange(),this.onHeaderCheckboxToggle.emit({originalEvent:e,checked:i}),this.isStateful()&&this.saveState()}}equals(e,i){return"equals"===this.compareSelectionBy?e===i:ti.equals(e,i,this.dataKey)}filter(e,i,r){this.filterTimeout&&clearTimeout(this.filterTimeout),this.isFilterBlank(e)?this.filters[i]&&delete this.filters[i]:this.filters[i]={value:e,matchMode:r},this.filterTimeout=setTimeout(()=>{this._filter(),this.filterTimeout=null},this.filterDelay),this.anchorRowIndex=null}filterGlobal(e,i){this.filter(e,"global",i)}isFilterBlank(e){return null==e||"string"==typeof e&&0==e.trim().length||e instanceof Array&&0==e.length}_filter(){if(this.restoringFilter||(this.first=0,this.firstChange.emit(this.first)),this.lazy)this.onLazyLoad.emit(this.createLazyLoadMetadata());else{if(!this.value)return;if(this.hasFilter()){let e;if(this.filters.global){if(!this.columns&&!this.globalFilterFields)throw new Error("Global filtering requires dynamic columns or globalFilterFields to be defined.");e=this.globalFilterFields||this.columns}this.filteredValue=[];for(let i=0;i<this.value.length;i++){let E,r=!0,a=!1,g=!1;for(let O in this.filters)if(this.filters.hasOwnProperty(O)&&"global"!==O){g=!0;let j=O,Y=this.filters[j];if(Array.isArray(Y)){for(let se of Y)if(r=this.executeLocalFilter(j,this.value[i],se),se.operator===U4.OR&&r||se.operator===U4.AND&&!r)break}else r=this.executeLocalFilter(j,this.value[i],Y);if(!r)break}if(this.filters.global&&!a&&e)for(let O=0;O<e.length&&(a=this.filterService.filters[this.filters.global.matchMode](ti.resolveFieldData(this.value[i],e[O].field||e[O]),this.filters.global.value,this.filterLocale),!a);O++);E=this.filters.global?g?g&&r&&a:a:g&&r,E&&this.filteredValue.push(this.value[i])}this.filteredValue.length===this.value.length&&(this.filteredValue=null),this.paginator&&(this.totalRecords=this.filteredValue?this.filteredValue.length:this.value?this.value.length:0)}else this.filteredValue=null,this.paginator&&(this.totalRecords=this.value?this.value.length:0)}this.onFilter.emit({filters:this.filters,filteredValue:this.filteredValue||this.value}),this.tableService.onValueChange(this.value),this.isStateful()&&!this.restoringFilter&&this.saveState(),this.restoringFilter&&(this.restoringFilter=!1),this.cd.markForCheck(),this.scrollable&&this.resetScrollTop()}executeLocalFilter(e,i,r){let a=r.value,g=r.matchMode||Pu.STARTS_WITH,E=ti.resolveFieldData(i,e);return(0,this.filterService.filters[g])(E,a,this.filterLocale)}hasFilter(){let e=!0;for(let i in this.filters)if(this.filters.hasOwnProperty(i)){e=!1;break}return!e}createLazyLoadMetadata(){return{first:this.first,rows:this.rows,sortField:this.sortField,sortOrder:this.sortOrder,filters:this.filters,globalFilter:this.filters&&this.filters.global?this.filters.global.value:null,multiSortMeta:this.multiSortMeta,forceUpdate:()=>this.cd.detectChanges()}}clear(){this._sortField=null,this._sortOrder=this.defaultSortOrder,this._multiSortMeta=null,this.tableService.onSort(null),this.filters.global&&(this.filters.global.value=null),this.filteredValue=null,this.tableService.onResetChange(),this.first=0,this.firstChange.emit(this.first),this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.totalRecords=this._value?this._value.length:0}reset(){this.clear()}getExportHeader(e){return e[this.exportHeader]||e.header||e.field}exportCSV(e){let i,r="",a=this.columns;e&&e.selectionOnly?i=this.selection||[]:e&&e.allValues?i=this.value||[]:(i=this.filteredValue||this.value,this.frozenValue&&(i=i?[...this.frozenValue,...i]:this.frozenValue));for(let O=0;O<a.length;O++){let j=a[O];!1!==j.exportable&&j.field&&(r+='"'+this.getExportHeader(j)+'"',O<a.length-1&&(r+=this.csvSeparator))}i.forEach((O,j)=>{r+="\n";for(let Y=0;Y<a.length;Y++){let se=a[Y];if(!1!==se.exportable&&se.field){let be=ti.resolveFieldData(O,se.field);be=null!=be?this.exportFunction?this.exportFunction({data:be,field:se.field}):String(be).replace(/"/g,'""'):"",r+='"'+be+'"',Y<a.length-1&&(r+=this.csvSeparator)}}});let g=new Blob([r],{type:"text/csv;charset=utf-8;"}),E=document.createElement("a");E.style.display="none",document.body.appendChild(E),void 0!==E.download?(E.setAttribute("href",URL.createObjectURL(g)),E.setAttribute("download",this.exportFilename+".csv"),E.click()):(r="data:text/csv;charset=utf-8,"+r,window.open(encodeURI(r))),document.body.removeChild(E)}onLazyItemLoad(e){this.onLazyLoad.emit({...this.createLazyLoadMetadata(),...e,rows:e.last-e.first})}resetScrollTop(){this.virtualScroll?this.scrollToVirtualIndex(0):this.scrollTo({top:0})}scrollToVirtualIndex(e){this.virtualScroll&&this.scroller.scrollToIndex(e)}scrollTo(e){this.virtualScroll?this.scroller.scrollTo(e):this.wrapperViewChild&&this.wrapperViewChild.nativeElement&&(this.wrapperViewChild.nativeElement.scrollTo?this.wrapperViewChild.nativeElement.scrollTo(e):(this.wrapperViewChild.nativeElement.scrollLeft=e.left,this.wrapperViewChild.nativeElement.scrollTop=e.top))}updateEditingCell(e,i,r,a){this.editingCell=e,this.editingCellData=i,this.editingCellField=r,this.editingCellRowIndex=a,this.bindDocumentEditListener()}isEditingCellValid(){return this.editingCell&&0===pt.find(this.editingCell,".ng-invalid.ng-dirty").length}bindDocumentEditListener(){this.documentEditListener||(this.documentEditListener=e=>{this.editingCell&&!this.selfClick&&this.isEditingCellValid()&&(pt.removeClass(this.editingCell,"p-cell-editing"),this.editingCell=null,this.onEditComplete.emit({field:this.editingCellField,data:this.editingCellData,originalEvent:e,index:this.editingCellRowIndex}),this.editingCellField=null,this.editingCellData=null,this.editingCellRowIndex=null,this.unbindDocumentEditListener(),this.cd.markForCheck(),this.overlaySubscription&&this.overlaySubscription.unsubscribe()),this.selfClick=!1},document.addEventListener("click",this.documentEditListener))}unbindDocumentEditListener(){this.documentEditListener&&(document.removeEventListener("click",this.documentEditListener),this.documentEditListener=null)}initRowEdit(e){let i=String(ti.resolveFieldData(e,this.dataKey));this.editingRowKeys[i]=!0}saveRowEdit(e,i){if(0===pt.find(i,".ng-invalid.ng-dirty").length){let r=String(ti.resolveFieldData(e,this.dataKey));delete this.editingRowKeys[r]}}cancelRowEdit(e){let i=String(ti.resolveFieldData(e,this.dataKey));delete this.editingRowKeys[i]}toggleRow(e,i){if(!this.dataKey)throw new Error("dataKey must be defined to use row expansion");let r=String(ti.resolveFieldData(e,this.dataKey));null!=this.expandedRowKeys[r]?(delete this.expandedRowKeys[r],this.onRowCollapse.emit({originalEvent:i,data:e})):("single"===this.rowExpandMode&&(this.expandedRowKeys={}),this.expandedRowKeys[r]=!0,this.onRowExpand.emit({originalEvent:i,data:e})),i&&i.preventDefault(),this.isStateful()&&this.saveState()}isRowExpanded(e){return!0===this.expandedRowKeys[String(ti.resolveFieldData(e,this.dataKey))]}isRowEditing(e){return!0===this.editingRowKeys[String(ti.resolveFieldData(e,this.dataKey))]}isSingleSelectionMode(){return"single"===this.selectionMode}isMultipleSelectionMode(){return"multiple"===this.selectionMode}onColumnResizeBegin(e){let i=pt.getOffset(this.containerViewChild.nativeElement).left;this.resizeColumnElement=e.target.parentElement,this.columnResizing=!0,this.lastResizerHelperX=e.pageX-i+this.containerViewChild.nativeElement.scrollLeft,this.onColumnResize(e),e.preventDefault()}onColumnResize(e){let i=pt.getOffset(this.containerViewChild.nativeElement).left;pt.addClass(this.containerViewChild.nativeElement,"p-unselectable-text"),this.resizeHelperViewChild.nativeElement.style.height=this.containerViewChild.nativeElement.offsetHeight+"px",this.resizeHelperViewChild.nativeElement.style.top="0px",this.resizeHelperViewChild.nativeElement.style.left=e.pageX-i+this.containerViewChild.nativeElement.scrollLeft+"px",this.resizeHelperViewChild.nativeElement.style.display="block"}onColumnResizeEnd(){let e=this.resizeHelperViewChild.nativeElement.offsetLeft-this.lastResizerHelperX,r=this.resizeColumnElement.offsetWidth+e;if(r>=(this.resizeColumnElement.style.minWidth.replace(/[^\d.]/g,"")||15)){if("fit"===this.columnResizeMode){let E=this.resizeColumnElement.nextElementSibling.offsetWidth-e;r>15&&E>15&&this.resizeTableCells(r,E)}else"expand"===this.columnResizeMode&&(this.setResizeTableWidth(this.tableViewChild.nativeElement.offsetWidth+e+"px"),this.resizeTableCells(r,null));this.onColResize.emit({element:this.resizeColumnElement,delta:e}),this.isStateful()&&this.saveState()}this.resizeHelperViewChild.nativeElement.style.display="none",pt.removeClass(this.containerViewChild.nativeElement,"p-unselectable-text")}resizeTableCells(e,i){let r=pt.index(this.resizeColumnElement),a=[];const g=pt.findSingle(this.containerViewChild.nativeElement,".p-datatable-thead");pt.find(g,"tr > th").forEach(j=>a.push(pt.getOuterWidth(j))),this.destroyStyleElement(),this.createStyleElement();let O="";a.forEach((j,Y)=>{let se=Y===r?e:i&&Y===r+1?i:j;O+=`\n                #${this.id}-table > .p-datatable-thead > tr > th:nth-child(${Y+1}),\n                #${this.id}-table > .p-datatable-tbody > tr > td:nth-child(${Y+1}),\n                #${this.id}-table > .p-datatable-tfoot > tr > td:nth-child(${Y+1}) {\n                    width: ${se}px !important; max-width: ${se}px !important;\n                }\n            `}),this.styleElement.innerHTML=O}onColumnDragStart(e,i){this.reorderIconWidth=pt.getHiddenElementOuterWidth(this.reorderIndicatorUpViewChild.nativeElement),this.reorderIconHeight=pt.getHiddenElementOuterHeight(this.reorderIndicatorDownViewChild.nativeElement),this.draggedColumn=i,e.dataTransfer.setData("text","b")}onColumnDragEnter(e,i){if(this.reorderableColumns&&this.draggedColumn&&i){e.preventDefault();let r=pt.getOffset(this.containerViewChild.nativeElement),a=pt.getOffset(i);if(this.draggedColumn!=i){pt.indexWithinGroup(this.draggedColumn,"preorderablecolumn"),pt.indexWithinGroup(i,"preorderablecolumn");let O=a.left-r.left,Y=a.left+i.offsetWidth/2;this.reorderIndicatorUpViewChild.nativeElement.style.top=a.top-r.top-(this.reorderIconHeight-1)+"px",this.reorderIndicatorDownViewChild.nativeElement.style.top=a.top-r.top+i.offsetHeight+"px",e.pageX>Y?(this.reorderIndicatorUpViewChild.nativeElement.style.left=O+i.offsetWidth-Math.ceil(this.reorderIconWidth/2)+"px",this.reorderIndicatorDownViewChild.nativeElement.style.left=O+i.offsetWidth-Math.ceil(this.reorderIconWidth/2)+"px",this.dropPosition=1):(this.reorderIndicatorUpViewChild.nativeElement.style.left=O-Math.ceil(this.reorderIconWidth/2)+"px",this.reorderIndicatorDownViewChild.nativeElement.style.left=O-Math.ceil(this.reorderIconWidth/2)+"px",this.dropPosition=-1),this.reorderIndicatorUpViewChild.nativeElement.style.display="block",this.reorderIndicatorDownViewChild.nativeElement.style.display="block"}else e.dataTransfer.dropEffect="none"}}onColumnDragLeave(e){this.reorderableColumns&&this.draggedColumn&&e.preventDefault()}onColumnDrop(e,i){if(e.preventDefault(),this.draggedColumn){let r=pt.indexWithinGroup(this.draggedColumn,"preorderablecolumn"),a=pt.indexWithinGroup(i,"preorderablecolumn"),g=r!=a;g&&(a-r==1&&-1===this.dropPosition||r-a==1&&1===this.dropPosition)&&(g=!1),g&&a<r&&1===this.dropPosition&&(a+=1),g&&a>r&&-1===this.dropPosition&&(a-=1),g&&(ti.reorderArray(this.columns,r,a),this.onColReorder.emit({dragIndex:r,dropIndex:a,columns:this.columns}),this.isStateful()&&this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.saveState()})})),this.reorderIndicatorUpViewChild.nativeElement.style.display="none",this.reorderIndicatorDownViewChild.nativeElement.style.display="none",this.draggedColumn.draggable=!1,this.draggedColumn=null,this.dropPosition=null}}onRowDragStart(e,i){this.rowDragging=!0,this.draggedRowIndex=i,e.dataTransfer.setData("text","b")}onRowDragOver(e,i,r){if(this.rowDragging&&this.draggedRowIndex!==i){let a=pt.getOffset(r).top+pt.getWindowScrollTop(),g=e.pageY,E=a+pt.getOuterHeight(r)/2,O=r.previousElementSibling;g<E?(pt.removeClass(r,"p-datatable-dragpoint-bottom"),this.droppedRowIndex=i,O?pt.addClass(O,"p-datatable-dragpoint-bottom"):pt.addClass(r,"p-datatable-dragpoint-top")):(O?pt.removeClass(O,"p-datatable-dragpoint-bottom"):pt.addClass(r,"p-datatable-dragpoint-top"),this.droppedRowIndex=i+1,pt.addClass(r,"p-datatable-dragpoint-bottom"))}}onRowDragLeave(e,i){let r=i.previousElementSibling;r&&pt.removeClass(r,"p-datatable-dragpoint-bottom"),pt.removeClass(i,"p-datatable-dragpoint-bottom"),pt.removeClass(i,"p-datatable-dragpoint-top")}onRowDragEnd(e){this.rowDragging=!1,this.draggedRowIndex=null,this.droppedRowIndex=null}onRowDrop(e,i){if(null!=this.droppedRowIndex){let r=this.draggedRowIndex>this.droppedRowIndex?this.droppedRowIndex:0===this.droppedRowIndex?0:this.droppedRowIndex-1;ti.reorderArray(this.value,this.draggedRowIndex,r),this.virtualScroll&&(this._value=[...this._value]),this.onRowReorder.emit({dragIndex:this.draggedRowIndex,dropIndex:r})}this.onRowDragLeave(e,i),this.onRowDragEnd(e)}isEmpty(){let e=this.filteredValue||this.value;return null==e||0==e.length}getBlockableElement(){return this.el.nativeElement.children[0]}getStorage(){switch(this.stateStorage){case"local":return window.localStorage;case"session":return window.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}}isStateful(){return null!=this.stateKey}saveState(){const e=this.getStorage();let i={};this.paginator&&(i.first=this.first,i.rows=this.rows),this.sortField&&(i.sortField=this.sortField,i.sortOrder=this.sortOrder),this.multiSortMeta&&(i.multiSortMeta=this.multiSortMeta),this.hasFilter()&&(i.filters=this.filters),this.resizableColumns&&this.saveColumnWidths(i),this.reorderableColumns&&this.saveColumnOrder(i),this.selection&&(i.selection=this.selection),Object.keys(this.expandedRowKeys).length&&(i.expandedRowKeys=this.expandedRowKeys),e.setItem(this.stateKey,JSON.stringify(i)),this.onStateSave.emit(i)}clearState(){const e=this.getStorage();this.stateKey&&e.removeItem(this.stateKey)}restoreState(){const i=this.getStorage().getItem(this.stateKey),r=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/;if(i){let g=JSON.parse(i,function(g,E){return"string"==typeof E&&r.test(E)?new Date(E):E});this.paginator&&(void 0!==this.first&&(this.first=g.first,this.firstChange.emit(this.first)),void 0!==this.rows&&(this.rows=g.rows,this.rowsChange.emit(this.rows))),g.sortField&&(this.restoringSort=!0,this._sortField=g.sortField,this._sortOrder=g.sortOrder),g.multiSortMeta&&(this.restoringSort=!0,this._multiSortMeta=g.multiSortMeta),g.filters&&(this.restoringFilter=!0,this.filters=g.filters),this.resizableColumns&&(this.columnWidthsState=g.columnWidths,this.tableWidthState=g.tableWidth),g.expandedRowKeys&&(this.expandedRowKeys=g.expandedRowKeys),g.selection&&Promise.resolve(null).then(()=>this.selectionChange.emit(g.selection)),this.stateRestored=!0,this.onStateRestore.emit(g)}}saveColumnWidths(e){let i=[];pt.find(this.containerViewChild.nativeElement,".p-datatable-thead > tr > th").forEach(a=>i.push(pt.getOuterWidth(a))),e.columnWidths=i.join(","),"expand"===this.columnResizeMode&&(e.tableWidth=pt.getOuterWidth(this.tableViewChild.nativeElement))}setResizeTableWidth(e){this.tableViewChild.nativeElement.style.width=e,this.tableViewChild.nativeElement.style.minWidth=e}restoreColumnWidths(){if(this.columnWidthsState){let e=this.columnWidthsState.split(",");if("expand"===this.columnResizeMode&&this.tableWidthState&&this.setResizeTableWidth(this.tableWidthState+"px"),ti.isNotEmpty(e)){this.createStyleElement();let i="";e.forEach((r,a)=>{i+=`\n                        #${this.id}-table > .p-datatable-thead > tr > th:nth-child(${a+1}),\n                        #${this.id}-table > .p-datatable-tbody > tr > td:nth-child(${a+1}),\n                        #${this.id}-table > .p-datatable-tfoot > tr > td:nth-child(${a+1}) {\n                            width: ${r}px !important; max-width: ${r}px !important\n                        }\n                    `}),this.styleElement.innerHTML=i}}}saveColumnOrder(e){if(this.columns){let i=[];this.columns.map(r=>{i.push(r.field||r.key)}),e.columnOrder=i}}restoreColumnOrder(){const i=this.getStorage().getItem(this.stateKey);if(i){let a=JSON.parse(i).columnOrder;if(a){let g=[];a.map(E=>{let O=this.findColumnByKey(E);O&&g.push(O)}),this.columnOrderStateRestored=!0,this.columns=g}}}findColumnByKey(e){if(!this.columns)return null;for(let i of this.columns)if(i.key===e||i.field===e)return i}createStyleElement(){this.styleElement=document.createElement("style"),this.styleElement.type="text/css",document.head.appendChild(this.styleElement)}getGroupRowsMeta(){return{field:this.groupRowsBy,order:this.groupRowsByOrder}}createResponsiveStyle(){this.responsiveStyleElement||(this.responsiveStyleElement=document.createElement("style"),this.responsiveStyleElement.type="text/css",document.head.appendChild(this.responsiveStyleElement),this.responsiveStyleElement.innerHTML=`\n@media screen and (max-width: ${this.breakpoint}) {\n    #${this.id}-table > .p-datatable-thead > tr > th,\n    #${this.id}-table > .p-datatable-tfoot > tr > td {\n        display: none !important;\n    }\n\n    #${this.id}-table > .p-datatable-tbody > tr > td {\n        display: flex;\n        width: 100% !important;\n        align-items: center;\n        justify-content: space-between;\n    }\n\n    #${this.id}-table > .p-datatable-tbody > tr > td:not(:last-child) {\n        border: 0 none;\n    }\n\n    #${this.id}.p-datatable-gridlines > .p-datatable-wrapper > .p-datatable-table > .p-datatable-tbody > tr > td:last-child {\n        border-top: 0;\n        border-right: 0;\n        border-left: 0;\n    }\n\n    #${this.id}-table > .p-datatable-tbody > tr > td > .p-column-title {\n        display: block;\n    }\n}\n`)}destroyResponsiveStyle(){this.responsiveStyleElement&&(document.head.removeChild(this.responsiveStyleElement),this.responsiveStyleElement=null)}destroyStyleElement(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)}ngOnDestroy(){this.unbindDocumentEditListener(),this.editingCell=null,this.initialized=null,this.destroyStyleElement(),this.destroyResponsiveStyle()}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.SBq),o.Y36(o.R0b),o.Y36(XS),o.Y36(o.sBO),o.Y36(H4),o.Y36(fk))},n.\u0275cmp=o.Xpm({type:n,selectors:[["p-table"]],contentQueries:function(e,i,r){if(1&e&&o.Suo(r,bp,4),2&e){let a;o.iGM(a=o.CRH())&&(i.templates=a)}},viewQuery:function(e,i){if(1&e&&(o.Gf(cie,5),o.Gf(uie,5),o.Gf(hie,5),o.Gf(die,5),o.Gf(pie,5),o.Gf(fie,5),o.Gf(mie,5),o.Gf(gie,5),o.Gf(_ie,5)),2&e){let r;o.iGM(r=o.CRH())&&(i.containerViewChild=r.first),o.iGM(r=o.CRH())&&(i.resizeHelperViewChild=r.first),o.iGM(r=o.CRH())&&(i.reorderIndicatorUpViewChild=r.first),o.iGM(r=o.CRH())&&(i.reorderIndicatorDownViewChild=r.first),o.iGM(r=o.CRH())&&(i.wrapperViewChild=r.first),o.iGM(r=o.CRH())&&(i.tableViewChild=r.first),o.iGM(r=o.CRH())&&(i.tableHeaderViewChild=r.first),o.iGM(r=o.CRH())&&(i.tableFooterViewChild=r.first),o.iGM(r=o.CRH())&&(i.scroller=r.first)}},hostAttrs:[1,"p-element"],inputs:{frozenColumns:"frozenColumns",frozenValue:"frozenValue",style:"style",styleClass:"styleClass",tableStyle:"tableStyle",tableStyleClass:"tableStyleClass",paginator:"paginator",pageLinks:"pageLinks",rowsPerPageOptions:"rowsPerPageOptions",alwaysShowPaginator:"alwaysShowPaginator",paginatorPosition:"paginatorPosition",paginatorDropdownAppendTo:"paginatorDropdownAppendTo",paginatorDropdownScrollHeight:"paginatorDropdownScrollHeight",currentPageReportTemplate:"currentPageReportTemplate",showCurrentPageReport:"showCurrentPageReport",showJumpToPageDropdown:"showJumpToPageDropdown",showJumpToPageInput:"showJumpToPageInput",showFirstLastIcon:"showFirstLastIcon",showPageLinks:"showPageLinks",defaultSortOrder:"defaultSortOrder",sortMode:"sortMode",resetPageOnSort:"resetPageOnSort",selectionMode:"selectionMode",selectionPageOnly:"selectionPageOnly",contextMenuSelection:"contextMenuSelection",contextMenuSelectionMode:"contextMenuSelectionMode",dataKey:"dataKey",metaKeySelection:"metaKeySelection",rowSelectable:"rowSelectable",rowTrackBy:"rowTrackBy",lazy:"lazy",lazyLoadOnInit:"lazyLoadOnInit",compareSelectionBy:"compareSelectionBy",csvSeparator:"csvSeparator",exportFilename:"exportFilename",filters:"filters",globalFilterFields:"globalFilterFields",filterDelay:"filterDelay",filterLocale:"filterLocale",expandedRowKeys:"expandedRowKeys",editingRowKeys:"editingRowKeys",rowExpandMode:"rowExpandMode",scrollable:"scrollable",scrollDirection:"scrollDirection",rowGroupMode:"rowGroupMode",scrollHeight:"scrollHeight",virtualScroll:"virtualScroll",virtualScrollItemSize:"virtualScrollItemSize",virtualScrollOptions:"virtualScrollOptions",virtualScrollDelay:"virtualScrollDelay",frozenWidth:"frozenWidth",responsive:"responsive",contextMenu:"contextMenu",resizableColumns:"resizableColumns",columnResizeMode:"columnResizeMode",reorderableColumns:"reorderableColumns",loading:"loading",loadingIcon:"loadingIcon",showLoader:"showLoader",rowHover:"rowHover",customSort:"customSort",showInitialSortBadge:"showInitialSortBadge",autoLayout:"autoLayout",exportFunction:"exportFunction",exportHeader:"exportHeader",stateKey:"stateKey",stateStorage:"stateStorage",editMode:"editMode",groupRowsBy:"groupRowsBy",groupRowsByOrder:"groupRowsByOrder",responsiveLayout:"responsiveLayout",breakpoint:"breakpoint",virtualRowHeight:"virtualRowHeight",value:"value",columns:"columns",first:"first",rows:"rows",totalRecords:"totalRecords",sortField:"sortField",sortOrder:"sortOrder",multiSortMeta:"multiSortMeta",selection:"selection",selectAll:"selectAll"},outputs:{selectAllChange:"selectAllChange",selectionChange:"selectionChange",contextMenuSelectionChange:"contextMenuSelectionChange",onRowSelect:"onRowSelect",onRowUnselect:"onRowUnselect",onPage:"onPage",onSort:"onSort",onFilter:"onFilter",onLazyLoad:"onLazyLoad",onRowExpand:"onRowExpand",onRowCollapse:"onRowCollapse",onContextMenuSelect:"onContextMenuSelect",onColResize:"onColResize",onColReorder:"onColReorder",onRowReorder:"onRowReorder",onEditInit:"onEditInit",onEditComplete:"onEditComplete",onEditCancel:"onEditCancel",onHeaderCheckboxToggle:"onHeaderCheckboxToggle",sortFunction:"sortFunction",firstChange:"firstChange",rowsChange:"rowsChange",onStateSave:"onStateSave",onStateRestore:"onStateRestore"},features:[o._Bn([XS]),o.TTD],decls:16,vars:22,consts:[[3,"ngStyle","ngClass"],["container",""],["class","p-datatable-loading-overlay p-component-overlay",4,"ngIf"],["class","p-datatable-header",4,"ngIf"],["styleClass","p-paginator-top",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","onPageChange",4,"ngIf"],[1,"p-datatable-wrapper",3,"ngStyle"],["wrapper",""],[3,"items","columns","style","scrollHeight","itemSize","step","delay","inline","lazy","loaderDisabled","showSpacer","showLoader","options","autoSize","onLazyLoad",4,"ngIf"],[4,"ngIf"],["buildInTable",""],["styleClass","p-paginator-bottom",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","onPageChange",4,"ngIf"],["class","p-datatable-footer",4,"ngIf"],["class","p-column-resizer-helper","style","display:none",4,"ngIf"],["class","pi pi-arrow-down p-datatable-reorder-indicator-up","style","display: none;",4,"ngIf"],["class","pi pi-arrow-up p-datatable-reorder-indicator-down","style","display: none;",4,"ngIf"],[1,"p-datatable-loading-overlay","p-component-overlay"],[1,"p-datatable-header"],[4,"ngTemplateOutlet"],["styleClass","p-paginator-top",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","onPageChange"],[3,"items","columns","scrollHeight","itemSize","step","delay","inline","lazy","loaderDisabled","showSpacer","showLoader","options","autoSize","onLazyLoad"],["scroller",""],["pTemplate","content"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["role","table",3,"ngClass"],["table",""],[1,"p-datatable-thead"],["thead",""],["class","p-datatable-tbody p-datatable-frozen-tbody",3,"value","frozenRows","pTableBody","pTableBodyTemplate","frozen",4,"ngIf"],[1,"p-datatable-tbody",3,"ngClass","value","pTableBody","pTableBodyTemplate","scrollerOptions"],["class","p-datatable-scroller-spacer",3,"style",4,"ngIf"],["class","p-datatable-tfoot",4,"ngIf"],[1,"p-datatable-tbody","p-datatable-frozen-tbody",3,"value","frozenRows","pTableBody","pTableBodyTemplate","frozen"],[1,"p-datatable-scroller-spacer"],[1,"p-datatable-tfoot"],["tfoot",""],["styleClass","p-paginator-bottom",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","onPageChange"],[1,"p-datatable-footer"],[1,"p-column-resizer-helper",2,"display","none"],["resizeHelper",""],[1,"pi","pi-arrow-down","p-datatable-reorder-indicator-up",2,"display","none"],["reorderIndicatorUp",""],[1,"pi","pi-arrow-up","p-datatable-reorder-indicator-down",2,"display","none"],["reorderIndicatorDown",""]],template:function(e,i){1&e&&(o.TgZ(0,"div",0,1),o.YNc(2,yie,2,2,"div",2),o.YNc(3,bie,2,1,"div",3),o.YNc(4,wie,1,17,"p-paginator",4),o.TgZ(5,"div",5,6),o.YNc(7,Tie,3,17,"p-scroller",7),o.YNc(8,Die,2,7,"ng-container",8),o.YNc(9,Fie,10,28,"ng-template",null,9,o.W1O),o.qZA(),o.YNc(11,Nie,1,17,"p-paginator",10),o.YNc(12,Bie,2,1,"div",11),o.YNc(13,Vie,2,0,"div",12),o.YNc(14,Uie,2,0,"span",13),o.YNc(15,Hie,2,0,"span",14),o.qZA()),2&e&&(o.Tol(i.styleClass),o.Q6J("ngStyle",i.style)("ngClass",o.kEZ(16,jie,i.rowHover||i.selectionMode,i.scrollable,i.scrollable&&"flex"===i.scrollHeight)),o.uIk("id",i.id),o.xp6(2),o.Q6J("ngIf",i.loading&&i.showLoader),o.xp6(1),o.Q6J("ngIf",i.captionTemplate),o.xp6(1),o.Q6J("ngIf",i.paginator&&("top"===i.paginatorPosition||"both"==i.paginatorPosition)),o.xp6(1),o.Q6J("ngStyle",o.VKq(20,Gie,i.virtualScroll?"":i.scrollHeight)),o.xp6(2),o.Q6J("ngIf",i.virtualScroll),o.xp6(1),o.Q6J("ngIf",!i.virtualScroll),o.xp6(3),o.Q6J("ngIf",i.paginator&&("bottom"===i.paginatorPosition||"both"==i.paginatorPosition)),o.xp6(1),o.Q6J("ngIf",i.summaryTemplate),o.xp6(1),o.Q6J("ngIf",i.resizableColumns),o.xp6(1),o.Q6J("ngIf",i.reorderableColumns),o.xp6(1),o.Q6J("ngIf",i.reorderableColumns))},dependencies:function(){return[Pi,Zn,Ki,qr,Gne,bp,CF,Kre]},styles:[".p-datatable{position:relative}.p-datatable>.p-datatable-wrapper{overflow:auto}.p-datatable-table{border-spacing:0px;width:100%}.p-datatable .p-sortable-column{cursor:pointer;-webkit-user-select:none;user-select:none}.p-datatable .p-sortable-column .p-column-title,.p-datatable .p-sortable-column .p-sortable-column-icon,.p-datatable .p-sortable-column .p-sortable-column-badge{vertical-align:middle}.p-datatable .p-sortable-column .p-sortable-column-badge{display:inline-flex;align-items:center;justify-content:center}.p-datatable-hoverable-rows .p-selectable-row{cursor:pointer}.p-datatable-scrollable>.p-datatable-wrapper{position:relative}.p-datatable-scrollable-table>.p-datatable-thead{position:sticky;top:0;z-index:1}.p-datatable-scrollable-table>.p-datatable-frozen-tbody{position:sticky;z-index:1}.p-datatable-scrollable-table>.p-datatable-tfoot{position:sticky;bottom:0;z-index:1}.p-datatable-scrollable .p-frozen-column{position:sticky;background:inherit}.p-datatable-scrollable th.p-frozen-column{z-index:1}.p-datatable-flex-scrollable{display:flex;flex-direction:column;height:100%}.p-datatable-flex-scrollable>.p-datatable-wrapper{display:flex;flex-direction:column;flex:1;height:100%}.p-datatable-scrollable-table>.p-datatable-tbody>.p-rowgroup-header{position:sticky;z-index:1}.p-datatable-resizable-table>.p-datatable-thead>tr>th,.p-datatable-resizable-table>.p-datatable-tfoot>tr>td,.p-datatable-resizable-table>.p-datatable-tbody>tr>td{overflow:hidden;white-space:nowrap}.p-datatable-resizable-table>.p-datatable-thead>tr>th.p-resizable-column:not(.p-frozen-column){background-clip:padding-box;position:relative}.p-datatable-resizable-table-fit>.p-datatable-thead>tr>th.p-resizable-column:last-child .p-column-resizer{display:none}.p-datatable .p-column-resizer{display:block;position:absolute!important;top:0;right:0;margin:0;width:.5rem;height:100%;padding:0;cursor:col-resize;border:1px solid transparent}.p-datatable .p-column-resizer-helper{width:1px;position:absolute;z-index:10;display:none}.p-datatable .p-row-editor-init,.p-datatable .p-row-editor-save,.p-datatable .p-row-editor-cancel,.p-datatable .p-row-toggler{display:inline-flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-datatable-reorder-indicator-up,.p-datatable-reorder-indicator-down{position:absolute}.p-datatable-reorderablerow-handle,[pReorderableColumn]{cursor:move}.p-datatable .p-datatable-loading-overlay{position:absolute;display:flex;align-items:center;justify-content:center;z-index:2}.p-column-filter-row{display:flex;align-items:center;width:100%}.p-column-filter-menu{display:inline-flex}.p-column-filter-row p-columnfilterformelement{flex:1 1 auto;width:1%}.p-column-filter-menu-button,.p-column-filter-clear-button{display:inline-flex;justify-content:center;align-items:center;cursor:pointer;text-decoration:none;overflow:hidden;position:relative}.p-column-filter-overlay{position:absolute;top:0;left:0}.p-column-filter-row-items{margin:0;padding:0;list-style:none}.p-column-filter-row-item{cursor:pointer}.p-column-filter-add-button,.p-column-filter-remove-button{justify-content:center}.p-column-filter-add-button .p-button-label,.p-column-filter-remove-button .p-button-label{flex-grow:0}.p-column-filter-buttonbar{display:flex;align-items:center;justify-content:space-between}.p-column-filter-buttonbar .p-button{width:auto}.p-datatable-tbody>tr>td>.p-column-title{display:none}.p-datatable-scroller-spacer{display:flex}.p-datatable .p-scroller .p-scroller-loading{transform:none!important;min-height:0;position:sticky;top:0;left:0}\n"],encapsulation:2}),n})(),Kre=(()=>{class n{constructor(e,i,r,a){this.dt=e,this.tableService=i,this.cd=r,this.el=a,this.subscription=this.dt.tableService.valueSource$.subscribe(()=>{this.dt.virtualScroll&&this.cd.detectChanges()})}get value(){return this._value}set value(e){this._value=e,this.frozenRows&&this.updateFrozenRowStickyPosition(),this.dt.scrollable&&"subheader"===this.dt.rowGroupMode&&this.updateFrozenRowGroupHeaderStickyPosition()}ngAfterViewInit(){this.frozenRows&&this.updateFrozenRowStickyPosition(),this.dt.scrollable&&"subheader"===this.dt.rowGroupMode&&this.updateFrozenRowGroupHeaderStickyPosition()}shouldRenderRowGroupHeader(e,i,r){let a=ti.resolveFieldData(i,this.dt.groupRowsBy),g=e[r-1];return!g||a!==ti.resolveFieldData(g,this.dt.groupRowsBy)}shouldRenderRowGroupFooter(e,i,r){let a=ti.resolveFieldData(i,this.dt.groupRowsBy),g=e[r+1];return!g||a!==ti.resolveFieldData(g,this.dt.groupRowsBy)}shouldRenderRowspan(e,i,r){let a=ti.resolveFieldData(i,this.dt.groupRowsBy),g=e[r-1];return!g||a!==ti.resolveFieldData(g,this.dt.groupRowsBy)}calculateRowGroupSize(e,i,r){let a=ti.resolveFieldData(i,this.dt.groupRowsBy),g=a,E=0;for(;a===g;){E++;let O=e[++r];if(!O)break;g=ti.resolveFieldData(O,this.dt.groupRowsBy)}return 1===E?null:E}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}updateFrozenRowStickyPosition(){this.el.nativeElement.style.top=pt.getOuterHeight(this.el.nativeElement.previousElementSibling)+"px"}updateFrozenRowGroupHeaderStickyPosition(){if(this.el.nativeElement.previousElementSibling){let e=pt.getOuterHeight(this.el.nativeElement.previousElementSibling);this.dt.rowGroupHeaderStyleObject.top=e+"px"}}getScrollerOption(e,i){return this.dt.virtualScroll&&(i=i||this.scrollerOptions)?i[e]:null}getRowIndex(e){const i=this.dt.paginator?this.dt.first+e:e,r=this.getScrollerOption("getItemOptions");return r?r(i).index:i}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(yk),o.Y36(XS),o.Y36(o.sBO),o.Y36(o.SBq))},n.\u0275cmp=o.Xpm({type:n,selectors:[["","pTableBody",""]],hostAttrs:[1,"p-element"],inputs:{columns:["pTableBody","columns"],template:["pTableBodyTemplate","template"],value:"value",frozen:"frozen",frozenRows:"frozenRows",scrollerOptions:"scrollerOptions"},attrs:$ie,decls:5,vars:5,consts:[[4,"ngIf"],["ngFor","",3,"ngForOf","ngForTrackBy"],["role","row",4,"ngIf"],["role","row"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,i){1&e&&(o.YNc(0,nre,2,2,"ng-container",0),o.YNc(1,dre,2,2,"ng-container",0),o.YNc(2,_re,2,2,"ng-container",0),o.YNc(3,vre,2,5,"ng-container",0),o.YNc(4,wre,2,5,"ng-container",0)),2&e&&(o.Q6J("ngIf",!i.dt.expandedRowTemplate),o.xp6(1),o.Q6J("ngIf",i.dt.expandedRowTemplate&&!(i.frozen&&i.dt.frozenExpandedRowTemplate)),o.xp6(1),o.Q6J("ngIf",i.dt.frozenExpandedRowTemplate&&i.frozen),o.xp6(1),o.Q6J("ngIf",i.dt.loading),o.xp6(1),o.Q6J("ngIf",i.dt.isEmpty()&&!i.dt.loading))},dependencies:[Hn,Zn,Ki],encapsulation:2}),n})(),Yre=(()=>{class n{constructor(e,i){this.dt=e,this.tableService=i,this.isEnabled()&&(this.subscription=this.dt.tableService.selectionSource$.subscribe(()=>{this.selected=this.dt.isSelected(this.data)}))}ngOnInit(){this.isEnabled()&&(this.selected=this.dt.isSelected(this.data))}onClick(e){this.isEnabled()&&this.dt.handleRowClick({originalEvent:e,rowData:this.data,rowIndex:this.index})}onTouchEnd(e){this.isEnabled()&&this.dt.handleRowTouchEnd(e)}onArrowDownKeyDown(e){if(!this.isEnabled())return;const r=this.findNextSelectableRow(e.currentTarget);r&&r.focus(),e.preventDefault()}onArrowUpKeyDown(e){if(!this.isEnabled())return;const r=this.findPrevSelectableRow(e.currentTarget);r&&r.focus(),e.preventDefault()}onEnterKeyDown(e){this.isEnabled()&&this.dt.handleRowClick({originalEvent:e,rowData:this.data,rowIndex:this.index})}onPageDownKeyDown(){this.dt.virtualScroll&&this.dt.scroller.elementViewChild.nativeElement.focus()}onSpaceKeydown(){this.dt.virtualScroll&&!this.dt.editingCell&&this.dt.scroller.elementViewChild.nativeElement.focus()}findNextSelectableRow(e){let i=e.nextElementSibling;return i?pt.hasClass(i,"p-selectable-row")?i:this.findNextSelectableRow(i):null}findPrevSelectableRow(e){let i=e.previousElementSibling;return i?pt.hasClass(i,"p-selectable-row")?i:this.findPrevSelectableRow(i):null}isEnabled(){return!0!==this.pSelectableRowDisabled}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(yk),o.Y36(XS))},n.\u0275dir=o.lG2({type:n,selectors:[["","pSelectableRow",""]],hostAttrs:[1,"p-element"],hostVars:5,hostBindings:function(e,i){1&e&&o.NdJ("click",function(a){return i.onClick(a)})("touchend",function(a){return i.onTouchEnd(a)})("keydown.arrowdown",function(a){return i.onArrowDownKeyDown(a)})("keydown.arrowup",function(a){return i.onArrowUpKeyDown(a)})("keydown.enter",function(a){return i.onEnterKeyDown(a)})("keydown.shift.enter",function(a){return i.onEnterKeyDown(a)})("keydown.meta.enter",function(a){return i.onEnterKeyDown(a)})("keydown.pagedown",function(){return i.onPageDownKeyDown()})("keydown.pageup",function(){return i.onPageDownKeyDown()})("keydown.home",function(){return i.onPageDownKeyDown()})("keydown.end",function(){return i.onPageDownKeyDown()})("keydown.space",function(){return i.onSpaceKeydown()}),2&e&&(o.uIk("tabindex",i.isEnabled()?0:void 0),o.ekj("p-selectable-row",i.isEnabled())("p-highlight",i.selected))},inputs:{data:["pSelectableRow","data"],index:["pSelectableRowIndex","index"],pSelectableRowDisabled:"pSelectableRowDisabled"}}),n})(),Jre=(()=>{class n{constructor(e,i,r){this.dt=e,this.tableService=i,this.cd=r,this.subscription=this.dt.tableService.selectionSource$.subscribe(()=>{this.checked=this.dt.isSelected(this.value),this.cd.markForCheck()})}ngOnInit(){this.checked=this.dt.isSelected(this.value)}onClick(e){this.disabled||this.dt.toggleRowWithCheckbox({originalEvent:e,rowIndex:this.index},this.value),pt.clearSelection()}onFocus(){this.focused=!0}onBlur(){this.focused=!1}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(yk),o.Y36(XS),o.Y36(o.sBO))},n.\u0275cmp=o.Xpm({type:n,selectors:[["p-tableCheckbox"]],hostAttrs:[1,"p-element"],inputs:{disabled:"disabled",value:"value",index:"index",inputId:"inputId",name:"name",required:"required",ariaLabel:"ariaLabel"},decls:6,vars:19,consts:[[1,"p-checkbox","p-component",3,"ngClass","click"],[1,"p-hidden-accessible"],["type","checkbox",3,"checked","disabled","focus","blur"],["role","checkbox",3,"ngClass"],["box",""],[1,"p-checkbox-icon",3,"ngClass"]],template:function(e,i){1&e&&(o.TgZ(0,"div",0),o.NdJ("click",function(a){return i.onClick(a)}),o.TgZ(1,"div",1)(2,"input",2),o.NdJ("focus",function(){return i.onFocus()})("blur",function(){return i.onBlur()}),o.qZA()(),o.TgZ(3,"div",3,4),o._UZ(5,"span",5),o.qZA()()),2&e&&(o.Q6J("ngClass",o.WLB(10,Ere,i.focused,i.disabled)),o.xp6(2),o.Q6J("checked",i.checked)("disabled",i.disabled),o.uIk("id",i.inputId)("name",i.name)("required",i.required)("aria-label",i.ariaLabel),o.xp6(1),o.Q6J("ngClass",o.kEZ(13,Tre,i.checked,i.focused,i.disabled)),o.uIk("aria-checked",i.checked),o.xp6(2),o.Q6J("ngClass",o.VKq(17,Sre,i.checked)))},dependencies:[Pi],encapsulation:2,changeDetection:0}),n})(),a5=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr,$ne,SF,TF,Uf,dw,tie,Aee,IF,lie,fC,yf,fC]}),n})();class eI{constructor(){this.stateChanged=new o.vpe}ngOnInit(){null==this.state&&(this.state=ey.Empty)}changeState(){this.stateChanged.emit(this.state)}}eI.\u0275fac=function(t){return new(t||eI)},eI.\u0275cmp=o.Xpm({type:eI,selectors:[["home-checkbox"]],inputs:{state:"state"},outputs:{stateChanged:"stateChanged"},decls:1,vars:2,consts:[[3,"click"]],template:function(t,e){1&t&&(o.TgZ(0,"div",0),o.NdJ("click",function(){return e.changeState()}),o.qZA()),2&t&&o.Tol(e.state)},styles:["[_nghost-%COMP%]   .full[_ngcontent-%COMP%], [_nghost-%COMP%]   .partial[_ngcontent-%COMP%], [_nghost-%COMP%]   .empty[_ngcontent-%COMP%]{cursor:pointer;height:20px;width:20px;box-shadow:0 2px 4px #adb5bd3b;border-radius:50%}[_nghost-%COMP%]   .full[_ngcontent-%COMP%]{background:var(--blue-500)}[_nghost-%COMP%]   .partial[_ngcontent-%COMP%]{border-width:3px;border-color:var(--blue-500);border-style:solid}[_nghost-%COMP%]   .empty[_ngcontent-%COMP%]{border-width:3px;border-color:gray;border-style:solid}"]});const Qre=function(n){return{available:n}};class tI{constructor(){this.status=KS.Unknown}}function Xre(n,t){1&n&&(o.TgZ(0,"label"),o._uU(1,"None Selected"),o.qZA())}function eoe(n,t){if(1&n&&(o.TgZ(0,"label"),o._uU(1),o.qZA()),2&n){const e=o.oxw(2);o.xp6(1),o.hij("Selected ",e.selectedFileCount,"")}}function toe(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",12),o.NdJ("click",function(){o.CHM(e);const r=o.oxw(2);return o.KtG(r.handleDialogDisplay(!0))}),o._UZ(1,"img",13),o._uU(2,"Download Selected"),o.qZA()}}function noe(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div")(1,"home-checkbox",9),o.NdJ("stateChanged",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.handleSelectionClick(r))}),o.qZA(),o.YNc(2,Xre,2,0,"label",10),o.YNc(3,eoe,2,1,"label",10),o.YNc(4,toe,3,0,"div",11),o.qZA()}if(2&n){const e=o.oxw();o.xp6(1),o.Q6J("state",e.tableState),o.xp6(1),o.Q6J("ngIf",!e.selectedFileCount),o.xp6(1),o.Q6J("ngIf",e.selectedFileCount),o.xp6(1),o.Q6J("ngIf",e.selectedFileCount)}}function ioe(n,t){1&n&&(o.TgZ(0,"tr"),o._UZ(1,"th"),o.TgZ(2,"th"),o._uU(3,"Name"),o.qZA(),o.TgZ(4,"th"),o._uU(5,"Device"),o.qZA(),o.TgZ(6,"th"),o._uU(7,"Path"),o.qZA(),o.TgZ(8,"th"),o._uU(9,"Status"),o.qZA()())}function roe(n,t){if(1&n&&(o.TgZ(0,"tr",14)(1,"td")(2,"p-tableCheckbox",15),o.NdJ("click",function(i){return i.stopPropagation()}),o.qZA()(),o.TgZ(3,"td"),o._uU(4),o.qZA(),o.TgZ(5,"td"),o._uU(6),o.qZA(),o.TgZ(7,"td"),o._uU(8),o.qZA(),o.TgZ(9,"td"),o._UZ(10,"home-status-indicator",16),o.qZA()()),2&n){const e=t.$implicit;o.Q6J("pSelectableRow",e),o.xp6(2),o.Q6J("value",e),o.xp6(2),o.hij(" ",e.name," "),o.xp6(2),o.hij(" ",e.device," "),o.xp6(2),o.hij(" ",e.path," "),o.xp6(2),o.Q6J("status",e.status)}}function ooe(n,t){1&n&&(o.TgZ(0,"div",17),o._uU(1,"File(s) in "),o.TgZ(2,"span",18),o._uU(3,"red"),o.qZA(),o._uU(4," are not available to be downloaded."),o.qZA())}function soe(n,t){if(1&n&&(o.TgZ(0,"div",22),o._uU(1),o.qZA()),2&n){const e=o.oxw().$implicit;o.s9C("title",e.path),o.xp6(1),o.Oqu(e.path)}}function aoe(n,t){if(1&n&&(o.TgZ(0,"div",23)(1,"a"),o._uU(2),o.qZA()()),2&n){const e=o.oxw().$implicit;o.s9C("title",e.path),o.xp6(2),o.Oqu(e.path)}}tI.\u0275fac=function(t){return new(t||tI)},tI.\u0275cmp=o.Xpm({type:tI,selectors:[["home-status-indicator"]],inputs:{status:"status"},decls:4,vars:4,consts:[[1,"status-indicator"],[1,"indicator",3,"ngClass"]],template:function(t,e){1&t&&(o.TgZ(0,"div",0),o._UZ(1,"span",1),o.TgZ(2,"label"),o._uU(3),o.qZA()()),2&t&&(o.xp6(1),o.Q6J("ngClass",o.VKq(2,Qre,"available"===e.status)),o.xp6(2),o.Oqu(e.status))},dependencies:[Pi],styles:["[_nghost-%COMP%]   .status-indicator[_ngcontent-%COMP%]{text-transform:capitalize;display:flex;flex-direction:row}[_nghost-%COMP%]   .status-indicator[_ngcontent-%COMP%]   .indicator[_ngcontent-%COMP%]{min-height:20px;min-width:20px}[_nghost-%COMP%]   .status-indicator[_ngcontent-%COMP%]   .indicator.available[_ngcontent-%COMP%]{background-color:green;border-radius:50%;display:inline-block}[_nghost-%COMP%]   .status-indicator[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{padding-left:1rem}"]});const loe=function(n){return{notavailable:n}};function coe(n,t){if(1&n&&(o.ynx(0),o.TgZ(1,"div",19),o._uU(2),o.qZA(),o.YNc(3,soe,2,2,"div",20),o.YNc(4,aoe,3,2,"div",21),o.BQk()),2&n){const e=t.$implicit;o.xp6(1),o.s9C("title",e.device),o.Q6J("ngClass",o.VKq(5,loe,"available"!==e.status)),o.xp6(1),o.Oqu(e.device),o.xp6(1),o.Q6J("ngIf","available"!==e.status),o.xp6(1),o.Q6J("ngIf","available"===e.status)}}function uoe(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"p-button",24),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.handleDialogDisplay(!1))}),o.qZA()}}const hoe=function(){return{width:"50vw"}};class nI{constructor(t){this.subscriptions=[],this.fileSubscription=new Gv.w0,this.files=[],this.selectedFiles=[],this.showModal=!1,this.filesService=t}ngOnInit(){this.fileSubscription=this.filesService.getFiles().subscribe(t=>{this.files=t}),this.subscriptions.push(this.fileSubscription)}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}handleSelectionClick(t){this.selectedFiles=t===ey.Empty||t===ey.Partial?this.files:[]}handleDialogDisplay(t){this.showModal=t}get tableState(){return 0===this.selectedFiles.length?ey.Empty:this.selectedFiles.length===this.files.length?ey.Full:ey.Partial}get selectedFileCount(){return this.selectedFiles.length}get selectedUnavailableFileCount(){return this.selectedFiles.filter(t=>t.status!==KS.Available).length}}nI.\u0275fac=function(t){return new(t||nI)(o.Y36(pC))},nI.\u0275cmp=o.Xpm({type:nI,selectors:[["page-downloads"]],decls:12,vars:10,consts:[["selectionMode","multiple",3,"value","selection","selectionChange"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["header","File Downloads",3,"visible","modal","draggable","visibleChange"],["class","message",4,"ngIf"],[1,"downloads"],[4,"ngFor","ngForOf"],["pTemplate","footer"],[3,"state","stateChanged"],[4,"ngIf"],["class","download",3,"click",4,"ngIf"],[1,"download",3,"click"],["src","assets/svgs/download.svg","alt","Download selected files"],[3,"pSelectableRow"],[3,"value","click"],[3,"status"],[1,"message"],[1,"notavailable"],[3,"title","ngClass"],["class","notavailable",3,"title",4,"ngIf"],[3,"title",4,"ngIf"],[1,"notavailable",3,"title"],[3,"title"],["label","Close","styleClass","p-button-text",3,"click"]],template:function(t,e){1&t&&(o.TgZ(0,"div")(1,"h1"),o._uU(2,"File Downloads"),o.qZA(),o.TgZ(3,"p-table",0),o.NdJ("selectionChange",function(r){return e.selectedFiles=r}),o.YNc(4,noe,5,4,"ng-template",1),o.YNc(5,ioe,10,0,"ng-template",2),o.YNc(6,roe,11,6,"ng-template",3),o.qZA(),o.TgZ(7,"p-dialog",4),o.NdJ("visibleChange",function(r){return e.showModal=r}),o.YNc(8,ooe,5,0,"div",5),o.TgZ(9,"div",6),o.YNc(10,coe,5,7,"ng-container",7),o.qZA(),o.YNc(11,uoe,1,0,"ng-template",8),o.qZA()()),2&t&&(o.xp6(3),o.Q6J("value",e.files)("selection",e.selectedFiles),o.xp6(4),o.Akn(o.DdM(9,hoe)),o.Q6J("visible",e.showModal)("modal",!0)("draggable",!1),o.xp6(1),o.Q6J("ngIf",e.selectedUnavailableFileCount),o.xp6(2),o.Q6J("ngForOf",e.selectedFiles))},dependencies:[bp,sX,OX,yk,Yre,Jre,Pi,Hn,Zn,eI,tI],styles:[".p-datatable-thead{text-align:left}  .p-datatable-tbody>tr:hover{cursor:pointer;background-color:#909090!important}  .p-datatable-tbody>tr.p-highlight{background-color:#e8e8e8}[_nghost-%COMP%]{width:100%}[_nghost-%COMP%]     .p-datatable-header>div{display:flex;align-items:center}[_nghost-%COMP%]     .p-datatable-header>div>label{margin-left:1rem}[_nghost-%COMP%]     .p-datatable-header>div>div.download{display:flex;justify-content:center}[_nghost-%COMP%]     .p-datatable-header>div>div.download img{width:1rem}[_nghost-%COMP%]     .p-datatable-header>div>div{margin-left:2rem;cursor:pointer}[_nghost-%COMP%]   .message[_ngcontent-%COMP%]{font-size:small;margin-bottom:1rem}[_nghost-%COMP%]   .notavailable[_ngcontent-%COMP%]{color:red;cursor:default!important}[_nghost-%COMP%]   .downloads[_ngcontent-%COMP%]{display:grid;grid-template-columns:25% 75%;gap:5px}[_nghost-%COMP%]   .downloads[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;cursor:pointer}"]});const iI=AU({source:"Currencies",events:{"Add Currency":{_as:"props",_p:void 0},"Remove Currency":{_as:"props",_p:void 0}}}),l5=AU({source:"Cryptocurrency API",events:{"Retrieved currencies":{_as:"props",_p:void 0}}}),doe=IL("currencies"),c5=IL("portfolio");var u5=Ee(4986);function MF(){return(0,k.e)((n,t)=>{let e,i=!1;n.subscribe((0,P.x)(t,r=>{const a=e;e=r,i&&t.next([a,r]),i=!0}))})}var poe=Ee(3942);function kF(n,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new Cn("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return t}function h5(){if(typeof Uint8Array>"u")throw new Cn("unimplemented","Uint8Arrays are not available in this environment.")}function d5(){if(!function o8(){return typeof atob<"u"}())throw new Cn("unimplemented","Blobs are unavailable in Firestore in this environment.")}class rI{constructor(t){this._delegate=t}static fromBase64String(t){return d5(),new rI(Pg.fromBase64String(t))}static fromUint8Array(t){return h5(),new rI(Pg.fromUint8Array(t))}toBase64(){return d5(),this._delegate.toBase64()}toUint8Array(){return h5(),this._delegate.toUint8Array()}isEqual(t){return this._delegate.isEqual(t._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function RF(n){return function goe(n,t){if("object"!=typeof n||null===n)return!1;const e=n;for(const i of t)if(i in e&&"function"==typeof e[i])return!0;return!1}(n,["next","error","complete"])}class _oe{enableIndexedDbPersistence(t,e){return function YZ(n,t){QV(n=po(n,fa));const e=cl(n),i=n._freezeSettings(),r=new VO;return JV(e,r,new OV(r,i.cacheSizeBytes,t?.forceOwnership))}(t._delegate,{forceOwnership:e})}enableMultiTabIndexedDbPersistence(t){return function JZ(n){QV(n=po(n,fa));const t=cl(n),e=n._freezeSettings(),i=new VO;return JV(t,i,new kZ(i,e.cacheSizeBytes))}(t._delegate)}clearIndexedDbPersistence(t){return function QZ(n){if(n._initialized&&!n._terminated)throw new Cn(Wt.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new Fl;return n._queue.enqueueAndForgetEvenWhileRestricted((0,ve.Z)(function*(){try{yield(e=(0,ve.Z)(function*(i){if(!dm.C())return Promise.resolve();const r=i+"main";yield dm.delete(r)}),function(i){return e.apply(this,arguments)})(PP(n._databaseId,n._persistenceKey)),t.resolve()}catch(e){t.reject(e)}var e})),t.promise}(t._delegate)}}class p5{constructor(t,e,i){this._delegate=e,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},t instanceof Dv||(this._appCompat=t)}get _databaseId(){return this._delegate._databaseId}settings(t){const e=this._delegate._getSettings();!t.merge&&e.host!==t.host&&$_("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)}useEmulator(t,e,i={}){UV(this._delegate,t,e,i)}enableNetwork(){return function eq(n){return function BZ(n){return n.asyncQueue.enqueue((0,ve.Z)(function*(){const t=yield WV(n),e=yield KO(n);return t.setNetworkEnabled(!0),function(i){const r=Qn(i);return r._u.delete(0),_S(r)}(e)}))}(cl(n=po(n,fa)))}(this._delegate)}disableNetwork(){return function tq(n){return function VZ(n){return n.asyncQueue.enqueue((0,ve.Z)(function*(){const t=yield WV(n),e=yield KO(n);return t.setNetworkEnabled(!1),(i=(0,ve.Z)(function*(r){const a=Qn(r);a._u.add(0),yield U1(a),a.gu.set("Offline")}),function(r){return i.apply(this,arguments)})(e);var i}))}(cl(n=po(n,fa)))}(this._delegate)}enablePersistence(t){let e=!1,i=!1;return t&&(e=!!t.synchronizeTabs,i=!!t.experimentalForceOwningTab,LV("synchronizeTabs",e,"experimentalForceOwningTab",i)),e?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function XZ(n){return function(t){const e=new Fl;return t.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return function vZ(n,t){return EO.apply(this,arguments)}(yield YO(t),e)})),e.promise}(cl(n=po(n,fa)))}(this._delegate)}onSnapshotsInSync(t){return function Aq(n,t){return function jZ(n,t){const e=new TM(t);return n.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return i=yield q1(n),r=e,Qn(i).Ru.add(r),void r.next();var i,r})),()=>{e.bc(),n.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return i=yield q1(n),r=e,void Qn(i).Ru.delete(r);var i,r}))}}(cl(n=po(n,fa)),QO(t)?t:{next:t})}(this._delegate,t)}get app(){if(!this._appCompat)throw new Cn("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(t){try{return new mC(this,HO(this._delegate,t))}catch(e){throw Zh(e,"collection()","Firestore.collection()")}}doc(t){try{return new vf(this,EM(this._delegate,t))}catch(e){throw Zh(e,"doc()","Firestore.doc()")}}collectionGroup(t){try{return new qh(this,function RZ(n,t){if(n=po(n,vS),UO("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new Cn(Wt.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new ku(n,null,(e=t,new W_(mt.emptyPath(),e)));var e}(this._delegate,t))}catch(e){throw Zh(e,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(t){return function Rq(n,t,e){n=po(n,fa);const i=Object.assign(Object.assign({},Mq),e);return function(r){if(r.maxAttempts<1)throw new Cn(Wt.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(r,a,g){const E=new Fl;return r.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){const O=yield function ZV(n){return SM(n).then(t=>t.datastore)}(r);new NZ(r.asyncQueue,O,g,a,E).run()})),E.promise}(cl(n),r=>t(new kq(n,r)),i)}(this._delegate,e=>t(new f5(this,e)))}batch(){return cl(this._delegate),new m5(new _U(this._delegate,t=>Y1(this._delegate,t)))}loadBundle(t){return function nq(n,t){const e=cl(n=po(n,fa)),i=new ZZ;return function GZ(n,t,e,i){const r=function(a,g){let E;return E="string"==typeof a?(new TextEncoder).encode(a):a,O=function(O,j){if(O instanceof Uint8Array)return jV(O,j);if(O instanceof ArrayBuffer)return jV(new Uint8Array(O),j);if(O instanceof ReadableStream)return O.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(E),new PZ(O,g);var O}(e,gS(t));n.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){!function MZ(n,t,e){const i=Qn(n);var r;(r=(0,ve.Z)(function*(a,g,E){try{const O=yield g.getMetadata();if(yield function(be,Me){const Ge=Qn(be),_t=ll(Me.createTime);return Ge.persistence.runTransaction("hasNewerBundle","readonly",Dt=>Ge.Ns.getBundleMetadata(Dt,Me.id)).then(Dt=>!!Dt&&Dt.createTime.compareTo(_t)>=0)}(a.localStore,O))return yield g.close(),E._completeWith({taskState:"Success",documentsLoaded:(be=O).totalDocuments,bytesLoaded:be.totalBytes,totalDocuments:be.totalDocuments,totalBytes:be.totalBytes}),Promise.resolve(new Set);E._updateProgress(EV(O));const j=new cZ(O,a.localStore,g.yt);let Y=yield g.mc();for(;Y;){const be=yield j.Fu(Y);be&&E._updateProgress(be),Y=yield g.mc()}const se=yield j.complete();return yield K_(a,se.Lu,void 0),yield function(be,Me){const Ge=Qn(be);return Ge.persistence.runTransaction("Save bundle","readwrite",_t=>Ge.Ns.saveBundleMetadata(_t,Me))}(a.localStore,O),E._completeWith(se.progress),Promise.resolve(se.Bu)}catch(O){return $_("SyncEngine",`Loading bundle failed with ${O}`),E._failWith(O),Promise.resolve(new Set)}var be}),function(a,g,E){return r.apply(this,arguments)})(i,t,e).then(r=>{i.sharedClientState.notifyBundleLoaded(r)})}(yield YO(n),r,i)}))}(e,n._databaseId,t,i),i}(this._delegate,t)}namedQuery(t){return function iq(n,t){return function $Z(n,t){return n.asyncQueue.enqueue((0,ve.Z)(function*(){return function(e,i){const r=Qn(e);return r.persistence.runTransaction("Get named query","readonly",a=>r.Ns.getNamedQuery(a,i))}(yield IM(n),t)}))}(cl(n=po(n,fa)),t).then(e=>e?new ku(n,null,e.query):null)}(this._delegate,t).then(e=>e?new qh(this,e):null)}}class vk extends sL{constructor(t){super(),this.firestore=t}convertBytes(t){return new rI(new Pg(t))}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return vf.forKey(e,this.firestore,null)}}class f5{constructor(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new vk(t)}get(t){const e=fw(t);return this._delegate.get(e).then(i=>new oI(this._firestore,new Q_(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,e.converter)))}set(t,e,i){const r=fw(t);return i?(kF("Transaction.set",i),this._delegate.set(r,e,i)):this._delegate.set(r,e),this}update(t,e,i,...r){const a=fw(t);return 2===arguments.length?this._delegate.update(a,e):this._delegate.update(a,e,i,...r),this}delete(t){const e=fw(t);return this._delegate.delete(e),this}}class m5{constructor(t){this._delegate=t}set(t,e,i){const r=fw(t);return i?(kF("WriteBatch.set",i),this._delegate.set(r,e,i)):this._delegate.set(r,e),this}update(t,e,i,...r){const a=fw(t);return 2===arguments.length?this._delegate.update(a,e):this._delegate.update(a,e,i,...r),this}delete(t){const e=fw(t);return this._delegate.delete(e),this}commit(){return this._delegate.commit()}}class pw{constructor(t,e,i){this._firestore=t,this._userDataWriter=e,this._delegate=i}fromFirestore(t,e){const i=new ES(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new sI(this._firestore,i),e??{})}toFirestore(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)}static getInstance(t,e){const i=pw.INSTANCES;let r=i.get(t);r||(r=new WeakMap,i.set(t,r));let a=r.get(e);return a||(a=new pw(t,new vk(t),e),r.set(e,a)),a}}pw.INSTANCES=new WeakMap;class vf{constructor(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new vk(t)}static forPath(t,e,i){if(t.length%2!=0)throw new Cn("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${t.canonicalString()} has ${t.length}`);return new vf(e,new pa(e._delegate,i,new Ut(t)))}static forKey(t,e,i){return new vf(e,new pa(e._delegate,i,t))}get id(){return this._delegate.id}get parent(){return new mC(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(t){try{return new mC(this.firestore,HO(this._delegate,t))}catch(e){throw Zh(e,"collection()","DocumentReference.collection()")}}isEqual(t){return(t=(0,Be.m9)(t))instanceof pa&&HV(this._delegate,t)}set(t,e){e=kF("DocumentReference.set",e);try{return e?mU(this._delegate,t,e):mU(this._delegate,t)}catch(i){throw Zh(i,"setDoc()","DocumentReference.set()")}}update(t,e,...i){try{return 1===arguments.length?gU(this._delegate,t):gU(this._delegate,t,e,...i)}catch(r){throw Zh(r,"updateDoc()","DocumentReference.update()")}}delete(){return function Iq(n){return Y1(po(n.firestore,fa),[new P1(n._key,ba.none())])}(this._delegate)}onSnapshot(...t){const e=g5(t),i=_5(t,r=>new oI(this.firestore,new Q_(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return aL(this._delegate,e,i)}get(t){let e;return e="cache"===t?.source?function xq(n){n=po(n,pa);const t=po(n.firestore,fa),e=cl(t),i=new Vv(t);return function UZ(n,t){const e=new Fl;return n.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return(i=(0,ve.Z)(function*(r,a,g){try{const E=yield function(O,j){const Y=Qn(O);return Y.persistence.runTransaction("read document","readonly",se=>Y.localDocuments.getDocument(se,j))}(r,a);E.isFoundDocument()?g.resolve(E):E.isNoDocument()?g.resolve(null):g.reject(new Cn(Wt.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(E){const O=G1(E,`Failed to get document '${a} from cache`);g.reject(O)}}),function(r,a,g){return i.apply(this,arguments)})(yield IM(n),t,e);var i})),e.promise}(e,n._key).then(r=>new Q_(t,i,n._key,r,new ew(null!==r&&r.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===t?.source?function Cq(n){n=po(n,pa);const t=po(n.firestore,fa);return qV(cl(t),n._key,{source:"server"}).then(e=>lL(t,n,e))}(this._delegate):function wq(n){n=po(n,pa);const t=po(n.firestore,fa);return qV(cl(t),n._key).then(e=>lL(t,n,e))}(this._delegate),e.then(i=>new oI(this.firestore,new Q_(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(t){return new vf(this.firestore,this._delegate.withConverter(t?pw.getInstance(this.firestore,t):null))}}function Zh(n,t,e){return n.message=n.message.replace(t,e),n}function g5(n){for(const t of n)if("object"==typeof t&&!RF(t))return t;return{}}function _5(n,t){var e,i;let r;return r=RF(n[0])?n[0]:RF(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:a=>{r.next&&r.next(t(a))},error:null===(e=r.error)||void 0===e?void 0:e.bind(r),complete:null===(i=r.complete)||void 0===i?void 0:i.bind(r)}}class oI{constructor(t,e){this._firestore=t,this._delegate=e}get ref(){return new vf(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(t){return this._delegate.data(t)}get(t,e){return this._delegate.get(t,e)}isEqual(t){return fU(this._delegate,t._delegate)}}class sI extends oI{data(t){const e=this._delegate.data(t);return function oz(n,t){n||fi()}(void 0!==e),e}}class qh{constructor(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new vk(t)}where(t,e,i){try{return new qh(this.firestore,J_(this._delegate,aU(t,e,i)))}catch(r){throw Zh(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(t,e){try{return new qh(this.firestore,J_(this._delegate,function dq(n,t="asc"){const e=t,i=PM("orderBy",n);return oL._create(i,e)}(t,e)))}catch(i){throw Zh(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(t){try{return new qh(this.firestore,J_(this._delegate,function pq(n){return zV("limit",n),OM._create("limit",n,"F")}(t)))}catch(e){throw Zh(e,"limit()","Query.limit()")}}limitToLast(t){try{return new qh(this.firestore,J_(this._delegate,function fq(n){return zV("limitToLast",n),OM._create("limitToLast",n,"L")}(t)))}catch(e){throw Zh(e,"limitToLast()","Query.limitToLast()")}}startAt(...t){try{return new qh(this.firestore,J_(this._delegate,function mq(...n){return LM._create("startAt",n,!0)}(...t)))}catch(e){throw Zh(e,"startAt()","Query.startAt()")}}startAfter(...t){try{return new qh(this.firestore,J_(this._delegate,function gq(...n){return LM._create("startAfter",n,!1)}(...t)))}catch(e){throw Zh(e,"startAfter()","Query.startAfter()")}}endBefore(...t){try{return new qh(this.firestore,J_(this._delegate,function _q(...n){return FM._create("endBefore",n,!1)}(...t)))}catch(e){throw Zh(e,"endBefore()","Query.endBefore()")}}endAt(...t){try{return new qh(this.firestore,J_(this._delegate,function yq(...n){return FM._create("endAt",n,!0)}(...t)))}catch(e){throw Zh(e,"endAt()","Query.endAt()")}}isEqual(t){return jO(this._delegate,t._delegate)}get(t){let e;return e="cache"===t?.source?function Tq(n){n=po(n,ku);const t=po(n.firestore,fa),e=cl(t),i=new Vv(t);return function HZ(n,t){const e=new Fl;return n.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return(i=(0,ve.Z)(function*(r,a,g){try{const E=yield _M(r,a,!0),O=new IV(a,E.Hi),j=O.Wu(E.documents),Y=O.applyChanges(j,!1);g.resolve(Y.snapshot)}catch(E){const O=G1(E,`Failed to execute query '${a} against cache`);g.reject(O)}}),function(r,a,g){return i.apply(this,arguments)})(yield IM(n),t,e);var i})),e.promise}(e,n._query).then(r=>new Bv(t,i,n,r))}(this._delegate):"server"===t?.source?function Sq(n){n=po(n,ku);const t=po(n.firestore,fa),e=cl(t),i=new Vv(t);return KV(e,n._query,{source:"server"}).then(r=>new Bv(t,i,n,r))}(this._delegate):function Eq(n){n=po(n,ku);const t=po(n.firestore,fa),e=cl(t),i=new Vv(t);return sU(n._query),KV(e,n._query).then(r=>new Bv(t,i,n,r))}(this._delegate),e.then(i=>new PF(this.firestore,new Bv(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...t){const e=g5(t),i=_5(t,r=>new PF(this.firestore,new Bv(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return aL(this._delegate,e,i)}withConverter(t){return new qh(this.firestore,this._delegate.withConverter(t?pw.getInstance(this.firestore,t):null))}}class voe{constructor(t,e){this._firestore=t,this._delegate=e}get type(){return this._delegate.type}get doc(){return new sI(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class PF{constructor(t,e){this._firestore=t,this._delegate=e}get query(){return new qh(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(t=>new sI(this._firestore,t))}docChanges(t){return this._delegate.docChanges(t).map(e=>new voe(this._firestore,e))}forEach(t,e){this._delegate.forEach(i=>{t.call(e,new sI(this._firestore,i))})}isEqual(t){return fU(this._delegate,t._delegate)}}class mC extends qh{constructor(t,e){super(t,e),this.firestore=t,this._delegate=e}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const t=this._delegate.parent;return t?new vf(this.firestore,t):null}doc(t){try{return new vf(this.firestore,void 0===t?EM(this._delegate):EM(this._delegate,t))}catch(e){throw Zh(e,"doc()","CollectionReference.doc()")}}add(t){return function Dq(n,t){const e=po(n.firestore,fa),i=EM(n),r=NM(n.converter,t);return Y1(e,[MM(Qb(n.firestore),"addDoc",i._key,r,null!==n.converter,{}).toMutation(i._key,ba.exists(!1))]).then(()=>i)}(this._delegate,t).then(e=>new vf(this.firestore,e))}isEqual(t){return HV(this._delegate,t._delegate)}withConverter(t){return new mC(this.firestore,this._delegate.withConverter(t?pw.getInstance(this.firestore,t):null))}}function fw(n){return po(n,pa)}class OF{constructor(...t){this._delegate=new Y_(...t)}static documentId(){return new OF(gn.keyField().canonicalString())}isEqual(t){return(t=(0,Be.m9)(t))instanceof Y_&&this._delegate._internalPath.isEqual(t._internalPath)}}class mw{constructor(t){this._delegate=t}static serverTimestamp(){const t=function Pq(){return new XO("serverTimestamp")}();return t._methodName="FieldValue.serverTimestamp",new mw(t)}static delete(){const t=yU();return t._methodName="FieldValue.delete",new mw(t)}static arrayUnion(...t){const e=function Oq(...n){return new aq("arrayUnion",n)}(...t);return e._methodName="FieldValue.arrayUnion",new mw(e)}static arrayRemove(...t){const e=function Lq(...n){return new lq("arrayRemove",n)}(...t);return e._methodName="FieldValue.arrayRemove",new mw(e)}static increment(t){const e=function Fq(n){return new cq("increment",n)}(t);return e._methodName="FieldValue.increment",new mw(e)}isEqual(t){return this._delegate.isEqual(t._delegate)}}const boe={Firestore:p5,GeoPoint:DM,Timestamp:ge,Blob:rI,Transaction:f5,WriteBatch:m5,DocumentReference:vf,DocumentSnapshot:oI,Query:qh,QueryDocumentSnapshot:sI,QuerySnapshot:PF,CollectionReference:mC,FieldPath:OF,FieldValue:mw,setLogLevel:function yoe(n){!function rz(n){Ig.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function y5(n,t){return function Coe(n,t=u5.z){return new w.y(e=>{let i;return null!=t?t.schedule(()=>{i=n.onSnapshot({includeMetadataChanges:!0},e)}):i=n.onSnapshot({includeMetadataChanges:!0},e),()=>{i?.()}})}(n,t)}function LF(n,t){return y5(n,t).pipe((0,M.U)(e=>({payload:e,type:"query"})))}function bk(n,t){return LF(n,t).pipe(ZM(void 0),MF(),(0,M.U)(([e,i])=>{const r=i.payload.docChanges(),a=r.map(g=>({type:g.type,payload:g}));return e&&JSON.stringify(e.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((g,E)=>{const O=r.find(Y=>Y.doc.ref.isEqual(g.ref)),j=e?.payload.docs.find(Y=>Y.ref.isEqual(g.ref));O&&JSON.stringify(O.doc.metadata)===JSON.stringify(g.metadata)||!O&&j&&JSON.stringify(j.metadata)===JSON.stringify(g.metadata)||a.push({type:"modified",payload:{oldIndex:E,newIndex:E,type:"modified",doc:g}})}),a}))}function v5(n,t,e){return bk(n,e).pipe(J1((i,r)=>function Toe(n,t,e){return t.forEach(i=>{e.indexOf(i.type)>-1&&(n=function Soe(n,t){switch(t.type){case"added":if(!n[t.newIndex]||!n[t.newIndex].doc.ref.isEqual(t.doc.ref))return FF(n,t.newIndex,0,t);break;case"modified":if(null==n[t.oldIndex]||n[t.oldIndex].doc.ref.isEqual(t.doc.ref)){if(t.oldIndex!==t.newIndex){const e=n.slice();return e.splice(t.oldIndex,1),e.splice(t.newIndex,0,t),e}return FF(n,t.newIndex,1,t)}break;case"removed":if(n[t.oldIndex]&&n[t.oldIndex].doc.ref.isEqual(t.doc.ref))return FF(n,t.oldIndex,1)}return n}(n,i))}),n}(i,r.map(a=>a.payload),t),[]),DU(),(0,M.U)(i=>i.map(r=>({type:r.type,payload:r}))))}function FF(n,t,e,...i){const r=n.slice();return r.splice(t,e,...i),r}function b5(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}!function xoe(n){(function woe(n,t){n.INTERNAL.registerComponent(new He.wA("firestore-compat",e=>{const i=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(i,r)},"PUBLIC").setServiceProps(Object.assign({},boe)))})(n,(t,e)=>new p5(t,e,new _oe)),n.registerVersion("@firebase/firestore-compat","0.3.3")}(poe.Z);class w5{constructor(t,e,i){this.ref=t,this.query=e,this.afs=i}stateChanges(t){let e=bk(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe((0,M.U)(i=>i.filter(r=>t.indexOf(r.type)>-1)))),e.pipe(ZM(void 0),MF(),I(([i,r])=>r.length>0||!i),(0,M.U)(([i,r])=>r),jr.iC)}auditTrail(t){return this.stateChanges(t).pipe(J1((e,i)=>[...e,...i],[]))}snapshotChanges(t){const e=b5(t);return v5(this.query,e,this.afs.schedulers.outsideAngular).pipe(jr.iC)}valueChanges(t={}){return LF(this.query,this.afs.schedulers.outsideAngular).pipe((0,M.U)(e=>e.payload.docs.map(i=>t.idField?Object.assign(Object.assign({},i.data()),{[t.idField]:i.id}):i.data())),jr.iC)}get(t){return(0,Qr.D)(this.query.get(t)).pipe(jr.iC)}add(t){return this.ref.add(t)}doc(t){return new x5(this.ref.doc(t),this.afs)}}class x5{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const i=this.ref.collection(t),{ref:r,query:a}=C5(i,e);return new w5(r,a,this.afs)}snapshotChanges(){return function Eoe(n,t){return y5(n,t).pipe(ZM(void 0),MF(),(0,M.U)(([e,i])=>i.exists?e?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(jr.iC)}valueChanges(t={}){return this.snapshotChanges().pipe((0,M.U)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return(0,Qr.D)(this.ref.get(t)).pipe(jr.iC)}}class Ioe{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?bk(this.query,this.afs.schedulers.outsideAngular).pipe((0,M.U)(e=>e.filter(i=>t.indexOf(i.type)>-1)),I(e=>e.length>0),jr.iC):bk(this.query,this.afs.schedulers.outsideAngular).pipe(jr.iC)}auditTrail(t){return this.stateChanges(t).pipe(J1((e,i)=>[...e,...i],[]))}snapshotChanges(t){const e=b5(t);return v5(this.query,e,this.afs.schedulers.outsideAngular).pipe(jr.iC)}valueChanges(t={}){return LF(this.query,this.afs.schedulers.outsideAngular).pipe((0,M.U)(i=>i.payload.docs.map(r=>t.idField?Object.assign({[t.idField]:r.id},r.data()):r.data())),jr.iC)}get(t){return(0,Qr.D)(this.query.get(t)).pipe(jr.iC)}}const Doe=new o.OlP("angularfire2.enableFirestorePersistence"),Aoe=new o.OlP("angularfire2.firestore.persistenceSettings"),Moe=new o.OlP("angularfire2.firestore.settings"),koe=new o.OlP("angularfire2.firestore.use-emulator");function C5(n,t=(e=>e)){return{query:t(n),ref:n}}let Roe=(()=>{class n{constructor(e,i,r,a,g,E,O,j,Y,se,be,Me,Ge,_t,Dt,_n,Ln){this.schedulers=O;const Bn=(0,qc.on)(e,E,i),Un=Y;se&&GE(Bn,E,be,Ge,_t,Dt,Me,_n),[this.firestore,this.persistenceEnabled$]=(0,qc.cc)(`${Bn.name}.firestore`,"AngularFirestore",Bn.name,()=>{const ii=E.runOutsideAngular(()=>Bn.firestore());if(a&&ii.settings(a),Un&&ii.useEmulator(...Un),r&&!ml(g)){const si=()=>{try{return(0,Qr.D)(ii.enablePersistence(j||void 0).then(()=>!0,()=>!1))}catch(_r){return typeof console<"u"&&console.warn(_r),qn(!1)}};return[ii,E.runOutsideAngular(si)]}return[ii,qn(!1)]},[a,Un,r])}collection(e,i){let r;r="string"==typeof e?this.firestore.collection(e):e;const{ref:a,query:g}=C5(r,i),E=this.schedulers.ngZone.run(()=>a);return new w5(E,g,this)}collectionGroup(e,i){const r=i||(g=>g),a=this.firestore.collectionGroup(e);return new Ioe(r(a),this)}doc(e){let i;i="string"==typeof e?this.firestore.doc(e):e;const r=this.schedulers.ngZone.run(()=>i);return new x5(r,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(e){return new(e||n)(o.LFG(qc.Dh),o.LFG(qc.xv,8),o.LFG(Doe,8),o.LFG(Moe,8),o.LFG(o.Lbi),o.LFG(o.R0b),o.LFG(jr.HU),o.LFG(Aoe,8),o.LFG(koe,8),o.LFG(fb,8),o.LFG(z_,8),o.LFG(FD,8),o.LFG(HE,8),o.LFG(ND,8),o.LFG(jE,8),o.LFG(zD,8),o.LFG(UE,8))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})();class gw{constructor(t,e,i){this.http=e,this.auth=(0,tR.n)(),this.db=i,this.collectionPortfolio=Xq(t,"portfolio")}getPortfolio(){return Qq(n7(this.collectionPortfolio,r7("__name__","==",this.auth.currentUser?.uid)))}saveNewPortfolio(){this.db.collection("portfolio").doc(this.auth.currentUser?.uid).set({})}saveCryptoToPortfolio(t){this.db.collection("portfolio").doc(this.auth.currentUser?.uid).set({[t]:1},{merge:!0})}removeCryptoFromPortfolio(t){this.db.collection("portfolio").doc(this.auth.currentUser?.uid).set({[t]:e7()},{merge:!0})}getCurrency(t){return this.http.get(`https://api.coincap.io/v2/assets/${t}`).pipe((0,M.U)(e=>e.data))}getCurrencies(t=""){return this.http.get(`https://api.coincap.io/v2/assets?search=${t}&limit=2000`).pipe((0,M.U)(e=>e.data||[]))}}gw.\u0275fac=function(t){return new(t||gw)(o.LFG(zM),o.LFG(yt),o.LFG(Roe))},gw.\u0275prov=o.Yz7({token:gw,factory:gw.\u0275fac,providedIn:"root"});const Poe=["container"],Ooe=["in"],Loe=["multiIn"],Foe=["multiContainer"],Noe=["ddBtn"],zoe=["items"],Boe=["scroller"],Voe=["overlay"],Uoe=function(n,t){return{"p-autocomplete-dd-input":n,"p-disabled":t}};function Hoe(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"input",13,14),o.NdJ("click",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onInputClick(r))})("input",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onInput(r))})("keydown",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onKeydown(r))})("keyup",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onKeyup(r))})("focus",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onInputFocus(r))})("blur",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onInputBlur(r))})("change",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onInputChange(r))})("paste",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onInputPaste(r))}),o.qZA()}if(2&n){const e=o.oxw();o.Tol(e.inputStyleClass),o.Q6J("autofocus",e.autofocus)("ngStyle",e.inputStyle)("autocomplete",e.autocomplete)("ngClass",o.WLB(20,Uoe,e.dropdown,e.disabled))("value",e.inputFieldValue)("readonly",e.readonly)("disabled",e.disabled),o.uIk("type",e.type)("id",e.inputId)("required",e.required)("name",e.name)("placeholder",e.placeholder)("size",e.size)("maxlength",e.maxlength)("tabindex",e.tabindex)("aria-label",e.ariaLabel)("aria-labelledby",e.ariaLabelledBy)("aria-required",e.required)}}function joe(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"i",15),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.clear())}),o.qZA()}}function Goe(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"i",15),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.clear())}),o.qZA()}}function $oe(n,t){1&n&&o.GkF(0)}function Woe(n,t){if(1&n&&(o.TgZ(0,"span",27),o._uU(1),o.qZA()),2&n){const e=o.oxw().$implicit,i=o.oxw(2);o.xp6(1),o.Oqu(i.resolveFieldData(e))}}function Zoe(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"span",28),o.NdJ("click",function(){o.CHM(e),o.oxw();const r=o.MAs(1),a=o.oxw(2);return o.KtG(a.removeItem(r))}),o.qZA()}}const wk=function(n){return{$implicit:n}};function qoe(n,t){if(1&n&&(o.TgZ(0,"li",22,23),o.YNc(2,$oe,1,0,"ng-container",24),o.YNc(3,Woe,2,1,"span",25),o.YNc(4,Zoe,1,0,"span",26),o.qZA()),2&n){const e=t.$implicit,i=o.oxw(2);o.xp6(2),o.Q6J("ngTemplateOutlet",i.selectedItemTemplate)("ngTemplateOutletContext",o.VKq(4,wk,e)),o.xp6(1),o.Q6J("ngIf",!i.selectedItemTemplate),o.xp6(1),o.Q6J("ngIf",!i.disabled&&!i.readonly)}}const Koe=function(n,t){return{"p-disabled":n,"p-focus":t}};function Yoe(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"ul",16,17),o.NdJ("click",function(){o.CHM(e);const r=o.MAs(5);return o.KtG(r.focus())}),o.YNc(2,qoe,5,6,"li",18),o.TgZ(3,"li",19)(4,"input",20,21),o.NdJ("input",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onInput(r))})("click",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onInputClick(r))})("keydown",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onKeydown(r))})("keyup",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onKeyup(r))})("focus",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onInputFocus(r))})("blur",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onInputBlur(r))})("change",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onInputChange(r))})("paste",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onInputPaste(r))}),o.qZA()()()}if(2&n){const e=o.oxw();o.Q6J("ngClass",o.WLB(20,Koe,e.disabled,e.focus)),o.xp6(2),o.Q6J("ngForOf",e.value),o.xp6(2),o.Tol(e.inputStyleClass),o.Q6J("autofocus",e.autofocus)("disabled",e.disabled)("readonly",e.readonly)("autocomplete",e.autocomplete)("ngStyle",e.inputStyle),o.uIk("type",e.type)("id",e.inputId)("placeholder",e.value&&e.value.length?null:e.placeholder)("tabindex",e.tabindex)("maxlength",e.maxlength)("aria-label",e.ariaLabel)("aria-labelledby",e.ariaLabelledBy)("aria-required",e.required)("aria-controls",e.listId)("aria-expanded",e.overlayVisible)("aria-activedescendant","p-highlighted-option")}}function Joe(n,t){1&n&&o._UZ(0,"i",29)}function Qoe(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"button",30,31),o.NdJ("click",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.handleDropdownClick(r))}),o.qZA()}if(2&n){const e=o.oxw();o.Q6J("icon",e.dropdownIcon)("disabled",e.disabled),o.uIk("aria-label",e.dropdownAriaLabel)("tabindex",e.tabindex)}}function Xoe(n,t){1&n&&o.GkF(0)}function ese(n,t){1&n&&o.GkF(0)}const E5=function(n,t){return{$implicit:n,options:t}};function tse(n,t){if(1&n&&o.YNc(0,ese,1,0,"ng-container",24),2&n){const e=t.$implicit,i=t.options;o.oxw(2);const r=o.MAs(15);o.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",o.WLB(2,E5,e,i))}}function nse(n,t){1&n&&o.GkF(0)}const ise=function(n){return{options:n}};function rse(n,t){if(1&n&&o.YNc(0,nse,1,0,"ng-container",24),2&n){const e=t.options,i=o.oxw(3);o.Q6J("ngTemplateOutlet",i.loaderTemplate)("ngTemplateOutletContext",o.VKq(2,ise,e))}}function ose(n,t){1&n&&(o.ynx(0),o.YNc(1,rse,1,4,"ng-template",35),o.BQk())}const xk=function(n){return{height:n}};function sse(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"p-scroller",32,33),o.NdJ("onLazyLoad",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.onLazyLoad.emit(r))}),o.YNc(2,tse,1,5,"ng-template",34),o.YNc(3,ose,2,0,"ng-container",11),o.qZA()}if(2&n){const e=o.oxw();o.Akn(o.VKq(8,xk,e.scrollHeight)),o.Q6J("items",e.suggestions)("itemSize",e.virtualScrollItemSize||e._itemSize)("autoSize",!0)("lazy",e.lazy)("options",e.virtualScrollOptions),o.xp6(3),o.Q6J("ngIf",e.loaderTemplate)}}function ase(n,t){1&n&&o.GkF(0)}const lse=function(){return{}};function cse(n,t){if(1&n&&(o.ynx(0),o.YNc(1,ase,1,0,"ng-container",24),o.BQk()),2&n){const e=o.oxw(),i=o.MAs(15);o.xp6(1),o.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",o.WLB(3,E5,e.suggestions,o.DdM(2,lse)))}}function use(n,t){if(1&n&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&n){const e=o.oxw().$implicit,i=o.oxw(3);o.xp6(1),o.Oqu(i.getOptionGroupLabel(e)||"empty")}}function hse(n,t){1&n&&o.GkF(0)}function dse(n,t){1&n&&o.GkF(0)}function pse(n,t){if(1&n&&(o.TgZ(0,"li",41),o.YNc(1,use,2,1,"span",11),o.YNc(2,hse,1,0,"ng-container",24),o.qZA(),o.YNc(3,dse,1,0,"ng-container",24)),2&n){const e=t.$implicit,i=o.oxw(2).options,r=o.MAs(5),a=o.oxw();o.Q6J("ngStyle",o.VKq(6,xk,i.itemSize+"px")),o.xp6(1),o.Q6J("ngIf",!a.groupTemplate),o.xp6(1),o.Q6J("ngTemplateOutlet",a.groupTemplate)("ngTemplateOutletContext",o.VKq(8,wk,e)),o.xp6(1),o.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",o.VKq(10,wk,a.getOptionGroupChildren(e)))}}function fse(n,t){if(1&n&&(o.ynx(0),o.YNc(1,pse,4,12,"ng-template",40),o.BQk()),2&n){const e=o.oxw().$implicit;o.xp6(1),o.Q6J("ngForOf",e)}}function mse(n,t){1&n&&o.GkF(0)}function gse(n,t){if(1&n&&(o.ynx(0),o.YNc(1,mse,1,0,"ng-container",24),o.BQk()),2&n){const e=o.oxw().$implicit,i=o.MAs(5);o.xp6(1),o.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",o.VKq(2,wk,e))}}function _se(n,t){if(1&n&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&n){const e=o.oxw().$implicit,i=o.oxw(3);o.xp6(1),o.Oqu(i.resolveFieldData(e))}}function yse(n,t){1&n&&o.GkF(0)}const vse=function(n){return{"p-highlight":n}},bse=function(n,t){return{$implicit:n,index:t}};function wse(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"li",43),o.NdJ("click",function(){const a=o.CHM(e).$implicit,g=o.oxw(3);return o.KtG(g.selectItem(a))}),o.YNc(1,_se,2,1,"span",11),o.YNc(2,yse,1,0,"ng-container",24),o.qZA()}if(2&n){const e=t.$implicit,i=t.index,r=o.oxw(2).options,a=o.oxw();o.Q6J("ngStyle",o.VKq(6,xk,r.itemSize+"px"))("ngClass",o.VKq(8,vse,e===a.highlightOption))("id",a.highlightOption==e?"p-highlighted-option":""),o.xp6(1),o.Q6J("ngIf",!a.itemTemplate),o.xp6(1),o.Q6J("ngTemplateOutlet",a.itemTemplate)("ngTemplateOutletContext",o.WLB(10,bse,e,r.getOptions?r.getOptions(i):i))}}function xse(n,t){1&n&&o.YNc(0,wse,3,13,"li",42),2&n&&o.Q6J("ngForOf",t.$implicit)}function Cse(n,t){if(1&n&&(o.ynx(0),o._uU(1),o.BQk()),2&n){const e=o.oxw(3);o.xp6(1),o.hij(" ",e.emptyMessageLabel," ")}}function Ese(n,t){1&n&&o.GkF(0,null,46)}function Tse(n,t){if(1&n&&(o.TgZ(0,"li",44),o.YNc(1,Cse,2,1,"ng-container",45),o.YNc(2,Ese,2,0,"ng-container",9),o.qZA()),2&n){const e=o.oxw().options,i=o.oxw();o.Q6J("ngStyle",o.VKq(4,xk,e.itemSize+"px")),o.xp6(1),o.Q6J("ngIf",!i.emptyTemplate)("ngIfElse",i.empty),o.xp6(1),o.Q6J("ngTemplateOutlet",i.emptyTemplate)}}function Sse(n,t){if(1&n&&(o.TgZ(0,"ul",36,37),o.YNc(2,fse,2,1,"ng-container",11),o.YNc(3,gse,2,4,"ng-container",11),o.YNc(4,xse,1,1,"ng-template",null,38,o.W1O),o.YNc(6,Tse,3,6,"li",39),o.qZA()),2&n){const e=t.options,i=o.oxw();o.Akn(e.contentStyle),o.Q6J("ngClass",e.contentStyleClass),o.uIk("id",i.listId),o.xp6(2),o.Q6J("ngIf",i.group),o.xp6(1),o.Q6J("ngIf",!i.group),o.xp6(3),o.Q6J("ngIf",i.noResults&&i.showEmptyMessage)}}function Ise(n,t){1&n&&o.GkF(0)}const Dse=function(n,t){return{"p-autocomplete p-component":!0,"p-autocomplete-dd":n,"p-autocomplete-multiple":t}},Ase=function(){return["p-autocomplete-panel p-component"]},Mse={provide:xs,useExisting:(0,o.Gpc)(()=>T5),multi:!0};let T5=(()=>{class n{constructor(e,i,r,a,g,E,O){this.el=e,this.renderer=i,this.cd=r,this.differs=a,this.config=g,this.overlayService=E,this.zone=O,this.minLength=1,this.delay=300,this.scrollHeight="200px",this.lazy=!1,this.type="text",this.autoZIndex=!0,this.baseZIndex=0,this.dropdownIcon="pi pi-chevron-down",this.unique=!0,this.completeOnFocus=!1,this.showClear=!1,this.dropdownMode="blank",this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.autocomplete="off",this.completeMethod=new o.vpe,this.onSelect=new o.vpe,this.onUnselect=new o.vpe,this.onFocus=new o.vpe,this.onBlur=new o.vpe,this.onDropdownClick=new o.vpe,this.onClear=new o.vpe,this.onKeyUp=new o.vpe,this.onShow=new o.vpe,this.onHide=new o.vpe,this.onLazyLoad=new o.vpe,this.onModelChange=()=>{},this.onModelTouched=()=>{},this.overlayVisible=!1,this.focus=!1,this.inputFieldValue=null,this.inputValue=null,this.differ=a.find([]).create(null),this.listId=YS()+"_list"}get itemSize(){return this._itemSize}set itemSize(e){this._itemSize=e,console.warn("The itemSize property is deprecated, use virtualScrollItemSize property instead.")}get suggestions(){return this._suggestions}set suggestions(e){this._suggestions=e,this.handleSuggestionsChange()}ngAfterViewChecked(){this.suggestionsUpdated&&this.overlayViewChild&&this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.overlayViewChild&&this.overlayViewChild.alignOverlay()},1),this.suggestionsUpdated=!1}),this.highlightOptionChanged&&this.zone.runOutsideAngular(()=>{setTimeout(()=>{if(this.overlay&&this.itemsWrapper){let e=pt.findSingle(this.overlayViewChild.overlayViewChild.nativeElement,"li.p-highlight");e&&pt.scrollInView(this.itemsWrapper,e)}},1),this.highlightOptionChanged=!1})}handleSuggestionsChange(){null!=this._suggestions&&this.loading&&(this.highlightOption=null,this._suggestions.length?(this.noResults=!1,this.show(),this.suggestionsUpdated=!0,this.autoHighlight&&(this.highlightOption=this._suggestions[0])):(this.noResults=!0,this.showEmptyMessage?(this.show(),this.suggestionsUpdated=!0):this.hide()),this.loading=!1)}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"item":default:this.itemTemplate=e.template;break;case"group":this.groupTemplate=e.template;break;case"selectedItem":this.selectedItemTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"empty":this.emptyTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"loader":this.loaderTemplate=e.template}})}writeValue(e){this.value=e,this.filled=this.value&&""!=this.value,this.updateInputField(),this.cd.markForCheck()}getOptionGroupChildren(e){return this.optionGroupChildren?ti.resolveFieldData(e,this.optionGroupChildren):e.items}getOptionGroupLabel(e){return this.optionGroupLabel?ti.resolveFieldData(e,this.optionGroupLabel):null!=e.label?e.label:e}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}onInput(e){if(!this.inputKeyDown&&pt.isIE())return;this.timeout&&clearTimeout(this.timeout);let i=e.target.value;this.inputValue=i,!this.multiple&&!this.forceSelection&&this.onModelChange(i),0===i.length&&!this.multiple&&(this.value=null,this.hide(),this.onClear.emit(e),this.onModelChange(i)),i.length>=this.minLength?this.timeout=setTimeout(()=>{this.search(e,i)},this.delay):this.hide(),this.updateFilledState(),this.inputKeyDown=!1}onInputClick(e){this.documentClickListener&&(this.inputClick=!0)}search(e,i){null!=i&&(this.loading=!0,this.completeMethod.emit({originalEvent:e,query:i}))}selectItem(e,i=!0){this.forceSelectionUpdateModelTimeout&&(clearTimeout(this.forceSelectionUpdateModelTimeout),this.forceSelectionUpdateModelTimeout=null),this.multiple?(this.multiInputEL.nativeElement.value="",this.value=this.value||[],(!this.isSelected(e)||!this.unique)&&(this.value=[...this.value,e],this.onModelChange(this.value))):(this.inputEL.nativeElement.value=this.resolveFieldData(e),this.value=e,this.onModelChange(this.value)),this.onSelect.emit(e),this.updateFilledState(),i&&(this.itemClicked=!0,this.focusInput()),this.hide()}show(e){(this.multiInputEL||this.inputEL)&&!this.overlayVisible&&(this.multiple?this.multiInputEL.nativeElement.ownerDocument.activeElement==this.multiInputEL.nativeElement:this.inputEL.nativeElement.ownerDocument.activeElement==this.inputEL.nativeElement)&&(this.overlayVisible=!0),this.onShow.emit(e),this.cd.markForCheck()}clear(){this.multiple?this.value=null:(this.inputValue=null,this.inputEL.nativeElement.value=""),this.updateFilledState(),this.onModelChange(this.value),this.onClear.emit()}onOverlayAnimationStart(e){"visible"===e.toState&&(this.itemsWrapper=pt.findSingle(this.overlayViewChild.overlayViewChild.nativeElement,this.virtualScroll?".p-scroller":".p-autocomplete-panel"),this.virtualScroll&&this.scroller?.setContentEl(this.itemsViewChild.nativeElement))}resolveFieldData(e){let i=this.field?ti.resolveFieldData(e,this.field):e;return void 0!==i?i:""}hide(e){this.overlayVisible=!1,this.onHide.emit(e),this.cd.markForCheck()}handleDropdownClick(e){if(this.overlayVisible)this.hide();else{this.focusInput();let i=this.multiple?this.multiInputEL.nativeElement.value:this.inputEL.nativeElement.value;"blank"===this.dropdownMode?this.search(e,""):"current"===this.dropdownMode&&this.search(e,i),this.onDropdownClick.emit({originalEvent:e,query:i})}}focusInput(){this.multiple?this.multiInputEL.nativeElement.focus():this.inputEL.nativeElement.focus()}get emptyMessageLabel(){return this.emptyMessage||this.config.getTranslation(wp.EMPTY_MESSAGE)}removeItem(e){let i=pt.index(e),r=this.value[i];this.value=this.value.filter((a,g)=>g!=i),this.onModelChange(this.value),this.updateFilledState(),this.onUnselect.emit(r)}onKeydown(e){if(this.overlayVisible)switch(e.which){case 40:if(this.group){let r=this.findOptionGroupIndex(this.highlightOption,this.suggestions);if(-1!==r){let a=r.itemIndex+1;a<this.getOptionGroupChildren(this.suggestions[r.groupIndex]).length?(this.highlightOption=this.getOptionGroupChildren(this.suggestions[r.groupIndex])[a],this.highlightOptionChanged=!0):this.suggestions[r.groupIndex+1]&&(this.highlightOption=this.getOptionGroupChildren(this.suggestions[r.groupIndex+1])[0],this.highlightOptionChanged=!0)}else this.highlightOption=this.getOptionGroupChildren(this.suggestions[0])[0]}else{let r=this.findOptionIndex(this.highlightOption,this.suggestions);if(-1!=r){var i=r+1;i!=this.suggestions.length&&(this.highlightOption=this.suggestions[i],this.highlightOptionChanged=!0)}else this.highlightOption=this.suggestions[0]}e.preventDefault();break;case 38:if(this.group){let r=this.findOptionGroupIndex(this.highlightOption,this.suggestions);if(-1!==r){let a=r.itemIndex-1;if(a>=0)this.highlightOption=this.getOptionGroupChildren(this.suggestions[r.groupIndex])[a],this.highlightOptionChanged=!0;else if(a<0){let g=this.suggestions[r.groupIndex-1];g&&(this.highlightOption=this.getOptionGroupChildren(g)[this.getOptionGroupChildren(g).length-1],this.highlightOptionChanged=!0)}}}else{let r=this.findOptionIndex(this.highlightOption,this.suggestions);r>0&&(this.highlightOption=this.suggestions[r-1],this.highlightOptionChanged=!0)}e.preventDefault();break;case 13:this.highlightOption&&(this.selectItem(this.highlightOption),this.hide()),e.preventDefault();break;case 27:this.hide(),e.preventDefault();break;case 9:this.highlightOption&&this.selectItem(this.highlightOption),this.hide()}else 40===e.which&&this.suggestions?this.search(e,e.target.value):e.ctrlKey&&"z"===e.key&&!this.multiple?(this.inputEL.nativeElement.value=this.resolveFieldData(null),this.value="",this.onModelChange(this.value)):e.ctrlKey&&"z"===e.key&&this.multiple&&(this.value.pop(),this.onModelChange(this.value),this.updateFilledState());if(this.multiple&&8===e.which&&this.value&&this.value.length&&!this.multiInputEL.nativeElement.value){this.value=[...this.value];const r=this.value.pop();this.onModelChange(this.value),this.updateFilledState(),this.onUnselect.emit(r)}this.inputKeyDown=!0}onKeyup(e){this.onKeyUp.emit(e)}onInputFocus(e){!this.itemClicked&&this.completeOnFocus&&this.search(e,this.multiple?this.multiInputEL.nativeElement.value:this.inputEL.nativeElement.value),this.focus=!0,this.onFocus.emit(e),this.itemClicked=!1}onInputBlur(e){this.focus=!1,this.onModelTouched(),this.onBlur.emit(e)}onInputChange(e){if(this.forceSelection){let i=!1,r=e.target.value.trim();if(this.suggestions)for(let a of this.suggestions){let g=this.field?ti.resolveFieldData(a,this.field):a;if(g&&r===g.trim()){i=!0,this.forceSelectionUpdateModelTimeout=setTimeout(()=>{this.selectItem(a,!1)},250);break}}i||(this.multiple?this.multiInputEL.nativeElement.value="":(this.value=null,this.inputEL.nativeElement.value=""),this.onClear.emit(e),this.onModelChange(this.value),this.updateFilledState())}}onInputPaste(e){this.onKeydown(e)}isSelected(e){let i=!1;if(this.value&&this.value.length)for(let r=0;r<this.value.length;r++)if(ti.equals(this.value[r],e,this.dataKey)){i=!0;break}return i}findOptionIndex(e,i){let r=-1;if(i)for(let a=0;a<i.length;a++)if(ti.equals(e,i[a])){r=a;break}return r}findOptionGroupIndex(e,i){let r,a;if(i)for(let g=0;g<i.length&&(r=g,a=this.findOptionIndex(e,this.getOptionGroupChildren(i[g])),-1===a);g++);return-1!==a?{groupIndex:r,itemIndex:a}:-1}updateFilledState(){this.filled=this.multiple?this.value&&this.value.length||this.multiInputEL&&this.multiInputEL.nativeElement&&""!=this.multiInputEL.nativeElement.value:this.inputFieldValue&&""!=this.inputFieldValue||this.inputEL&&this.inputEL.nativeElement&&""!=this.inputEL.nativeElement.value}updateInputField(){let e=this.resolveFieldData(this.value);this.inputFieldValue=e,this.inputEL&&this.inputEL.nativeElement&&(this.inputEL.nativeElement.value=e),this.updateFilledState()}ngOnDestroy(){this.forceSelectionUpdateModelTimeout&&(clearTimeout(this.forceSelectionUpdateModelTimeout),this.forceSelectionUpdateModelTimeout=null),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null)}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(o.SBq),o.Y36(o.Qsj),o.Y36(o.sBO),o.Y36(o.ZZ4),o.Y36(lw),o.Y36(fk),o.Y36(o.R0b))},n.\u0275cmp=o.Xpm({type:n,selectors:[["p-autoComplete"]],contentQueries:function(e,i,r){if(1&e&&o.Suo(r,bp,4),2&e){let a;o.iGM(a=o.CRH())&&(i.templates=a)}},viewQuery:function(e,i){if(1&e&&(o.Gf(Poe,5),o.Gf(Ooe,5),o.Gf(Loe,5),o.Gf(Foe,5),o.Gf(Noe,5),o.Gf(zoe,5),o.Gf(Boe,5),o.Gf(Voe,5)),2&e){let r;o.iGM(r=o.CRH())&&(i.containerEL=r.first),o.iGM(r=o.CRH())&&(i.inputEL=r.first),o.iGM(r=o.CRH())&&(i.multiInputEL=r.first),o.iGM(r=o.CRH())&&(i.multiContainerEL=r.first),o.iGM(r=o.CRH())&&(i.dropdownButton=r.first),o.iGM(r=o.CRH())&&(i.itemsViewChild=r.first),o.iGM(r=o.CRH())&&(i.scroller=r.first),o.iGM(r=o.CRH())&&(i.overlayViewChild=r.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:6,hostBindings:function(e,i){2&e&&o.ekj("p-inputwrapper-filled",i.filled)("p-inputwrapper-focus",i.focus&&!i.disabled||i.autofocus||i.overlayVisible)("p-autocomplete-clearable",i.showClear&&!i.disabled)},inputs:{minLength:"minLength",delay:"delay",style:"style",panelStyle:"panelStyle",styleClass:"styleClass",panelStyleClass:"panelStyleClass",inputStyle:"inputStyle",inputId:"inputId",inputStyleClass:"inputStyleClass",placeholder:"placeholder",readonly:"readonly",disabled:"disabled",scrollHeight:"scrollHeight",lazy:"lazy",virtualScroll:"virtualScroll",virtualScrollItemSize:"virtualScrollItemSize",virtualScrollOptions:"virtualScrollOptions",maxlength:"maxlength",name:"name",required:"required",size:"size",appendTo:"appendTo",autoHighlight:"autoHighlight",forceSelection:"forceSelection",type:"type",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",ariaLabel:"ariaLabel",dropdownAriaLabel:"dropdownAriaLabel",ariaLabelledBy:"ariaLabelledBy",dropdownIcon:"dropdownIcon",unique:"unique",group:"group",completeOnFocus:"completeOnFocus",showClear:"showClear",field:"field",dropdown:"dropdown",showEmptyMessage:"showEmptyMessage",dropdownMode:"dropdownMode",multiple:"multiple",tabindex:"tabindex",dataKey:"dataKey",emptyMessage:"emptyMessage",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",autofocus:"autofocus",autocomplete:"autocomplete",optionGroupChildren:"optionGroupChildren",optionGroupLabel:"optionGroupLabel",overlayOptions:"overlayOptions",itemSize:"itemSize",suggestions:"suggestions"},outputs:{completeMethod:"completeMethod",onSelect:"onSelect",onUnselect:"onUnselect",onFocus:"onFocus",onBlur:"onBlur",onDropdownClick:"onDropdownClick",onClear:"onClear",onKeyUp:"onKeyUp",onShow:"onShow",onHide:"onHide",onLazyLoad:"onLazyLoad"},features:[o._Bn([Mse])],decls:17,vars:30,consts:[[3,"ngClass","ngStyle"],["container",""],["pAutoFocus","","class","p-autocomplete-input p-inputtext p-component","aria-autocomplete","list","role","searchbox",3,"autofocus","ngStyle","class","autocomplete","ngClass","value","readonly","disabled","click","input","keydown","keyup","focus","blur","change","paste",4,"ngIf"],["class","p-autocomplete-clear-icon pi pi-times",3,"click",4,"ngIf"],["class","p-autocomplete-multiple-container p-component p-inputtext",3,"ngClass","click",4,"ngIf"],["class","p-autocomplete-loader pi pi-spinner pi-spin",4,"ngIf"],["type","button","pButton","","class","p-autocomplete-dropdown","pRipple","",3,"icon","disabled","click",4,"ngIf"],[3,"visible","options","target","appendTo","showTransitionOptions","hideTransitionOptions","visibleChange","onAnimationStart","onShow","onHide"],["overlay",""],[4,"ngTemplateOutlet"],[3,"items","style","itemSize","autoSize","lazy","options","onLazyLoad",4,"ngIf"],[4,"ngIf"],["buildInItems",""],["pAutoFocus","","aria-autocomplete","list","role","searchbox",1,"p-autocomplete-input","p-inputtext","p-component",3,"autofocus","ngStyle","autocomplete","ngClass","value","readonly","disabled","click","input","keydown","keyup","focus","blur","change","paste"],["in",""],[1,"p-autocomplete-clear-icon","pi","pi-times",3,"click"],[1,"p-autocomplete-multiple-container","p-component","p-inputtext",3,"ngClass","click"],["multiContainer",""],["class","p-autocomplete-token",4,"ngFor","ngForOf"],[1,"p-autocomplete-input-token"],["pAutoFocus","","aria-autocomplete","list","role","searchbox","aria-haspopup","true",3,"autofocus","disabled","readonly","autocomplete","ngStyle","input","click","keydown","keyup","focus","blur","change","paste"],["multiIn",""],[1,"p-autocomplete-token"],["token",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","p-autocomplete-token-label",4,"ngIf"],["class","p-autocomplete-token-icon pi pi-times-circle",3,"click",4,"ngIf"],[1,"p-autocomplete-token-label"],[1,"p-autocomplete-token-icon","pi","pi-times-circle",3,"click"],[1,"p-autocomplete-loader","pi","pi-spinner","pi-spin"],["type","button","pButton","","pRipple","",1,"p-autocomplete-dropdown",3,"icon","disabled","click"],["ddBtn",""],[3,"items","itemSize","autoSize","lazy","options","onLazyLoad"],["scroller",""],["pTemplate","content"],["pTemplate","loader"],["role","listbox",1,"p-autocomplete-items",3,"ngClass"],["items",""],["itemslist",""],["class","p-autocomplete-empty-message",3,"ngStyle",4,"ngIf"],["ngFor","",3,"ngForOf"],[1,"p-autocomplete-item-group",3,"ngStyle"],["role","option","class","p-autocomplete-item","pRipple","",3,"ngStyle","ngClass","id","click",4,"ngFor","ngForOf"],["role","option","pRipple","",1,"p-autocomplete-item",3,"ngStyle","ngClass","id","click"],[1,"p-autocomplete-empty-message",3,"ngStyle"],[4,"ngIf","ngIfElse"],["empty",""]],template:function(e,i){1&e&&(o.TgZ(0,"span",0,1),o.YNc(2,Hoe,2,23,"input",2),o.YNc(3,joe,1,0,"i",3),o.YNc(4,Goe,1,0,"i",3),o.YNc(5,Yoe,6,23,"ul",4),o.YNc(6,Joe,1,0,"i",5),o.YNc(7,Qoe,2,4,"button",6),o.TgZ(8,"p-overlay",7,8),o.NdJ("visibleChange",function(a){return i.overlayVisible=a})("onAnimationStart",function(a){return i.onOverlayAnimationStart(a)})("onShow",function(a){return i.show(a)})("onHide",function(a){return i.hide(a)}),o.TgZ(10,"div",0),o.YNc(11,Xoe,1,0,"ng-container",9),o.YNc(12,sse,4,10,"p-scroller",10),o.YNc(13,cse,2,6,"ng-container",11),o.YNc(14,Sse,7,7,"ng-template",null,12,o.W1O),o.YNc(16,Ise,1,0,"ng-container",9),o.qZA()()()),2&e&&(o.Tol(i.styleClass),o.Q6J("ngClass",o.WLB(26,Dse,i.dropdown,i.multiple))("ngStyle",i.style),o.xp6(2),o.Q6J("ngIf",!i.multiple),o.xp6(1),o.Q6J("ngIf",!i.multiple&&i.filled&&!i.disabled&&i.showClear),o.xp6(1),o.Q6J("ngIf",i.multiple&&i.filled&&!i.disabled&&i.showClear),o.xp6(1),o.Q6J("ngIf",i.multiple),o.xp6(1),o.Q6J("ngIf",i.loading),o.xp6(1),o.Q6J("ngIf",i.dropdown),o.xp6(1),o.Q6J("visible",i.overlayVisible)("options",i.virtualScrollOptions)("target","@parent")("appendTo",i.appendTo)("showTransitionOptions",i.showTransitionOptions)("hideTransitionOptions",i.hideTransitionOptions),o.xp6(2),o.Tol(i.panelStyleClass),o.Udp("max-height",i.virtualScroll?"auto":i.scrollHeight),o.Q6J("ngClass",o.DdM(29,Ase))("ngStyle",i.panelStyle),o.xp6(1),o.Q6J("ngTemplateOutlet",i.headerTemplate),o.xp6(1),o.Q6J("ngIf",i.virtualScroll),o.xp6(1),o.Q6J("ngIf",!i.virtualScroll),o.xp6(3),o.Q6J("ngTemplateOutlet",i.footerTemplate))},dependencies:[Pi,Hn,Zn,Ki,qr,wF,bp,vF,cw,CF,q4],styles:[".p-autocomplete{display:inline-flex;position:relative}.p-autocomplete-loader{position:absolute;top:50%;margin-top:-.5rem}.p-autocomplete-dd .p-autocomplete-input{flex:1 1 auto;width:1%}.p-autocomplete-dd .p-autocomplete-input,.p-autocomplete-dd .p-autocomplete-multiple-container{border-top-right-radius:0;border-bottom-right-radius:0}.p-autocomplete-dd .p-autocomplete-dropdown{border-top-left-radius:0;border-bottom-left-radius:0}.p-autocomplete-panel{overflow:auto}.p-autocomplete-items{margin:0;padding:0;list-style-type:none}.p-autocomplete-item{cursor:pointer;white-space:nowrap;position:relative;overflow:hidden}.p-autocomplete-multiple-container{margin:0;padding:0;list-style-type:none;cursor:text;overflow:hidden;display:flex;align-items:center;flex-wrap:wrap}.p-autocomplete-token{cursor:default;display:inline-flex;align-items:center;flex:0 0 auto}.p-autocomplete-token-icon{cursor:pointer}.p-autocomplete-input-token{flex:1 1 auto;display:inline-flex}.p-autocomplete-input-token input{border:0 none;outline:0 none;background-color:transparent;margin:0;padding:0;box-shadow:none;border-radius:0;width:100%}.p-fluid .p-autocomplete{display:flex}.p-fluid .p-autocomplete-dd .p-autocomplete-input{width:1%}.p-autocomplete-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-autocomplete-clearable{position:relative}\n"],encapsulation:2,data:{animation:[l_("overlayAnimation",[Ph(":enter",[Ti({opacity:0,transform:"scaleY(0.8)"}),ih("{{showTransitionParams}}")]),Ph(":leave",[ih("{{hideTransitionParams}}",Ti({opacity:0}))])])]},changeDetection:0}),n})(),S5=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr,mk,SF,dw,yf,uw,fC,bF,mk,yf,fC,bF]}),n})();const I5=function(){return{width:"100%"}};class aI{constructor(t){this.store=t,this.currencies=[],this.add=new o.vpe,this.currencyPortfolio$=this.store.select(c5),this.subscriptions=[],this.selectedCryptosSubscription=new Gv.w0,this.cryptoIdsInPortfolio=[],this.text="",this.results=[]}ngOnInit(){this.selectedCryptosSubscription=this.currencyPortfolio$.subscribe(t=>{this.cryptoIdsInPortfolio=t.map(e=>e.id)}),this.subscriptions.push(this.selectedCryptosSubscription)}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}search(t){const e=t.query.trim().toLowerCase();this.results=this.currencies.filter(i=>(i.id.toLowerCase().indexOf(e)>-1||i.name.toLowerCase().indexOf(e)>-1||i.symbol.toLowerCase().indexOf(e)>-1)&&-1===this.cryptoIdsInPortfolio.indexOf(i.id))}addCurrency(t){this.text="",this.add.emit(t)}}function kse(n,t){1&n&&(o.TgZ(0,"label"),o._uU(1," You have no cryptocurrencies in your portfolio "),o.qZA())}function Rse(n,t){if(1&n&&(o.TgZ(0,"div"),o._uU(1),o.qZA()),2&n){const e=t.row;o.xp6(1),o.Oqu(e.id)}}function Pse(n,t){if(1&n&&(o.TgZ(0,"div"),o._uU(1),o.qZA()),2&n){const e=t.row;o.xp6(1),o.Oqu(e.name)}}function Ose(n,t){if(1&n&&(o.TgZ(0,"div"),o._uU(1),o.qZA()),2&n){const e=t.row;o.xp6(1),o.Oqu(e.symbol)}}function Lse(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",8),o.NdJ("click",function(){const a=o.CHM(e).row,g=o.oxw(2);return o.KtG(g.remove.emit(a))}),o._uU(1,"X"),o.qZA()}}function Fse(n,t){if(1&n&&(o.TgZ(0,"ngx-datatable",2)(1,"ngx-datatable-column",3),o.YNc(2,Rse,2,1,"ng-template",4),o.qZA(),o.TgZ(3,"ngx-datatable-column",5),o.YNc(4,Pse,2,1,"ng-template",4),o.qZA(),o.TgZ(5,"ngx-datatable-column",6),o.YNc(6,Ose,2,1,"ng-template",4),o.qZA(),o.TgZ(7,"ngx-datatable-column",7),o.YNc(8,Lse,2,0,"ng-template",4),o.qZA()()),2&n){const e=o.oxw();o.Q6J("rows",e.currencies)}}aI.\u0275fac=function(t){return new(t||aI)(o.Y36(Q1))},aI.\u0275cmp=o.Xpm({type:aI,selectors:[["home-crypto-selector"]],inputs:{currencies:"currencies"},outputs:{add:"add"},decls:3,vars:7,consts:[["field","name","placeholder","Search for a cryptocurrency",3,"ngModel","suggestions","inputStyle","ngModelChange","onSelect","completeMethod"]],template:function(t,e){1&t&&(o.TgZ(0,"div")(1,"div")(2,"p-autoComplete",0),o.NdJ("ngModelChange",function(r){return e.text=r})("onSelect",function(r){return e.addCurrency(r)})("completeMethod",function(r){return e.search(r)}),o.qZA()()()),2&t&&(o.xp6(2),o.Akn(o.DdM(5,I5)),o.Q6J("ngModel",e.text)("suggestions",e.results)("inputStyle",o.DdM(6,I5)))},dependencies:[T5,my,Bm],encapsulation:2});class lI{constructor(){this.currencies=[],this.remove=new o.vpe}}lI.\u0275fac=function(t){return new(t||lI)},lI.\u0275cmp=o.Xpm({type:lI,selectors:[["home-crypto-portfolio"]],inputs:{currencies:"currencies"},outputs:{remove:"remove"},decls:3,vars:2,consts:[[4,"ngIf"],["class","material light",3,"rows",4,"ngIf"],[1,"material","light",3,"rows"],["name","Id"],["ngx-datatable-cell-template",""],["name","Name"],["name","Symbol"],["name","Remove"],[2,"cursor","pointer",3,"click"]],template:function(t,e){1&t&&(o.TgZ(0,"div"),o.YNc(1,kse,2,0,"label",0),o.YNc(2,Fse,9,1,"ngx-datatable",1),o.qZA()),2&t&&(o.xp6(1),o.Q6J("ngIf",0===e.currencies.length),o.xp6(1),o.Q6J("ngIf",e.currencies.length>0))},dependencies:[Zn,aY,g6,m6],styles:['div[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol}']});var Nse=Ee(3532);let Vse=(()=>{class n{constructor(){this.strokeWidth="2",this.fill="none",this.animationDuration="2s"}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=o.Xpm({type:n,selectors:[["p-progressSpinner"]],hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",strokeWidth:"strokeWidth",fill:"fill",animationDuration:"animationDuration"},decls:3,vars:6,consts:[["role","alert","aria-busy","true",1,"p-progress-spinner",3,"ngStyle","ngClass"],["viewBox","25 25 50 50",1,"p-progress-spinner-svg"],["cx","50","cy","50","r","20","stroke-miterlimit","10",1,"p-progress-spinner-circle"]],template:function(e,i){1&e&&(o.TgZ(0,"div",0),o.O4$(),o.TgZ(1,"svg",1),o._UZ(2,"circle",2),o.qZA()()),2&e&&(o.Q6J("ngStyle",i.style)("ngClass",i.styleClass),o.xp6(1),o.Udp("animation-duration",i.animationDuration),o.xp6(1),o.uIk("fill",i.fill)("stroke-width",i.strokeWidth))},dependencies:[Pi,qr],styles:['.p-progress-spinner{position:relative;margin:0 auto;width:100px;height:100px;display:inline-block}.p-progress-spinner:before{content:"";display:block;padding-top:100%}.p-progress-spinner-svg{animation:p-progress-spinner-rotate 2s linear infinite;height:100%;transform-origin:center center;width:100%;position:absolute;inset:0;margin:auto}.p-progress-spinner-circle{stroke-dasharray:89,200;stroke-dashoffset:0;stroke:#d62d20;animation:p-progress-spinner-dash 1.5s ease-in-out infinite,p-progress-spinner-color 6s ease-in-out infinite;stroke-linecap:round}@keyframes p-progress-spinner-rotate{to{transform:rotate(360deg)}}@keyframes p-progress-spinner-dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:89,200;stroke-dashoffset:-35px}to{stroke-dasharray:89,200;stroke-dashoffset:-124px}}@keyframes p-progress-spinner-color{to,0%{stroke:#d62d20}40%{stroke:#0057e7}66%{stroke:#008744}80%,90%{stroke:#ffa700}}\n'],encapsulation:2,changeDetection:0}),n})(),D5=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[tr]}),n})();function Use(n,t){1&n&&o._UZ(0,"p-progressSpinner")}function Hse(n,t){if(1&n&&(o.TgZ(0,"td"),o._uU(1),o.ALo(2,"currency"),o.qZA()),2&n){const e=o.oxw(2);o.xp6(1),o.Oqu(o.gM2(2,1,e.randomCurrency.marketCapUsd,"USD",!0,"2.0"))}}function jse(n,t){1&n&&(o.TgZ(0,"td"),o._uU(1,"Unknown"),o.qZA())}function Gse(n,t){if(1&n&&(o.TgZ(0,"table",2)(1,"thead",3)(2,"tr")(3,"th",4),o._uU(4,"Field"),o.qZA(),o.TgZ(5,"th"),o._uU(6,"Value"),o.qZA()()(),o.TgZ(7,"tbody")(8,"tr")(9,"td"),o._uU(10,"Name"),o.qZA(),o.TgZ(11,"td"),o._uU(12),o.qZA()(),o.TgZ(13,"tr")(14,"td"),o._uU(15,"Symbol"),o.qZA(),o.TgZ(16,"td"),o._uU(17),o.qZA()(),o.TgZ(18,"tr")(19,"td"),o._uU(20,"Market Cap (USD)"),o.qZA(),o.YNc(21,Hse,3,6,"td",0),o.YNc(22,jse,2,0,"td",0),o.qZA()()()),2&n){const e=o.oxw();o.xp6(12),o.Oqu(e.randomCurrency.name),o.xp6(5),o.Oqu(e.randomCurrency.symbol),o.xp6(4),o.Q6J("ngIf",e.randomCurrency.marketCapUsd),o.xp6(1),o.Q6J("ngIf",!e.randomCurrency.marketCapUsd)}}class cI{constructor(t){this.currencyService=t,this.currencies=[],this.subscriptions=[],this.randomCryptosSubscription=new Gv.w0}ngOnInit(){this.randomCryptosSubscription=function Bse(n=0,t,e=u5.P){let i=-1;return null!=t&&((0,Nse.K)(t)?e=t:i=t),new w.y(r=>{let a=function zse(n){return n instanceof Date&&!isNaN(n)}(n)?+n-e.now():n;a<0&&(a=0);let g=0;return e.schedule(function(){r.closed||(r.next(g++),0<=i?this.schedule(void 0,i):r.complete())},a)})}(1e3,1e4).pipe((0,h.z)(()=>{if(!this.currencies.length)return qn();const t=Math.floor(Math.random()*this.currencies.length);return this.currencyService.getCurrency(this.currencies[t].id)})).subscribe(t=>this.randomCurrency=t),this.subscriptions.push(this.randomCryptosSubscription)}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}}cI.\u0275fac=function(t){return new(t||cI)(o.Y36(gw))},cI.\u0275cmp=o.Xpm({type:cI,selectors:[["home-crypto-randomizer"]],inputs:{currencies:"currencies"},decls:3,vars:2,consts:[[4,"ngIf"],["style","width: 100%;",4,"ngIf"],[2,"width","100%"],[2,"text-align","left"],[2,"width","40%"]],template:function(t,e){1&t&&(o.ynx(0),o.YNc(1,Use,1,0,"p-progressSpinner",0),o.YNc(2,Gse,23,4,"table",1),o.BQk()),2&t&&(o.xp6(1),o.Q6J("ngIf",!e.randomCurrency),o.xp6(1),o.Q6J("ngIf",e.randomCurrency))},dependencies:[Vse,Zn,kp],styles:['.p-datatable-thead{text-align:left}  .p-datatable-tbody>tr:hover{cursor:pointer;background-color:#909090!important}  .p-datatable-tbody>tr.p-highlight{background-color:#e8e8e8}[_nghost-%COMP%]{display:flex;justify-content:center;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol;font-size:1rem}']});class uI{constructor(t,e){this.store=t,this.currencyService=e,this.subscriptions=[],this.allCryptosSubscription=new Gv.w0,this.portfolioSubscription=new Gv.w0,this.currencies$=this.store.select(doe),this.currencyPortfolio$=this.store.select(c5)}ngOnInit(){this.allCryptosSubscription=this.currencyService.getCurrencies().subscribe(t=>{t=t.sort((e,i)=>e.name>i.name?1:-1),this.store.dispatch(l5.retrievedCurrencies({currencies:t}))},t=>{console.error("CryptoComponent - ngOnInit: ",t)}),this.portfolioSubscription=this.currencyService.getPortfolio().subscribe(t=>{t.length>0&&Object.keys(t[0]).forEach(e=>{this.currencyService.getCurrency(e).subscribe(i=>{this.store.dispatch(iI.addCurrency({currency:i}))})})}),this.subscriptions.push(this.allCryptosSubscription),this.subscriptions.push(this.portfolioSubscription)}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}onAdd(t){this.currencyService.saveCryptoToPortfolio(t.id),this.store.dispatch(iI.addCurrency({currency:t}))}onRemove(t){this.currencyService.removeCryptoFromPortfolio(t.id),this.store.dispatch(iI.removeCurrency({currency:t}))}}uI.\u0275fac=function(t){return new(t||uI)(o.Y36(Q1),o.Y36(gw))},uI.\u0275cmp=o.Xpm({type:uI,selectors:[["page-crypto"]],decls:19,vars:9,consts:[[1,"crypto-table"],[2,"width","20%"],[3,"currencies","add"],[2,"width","60%"],[3,"currencies","remove"],[3,"currencies"]],template:function(t,e){1&t&&(o.TgZ(0,"div")(1,"h1"),o._uU(2,"Crypto Tracker"),o.qZA(),o.TgZ(3,"div",0)(4,"div",1)(5,"label"),o._uU(6,"Available Cryptocurrencies"),o.qZA(),o.TgZ(7,"home-crypto-selector",2),o.NdJ("add",function(r){return e.onAdd(r)}),o.ALo(8,"async"),o.qZA()(),o.TgZ(9,"div",3)(10,"label"),o._uU(11,"Portfolio"),o.qZA(),o.TgZ(12,"home-crypto-portfolio",4),o.NdJ("remove",function(r){return e.onRemove(r)}),o.ALo(13,"async"),o.qZA()(),o.TgZ(14,"div",1)(15,"label"),o._uU(16,"Random Cryptocurrency"),o.qZA(),o._UZ(17,"home-crypto-randomizer",5),o.ALo(18,"async"),o.qZA()()()),2&t&&(o.xp6(7),o.Q6J("currencies",o.lcZ(8,3,e.currencies$)),o.xp6(5),o.Q6J("currencies",o.lcZ(13,5,e.currencyPortfolio$)),o.xp6(5),o.Q6J("currencies",o.lcZ(18,7,e.currencies$)))},dependencies:[aI,lI,cI,Qi],styles:[".p-datatable-thead{text-align:left}  .p-datatable-tbody>tr:hover{cursor:pointer;background-color:#909090!important}  .p-datatable-tbody>tr.p-highlight{background-color:#e8e8e8}[_nghost-%COMP%]{width:100%}[_nghost-%COMP%]   .crypto-table[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;width:100%}[_nghost-%COMP%]   .crypto-table[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{padding:1rem}[_nghost-%COMP%]   .crypto-table[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{padding-top:.25rem}[_nghost-%COMP%]   .crypto-table[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:medium}"]});const $se=function(){return[9]},Wse=function(n){return[n,30.266]};nC.workerClass=Ee(7621).Z;class hI{}hI.\u0275fac=function(t){return new(t||hI)},hI.\u0275cmp=o.Xpm({type:hI,selectors:[["home-map"]],decls:2,vars:7,consts:[[3,"zoom","center"],["mglNavigation",""]],template:function(t,e){1&t&&(o.TgZ(0,"mgl-map",0),o._UZ(1,"mgl-control",1),o.qZA()),2&t&&(o.Akn("mapbox://styles/mapbox/light-v10"),o.Q6J("zoom",o.DdM(4,$se))("center",o.VKq(5,Wse,-97.743)))},dependencies:[xY,I6,bY],styles:["mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]});const Zse=[{path:"",redirectTo:"/crypto",pathMatch:"full"},{path:"files",component:nI,pathMatch:"full"},{path:"crypto",component:uI,pathMatch:"full"},{path:"map",component:hI,pathMatch:"full"}];class gC{}gC.\u0275fac=function(t){return new(t||gC)},gC.\u0275mod=o.oAB({type:gC}),gC.\u0275inj=o.cJS({imports:[N4.forRoot(Zse,{useHash:!0}),N4]});class _C{}_C.\u0275fac=function(t){return new(t||_C)},_C.\u0275mod=o.oAB({type:_C}),_C.\u0275inj=o.cJS({imports:[S5,dw,j4,D5,a5,S5,dw,j4,D5,a5]});const qse=l6([],RL(l5.retrievedCurrencies,(n,{currencies:t})=>t)),Kse=l6([],RL(iI.removeCurrency,(n,{currency:t})=>n.filter(e=>e.id!==t.id)),RL(iI.addCurrency,(n,{currency:t})=>n.map(e=>e.id).indexOf(t.id)>-1?n:[...n,t])),Ck_firebaseConfig={apiKey:"AIzaSyAKqYEYfgbqJWGG3wxDcEdbhio3GKoP6yQ",authDomain:"homework-c5efc.firebaseapp.com",projectId:"homework-c5efc",storageBucket:"homework-c5efc.appspot.com",messagingSenderId:"1084922941630",appId:"1:1084922941630:web:de38b3ca0caa199aa5ceef",measurementId:"G-XG8VTVVQXF"},Yse=function(){return["/files"]},Jse=function(){return["/crypto"]},Qse=function(){return["/map"]};function Xse(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"div",5)(1,"div")(2,"a",6),o._uU(3,"File Downloads"),o.qZA(),o.TgZ(4,"a",6),o._uU(5,"Crypto Portfolio"),o.qZA(),o.TgZ(6,"a",6),o._uU(7,"Drone Routes"),o.qZA()(),o.TgZ(8,"div",7)(9,"h1"),o._uU(10),o.qZA()(),o.TgZ(11,"div",8)(12,"a",9),o.NdJ("click",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.angularFireAuth.signOut())}),o._uU(13,"Logout"),o.qZA()()()}if(2&n){const e=o.oxw();o.xp6(2),o.Q6J("routerLink",o.DdM(4,Yse)),o.xp6(2),o.Q6J("routerLink",o.DdM(5,Jse)),o.xp6(2),o.Q6J("routerLink",o.DdM(6,Qse)),o.xp6(4),o.Oqu(e.title)}}function eae(n,t){if(1&n&&(o.TgZ(0,"div")(1,"h1"),o._uU(2),o.qZA()()),2&n){const e=o.oxw();o.xp6(2),o.Oqu(e.title)}}function tae(n,t){1&n&&(o.TgZ(0,"div",10),o._UZ(1,"router-outlet"),o.qZA())}function nae(n,t){if(1&n){const e=o.EpF();o.TgZ(0,"firebase-ui",11),o.NdJ("signInSuccessWithAuthResult",function(){o.CHM(e);const r=o.oxw();return o.KtG(r.successLoginCallback)})("signInFailure",function(r){o.CHM(e);const a=o.oxw();return o.KtG(a.errorLoginCallback(r))}),o.qZA()}}class dI{constructor(t){this.angularFireAuth=t,this.title="Homework Web Site"}successLoginCallback(t,e){console.log(t),console.log(e)}errorLoginCallback(t){console.error(t)}}dI.\u0275fac=function(t){return new(t||dI)(o.Y36(fb))},dI.\u0275cmp=o.Xpm({type:dI,selectors:[["app-root"]],decls:9,vars:8,consts:[[1,"content"],["class","toolbar","role","banner",4,"ngIf","ngIfElse"],["loggedoutbanner",""],["style","width: 100%; height: 100%; padding: 1rem",4,"ngIf","ngIfElse"],["login",""],["role","banner",1,"toolbar"],[2,"margin-right","1rem","color","white",3,"routerLink"],[2,"text-align","center"],[2,"text-align","right"],[2,"cursor","pointer",3,"click"],[2,"width","100%","height","100%","padding","1rem"],[3,"signInSuccessWithAuthResult","signInFailure"]],template:function(t,e){if(1&t&&(o.TgZ(0,"div",0),o.YNc(1,Xse,14,7,"div",1),o.ALo(2,"async"),o.YNc(3,eae,3,1,"ng-template",null,2,o.W1O),o.YNc(5,tae,2,0,"div",3),o.ALo(6,"async"),o.YNc(7,nae,1,0,"ng-template",null,4,o.W1O),o.qZA()),2&t){const i=o.MAs(4),r=o.MAs(8);o.xp6(1),o.Q6J("ngIf",o.lcZ(2,4,e.angularFireAuth.user))("ngIfElse",i),o.xp6(4),o.Q6J("ngIf",o.lcZ(6,6,e.angularFireAuth.user))("ngIfElse",r)}},dependencies:[sF,pk,Zn,a7,Qi],styles:[".content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;height:100%;width:100%}.toolbar[_ngcontent-%COMP%]{height:60px;width:100%;background-color:#1976d2;color:#fff;font-weight:600;font-size:1rem;display:flex;align-items:center;justify-content:center;padding-left:1rem;padding-right:1rem}.toolbar[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{flex:1}"]});const iae={signInFlow:"popup",signInOptions:[{requireDisplayName:!1,provider:l7.auth.EmailAuthProvider.PROVIDER_ID}],tosUrl:"<your-tos-link>",privacyPolicyUrl:"<your-privacyPolicyUrl-link>",credentialHelper:c7.auth.CredentialHelper.NONE};class yC{}yC.\u0275fac=function(t){return new(t||yC)},yC.\u0275mod=o.oAB({type:yC,bootstrap:[dI]}),yC.\u0275inj=o.cJS({imports:[gC,_C,Uf,Ku,om,Z,lY,u9.forRoot({currencies:qse,portfolio:Kse}),qc.hO.initializeApp(Ck_firebaseConfig),$E,u7.forRoot(iae),function W(n,...t){return{ngModule:U,providers:[{provide:C,useFactory:N(n),multi:!0,deps:[o.R0b,o.zs3,jr.HU,...t]}]}}(()=>le(Ck_firebaseConfig)),function Jq(n,...t){return{ngModule:Yq,providers:[{provide:dL,useFactory:Zq(n),multi:!0,deps:[o.R0b,o.zs3,jr.HU,c,[new o.FiY,BD],[new o.FiY,UE],...t]}]}}(()=>t7()),CY.withConfig({accessToken:"pk.eyJ1IjoibWF4aW1lZ2Fsb24iLCJhIjoiY2tmNXc5bDRvMGN3NjJxcGxneXRqdWlqaCJ9.zhUGq9QLOcIXQEc-CuPIrA"})]}),If().bootstrapModule(yC).catch(n=>console.error(n))},4159:(bt,vt,Ee)=>{var pe;!function(){var o=window.CustomEvent;function ct(Ze){for(;Ze;){if("dialog"===Ze.localName)return Ze;Ze=Ze.parentElement}return null}function Ct(Ze){Ze&&Ze.blur&&Ze!==document.body&&Ze.blur()}function Ht(Ze,Je){for(var dt=0;dt<Ze.length;++dt)if(Ze[dt]===Je)return!0;return!1}function y(Ze){return!(!Ze||!Ze.hasAttribute("method"))&&"dialog"===Ze.getAttribute("method").toLowerCase()}function ze(Ze){if(this.dialog_=Ze,this.replacedStyleTop_=!1,this.openAsModal_=!1,Ze.hasAttribute("role")||Ze.setAttribute("role","dialog"),Ze.show=this.show.bind(this),Ze.showModal=this.showModal.bind(this),Ze.close=this.close.bind(this),"returnValue"in Ze||(Ze.returnValue=""),"MutationObserver"in window)new MutationObserver(this.maybeHideModal.bind(this)).observe(Ze,{attributes:!0,attributeFilter:["open"]});else{var Jt,dt=!1,Ot=function(){dt?this.downgradeModal():this.maybeHideModal(),dt=!1}.bind(this),st=function(Zt){if(Zt.target===Ze){var nn="DOMNodeRemoved";dt|=Zt.type.substr(0,nn.length)===nn,window.clearTimeout(Jt),Jt=window.setTimeout(Ot,0)}};["DOMAttrModified","DOMNodeRemoved","DOMNodeRemovedFromDocument"].forEach(function(Zt){Ze.addEventListener(Zt,st)})}Object.defineProperty(Ze,"open",{set:this.setOpen.bind(this),get:Ze.hasAttribute.bind(Ze,"open")}),this.backdrop_=document.createElement("div"),this.backdrop_.className="backdrop",this.backdrop_.addEventListener("click",this.backdropClick_.bind(this))}(!o||"object"==typeof o)&&((o=function(Je,dt){dt=dt||{};var Ot=document.createEvent("CustomEvent");return Ot.initCustomEvent(Je,!!dt.bubbles,!!dt.cancelable,dt.detail||null),Ot}).prototype=window.Event.prototype),ze.prototype={get dialog(){return this.dialog_},maybeHideModal:function(){this.dialog_.hasAttribute("open")&&document.body.contains(this.dialog_)||this.downgradeModal()},downgradeModal:function(){this.openAsModal_&&(this.openAsModal_=!1,this.dialog_.style.zIndex="",this.replacedStyleTop_&&(this.dialog_.style.top="",this.replacedStyleTop_=!1),this.backdrop_.parentNode&&this.backdrop_.parentNode.removeChild(this.backdrop_),ht.dm.removeDialog(this))},setOpen:function(Ze){Ze?this.dialog_.hasAttribute("open")||this.dialog_.setAttribute("open",""):(this.dialog_.removeAttribute("open"),this.maybeHideModal())},backdropClick_:function(Ze){if(this.dialog_.hasAttribute("tabindex"))this.dialog_.focus();else{var Je=document.createElement("div");this.dialog_.insertBefore(Je,this.dialog_.firstChild),Je.tabIndex=-1,Je.focus(),this.dialog_.removeChild(Je)}var dt=document.createEvent("MouseEvents");dt.initMouseEvent(Ze.type,Ze.bubbles,Ze.cancelable,window,Ze.detail,Ze.screenX,Ze.screenY,Ze.clientX,Ze.clientY,Ze.ctrlKey,Ze.altKey,Ze.shiftKey,Ze.metaKey,Ze.button,Ze.relatedTarget),this.dialog_.dispatchEvent(dt),Ze.stopPropagation()},focus_:function(){var Ze=this.dialog_.querySelector("[autofocus]:not([disabled])");if(!Ze&&this.dialog_.tabIndex>=0&&(Ze=this.dialog_),!Ze){var dt=["button","input","keygen","select","textarea"].map(function(Ot){return Ot+":not([disabled])"});dt.push('[tabindex]:not([disabled]):not([tabindex=""])'),Ze=this.dialog_.querySelector(dt.join(", "))}Ct(document.activeElement),Ze&&Ze.focus()},updateZIndex:function(Ze,Je){if(Ze<Je)throw new Error("dialogZ should never be < backdropZ");this.dialog_.style.zIndex=Ze,this.backdrop_.style.zIndex=Je},show:function(){this.dialog_.open||(this.setOpen(!0),this.focus_())},showModal:function(){if(this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'showModal' on dialog: The element is already open, and therefore cannot be opened modally.");if(!document.body.contains(this.dialog_))throw new Error("Failed to execute 'showModal' on dialog: The element is not in a Document.");if(!ht.dm.pushDialog(this))throw new Error("Failed to execute 'showModal' on dialog: There are too many open modal dialogs.");(function xe(Ze){for(;Ze&&Ze!==document.body;){var Je=window.getComputedStyle(Ze),dt=function(Ot,Jt){return!(void 0===Je[Ot]||Je[Ot]===Jt)};if(Je.opacity<1||dt("zIndex","auto")||dt("transform","none")||dt("mixBlendMode","normal")||dt("filter","none")||dt("perspective","none")||"isolate"===Je.isolation||"fixed"===Je.position||"touch"===Je.webkitOverflowScrolling)return!0;Ze=Ze.parentElement}return!1})(this.dialog_.parentElement)&&console.warn("A dialog is being shown inside a stacking context. This may cause it to be unusable. For more information, see this link: https://github.com/GoogleChrome/dialog-polyfill/#stacking-context"),this.setOpen(!0),this.openAsModal_=!0,ht.needsCentering(this.dialog_)?(ht.reposition(this.dialog_),this.replacedStyleTop_=!0):this.replacedStyleTop_=!1,this.dialog_.parentNode.insertBefore(this.backdrop_,this.dialog_.nextSibling),this.focus_()},close:function(Ze){if(!this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'close' on dialog: The element does not have an 'open' attribute, and therefore cannot be closed.");this.setOpen(!1),void 0!==Ze&&(this.dialog_.returnValue=Ze);var Je=new o("close",{bubbles:!1,cancelable:!1});this.dialog_.dispatchEvent(Je)}};var ht={reposition:function(Ze){var Je=document.body.scrollTop||document.documentElement.scrollTop,dt=Je+(window.innerHeight-Ze.offsetHeight)/2;Ze.style.top=Math.max(Je,dt)+"px"},isInlinePositionSetByStylesheet:function(Ze){for(var Je=0;Je<document.styleSheets.length;++Je){var dt=document.styleSheets[Je],Ot=null;try{Ot=dt.cssRules}catch{}if(Ot)for(var Jt=0;Jt<Ot.length;++Jt){var st=Ot[Jt],Zt=null;try{Zt=document.querySelectorAll(st.selectorText)}catch{}if(Zt&&Ht(Zt,Ze)){var nn=st.style.getPropertyValue("top"),yn=st.style.getPropertyValue("bottom");if(nn&&"auto"!==nn||yn&&"auto"!==yn)return!0}}}return!1},needsCentering:function(Ze){return!("absolute"!==window.getComputedStyle(Ze).position||"auto"!==Ze.style.top&&""!==Ze.style.top||"auto"!==Ze.style.bottom&&""!==Ze.style.bottom||ht.isInlinePositionSetByStylesheet(Ze))},forceRegisterDialog:function(Ze){if((window.HTMLDialogElement||Ze.showModal)&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly",Ze),"dialog"!==Ze.localName)throw new Error("Failed to register dialog: The element is not a dialog.");new ze(Ze)},registerDialog:function(Ze){Ze.showModal||ht.forceRegisterDialog(Ze)},DialogManager:function(){this.pendingDialogStack=[];var Ze=this.checkDOM_.bind(this);this.overlay=document.createElement("div"),this.overlay.className="_dialog_overlay",this.overlay.addEventListener("click",function(Je){this.forwardTab_=void 0,Je.stopPropagation(),Ze([])}.bind(this)),this.handleKey_=this.handleKey_.bind(this),this.handleFocus_=this.handleFocus_.bind(this),this.zIndexLow_=1e5,this.zIndexHigh_=100150,this.forwardTab_=void 0,"MutationObserver"in window&&(this.mo_=new MutationObserver(function(Je){var dt=[];Je.forEach(function(Ot){for(var st,Jt=0;st=Ot.removedNodes[Jt];++Jt)st instanceof Element&&("dialog"===st.localName&&dt.push(st),dt=dt.concat(st.querySelectorAll("dialog")))}),dt.length&&Ze(dt)}))}};if(ht.DialogManager.prototype.blockDocument=function(){document.documentElement.addEventListener("focus",this.handleFocus_,!0),document.addEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.observe(document,{childList:!0,subtree:!0})},ht.DialogManager.prototype.unblockDocument=function(){document.documentElement.removeEventListener("focus",this.handleFocus_,!0),document.removeEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.disconnect()},ht.DialogManager.prototype.updateStacking=function(){for(var dt,Ze=this.zIndexHigh_,Je=0;dt=this.pendingDialogStack[Je];++Je)dt.updateZIndex(--Ze,--Ze),0===Je&&(this.overlay.style.zIndex=--Ze);var Ot=this.pendingDialogStack[0];Ot?(Ot.dialog.parentNode||document.body).appendChild(this.overlay):this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)},ht.DialogManager.prototype.containedByTopDialog_=function(Ze){for(;Ze=ct(Ze);){for(var dt,Je=0;dt=this.pendingDialogStack[Je];++Je)if(dt.dialog===Ze)return 0===Je;Ze=Ze.parentElement}return!1},ht.DialogManager.prototype.handleFocus_=function(Ze){if(!this.containedByTopDialog_(Ze.target)&&(Ze.preventDefault(),Ze.stopPropagation(),Ct(Ze.target),void 0!==this.forwardTab_)){var Je=this.pendingDialogStack[0];return Je.dialog.compareDocumentPosition(Ze.target)&Node.DOCUMENT_POSITION_PRECEDING&&(this.forwardTab_?Je.focus_():document.documentElement.focus()),!1}},ht.DialogManager.prototype.handleKey_=function(Ze){if(this.forwardTab_=void 0,27===Ze.keyCode){Ze.preventDefault(),Ze.stopPropagation();var Je=new o("cancel",{bubbles:!1,cancelable:!0}),dt=this.pendingDialogStack[0];dt&&dt.dialog.dispatchEvent(Je)&&dt.dialog.close()}else 9===Ze.keyCode&&(this.forwardTab_=!Ze.shiftKey)},ht.DialogManager.prototype.checkDOM_=function(Ze){this.pendingDialogStack.slice().forEach(function(dt){-1!==Ze.indexOf(dt.dialog)?dt.downgradeModal():dt.maybeHideModal()})},ht.DialogManager.prototype.pushDialog=function(Ze){return!(this.pendingDialogStack.length>=(this.zIndexHigh_-this.zIndexLow_)/2-1||(1===this.pendingDialogStack.unshift(Ze)&&this.blockDocument(),this.updateStacking(),0))},ht.DialogManager.prototype.removeDialog=function(Ze){var Je=this.pendingDialogStack.indexOf(Ze);-1!==Je&&(this.pendingDialogStack.splice(Je,1),0===this.pendingDialogStack.length&&this.unblockDocument(),this.updateStacking())},ht.dm=new ht.DialogManager,ht.formSubmitter=null,ht.useValue=null,void 0===window.HTMLDialogElement){var qe=document.createElement("form");if(qe.setAttribute("method","dialog"),"dialog"!==qe.method){var Ne=Object.getOwnPropertyDescriptor(HTMLFormElement.prototype,"method");if(Ne){var nt=Ne.get;Ne.get=function(){return y(this)?"dialog":nt.call(this)};var fn=Ne.set;Ne.set=function(Ze){return"string"==typeof Ze&&"dialog"===Ze.toLowerCase()?this.setAttribute("method",Ze):fn.call(this,Ze)},Object.defineProperty(HTMLFormElement.prototype,"method",Ne)}}document.addEventListener("click",function(Ze){if(ht.formSubmitter=null,ht.useValue=null,!Ze.defaultPrevented){var Je=Ze.target;if(Je&&y(Je.form)){if(!("submit"===Je.type&&["button","input"].indexOf(Je.localName)>-1)){if("input"!==Je.localName||"image"!==Je.type)return;ht.useValue=Ze.offsetX+","+Ze.offsetY}ct(Je)&&(ht.formSubmitter=Je)}}},!1);var ft=HTMLFormElement.prototype.submit;HTMLFormElement.prototype.submit=function(){if(!y(this))return ft.call(this);var Ze=ct(this);Ze&&Ze.close()},document.addEventListener("submit",function(Ze){var Je=Ze.target;if(y(Je)){Ze.preventDefault();var dt=ct(Je);if(dt){var Ot=ht.formSubmitter;Ot&&Ot.form===Je?dt.close(ht.useValue||Ot.value):dt.close(),ht.formSubmitter=null}}},!0)}ht.forceRegisterDialog=ht.forceRegisterDialog,ht.registerDialog=ht.registerDialog,"amd"in Ee.amdD?void 0!==(pe=function(){return ht}.call(vt,Ee,vt,bt))&&(bt.exports=pe):"object"==typeof bt.exports?bt.exports=ht:window.dialogPolyfill=ht}()},9898:function(bt,vt,Ee){var pe=Ee(8416).default;bt.exports=function(){"use strict";var o,xe,ct;function Ct(y,ze){if(o)if(xe){var ht="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+o+")(sharedChunk); ("+xe+")(sharedChunk); self.onerror = null;",qe={};o(qe),ct=ze(qe),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(ct.workerUrl=window.URL.createObjectURL(new Blob([ht],{type:"text/javascript"})))}else xe=ze;else o=ze}return Ct(0,function(y){var ze=typeof self<"u"?self:{},ht="2.14.0";let qe;const Ne={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==qe){const l=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{qe=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):l}catch{qe=l}}return qe},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Ne.API_URL)return null;try{const l=new URL(Ne.API_URL);return"api.mapbox.cn"===l.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===l.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},nt={supported:!1,testSupport:function(l){!ln&&ft&&(Ze?Je(l):fn=l)}};let fn,ft,ln=!1,Ze=!1;function Je(l){const s=l.createTexture();l.bindTexture(l.TEXTURE_2D,s);try{if(l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,ft),l.isContextLost())return;nt.supported=!0}catch{}l.deleteTexture(s),ln=!0}ze.document&&(ft=ze.document.createElement("img"),ft.onload=function(){fn&&Je(fn),fn=null,Ze=!0},ft.onerror=function(){ln=!0,fn=null},ft.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const dt="01";var Ot=Jt;function Jt(l,s,c,f){this.cx=3*l,this.bx=3*(c-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(f-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=s,this.p2x=c,this.p2y=f}Jt.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,s){if(void 0===s&&(s=1e-6),l<0)return 0;if(l>1)return 1;for(var c=l,f=0;f<8;f++){var v=this.sampleCurveX(c)-l;if(Math.abs(v)<s)return c;var C=this.sampleCurveDerivativeX(c);if(Math.abs(C)<1e-6)break;c-=v/C}var S=0,R=1;for(c=l,f=0;f<20&&(v=this.sampleCurveX(c),!(Math.abs(v-l)<s));f++)l>v?S=c:R=c,c=.5*(R-S)+S;return c},solve:function(l,s){return this.sampleCurveY(this.solveCurveX(l,s))}};var st=Zt;function Zt(l,s){this.x=l,this.y=s}Zt.prototype={clone:function(){return new Zt(this.x,this.y)},add:function(l){return this.clone()._add(l)},sub:function(l){return this.clone()._sub(l)},multByPoint:function(l){return this.clone()._multByPoint(l)},divByPoint:function(l){return this.clone()._divByPoint(l)},mult:function(l){return this.clone()._mult(l)},div:function(l){return this.clone()._div(l)},rotate:function(l){return this.clone()._rotate(l)},rotateAround:function(l,s){return this.clone()._rotateAround(l,s)},matMult:function(l){return this.clone()._matMult(l)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(l){return this.x===l.x&&this.y===l.y},dist:function(l){return Math.sqrt(this.distSqr(l))},distSqr:function(l){var s=l.x-this.x,c=l.y-this.y;return s*s+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith:function(l){return this.angleWithSep(l.x,l.y)},angleWithSep:function(l,s){return Math.atan2(this.x*s-this.y*l,this.x*l+this.y*s)},_matMult:function(l){var s=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=s,this},_add:function(l){return this.x+=l.x,this.y+=l.y,this},_sub:function(l){return this.x-=l.x,this.y-=l.y,this},_mult:function(l){return this.x*=l,this.y*=l,this},_div:function(l){return this.x/=l,this.y/=l,this},_multByPoint:function(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint:function(l){return this.x/=l.x,this.y/=l.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var l=this.y;return this.y=this.x,this.x=-l,this},_rotate:function(l){var s=Math.cos(l),c=Math.sin(l),f=c*this.x+s*this.y;return this.x=s*this.x-c*this.y,this.y=f,this},_rotateAround:function(l,s){var c=Math.cos(l),f=Math.sin(l),v=s.y+f*(this.x-s.x)+c*(this.y-s.y);return this.x=s.x+c*(this.x-s.x)-f*(this.y-s.y),this.y=v,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Zt.convert=function(l){return l instanceof Zt?l:Array.isArray(l)?new Zt(l[0],l[1]):l};const nn=Math.PI/180,yn=180/Math.PI;function it(l){return l*nn}function zt(l){return l*yn}const en=[[0,0],[1,0],[1,1],[0,1]];function gt(l){if(l<=0)return 0;if(l>=1)return 1;const s=l*l,c=s*l;return 4*(l<.5?c:3*(l-s)+c-.75)}function xt(l,s,c,f){const v=new Ot(l,s,c,f);return function(C){return v.solve(C)}}const Lt=xt(.25,.1,.25,1);function It(l,s,c){return Math.min(c,Math.max(s,l))}function Vt(l,s,c){return(c=It((c-l)/(s-l),0,1))*c*(3-2*c)}function wn(l,s,c){const f=c-s,v=((l-s)%f+f)%f+s;return v===s?c:v}function ai(l,s,c){if(!l.length)return c(null,[]);let f=l.length;const v=new Array(l.length);let C=null;l.forEach((S,R)=>{s(S,(N,U)=>{N&&(C=N),v[R]=U,0==--f&&c(C,v)})})}function ir(l){const s=[];for(const c in l)s.push(l[c]);return s}function Ni(l,...s){for(const c of s)for(const f in c)l[f]=c[f];return l}let vi=1;function zi(){return vi++}function ri(){return function l(s){return s?(s^Math.random()*(16>>s/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,l)}()}function or(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function Bo(l){return!!l&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(l)}function $i(l,s){l.forEach(c=>{s[c]&&(s[c]=s[c].bind(s))})}function bi(l,s){return-1!==l.indexOf(s,l.length-s.length)}function Gr(l,s,c){const f={};for(const v in l)f[v]=s.call(c||this,l[v],v,l);return f}function Vo(l,s,c){const f={};for(const v in l)s.call(c||this,l[v],v,l)&&(f[v]=l[v]);return f}function $r(l){return Array.isArray(l)?l.map($r):"object"==typeof l&&l?Gr(l,$r):l}const fo={};function Ar(l){fo[l]||(typeof console<"u"&&console.warn(l),fo[l]=!0)}function ys(l,s,c){return(c.y-l.y)*(s.x-l.x)>(s.y-l.y)*(c.x-l.x)}function qi(l){let s=0;for(let c,f,v=0,C=l.length,S=C-1;v<C;S=v++)c=l[v],f=l[S],s+=(f.x-c.x)*(c.y+f.y);return s}function Rr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Xo(l){const s={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,f,v,C)=>{const S=v||C;return s[f]=!S||S.toLowerCase(),""}),s["max-age"]){const c=parseInt(s["max-age"],10);isNaN(c)?delete s["max-age"]:s["max-age"]=c}return s}let Gs=null;function Ao(l){if(null==Gs){const s=l.navigator?l.navigator.userAgent:null;Gs=!!l.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return Gs}function Pr(l){try{const s=ze[l];return s.setItem("_mapbox_test_",1),s.removeItem("_mapbox_test_"),!0}catch{return!1}}function jn(l,s){return[l[4*s],l[4*s+1],l[4*s+2],l[4*s+3]]}const Uo="mapbox-tiles";let lo,Wr,es=500,Mo=50;function wr(){try{return ze.caches}catch{}}function yr(){wr()&&!lo&&(lo=ze.caches.open(Uo))}function ui(l){const s=l.indexOf("?");if(s<0)return l;const f=function(v){const C=v.indexOf("?");return C>0?v.slice(C+1).split("&"):[]}(l).filter(v=>{const C=v.split("=");return"language"===C[0]||"worldview"===C[0]});return f.length?`${l.slice(0,s)}?${f.join("&")}`:l.slice(0,s)}let Wn=1/0;const ts={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(ts);class Ur extends Error{constructor(s,c,f){401===c&&zn(f)&&(s+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(s),this.status=c,this.url=f}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Ho=Rr()?()=>self.worker&&self.worker.referrer:()=>("blob:"===ze.location.protocol?ze.parent:ze).location.href,vs=function(l,s){if(!(/^file:/.test(c=l.url)||/^file:/.test(Ho())&&!/^\w+:/.test(c))){if(ze.fetch&&ze.Request&&ze.AbortController&&ze.Request.prototype.hasOwnProperty("signal"))return function(f,v){const C=new ze.AbortController,S=new ze.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:Ho(),referrerPolicy:f.referrerPolicy,signal:C.signal});let R=!1,N=!1;const U=(W=S.url).indexOf("sku=")>0&&zn(W);var W;"json"===f.type&&S.headers.set("Accept","application/json");const Q=(oe,le,he)=>{if(N)return;if(oe&&"SecurityError"!==oe.message&&Ar(oe),le&&he)return ee(le);const Ie=Date.now();ze.fetch(S).then(Le=>{if(Le.ok){const ve=U?Le.clone():null;return ee(Le,ve,Ie)}return v(new Ur(Le.statusText,Le.status,f.url))}).catch(Le=>{"AbortError"!==Le.name&&v(new Error(`${Le.message} ${f.url}`))})},ee=(oe,le,he)=>{("arrayBuffer"===f.type?oe.arrayBuffer():"json"===f.type?oe.json():oe.text()).then(Ie=>{N||(le&&he&&function(Le,ve,Pe){if(yr(),!lo)return;const He={status:ve.status,statusText:ve.statusText,headers:new ze.Headers};ve.headers.forEach((kt,St)=>He.headers.set(St,kt));const Be=Xo(ve.headers.get("Cache-Control")||"");if(Be["no-store"])return;Be["max-age"]&&He.headers.set("Expires",new Date(Pe+1e3*Be["max-age"]).toUTCString());const $e=He.headers.get("Expires");$e&&(new Date($e).getTime()-Pe<42e4||function(kt,St){if(void 0===Wr)try{new Response(new ReadableStream),Wr=!0}catch{Wr=!1}Wr?St(kt.body):kt.blob().then(St)}(ve,kt=>{const St=new ze.Response(kt,He);yr(),lo&&lo.then(Gt=>Gt.put(ui(Le.url),St)).catch(Gt=>Ar(Gt.message))}))}(S,le,he),R=!0,v(null,Ie,oe.headers.get("Cache-Control"),oe.headers.get("Expires")))}).catch(Ie=>{N||v(new Error(Ie.message))})};return U?function(oe,le){if(yr(),!lo)return le(null);const he=ui(oe.url);lo.then(Ie=>{Ie.match(he).then(Le=>{const ve=function(Pe){if(!Pe)return!1;const He=new Date(Pe.headers.get("Expires")||0),Be=Xo(Pe.headers.get("Cache-Control")||"");return He>Date.now()&&!Be["no-cache"]}(Le);Ie.delete(he),ve&&Ie.put(he,Le.clone()),le(null,Le,ve)}).catch(le)}).catch(le)}(S,Q):Q(null,null),{cancel:()=>{N=!0,R||C.abort()}}}(l,s);if(Rr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",l,s,void 0,!0)}var c;return function(f,v){const C=new ze.XMLHttpRequest;C.open(f.method||"GET",f.url,!0),"arrayBuffer"===f.type&&(C.responseType="arraybuffer");for(const S in f.headers)C.setRequestHeader(S,f.headers[S]);return"json"===f.type&&(C.responseType="text",C.setRequestHeader("Accept","application/json")),C.withCredentials="include"===f.credentials,C.onerror=()=>{v(new Error(C.statusText))},C.onload=()=>{if((C.status>=200&&C.status<300||0===C.status)&&null!==C.response){let S=C.response;if("json"===f.type)try{S=JSON.parse(C.response)}catch(R){return v(R)}v(null,S,C.getResponseHeader("Cache-Control"),C.getResponseHeader("Expires"))}else v(new Ur(C.statusText,C.status,f.url))},C.send(f.body),{cancel:()=>C.abort()}}(l,s)},Jr=function(l,s){return vs(Ni(l,{type:"arrayBuffer"}),s)};function co(l){const s=ze.document.createElement("a");return s.href=l,s.protocol===ze.document.location.protocol&&s.host===ze.document.location.host}const mr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let cs,Bi;cs=[],Bi=0;const qo=function(l,s){if(nt.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*"),Bi>=Ne.MAX_PARALLEL_IMAGE_REQUESTS){const C={requestParameters:l,callback:s,cancelled:!1,cancel(){this.cancelled=!0}};return cs.push(C),C}Bi++;let c=!1;const f=()=>{if(!c)for(c=!0,Bi--;cs.length&&Bi<Ne.MAX_PARALLEL_IMAGE_REQUESTS;){const C=cs.shift(),{requestParameters:S,callback:R,cancelled:N}=C;N||(C.cancel=qo(S,R).cancel)}},v=Jr(l,(C,S,R,N)=>{f(),C?s(C):S&&(ze.createImageBitmap?function(U,W){const Q=new ze.Blob([new Uint8Array(U)],{type:"image/png"});ze.createImageBitmap(Q).then(ee=>{W(null,ee)}).catch(ee=>{W(new Error(`Could not load image because of ${ee.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(S,(U,W)=>s(U,W,R,N)):function(U,W){const Q=new ze.Image,ee=ze.URL;Q.onload=()=>{W(null,Q),ee.revokeObjectURL(Q.src),Q.onload=null,ze.requestAnimationFrame(()=>{Q.src=mr})},Q.onerror=()=>W(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const oe=new ze.Blob([new Uint8Array(U)],{type:"image/png"});Q.src=U.byteLength?ee.createObjectURL(oe):mr}(S,(U,W)=>s(U,W,R,N)))});return{cancel:()=>{v.cancel(),f()}}},En="NO_ACCESS_TOKEN";function rn(l){return 0===l.indexOf("mapbox:")}function zn(l){return Ne.API_URL_REGEX.test(l)}function wi(l){return Ne.API_CDN_URL_REGEX.test(l)}function Di(l){return Ne.API_STYLE_REGEX.test(l)&&!er(l)}function er(l){return Ne.API_SPRITE_REGEX.test(l)}const Qe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function je(l){const s=l.match(Qe);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function at(l){const s=l.params.length?`?${l.params.join("&")}`:"";return`${l.protocol}://${l.authority}${l.path}${s}`}function Ue(l){if(!l)return null;const s=l.split(".");if(!s||3!==s.length)return null;try{return JSON.parse(decodeURIComponent(ze.atob(s[1]).split("").map(c=>"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Ce{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const c=Ue(Ne.ACCESS_TOKEN);let f="";return f=c&&c.u?ze.btoa(encodeURIComponent(c.u).replace(/%([0-9A-F]{2})/g,(v,C)=>String.fromCharCode(Number("0x"+C)))):Ne.ACCESS_TOKEN||"",s?`mapbox.eventData.${s}:${f}`:`mapbox.eventData:${f}`}fetchEventData(){const s=Pr("localStorage"),c=this.getStorageKey(),f=this.getStorageKey("uuid");if(s)try{const v=ze.localStorage.getItem(c);v&&(this.eventData=JSON.parse(v));const C=ze.localStorage.getItem(f);C&&(this.anonId=C)}catch{Ar("Unable to read from LocalStorage")}}saveEventData(){const s=Pr("localStorage"),c=this.getStorageKey(),f=this.getStorageKey("uuid");if(s)try{ze.localStorage.setItem(f,this.anonId),Object.keys(this.eventData).length>=1&&ze.localStorage.setItem(c,JSON.stringify(this.eventData))}catch{Ar("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,c,f,v){if(!Ne.EVENTS_URL)return;const C=je(Ne.EVENTS_URL);C.params.push(`access_token=${v||Ne.ACCESS_TOKEN||""}`);const S={event:this.type,created:new Date(s).toISOString()},R=c?Ni(S,c):S,N={url:at(C),headers:{"Content-Type":"text/plain"},body:JSON.stringify([R])};var W;this.pendingRequest=(W=U=>{this.pendingRequest=null,f(U),this.saveEventData(),this.processRequests(v)},vs(Ni(N,{method:"POST"}),W))}queueRequest(s,c){this.queue.push(s),this.processRequests(c)}}const re=new class extends Ce{constructor(l){super("appUserTurnstile"),this._customAccessToken=l}postTurnstileEvent(l,s){Ne.EVENTS_URL&&Ne.ACCESS_TOKEN&&Array.isArray(l)&&l.some(c=>rn(c)||zn(c))&&this.queueRequest(Date.now(),s)}processRequests(l){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=Ue(Ne.ACCESS_TOKEN),c=s?s.u:Ne.ACCESS_TOKEN;let f=c!==this.eventData.tokenU;Bo(this.anonId)||(this.anonId=ri(),f=!0);const v=this.queue.shift();if(this.eventData.lastSuccess){const C=new Date(this.eventData.lastSuccess),S=new Date(v),R=(v-this.eventData.lastSuccess)/864e5;f=f||R>=1||R<-1||C.getDate()!==S.getDate()}else f=!0;f?this.postEvent(v,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ht,skuId:dt,"enabled.telemetry":!1,userId:this.anonId},C=>{C||(this.eventData.lastSuccess=v,this.eventData.tokenU=c)},l):this.processRequests()}},ie=re.postTurnstileEvent.bind(re),ae=new class extends Ce{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(l,s,c,f){this.skuToken=s,this.errorCb=f,Ne.EVENTS_URL&&(c||Ne.ACCESS_TOKEN?this.queueRequest({id:l,timestamp:Date.now()},c):this.errorCb(new Error(En)))}processRequests(l){if(this.pendingRequest||0===this.queue.length)return;const{id:s,timestamp:c}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),Bo(this.anonId)||(this.anonId=ri()),this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ht,skuId:dt,skuToken:this.skuToken,userId:this.anonId},f=>{f?this.errorCb(f):s&&(this.success[s]=!0)},l))}},we=ae.postMapLoadEvent.bind(ae),De=new class extends Ce{constructor(){super("gljs.performance")}postPerformanceEvent(l,s){Ne.EVENTS_URL&&(l||Ne.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},l)}processRequests(l){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:s,performanceData:c}=this.queue.shift(),f=function(v){const C=ze.performance.getEntriesByType("resource"),S=ze.performance.getEntriesByType("mark"),R=function(ee){const oe={};if(ee)for(const le in ee)if("other"!==le)for(const he of ee[le]){const Ie=`${le}ResolveRangeMin`,Le=`${le}ResolveRangeMax`,ve=`${le}RequestCount`,Pe=`${le}RequestCachedCount`;oe[Ie]=Math.min(oe[Ie]||1/0,he.startTime),oe[Le]=Math.max(oe[Le]||-1/0,he.responseEnd);const He=Be=>{void 0===oe[Be]&&(oe[Be]=0),++oe[Be]};void 0!==he.transferSize&&0===he.transferSize&&He(Pe),He(ve)}return oe}(function(ee,oe){const le={};if(ee)for(const he of ee){const Ie=oe(he);void 0===le[Ie]&&(le[Ie]=[]),le[Ie].push(he)}return le}(C,Dn)),N=ze.devicePixelRatio,U=ze.navigator.connection||ze.navigator.mozConnection||ze.navigator.webkitConnection,W={counters:[],metadata:[],attributes:[]},Q=(ee,oe,le)=>{null!=le&&ee.push({name:oe,value:le.toString()})};for(const ee in R)Q(W.counters,ee,R[ee]);if(v.interactionRange[0]!==1/0&&v.interactionRange[1]!==-1/0&&(Q(W.counters,"interactionRangeMin",v.interactionRange[0]),Q(W.counters,"interactionRangeMax",v.interactionRange[1])),S)for(const ee of Object.keys(rt)){const oe=rt[ee],le=S.find(he=>he.name===oe);le&&Q(W.counters,oe,le.startTime)}return Q(W.counters,"visibilityHidden",v.visibilityHidden),Q(W.attributes,"style",function(ee){if(ee)for(const oe of ee){const le=oe.name.split("?")[0];if(Di(le)){const he=le.split("/").slice(-2);if(2===he.length)return`mapbox://styles/${he[0]}/${he[1]}`}}}(C)),Q(W.attributes,"terrainEnabled",v.terrainEnabled?"true":"false"),Q(W.attributes,"fogEnabled",v.fogEnabled?"true":"false"),Q(W.attributes,"projection",v.projection),Q(W.attributes,"zoom",v.zoom),Q(W.metadata,"devicePixelRatio",N),Q(W.metadata,"connectionEffectiveType",U?U.effectiveType:void 0),Q(W.metadata,"navigatorUserAgent",ze.navigator.userAgent),Q(W.metadata,"screenWidth",ze.screen.width),Q(W.metadata,"screenHeight",ze.screen.height),Q(W.metadata,"windowWidth",ze.innerWidth),Q(W.metadata,"windowHeight",ze.innerHeight),Q(W.metadata,"mapWidth",v.width/N),Q(W.metadata,"mapHeight",v.height/N),Q(W.metadata,"webglRenderer",v.renderer),Q(W.metadata,"webglVendor",v.vendor),Q(W.metadata,"sdkVersion",ht),Q(W.metadata,"sdkIdentifier","mapbox-gl-js"),W}(c);for(const v of f.metadata);for(const v of f.counters);for(const v of f.attributes);this.postEvent(s,f,()=>{},l)}},Ve=De.postPerformanceEvent.bind(De),Ke=new class extends Ce{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(l,s,c,f){if(!Ne.API_URL||!Ne.SESSION_PATH)return;const v=je(Ne.API_URL+Ne.SESSION_PATH);v.params.push(`sku=${s||""}`),v.params.push(`access_token=${f||Ne.ACCESS_TOKEN||""}`);const C={url:at(v),headers:{"Content-Type":"text/plain"}};var R;this.pendingRequest=(R=S=>{this.pendingRequest=null,c(S),this.saveEventData(),this.processRequests(f)},vs(Ni(C,{method:"GET"}),R))}getSessionAPI(l,s,c,f){this.skuToken=s,this.errorCb=f,Ne.SESSION_PATH&&Ne.API_URL&&(c||Ne.ACCESS_TOKEN?this.queueRequest({id:l,timestamp:Date.now()},c):this.errorCb(new Error(En)))}processRequests(l){if(this.pendingRequest||0===this.queue.length)return;const{id:s,timestamp:c}=this.queue.shift();s&&this.success[s]||this.getSession(c,this.skuToken,f=>{f?this.errorCb(f):s&&(this.success[s]=!0)},l)}},ot=Ke.getSessionAPI.bind(Ke),tt=new Set,rt={create:"create",load:"load",fullLoad:"fullLoad"},$t={mark(l){ze.performance.mark(l)},measure(l,s,c){ze.performance.measure(l,s,c)}};function Dn(l){const s=l.name.split("?")[0];return wi(s)&&s.includes("mapbox-gl.js")?"javascript":wi(s)&&s.includes("mapbox-gl.css")?"css":Ne.API_FONTS_REGEX.test(s)?"fontRange":er(s)?"sprite":Di(s)?"style":Ne.API_TILEJSON_REGEX.test(s)?"tilejson":"other"}const cn=ze.performance;function ni(l){const s=l?l.url.toString():void 0;return cn.getEntriesByName(s)}let Xn,Nn,di,Li;const ur={now:()=>void 0!==di?di:ze.performance.now(),setNow(l){di=l},restoreNow(){di=void 0},frame(l){const s=ze.requestAnimationFrame(l);return{cancel:()=>ze.cancelAnimationFrame(s)}},getImageData(l,s=0){const{width:c,height:f}=l;Li||(Li=ze.document.createElement("canvas"));const v=Li.getContext("2d",{willReadFrequently:!0});if(!v)throw new Error("failed to create canvas 2d context");return(c>Li.width||f>Li.height)&&(Li.width=c,Li.height=f),v.clearRect(-s,-s,c+2*s,f+2*s),v.drawImage(l,0,0,c,f),v.getImageData(-s,-s,c+2*s,f+2*s)},resolveURL:l=>(Xn||(Xn=ze.document.createElement("a")),Xn.href=l,Xn.href),get devicePixelRatio(){return ze.devicePixelRatio},get prefersReducedMotion(){return!!ze.matchMedia&&(null==Nn&&(Nn=ze.matchMedia("(prefers-reduced-motion: reduce)")),Nn.matches)}};function li(l,s,c){c[l]&&-1!==c[l].indexOf(s)||(c[l]=c[l]||[],c[l].push(s))}function vr(l,s,c){if(c&&c[l]){const f=c[l].indexOf(s);-1!==f&&c[l].splice(f,1)}}class ci{constructor(s,c={}){Ni(this,c),this.type=s}}class Mr extends ci{constructor(s,c={}){super("error",Ni({error:s},c))}}class mo{on(s,c){return this._listeners=this._listeners||{},li(s,c,this._listeners),this}off(s,c){return vr(s,c,this._listeners),vr(s,c,this._oneTimeListeners),this}once(s,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},li(s,c,this._oneTimeListeners),this):new Promise(f=>this.once(s,f))}fire(s,c){"string"==typeof s&&(s=new ci(s,c||{}));const f=s.type;if(this.listens(f)){s.target=this;const v=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const R of v)R.call(this,s);const C=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const R of C)vr(f,R,this._oneTimeListeners),R.call(this,s);const S=this._eventedParent;S&&(Ni(s,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),S.fire(s))}else s instanceof Mr&&console.error(s.error);return this}listens(s){return!!(this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s))}setEventedParent(s,c){return this._eventedParent=s,this._eventedParentData=c,this}}var Rt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Ko(l,...s){for(const c of s)for(const f in c)l[f]=c[f];return l}function Sr(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function Vn(l){if(Array.isArray(l))return l.map(Vn);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const s={};for(const c in l)s[c]=Vn(l[c]);return s}return Sr(l)}class Vi extends Error{constructor(s,c){super(c),this.message=c,this.key=s}}var Pi=Vi;class ns{constructor(s,c=[]){this.parent=s,this.bindings={};for(const[f,v]of c)this.bindings[f]=v}concat(s){return new ns(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}var Ka=ns;const xo={kind:"null"},vn={kind:"number"},Hn={kind:"string"},Ui={kind:"boolean"},Ms={kind:"color"},Zn={kind:"object"},Hi={kind:"value"},Hl={kind:"collator"},pl={kind:"formatted"},$s={kind:"resolvedImage"};function kr(l,s){return{kind:"array",itemType:l,N:s}}function xr(l){if("array"===l.kind){const s=xr(l.itemType);return"number"==typeof l.N?`array<${s}, ${l.N}>`:"value"===l.itemType.kind?"array":`array<${s}>`}return l.kind}const Cc=[xo,vn,Hn,Ui,Ms,pl,Zn,kr(Hi),$s];function Zr(l,s){if("error"===s.kind)return null;if("array"===l.kind){if("array"===s.kind&&(0===s.N&&"value"===s.itemType.kind||!Zr(l.itemType,s.itemType))&&("number"!=typeof l.N||l.N===s.N))return null}else{if(l.kind===s.kind)return null;if("value"===l.kind)for(const c of Cc)if(!Zr(c,s))return null}return`Expected ${xr(l)} but found ${xr(s)} instead.`}function ta(l,s){return s.some(c=>c.kind===l.kind)}function qr(l,s){return s.some(c=>"null"===c?null===l:"array"===c?Array.isArray(l):"object"===c?l&&!Array.isArray(l)&&"object"==typeof l:c===typeof l)}var Ki,Ya={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ks(l){return(l=Math.round(l))<0?0:l>255?255:l}function fl(l){return ks("%"===l[l.length-1]?parseFloat(l)/100*255:parseInt(l))}function jl(l){return(s="%"===l[l.length-1]?parseFloat(l)/100:parseFloat(l))<0?0:s>1?1:s;var s}function Ja(l,s,c){return c<0?c+=1:c>1&&(c-=1),6*c<1?l+(s-l)*c*6:2*c<1?s:3*c<2?l+(s-l)*(2/3-c)*6:l}try{Ki={}.parseCSSColor=function(l){var s,c=l.replace(/ /g,"").toLowerCase();if(c in Ya)return Ya[c].slice();if("#"===c[0])return 4===c.length?(s=parseInt(c.substr(1),16))>=0&&s<=4095?[(3840&s)>>4|(3840&s)>>8,240&s|(240&s)>>4,15&s|(15&s)<<4,1]:null:7===c.length&&(s=parseInt(c.substr(1),16))>=0&&s<=16777215?[(16711680&s)>>16,(65280&s)>>8,255&s,1]:null;var f=c.indexOf("("),v=c.indexOf(")");if(-1!==f&&v+1===c.length){var C=c.substr(0,f),S=c.substr(f+1,v-(f+1)).split(","),R=1;switch(C){case"rgba":if(4!==S.length)return null;R=jl(S.pop());case"rgb":return 3!==S.length?null:[fl(S[0]),fl(S[1]),fl(S[2]),R];case"hsla":if(4!==S.length)return null;R=jl(S.pop());case"hsl":if(3!==S.length)return null;var N=(parseFloat(S[0])%360+360)%360/360,U=jl(S[1]),W=jl(S[2]),Q=W<=.5?W*(U+1):W+U-W*U,ee=2*W-Q;return[ks(255*Ja(ee,Q,N+1/3)),ks(255*Ja(ee,Q,N)),ks(255*Ja(ee,Q,N-1/3)),R];default:return null}}return null}}catch{}class go{constructor(s,c,f,v=1){this.r=s,this.g=c,this.b=f,this.a=v}static parse(s){if(!s)return;if(s instanceof go)return s;if("string"!=typeof s)return;const c=Ki(s);return c?new go(c[0]/255*c[3],c[1]/255*c[3],c[2]/255*c[3],c[3]):void 0}toString(){const[s,c,f,v]=this.toArray();return`rgba(${Math.round(s)},${Math.round(c)},${Math.round(f)},${v})`}toArray(){const{r:s,g:c,b:f,a:v}=this;return 0===v?[0,0,0,0]:[255*s/v,255*c/v,255*f/v,v]}toArray01(){const{r:s,g:c,b:f,a:v}=this;return 0===v?[0,0,0,0]:[s/v,c/v,f/v,v]}toArray01PremultipliedAlpha(){const{r:s,g:c,b:f,a:v}=this;return[s,c,f,v]}}go.black=new go(0,0,0,1),go.white=new go(1,1,1,1),go.transparent=new go(0,0,0,0),go.red=new go(1,0,0,1),go.blue=new go(0,0,1,1);var Qi=go;class jd{constructor(s,c,f){this.sensitivity=s?c?"variant":"case":c?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,c){return this.collator.compare(s,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Rs{constructor(s,c,f,v,C){this.text=s.normalize?s.normalize():s,this.image=c,this.scale=f,this.fontStack=v,this.textColor=C}}class uo{constructor(s){this.sections=s}static fromString(s){return new uo([new Rs(s,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(s=>0!==s.text.length||s.image&&0!==s.image.name.length)}static factory(s){return s instanceof uo?s:uo.fromString(s)}toString(){return 0===this.sections.length?"":this.sections.map(s=>s.text).join("")}serialize(){const s=["format"];for(const c of this.sections){if(c.image){s.push(["image",c.image.name]);continue}s.push(c.text);const f={};c.fontStack&&(f["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(f["font-scale"]=c.scale),c.textColor&&(f["text-color"]=["rgba"].concat(c.textColor.toArray())),s.push(f)}return s}}class ko{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new ko({name:s,available:!1}):null}serialize(){return["image",this.name]}}function Nu(l,s,c,f){return"number"==typeof l&&l>=0&&l<=255&&"number"==typeof s&&s>=0&&s<=255&&"number"==typeof c&&c>=0&&c<=255?void 0===f||"number"==typeof f&&f>=0&&f<=1?null:`Invalid rgba value [${[l,s,c,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof f?[l,s,c,f]:[l,s,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function zu(l){if(null===l||"string"==typeof l||"boolean"==typeof l||"number"==typeof l||l instanceof Qi||l instanceof jd||l instanceof uo||l instanceof ko)return!0;if(Array.isArray(l)){for(const s of l)if(!zu(s))return!1;return!0}if("object"==typeof l){for(const s in l)if(!zu(l[s]))return!1;return!0}return!1}function fr(l){if(null===l)return xo;if("string"==typeof l)return Hn;if("boolean"==typeof l)return Ui;if("number"==typeof l)return vn;if(l instanceof Qi)return Ms;if(l instanceof jd)return Hl;if(l instanceof uo)return pl;if(l instanceof ko)return $s;if(Array.isArray(l)){const s=l.length;let c;for(const f of l){const v=fr(f);if(c){if(c===v)continue;c=Hi;break}c=v}return kr(c||Hi,s)}return Zn}function Xh(l){const s=typeof l;return null===l?"":"string"===s||"number"===s||"boolean"===s?String(l):l instanceof Qi||l instanceof uo||l instanceof ko?l.toString():JSON.stringify(l)}class Bu{constructor(s,c){this.type=s,this.value=c}static parse(s,c){if(2!==s.length)return c.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!zu(s[1]))return c.error("invalid value");const f=s[1];let v=fr(f);const C=c.expectedType;return"array"!==v.kind||0!==v.N||!C||"array"!==C.kind||"number"==typeof C.N&&0!==C.N||(v=C),new Bu(v,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Qi?["rgba"].concat(this.value.toArray()):this.value instanceof uo?this.value.serialize():this.value}}var Ca=Bu,jo=class{constructor(l){this.name="ExpressionEvaluationError",this.message=l}toJSON(){return this.message}};const Ec={string:Hn,number:vn,boolean:Ui,object:Zn};class ph{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");let f,v=1;const C=s[0];if("array"===C){let R,N;if(s.length>2){const U=s[1];if("string"!=typeof U||!(U in Ec)||"object"===U)return c.error('The item type argument of "array" must be one of string, number, boolean',1);R=Ec[U],v++}else R=Hi;if(s.length>3){if(null!==s[2]&&("number"!=typeof s[2]||s[2]<0||s[2]!==Math.floor(s[2])))return c.error('The length argument to "array" must be a positive integer literal',2);N=s[2],v++}f=kr(R,N)}else f=Ec[C];const S=[];for(;v<s.length;v++){const R=c.parse(s[v],v,Hi);if(!R)return null;S.push(R)}return new ph(f,S)}evaluate(s){for(let c=0;c<this.args.length;c++){const f=this.args[c].evaluate(s);if(!Zr(this.type,fr(f)))return f;if(c===this.args.length-1)throw new jo(`Expected value to be of type ${xr(this.type)}, but found ${xr(fr(f))} instead.`)}return null}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=this.type,c=[s.kind];if("array"===s.kind){const f=s.itemType;if("string"===f.kind||"number"===f.kind||"boolean"===f.kind){c.push(f.kind);const v=s.N;("number"==typeof v||this.args.length>1)&&c.push(v)}}return c.concat(this.args.map(f=>f.serialize()))}}var Gl=ph;class fh{constructor(s){this.type=pl,this.sections=s}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const f=s[1];if(!Array.isArray(f)&&"object"==typeof f)return c.error("First argument must be an image or text section.");const v=[];let C=!1;for(let S=1;S<=s.length-1;++S){const R=s[S];if(C&&"object"==typeof R&&!Array.isArray(R)){C=!1;let N=null;if(R["font-scale"]&&(N=c.parse(R["font-scale"],1,vn),!N))return null;let U=null;if(R["text-font"]&&(U=c.parse(R["text-font"],1,kr(Hn)),!U))return null;let W=null;if(R["text-color"]&&(W=c.parse(R["text-color"],1,Ms),!W))return null;const Q=v[v.length-1];Q.scale=N,Q.font=U,Q.textColor=W}else{const N=c.parse(s[S],1,Hi);if(!N)return null;const U=N.type.kind;if("string"!==U&&"value"!==U&&"null"!==U&&"resolvedImage"!==U)return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");C=!0,v.push({content:N,scale:null,font:null,textColor:null})}}return new fh(v)}evaluate(s){return new uo(this.sections.map(c=>{const f=c.content.evaluate(s);return fr(f)===$s?new Rs("",f,null,null,null):new Rs(Xh(f),null,c.scale?c.scale.evaluate(s):null,c.font?c.font.evaluate(s).join(","):null,c.textColor?c.textColor.evaluate(s):null)}))}eachChild(s){for(const c of this.sections)s(c.content),c.scale&&s(c.scale),c.font&&s(c.font),c.textColor&&s(c.textColor)}outputDefined(){return!1}serialize(){const s=["format"];for(const c of this.sections){s.push(c.content.serialize());const f={};c.scale&&(f["font-scale"]=c.scale.serialize()),c.font&&(f["text-font"]=c.font.serialize()),c.textColor&&(f["text-color"]=c.textColor.serialize()),s.push(f)}return s}}class Gd{constructor(s){this.type=$s,this.input=s}static parse(s,c){if(2!==s.length)return c.error("Expected two arguments.");const f=c.parse(s[1],1,Hn);return f?new Gd(f):c.error("No image name provided.")}evaluate(s){const c=this.input.evaluate(s),f=ko.fromString(c);return f&&s.availableImages&&(f.available=s.availableImages.indexOf(c)>-1),f}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const mh={"to-boolean":Ui,"to-color":Ms,"to-number":vn,"to-string":Hn};class kp{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const f=s[0];if(("to-boolean"===f||"to-string"===f)&&2!==s.length)return c.error("Expected one argument.");const v=mh[f],C=[];for(let S=1;S<s.length;S++){const R=c.parse(s[S],S,Hi);if(!R)return null;C.push(R)}return new kp(v,C)}evaluate(s){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(s));if("color"===this.type.kind){let c,f;for(const v of this.args){if(c=v.evaluate(s),f=null,c instanceof Qi)return c;if("string"==typeof c){const C=s.parseColor(c);if(C)return C}else if(Array.isArray(c)&&(f=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:Nu(c[0],c[1],c[2],c[3]),!f))return new Qi(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new jo(f||`Could not parse color from value '${"string"==typeof c?c:String(JSON.stringify(c))}'`)}if("number"===this.type.kind){let c=null;for(const f of this.args){if(c=f.evaluate(s),null===c)return 0;const v=Number(c);if(!isNaN(v))return v}throw new jo(`Could not convert ${JSON.stringify(c)} to number.`)}return"formatted"===this.type.kind?uo.fromString(Xh(this.args[0].evaluate(s))):"resolvedImage"===this.type.kind?ko.fromString(Xh(this.args[0].evaluate(s))):Xh(this.args[0].evaluate(s))}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){if("formatted"===this.type.kind)return new fh([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Gd(this.args[0]).serialize();const s=[`to-${this.type.kind}`];return this.eachChild(c=>{s.push(c.serialize())}),s}}var na=kp;const Qa=["Unknown","Point","LineString","Polygon"];var ed=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Qa[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const l=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:c,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*s-l[0])+this.featureDistanceData.bearing[1]*(f*s-l[1])}return 0}parseColor(l){let s=this._parseColorCache[l];return s||(s=this._parseColorCache[l]=Qi.parse(l)),s}};class Tc{constructor(s,c,f,v){this.name=s,this.type=c,this._evaluate=f,this.args=v}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(s=>s.serialize()))}static parse(s,c){const f=s[0],v=Tc.definitions[f];if(!v)return c.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const C=Array.isArray(v)?v[0]:v.type,S=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,R=S.filter(([U])=>!Array.isArray(U)||U.length===s.length-1);let N=null;for(const[U,W]of R){N=new Oa(c.registry,c.path,null,c.scope);const Q=[];let ee=!1;for(let oe=1;oe<s.length;oe++){const le=s[oe],he=Array.isArray(U)?U[oe-1]:U.type,Ie=N.parse(le,1+Q.length,he);if(!Ie){ee=!0;break}Q.push(Ie)}if(!ee)if(Array.isArray(U)&&U.length!==Q.length)N.error(`Expected ${U.length} arguments, but found ${Q.length} instead.`);else{for(let oe=0;oe<Q.length;oe++){const le=Array.isArray(U)?U[oe]:U.type,he=Q[oe];N.concat(oe+1).checkSubtype(le,he.type)}if(0===N.errors.length)return new Tc(f,C,W,Q)}}if(1===R.length)c.errors.push(...N.errors);else{const U=(R.length?R:S).map(([Q])=>{return ee=Q,Array.isArray(ee)?`(${ee.map(xr).join(", ")})`:`(${xr(ee.type)}...)`;var ee}).join(" | "),W=[];for(let Q=1;Q<s.length;Q++){const ee=c.parse(s[Q],1+W.length);if(!ee)return null;W.push(xr(ee.type))}c.error(`Expected arguments of type ${U}, but found (${W.join(", ")}) instead.`)}return null}static register(s,c){Tc.definitions=c;for(const f in c)s[f]=Tc}}var tr=Tc;class Sc{constructor(s,c,f){this.type=Hl,this.locale=f,this.caseSensitive=s,this.diacriticSensitive=c}static parse(s,c){if(2!==s.length)return c.error("Expected one argument.");const f=s[1];if("object"!=typeof f||Array.isArray(f))return c.error("Collator options argument must be an object.");const v=c.parse(void 0!==f["case-sensitive"]&&f["case-sensitive"],1,Ui);if(!v)return null;const C=c.parse(void 0!==f["diacritic-sensitive"]&&f["diacritic-sensitive"],1,Ui);if(!C)return null;let S=null;return f.locale&&(S=c.parse(f.locale,1,Hn),!S)?null:new Sc(v,C,S)}evaluate(s){return new jd(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}serialize(){const s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]}}const $l=8192;function ia(l,s){l[0]=Math.min(l[0],s[0]),l[1]=Math.min(l[1],s[1]),l[2]=Math.max(l[2],s[0]),l[3]=Math.max(l[3],s[1])}function tu(l,s){return!(l[0]<=s[0]||l[2]>=s[2]||l[1]<=s[1]||l[3]>=s[3])}function wf(l,s){const c=(180+l[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,v=Math.pow(2,s.z);return[Math.round(c*v*$l),Math.round(f*v*$l)]}function ml(l,s,c){const f=l[0]-s[0],v=l[1]-s[1],C=l[0]-c[0],S=l[1]-c[1];return f*S-C*v==0&&f*C<=0&&v*S<=0}function Wl(l,s){let c=!1;for(let S=0,R=s.length;S<R;S++){const N=s[S];for(let U=0,W=N.length;U<W-1;U++){if(ml(l,N[U],N[U+1]))return!1;(v=N[U])[1]>(f=l)[1]!=(C=N[U+1])[1]>f[1]&&f[0]<(C[0]-v[0])*(f[1]-v[1])/(C[1]-v[1])+v[0]&&(c=!c)}}var f,v,C;return c}function nu(l,s){for(let c=0;c<s.length;c++)if(Wl(l,s[c]))return!0;return!1}function iu(l,s,c,f){const v=f[0]-c[0],C=f[1]-c[1],S=(l[0]-c[0])*C-v*(l[1]-c[1]),R=(s[0]-c[0])*C-v*(s[1]-c[1]);return S>0&&R<0||S<0&&R>0}function Vu(l,s,c){for(const U of c)for(let W=0;W<U.length-1;++W)if((R=[(S=U[W+1])[0]-(C=U[W])[0],S[1]-C[1]])[0]*(N=[(v=s)[0]-(f=l)[0],v[1]-f[1]])[1]-R[1]*N[0]!=0&&iu(f,v,C,S)&&iu(C,S,f,v))return!0;var f,v,C,S,R,N;return!1}function Xa(l,s){for(let c=0;c<l.length;++c)if(!Wl(l[c],s))return!1;for(let c=0;c<l.length-1;++c)if(Vu(l[c],l[c+1],s))return!1;return!0}function Ic(l,s){for(let c=0;c<s.length;c++)if(Xa(l,s[c]))return!0;return!1}function Dc(l,s,c){const f=[];for(let v=0;v<l.length;v++){const C=[];for(let S=0;S<l[v].length;S++){const R=wf(l[v][S],c);ia(s,R),C.push(R)}f.push(C)}return f}function gh(l,s,c){const f=[];for(let v=0;v<l.length;v++){const C=Dc(l[v],s,c);f.push(C)}return f}function Zl(l,s,c,f){if(l[0]<c[0]||l[0]>c[2]){const v=.5*f;let C=l[0]-c[0]>v?-f:c[0]-l[0]>v?f:0;0===C&&(C=l[0]-c[2]>v?-f:c[2]-l[0]>v?f:0),l[0]+=C}ia(s,l)}function gl(l,s,c,f){const v=Math.pow(2,f.z)*$l,C=[f.x*$l,f.y*$l],S=[];if(!l)return S;for(const R of l)for(const N of R){const U=[N.x+C[0],N.y+C[1]];Zl(U,s,c,v),S.push(U)}return S}function Mi(l,s,c,f){const v=Math.pow(2,f.z)*$l,C=[f.x*$l,f.y*$l],S=[];if(!l)return S;for(const N of l){const U=[];for(const W of N){const Q=[W.x+C[0],W.y+C[1]];ia(s,Q),U.push(Q)}S.push(U)}if(s[2]-s[0]<=v/2){(R=s)[0]=R[1]=1/0,R[2]=R[3]=-1/0;for(const N of S)for(const U of N)Zl(U,s,c,v)}var R;return S}class Ro{constructor(s,c){this.type=Ui,this.geojson=s,this.geometries=c}static parse(s,c){if(2!==s.length)return c.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(zu(s[1])){const f=s[1];if("FeatureCollection"===f.type)for(let v=0;v<f.features.length;++v){const C=f.features[v].geometry.type;if("Polygon"===C||"MultiPolygon"===C)return new Ro(f,f.features[v].geometry)}else if("Feature"===f.type){const v=f.geometry.type;if("Polygon"===v||"MultiPolygon"===v)return new Ro(f,f.geometry)}else if("Polygon"===f.type||"MultiPolygon"===f.type)return new Ro(f,f)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(null!=s.geometry()&&null!=s.canonicalID()){if("Point"===s.geometryType())return function(c,f){const v=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],S=c.canonicalID();if(!S)return!1;if("Polygon"===f.type){const R=Dc(f.coordinates,C,S),N=gl(c.geometry(),v,C,S);if(!tu(v,C))return!1;for(const U of N)if(!Wl(U,R))return!1}if("MultiPolygon"===f.type){const R=gh(f.coordinates,C,S),N=gl(c.geometry(),v,C,S);if(!tu(v,C))return!1;for(const U of N)if(!nu(U,R))return!1}return!0}(s,this.geometries);if("LineString"===s.geometryType())return function(c,f){const v=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],S=c.canonicalID();if(!S)return!1;if("Polygon"===f.type){const R=Dc(f.coordinates,C,S),N=Mi(c.geometry(),v,C,S);if(!tu(v,C))return!1;for(const U of N)if(!Xa(U,R))return!1}if("MultiPolygon"===f.type){const R=gh(f.coordinates,C,S),N=Mi(c.geometry(),v,C,S);if(!tu(v,C))return!1;for(const U of N)if(!Ic(U,R))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var _h=Ro;function _o(l){if(l instanceof tr&&("get"===l.name&&1===l.args.length||"feature-state"===l.name||"has"===l.name&&1===l.args.length||"properties"===l.name||"geometry-type"===l.name||"id"===l.name||/^filter-/.test(l.name))||l instanceof _h)return!1;let s=!0;return l.eachChild(c=>{s&&!_o(c)&&(s=!1)}),s}function Uu(l){if(l instanceof tr&&"feature-state"===l.name)return!1;let s=!0;return l.eachChild(c=>{s&&!Uu(c)&&(s=!1)}),s}function Pa(l,s){if(l instanceof tr&&s.indexOf(l.name)>=0)return!1;let c=!0;return l.eachChild(f=>{c&&!Pa(f,s)&&(c=!1)}),c}class Ps{constructor(s,c){this.type=c.type,this.name=s,this.boundExpression=c}static parse(s,c){if(2!==s.length||"string"!=typeof s[1])return c.error("'var' expression requires exactly one string literal argument.");const f=s[1];return c.scope.has(f)?new Ps(f,c.scope.get(f)):c.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var _l=Ps;class ru{constructor(s,c=[],f,v=new Ka,C=[]){this.registry=s,this.path=c,this.key=c.map(S=>`[${S}]`).join(""),this.scope=v,this.errors=C,this.expectedType=f}parse(s,c,f,v,C={}){return c?this.concat(c,f,v)._parse(s,C):this._parse(s,C)}_parse(s,c){function f(v,C,S){return"assert"===S?new Gl(C,[v]):"coerce"===S?new na(C,[v]):v}if(null!==s&&"string"!=typeof s&&"boolean"!=typeof s&&"number"!=typeof s||(s=["literal",s]),Array.isArray(s)){if(0===s.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const v=s[0];if("string"!=typeof v)return this.error(`Expression name must be a string, but found ${typeof v} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const C=this.registry[v];if(C){let S=C.parse(s,this);if(!S)return null;if(this.expectedType){const R=this.expectedType,N=S.type;if("string"!==R.kind&&"number"!==R.kind&&"boolean"!==R.kind&&"object"!==R.kind&&"array"!==R.kind||"value"!==N.kind)if("color"!==R.kind&&"formatted"!==R.kind&&"resolvedImage"!==R.kind||"value"!==N.kind&&"string"!==N.kind){if(this.checkSubtype(R,N))return null}else S=f(S,R,c.typeAnnotation||"coerce");else S=f(S,R,c.typeAnnotation||"assert")}if(!(S instanceof Ca)&&"resolvedImage"!==S.type.kind&&Co(S)){const R=new ed;try{S=new Ca(S.type,S.evaluate(R))}catch(N){return this.error(N.message),null}}return S}return this.error(`Unknown expression "${v}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===s?"'undefined' value invalid. Use null instead.":"object"==typeof s?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,c,f){const v="number"==typeof s?this.path.concat(s):this.path,C=f?this.scope.concat(f):this.scope;return new ru(this.registry,v,c||null,C,this.errors)}error(s,...c){const f=`${this.key}${c.map(v=>`[${v}]`).join("")}`;this.errors.push(new Pi(f,s))}checkSubtype(s,c){const f=Zr(s,c);return f&&this.error(f),f}}var Oa=ru;function Co(l){if(l instanceof _l)return Co(l.boundExpression);if(l instanceof tr&&"error"===l.name||l instanceof Sc||l instanceof _h)return!1;const s=l instanceof na||l instanceof Gl;let c=!0;return l.eachChild(f=>{c=s?c&&Co(f):c&&f instanceof Ca}),!!c&&_o(l)&&Pa(l,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function yl(l,s){const c=l.length-1;let f,v,C=0,S=c,R=0;for(;C<=S;)if(R=Math.floor((C+S)/2),f=l[R],v=l[R+1],f<=s){if(R===c||s<v)return R;C=R+1}else{if(!(f>s))throw new jo("Input is not a number.");S=R-1}return 0}class vl{constructor(s,c,f){this.type=s,this.input=c,this.labels=[],this.outputs=[];for(const[v,C]of f)this.labels.push(v),this.outputs.push(C)}static parse(s,c){if(s.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return c.error("Expected an even number of arguments.");const f=c.parse(s[1],1,vn);if(!f)return null;const v=[];let C=null;c.expectedType&&"value"!==c.expectedType.kind&&(C=c.expectedType);for(let S=1;S<s.length;S+=2){const R=1===S?-1/0:s[S],N=s[S+1],U=S,W=S+1;if("number"!=typeof R)return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(v.length&&v[v.length-1][0]>=R)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',U);const Q=c.parse(N,W,C);if(!Q)return null;C=C||Q.type,v.push([R,Q])}return new vl(C,f,v)}evaluate(s){const c=this.labels,f=this.outputs;if(1===c.length)return f[0].evaluate(s);const v=this.input.evaluate(s);if(v<=c[0])return f[0].evaluate(s);const C=c.length;return v>=c[C-1]?f[C-1].evaluate(s):f[yl(c,v)].evaluate(s)}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){const s=["step",this.input.serialize()];for(let c=0;c<this.labels.length;c++)c>0&&s.push(this.labels[c]),s.push(this.outputs[c].serialize());return s}}var $d=vl;function Oi(l,s,c){return l*(1-c)+s*c}var Hu=Object.freeze({__proto__:null,number:Oi,color:function(l,s,c){return new Qi(Oi(l.r,s.r,c),Oi(l.g,s.g,c),Oi(l.b,s.b,c),Oi(l.a,s.a,c))},array:function(l,s,c){return l.map((f,v)=>Oi(f,s[v],c))}});const Mc=4/29,td=6/29,ju=3*td*td,Rp=Math.PI/180,yh=180/Math.PI;function vh(l){return l>.008856451679035631?Math.pow(l,1/3):l/ju+Mc}function Gu(l){return l>td?l*l*l:ju*(l-Mc)}function Wd(l){return 255*(l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055)}function dn(l){return(l/=255)<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function xi(l){const s=dn(l.r),c=dn(l.g),f=dn(l.b),v=vh((.4124564*s+.3575761*c+.1804375*f)/.95047),C=vh((.2126729*s+.7151522*c+.072175*f)/1);return{l:116*C-16,a:500*(v-C),b:200*(C-vh((.0193339*s+.119192*c+.9503041*f)/1.08883)),alpha:l.a}}function Pp(l){let s=(l.l+16)/116,c=isNaN(l.a)?s:s+l.a/500,f=isNaN(l.b)?s:s-l.b/200;return s=1*Gu(s),c=.95047*Gu(c),f=1.08883*Gu(f),new Qi(Wd(3.2404542*c-1.5371385*s-.4985314*f),Wd(-.969266*c+1.8760108*s+.041556*f),Wd(.0556434*c-.2040259*s+1.0572252*f),l.alpha)}function Op(l,s,c){const f=s-l;return l+c*(f>180||f<-180?f-360*Math.round(f/360):f)}const Go={forward:xi,reverse:Pp,interpolate:function(l,s,c){return{l:Oi(l.l,s.l,c),a:Oi(l.a,s.a,c),b:Oi(l.b,s.b,c),alpha:Oi(l.alpha,s.alpha,c)}}},ou={forward:function(l){const{l:s,a:c,b:f}=xi(l),v=Math.atan2(f,c)*yh;return{h:v<0?v+360:v,c:Math.sqrt(c*c+f*f),l:s,alpha:l.a}},reverse:function(l){const s=l.h*Rp,c=l.c;return Pp({l:l.l,a:Math.cos(s)*c,b:Math.sin(s)*c,alpha:l.alpha})},interpolate:function(l,s,c){return{h:Op(l.h,s.h,c),c:Oi(l.c,s.c,c),l:Oi(l.l,s.l,c),alpha:Oi(l.alpha,s.alpha,c)}}};var su=Object.freeze({__proto__:null,lab:Go,hcl:ou});class ga{constructor(s,c,f,v,C){this.type=s,this.operator=c,this.interpolation=f,this.input=v,this.labels=[],this.outputs=[];for(const[S,R]of C)this.labels.push(S),this.outputs.push(R)}static interpolationFactor(s,c,f,v){let C=0;if("exponential"===s.name)C=ql(c,s.base,f,v);else if("linear"===s.name)C=ql(c,1,f,v);else if("cubic-bezier"===s.name){const S=s.controlPoints;C=new Ot(S[0],S[1],S[2],S[3]).solve(ql(c,1,f,v))}return C}static parse(s,c){let[f,v,C,...S]=s;if(!Array.isArray(v)||0===v.length)return c.error("Expected an interpolation type expression.",1);if("linear"===v[0])v={name:"linear"};else if("exponential"===v[0]){const U=v[1];if("number"!=typeof U)return c.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:U}}else{if("cubic-bezier"!==v[0])return c.error(`Unknown interpolation type ${String(v[0])}`,1,0);{const U=v.slice(1);if(4!==U.length||U.some(W=>"number"!=typeof W||W<0||W>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:U}}}if(s.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(C=c.parse(C,2,vn),!C)return null;const R=[];let N=null;"interpolate-hcl"===f||"interpolate-lab"===f?N=Ms:c.expectedType&&"value"!==c.expectedType.kind&&(N=c.expectedType);for(let U=0;U<S.length;U+=2){const W=S[U],Q=S[U+1],ee=U+3,oe=U+4;if("number"!=typeof W)return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ee);if(R.length&&R[R.length-1][0]>=W)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ee);const le=c.parse(Q,oe,N);if(!le)return null;N=N||le.type,R.push([W,le])}return"number"===N.kind||"color"===N.kind||"array"===N.kind&&"number"===N.itemType.kind&&"number"==typeof N.N?new ga(N,f,v,C,R):c.error(`Type ${xr(N)} is not interpolatable.`)}evaluate(s){const c=this.labels,f=this.outputs;if(1===c.length)return f[0].evaluate(s);const v=this.input.evaluate(s);if(v<=c[0])return f[0].evaluate(s);const C=c.length;if(v>=c[C-1])return f[C-1].evaluate(s);const S=yl(c,v),R=ga.interpolationFactor(this.interpolation,v,c[S],c[S+1]),N=f[S].evaluate(s),U=f[S+1].evaluate(s);return"interpolate"===this.operator?Hu[this.type.kind.toLowerCase()](N,U,R):"interpolate-hcl"===this.operator?ou.reverse(ou.interpolate(ou.forward(N),ou.forward(U),R)):Go.reverse(Go.interpolate(Go.forward(N),Go.forward(U),R))}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){let s;s="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const c=[this.operator,s,this.input.serialize()];for(let f=0;f<this.labels.length;f++)c.push(this.labels[f],this.outputs[f].serialize());return c}}function ql(l,s,c,f){const v=f-c,C=l-c;return 0===v?0:1===s?C/v:(Math.pow(s,C)-1)/(Math.pow(s,v)-1)}var el=ga;class $u{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expectected at least one argument.");let f=null;const v=c.expectedType;v&&"value"!==v.kind&&(f=v);const C=[];for(const R of s.slice(1)){const N=c.parse(R,1+C.length,f,void 0,{typeAnnotation:"omit"});if(!N)return null;f=f||N.type,C.push(N)}const S=v&&C.some(R=>Zr(v,R.type));return new $u(S?Hi:f,C)}evaluate(s){let c,f=null,v=0;for(const C of this.args){if(v++,f=C.evaluate(s),f&&f instanceof ko&&!f.available&&(c||(c=f),f=null,v===this.args.length))return c;if(null!==f)break}return f}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=["coalesce"];return this.eachChild(c=>{s.push(c.serialize())}),s}}var vm=$u;class bl{constructor(s,c){this.type=c.type,this.bindings=[].concat(s),this.result=c}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const c of this.bindings)s(c[1]);s(this.result)}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const f=[];for(let C=1;C<s.length-1;C+=2){const S=s[C];if("string"!=typeof S)return c.error(`Expected string, but found ${typeof S} instead.`,C);if(/[^a-zA-Z0-9_]/.test(S))return c.error("Variable names must contain only alphanumeric characters or '_'.",C);const R=c.parse(s[C+1],C+1);if(!R)return null;f.push([S,R])}const v=c.parse(s[s.length-1],s.length-1,c.expectedType,f);return v?new bl(f,v):null}outputDefined(){return this.result.outputDefined()}serialize(){const s=["let"];for(const[c,f]of this.bindings)s.push(c,f.serialize());return s.push(this.result.serialize()),s}}var bs=bl;class Ws{constructor(s,c,f){this.type=s,this.index=c,this.input=f}static parse(s,c){if(3!==s.length)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=c.parse(s[1],1,vn),v=c.parse(s[2],2,kr(c.expectedType||Hi));return f&&v?new Ws(v.type.itemType,f,v):null}evaluate(s){const c=this.index.evaluate(s),f=this.input.evaluate(s);if(c<0)throw new jo(`Array index out of bounds: ${c} < 0.`);if(c>=f.length)throw new jo(`Array index out of bounds: ${c} > ${f.length-1}.`);if(c!==Math.floor(c))throw new jo(`Array index must be an integer, but found ${c} instead.`);return f[c]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var nd=Ws;class Zs{constructor(s,c){this.type=Ui,this.needle=s,this.haystack=c}static parse(s,c){if(3!==s.length)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=c.parse(s[1],1,Hi),v=c.parse(s[2],2,Hi);return f&&v?ta(f.type,[Ui,Hn,vn,xo,Hi])?new Zs(f,v):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${xr(f.type)} instead`):null}evaluate(s){const c=this.needle.evaluate(s),f=this.haystack.evaluate(s);if(null==f)return!1;if(!qr(c,["boolean","string","number","null"]))throw new jo(`Expected first argument to be of type boolean, string, number or null, but found ${xr(fr(c))} instead.`);if(!qr(f,["string","array"]))throw new jo(`Expected second argument to be of type array or string, but found ${xr(fr(f))} instead.`);return f.indexOf(c)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Kl=Zs;class id{constructor(s,c,f){this.type=vn,this.needle=s,this.haystack=c,this.fromIndex=f}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const f=c.parse(s[1],1,Hi),v=c.parse(s[2],2,Hi);if(!f||!v)return null;if(!ta(f.type,[Ui,Hn,vn,xo,Hi]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${xr(f.type)} instead`);if(4===s.length){const C=c.parse(s[3],3,vn);return C?new id(f,v,C):null}return new id(f,v)}evaluate(s){const c=this.needle.evaluate(s),f=this.haystack.evaluate(s);if(!qr(c,["boolean","string","number","null"]))throw new jo(`Expected first argument to be of type boolean, string, number or null, but found ${xr(fr(c))} instead.`);if(!qr(f,["string","array"]))throw new jo(`Expected second argument to be of type array or string, but found ${xr(fr(f))} instead.`);if(this.fromIndex){const v=this.fromIndex.evaluate(s);return f.indexOf(c,v)}return f.indexOf(c)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var au=id;class lu{constructor(s,c,f,v,C,S){this.inputType=s,this.type=c,this.input=f,this.cases=v,this.outputs=C,this.otherwise=S}static parse(s,c){if(s.length<5)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return c.error("Expected an even number of arguments.");let f,v;c.expectedType&&"value"!==c.expectedType.kind&&(v=c.expectedType);const C={},S=[];for(let U=2;U<s.length-1;U+=2){let W=s[U];const Q=s[U+1];Array.isArray(W)||(W=[W]);const ee=c.concat(U);if(0===W.length)return ee.error("Expected at least one branch label.");for(const le of W){if("number"!=typeof le&&"string"!=typeof le)return ee.error("Branch labels must be numbers or strings.");if("number"==typeof le&&Math.abs(le)>Number.MAX_SAFE_INTEGER)return ee.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof le&&Math.floor(le)!==le)return ee.error("Numeric branch labels must be integer values.");if(f){if(ee.checkSubtype(f,fr(le)))return null}else f=fr(le);if(void 0!==C[String(le)])return ee.error("Branch labels must be unique.");C[String(le)]=S.length}const oe=c.parse(Q,U,v);if(!oe)return null;v=v||oe.type,S.push(oe)}const R=c.parse(s[1],1,Hi);if(!R)return null;const N=c.parse(s[s.length-1],s.length-1,v);return N?"value"!==R.type.kind&&c.concat(1).checkSubtype(f,R.type)?null:new lu(f,v,R,C,S,N):null}evaluate(s){const c=this.input.evaluate(s);return(fr(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["match",this.input.serialize()],c=Object.keys(this.cases).sort(),f=[],v={};for(const S of c){const R=v[this.cases[S]];void 0===R?(v[this.cases[S]]=f.length,f.push([this.cases[S],[S]])):f[R][1].push(S)}const C=S=>"number"===this.inputType.kind?Number(S):S;for(const[S,R]of f)s.push(1===R.length?C(R[0]):R.map(C)),s.push(this.outputs[S].serialize());return s.push(this.otherwise.serialize()),s}}var xf=lu;class Yl{constructor(s,c,f){this.type=s,this.branches=c,this.otherwise=f}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return c.error("Expected an odd number of arguments.");let f;c.expectedType&&"value"!==c.expectedType.kind&&(f=c.expectedType);const v=[];for(let S=1;S<s.length-1;S+=2){const R=c.parse(s[S],S,Ui);if(!R)return null;const N=c.parse(s[S+1],S+1,f);if(!N)return null;v.push([R,N]),f=f||N.type}const C=c.parse(s[s.length-1],s.length-1,f);return C?new Yl(f,v,C):null}evaluate(s){for(const[c,f]of this.branches)if(c.evaluate(s))return f.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[c,f]of this.branches)s(c),s(f);s(this.otherwise)}outputDefined(){return this.branches.every(([s,c])=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["case"];return this.eachChild(c=>{s.push(c.serialize())}),s}}var rd=Yl;class Jl{constructor(s,c,f,v){this.type=s,this.input=c,this.beginIndex=f,this.endIndex=v}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const f=c.parse(s[1],1,Hi),v=c.parse(s[2],2,vn);if(!f||!v)return null;if(!ta(f.type,[kr(Hi),Hn,Hi]))return c.error(`Expected first argument to be of type array or string, but found ${xr(f.type)} instead`);if(4===s.length){const C=c.parse(s[3],3,vn);return C?new Jl(f.type,f,v,C):null}return new Jl(f.type,f,v)}evaluate(s){const c=this.input.evaluate(s),f=this.beginIndex.evaluate(s);if(!qr(c,["string","array"]))throw new jo(`Expected first argument to be of type array or string, but found ${xr(fr(c))} instead.`);if(this.endIndex){const v=this.endIndex.evaluate(s);return c.slice(f,v)}return c.slice(f)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var od=Jl;function sd(l,s){return"=="===l||"!="===l?"boolean"===s.kind||"string"===s.kind||"number"===s.kind||"null"===s.kind||"value"===s.kind:"string"===s.kind||"number"===s.kind||"value"===s.kind}function Lp(l,s,c,f){return 0===f.compare(s,c)}function Ql(l,s,c){const f="=="!==l&&"!="!==l;return class Z${constructor(C,S,R){this.type=Ui,this.lhs=C,this.rhs=S,this.collator=R,this.hasUntypedArgument="value"===C.type.kind||"value"===S.type.kind}static parse(C,S){if(3!==C.length&&4!==C.length)return S.error("Expected two or three arguments.");const R=C[0];let N=S.parse(C[1],1,Hi);if(!N)return null;if(!sd(R,N.type))return S.concat(1).error(`"${R}" comparisons are not supported for type '${xr(N.type)}'.`);let U=S.parse(C[2],2,Hi);if(!U)return null;if(!sd(R,U.type))return S.concat(2).error(`"${R}" comparisons are not supported for type '${xr(U.type)}'.`);if(N.type.kind!==U.type.kind&&"value"!==N.type.kind&&"value"!==U.type.kind)return S.error(`Cannot compare types '${xr(N.type)}' and '${xr(U.type)}'.`);f&&("value"===N.type.kind&&"value"!==U.type.kind?N=new Gl(U.type,[N]):"value"!==N.type.kind&&"value"===U.type.kind&&(U=new Gl(N.type,[U])));let W=null;if(4===C.length){if("string"!==N.type.kind&&"string"!==U.type.kind&&"value"!==N.type.kind&&"value"!==U.type.kind)return S.error("Cannot use collator to compare non-string types.");if(W=S.parse(C[3],3,Hl),!W)return null}return new Z$(N,U,W)}evaluate(C){const S=this.lhs.evaluate(C),R=this.rhs.evaluate(C);if(f&&this.hasUntypedArgument){const N=fr(S),U=fr(R);if(N.kind!==U.kind||"string"!==N.kind&&"number"!==N.kind)throw new jo(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${N.kind}, ${U.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const N=fr(S),U=fr(R);if("string"!==N.kind||"string"!==U.kind)return s(C,S,R)}return this.collator?c(C,S,R,this.collator.evaluate(C)):s(C,S,R)}eachChild(C){C(this.lhs),C(this.rhs),this.collator&&C(this.collator)}outputDefined(){return!0}serialize(){const C=[l];return this.eachChild(S=>{C.push(S.serialize())}),C}}}const bm=Ql("==",function(l,s,c){return s===c},Lp),Cf=Ql("!=",function(l,s,c){return s!==c},function(l,s,c,f){return!Lp(0,s,c,f)}),Ef=Ql("<",function(l,s,c){return s<c},function(l,s,c,f){return f.compare(s,c)<0}),Zd=Ql(">",function(l,s,c){return s>c},function(l,s,c,f){return f.compare(s,c)>0}),Fp=Ql("<=",function(l,s,c){return s<=c},function(l,s,c,f){return f.compare(s,c)<=0}),ay=Ql(">=",function(l,s,c){return s>=c},function(l,s,c,f){return f.compare(s,c)>=0});class bh{constructor(s,c,f,v,C,S){this.type=Hn,this.number=s,this.locale=c,this.currency=f,this.unit=v,this.minFractionDigits=C,this.maxFractionDigits=S}static parse(s,c){if(3!==s.length)return c.error("Expected two arguments.");const f=c.parse(s[1],1,vn);if(!f)return null;const v=s[2];if("object"!=typeof v||Array.isArray(v))return c.error("NumberFormat options argument must be an object.");let C=null;if(v.locale&&(C=c.parse(v.locale,1,Hn),!C))return null;let S=null;if(v.currency&&(S=c.parse(v.currency,1,Hn),!S))return null;let R=null;if(v.unit&&(R=c.parse(v.unit,1,Hn),!R))return null;let N=null;if(v["min-fraction-digits"]&&(N=c.parse(v["min-fraction-digits"],1,vn),!N))return null;let U=null;return v["max-fraction-digits"]&&(U=c.parse(v["max-fraction-digits"],1,vn),!U)?null:new bh(f,C,S,R,N,U)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(s):void 0,unit:this.unit?this.unit.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.unit&&s(this.unit),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.unit&&(s.unit=this.unit.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]}}class ra{constructor(s){this.type=vn,this.input=s}static parse(s,c){if(2!==s.length)return c.error(`Expected 1 argument, but found ${s.length-1} instead.`);const f=c.parse(s[1],1);return f?"array"!==f.type.kind&&"string"!==f.type.kind&&"value"!==f.type.kind?c.error(`Expected argument of type string or array, but found ${xr(f.type)} instead.`):new ra(f):null}evaluate(s){const c=this.input.evaluate(s);if("string"==typeof c||Array.isArray(c))return c.length;throw new jo(`Expected value to be of type string or array, but found ${xr(fr(c))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){const s=["length"];return this.eachChild(c=>{s.push(c.serialize())}),s}}const wl={"==":bm,"!=":Cf,">":Zd,"<":Ef,">=":ay,"<=":Fp,array:Gl,at:nd,boolean:Gl,case:rd,coalesce:vm,collator:Sc,format:fh,image:Gd,in:Kl,"index-of":au,interpolate:el,"interpolate-hcl":el,"interpolate-lab":el,length:ra,let:bs,literal:Ca,match:xf,number:Gl,"number-format":bh,object:Gl,slice:od,step:$d,string:Gl,"to-boolean":na,"to-color":na,"to-number":na,"to-string":na,var:_l,within:_h};function Or(l,[s,c,f,v]){s=s.evaluate(l),c=c.evaluate(l),f=f.evaluate(l);const C=v?v.evaluate(l):1,S=Nu(s,c,f,C);if(S)throw new jo(S);return new Qi(s/255*C,c/255*C,f/255*C,C)}function ad(l,s){return l in s}function qd(l,s){const c=s[l];return void 0===c?null:c}function Po(l){return{type:l}}tr.register(wl,{error:[{kind:"error"},[Hn],(l,[s])=>{throw new jo(s.evaluate(l))}],typeof:[Hn,[Hi],(l,[s])=>xr(fr(s.evaluate(l)))],"to-rgba":[kr(vn,4),[Ms],(l,[s])=>s.evaluate(l).toArray()],rgb:[Ms,[vn,vn,vn],Or],rgba:[Ms,[vn,vn,vn,vn],Or],has:{type:Ui,overloads:[[[Hn],(l,[s])=>ad(s.evaluate(l),l.properties())],[[Hn,Zn],(l,[s,c])=>ad(s.evaluate(l),c.evaluate(l))]]},get:{type:Hi,overloads:[[[Hn],(l,[s])=>qd(s.evaluate(l),l.properties())],[[Hn,Zn],(l,[s,c])=>qd(s.evaluate(l),c.evaluate(l))]]},"feature-state":[Hi,[Hn],(l,[s])=>qd(s.evaluate(l),l.featureState||{})],properties:[Zn,[],l=>l.properties()],"geometry-type":[Hn,[],l=>l.geometryType()],id:[Hi,[],l=>l.id()],zoom:[vn,[],l=>l.globals.zoom],pitch:[vn,[],l=>l.globals.pitch||0],"distance-from-center":[vn,[],l=>l.distanceFromCenter()],"heatmap-density":[vn,[],l=>l.globals.heatmapDensity||0],"line-progress":[vn,[],l=>l.globals.lineProgress||0],"sky-radial-progress":[vn,[],l=>l.globals.skyRadialProgress||0],accumulated:[Hi,[],l=>void 0===l.globals.accumulated?null:l.globals.accumulated],"+":[vn,Po(vn),(l,s)=>{let c=0;for(const f of s)c+=f.evaluate(l);return c}],"*":[vn,Po(vn),(l,s)=>{let c=1;for(const f of s)c*=f.evaluate(l);return c}],"-":{type:vn,overloads:[[[vn,vn],(l,[s,c])=>s.evaluate(l)-c.evaluate(l)],[[vn],(l,[s])=>-s.evaluate(l)]]},"/":[vn,[vn,vn],(l,[s,c])=>s.evaluate(l)/c.evaluate(l)],"%":[vn,[vn,vn],(l,[s,c])=>s.evaluate(l)%c.evaluate(l)],ln2:[vn,[],()=>Math.LN2],pi:[vn,[],()=>Math.PI],e:[vn,[],()=>Math.E],"^":[vn,[vn,vn],(l,[s,c])=>Math.pow(s.evaluate(l),c.evaluate(l))],sqrt:[vn,[vn],(l,[s])=>Math.sqrt(s.evaluate(l))],log10:[vn,[vn],(l,[s])=>Math.log(s.evaluate(l))/Math.LN10],ln:[vn,[vn],(l,[s])=>Math.log(s.evaluate(l))],log2:[vn,[vn],(l,[s])=>Math.log(s.evaluate(l))/Math.LN2],sin:[vn,[vn],(l,[s])=>Math.sin(s.evaluate(l))],cos:[vn,[vn],(l,[s])=>Math.cos(s.evaluate(l))],tan:[vn,[vn],(l,[s])=>Math.tan(s.evaluate(l))],asin:[vn,[vn],(l,[s])=>Math.asin(s.evaluate(l))],acos:[vn,[vn],(l,[s])=>Math.acos(s.evaluate(l))],atan:[vn,[vn],(l,[s])=>Math.atan(s.evaluate(l))],min:[vn,Po(vn),(l,s)=>Math.min(...s.map(c=>c.evaluate(l)))],max:[vn,Po(vn),(l,s)=>Math.max(...s.map(c=>c.evaluate(l)))],abs:[vn,[vn],(l,[s])=>Math.abs(s.evaluate(l))],round:[vn,[vn],(l,[s])=>{const c=s.evaluate(l);return c<0?-Math.round(-c):Math.round(c)}],floor:[vn,[vn],(l,[s])=>Math.floor(s.evaluate(l))],ceil:[vn,[vn],(l,[s])=>Math.ceil(s.evaluate(l))],"filter-==":[Ui,[Hn,Hi],(l,[s,c])=>l.properties()[s.value]===c.value],"filter-id-==":[Ui,[Hi],(l,[s])=>l.id()===s.value],"filter-type-==":[Ui,[Hn],(l,[s])=>l.geometryType()===s.value],"filter-<":[Ui,[Hn,Hi],(l,[s,c])=>{const f=l.properties()[s.value],v=c.value;return typeof f==typeof v&&f<v}],"filter-id-<":[Ui,[Hi],(l,[s])=>{const c=l.id(),f=s.value;return typeof c==typeof f&&c<f}],"filter->":[Ui,[Hn,Hi],(l,[s,c])=>{const f=l.properties()[s.value],v=c.value;return typeof f==typeof v&&f>v}],"filter-id->":[Ui,[Hi],(l,[s])=>{const c=l.id(),f=s.value;return typeof c==typeof f&&c>f}],"filter-<=":[Ui,[Hn,Hi],(l,[s,c])=>{const f=l.properties()[s.value],v=c.value;return typeof f==typeof v&&f<=v}],"filter-id-<=":[Ui,[Hi],(l,[s])=>{const c=l.id(),f=s.value;return typeof c==typeof f&&c<=f}],"filter->=":[Ui,[Hn,Hi],(l,[s,c])=>{const f=l.properties()[s.value],v=c.value;return typeof f==typeof v&&f>=v}],"filter-id->=":[Ui,[Hi],(l,[s])=>{const c=l.id(),f=s.value;return typeof c==typeof f&&c>=f}],"filter-has":[Ui,[Hi],(l,[s])=>s.value in l.properties()],"filter-has-id":[Ui,[],l=>null!==l.id()&&void 0!==l.id()],"filter-type-in":[Ui,[kr(Hn)],(l,[s])=>s.value.indexOf(l.geometryType())>=0],"filter-id-in":[Ui,[kr(Hi)],(l,[s])=>s.value.indexOf(l.id())>=0],"filter-in-small":[Ui,[Hn,kr(Hi)],(l,[s,c])=>c.value.indexOf(l.properties()[s.value])>=0],"filter-in-large":[Ui,[Hn,kr(Hi)],(l,[s,c])=>function(f,v,C,S){for(;C<=S;){const R=C+S>>1;if(v[R]===f)return!0;v[R]>f?S=R-1:C=R+1}return!1}(l.properties()[s.value],c.value,0,c.value.length-1)],all:{type:Ui,overloads:[[[Ui,Ui],(l,[s,c])=>s.evaluate(l)&&c.evaluate(l)],[Po(Ui),(l,s)=>{for(const c of s)if(!c.evaluate(l))return!1;return!0}]]},any:{type:Ui,overloads:[[[Ui,Ui],(l,[s,c])=>s.evaluate(l)||c.evaluate(l)],[Po(Ui),(l,s)=>{for(const c of s)if(c.evaluate(l))return!0;return!1}]]},"!":[Ui,[Ui],(l,[s])=>!s.evaluate(l)],"is-supported-script":[Ui,[Hn],(l,[s])=>{const c=l.globals&&l.globals.isSupportedScript;return!c||c(s.evaluate(l))}],upcase:[Hn,[Hn],(l,[s])=>s.evaluate(l).toUpperCase()],downcase:[Hn,[Hn],(l,[s])=>s.evaluate(l).toLowerCase()],concat:[Hn,Po(Hi),(l,s)=>s.map(c=>Xh(c.evaluate(l))).join("")],"resolved-locale":[Hn,[Hl],(l,[s])=>s.evaluate(l).resolvedLocale()]});var Wu=wl;function ld(l){return{result:"success",value:l}}function cu(l){return{result:"error",value:l}}function xl(l){return"data-driven"===l["property-type"]}function Ea(l){return!!l.expression&&l.expression.parameters.indexOf("zoom")>-1}function Cl(l){return!!l.expression&&l.expression.interpolated}function ji(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":null===l?"null":typeof l}function Xl(l){return"object"==typeof l&&null!==l&&!Array.isArray(l)}function Tf(l){return l}function tl(l,s){const c="color"===s.type,f=l.stops&&"object"==typeof l.stops[0][0],v=f||!(f||void 0!==l.property),C=l.type||(Cl(s)?"exponential":"interval");if(c&&((l=Ko({},l)).stops&&(l.stops=l.stops.map(U=>[U[0],Qi.parse(U[1])])),l.default=Qi.parse(l.default?l.default:s.default)),l.colorSpace&&"rgb"!==l.colorSpace&&!su[l.colorSpace])throw new Error(`Unknown color space: ${l.colorSpace}`);let S,R,N;if("exponential"===C)S=Rc;else if("interval"===C)S=wm;else if("categorical"===C){S=Os,R=Object.create(null);for(const U of l.stops)R[U[0]]=U[1];N=typeof l.stops[0][0]}else{if("identity"!==C)throw new Error(`Unknown function type "${C}"`);S=Sf}if(f){const U={},W=[];for(let oe=0;oe<l.stops.length;oe++){const le=l.stops[oe],he=le[0].zoom;void 0===U[he]&&(U[he]={zoom:he,type:l.type,property:l.property,default:l.default,stops:[]},W.push(he)),U[he].stops.push([le[0].value,le[1]])}const Q=[];for(const oe of W)Q.push([U[oe].zoom,tl(U[oe],s)]);const ee={name:"linear"};return{kind:"composite",interpolationType:ee,interpolationFactor:el.interpolationFactor.bind(void 0,ee),zoomStops:Q.map(oe=>oe[0]),evaluate:({zoom:oe},le)=>Rc({stops:Q,base:l.base},s,oe).evaluate(oe,le)}}if(v){const U="exponential"===C?{name:"exponential",base:void 0!==l.base?l.base:1}:null;return{kind:"camera",interpolationType:U,interpolationFactor:el.interpolationFactor.bind(void 0,U),zoomStops:l.stops.map(W=>W[0]),evaluate:({zoom:W})=>S(l,s,W,R,N)}}return{kind:"source",evaluate(U,W){const Q=W&&W.properties?W.properties[l.property]:void 0;return void 0===Q?kc(l.default,s.default):S(l,s,Q,R,N)}}}function kc(l,s,c){return void 0!==l?l:void 0!==s?s:void 0!==c?c:void 0}function Os(l,s,c,f,v){return kc(typeof c===v?f[c]:void 0,l.default,s.default)}function wm(l,s,c){if("number"!==ji(c))return kc(l.default,s.default);const f=l.stops.length;if(1===f||c<=l.stops[0][0])return l.stops[0][1];if(c>=l.stops[f-1][0])return l.stops[f-1][1];const v=yl(l.stops.map(C=>C[0]),c);return l.stops[v][1]}function Rc(l,s,c){const f=void 0!==l.base?l.base:1;if("number"!==ji(c))return kc(l.default,s.default);const v=l.stops.length;if(1===v||c<=l.stops[0][0])return l.stops[0][1];if(c>=l.stops[v-1][0])return l.stops[v-1][1];const C=yl(l.stops.map(W=>W[0]),c),S=function(W,Q,ee,oe){const le=oe-ee,he=W-ee;return 0===le?0:1===Q?he/le:(Math.pow(Q,he)-1)/(Math.pow(Q,le)-1)}(c,f,l.stops[C][0],l.stops[C+1][0]),R=l.stops[C][1],N=l.stops[C+1][1];let U=Hu[s.type]||Tf;if(l.colorSpace&&"rgb"!==l.colorSpace){const W=su[l.colorSpace];U=(Q,ee)=>W.reverse(W.interpolate(W.forward(Q),W.forward(ee),S))}return"function"==typeof R.evaluate?{evaluate(...W){const Q=R.evaluate.apply(void 0,W),ee=N.evaluate.apply(void 0,W);if(void 0!==Q&&void 0!==ee)return U(Q,ee,S)}}:U(R,N,S)}function Sf(l,s,c){return"color"===s.type?c=Qi.parse(c):"formatted"===s.type?c=uo.fromString(c.toString()):"resolvedImage"===s.type?c=ko.fromString(c.toString()):ji(c)===s.type||"enum"===s.type&&s.values[c]||(c=void 0),kc(c,l.default,s.default)}class wh{constructor(s,c){var f;this.expression=s,this._warningHistory={},this._evaluator=new ed,this._defaultValue=c?"color"===(f=c).type&&(Xl(f.default)||Array.isArray(f.default))?new Qi(0,0,0,0):"color"===f.type?Qi.parse(f.default)||null:void 0===f.default?null:f.default:null,this._enumValues=c&&"enum"===c.type?c.values:null}evaluateWithoutErrorHandling(s,c,f,v,C,S,R,N){return this._evaluator.globals=s,this._evaluator.feature=c,this._evaluator.featureState=f,this._evaluator.canonical=v||null,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=S,this._evaluator.featureTileCoord=R||null,this._evaluator.featureDistanceData=N||null,this.expression.evaluate(this._evaluator)}evaluate(s,c,f,v,C,S,R,N){this._evaluator.globals=s,this._evaluator.feature=c||null,this._evaluator.featureState=f||null,this._evaluator.canonical=v||null,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=S||null,this._evaluator.featureTileCoord=R||null,this._evaluator.featureDistanceData=N||null;try{const U=this.expression.evaluate(this._evaluator);if(null==U||"number"==typeof U&&U!=U)return this._defaultValue;if(this._enumValues&&!(U in this._enumValues))throw new jo(`Expected value to be one of ${Object.keys(this._enumValues).map(W=>JSON.stringify(W)).join(", ")}, but found ${JSON.stringify(U)} instead.`);return U}catch(U){return this._warningHistory[U.message]||(this._warningHistory[U.message]=!0,typeof console<"u"&&console.warn(U.message)),this._defaultValue}}}function Ta(l){return Array.isArray(l)&&l.length>0&&"string"==typeof l[0]&&l[0]in Wu}function Pc(l,s){const c=new Oa(Wu,[],s?function(v){const C={color:Ms,string:Hn,number:vn,enum:Hn,boolean:Ui,formatted:pl,resolvedImage:$s};return"array"===v.type?kr(C[v.value]||Hi,v.length):C[v.type]}(s):void 0),f=c.parse(l,void 0,void 0,void 0,s&&"string"===s.type?{typeAnnotation:"coerce"}:void 0);return f?ld(new wh(f,s)):cu(c.errors)}class Eo{constructor(s,c){this.kind=s,this._styleExpression=c,this.isStateDependent="constant"!==s&&!Uu(c.expression)}evaluateWithoutErrorHandling(s,c,f,v,C,S){return this._styleExpression.evaluateWithoutErrorHandling(s,c,f,v,C,S)}evaluate(s,c,f,v,C,S){return this._styleExpression.evaluate(s,c,f,v,C,S)}}class El{constructor(s,c,f,v){this.kind=s,this.zoomStops=f,this._styleExpression=c,this.isStateDependent="camera"!==s&&!Uu(c.expression),this.interpolationType=v}evaluateWithoutErrorHandling(s,c,f,v,C,S){return this._styleExpression.evaluateWithoutErrorHandling(s,c,f,v,C,S)}evaluate(s,c,f,v,C,S){return this._styleExpression.evaluate(s,c,f,v,C,S)}interpolationFactor(s,c,f){return this.interpolationType?el.interpolationFactor(this.interpolationType,s,c,f):0}}function qs(l,s){if("error"===(l=Pc(l,s)).result)return l;const c=l.value.expression,f=_o(c);if(!f&&!xl(s))return cu([new Pi("","data expressions not supported")]);const v=Pa(c,["zoom","pitch","distance-from-center"]);if(!v&&!Ea(s))return cu([new Pi("","zoom expressions not supported")]);const C=oa(c);return C||v?C instanceof Pi?cu([C]):C instanceof el&&!Cl(s)?cu([new Pi("",'"interpolate" expressions cannot be used with this property')]):ld(C?new El(f?"camera":"composite",l.value,C.labels,C instanceof el?C.interpolation:void 0):new Eo(f?"constant":"source",l.value)):cu([new Pi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Oc{constructor(s,c){this._parameters=s,this._specification=c,Ko(this,tl(this._parameters,this._specification))}static deserialize(s){return new Oc(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function oa(l){let s=null;if(l instanceof bs)s=oa(l.result);else if(l instanceof vm){for(const c of l.args)if(s=oa(c),s)break}else(l instanceof $d||l instanceof el)&&l.input instanceof tr&&"zoom"===l.input.name&&(s=l);return s instanceof Pi||l.eachChild(c=>{const f=oa(c);f instanceof Pi?s=f:!s&&f?s=new Pi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&f&&s!==f&&(s=new Pi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}class An{constructor(s,c,f,v){this.message=(s?`${s}: `:"")+f,v&&(this.identifier=v),null!=c&&c.__line__&&(this.line=c.__line__)}}function _a(l){const s=l.key,c=l.value,f=l.valueSpec||{},v=l.objectElementValidators||{},C=l.style,S=l.styleSpec;let R=[];const N=ji(c);if("object"!==N)return[new An(s,c,`object expected, ${N} found`)];for(const U in c){const W=U.split(".")[0];let ee;v[W]?ee=v[W]:f[W]?ee=Ls:v["*"]?ee=v["*"]:f["*"]&&(ee=Ls),ee?R=R.concat(ee({key:(s&&`${s}.`)+U,value:c[U],valueSpec:f[W]||f["*"],style:C,styleSpec:S,object:c,objectKey:U},c)):R.push(new An(s,c[U],`unknown property "${U}"`))}for(const U in f)v[U]||f[U].required&&void 0===f[U].default&&void 0===c[U]&&R.push(new An(s,c,`missing required property "${U}"`));return R}function uu(l){const s=l.value,c=l.valueSpec,f=l.style,v=l.styleSpec,C=l.key,S=l.arrayElementValidator||Ls;if("array"!==ji(s))return[new An(C,s,`array expected, ${ji(s)} found`)];if(c.length&&s.length!==c.length)return[new An(C,s,`array length ${c.length} expected, length ${s.length} found`)];if(c["min-length"]&&s.length<c["min-length"])return[new An(C,s,`array length at least ${c["min-length"]} expected, length ${s.length} found`)];let R={type:c.value,values:c.values,minimum:c.minimum,maximum:c.maximum,function:void 0};v.$version<7&&(R.function=c.function),"object"===ji(c.value)&&(R=c.value);let N=[];for(let U=0;U<s.length;U++)N=N.concat(S({array:s,arrayIndex:U,value:s[U],valueSpec:R,style:f,styleSpec:v,key:`${C}[${U}]`}));return N}function xh(l){const s=l.key,c=l.value,f=l.valueSpec;let v=ji(c);if("number"===v&&c!=c&&(v="NaN"),"number"!==v)return[new An(s,c,`number expected, ${v} found`)];if("minimum"in f){let C=f.minimum;if("array"===ji(f.minimum)&&(C=f.minimum[l.arrayIndex]),c<C)return[new An(s,c,`${c} is less than the minimum value ${C}`)]}if("maximum"in f){let C=f.maximum;if("array"===ji(f.maximum)&&(C=f.maximum[l.arrayIndex]),c>C)return[new An(s,c,`${c} is greater than the maximum value ${C}`)]}return[]}function nl(l){const s=l.valueSpec,c=Sr(l.value.type);let f,v,C,S={};const R="categorical"!==c&&void 0===l.value.property,N=!R,U="array"===ji(l.value.stops)&&"array"===ji(l.value.stops[0])&&"object"===ji(l.value.stops[0][0]),W=_a({key:l.key,value:l.value,valueSpec:l.styleSpec.function,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{stops:function(oe){if("identity"===c)return[new An(oe.key,oe.value,'identity function may not have a "stops" property')];let le=[];const he=oe.value;return le=le.concat(uu({key:oe.key,value:he,valueSpec:oe.valueSpec,style:oe.style,styleSpec:oe.styleSpec,arrayElementValidator:Q})),"array"===ji(he)&&0===he.length&&le.push(new An(oe.key,he,"array must have at least one stop")),le},default:function(oe){return Ls({key:oe.key,value:oe.value,valueSpec:s,style:oe.style,styleSpec:oe.styleSpec})}}});return"identity"===c&&R&&W.push(new An(l.key,l.value,'missing required property "property"')),"identity"===c||l.value.stops||W.push(new An(l.key,l.value,'missing required property "stops"')),"exponential"===c&&l.valueSpec.expression&&!Cl(l.valueSpec)&&W.push(new An(l.key,l.value,"exponential functions not supported")),l.styleSpec.$version>=8&&(N&&!xl(l.valueSpec)?W.push(new An(l.key,l.value,"property functions not supported")):R&&!Ea(l.valueSpec)&&W.push(new An(l.key,l.value,"zoom functions not supported"))),"categorical"!==c&&!U||void 0!==l.value.property||W.push(new An(l.key,l.value,'"property" property is required')),W;function Q(oe){let le=[];const he=oe.value,Ie=oe.key;if("array"!==ji(he))return[new An(Ie,he,`array expected, ${ji(he)} found`)];if(2!==he.length)return[new An(Ie,he,`array length 2 expected, length ${he.length} found`)];if(U){if("object"!==ji(he[0]))return[new An(Ie,he,`object expected, ${ji(he[0])} found`)];if(void 0===he[0].zoom)return[new An(Ie,he,"object stop key must have zoom")];if(void 0===he[0].value)return[new An(Ie,he,"object stop key must have value")];const Le=Sr(he[0].zoom);if("number"!=typeof Le)return[new An(Ie,he[0].zoom,"stop zoom values must be numbers")];if(C&&C>Le)return[new An(Ie,he[0].zoom,"stop zoom values must appear in ascending order")];Le!==C&&(C=Le,v=void 0,S={}),le=le.concat(_a({key:`${Ie}[0]`,value:he[0],valueSpec:{zoom:{}},style:oe.style,styleSpec:oe.styleSpec,objectElementValidators:{zoom:xh,value:ee}}))}else le=le.concat(ee({key:`${Ie}[0]`,value:he[0],valueSpec:{},style:oe.style,styleSpec:oe.styleSpec},he));return Ta(Vn(he[1]))?le.concat([new An(`${Ie}[1]`,he[1],"expressions are not allowed in function stops.")]):le.concat(Ls({key:`${Ie}[1]`,value:he[1],valueSpec:s,style:oe.style,styleSpec:oe.styleSpec}))}function ee(oe,le){const he=ji(oe.value),Ie=Sr(oe.value),Le=null!==oe.value?oe.value:le;if(f){if(he!==f)return[new An(oe.key,Le,`${he} stop domain type must match previous stop domain type ${f}`)]}else f=he;if("number"!==he&&"string"!==he&&"boolean"!==he&&"number"!=typeof Ie&&"string"!=typeof Ie&&"boolean"!=typeof Ie)return[new An(oe.key,Le,"stop domain value must be a number, string, or boolean")];if("number"!==he&&"categorical"!==c){let ve=`number expected, ${he} found`;return xl(s)&&void 0===c&&(ve+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new An(oe.key,Le,ve)]}return"categorical"!==c||"number"!==he||"number"==typeof Ie&&isFinite(Ie)&&Math.floor(Ie)===Ie?"categorical"!==c&&"number"===he&&"number"==typeof Ie&&"number"==typeof v&&void 0!==v&&Ie<v?[new An(oe.key,Le,"stop domain values must appear in ascending order")]:(v=Ie,"categorical"===c&&Ie in S?[new An(oe.key,Le,"stop domain values must be unique")]:(S[Ie]=!0,[])):[new An(oe.key,Le,`integer expected, found ${String(Ie)}`)]}}function il(l){const s=("property"===l.expressionContext?qs:Pc)(Vn(l.value),l.valueSpec);if("error"===s.result)return s.value.map(f=>new An(`${l.key}${f.key}`,l.value,f.message));const c=s.value.expression||s.value._styleExpression.expression;if("property"===l.expressionContext&&"text-font"===l.propertyKey&&!c.outputDefined())return[new An(l.key,l.value,`Invalid data expression for "${l.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===l.expressionContext&&"layout"===l.propertyType&&!Uu(c))return[new An(l.key,l.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===l.expressionContext)return ec(c,l);if(l.expressionContext&&0===l.expressionContext.indexOf("cluster")){if(!Pa(c,["zoom","feature-state"]))return[new An(l.key,l.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===l.expressionContext&&!_o(c))return[new An(l.key,l.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ec(l,s){const c=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(const v of s.valueSpec.expression.parameters)c.delete(v);if(0===c.size)return[];const f=[];return l instanceof tr&&c.has(l.name)?[new An(s.key,s.value,`["${l.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(l.eachChild(v=>{f.push(...ec(v,s))}),f)}function Tl(l){const s=l.key,c=l.value,f=l.valueSpec,v=[];return Array.isArray(f.values)?-1===f.values.indexOf(Sr(c))&&v.push(new An(s,c,`expected one of [${f.values.join(", ")}], ${JSON.stringify(c)} found`)):-1===Object.keys(f.values).indexOf(Sr(c))&&v.push(new An(s,c,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(c)} found`)),v}function Ch(l){if(!0===l||!1===l)return!0;if(!Array.isArray(l)||0===l.length)return!1;switch(l[0]){case"has":return l.length>=2&&"$id"!==l[1]&&"$type"!==l[1];case"in":return l.length>=3&&("string"!=typeof l[1]||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==l.length||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const s of l.slice(1))if(!Ch(s)&&"boolean"!=typeof s)return!1;return!0;default:return!0}}function La(l,s="fill"){if(null==l)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ch(l)||(l=hu(l));const c=l;let f=!0;try{f=function(U){if(!us(U))return U;let W=Vn(U);return ws(W),W=Lc(W),W}(c)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(c,null,2)}\n        `)}const v=Rt[`filter_${s}`],C=Pc(f,v);let S=null;if("error"===C.result)throw new Error(C.value.map(U=>`${U.key}: ${U.message}`).join(", "));S=(U,W,Q)=>C.value.evaluate(U,W,{},Q);let R=null,N=null;if(f!==c){const U=Pc(c,v);if("error"===U.result)throw new Error(U.value.map(W=>`${W.key}: ${W.message}`).join(", "));R=(W,Q,ee,oe,le)=>U.value.evaluate(W,Q,{},ee,void 0,void 0,oe,le),N=!_o(U.value.expression)}return{filter:S,dynamicFilter:R||void 0,needGeometry:cd(f),needFeature:!!N}}function Lc(l){if(!Array.isArray(l))return l;const s=function(c){if(Fa.has(c[0]))for(let f=1;f<c.length;f++)if(us(c[f]))return!0;return c}(l);return!0===s?s:s.map(c=>Lc(c))}function ws(l){let s=!1;const c=[];if("case"===l[0]){for(let f=1;f<l.length-1;f+=2)s=s||us(l[f]),c.push(l[f+1]);c.push(l[l.length-1])}else if("match"===l[0]){s=s||us(l[1]);for(let f=2;f<l.length-1;f+=2)c.push(l[f+1]);c.push(l[l.length-1])}else if("step"===l[0]){s=s||us(l[1]);for(let f=1;f<l.length-1;f+=2)c.push(l[f+1])}s&&(l.length=0,l.push("any",...c));for(let f=1;f<l.length;f++)ws(l[f])}function us(l){if(!Array.isArray(l))return!1;if("pitch"===(s=l[0])||"distance-from-center"===s)return!0;var s;for(let c=1;c<l.length;c++)if(us(l[c]))return!0;return!1}const Fa=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Zu(l,s){return l<s?-1:l>s?1:0}function cd(l){if(!Array.isArray(l))return!1;if("within"===l[0])return!0;for(let s=1;s<l.length;s++)if(cd(l[s]))return!0;return!1}function hu(l){if(!l)return!0;const s=l[0];return l.length<=1?"any"!==s:"=="===s?Eh(l[1],l[2],"=="):"!="===s?tc(Eh(l[1],l[2],"==")):"<"===s||">"===s||"<="===s||">="===s?Eh(l[1],l[2],s):"any"===s?(c=l.slice(1),["any"].concat(c.map(hu))):"all"===s?["all"].concat(l.slice(1).map(hu)):"none"===s?["all"].concat(l.slice(1).map(hu).map(tc)):"in"===s?du(l[1],l.slice(2)):"!in"===s?tc(du(l[1],l.slice(2))):"has"===s?Kd(l[1]):"!has"===s?tc(Kd(l[1])):"within"!==s||l;var c}function Eh(l,s,c){switch(l){case"$type":return[`filter-type-${c}`,s];case"$id":return[`filter-id-${c}`,s];default:return[`filter-${c}`,l,s]}}function du(l,s){if(0===s.length)return!1;switch(l){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(c=>typeof c!=typeof s[0])?["filter-in-large",l,["literal",s.sort(Zu)]]:["filter-in-small",l,["literal",s]]}}function Kd(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function tc(l){return["!",l]}function qu(l){return Ch(Vn(l.value))?il(Ko({},l,{expressionContext:"filter",valueSpec:l.styleSpec[`filter_${l.layerType||"fill"}`]})):Na(l)}function Na(l){const s=l.value,c=l.key;if("array"!==ji(s))return[new An(c,s,`array expected, ${ji(s)} found`)];const f=l.styleSpec;let v,C=[];if(s.length<1)return[new An(c,s,"filter array must have at least 1 element")];switch(C=C.concat(Tl({key:`${c}[0]`,value:s[0],valueSpec:f.filter_operator,style:l.style,styleSpec:l.styleSpec})),Sr(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&"$type"===Sr(s[1])&&C.push(new An(c,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":3!==s.length&&C.push(new An(c,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(v=ji(s[1]),"string"!==v&&C.push(new An(`${c}[1]`,s[1],`string expected, ${v} found`)));for(let S=2;S<s.length;S++)v=ji(s[S]),"$type"===Sr(s[1])?C=C.concat(Tl({key:`${c}[${S}]`,value:s[S],valueSpec:f.geometry_type,style:l.style,styleSpec:l.styleSpec})):"string"!==v&&"number"!==v&&"boolean"!==v&&C.push(new An(`${c}[${S}]`,s[S],`string, number, or boolean expected, ${v} found`));break;case"any":case"all":case"none":for(let S=1;S<s.length;S++)C=C.concat(Na({key:`${c}[${S}]`,value:s[S],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":v=ji(s[1]),2!==s.length?C.push(new An(c,s,`filter array for "${s[0]}" operator must have 2 elements`)):"string"!==v&&C.push(new An(`${c}[1]`,s[1],`string expected, ${v} found`));break;case"within":v=ji(s[1]),2!==s.length?C.push(new An(c,s,`filter array for "${s[0]}" operator must have 2 elements`)):"object"!==v&&C.push(new An(`${c}[1]`,s[1],`object expected, ${v} found`))}return C}function ud(l,s){const c=l.key,f=l.style,v=l.styleSpec,C=l.value,S=l.objectKey,R=v[`${s}_${l.layerType}`];if(!R)return[];const N=S.match(/^(.*)-transition$/);if("paint"===s&&N&&R[N[1]]&&R[N[1]].transition)return Ls({key:c,value:C,valueSpec:v.transition,style:f,styleSpec:v});const U=l.valueSpec||R[S];if(!U)return[new An(c,C,`unknown property "${S}"`)];let W;if("string"===ji(C)&&xl(U)&&!U.tokens&&(W=/^{([^}]+)}$/.exec(C))){const ee=`\`{ "type": "identity", "property": ${W?JSON.stringify(W[1]):'"_"'} }\``;return[new An(c,C,`"${S}" does not support interpolation syntax\nUse an identity property function instead: ${ee}.`)]}const Q=[];return"symbol"===l.layerType&&("text-field"===S&&f&&!f.glyphs&&Q.push(new An(c,C,'use of "text-field" requires a style "glyphs" property')),"text-font"===S&&Xl(Vn(C))&&"identity"===Sr(C.type)&&Q.push(new An(c,C,'"text-font" does not support identity functions'))),Q.concat(Ls({key:l.key,value:C,valueSpec:U,style:f,styleSpec:v,expressionContext:"property",propertyType:s,propertyKey:S}))}function Fc(l){return ud(l,"paint")}function za(l){return ud(l,"layout")}function hd(l){let s=[];const c=l.value,f=l.key,v=l.style,C=l.styleSpec;c.type||c.ref||s.push(new An(f,c,'either "type" or "ref" is required'));let S=Sr(c.type);const R=Sr(c.ref);if(c.id){const N=Sr(c.id);for(let U=0;U<l.arrayIndex;U++){const W=v.layers[U];Sr(W.id)===N&&s.push(new An(f,c.id,`duplicate layer id "${c.id}", previously used at line ${W.id.__line__}`))}}if("ref"in c){let N;["type","source","source-layer","filter","layout"].forEach(U=>{U in c&&s.push(new An(f,c[U],`"${U}" is prohibited for ref layers`))}),v.layers.forEach(U=>{Sr(U.id)===R&&(N=U)}),N?N.ref?s.push(new An(f,c.ref,"ref cannot reference another ref layer")):S=Sr(N.type):"string"==typeof R&&s.push(new An(f,c.ref,`ref layer "${R}" not found`))}else if("background"!==S&&"sky"!==S)if(c.source){const N=v.sources&&v.sources[c.source],U=N&&Sr(N.type);N?"vector"===U&&"raster"===S?s.push(new An(f,c.source,`layer "${c.id}" requires a raster source`)):"raster"===U&&"raster"!==S?s.push(new An(f,c.source,`layer "${c.id}" requires a vector source`)):"vector"!==U||c["source-layer"]?"raster-dem"===U&&"hillshade"!==S?s.push(new An(f,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==S||!c.paint||!c.paint["line-gradient"]&&!c.paint["line-trim-offset"]||"geojson"===U&&N.lineMetrics||s.push(new An(f,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new An(f,c,`layer "${c.id}" must specify a "source-layer"`)):s.push(new An(f,c.source,`source "${c.source}" not found`))}else s.push(new An(f,c,'missing required property "source"'));return s=s.concat(_a({key:f,value:c,valueSpec:C.layer,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ls({key:`${f}.type`,value:c.type,valueSpec:C.layer.type,style:l.style,styleSpec:l.styleSpec,object:c,objectKey:"type"}),filter:N=>qu(Ko({layerType:S},N)),layout:N=>_a({layer:c,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":U=>za(Ko({layerType:S},U))}}),paint:N=>_a({layer:c,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":U=>Fc(Ko({layerType:S},U))}})}})),s}function Nc(l){const s=l.value,c=l.key,f=ji(s);return"string"!==f?[new An(c,s,`string expected, ${f} found`)]:[]}const Ks={promoteId:function({key:l,value:s}){if("string"===ji(s))return Nc({key:l,value:s});{const c=[];for(const f in s)c.push(...Nc({key:`${l}.${f}`,value:s[f]}));return c}}};function Sa(l){const s=l.value,c=l.key,f=l.styleSpec,v=l.style;if(!s.type)return[new An(c,s,'"type" is required')];const C=Sr(s.type);let S;switch(C){case"vector":case"raster":case"raster-dem":return S=_a({key:c,value:s,valueSpec:f[`source_${C.replace("-","_")}`],style:l.style,styleSpec:f,objectElementValidators:Ks}),S;case"geojson":if(S=_a({key:c,value:s,valueSpec:f.source_geojson,style:v,styleSpec:f,objectElementValidators:Ks}),s.cluster)for(const R in s.clusterProperties){const[N,U]=s.clusterProperties[R],W="string"==typeof N?[N,["accumulated"],["get",R]]:N;S.push(...il({key:`${c}.${R}.map`,value:U,expressionContext:"cluster-map"})),S.push(...il({key:`${c}.${R}.reduce`,value:W,expressionContext:"cluster-reduce"}))}return S;case"video":return _a({key:c,value:s,valueSpec:f.source_video,style:v,styleSpec:f});case"image":return _a({key:c,value:s,valueSpec:f.source_image,style:v,styleSpec:f});case"canvas":return[new An(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Tl({key:`${c}.type`,value:s.type,valueSpec:{values:If(f)},style:v,styleSpec:f})}}function If(l){return l.source.reduce((s,c)=>{const f=l[c];return"enum"===f.type.type&&(s=s.concat(Object.keys(f.type.values))),s},[])}function dd(l){const s=l.value,c=l.styleSpec,f=c.light,v=l.style;let C=[];const S=ji(s);if(void 0===s)return C;if("object"!==S)return C=C.concat([new An("light",s,`object expected, ${S} found`)]),C;for(const R in s){const N=R.match(/^(.*)-transition$/);C=C.concat(N&&f[N[1]]&&f[N[1]].transition?Ls({key:R,value:s[R],valueSpec:c.transition,style:v,styleSpec:c}):f[R]?Ls({key:R,value:s[R],valueSpec:f[R],style:v,styleSpec:c}):[new An(R,s[R],`unknown property "${R}"`)])}return C}function zc(l){const s=l.value,c=l.key,f=l.style,v=l.styleSpec,C=v.terrain;let S=[];const R=ji(s);if(void 0===s)return S;if("object"!==R)return S=S.concat([new An("terrain",s,`object expected, ${R} found`)]),S;for(const N in s){const U=N.match(/^(.*)-transition$/);S=S.concat(U&&C[U[1]]&&C[U[1]].transition?Ls({key:N,value:s[N],valueSpec:v.transition,style:f,styleSpec:v}):C[N]?Ls({key:N,value:s[N],valueSpec:C[N],style:f,styleSpec:v}):[new An(N,s[N],`unknown property "${N}"`)])}if(s.source){const N=f.sources&&f.sources[s.source],U=N&&Sr(N.type);N?"raster-dem"!==U&&S.push(new An(c,s.source,`terrain cannot be used with a source of type ${String(U)}, it only be used with a "raster-dem" source type`)):S.push(new An(c,s.source,`source "${s.source}" not found`))}else S.push(new An(c,s,'terrain is missing required property "source"'));return S}function Np(l){const s=l.value,c=l.style,f=l.styleSpec,v=f.fog;let C=[];const S=ji(s);if(void 0===s)return C;if("object"!==S)return C=C.concat([new An("fog",s,`object expected, ${S} found`)]),C;for(const R in s){const N=R.match(/^(.*)-transition$/);C=C.concat(N&&v[N[1]]&&v[N[1]].transition?Ls({key:R,value:s[R],valueSpec:f.transition,style:c,styleSpec:f}):v[R]?Ls({key:R,value:s[R],valueSpec:v[R],style:c,styleSpec:f}):[new An(R,s[R],`unknown property "${R}"`)])}return C}const Ku={"*":()=>[],array:uu,boolean:function(l){const s=l.value,c=l.key,f=ji(s);return"boolean"!==f?[new An(c,s,`boolean expected, ${f} found`)]:[]},number:xh,color:function(l){const s=l.key,c=l.value,f=ji(c);return"string"!==f?[new An(s,c,`color expected, ${f} found`)]:null===Ki(c)?[new An(s,c,`color expected, "${c}" found`)]:[]},enum:Tl,filter:qu,function:nl,layer:hd,object:_a,source:Sa,light:dd,terrain:zc,fog:Np,string:Nc,formatted:function(l){return 0===Nc(l).length?[]:il(l)},resolvedImage:function(l){return 0===Nc(l).length?[]:il(l)},projection:function(l){const s=l.value,c=l.styleSpec,f=c.projection,v=l.style;let C=[];const S=ji(s);if("object"===S)for(const R in s)C=C.concat(Ls({key:R,value:s[R],valueSpec:f[R],style:v,styleSpec:c}));else"string"!==S&&(C=C.concat([new An("projection",s,`object or string expected, ${S} found`)]));return C}};function Ls(l){const s=l.value,c=l.valueSpec,f=l.styleSpec;return c.expression&&Xl(Sr(s))?nl(l):c.expression&&Ta(Vn(s))?il(l):c.type&&Ku[c.type]?Ku[c.type](l):_a(Ko({},l,{valueSpec:c.type?f[c.type]:c}))}function Bc(l){const s=l.value,c=l.key,f=Nc(l);return f.length||(-1===s.indexOf("{fontstack}")&&f.push(new An(c,s,'"glyphs" url must include a "{fontstack}" token')),-1===s.indexOf("{range}")&&f.push(new An(c,s,'"glyphs" url must include a "{range}" token'))),f}function Th(l,s=Rt){return Sl(Ls({key:"",value:l,valueSpec:s.$root,styleSpec:s,style:l,objectElementValidators:{glyphs:Bc,"*":()=>[]}}))}const Yu=l=>Sl(Fc(l)),Yd=l=>Sl(za(l));function Sl(l){return l.slice().sort((s,c)=>s.line&&c.line?s.line-c.line:0)}function Ju(l,s){let c=!1;if(s&&s.length)for(const f of s)l.fire(new Mr(new Error(f.message))),c=!0;return c}var Qu=Vc;function Vc(l,s,c){var f=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;var v=new Int32Array(this.arrayBuffer);l=v[0],this.d=(s=v[1])+2*(c=v[2]);for(var C=0;C<this.d*this.d;C++){var S=v[3+C],R=v[3+C+1];f.push(S===R?null:v.subarray(S,R))}var N=v[3+f.length+1];this.keys=v.subarray(v[3+f.length],N),this.bboxes=v.subarray(N),this.insert=this._insertReadonly}else{this.d=s+2*c;for(var U=0;U<this.d*this.d;U++)f.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=l,this.padding=c,this.scale=s/l,this.uid=0;var W=c/s*l;this.min=-W,this.max=l+W}Vc.prototype.insert=function(l,s,c,f,v){this._forEachCell(s,c,f,v,this._insertCell,this.uid++),this.keys.push(l),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(v)},Vc.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Vc.prototype._insertCell=function(l,s,c,f,v,C){this.cells[v].push(C)},Vc.prototype.query=function(l,s,c,f,v){var C=this.min,S=this.max;if(l<=C&&s<=C&&S<=c&&S<=f&&!v)return Array.prototype.slice.call(this.keys);var R=[];return this._forEachCell(l,s,c,f,this._queryCell,R,{},v),R},Vc.prototype._queryCell=function(l,s,c,f,v,C,S,R){var N=this.cells[v];if(null!==N)for(var U=this.keys,W=this.bboxes,Q=0;Q<N.length;Q++){var ee=N[Q];if(void 0===S[ee]){var oe=4*ee;(R?R(W[oe+0],W[oe+1],W[oe+2],W[oe+3]):l<=W[oe+2]&&s<=W[oe+3]&&c>=W[oe+0]&&f>=W[oe+1])?(S[ee]=!0,C.push(U[ee])):S[ee]=!1}}},Vc.prototype._forEachCell=function(l,s,c,f,v,C,S,R){for(var N=this._convertToCellCoord(l),U=this._convertToCellCoord(s),W=this._convertToCellCoord(c),Q=this._convertToCellCoord(f),ee=N;ee<=W;ee++)for(var oe=U;oe<=Q;oe++){var le=this.d*oe+ee;if((!R||R(this._convertFromCellCoord(ee),this._convertFromCellCoord(oe),this._convertFromCellCoord(ee+1),this._convertFromCellCoord(oe+1)))&&v.call(this,l,s,c,f,le,C,S,R))return}},Vc.prototype._convertFromCellCoord=function(l){return(l-this.padding)/this.scale},Vc.prototype._convertToCellCoord=function(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))},Vc.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,s=3+this.cells.length+1+1,c=0,f=0;f<this.cells.length;f++)c+=this.cells[f].length;var v=new Int32Array(s+c+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var C=s,S=0;S<l.length;S++){var R=l[S];v[3+S]=C,v.set(R,C),C+=R.length}return v[3+l.length]=C,v.set(this.keys,C),v[3+l.length+1]=C+=this.keys.length,v.set(this.bboxes,C),C+=this.bboxes.length,v.buffer};const Cr={};function Rn(l,s,c={}){Object.defineProperty(l,"_classRegistryKey",{value:s,writeable:!1}),Cr[s]={klass:l,omit:c.omit||[]}}Rn(Object,"Object"),Qu.serialize=function(l,s){const c=l.toArrayBuffer();return s&&s.push(c),{buffer:c}},Qu.deserialize=function(l){return new Qu(l.buffer)},Object.defineProperty(Qu,"name",{value:"Grid"}),Rn(Qu,"Grid"),Rn(Qi,"Color"),Rn(Error,"Error"),Rn(Ur,"AJAXError"),Rn(ko,"ResolvedImage"),Rn(Oc,"StylePropertyFunction"),Rn(wh,"StyleExpression",{omit:["_evaluator"]}),Rn(El,"ZoomDependentExpression"),Rn(Eo,"ZoomConstantExpression"),Rn(tr,"CompoundExpression",{omit:["_evaluate"]});for(const l in Wu)Cr[Wu[l]._classRegistryKey]||Rn(Wu[l],`Expression${l}`);function Jd(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&"ArrayBuffer"===l.constructor.name)}function pd(l){return ze.ImageBitmap&&l instanceof ze.ImageBitmap}function Uc(l,s){if(null==l||"boolean"==typeof l||"number"==typeof l||"string"==typeof l||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp)return l;if(Jd(l)||pd(l))return s&&s.push(l),l;if(ArrayBuffer.isView(l)){const c=l;return s&&s.push(c.buffer),c}if(l instanceof ze.ImageData)return s&&s.push(l.data.buffer),l;if(Array.isArray(l)){const c=[];for(const f of l)c.push(Uc(f,s));return c}if("object"==typeof l){const c=l.constructor,f=c._classRegistryKey;if(!f)throw new Error(`can't serialize object of unregistered class ${f}`);const v=c.serialize?c.serialize(l,s):{};if(!c.serialize){for(const C in l)l.hasOwnProperty(C)&&(Cr[f].omit.indexOf(C)>=0||(v[C]=Uc(l[C],s)));l instanceof Error&&(v.message=l.message)}if(v.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==f&&(v.$name=f),v}throw new Error("can't serialize object of type "+typeof l)}function nc(l){if(null==l||"boolean"==typeof l||"number"==typeof l||"string"==typeof l||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||Jd(l)||pd(l)||ArrayBuffer.isView(l)||l instanceof ze.ImageData)return l;if(Array.isArray(l))return l.map(nc);if("object"==typeof l){const s=l.$name||"Object",{klass:c}=Cr[s];if(!c)throw new Error(`can't deserialize unregistered class ${s}`);if(c.deserialize)return c.deserialize(l);const f=Object.create(c.prototype);for(const v of Object.keys(l))"$name"!==v&&(f[v]=nc(l[v]));return f}throw new Error("can't deserialize object of type "+typeof l)}const Sh=l=>l>=1536&&l<=1791,Df=l=>l>=1872&&l<=1919,ic=l=>l>=2208&&l<=2303,Af=l=>l>=11904&&l<=12031,rc=l=>l>=12032&&l<=12255,To=l=>l>=12272&&l<=12287,Hc=l=>l>=12288&&l<=12351,oc=l=>l>=12352&&l<=12447,pu=l=>l>=12448&&l<=12543,hs=l=>l>=12544&&l<=12591,Il=l=>l>=12704&&l<=12735,Mf=l=>l>=12736&&l<=12783,fd=l=>l>=12784&&l<=12799,Xu=l=>l>=12800&&l<=13055,kf=l=>l>=13056&&l<=13311,zp=l=>l>=13312&&l<=19903,fu=l=>l>=19968&&l<=40959,Qd=l=>l>=40960&&l<=42127,Ys=l=>l>=42128&&l<=42191,Xd=l=>l>=44032&&l<=55215,Oo=l=>l>=63744&&l<=64255,Qr=l=>l>=64336&&l<=65023,qn=l=>l>=65040&&l<=65055,w=l=>l>=65072&&l<=65103,h=l=>l>=65104&&l<=65135,_=l=>l>=65136&&l<=65279,T=l=>l>=65280&&l<=65519;function k(l){for(const s of l)if(M(s.charCodeAt(0)))return!0;return!1}function P(l){for(const s of l)if(!I(s.charCodeAt(0)))return!1;return!0}function I(l){return!(Sh(l)||Df(l)||ic(l)||Qr(l)||_(l))}function M(l){return!(746!==l&&747!==l&&(l<4352||!(Il(l)||hs(l)||w(l)&&!(l>=65097&&l<=65103)||Oo(l)||kf(l)||Af(l)||Mf(l)||!(!Hc(l)||l>=12296&&l<=12305||l>=12308&&l<=12319||12336===l)||zp(l)||fu(l)||Xu(l)||(s=l,s>=12592&&s<=12687)||(s=>s>=43360&&s<=43391)(l)||(s=>s>=55216&&s<=55295)(l)||(s=>s>=4352&&s<=4607)(l)||Xd(l)||oc(l)||To(l)||(s=>s>=12688&&s<=12703)(l)||rc(l)||fd(l)||pu(l)&&12540!==l||!(!T(l)||65288===l||65289===l||65293===l||l>=65306&&l<=65310||65339===l||65341===l||65343===l||l>=65371&&l<=65503||65507===l||l>=65512&&l<=65519)||!(!h(l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||(s=>s>=5120&&s<=5759)(l)||(s=>s>=6320&&s<=6399)(l)||qn(l)||(s=>s>=19904&&s<=19967)(l)||Qd(l)||Ys(l))));var s}function z(l){return!(M(l)||(s=l,(c=s)>=128&&c<=255&&(167===s||169===s||174===s||177===s||188===s||189===s||190===s||215===s||247===s)||(c=>c>=8192&&c<=8303)(s)&&(8214===s||8224===s||8225===s||8240===s||8241===s||8251===s||8252===s||8258===s||8263===s||8264===s||8265===s||8273===s)||(c=>c>=8448&&c<=8527)(s)||(c=>c>=8528&&c<=8591)(s)||(c=>c>=8960&&c<=9215)(s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||9003===s||s>=9085&&s<=9114||s>=9150&&s<=9165||9167===s||s>=9169&&s<=9179||s>=9186&&s<=9215)||(c=>c>=9216&&c<=9279)(s)&&9251!==s||(c=>c>=9280&&c<=9311)(s)||(c=>c>=9312&&c<=9471)(s)||(c=>c>=9632&&c<=9727)(s)||(c=>c>=9728&&c<=9983)(s)&&!(s>=9754&&s<=9759)||(c=>c>=11008&&c<=11263)(s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||Hc(s)||pu(s)||(c=>c>=57344&&c<=63743)(s)||w(s)||h(s)||T(s)||8734===s||8756===s||8757===s||s>=9984&&s<=10087||s>=10102&&s<=10131||65532===s||65533===s));var s,c}function G(l){return l>=1424&&l<=2303||Qr(l)||_(l)}function $(l,s){return!(!s&&G(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||(c=l,c>=6016&&c<=6143));var c}function te(l){for(const s of l)if(G(s.charCodeAt(0)))return!0;return!1}const ue="deferred",fe="loading",_e="loaded";let ye=null,Te="unavailable",de=null;const Oe=function(l){l&&"string"==typeof l&&l.indexOf("NetworkError")>-1&&(Te="error"),ye&&ye(l)};function Re(){Fe.fire(new ci("pluginStateChange",{pluginStatus:Te,pluginURL:de}))}const Fe=new mo,Ye=function(){return Te},We=function(){if(Te!==ue||!de)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Te=fe,Re(),de&&Jr({url:de},l=>{l?Oe(l):(Te=_e,Re())})},Xe={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Te===_e||null!=Xe.applyArabicShaping,isLoading:()=>Te===fe,setState(l){Te=l.pluginStatus,de=l.pluginURL},isParsed:()=>null!=Xe.applyArabicShaping&&null!=Xe.processBidirectionalText&&null!=Xe.processStyledBidirectionalText,getPluginURL:()=>de};class ut{constructor(s,c){this.zoom=s,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.transition=c.transition,this.pitch=c.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(s){return function(c,f){for(const v of c)if(!$(v.charCodeAt(0),f))return!1;return!0}(s,Xe.isLoaded())}}class Et{constructor(s,c){this.property=s,this.value=c,this.expression=function(f,v){if(Xl(f))return new Oc(f,v);if(Ta(f)){const C=qs(f,v);if("error"===C.result)throw new Error(C.value.map(S=>`${S.key}: ${S.message}`).join(", "));return C.value}{let C=f;return"string"==typeof f&&"color"===v.type&&(C=Qi.parse(f)),{kind:"constant",evaluate:()=>C}}}(void 0===c?s.specification.default:c,s.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(s,c,f){return this.property.possiblyEvaluate(this,s,c,f)}}class At{constructor(s){this.property=s,this.value=new Et(s,void 0)}transitioned(s,c){return new wt(this.property,this.value,c,Ni({},s.transition,this.transition),s.now)}untransitioned(){return new wt(this.property,this.value,null,{},0)}}class on{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return $r(this._values[s].value.value)}setValue(s,c){this._values.hasOwnProperty(s)||(this._values[s]=new At(this._values[s].property)),this._values[s].value=new Et(this._values[s].property,null===c?void 0:$r(c))}getTransition(s){return $r(this._values[s].transition)}setTransition(s,c){this._values.hasOwnProperty(s)||(this._values[s]=new At(this._values[s].property)),this._values[s].transition=$r(c)||void 0}serialize(){const s={};for(const c of Object.keys(this._values)){const f=this.getValue(c);void 0!==f&&(s[c]=f);const v=this.getTransition(c);void 0!==v&&(s[`${c}-transition`]=v)}return s}transitioned(s,c){const f=new qt(this._properties);for(const v of Object.keys(this._values))f._values[v]=this._values[v].transitioned(s,c._values[v]);return f}untransitioned(){const s=new qt(this._properties);for(const c of Object.keys(this._values))s._values[c]=this._values[c].untransitioned();return s}}class wt{constructor(s,c,f,v,C){const S=v.delay||0,R=v.duration||0;C=C||0,this.property=s,this.value=c,this.begin=C+S,this.end=this.begin+R,s.specification.transition&&(v.delay||v.duration)&&(this.prior=f)}possiblyEvaluate(s,c,f){const v=s.now||0,C=this.value.possiblyEvaluate(s,c,f),S=this.prior;if(S){if(v>this.end)return this.prior=null,C;if(this.value.isDataDriven())return this.prior=null,C;if(v<this.begin)return S.possiblyEvaluate(s,c,f);{const R=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(S.possiblyEvaluate(s,c,f),C,gt(R))}}return C}}class qt{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,c,f){const v=new Tt(this._properties);for(const C of Object.keys(this._values))v._values[C]=this._values[C].possiblyEvaluate(s,c,f);return v}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class Nt{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}getValue(s){return $r(this._values[s].value)}setValue(s,c){this._values[s]=new Et(this._values[s].property,null===c?void 0:$r(c))}serialize(){const s={};for(const c of Object.keys(this._values)){const f=this.getValue(c);void 0!==f&&(s[c]=f)}return s}possiblyEvaluate(s,c,f){const v=new Tt(this._properties);for(const C of Object.keys(this._values))v._values[C]=this._values[C].possiblyEvaluate(s,c,f);return v}}class sn{constructor(s,c,f){this.property=s,this.value=c,this.parameters=f}isConstant(){return"constant"===this.value.kind}constantOr(s){return"constant"===this.value.kind?this.value.value:s}evaluate(s,c,f,v){return this.property.evaluate(this.value,this.parameters,s,c,f,v)}}class Tt{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class yt{constructor(s){this.specification=s}possiblyEvaluate(s,c){return s.expression.evaluate(c)}interpolate(s,c,f){const v=Hu[this.specification.type];return v?v(s,c,f):s}}class Pt{constructor(s,c){this.specification=s,this.overrides=c}possiblyEvaluate(s,c,f,v){return new sn(this,"constant"===s.expression.kind||"camera"===s.expression.kind?{kind:"constant",value:s.expression.evaluate(c,null,{},f,v)}:s.expression,c)}interpolate(s,c,f){if("constant"!==s.value.kind||"constant"!==c.value.kind)return s;if(void 0===s.value.value||void 0===c.value.value)return new sn(this,{kind:"constant",value:void 0},s.parameters);const v=Hu[this.specification.type];return v?new sn(this,{kind:"constant",value:v(s.value.value,c.value.value,f)},s.parameters):s}evaluate(s,c,f,v,C,S){return"constant"===s.kind?s.value:s.evaluate(c,f,v,C,S)}}class tn{constructor(s){this.specification=s}possiblyEvaluate(s,c,f,v){return!!s.expression.evaluate(c,null,{},f,v)}interpolate(){return!1}}class hn{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const c=new ut(0,{});for(const f in s){const v=s[f];v.specification.overridable&&this.overridableProperties.push(f);const C=this.defaultPropertyValues[f]=new Et(v,void 0),S=this.defaultTransitionablePropertyValues[f]=new At(v);this.defaultTransitioningPropertyValues[f]=S.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=C.possiblyEvaluate(c)}}}function $n(l,s){return 256*(l=It(Math.floor(l),0,255))+It(Math.floor(s),0,255)}Rn(Pt,"DataDrivenProperty"),Rn(yt,"DataConstantProperty"),Rn(tn,"ColorRampProperty");const ki={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Gn{constructor(s,c){this._structArray=s,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class On{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,c){return s._trim(),c&&(s.isTransferred=!0,c.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const c=Object.create(this.prototype);return c.arrayBuffer=s.arrayBuffer,c.length=s.length,c.capacity=s.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Jn(l,s=1){let c=0,f=0;return{members:l.map(v=>{const C=ki[v.type].BYTES_PER_ELEMENT,S=c=sr(c,Math.max(s,C)),R=v.components||1;return f=Math.max(f,C),c+=C*R,{name:v.name,type:v.type,components:R,offset:S}}),size:sr(c,Math.max(f,s)),alignment:s}}function sr(l,s){return Math.ceil(l/s)*s}class hi extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c){const f=this.length;return this.resize(f+1),this.emplace(f,s,c)}emplace(s,c,f){const v=2*s;return this.int16[v+0]=c,this.int16[v+1]=f,s}}hi.prototype.bytesPerElement=4,Rn(hi,"StructArrayLayout2i4");class Lr extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,f){const v=this.length;return this.resize(v+1),this.emplace(v,s,c,f)}emplace(s,c,f,v){const C=3*s;return this.int16[C+0]=c,this.int16[C+1]=f,this.int16[C+2]=v,s}}Lr.prototype.bytesPerElement=6,Rn(Lr,"StructArrayLayout3i6");class Hr extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,f,v){const C=this.length;return this.resize(C+1),this.emplace(C,s,c,f,v)}emplace(s,c,f,v,C){const S=4*s;return this.int16[S+0]=c,this.int16[S+1]=f,this.int16[S+2]=v,this.int16[S+3]=C,s}}Hr.prototype.bytesPerElement=8,Rn(Hr,"StructArrayLayout4i8");class Xr extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,v,C,S,R){const N=this.length;return this.resize(N+1),this.emplace(N,s,c,f,v,C,S,R)}emplace(s,c,f,v,C,S,R,N){const U=6*s,W=12*s,Q=3*s;return this.int16[U+0]=c,this.int16[U+1]=f,this.uint8[W+4]=v,this.uint8[W+5]=C,this.uint8[W+6]=S,this.uint8[W+7]=R,this.float32[Q+2]=N,s}}Xr.prototype.bytesPerElement=12,Rn(Xr,"StructArrayLayout2i4ub1f12");class Kr extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,v){const C=this.length;return this.resize(C+1),this.emplace(C,s,c,f,v)}emplace(s,c,f,v,C){const S=4*s;return this.float32[S+0]=c,this.float32[S+1]=f,this.float32[S+2]=v,this.float32[S+3]=C,s}}Kr.prototype.bytesPerElement=16,Rn(Kr,"StructArrayLayout4f16");class is extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,v,C){const S=this.length;return this.resize(S+1),this.emplace(S,s,c,f,v,C)}emplace(s,c,f,v,C,S){const R=6*s,N=3*s;return this.uint16[R+0]=c,this.uint16[R+1]=f,this.uint16[R+2]=v,this.uint16[R+3]=C,this.float32[N+2]=S,s}}is.prototype.bytesPerElement=12,Rn(is,"StructArrayLayout4ui1f12");class sa extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,f,v){const C=this.length;return this.resize(C+1),this.emplace(C,s,c,f,v)}emplace(s,c,f,v,C){const S=4*s;return this.uint16[S+0]=c,this.uint16[S+1]=f,this.uint16[S+2]=v,this.uint16[S+3]=C,s}}sa.prototype.bytesPerElement=8,Rn(sa,"StructArrayLayout4ui8");class Dl extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,f,v,C,S){const R=this.length;return this.resize(R+1),this.emplace(R,s,c,f,v,C,S)}emplace(s,c,f,v,C,S,R){const N=6*s;return this.int16[N+0]=c,this.int16[N+1]=f,this.int16[N+2]=v,this.int16[N+3]=C,this.int16[N+4]=S,this.int16[N+5]=R,s}}Dl.prototype.bytesPerElement=12,Rn(Dl,"StructArrayLayout6i12");class mu extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,f,v,C,S,R,N,U,W,Q,ee){const oe=this.length;return this.resize(oe+1),this.emplace(oe,s,c,f,v,C,S,R,N,U,W,Q,ee)}emplace(s,c,f,v,C,S,R,N,U,W,Q,ee,oe){const le=12*s;return this.int16[le+0]=c,this.int16[le+1]=f,this.int16[le+2]=v,this.int16[le+3]=C,this.uint16[le+4]=S,this.uint16[le+5]=R,this.uint16[le+6]=N,this.uint16[le+7]=U,this.int16[le+8]=W,this.int16[le+9]=Q,this.int16[le+10]=ee,this.int16[le+11]=oe,s}}mu.prototype.bytesPerElement=24,Rn(mu,"StructArrayLayout4i4ui4i24");class eo extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,v,C,S){const R=this.length;return this.resize(R+1),this.emplace(R,s,c,f,v,C,S)}emplace(s,c,f,v,C,S,R){const N=10*s,U=5*s;return this.int16[N+0]=c,this.int16[N+1]=f,this.int16[N+2]=v,this.float32[U+2]=C,this.float32[U+3]=S,this.float32[U+4]=R,s}}eo.prototype.bytesPerElement=20,Rn(eo,"StructArrayLayout3i3f20");class hr extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint32[1*s+0]=c,s}}hr.prototype.bytesPerElement=4,Rn(hr,"StructArrayLayout1ul4");class gr extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,f,v,C,S,R,N,U,W,Q,ee,oe){const le=this.length;return this.resize(le+1),this.emplace(le,s,c,f,v,C,S,R,N,U,W,Q,ee,oe)}emplace(s,c,f,v,C,S,R,N,U,W,Q,ee,oe,le){const he=20*s,Ie=10*s;return this.int16[he+0]=c,this.int16[he+1]=f,this.int16[he+2]=v,this.int16[he+3]=C,this.int16[he+4]=S,this.float32[Ie+3]=R,this.float32[Ie+4]=N,this.float32[Ie+5]=U,this.float32[Ie+6]=W,this.int16[he+14]=Q,this.uint32[Ie+8]=ee,this.uint16[he+18]=oe,this.uint16[he+19]=le,s}}gr.prototype.bytesPerElement=40,Rn(gr,"StructArrayLayout5i4f1i1ul2ui40");class Lo extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,f,v,C,S,R){const N=this.length;return this.resize(N+1),this.emplace(N,s,c,f,v,C,S,R)}emplace(s,c,f,v,C,S,R,N){const U=8*s;return this.int16[U+0]=c,this.int16[U+1]=f,this.int16[U+2]=v,this.int16[U+4]=C,this.int16[U+5]=S,this.int16[U+6]=R,this.int16[U+7]=N,s}}Lo.prototype.bytesPerElement=16,Rn(Lo,"StructArrayLayout3i2i2i16");class aa extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,f,v,C){const S=this.length;return this.resize(S+1),this.emplace(S,s,c,f,v,C)}emplace(s,c,f,v,C,S){const R=4*s,N=8*s;return this.float32[R+0]=c,this.float32[R+1]=f,this.float32[R+2]=v,this.int16[N+6]=C,this.int16[N+7]=S,s}}aa.prototype.bytesPerElement=16,Rn(aa,"StructArrayLayout2f1f2i16");class Fr extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,v){const C=this.length;return this.resize(C+1),this.emplace(C,s,c,f,v)}emplace(s,c,f,v,C){const S=12*s,R=3*s;return this.uint8[S+0]=c,this.uint8[S+1]=f,this.float32[R+1]=v,this.float32[R+2]=C,s}}Fr.prototype.bytesPerElement=12,Rn(Fr,"StructArrayLayout2ub2f12");class Fs extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f){const v=this.length;return this.resize(v+1),this.emplace(v,s,c,f)}emplace(s,c,f,v){const C=3*s;return this.float32[C+0]=c,this.float32[C+1]=f,this.float32[C+2]=v,s}}Fs.prototype.bytesPerElement=12,Rn(Fs,"StructArrayLayout3f12");class Ns extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,f){const v=this.length;return this.resize(v+1),this.emplace(v,s,c,f)}emplace(s,c,f,v){const C=3*s;return this.uint16[C+0]=c,this.uint16[C+1]=f,this.uint16[C+2]=v,s}}Ns.prototype.bytesPerElement=6,Rn(Ns,"StructArrayLayout3ui6");class gu extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,c,f,v,C,S,R,N,U,W,Q,ee,oe,le,he,Ie,Le,ve,Pe,He,Be){const $e=this.length;return this.resize($e+1),this.emplace($e,s,c,f,v,C,S,R,N,U,W,Q,ee,oe,le,he,Ie,Le,ve,Pe,He,Be)}emplace(s,c,f,v,C,S,R,N,U,W,Q,ee,oe,le,he,Ie,Le,ve,Pe,He,Be,$e){const kt=30*s,St=15*s,Gt=60*s;return this.int16[kt+0]=c,this.int16[kt+1]=f,this.int16[kt+2]=v,this.float32[St+2]=C,this.float32[St+3]=S,this.uint16[kt+8]=R,this.uint16[kt+9]=N,this.uint32[St+5]=U,this.uint32[St+6]=W,this.uint32[St+7]=Q,this.uint16[kt+16]=ee,this.uint16[kt+17]=oe,this.uint16[kt+18]=le,this.float32[St+10]=he,this.float32[St+11]=Ie,this.uint8[Gt+48]=Le,this.uint8[Gt+49]=ve,this.uint8[Gt+50]=Pe,this.uint32[St+13]=He,this.int16[kt+28]=Be,this.uint8[Gt+58]=$e,s}}gu.prototype.bytesPerElement=60,Rn(gu,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Ih extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,c,f,v,C,S,R,N,U,W,Q,ee,oe,le,he,Ie,Le,ve,Pe,He,Be,$e,kt,St,Gt,Qt,Ft,Kt,Xt,un){const pn=this.length;return this.resize(pn+1),this.emplace(pn,s,c,f,v,C,S,R,N,U,W,Q,ee,oe,le,he,Ie,Le,ve,Pe,He,Be,$e,kt,St,Gt,Qt,Ft,Kt,Xt,un)}emplace(s,c,f,v,C,S,R,N,U,W,Q,ee,oe,le,he,Ie,Le,ve,Pe,He,Be,$e,kt,St,Gt,Qt,Ft,Kt,Xt,un,pn){const Bt=38*s,In=19*s;return this.int16[Bt+0]=c,this.int16[Bt+1]=f,this.int16[Bt+2]=v,this.float32[In+2]=C,this.float32[In+3]=S,this.int16[Bt+8]=R,this.int16[Bt+9]=N,this.int16[Bt+10]=U,this.int16[Bt+11]=W,this.int16[Bt+12]=Q,this.int16[Bt+13]=ee,this.uint16[Bt+14]=oe,this.uint16[Bt+15]=le,this.uint16[Bt+16]=he,this.uint16[Bt+17]=Ie,this.uint16[Bt+18]=Le,this.uint16[Bt+19]=ve,this.uint16[Bt+20]=Pe,this.uint16[Bt+21]=He,this.uint16[Bt+22]=Be,this.uint16[Bt+23]=$e,this.uint16[Bt+24]=kt,this.uint16[Bt+25]=St,this.uint16[Bt+26]=Gt,this.uint16[Bt+27]=Qt,this.uint16[Bt+28]=Ft,this.uint32[In+15]=Kt,this.float32[In+16]=Xt,this.float32[In+17]=un,this.float32[In+18]=pn,s}}Ih.prototype.bytesPerElement=76,Rn(Ih,"StructArrayLayout3i2f6i15ui1ul3f76");class Ba extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.float32[1*s+0]=c,s}}Ba.prototype.bytesPerElement=4,Rn(Ba,"StructArrayLayout1f4");class rl extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,v,C){const S=this.length;return this.resize(S+1),this.emplace(S,s,c,f,v,C)}emplace(s,c,f,v,C,S){const R=5*s;return this.float32[R+0]=c,this.float32[R+1]=f,this.float32[R+2]=v,this.float32[R+3]=C,this.float32[R+4]=S,s}}rl.prototype.bytesPerElement=20,Rn(rl,"StructArrayLayout5f20");class to extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,f,v){const C=this.length;return this.resize(C+1),this.emplace(C,s,c,f,v)}emplace(s,c,f,v,C){const S=6*s;return this.uint32[3*s+0]=c,this.uint16[S+2]=f,this.uint16[S+3]=v,this.uint16[S+4]=C,s}}to.prototype.bytesPerElement=12,Rn(to,"StructArrayLayout1ul3ui12");class yo extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c){const f=this.length;return this.resize(f+1),this.emplace(f,s,c)}emplace(s,c,f){const v=2*s;return this.uint16[v+0]=c,this.uint16[v+1]=f,s}}yo.prototype.bytesPerElement=4,Rn(yo,"StructArrayLayout2ui4");class sc extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint16[1*s+0]=c,s}}sc.prototype.bytesPerElement=2,Rn(sc,"StructArrayLayout1ui2");class md extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c){const f=this.length;return this.resize(f+1),this.emplace(f,s,c)}emplace(s,c,f){const v=2*s;return this.float32[v+0]=c,this.float32[v+1]=f,s}}md.prototype.bytesPerElement=8,Rn(md,"StructArrayLayout2f8");class Rf extends Gn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Rf.prototype.size=40;class ya extends gr{get(s){return new Rf(this,s)}}Rn(ya,"CollisionBoxArray");class Bp extends Gn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(s){this._structArray.uint8[this._pos1+49]=s}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(s){this._structArray.uint8[this._pos1+50]=s}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(s){this._structArray.uint32[this._pos4+13]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(s){this._structArray.uint8[this._pos1+58]=s}}Bp.prototype.size=60;class ly extends gu{get(s){return new Bp(this,s)}}Rn(ly,"PlacedSymbolArray");class Gg extends Gn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(s){this._structArray.uint32[this._pos4+15]=s}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Gg.prototype.size=76;class h0 extends Ih{get(s){return new Gg(this,s)}}Rn(h0,"SymbolInstanceArray");class cy extends Ba{getoffsetX(s){return this.float32[1*s+0]}}Rn(cy,"GlyphOffsetArray");class Z extends hi{getx(s){return this.int16[2*s+0]}gety(s){return this.int16[2*s+1]}}Rn(Z,"SymbolLineVertexArray");class F extends Gn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}F.prototype.size=12;class V extends to{get(s){return new F(this,s)}}Rn(V,"FeatureIndexArray");class J extends yo{geta_centroid_pos0(s){return this.uint16[2*s+0]}geta_centroid_pos1(s){return this.uint16[2*s+1]}}Rn(J,"FillExtrusionCentroidArray");const me=Jn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),ke=Jn([{name:"a_dash",components:4,type:"Uint16"}]);var Mt={},mn={get exports(){return Mt},set exports(l){Mt=l}},ei={};({get exports(){return ei},set exports(l){ei=l}}).exports=function(l,s){var c,f,v,C,S,R,N,U;for(f=l.length-(c=3&l.length),v=s,S=3432918353,R=461845907,U=0;U<f;)N=255&l.charCodeAt(U)|(255&l.charCodeAt(++U))<<8|(255&l.charCodeAt(++U))<<16|(255&l.charCodeAt(++U))<<24,++U,v=27492+(65535&(C=5*(65535&(v=(v^=N=(65535&(N=(N=(65535&N)*S+(((N>>>16)*S&65535)<<16)&4294967295)<<15|N>>>17))*R+(((N>>>16)*R&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(N=0,c){case 3:N^=(255&l.charCodeAt(U+2))<<16;case 2:N^=(255&l.charCodeAt(U+1))<<8;case 1:v^=N=(65535&(N=(N=(65535&(N^=255&l.charCodeAt(U)))*S+(((N>>>16)*S&65535)<<16)&4294967295)<<15|N>>>17))*R+(((N>>>16)*R&65535)<<16)&4294967295}return v^=l.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0};var oi={};({get exports(){return oi},set exports(l){oi=l}}).exports=function(l,s){for(var c,f=l.length,v=s^f,C=0;f>=4;)c=1540483477*(65535&(c=255&l.charCodeAt(C)|(255&l.charCodeAt(++C))<<8|(255&l.charCodeAt(++C))<<16|(255&l.charCodeAt(++C))<<24))+((1540483477*(c>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),f-=4,++C;switch(f){case 3:v^=(255&l.charCodeAt(C+2))<<16;case 2:v^=(255&l.charCodeAt(C+1))<<8;case 1:v=1540483477*(65535&(v^=255&l.charCodeAt(C)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0};var dr=ei,rs=oi;mn.exports=dr,Mt.murmur3=dr,Mt.murmur2=rs;class Ia{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,c,f,v){this.ids.push(jc(s)),this.positions.push(c,f,v)}getPositions(s){const c=jc(s);let f=0,v=this.ids.length-1;for(;f<v;){const S=f+v>>1;this.ids[S]>=c?v=S:f=S+1}const C=[];for(;this.ids[f]===c;)C.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return C}static serialize(s,c){const f=new Float64Array(s.ids),v=new Uint32Array(s.positions);return ep(f,v,0,f.length-1),c&&c.push(f.buffer,v.buffer),{ids:f,positions:v}}static deserialize(s){const c=new Ia;return c.ids=s.ids,c.positions=s.positions,c.indexed=!0,c}}function jc(l){const s=+l;return!isNaN(s)&&Number.MIN_SAFE_INTEGER<=s&&s<=Number.MAX_SAFE_INTEGER?s:Mt(String(l))}function ep(l,s,c,f){for(;c<f;){const v=l[c+f>>1];let C=c-1,S=f+1;for(;;){do{C++}while(l[C]<v);do{S--}while(l[S]>v);if(C>=S)break;_u(l,C,S),_u(s,3*C,3*S),_u(s,3*C+1,3*S+1),_u(s,3*C+2,3*S+2)}S-c<f-S?(ep(l,s,c,S),c=S+1):(ep(l,s,S+1,f),f=S)}}function _u(l,s,c){const f=l[s];l[s]=l[c],l[c]=f}Rn(Ia,"FeaturePositionMap");class la{constructor(s){this.gl=s.gl,this.initialized=!1}fetchUniformLocation(s,c){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(s,c),this.initialized=!0),!!this.location}}class xs extends la{constructor(s){super(s),this.current=0}set(s,c,f){this.fetchUniformLocation(s,c)&&this.current!==f&&(this.current=f,this.gl.uniform1f(this.location,f))}}class $g extends la{constructor(s){super(s),this.current=[0,0,0,0]}set(s,c,f){this.fetchUniformLocation(s,c)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]&&f[3]===this.current[3]||(this.current=f,this.gl.uniform4f(this.location,f[0],f[1],f[2],f[3])))}}class tp extends la{constructor(s){super(s),this.current=Qi.transparent}set(s,c,f){this.fetchUniformLocation(s,c)&&(f.r===this.current.r&&f.g===this.current.g&&f.b===this.current.b&&f.a===this.current.a||(this.current=f,this.gl.uniform4f(this.location,f.r,f.g,f.b,f.a)))}}const uy=new Float32Array(16),hy=new Float32Array(9),Wg=new Float32Array(4);function Vp(l){return[$n(255*l.r,255*l.g),$n(255*l.b,255*l.a)]}class Pf{constructor(s,c,f){this.value=s,this.uniformNames=c.map(v=>`u_${v}`),this.type=f}setUniform(s,c,f,v,C){c.set(s,C,v.constantOr(this.value))}getBinding(s,c){return"color"===this.type?new tp(s):new xs(s)}}class ol{constructor(s,c){this.uniformNames=c.map(f=>`u_${f}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(s){this.pixelRatio=s.pixelRatio||1,this.pattern=s.tl.concat(s.br)}setUniform(s,c,f,v,C){const S="u_pattern"===C||"u_dash"===C?this.pattern:"u_pixel_ratio"===C?this.pixelRatio:null;S&&c.set(s,C,S)}getBinding(s,c){return"u_pattern"===c||"u_dash"===c?new $g(s):new xs(s)}}class yu{constructor(s,c,f,v){this.expression=s,this.type=f,this.maxValue=0,this.paintVertexAttributes=c.map(C=>({name:`a_${C}`,type:"Float32",components:"color"===f?2:1,offset:0})),this.paintVertexArray=new v}populatePaintArray(s,c,f,v,C,S){const R=this.paintVertexArray.length,N=this.expression.evaluate(new ut(0),c,{},C,v,S);this.paintVertexArray.resize(s),this._setPaintValue(R,s,N)}updatePaintArray(s,c,f,v,C){const S=this.expression.evaluate({zoom:0},f,v,void 0,C);this._setPaintValue(s,c,S)}_setPaintValue(s,c,f){if("color"===this.type){const v=Vp(f);for(let C=s;C<c;C++)this.paintVertexArray.emplace(C,v[0],v[1])}else{for(let v=s;v<c;v++)this.paintVertexArray.emplace(v,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class $o{constructor(s,c,f,v,C,S){this.expression=s,this.uniformNames=c.map(R=>`u_${R}_t`),this.type=f,this.useIntegerZoom=v,this.zoom=C,this.maxValue=0,this.paintVertexAttributes=c.map(R=>({name:`a_${R}`,type:"Float32",components:"color"===f?4:2,offset:0})),this.paintVertexArray=new S}populatePaintArray(s,c,f,v,C,S){const R=this.expression.evaluate(new ut(this.zoom),c,{},C,v,S),N=this.expression.evaluate(new ut(this.zoom+1),c,{},C,v,S),U=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(U,s,R,N)}updatePaintArray(s,c,f,v,C){const S=this.expression.evaluate({zoom:this.zoom},f,v,void 0,C),R=this.expression.evaluate({zoom:this.zoom+1},f,v,void 0,C);this._setPaintValue(s,c,S,R)}_setPaintValue(s,c,f,v){if("color"===this.type){const C=Vp(f),S=Vp(v);for(let R=s;R<c;R++)this.paintVertexArray.emplace(R,C[0],C[1],S[0],S[1])}else{for(let C=s;C<c;C++)this.paintVertexArray.emplace(C,f,v);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(v))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,c,f,v,C){const S=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,R=It(this.expression.interpolationFactor(S,this.zoom,this.zoom+1),0,1);c.set(s,C,R)}getBinding(s,c){return new xs(s)}}class Al{constructor(s,c,f,v,C){this.expression=s,this.layerId=C,this.paintVertexAttributes=("array"===f?ke:me).members;for(let S=0;S<c.length;++S);this.paintVertexArray=new v}populatePaintArray(s,c,f){const v=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValues(v,s,c.patterns&&c.patterns[this.layerId],f)}updatePaintArray(s,c,f,v,C,S){this._setPaintValues(s,c,f.patterns&&f.patterns[this.layerId],S)}_setPaintValues(s,c,f,v){if(!v||!f)return;const C=v[f];if(!C)return;const{tl:S,br:R,pixelRatio:N}=C;for(let U=s;U<c;U++)this.paintVertexArray.emplace(U,S[0],S[1],R[0],R[1],N)}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class gd{constructor(s,c,f=(()=>!0)){this.binders={},this._buffers=[];const v=[];for(const C in s.paint._values){if(!f(C))continue;const S=s.paint.get(C);if(!(S instanceof sn&&xl(S.property.specification)))continue;const R=d0(C,s.type),N=S.value,U=S.property.specification.type,W=!!S.property.useIntegerZoom,Q="line-dasharray"===C||C.endsWith("pattern"),ee="line-dasharray"===C&&"constant"!==s.layout.get("line-cap").value.kind;if("constant"!==N.kind||ee)if("source"===N.kind||ee||Q){const oe=dy(C,U,"source");this.binders[C]=Q?new Al(N,R,U,oe,s.id):new yu(N,R,U,oe),v.push(`/a_${C}`)}else{const oe=dy(C,U,"composite");this.binders[C]=new $o(N,R,U,W,c,oe),v.push(`/z_${C}`)}else this.binders[C]=Q?new ol(N.value,R):new Pf(N.value,R,U),v.push(`/u_${C}`)}this.cacheKey=v.sort().join("")}getMaxValue(s){const c=this.binders[s];return c instanceof yu||c instanceof $o?c.maxValue:0}populatePaintArrays(s,c,f,v,C,S){for(const R in this.binders){const N=this.binders[R];(N instanceof yu||N instanceof $o||N instanceof Al)&&N.populatePaintArray(s,c,f,v,C,S)}}setConstantPatternPositions(s){for(const c in this.binders){const f=this.binders[c];f instanceof ol&&f.setConstantPatternPositions(s)}}updatePaintArrays(s,c,f,v,C,S){let R=!1;for(const N in s){const U=c.getPositions(N);for(const W of U){const Q=f.feature(W.index);for(const ee in this.binders){const oe=this.binders[ee];if((oe instanceof yu||oe instanceof $o||oe instanceof Al)&&!0===oe.expression.isStateDependent){const le=v.paint.get(ee);oe.expression=le.value,oe.updatePaintArray(W.start,W.end,Q,s[N],C,S),R=!0}}}}return R}defines(){const s=[];for(const c in this.binders){const f=this.binders[c];(f instanceof Pf||f instanceof ol)&&s.push(...f.uniformNames.map(v=>`#define HAS_UNIFORM_${v}`))}return s}getBinderAttributes(){const s=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof yu||f instanceof $o||f instanceof Al)for(let v=0;v<f.paintVertexAttributes.length;v++)s.push(f.paintVertexAttributes[v].name)}return s}getBinderUniforms(){const s=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof Pf||f instanceof ol||f instanceof $o)for(const v of f.uniformNames)s.push(v)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s){const c=[];for(const f in this.binders){const v=this.binders[f];if(v instanceof Pf||v instanceof ol||v instanceof $o)for(const C of v.uniformNames)c.push({name:C,property:f,binding:v.getBinding(s,C)})}return c}setUniforms(s,c,f,v,C){for(const{name:S,property:R,binding:N}of f)this.binders[R].setUniform(s,N,C,v.get(R),S)}updatePaintBuffers(){this._buffers=[];for(const s in this.binders){const c=this.binders[s];(c instanceof yu||c instanceof $o||c instanceof Al)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(s){for(const c in this.binders){const f=this.binders[c];(f instanceof yu||f instanceof $o||f instanceof Al)&&f.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const c=this.binders[s];(c instanceof yu||c instanceof $o||c instanceof Al)&&c.destroy()}}}class xm{constructor(s,c,f=(()=>!0)){this.programConfigurations={};for(const v of s)this.programConfigurations[v.id]=new gd(v,c,f);this.needsUpload=!1,this._featureMap=new Ia,this._bufferOffset=0}populatePaintArrays(s,c,f,v,C,S,R){for(const N in this.programConfigurations)this.programConfigurations[N].populatePaintArrays(s,c,v,C,S,R);void 0!==c.id&&this._featureMap.add(c.id,f,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,c,f,v,C){for(const S of f)this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(s,this._featureMap,c,S,v,C)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}const Lw={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function d0(l,s){return Lw[l]||[l.replace(`${s}-`,"").replace(/-/g,"_")]}const p0={"line-pattern":{source:is,composite:is},"fill-pattern":{source:is,composite:is},"fill-extrusion-pattern":{source:is,composite:is},"line-dasharray":{source:sa,composite:sa}},Up={color:{source:md,composite:Kr},number:{source:Ba,composite:md}};function dy(l,s,c){const f=p0[l];return f&&f[c]||Up[s][c]}Rn(Pf,"ConstantBinder"),Rn(ol,"PatternConstantBinder"),Rn(yu,"SourceExpressionBinder"),Rn(Al,"PatternCompositeBinder"),Rn($o,"CompositeExpressionBinder"),Rn(gd,"ProgramConfiguration",{omit:["_buffers"]}),Rn(xm,"ProgramConfigurationSet");const Cm="-transition";class eh extends mo{constructor(s,c){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==s.type&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,"background"!==s.type&&"sky"!==s.type&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),c.layout&&(this._unevaluatedLayout=new Nt(c.layout)),c.paint)){this._transitionablePaint=new on(c.paint);for(const f in s.paint)this.setPaintProperty(f,s.paint[f],{validate:!1});for(const f in s.layout)this.setLayoutProperty(f,s.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Tt(c.paint)}}getLayoutProperty(s){return"visibility"===s?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,c,f={}){null!=c&&this._validate(Yd,`layers.${this.id}.layout.${s}`,s,c,f)||("visibility"!==s?this._unevaluatedLayout.setValue(s,c):this.visibility=c)}getPaintProperty(s){return bi(s,Cm)?this._transitionablePaint.getTransition(s.slice(0,-Cm.length)):this._transitionablePaint.getValue(s)}setPaintProperty(s,c,f={}){if(null!=c&&this._validate(Yu,`layers.${this.id}.paint.${s}`,s,c,f))return!1;if(bi(s,Cm))return this._transitionablePaint.setTransition(s.slice(0,-Cm.length),c||void 0),!1;{const v=this._transitionablePaint._values[s],C=v.value.isDataDriven(),S=v.value;this._transitionablePaint.setValue(s,c),this._handleSpecialPaintPropertyUpdate(s);const R=this._transitionablePaint._values[s].value,N=R.isDataDriven(),U=bi(s,"pattern")||"line-dasharray"===s;return N||C||U||this._handleOverridablePaintPropertyUpdate(s,S,R)}}_handleSpecialPaintPropertyUpdate(s){}getProgramIds(){return null}getProgramConfiguration(s){return null}_handleOverridablePaintPropertyUpdate(s,c,f){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||"none"===this.visibility}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,c){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,c)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),Vo(s,(c,f)=>!(void 0===c||"layout"===f&&!Object.keys(c).length||"paint"===f&&!Object.keys(c).length))}_validate(s,c,f,v,C={}){return(!C||!1!==C.validate)&&Ju(this,s.call(Th,{key:c,layerType:this.type,objectKey:f,value:v,styleSpec:Rt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const c=this.paint.get(s);if(c instanceof sn&&xl(c.property.specification)&&("source"===c.value.kind||"composite"===c.value.kind)&&c.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=La(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const sE=Jn([{name:"a_pos",components:2,type:"Int16"}],4),Of=Jn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Cs{constructor(s=[]){this.segments=s}prepareSegment(s,c,f,v){let C=this.segments[this.segments.length-1];return s>Cs.MAX_VERTEX_ARRAY_LENGTH&&Ar(`Max vertices per segment is ${Cs.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!C||C.vertexLength+s>Cs.MAX_VERTEX_ARRAY_LENGTH||C.sortKey!==v)&&(C={vertexOffset:c.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},void 0!==v&&(C.sortKey=v),this.segments.push(C)),C}get(){return this.segments}destroy(){for(const s of this.segments)for(const c in s.vaos)s.vaos[c].destroy()}static simpleSegment(s,c,f,v){return new Cs([{vertexOffset:s,primitiveOffset:c,vertexLength:f,primitiveLength:v,vaos:{},sortKey:0}])}}Cs.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Rn(Cs,"SegmentVector");var Ci=8192;class _d{constructor(s,c){s&&(c?this.setSouthWest(s).setNorthEast(c):4===s.length?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1]))}setNorthEast(s){return this._ne=s instanceof br?new br(s.lng,s.lat):br.convert(s),this}setSouthWest(s){return this._sw=s instanceof br?new br(s.lng,s.lat):br.convert(s),this}extend(s){const c=this._sw,f=this._ne;let v,C;if(s instanceof br)v=s,C=s;else{if(!(s instanceof _d))return Array.isArray(s)?4===s.length||s.every(Array.isArray)?this.extend(_d.convert(s)):this.extend(br.convert(s)):"object"==typeof s&&null!==s&&s.hasOwnProperty("lat")&&(s.hasOwnProperty("lon")||s.hasOwnProperty("lng"))?this.extend(br.convert(s)):this;if(v=s._sw,C=s._ne,!v||!C)return this}return c||f?(c.lng=Math.min(v.lng,c.lng),c.lat=Math.min(v.lat,c.lat),f.lng=Math.max(C.lng,f.lng),f.lat=Math.max(C.lat,f.lat)):(this._sw=new br(v.lng,v.lat),this._ne=new br(C.lng,C.lat)),this}getCenter(){return new br((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new br(this.getWest(),this.getNorth())}getSouthEast(){return new br(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:c,lat:f}=br.convert(s);let v=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&v}static convert(s){return!s||s instanceof _d?s:new _d(s)}}var Em=1e-6,Ml=typeof Float32Array<"u"?Float32Array:Array;function py(){var l=new Ml(9);return Ml!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}function Tm(l,s,c){var f=s[0],v=s[1],C=s[2],S=s[3],R=s[4],N=s[5],U=s[6],W=s[7],Q=s[8],ee=c[0],oe=c[1],le=c[2],he=c[3],Ie=c[4],Le=c[5],ve=c[6],Pe=c[7],He=c[8];return l[0]=ee*f+oe*S+le*U,l[1]=ee*v+oe*R+le*W,l[2]=ee*C+oe*N+le*Q,l[3]=he*f+Ie*S+Le*U,l[4]=he*v+Ie*R+Le*W,l[5]=he*C+Ie*N+Le*Q,l[6]=ve*f+Pe*S+He*U,l[7]=ve*v+Pe*R+He*W,l[8]=ve*C+Pe*N+He*Q,l}function kl(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function Zg(l,s){var c=s[0],f=s[1],v=s[2],C=s[3],S=s[4],R=s[5],N=s[6],U=s[7],W=s[8],Q=s[9],ee=s[10],oe=s[11],le=s[12],he=s[13],Ie=s[14],Le=s[15],ve=c*R-f*S,Pe=c*N-v*S,He=c*U-C*S,Be=f*N-v*R,$e=f*U-C*R,kt=v*U-C*N,St=W*he-Q*le,Gt=W*Ie-ee*le,Qt=W*Le-oe*le,Ft=Q*Ie-ee*he,Kt=Q*Le-oe*he,Xt=ee*Le-oe*Ie,un=ve*Xt-Pe*Kt+He*Ft+Be*Qt-$e*Gt+kt*St;return un?(l[0]=(R*Xt-N*Kt+U*Ft)*(un=1/un),l[1]=(v*Kt-f*Xt-C*Ft)*un,l[2]=(he*kt-Ie*$e+Le*Be)*un,l[3]=(ee*$e-Q*kt-oe*Be)*un,l[4]=(N*Qt-S*Xt-U*Gt)*un,l[5]=(c*Xt-v*Qt+C*Gt)*un,l[6]=(Ie*He-le*kt-Le*Pe)*un,l[7]=(W*kt-ee*He+oe*Pe)*un,l[8]=(S*Kt-R*Qt+U*St)*un,l[9]=(f*Qt-c*Kt-C*St)*un,l[10]=(le*$e-he*He+Le*ve)*un,l[11]=(Q*He-W*$e-oe*ve)*un,l[12]=(R*Gt-S*Ft-N*St)*un,l[13]=(c*Ft-f*Gt+v*St)*un,l[14]=(he*Pe-le*Be-Ie*ve)*un,l[15]=(W*Be-Q*Pe+ee*ve)*un,l):null}function Dh(l,s,c){var f=s[0],v=s[1],C=s[2],S=s[3],R=s[4],N=s[5],U=s[6],W=s[7],Q=s[8],ee=s[9],oe=s[10],le=s[11],he=s[12],Ie=s[13],Le=s[14],ve=s[15],Pe=c[0],He=c[1],Be=c[2],$e=c[3];return l[0]=Pe*f+He*R+Be*Q+$e*he,l[1]=Pe*v+He*N+Be*ee+$e*Ie,l[2]=Pe*C+He*U+Be*oe+$e*Le,l[3]=Pe*S+He*W+Be*le+$e*ve,l[4]=(Pe=c[4])*f+(He=c[5])*R+(Be=c[6])*Q+($e=c[7])*he,l[5]=Pe*v+He*N+Be*ee+$e*Ie,l[6]=Pe*C+He*U+Be*oe+$e*Le,l[7]=Pe*S+He*W+Be*le+$e*ve,l[8]=(Pe=c[8])*f+(He=c[9])*R+(Be=c[10])*Q+($e=c[11])*he,l[9]=Pe*v+He*N+Be*ee+$e*Ie,l[10]=Pe*C+He*U+Be*oe+$e*Le,l[11]=Pe*S+He*W+Be*le+$e*ve,l[12]=(Pe=c[12])*f+(He=c[13])*R+(Be=c[14])*Q+($e=c[15])*he,l[13]=Pe*v+He*N+Be*ee+$e*Ie,l[14]=Pe*C+He*U+Be*oe+$e*Le,l[15]=Pe*S+He*W+Be*le+$e*ve,l}function Hp(l,s,c){var f,v,C,S,R,N,U,W,Q,ee,oe,le,he=c[0],Ie=c[1],Le=c[2];return s===l?(l[12]=s[0]*he+s[4]*Ie+s[8]*Le+s[12],l[13]=s[1]*he+s[5]*Ie+s[9]*Le+s[13],l[14]=s[2]*he+s[6]*Ie+s[10]*Le+s[14],l[15]=s[3]*he+s[7]*Ie+s[11]*Le+s[15]):(v=s[1],C=s[2],S=s[3],R=s[4],N=s[5],U=s[6],W=s[7],Q=s[8],ee=s[9],oe=s[10],le=s[11],l[0]=f=s[0],l[1]=v,l[2]=C,l[3]=S,l[4]=R,l[5]=N,l[6]=U,l[7]=W,l[8]=Q,l[9]=ee,l[10]=oe,l[11]=le,l[12]=f*he+R*Ie+Q*Le+s[12],l[13]=v*he+N*Ie+ee*Le+s[13],l[14]=C*he+U*Ie+oe*Le+s[14],l[15]=S*he+W*Ie+le*Le+s[15]),l}function yd(l,s,c){var f=c[0],v=c[1],C=c[2];return l[0]=s[0]*f,l[1]=s[1]*f,l[2]=s[2]*f,l[3]=s[3]*f,l[4]=s[4]*v,l[5]=s[5]*v,l[6]=s[6]*v,l[7]=s[7]*v,l[8]=s[8]*C,l[9]=s[9]*C,l[10]=s[10]*C,l[11]=s[11]*C,l[12]=s[12],l[13]=s[13],l[14]=s[14],l[15]=s[15],l}function jp(l,s,c){var f=Math.sin(c),v=Math.cos(c),C=s[4],S=s[5],R=s[6],N=s[7],U=s[8],W=s[9],Q=s[10],ee=s[11];return s!==l&&(l[0]=s[0],l[1]=s[1],l[2]=s[2],l[3]=s[3],l[12]=s[12],l[13]=s[13],l[14]=s[14],l[15]=s[15]),l[4]=C*v+U*f,l[5]=S*v+W*f,l[6]=R*v+Q*f,l[7]=N*v+ee*f,l[8]=U*v-C*f,l[9]=W*v-S*f,l[10]=Q*v-R*f,l[11]=ee*v-N*f,l}function Sm(l,s,c){var f=Math.sin(c),v=Math.cos(c),C=s[0],S=s[1],R=s[2],N=s[3],U=s[8],W=s[9],Q=s[10],ee=s[11];return s!==l&&(l[4]=s[4],l[5]=s[5],l[6]=s[6],l[7]=s[7],l[12]=s[12],l[13]=s[13],l[14]=s[14],l[15]=s[15]),l[0]=C*v-U*f,l[1]=S*v-W*f,l[2]=R*v-Q*f,l[3]=N*v-ee*f,l[8]=C*f+U*v,l[9]=S*f+W*v,l[10]=R*f+Q*v,l[11]=N*f+ee*v,l}function Im(l,s){return l[0]=s[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=s[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=s[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function f0(l,s,c){var f,v,C,S=c[0],R=c[1],N=c[2],U=Math.hypot(S,R,N);return U<Em?null:(S*=U=1/U,R*=U,N*=U,f=Math.sin(s),v=Math.cos(s),l[0]=S*S*(C=1-v)+v,l[1]=R*S*C+N*f,l[2]=N*S*C-R*f,l[3]=0,l[4]=S*R*C-N*f,l[5]=R*R*C+v,l[6]=N*R*C+S*f,l[7]=0,l[8]=S*N*C+R*f,l[9]=R*N*C-S*f,l[10]=N*N*C+v,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l)}Math.hypot||(Math.hypot=function(){for(var l=0,s=arguments.length;s--;)l+=arguments[s]*arguments[s];return Math.sqrt(l)});var Fw=Dh;function fy(){var l=new Ml(3);return Ml!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l}function sl(l){var s=new Ml(3);return s[0]=l[0],s[1]=l[1],s[2]=l[2],s}function vu(l){return Math.hypot(l[0],l[1],l[2])}function vd(l,s,c){var f=new Ml(3);return f[0]=l,f[1]=s,f[2]=c,f}function bd(l,s,c){return l[0]=s[0]+c[0],l[1]=s[1]+c[1],l[2]=s[2]+c[2],l}function Gp(l,s,c){return l[0]=s[0]-c[0],l[1]=s[1]-c[1],l[2]=s[2]-c[2],l}function my(l,s,c){return l[0]=s[0]*c[0],l[1]=s[1]*c[1],l[2]=s[2]*c[2],l}function qg(l,s,c){return l[0]=Math.min(s[0],c[0]),l[1]=Math.min(s[1],c[1]),l[2]=Math.min(s[2],c[2]),l}function Dm(l,s,c){return l[0]=Math.max(s[0],c[0]),l[1]=Math.max(s[1],c[1]),l[2]=Math.max(s[2],c[2]),l}function Rl(l,s,c){return l[0]=s[0]*c,l[1]=s[1]*c,l[2]=s[2]*c,l}function Lf(l,s,c,f){return l[0]=s[0]+c[0]*f,l[1]=s[1]+c[1]*f,l[2]=s[2]+c[2]*f,l}function Va(l,s){var c=s[0],f=s[1],v=s[2],C=c*c+f*f+v*v;return C>0&&(C=1/Math.sqrt(C)),l[0]=s[0]*C,l[1]=s[1]*C,l[2]=s[2]*C,l}function bu(l,s){return l[0]*s[0]+l[1]*s[1]+l[2]*s[2]}function Kg(l,s,c){var f=s[0],v=s[1],C=s[2],S=c[0],R=c[1],N=c[2];return l[0]=v*N-C*R,l[1]=C*S-f*N,l[2]=f*R-v*S,l}function ds(l,s,c){var f=s[0],v=s[1],C=s[2],S=c[3]*f+c[7]*v+c[11]*C+c[15];return l[0]=(c[0]*f+c[4]*v+c[8]*C+c[12])/(S=S||1),l[1]=(c[1]*f+c[5]*v+c[9]*C+c[13])/S,l[2]=(c[2]*f+c[6]*v+c[10]*C+c[14])/S,l}function Nw(l,s,c){var f=c[0],v=c[1],C=c[2],S=s[0],R=s[1],N=s[2],U=v*N-C*R,W=C*S-f*N,Q=f*R-v*S,ee=v*Q-C*W,oe=C*U-f*Q,le=f*W-v*U,he=2*c[3];return W*=he,Q*=he,oe*=2,le*=2,l[0]=S+(U*=he)+(ee*=2),l[1]=R+W+oe,l[2]=N+Q+le,l}var Yg,Ah=Gp,aE=my,yD=vu;function zw(l,s,c){return l[0]=s[0]*c,l[1]=s[1]*c,l[2]=s[2]*c,l[3]=s[3]*c,l}function m0(l,s){var c=s[0],f=s[1],v=s[2],C=s[3],S=c*c+f*f+v*v+C*C;return S>0&&(S=1/Math.sqrt(S)),l[0]=c*S,l[1]=f*S,l[2]=v*S,l[3]=C*S,l}function Ff(l,s,c){var f=s[0],v=s[1],C=s[2],S=s[3];return l[0]=c[0]*f+c[4]*v+c[8]*C+c[12]*S,l[1]=c[1]*f+c[5]*v+c[9]*C+c[13]*S,l[2]=c[2]*f+c[6]*v+c[10]*C+c[14]*S,l[3]=c[3]*f+c[7]*v+c[11]*C+c[15]*S,l}function Bw(){var l=new Ml(4);return Ml!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l[3]=1,l}function np(l){return l[0]=0,l[1]=0,l[2]=0,l[3]=1,l}function $p(l,s,c){c*=.5;var f=s[0],v=s[1],C=s[2],S=s[3],R=Math.sin(c),N=Math.cos(c);return l[0]=f*N+S*R,l[1]=v*N+C*R,l[2]=C*N-v*R,l[3]=S*N-f*R,l}function Am(l,s,c){c*=.5;var f=s[0],v=s[1],C=s[2],S=s[3],R=Math.sin(c),N=Math.cos(c);return l[0]=f*N-C*R,l[1]=v*N+S*R,l[2]=C*N+f*R,l[3]=S*N-v*R,l}fy(),Yg=new Ml(4),Ml!=Float32Array&&(Yg[0]=0,Yg[1]=0,Yg[2]=0,Yg[3]=0);var g0=m0;fy(),vd(1,0,0),vd(0,1,0),Bw(),Bw(),py();const Jg=Jn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Qg}=Jg,_0=Jn([{name:"a_pos_3",components:3,type:"Int16"}]);var gy=Jn([{name:"a_pos",type:"Int16",components:2}]);class Mm{constructor(s,c){this.pos=s,this.dir=c}intersectsPlane(s,c,f){const v=bu(c,this.dir);if(Math.abs(v)<1e-6)return!1;const C=((s[0]-this.pos[0])*c[0]+(s[1]-this.pos[1])*c[1]+(s[2]-this.pos[2])*c[2])/v;return f[0]=this.pos[0]+this.dir[0]*C,f[1]=this.pos[1]+this.dir[1]*C,f[2]=this.pos[2]+this.dir[2]*C,!0}closestPointOnSphere(s,c,f){if(he=(oe=this.pos)[0],Ie=oe[1],Le=oe[2],ve=(le=s)[0],Pe=le[1],He=le[2],Math.abs(he-ve)<=Em*Math.max(1,Math.abs(he),Math.abs(ve))&&Math.abs(Ie-Pe)<=Em*Math.max(1,Math.abs(Ie),Math.abs(Pe))&&Math.abs(Le-He)<=Em*Math.max(1,Math.abs(Le),Math.abs(He))||0===c)return f[0]=f[1]=f[2]=0,!1;var oe,le,he,Ie,Le,ve,Pe,He;const[v,C,S]=this.dir,R=this.pos[0]-s[0],N=this.pos[1]-s[1],U=this.pos[2]-s[2],W=v*v+C*C+S*S,Q=2*(R*v+N*C+U*S),ee=Q*Q-4*W*(R*R+N*N+U*U-c*c);if(ee<0){const oe=Math.max(-Q/2,0),le=R+v*oe,he=N+C*oe,Ie=U+S*oe,Le=Math.hypot(le,he,Ie);return f[0]=le*c/Le,f[1]=he*c/Le,f[2]=Ie*c/Le,!1}{const oe=(-Q-Math.sqrt(ee))/(2*W);if(oe<0){const le=Math.hypot(R,N,U);return f[0]=R*c/le,f[1]=N*c/le,f[2]=U*c/le,!1}return f[0]=R+v*oe,f[1]=N+C*oe,f[2]=U+S*oe,!0}}}class y0{constructor(s,c,f,v,C){this.TL=s,this.TR=c,this.BR=f,this.BL=v,this.horizon=C}static fromInvProjectionMatrix(s,c,f){const v=[-1,1,1],C=[1,1,1],S=[1,-1,1],R=[-1,-1,1],N=ds(v,v,s),U=ds(C,C,s),W=ds(S,S,s),Q=ds(R,R,s);return new y0(N,U,W,Q,c/f)}}class km{constructor(s,c){this.points=s,this.planes=c}static fromInvProjectionMatrix(s,c,f,v){const C=Math.pow(2,f),S=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(N=>{const U=Ff([],N,s),W=1/U[3]/c*C;return(Q=U)[0]=(ee=U)[0]*(oe=[W,W,v?1/U[3]:W,W])[0],Q[1]=ee[1]*oe[1],Q[2]=ee[2]*oe[2],Q[3]=ee[3]*oe[3],Q;var Q,ee,oe}),R=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(N=>{const U=Va([],Kg([],Ah([],S[N[0]],S[N[1]]),Ah([],S[N[2]],S[N[1]]))),W=-bu(U,S[N[1]]);return U.concat(W)});return new km(S,R)}}class al{static fromPoints(s){const c=[1/0,1/0,1/0],f=[-1/0,-1/0,-1/0];for(const v of s)qg(c,c,v),Dm(f,f,v);return new al(c,f)}static applyTransform(s,c){const f=s.getCorners();for(let v=0;v<f.length;++v)ds(f[v],f[v],c);return al.fromPoints(f)}constructor(s,c){this.min=s,this.max=c,this.center=Rl([],bd([],this.min,this.max),.5)}quadrant(s){const c=[s%2==0,s<2],f=sl(this.min),v=sl(this.max);for(let C=0;C<c.length;C++)f[C]=c[C]?this.min[C]:this.center[C],v[C]=c[C]?this.center[C]:this.max[C];return v[2]=this.max[2],new al(f,v)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}distanceZ(s){return Math.max(Math.min(this.max[2],s[2]),this.min[2])-s[2]}getCorners(){const s=this.min,c=this.max;return[[s[0],s[1],s[2]],[c[0],s[1],s[2]],[c[0],c[1],s[2]],[s[0],c[1],s[2]],[s[0],s[1],c[2]],[c[0],s[1],c[2]],[c[0],c[1],c[2]],[s[0],c[1],c[2]]]}intersects(s){const c=this.getCorners();let f=!0;for(let v=0;v<s.planes.length;v++){const C=s.planes[v];let S=0;for(let R=0;R<c.length;R++)S+=bu(C,c[R])+C[3]>=0;if(0===S)return 0;S!==c.length&&(f=!1)}if(f)return 2;for(let v=0;v<3;v++){let C=Number.MAX_VALUE,S=-Number.MAX_VALUE;for(let R=0;R<s.points.length;R++){const N=s.points[R][v]-this.min[v];C=Math.min(C,N),S=Math.max(S,N)}if(S<0||C>this.max[v]-this.min[v])return 0}return 1}}const Mh=Ci/Math.PI/2,ac=[64,32,16],lc=-Mh,th=Mh,Vw=[new al([lc,lc,lc],[th,th,th]),new al([lc,lc,lc],[0,0,th]),new al([0,lc,lc],[th,0,th]),new al([lc,0,lc],[0,th,th]),new al([0,0,lc],[th,th,th])];function _y(l){return l*Mh/t_}function Xg(l,s,c,f=!0){const v=Rl([],l._camera.position,l.worldSize),C=[s,c,1,1];Ff(C,C,l.pixelMatrixInverse),zw(C,C,1/C[3]);const S=Va([],Ah([],C,v)),R=l.globeMatrix,N=[R[12],R[13],R[14]],U=Ah([],N,v),W=vu(U),Q=Va([],U),ee=l.worldSize/(2*Math.PI),oe=bu(Q,S),le=Math.asin(ee/W);if(le<Math.acos(oe)){if(!f)return null;const Qt=[],Ft=[];Rl(Qt,S,W/oe),Va(Ft,Ah(Ft,Qt,U)),Va(S,bd(S,U,Rl(S,Ft,Math.tan(le)*W)))}const he=[];new Mm(v,S).closestPointOnSphere(N,ee,he);const Ie=Va([],jn(R,0)),Le=Va([],jn(R,1)),ve=Va([],jn(R,2)),Pe=bu(Ie,he),He=bu(Le,he),Be=bu(ve,he),$e=zt(Math.asin(-He/ee));let kt=zt(Math.atan2(Pe,Be));kt=l.center.lng+function(Qt,Ft){const Kt=(Ft-Qt+180)%360-180;return Kt<-180?Kt+360:Kt}(l.center.lng,kt);const St=kh(kt),Gt=It(cc($e),0,1);return new zm(St,Gt)}class Uw{constructor(s,c,f){this.a=Ah([],s,f),this.b=Ah([],c,f),this.center=f;const v=Va([],this.a),C=Va([],this.b);this.angle=Math.acos(bu(v,C))}}function e_(l,s){if(0===l.angle)return null;let c;return c=0===l.a[s]?1/l.angle*.5*Math.PI:1/l.angle*Math.atan(l.b[s]/l.a[s]/Math.sin(l.angle)-1/Math.tan(l.angle)),c<0||c>1?null:function(f,v,C,S){const R=Math.sin(C);return f*(Math.sin((1-S)*C)/R)+v*(Math.sin(S*C)/R)}(l.a[s],l.b[s],l.angle,It(c,0,1))+l.center[s]}function Pl(l){if(l.z<=1)return Vw[l.z+2*l.y+l.x];const s=v0(Nf(l));return al.fromPoints(s)}function nh(l,s,c){return Rl(l,l,1-c),Lf(l,l,s,c)}function yy(l,s){const c=Lm(s.zoom);if(0===c)return Pl(l);const f=Nf(l),v=v0(f),C=kh(f.getWest())*s.worldSize,S=kh(f.getEast())*s.worldSize,R=cc(f.getNorth())*s.worldSize,N=cc(f.getSouth())*s.worldSize,U=[C,R,0],W=[S,R,0],Q=[C,N,0],ee=[S,N,0],oe=Zg([],s.globeMatrix);return ds(U,U,oe),ds(W,W,oe),ds(Q,Q,oe),ds(ee,ee,oe),v[0]=nh(v[0],Q,c),v[1]=nh(v[1],ee,c),v[2]=nh(v[2],W,c),v[3]=nh(v[3],U,c),al.fromPoints(v)}function lE(l,s,c){for(const f of l)ds(f,f,s),Rl(f,f,c)}function Nf({x:l,y:s,z:c}){const f=1/(1<<c),v=new br(uc(l*f),Ua((s+1)*f)),C=new br(uc((l+1)*f),Ua(s*f));return new _d(v,C)}function v0(l){const s=it(l.getNorth()),c=it(l.getSouth()),f=Math.cos(s),v=Math.cos(c),C=Math.sin(s),S=Math.sin(c),R=l.getWest(),N=l.getEast();return[Rm(v,S,R),Rm(v,S,N),Rm(f,C,N),Rm(f,C,R)]}function Rm(l,s,c,f=Mh){return c=it(c),[l*Math.sin(c)*f,-s*f,l*Math.cos(c)*f]}function zf(l,s,c){return Rm(Math.cos(it(l)),Math.sin(it(l)),s,c)}function Pm(l,s,c,f){const v=1<<c.z,C=(l/Ci+c.x)/v;return zf(Ua((s/Ci+c.y)/v),uc(C),f)}function Wp({min:l,max:s}){return 16383/Math.max(s[0]-l[0],s[1]-l[1],s[2]-l[2])}const Hw=new Float64Array(16);function Om(l){const s=Wp(l),c=Im(Hw,[s,s,s]);return Hp(c,c,((f=[])[0]=-(v=l.min)[0],f[1]=-v[1],f[2]=-v[2],f));var f,v}function b0(l){const s=(f=l.min,(c=Hw)[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=f[0],c[13]=f[1],c[14]=f[2],c[15]=1,c);var c,f;const v=1/Wp(l);return yd(s,s,[v,v,v])}function zs(l,s,c,f,v){const C=function(N){const U=Ci/(2*Math.PI);return N/(2*Math.PI)/U}(c),S=[l,s,-c/(2*Math.PI)],R=kl(new Float64Array(16));return Hp(R,R,S),yd(R,R,[C,C,C]),jp(R,R,it(-v)),Sm(R,R,it(-f)),R}function Lm(l){return Vt(5,6,l)}function cE(l,s){const c=zf(s.lat,s.lng);return S=(v=Gp([],function(le){const he=zf(le._center.lat,le._center.lng);let Ie=Kg([],vd(0,1,0),he);const Le=f0([],-le.angle,he);Ie=ds(Ie,Ie,Le),f0(Le,-le._pitch,Ie);const ve=Va([],he);return Rl(ve,ve,_y(le.cameraToCenterDistance/le.pixelsPerMeter)),ds(ve,ve,Le),bd([],he,ve)}(l),c))[0],R=v[1],N=v[2],U=(C=c)[0],W=C[1],Q=C[2],oe=(ee=Math.sqrt(S*S+R*R+N*N)*Math.sqrt(U*U+W*W+Q*Q))&&bu(v,C)/ee,Math.acos(Math.min(Math.max(oe,-1),1));var v,C,S,R,N,U,W,Q,ee,oe}function Fm(l,s){return cE(l,s)>Math.PI/2*1.01}const w0=it(85),jw=Math.cos(w0),x0=Math.sin(w0),t_=6371008.8,uE=2*Math.PI*t_;class br{constructor(s,c){if(isNaN(s)||isNaN(c))throw new Error(`Invalid LngLat object: (${s}, ${c})`);if(this.lng=+s,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new br(wn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const c=Math.PI/180,f=this.lat*c,v=s.lat*c,C=Math.sin(f)*Math.sin(v)+Math.cos(f)*Math.cos(v)*Math.cos((s.lng-this.lng)*c);return t_*Math.acos(Math.min(C,1))}toBounds(s=0){const c=360*s/40075017,f=c/Math.cos(Math.PI/180*this.lat);return new _d(new br(this.lng-f,this.lat-c),new br(this.lng+f,this.lat+c))}toEcef(s){const c=_y(s);return zf(this.lat,this.lng,Mh+c)}static convert(s){if(s instanceof br)return s;if(Array.isArray(s)&&(2===s.length||3===s.length))return new br(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&"object"==typeof s&&null!==s)return new br(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function Nm(l){return uE*Math.cos(l*Math.PI/180)}function kh(l){return(180+l)/360}function cc(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function Gc(l,s){return l/Nm(s)}function uc(l){return 360*l-180}function Ua(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function C0(l,s){return l*Nm(Ua(s))}const Da=85.051129;function hE(l){return 1/Math.cos(l*Math.PI/180)}class zm{constructor(s,c,f=0){this.x=+s,this.y=+c,this.z=+f}static fromLngLat(s,c=0){const f=br.convert(s);return new zm(kh(f.lng),cc(f.lat),Gc(c,f.lat))}toLngLat(){return new br(uc(this.x),Ua(this.y))}toAltitude(){return C0(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/uE*hE(Ua(this.y))}}function E0(l,s,c,f,v,C,S,R,N){const U=(s+f)/2,W=(c+v)/2,Q=new st(U,W);R(Q),function(ee,oe,le,he,Ie,Le){const ve=le-Ie,Pe=he-Le;return Math.abs((he-oe)*ve-(le-ee)*Pe)/Math.hypot(ve,Pe)}(Q.x,Q.y,C.x,C.y,S.x,S.y)>=N?(E0(l,s,c,U,W,C,Q,R,N),E0(l,U,W,f,v,Q,S,R,N)):l.push(S)}function T0(l,s,c){let f=l[0],v=f.x,C=f.y;s(f);const S=[f];for(let R=1;R<l.length;R++){const N=l[R],{x:U,y:W}=N;s(N),E0(S,v,C,U,W,f,N,s,c),v=U,C=W,f=N}return S}function Gw(l,s,c,f){if(f(s,c)){const v=s.add(c)._mult(.5);Gw(l,s,v,f),Gw(l,v,c,f)}else l.push(c)}function by(l,s){let c=l[0];const f=[c];for(let v=1;v<l.length;v++){const C=l[v];Gw(f,c,C,s),c=C}return f}const S0=Math.pow(2,14)-1,n_=-S0-1;function Bm(l,s){const c=Math.round(l.x*s),f=Math.round(l.y*s);return l.x=It(c,n_,S0),l.y=It(f,n_,S0),(c<l.x||c>l.x+1||f<l.y||f>l.y+1)&&Ar("Geometry exceeds allowed extent, reduce your vector tile buffer size"),l}function xd(l,s,c){const f=l.loadGeometry(),v=l.extent,C=Ci/v;if(s&&c&&c.projection.isReprojectedInTileSpace){const S=1<<s.z,{scale:R,x:N,y:U,projection:W}=c,Q=ee=>{const oe=uc((s.x+ee.x/v)/S),le=Ua((s.y+ee.y/v)/S),he=W.project(oe,le);ee.x=(he.x*R-N)*v,ee.y=(he.y*R-U)*v};for(let ee=0;ee<f.length;ee++)if(1!==l.type)f[ee]=T0(f[ee],Q,1);else{const oe=[];for(const le of f[ee])le.x<0||le.x>=v||le.y<0||le.y>=v||(Q(le),oe.push(le));f[ee]=oe}}for(const S of f)for(const R of S)Bm(R,C);return f}function wu(l,s){return{type:l.type,id:l.id,properties:l.properties,geometry:s?xd(l):[]}}function i_(l,s,c,f,v){l.emplaceBack(2*s+(f+1)/2,2*c+(v+1)/2)}function Vm(l,s,c){l.emplaceBack(s.x,s.y,s.z,16384*c[0],16384*c[1],16384*c[2])}class r_{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.projection=s.projection,this.layoutVertexArray=new hi,this.indexArray=new Ns,this.segments=new Cs,this.programConfigurations=new xm(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,f,v){const C=this.layers[0],S=[];let R=null;"circle"===C.type&&(R=C.layout.get("circle-sort-key"));for(const{feature:U,id:W,index:Q,sourceLayerIndex:ee}of s){const oe=this.layers[0]._featureFilter.needGeometry,le=wu(U,oe);if(!this.layers[0]._featureFilter.filter(new ut(this.zoom),le,f))continue;const he=R?R.evaluate(le,{},f):void 0,Ie={id:W,properties:U.properties,type:U.type,sourceLayerIndex:ee,index:Q,geometry:oe?le.geometry:xd(U,f,v),patterns:{},sortKey:he};S.push(Ie)}R&&S.sort((U,W)=>U.sortKey-W.sortKey);let N=null;"globe"===v.projection.name&&(this.globeExtVertexArray=new Dl,N=v.projection);for(const U of S){const{geometry:W,index:Q,sourceLayerIndex:ee}=U,oe=s[Q].feature;this.addFeature(U,W,Q,c.availableImages,f,N),c.featureIndex.insert(oe,W,Q,ee,this.index)}}update(s,c,f,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,f,v)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,sE.members),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,Of.members))),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(s,c,f,v,C,S){for(const R of c)for(const N of R){const U=N.x,W=N.y;if(U<0||U>=Ci||W<0||W>=Ci)continue;if(S){const oe=S.projectTilePoint(U,W,C),le=S.upVector(C,U,W),he=this.globeExtVertexArray;Vm(he,oe,le),Vm(he,oe,le),Vm(he,oe,le),Vm(he,oe,le)}const Q=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),ee=Q.vertexLength;i_(this.layoutVertexArray,U,W,-1,-1),i_(this.layoutVertexArray,U,W,1,-1),i_(this.layoutVertexArray,U,W,1,1),i_(this.layoutVertexArray,U,W,-1,1),this.indexArray.emplaceBack(ee,ee+1,ee+2),this.indexArray.emplaceBack(ee,ee+2,ee+3),Q.vertexLength+=4,Q.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,{},v,C)}}function I0(l,s){for(let c=0;c<l.length;c++)if($c(s,l[c]))return!0;for(let c=0;c<s.length;c++)if($c(l,s[c]))return!0;return!!o_(l,s)}function D0(l,s,c){return!!$c(l,s)||!!A0(s,l,c)}function Um(l,s){if(1===l.length)return k0(s,l[0]);for(let c=0;c<s.length;c++){const f=s[c];for(let v=0;v<f.length;v++)if($c(l,f[v]))return!0}for(let c=0;c<l.length;c++)if(k0(s,l[c]))return!0;for(let c=0;c<s.length;c++)if(o_(l,s[c]))return!0;return!1}function Bf(l,s,c){if(l.length>1){if(o_(l,s))return!0;for(let f=0;f<s.length;f++)if(A0(s[f],l,c))return!0}for(let f=0;f<l.length;f++)if(A0(l[f],s,c))return!0;return!1}function o_(l,s){if(0===l.length||0===s.length)return!1;for(let c=0;c<l.length-1;c++){const f=l[c],v=l[c+1];for(let C=0;C<s.length-1;C++)if(wy(f,v,s[C],s[C+1]))return!0}return!1}function wy(l,s,c,f){return ys(l,c,f)!==ys(s,c,f)&&ys(l,s,c)!==ys(l,s,f)}function A0(l,s,c){const f=c*c;if(1===s.length)return l.distSqr(s[0])<f;for(let v=1;v<s.length;v++)if(M0(l,s[v-1],s[v])<f)return!0;return!1}function M0(l,s,c){const f=s.distSqr(c);if(0===f)return l.distSqr(s);const v=((l.x-s.x)*(c.x-s.x)+(l.y-s.y)*(c.y-s.y))/f;return l.distSqr(v<0?s:v>1?c:c.sub(s)._mult(v)._add(s))}function k0(l,s){let c,f,v,C=!1;for(let S=0;S<l.length;S++){c=l[S];for(let R=0,N=c.length-1;R<c.length;N=R++)f=c[R],v=c[N],f.y>s.y!=v.y>s.y&&s.x<(v.x-f.x)*(s.y-f.y)/(v.y-f.y)+f.x&&(C=!C)}return C}function $c(l,s){let c=!1;for(let f=0,v=l.length-1;f<l.length;v=f++){const C=l[f],S=l[v];C.y>s.y!=S.y>s.y&&s.x<(S.x-C.x)*(s.y-C.y)/(S.y-C.y)+C.x&&(c=!c)}return c}function $w(l,s,c,f,v){for(const S of l)if(s<=S.x&&c<=S.y&&f>=S.x&&v>=S.y)return!0;const C=[new st(s,c),new st(s,v),new st(f,v),new st(f,c)];if(l.length>2)for(const S of C)if($c(l,S))return!0;for(let S=0;S<l.length-1;S++)if(R0(l[S],l[S+1],C))return!0;return!1}function R0(l,s,c){const f=c[0],v=c[2];if(l.x<f.x&&s.x<f.x||l.x>v.x&&s.x>v.x||l.y<f.y&&s.y<f.y||l.y>v.y&&s.y>v.y)return!1;const C=ys(l,s,c[0]);return C!==ys(l,s,c[1])||C!==ys(l,s,c[2])||C!==ys(l,s,c[3])}function Hm(l,s,c){const f=s.paint.get(l).value;return"constant"===f.kind?f.value:c.programConfigurations.get(s.id).getMaxValue(l)}function Zp(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function P0(l,s,c,f,v){if(!s[0]&&!s[1])return l;const C=st.convert(s)._mult(v);"viewport"===c&&C._rotate(-f);const S=[];for(let R=0;R<l.length;R++)S.push(l[R].sub(C));return S}function O0(l,s,c,f){const v=st.convert(l)._mult(f);return"viewport"===s&&v._rotate(-c),v}Rn(r_,"CircleBucket",{omit:["layers"]});const Ww=new hn({"circle-sort-key":new Pt(Rt.layout_circle["circle-sort-key"])});var Zw={paint:new hn({"circle-radius":new Pt(Rt.paint_circle["circle-radius"]),"circle-color":new Pt(Rt.paint_circle["circle-color"]),"circle-blur":new Pt(Rt.paint_circle["circle-blur"]),"circle-opacity":new Pt(Rt.paint_circle["circle-opacity"]),"circle-translate":new yt(Rt.paint_circle["circle-translate"]),"circle-translate-anchor":new yt(Rt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new yt(Rt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new yt(Rt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Pt(Rt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Pt(Rt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Pt(Rt.paint_circle["circle-stroke-opacity"])}),layout:Ww};function qw(l,s,c,f,v,C,S,R,N){if(C&&l.queryGeometry.isAboveHorizon)return!1;C&&(N*=l.pixelToTileUnitsFactor);const U=l.tileID.canonical,W=c.projection.upVectorScale(U,c.center.lat,c.worldSize).metersToTile;for(const Q of s)for(const ee of Q){const oe=ee.add(R),le=v&&c.elevation?c.elevation.exaggeration()*v.getElevationAt(oe.x,oe.y,!0):0,he=c.projection.projectTilePoint(oe.x,oe.y,U);if(le>0){const Pe=c.projection.upVector(U,oe.x,oe.y);he.x+=Pe[0]*W*le,he.y+=Pe[1]*W*le,he.z+=Pe[2]*W*le}const Ie=C?oe:dE(he.x,he.y,he.z,f),Le=C?l.tilespaceRays.map(Pe=>jm(Pe,le)):l.queryGeometry.screenGeometry,ve=Ff([],[he.x,he.y,he.z,1],f);if(!S&&C?N*=ve[3]/c.cameraToCenterDistance:S&&!C&&(N*=c.cameraToCenterDistance/ve[3]),C){const Pe=Ua((ee.y/Ci+U.y)/(1<<U.z));N/=c.projection.pixelsPerMeter(Pe,1)/Gc(1,Pe)}if(D0(Le,Ie,N))return!0}return!1}function dE(l,s,c,f){const v=Ff([],[l,s,c,1],f);return new st(v[0]/v[3],v[1]/v[3])}const qp=vd(0,0,0),pE=vd(0,0,1);function jm(l,s){const c=fy();return qp[2]=s,l.intersectsPlane(qp,pE,c),new st(c[0],c[1])}class Vf extends r_{}function Kw(l,{width:s,height:c},f,v){if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==s*c*f)throw new RangeError("mismatched image size")}else v=new Uint8Array(s*c*f);return l.width=s,l.height=c,l.data=v,l}function Yw(l,s,c){const{width:f,height:v}=s;f===l.width&&v===l.height||(s_(l,s,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,f),height:Math.min(l.height,v)},c),l.width=f,l.height=v,l.data=s.data)}function s_(l,s,c,f,v,C){if(0===v.width||0===v.height)return s;if(v.width>l.width||v.height>l.height||c.x>l.width-v.width||c.y>l.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>s.width||v.height>s.height||f.x>s.width-v.width||f.y>s.height-v.height)throw new RangeError("out of range destination coordinates for image copy");const S=l.data,R=s.data;for(let N=0;N<v.height;N++){const U=((c.y+N)*l.width+c.x)*C,W=((f.y+N)*s.width+f.x)*C;for(let Q=0;Q<v.width*C;Q++)R[W+Q]=S[U+Q]}return s}Rn(Vf,"HeatmapBucket",{omit:["layers"]});class ip{constructor(s,c){Kw(this,s,1,c)}resize(s){Yw(this,new ip(s),1)}clone(){return new ip({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,f,v,C){s_(s,c,f,v,C,1)}}class hc{constructor(s,c){Kw(this,s,4,c)}resize(s){Yw(this,new hc(s),4)}replace(s,c){c?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new hc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,f,v,C){s_(s,c,f,v,C,4)}}Rn(ip,"AlphaImage"),Rn(hc,"RGBAImage");var L0={paint:new hn({"heatmap-radius":new Pt(Rt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Pt(Rt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new yt(Rt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new tn(Rt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new yt(Rt.paint_heatmap["heatmap-opacity"])})};function Cd(l){const s={},c=l.resolution||256,f=l.clips?l.clips.length:1,v=l.image||new hc({width:c,height:f}),C=(S,R,N)=>{s[l.evaluationKey]=N;const U=l.expression.evaluate(s);v.data[S+R+0]=Math.floor(255*U.r/U.a),v.data[S+R+1]=Math.floor(255*U.g/U.a),v.data[S+R+2]=Math.floor(255*U.b/U.a),v.data[S+R+3]=Math.floor(255*U.a)};if(l.clips)for(let S=0,R=0;S<f;++S,R+=4*c)for(let N=0,U=0;N<c;N++,U+=4){const W=N/(c-1),{start:Q,end:ee}=l.clips[S];C(R,U,Q*(1-W)+ee*W)}else for(let S=0,R=0;S<c;S++,R+=4)C(0,R,S/(c-1));return v}var F0={paint:new hn({"hillshade-illumination-direction":new yt(Rt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new yt(Rt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new yt(Rt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new yt(Rt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new yt(Rt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new yt(Rt.paint_hillshade["hillshade-accent-color"])})};const xy=Jn([{name:"a_pos",components:2,type:"Int16"}],4),{members:fE}=xy;var rp={};function Kp(l,s,c){c=c||2;var f,v,C,S,R,N,U,W=s&&s.length,Q=W?s[0]*c:l.length,ee=Jw(l,0,Q,c,!0),oe=[];if(!ee||ee.next===ee.prev)return oe;if(W&&(ee=function(he,Ie,Le,ve){var Pe,He,Be,$e=[];for(Pe=0,He=Ie.length;Pe<He;Pe++)(Be=Jw(he,Ie[Pe]*ve,Pe<He-1?Ie[Pe+1]*ve:he.length,ve,!1))===Be.next&&(Be.steiner=!0),$e.push(U2(Be));for($e.sort($m),Pe=0;Pe<$e.length;Pe++)Le=Ed($e[Pe],Le);return Le}(l,s,ee,c)),l.length>80*c){f=C=l[0],v=S=l[1];for(var le=c;le<Q;le+=c)(R=l[le])<f&&(f=R),(N=l[le+1])<v&&(v=N),R>C&&(C=R),N>S&&(S=N);U=0!==(U=Math.max(C-f,S-v))?32767/U:0}return Gm(ee,oe,c,f,v,U,0),oe}function Jw(l,s,c,f,v){var C,S;if(v===ex(l,s,c,f)>0)for(C=s;C<c;C+=f)S=Rh(C,l[C],l[C+1],S);else for(C=c-f;C>=s;C-=f)S=Rh(C,l[C],l[C+1],S);return S&&a_(S,S.next)&&(Iy(S),S=S.next),S}function op(l,s){if(!l)return l;s||(s=l);var c,f=l;do{if(c=!1,f.steiner||!a_(f,f.next)&&0!==Js(f.prev,f,f.next))f=f.next;else{if(Iy(f),(f=s=f.prev)===f.next)break;c=!0}}while(c||f!==s);return s}function Gm(l,s,c,f,v,C,S){if(l){!S&&C&&function(W,Q,ee,oe){var le=W;do{0===le.z&&(le.z=Cy(le.x,le.y,Q,ee,oe)),le.prevZ=le.prev,le.nextZ=le.next,le=le.next}while(le!==W);le.prevZ.nextZ=null,le.prevZ=null,function(he){var Ie,Le,ve,Pe,He,Be,$e,kt,St=1;do{for(Le=he,he=null,He=null,Be=0;Le;){for(Be++,ve=Le,$e=0,Ie=0;Ie<St&&($e++,ve=ve.nextZ);Ie++);for(kt=St;$e>0||kt>0&&ve;)0!==$e&&(0===kt||!ve||Le.z<=ve.z)?(Pe=Le,Le=Le.nextZ,$e--):(Pe=ve,ve=ve.nextZ,kt--),He?He.nextZ=Pe:he=Pe,Pe.prevZ=He,He=Pe;Le=ve}He.nextZ=null,St*=2}while(Be>1)}(le)}(l,f,v,C);for(var R,N,U=l;l.prev!==l.next;)if(R=l.prev,N=l.next,C?N0(l,f,v,C):mE(l))s.push(R.i/c|0),s.push(l.i/c|0),s.push(N.i/c|0),Iy(l),l=N.next,U=N.next;else if((l=N)===U){S?1===S?Gm(l=gE(op(l),s,c),s,c,f,v,C,2):2===S&&Qw(l,s,c,f,v,C):Gm(op(l),s,c,f,v,C,1);break}}}function mE(l){var s=l.prev,c=l,f=l.next;if(Js(s,c,f)>=0)return!1;for(var v=s.x,C=c.x,S=f.x,R=s.y,N=c.y,U=f.y,W=v<C?v<S?v:S:C<S?C:S,Q=R<N?R<U?R:U:N<U?N:U,ee=v>C?v>S?v:S:C>S?C:S,oe=R>N?R>U?R:U:N>U?N:U,le=f.next;le!==s;){if(le.x>=W&&le.x<=ee&&le.y>=Q&&le.y<=oe&&Ey(v,R,C,N,S,U,le.x,le.y)&&Js(le.prev,le,le.next)>=0)return!1;le=le.next}return!0}function N0(l,s,c,f){var v=l.prev,C=l,S=l.next;if(Js(v,C,S)>=0)return!1;for(var R=v.x,N=C.x,U=S.x,W=v.y,Q=C.y,ee=S.y,oe=R<N?R<U?R:U:N<U?N:U,le=W<Q?W<ee?W:ee:Q<ee?Q:ee,he=R>N?R>U?R:U:N>U?N:U,Ie=W>Q?W>ee?W:ee:Q>ee?Q:ee,Le=Cy(oe,le,s,c,f),ve=Cy(he,Ie,s,c,f),Pe=l.prevZ,He=l.nextZ;Pe&&Pe.z>=Le&&He&&He.z<=ve;){if(Pe.x>=oe&&Pe.x<=he&&Pe.y>=le&&Pe.y<=Ie&&Pe!==v&&Pe!==S&&Ey(R,W,N,Q,U,ee,Pe.x,Pe.y)&&Js(Pe.prev,Pe,Pe.next)>=0||(Pe=Pe.prevZ,He.x>=oe&&He.x<=he&&He.y>=le&&He.y<=Ie&&He!==v&&He!==S&&Ey(R,W,N,Q,U,ee,He.x,He.y)&&Js(He.prev,He,He.next)>=0))return!1;He=He.nextZ}for(;Pe&&Pe.z>=Le;){if(Pe.x>=oe&&Pe.x<=he&&Pe.y>=le&&Pe.y<=Ie&&Pe!==v&&Pe!==S&&Ey(R,W,N,Q,U,ee,Pe.x,Pe.y)&&Js(Pe.prev,Pe,Pe.next)>=0)return!1;Pe=Pe.prevZ}for(;He&&He.z<=ve;){if(He.x>=oe&&He.x<=he&&He.y>=le&&He.y<=Ie&&He!==v&&He!==S&&Ey(R,W,N,Q,U,ee,He.x,He.y)&&Js(He.prev,He,He.next)>=0)return!1;He=He.nextZ}return!0}function gE(l,s,c){var f=l;do{var v=f.prev,C=f.next.next;!a_(v,C)&&Xw(v,f,f.next,C)&&Sy(v,C)&&Sy(C,v)&&(s.push(v.i/c|0),s.push(f.i/c|0),s.push(C.i/c|0),Iy(f),Iy(f.next),f=l=C),f=f.next}while(f!==l);return op(f)}function Qw(l,s,c,f,v,C){var S=l;do{for(var R=S.next.next;R!==S.prev;){if(S.i!==R.i&&yE(S,R)){var N=vE(S,R);return S=op(S,S.next),N=op(N,N.next),Gm(S,s,c,f,v,C,0),void Gm(N,s,c,f,v,C,0)}R=R.next}S=S.next}while(S!==l)}function $m(l,s){return l.x-s.x}function Ed(l,s){var c=function(v,C){var S,R=C,N=v.x,U=v.y,W=-1/0;do{if(U<=R.y&&U>=R.next.y&&R.next.y!==R.y){var Q=R.x+(U-R.y)*(R.next.x-R.x)/(R.next.y-R.y);if(Q<=N&&Q>W&&(W=Q,S=R.x<R.next.x?R:R.next,Q===N))return S}R=R.next}while(R!==C);if(!S)return null;var ee,oe=S,le=S.x,he=S.y,Ie=1/0;R=S;do{N>=R.x&&R.x>=le&&N!==R.x&&Ey(U<he?N:W,U,le,he,U<he?W:N,U,R.x,R.y)&&(ee=Math.abs(U-R.y)/(N-R.x),Sy(R,v)&&(ee<Ie||ee===Ie&&(R.x>S.x||R.x===S.x&&_E(S,R)))&&(S=R,Ie=ee)),R=R.next}while(R!==oe);return S}(l,s);if(!c)return s;var f=vE(c,l);return op(f,f.next),op(c,c.next)}function _E(l,s){return Js(l.prev,l,s.prev)<0&&Js(s.next,l,l.next)<0}function Cy(l,s,c,f,v){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-c)*v|0)|l<<8))|l<<4))|l<<2))|l<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-f)*v|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function U2(l){var s=l,c=l;do{(s.x<c.x||s.x===c.x&&s.y<c.y)&&(c=s),s=s.next}while(s!==l);return c}function Ey(l,s,c,f,v,C,S,R){return(v-S)*(s-R)>=(l-S)*(C-R)&&(l-S)*(f-R)>=(c-S)*(s-R)&&(c-S)*(C-R)>=(v-S)*(f-R)}function yE(l,s){return l.next.i!==s.i&&l.prev.i!==s.i&&!function(c,f){var v=c;do{if(v.i!==c.i&&v.next.i!==c.i&&v.i!==f.i&&v.next.i!==f.i&&Xw(v,v.next,c,f))return!0;v=v.next}while(v!==c);return!1}(l,s)&&(Sy(l,s)&&Sy(s,l)&&function(c,f){var v=c,C=!1,S=(c.x+f.x)/2,R=(c.y+f.y)/2;do{v.y>R!=v.next.y>R&&v.next.y!==v.y&&S<(v.next.x-v.x)*(R-v.y)/(v.next.y-v.y)+v.x&&(C=!C),v=v.next}while(v!==c);return C}(l,s)&&(Js(l.prev,l,s.prev)||Js(l,s.prev,s))||a_(l,s)&&Js(l.prev,l,l.next)>0&&Js(s.prev,s,s.next)>0)}function Js(l,s,c){return(s.y-l.y)*(c.x-s.x)-(s.x-l.x)*(c.y-s.y)}function a_(l,s){return l.x===s.x&&l.y===s.y}function Xw(l,s,c,f){var v=Ty(Js(l,s,c)),C=Ty(Js(l,s,f)),S=Ty(Js(c,f,l)),R=Ty(Js(c,f,s));return v!==C&&S!==R||!(0!==v||!z0(l,c,s))||!(0!==C||!z0(l,f,s))||!(0!==S||!z0(c,l,f))||!(0!==R||!z0(c,s,f))}function z0(l,s,c){return s.x<=Math.max(l.x,c.x)&&s.x>=Math.min(l.x,c.x)&&s.y<=Math.max(l.y,c.y)&&s.y>=Math.min(l.y,c.y)}function Ty(l){return l>0?1:l<0?-1:0}function Sy(l,s){return Js(l.prev,l,l.next)<0?Js(l,s,l.next)>=0&&Js(l,l.prev,s)>=0:Js(l,s,l.prev)<0||Js(l,l.next,s)<0}function vE(l,s){var c=new Uf(l.i,l.x,l.y),f=new Uf(s.i,s.x,s.y),v=l.next,C=s.prev;return l.next=s,s.prev=l,c.next=v,v.prev=c,f.next=c,c.prev=f,C.next=f,f.prev=C,f}function Rh(l,s,c,f){var v=new Uf(l,s,c);return f?(v.next=f.next,v.prev=f,f.next.prev=v,f.next=v):(v.prev=v,v.next=v),v}function Iy(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function Uf(l,s,c){this.i=l,this.x=s,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ex(l,s,c,f){for(var v=0,C=s,S=c-f;C<c;C+=f)v+=(l[S]-l[C])*(l[C+1]+l[S+1]),S=C;return v}function tx(l,s,c,f,v){nx(l,s,c||0,f||l.length-1,v||l_)}function nx(l,s,c,f,v){for(;f>c;){if(f-c>600){var C=f-c+1,S=s-c+1,R=Math.log(C),N=.5*Math.exp(2*R/3),U=.5*Math.sqrt(R*N*(C-N)/C)*(S-C/2<0?-1:1);nx(l,s,Math.max(c,Math.floor(s-S*N/C+U)),Math.min(f,Math.floor(s+(C-S)*N/C+U)),v)}var W=l[s],Q=c,ee=f;for(xu(l,c,s),v(l[f],W)>0&&xu(l,c,f);Q<ee;){for(xu(l,Q,ee),Q++,ee--;v(l[Q],W)<0;)Q++;for(;v(l[ee],W)>0;)ee--}0===v(l[c],W)?xu(l,c,ee):xu(l,++ee,f),ee<=s&&(c=ee+1),s<=ee&&(f=ee-1)}}function xu(l,s,c){var f=l[s];l[s]=l[c],l[c]=f}function l_(l,s){return l<s?-1:l>s?1:0}function ih(l,s){const c=l.length;if(c<=1)return[l];const f=[];let v,C;for(let S=0;S<c;S++){const R=qi(l[S]);0!==R&&(l[S].area=Math.abs(R),void 0===C&&(C=R<0),C===R<0?(v&&f.push(v),v=[l[S]]):v.push(l[S]))}if(v&&f.push(v),s>1)for(let S=0;S<f.length;S++)f[S].length<=s||(tx(f[S],s,1,f[S].length-1,vD),f[S]=f[S].slice(0,s));return f}function vD(l,s){return s.area-l.area}function Dy(l,s,c){const f=c.patternDependencies;let v=!1;for(const C of s){const S=C.paint.get(`${l}-pattern`);S.isConstant()||(v=!0);const R=S.constantOr(null);R&&(v=!0,f[R]=!0)}return v}function Ti(l,s,c,f,v){const C=v.patternDependencies;for(const S of s){const R=S.paint.get(`${l}-pattern`).value;if("constant"!==R.kind){let N=R.evaluate({zoom:f},c,{},v.availableImages);N=N&&N.name?N.name:N,C[N]=!0,c.patterns[S.id]=N}}return c}({get exports(){return rp},set exports(l){rp=l}}).exports=Kp,rp.default=Kp,Kp.deviation=function(l,s,c,f){var v=s&&s.length,C=Math.abs(ex(l,0,v?s[0]*c:l.length,c));if(v)for(var S=0,R=s.length;S<R;S++)C-=Math.abs(ex(l,s[S]*c,S<R-1?s[S+1]*c:l.length,c));var N=0;for(S=0;S<f.length;S+=3){var U=f[S]*c,W=f[S+1]*c,Q=f[S+2]*c;N+=Math.abs((l[U]-l[Q])*(l[W+1]-l[U+1])-(l[U]-l[W])*(l[Q+1]-l[U+1]))}return 0===C&&0===N?0:Math.abs((N-C)/C)},Kp.flatten=function(l){for(var s=l[0][0].length,c={vertices:[],holes:[],dimensions:s},f=0,v=0;v<l.length;v++){for(var C=0;C<l[v].length;C++)for(var S=0;S<s;S++)c.vertices.push(l[v][C][S]);v>0&&c.holes.push(f+=l[v-1].length)}return c};class c_{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new hi,this.indexArray=new Ns,this.indexArray2=new yo,this.programConfigurations=new xm(s.layers,s.zoom),this.segments=new Cs,this.segments2=new Cs,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.projection=s.projection}populate(s,c,f,v){this.hasPattern=Dy("fill",this.layers,c);const C=this.layers[0].layout.get("fill-sort-key"),S=[];for(const{feature:R,id:N,index:U,sourceLayerIndex:W}of s){const Q=this.layers[0]._featureFilter.needGeometry,ee=wu(R,Q);if(!this.layers[0]._featureFilter.filter(new ut(this.zoom),ee,f))continue;const oe=C?C.evaluate(ee,{},f,c.availableImages):void 0,le={id:N,properties:R.properties,type:R.type,sourceLayerIndex:W,index:U,geometry:Q?ee.geometry:xd(R,f,v),patterns:{},sortKey:oe};S.push(le)}C&&S.sort((R,N)=>R.sortKey-N.sortKey);for(const R of S){const{geometry:N,index:U,sourceLayerIndex:W}=R;if(this.hasPattern){const Q=Ti("fill",this.layers,R,this.zoom,c);this.patternFeatures.push(Q)}else this.addFeature(R,N,U,f,{},c.availableImages);c.featureIndex.insert(s[U].feature,N,U,W,this.index)}}update(s,c,f,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,f,v)}addFeatures(s,c,f,v,C){for(const S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,c,f,v)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,fE),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,c,f,v,C,S=[]){for(const R of ih(c,500)){let N=0;for(const le of R)N+=le.length;const U=this.segments.prepareSegment(N,this.layoutVertexArray,this.indexArray),W=U.vertexLength,Q=[],ee=[];for(const le of R){if(0===le.length)continue;le!==R[0]&&ee.push(Q.length/2);const he=this.segments2.prepareSegment(le.length,this.layoutVertexArray,this.indexArray2),Ie=he.vertexLength;this.layoutVertexArray.emplaceBack(le[0].x,le[0].y),this.indexArray2.emplaceBack(Ie+le.length-1,Ie),Q.push(le[0].x),Q.push(le[0].y);for(let Le=1;Le<le.length;Le++)this.layoutVertexArray.emplaceBack(le[Le].x,le[Le].y),this.indexArray2.emplaceBack(Ie+Le-1,Ie+Le),Q.push(le[Le].x),Q.push(le[Le].y);he.vertexLength+=le.length,he.primitiveLength+=le.length}const oe=rp(Q,ee);for(let le=0;le<oe.length;le+=3)this.indexArray.emplaceBack(W+oe[le],W+oe[le+1],W+oe[le+2]);U.vertexLength+=N,U.primitiveLength+=oe.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,C,S,v)}}Rn(c_,"FillBucket",{omit:["layers","patternFeatures"]});const bE=new hn({"fill-sort-key":new Pt(Rt.layout_fill["fill-sort-key"])});var Ph={paint:new hn({"fill-antialias":new yt(Rt.paint_fill["fill-antialias"]),"fill-opacity":new Pt(Rt.paint_fill["fill-opacity"]),"fill-color":new Pt(Rt.paint_fill["fill-color"]),"fill-outline-color":new Pt(Rt.paint_fill["fill-outline-color"]),"fill-translate":new yt(Rt.paint_fill["fill-translate"]),"fill-translate-anchor":new yt(Rt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Pt(Rt.paint_fill["fill-pattern"])}),layout:bE};const Ay=Jn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),bD=Jn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),u_=Jn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:wD}=Ay;var My={},ix=st,Wm=Zm;function Zm(l,s,c,f,v){this.properties={},this.extent=c,this.type=0,this._pbf=l,this._geometry=-1,this._keys=f,this._values=v,l.readFields(ky,this,s)}function ky(l,s,c){1==l?s.id=c.readVarint():2==l?function(f,v){for(var C=f.readVarint()+f.pos;f.pos<C;){var S=v._keys[f.readVarint()],R=v._values[f.readVarint()];v.properties[S]=R}}(c,s):3==l?s.type=c.readVarint():4==l&&(s._geometry=c.pos)}function wE(l){for(var s,c,f=0,v=0,C=l.length,S=C-1;v<C;S=v++)f+=((c=l[S]).x-(s=l[v]).x)*(s.y+c.y);return f}Zm.types=["Unknown","Point","LineString","Polygon"],Zm.prototype.loadGeometry=function(){var l=this._pbf;l.pos=this._geometry;for(var s,c=l.readVarint()+l.pos,f=1,v=0,C=0,S=0,R=[];l.pos<c;){if(v<=0){var N=l.readVarint();f=7&N,v=N>>3}if(v--,1===f||2===f)C+=l.readSVarint(),S+=l.readSVarint(),1===f&&(s&&R.push(s),s=[]),s.push(new ix(C,S));else{if(7!==f)throw new Error("unknown command "+f);s&&s.push(s[0].clone())}}return s&&R.push(s),R},Zm.prototype.bbox=function(){var l=this._pbf;l.pos=this._geometry;for(var s=l.readVarint()+l.pos,c=1,f=0,v=0,C=0,S=1/0,R=-1/0,N=1/0,U=-1/0;l.pos<s;){if(f<=0){var W=l.readVarint();c=7&W,f=W>>3}if(f--,1===c||2===c)(v+=l.readSVarint())<S&&(S=v),v>R&&(R=v),(C+=l.readSVarint())<N&&(N=C),C>U&&(U=C);else if(7!==c)throw new Error("unknown command "+c)}return[S,N,R,U]},Zm.prototype.toGeoJSON=function(l,s,c){var f,v,C=this.extent*Math.pow(2,c),S=this.extent*l,R=this.extent*s,N=this.loadGeometry(),U=Zm.types[this.type];function W(oe){for(var le=0;le<oe.length;le++){var he=oe[le];oe[le]=[360*(he.x+S)/C-180,360/Math.PI*Math.atan(Math.exp((180-360*(he.y+R)/C)*Math.PI/180))-90]}}switch(this.type){case 1:var Q=[];for(f=0;f<N.length;f++)Q[f]=N[f][0];W(N=Q);break;case 2:for(f=0;f<N.length;f++)W(N[f]);break;case 3:for(N=function(oe){var le=oe.length;if(le<=1)return[oe];for(var he,Ie,Le=[],ve=0;ve<le;ve++){var Pe=wE(oe[ve]);0!==Pe&&(void 0===Ie&&(Ie=Pe<0),Ie===Pe<0?(he&&Le.push(he),he=[oe[ve]]):he.push(oe[ve]))}return he&&Le.push(he),Le}(N),f=0;f<N.length;f++)for(v=0;v<N[f].length;v++)W(N[f][v])}1===N.length?N=N[0]:U="Multi"+U;var ee={type:"Feature",geometry:{type:U,coordinates:N},properties:this.properties};return"id"in this&&(ee.id=this.id),ee};var Yp=Wm,rx=Ry;function Ry(l,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(B0,this,s),this.length=this._features.length}function B0(l,s,c){15===l?s.version=c.readVarint():1===l?s.name=c.readString():5===l?s.extent=c.readVarint():2===l?s._features.push(c.pos):3===l?s._keys.push(c.readString()):4===l&&s._values.push(function(f){for(var v=null,C=f.readVarint()+f.pos;f.pos<C;){var S=f.readVarint()>>3;v=1===S?f.readString():2===S?f.readFloat():3===S?f.readDouble():4===S?f.readVarint64():5===S?f.readVarint():6===S?f.readSVarint():7===S?f.readBoolean():null}return v}(c))}Ry.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var s=this._pbf.readVarint()+this._pbf.pos;return new Yp(this._pbf,s,this.extent,this._keys,this._values)};var xE=rx;function xD(l,s,c){if(3===l){var f=new xE(c,c.readVarint()+c.pos);f.length&&(s[f.name]=f)}}var ox=My.VectorTile=function(l,s){this.layers=l.readFields(xD,{},s)},V0=My.VectorTileFeature=Wm;function Py(l,s,c,f){const v=[],C=0===f?(S,R,N,U,W,Q)=>{S.push(new st(Q,N+(Q-R)/(U-R)*(W-N)))}:(S,R,N,U,W,Q)=>{S.push(new st(R+(Q-N)/(W-N)*(U-R),Q))};for(const S of l){const R=[];for(const N of S){if(N.length<=2)continue;const U=[];for(let ee=0;ee<N.length-1;ee++){const oe=N[ee].x,le=N[ee].y,he=N[ee+1].x,Ie=N[ee+1].y,Le=0===f?oe:le,ve=0===f?he:Ie;Le<s?ve>s&&C(U,oe,le,he,Ie,s):Le>c?ve<c&&C(U,oe,le,he,Ie,c):U.push(N[ee]),ve<s&&Le>=s&&C(U,oe,le,he,Ie,s),ve>c&&Le<=c&&C(U,oe,le,he,Ie,c)}let W=N[N.length-1];const Q=0===f?W.x:W.y;Q>=s&&Q<=c&&U.push(W),U.length&&(W=U[U.length-1],U[0].x===W.x&&U[0].y===W.y||U.push(U[0]),R.push(U))}R.length&&v.push(R)}return v}My.VectorTileLayer=rx;const sx=V0.types,CD=Math.pow(2,13);function Oy(l,s,c,f,v,C,S,R){l.emplaceBack((s<<1)+S,(c<<1)+C,(Math.floor(f*CD)<<1)+v,Math.round(R))}function Td(l,s,c){l.emplaceBack(s.x,s.y,s.z,16384*c[0],16384*c[1],16384*c[2])}class ax{constructor(){this.acc=new st(0,0),this.polyCount=[]}startRing(s){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new st(s.x,s.y),this.max=new st(s.x,s.y))}append(s,c){this.currentPolyCount.edges++,this.acc._add(s);const f=this.min,v=this.max;s.x<f.x?f.x=s.x:s.x>v.x&&(v.x=s.x),s.y<f.y?f.y=s.y:s.y>v.y&&(v.y=s.y),((0===s.x||s.x===Ci)&&s.x===c.x)!=((0===s.y||s.y===Ci)&&s.y===c.y)&&this.processBorderOverlap(s,c),c.x<0!=s.x<0&&this.addBorderIntersection(0,Oi(c.y,s.y,(0-c.x)/(s.x-c.x))),c.x>Ci!=s.x>Ci&&this.addBorderIntersection(1,Oi(c.y,s.y,(Ci-c.x)/(s.x-c.x))),c.y<0!=s.y<0&&this.addBorderIntersection(2,Oi(c.x,s.x,(0-c.y)/(s.y-c.y))),c.y>Ci!=s.y>Ci&&this.addBorderIntersection(3,Oi(c.x,s.x,(Ci-c.y)/(s.y-c.y)))}addBorderIntersection(s,c){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const f=this.borders[s];c<f[0]&&(f[0]=c),c>f[1]&&(f[1]=c)}processBorderOverlap(s,c){if(s.x===c.x){if(s.y===c.y)return;const f=0===s.x?0:1;this.addBorderIntersection(f,c.y),this.addBorderIntersection(f,s.y)}else{const f=0===s.y?2:3;this.addBorderIntersection(f,c.x),this.addBorderIntersection(f,s.x)}}centroid(){const s=this.polyCount.reduce((c,f)=>c+f.edges,0);return 0!==s?this.acc.div(s)._round():new st(0,0)}span(){return new st(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((s,c)=>s+ +(c[0]!==Number.MAX_VALUE),0)}}class qm{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=s.projection,this.layoutVertexArray=new Hr,this.centroidVertexArray=new J,this.indexArray=new Ns,this.programConfigurations=new xm(s.layers,s.zoom),this.segments=new Cs,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.enableTerrain=s.enableTerrain}populate(s,c,f,v){this.features=[],this.hasPattern=Dy("fill-extrusion",this.layers,c),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(C){const S=Math.exp(Math.PI*(1-C.y/(1<<C.z)*2));return 80150034*S/(S*S+1)/Ci/(1<<C.z)}(f),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:C,id:S,index:R,sourceLayerIndex:N}of s){const U=this.layers[0]._featureFilter.needGeometry,W=wu(C,U);if(!this.layers[0]._featureFilter.filter(new ut(this.zoom),W,f))continue;const Q={id:S,sourceLayerIndex:N,index:R,geometry:U?W.geometry:xd(C,f,v),properties:C.properties,type:C.type,patterns:{}},ee=this.layoutVertexArray.length;this.hasPattern?this.features.push(Ti("fill-extrusion",this.layers,Q,this.zoom,c)):this.addFeature(Q,Q.geometry,R,f,{},c.availableImages,v),c.featureIndex.insert(C,Q.geometry,R,N,this.index,ee)}this.sortBorders()}addFeatures(s,c,f,v,C){for(const S of this.features){const{geometry:R}=S;this.addFeature(S,R,S.index,c,f,v,C)}this.sortBorders()}update(s,c,f,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,f,v)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,wD),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=s.createVertexBuffer(this.layoutVertexExtArray,u_.members,!0))),this.programConfigurations.upload(s),this.uploaded=!0}uploadCentroid(s){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,bD.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,c,f,v,C,S,R){const N=[new st(0,0),new st(Ci,Ci)],U=R.projection,W="globe"===U.name,Q=this.enableTerrain&&!W?new ax:null,ee="Polygon"===sx[s.type];W&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Dl);const oe=ih(c,500);for(let Le=oe.length-1;Le>=0;Le--){const ve=oe[Le];(0===ve.length||(le=ve[0]).every(Pe=>Pe.x<=0)||le.every(Pe=>Pe.x>=Ci)||le.every(Pe=>Pe.y<=0)||le.every(Pe=>Pe.y>=Ci))&&oe.splice(Le,1)}var le;let he;if(W)he=dx(oe,N,v);else{he=[];for(const Le of oe)he.push({polygon:Le,bounds:N})}const Ie=ee?this.edgeRadius:0;for(const{polygon:Le,bounds:ve}of he){let Pe=0,He=0;for(const $e of Le)ee&&!$e[0].equals($e[$e.length-1])&&$e.push($e[0]),He+=ee?$e.length-1:$e.length;const Be=this.segments.prepareSegment((ee?5:4)*He,this.layoutVertexArray,this.indexArray);if(ee){const $e=[],kt=[];Pe=Be.vertexLength;for(const Gt of Le){let Qt,Ft;Gt.length&&Gt!==Le[0]&&kt.push($e.length/2),Qt=Gt[1].sub(Gt[0])._perp()._unit();for(let Kt=1;Kt<Gt.length;Kt++){const Xt=Gt[Kt],un=Gt[Kt===Gt.length-1?1:Kt+1];let{x:pn,y:Bt}=Xt;if(Ie){Ft=un.sub(Xt)._perp()._unit();const In=Qt.add(Ft)._unit(),mi=Ie*Math.min(4,1/(Qt.x*In.x+Qt.y*In.y));pn+=mi*In.x,Bt+=mi*In.y,Qt=Ft}Oy(this.layoutVertexArray,pn,Bt,0,0,1,1,0),Be.vertexLength++,$e.push(Xt.x,Xt.y),W&&Td(this.layoutVertexExtArray,U.projectTilePoint(pn,Bt,v),U.upVector(v,pn,Bt))}}const St=rp($e,kt);for(let Gt=0;Gt<St.length;Gt+=3)this.indexArray.emplaceBack(Pe+St[Gt],Pe+St[Gt+2],Pe+St[Gt+1]),Be.primitiveLength++}for(const $e of Le){Q&&$e.length&&Q.startRing($e[0]);let kt,St,Gt,Qt=$e.length>4&&cx($e[$e.length-2],$e[0],$e[1]),Ft=Ie?CE($e[$e.length-2],$e[0],$e[1],Ie):0;St=$e[1].sub($e[0])._perp()._unit();let Kt=!0;for(let Xt=1,un=0;Xt<$e.length;Xt++){let pn=$e[Xt-1],Bt=$e[Xt];const In=$e[Xt===$e.length-1?1:Xt+1];if(Q&&ee&&Q.currentPolyCount.top++,lx(Bt,pn,ve)){Ie&&(St=In.sub(Bt)._perp()._unit(),Kt=!Kt);continue}Q&&Q.append(Bt,pn);const mi=Bt.sub(pn)._perp(),Pn=mi.x/(Math.abs(mi.x)+Math.abs(mi.y)),Kn=mi.y>0?1:0,Mn=pn.dist(Bt);if(un+Mn>32768&&(un=0),Ie){Gt=In.sub(Bt)._perp()._unit();let Yi=U0(pn,Bt,In,h_(St,Gt),Ie);isNaN(Yi)&&(Yi=0);const _i=Bt.sub(pn)._unit();pn=pn.add(_i.mult(Ft))._round(),Bt=Bt.add(_i.mult(-Yi))._round(),Ft=Yi,St=Gt}const Yn=Be.vertexLength,Xi=$e.length>4&&cx(pn,Bt,In);let nr=ux(un,Qt,Kt);if(Oy(this.layoutVertexArray,pn.x,pn.y,Pn,Kn,0,0,nr),Oy(this.layoutVertexArray,pn.x,pn.y,Pn,Kn,0,1,nr),un+=Mn,nr=ux(un,Xi,!Kt),Qt=Xi,Oy(this.layoutVertexArray,Bt.x,Bt.y,Pn,Kn,0,0,nr),Oy(this.layoutVertexArray,Bt.x,Bt.y,Pn,Kn,0,1,nr),Be.vertexLength+=4,this.indexArray.emplaceBack(Yn+0,Yn+1,Yn+2),this.indexArray.emplaceBack(Yn+1,Yn+3,Yn+2),Be.primitiveLength+=2,Ie){const Yi=Pe+(1===Xt?$e.length-2:Xt-2),_i=1===Xt?Pe:Yi+1;if(this.indexArray.emplaceBack(Yn+1,Yi,Yn+3),this.indexArray.emplaceBack(Yi,_i,Yn+3),Be.primitiveLength+=2,void 0===kt&&(kt=Yn),!lx(In,$e[Xt],ve)){const Nr=Xt===$e.length-1?kt:Be.vertexLength;this.indexArray.emplaceBack(Yn+2,Yn+3,Nr),this.indexArray.emplaceBack(Yn+3,Nr+1,Nr),this.indexArray.emplaceBack(Yn+3,_i,Nr+1),Be.primitiveLength+=3}Kt=!Kt}if(W){const Yi=this.layoutVertexExtArray,_i=U.projectTilePoint(pn.x,pn.y,v),Nr=U.projectTilePoint(Bt.x,Bt.y,v),Ri=U.upVector(v,pn.x,pn.y),ar=U.upVector(v,Bt.x,Bt.y);Td(Yi,_i,Ri),Td(Yi,_i,Ri),Td(Yi,Nr,ar),Td(Yi,Nr,ar)}}ee&&(Pe+=$e.length-1)}}if(Q&&Q.polyCount.length>0){if(Q.borders){Q.vertexArrayOffset=this.centroidVertexArray.length;const Le=Q.borders,ve=this.featuresOnBorder.push(Q)-1;for(let Pe=0;Pe<4;Pe++)Le[Pe][0]!==Number.MAX_VALUE&&this.borders[Pe].push(ve)}this.encodeCentroid(Q.borders?void 0:Q.centroid(),Q)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,C,S,v)}sortBorders(){for(let s=0;s<4;s++)this.borders[s].sort((c,f)=>this.featuresOnBorder[c].borders[s][0]-this.featuresOnBorder[f].borders[s][0])}encodeCentroid(s,c,f=!0){let v,C;if(s)if(0!==s.y){const R=c.span()._mult(this.tileToMeter);v=(Math.max(s.x,1)<<3)+Math.min(7,Math.round(R.x/10)),C=(Math.max(s.y,1)<<3)+Math.min(7,Math.round(R.y/10))}else v=Math.ceil(7*(s.x+450)),C=0;else v=0,C=+f;let S=f?this.centroidVertexArray.length:c.vertexArrayOffset;for(const R of c.polyCount){f&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*R.edges+R.top);for(let N=0;N<R.top;N++)this.centroidVertexArray.emplace(S++,v,C);for(let N=0;N<2*R.edges;N++)this.centroidVertexArray.emplace(S++,0,C),this.centroidVertexArray.emplace(S++,v,C)}}}function h_(l,s){const c=l.add(s)._unit();return l.x*c.x+l.y*c.y}function CE(l,s,c,f){const v=s.sub(l)._perp()._unit(),C=c.sub(s)._perp()._unit();return U0(l,s,c,h_(v,C),f)}function U0(l,s,c,f,v){const C=Math.sqrt(1-f*f);return Math.min(l.dist(s)/3,s.dist(c)/3,v*C/f)}function lx(l,s,c){return l.x<c[0].x&&s.x<c[0].x||l.x>c[1].x&&s.x>c[1].x||l.y<c[0].y&&s.y<c[0].y||l.y>c[1].y&&s.y>c[1].y}function cx(l,s,c){if(l.x<0||l.x>=Ci||s.x<0||s.x>=Ci||c.x<0||c.x>=Ci)return!1;const f=c.sub(s),v=f.perp(),C=l.sub(s);return(f.x*C.x+f.y*C.y)/Math.sqrt((f.x*f.x+f.y*f.y)*(C.x*C.x+C.y*C.y))>-.866&&v.x*C.x+v.y*C.y<0}function ux(l,s,c){const f=s?2|l:-3&l;return c?1|f:-2&f}function hx(){const l=Math.PI/32,s=Math.tan(l),c=t_;return c*Math.sqrt(1+2*s*s)-c}function dx(l,s,c){const f=1<<c.z,v=uc(c.x/f),C=uc((c.x+1)/f),S=Ua(c.y/f),R=Ua((c.y+1)/f);return function(N,U,W,Q,ee=0,oe){const le=[];if(!N.length||!W||!Q)return le;const he=($e,kt)=>{for(const St of $e)le.push({polygon:St,bounds:kt})},Ie=Math.ceil(Math.log2(W)),Le=Math.ceil(Math.log2(Q)),ve=Ie-Le,Pe=[];for(let $e=0;$e<Math.abs(ve);$e++)Pe.push(ve>0?0:1);for(let $e=0;$e<Math.min(Ie,Le);$e++)Pe.push(0),Pe.push(1);let He=N;if(He=Py(He,U[0].y-ee,U[1].y+ee,1),He=Py(He,U[0].x-ee,U[1].x+ee,0),!He.length)return le;const Be=[];for(Pe.length?Be.push({polygons:He,bounds:U,depth:0}):he(He,U);Be.length;){const $e=Be.pop(),kt=$e.depth,St=Pe[kt],Gt=$e.bounds[0],Qt=$e.bounds[1],Ft=0===St?Gt.x:Gt.y,Kt=0===St?Qt.x:Qt.y,Xt=oe?oe(St,Ft,Kt):.5*(Ft+Kt),un=Py($e.polygons,Ft-ee,Xt+ee,St),pn=Py($e.polygons,Xt-ee,Kt+ee,St);if(un.length){const Bt=[Gt,new st(0===St?Xt:Qt.x,1===St?Xt:Qt.y)];Pe.length>kt+1?Be.push({polygons:un,bounds:Bt,depth:kt+1}):he(un,Bt)}if(pn.length){const Bt=[new st(0===St?Xt:Gt.x,1===St?Xt:Gt.y),Qt];Pe.length>kt+1?Be.push({polygons:pn,bounds:Bt,depth:kt+1}):he(pn,Bt)}}return le}(l,s,Math.ceil((C-v)/11.25),Math.ceil((S-R)/11.25),1,(N,U,W)=>{if(0===N)return.5*(U+W);{const Q=Ua((c.y+U/Ci)/f);return(cc(.5*(Ua((c.y+W/Ci)/f)+Q))*f-c.y)*Ci}})}Rn(qm,"FillExtrusionBucket",{omit:["layers","features"]}),Rn(ax,"PartMetadata");const px=new hn({"fill-extrusion-edge-radius":new yt(Rt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var EE={paint:new hn({"fill-extrusion-opacity":new yt(Rt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Pt(Rt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new yt(Rt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new yt(Rt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Pt(Rt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Pt(Rt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Pt(Rt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new yt(Rt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new yt(Rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new yt(Rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:px};function H0(l,s,c){var f=2*Math.PI*6378137/256/Math.pow(2,c);return[l*f-2*Math.PI*6378137/2,s*f-2*Math.PI*6378137/2]}class d_{constructor(s,c,f){this.z=s,this.x=c,this.y=f,this.key=Hf(0,s,s,c,f)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,c){const f=(S=this.y,R=this.z,N=H0(256*(C=this.x),256*(S=Math.pow(2,R)-S-1),R),U=H0(256*(C+1),256*(S+1),R),N[0]+","+N[1]+","+U[0]+","+U[1]),v=function(C,S,R){let N,U="";for(let W=C;W>0;W--)N=1<<W-1,U+=(S&N?1:0)+(R&N?2:0);return U}(this.z,this.x,this.y);var C,S,R,N,U;return s[(this.x+this.y)%s.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===c?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",v).replace("{bbox-epsg-3857}",f)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ly{constructor(s,c){this.wrap=s,this.canonical=c,this.key=Hf(s,c.z,c.z,c.x,c.y)}}class dc{constructor(s,c,f,v,C){this.overscaledZ=s,this.wrap=c,this.canonical=new d_(f,+v,+C),this.key=0===c&&s===f?this.canonical.key:Hf(c,s,f,v,C)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){const c=this.canonical.z-s;return s>this.canonical.z?new dc(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new dc(s,this.wrap,s,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(s,c=!0){if(this.overscaledZ===s&&c)return this.key;if(s>this.canonical.z)return Hf(this.wrap*+c,s,this.canonical.z,this.canonical.x,this.canonical.y);{const f=this.canonical.z-s;return Hf(this.wrap*+c,s,s,this.canonical.x>>f,this.canonical.y>>f)}}isChildOf(s){if(s.wrap!==this.wrap)return!1;const c=this.canonical.z-s.canonical.z;return 0===s.overscaledZ||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>c&&s.canonical.y===this.canonical.y>>c}children(s){if(this.overscaledZ>=s)return[new dc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,f=2*this.canonical.x,v=2*this.canonical.y;return[new dc(c,this.wrap,c,f,v),new dc(c,this.wrap,c,f+1,v),new dc(c,this.wrap,c,f,v+1),new dc(c,this.wrap,c,f+1,v+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new dc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new dc(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ly(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Hf(l,s,c,f,v){const C=1<<Math.min(c,22);let S=C*(v%C)+f%C;return l&&c<22&&(S+=C*C*((l<0?-2*l-1:2*l)%(1<<2*(22-c)))),16*(32*S+c)+(s-c)}Rn(d_,"CanonicalTileID"),Rn(dc,"OverscaledTileID",{omit:["projMatrix"]});class Km extends st{constructor(s,c,f){super(s,c),this.z=f}}function Fy(l,s){return l.x*s.x+l.y*s.y}function jf(l,s){if(1===l.length){let c=0;const f=s[c++];let v;for(;!v||f.equals(v);)if(v=s[c++],!v)return 1/0;for(;c<s.length;c++){const C=s[c],S=l[0],R=v.sub(f),N=C.sub(f),U=S.sub(f),W=Fy(R,R),Q=Fy(R,N),ee=Fy(N,N),oe=Fy(U,R),le=Fy(U,N),he=W*ee-Q*Q,Ie=(ee*oe-Q*le)/he,Le=(W*le-Q*oe)/he,ve=f.z*(1-Ie-Le)+v.z*Ie+C.z*Le;if(isFinite(ve))return ve}return 1/0}{let c=1/0;for(const f of s)c=Math.min(c,f.z);return c}}function j0(l,s,c,f,v,C,S,R){const N=S*v.getElevationAt(l,s,!0,!0),U=0!==C[0],W=U?0===C[1]?S*(C[0]/7-450):S*function(Q,ee,oe){const le=Math.floor(ee[0]/8),he=Math.floor(ee[1]/8),Ie=10*(ee[0]-8*le),Le=10*(ee[1]-8*he),ve=Q.getElevationAt(le,he,!0,!0),Pe=Q.getMeterToDEM(oe),He=Math.floor(.5*(Ie*Pe-1)),Be=Math.floor(.5*(Le*Pe-1)),$e=Q.tileCoordToPixel(le,he),kt=2*He+1,St=2*Be+1,Gt=(mi=kt,Pn=St,[(pn=Q).getElevationAtPixel(Bt=$e.x-He,In=$e.y-Be,!0),pn.getElevationAtPixel(Bt+Pn,In,!0),pn.getElevationAtPixel(Bt,In+Pn,!0),pn.getElevationAtPixel(Bt+mi,In+Pn,!0)]),Qt=Math.abs(Gt[0]-Gt[1]),Ft=Math.abs(Gt[2]-Gt[3]),Kt=Math.abs(Gt[0]-Gt[2])+Math.abs(Gt[1]-Gt[3]),Xt=Math.min(.25,.5*Pe*(Qt+Ft)/kt),un=Math.min(.25,.5*Pe*Kt/St);var pn,Bt,In,mi,Pn;return ve+Math.max(Xt*Ie,un*Le)}(v,C,R):N;return{base:N+(0===c)?-1:c,top:U?Math.max(W+f,N+c+2):N+f}}const ED=Jn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:fx}=ED,TE=Jn([{name:"a_packed",components:4,type:"Float32"}]),{members:SE}=TE,Ym=V0.types,Cu=Math.cos(Math.PI/180*37.5);class Gf{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.projection=s.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new Xr,this.layoutVertexArray2=new Kr,this.indexArray=new Ns,this.programConfigurations=new xm(s.layers,s.zoom),this.segments=new Cs,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,f,v){this.hasPattern=Dy("line",this.layers,c);const C=this.layers[0].layout.get("line-sort-key"),S=[];for(const{feature:W,id:Q,index:ee,sourceLayerIndex:oe}of s){const le=this.layers[0]._featureFilter.needGeometry,he=wu(W,le);if(!this.layers[0]._featureFilter.filter(new ut(this.zoom),he,f))continue;const Ie=C?C.evaluate(he,{},f):void 0,Le={id:Q,properties:W.properties,type:W.type,sourceLayerIndex:oe,index:ee,geometry:le?he.geometry:xd(W,f,v),patterns:{},sortKey:Ie};S.push(Le)}C&&S.sort((W,Q)=>W.sortKey-Q.sortKey);const{lineAtlas:R,featureIndex:N}=c,U=this.addConstantDashes(R);for(const W of S){const{geometry:Q,index:ee,sourceLayerIndex:oe}=W;if(U&&this.addFeatureDashes(W,R),this.hasPattern){const le=Ti("line",this.layers,W,this.zoom,c);this.patternFeatures.push(le)}else this.addFeature(W,Q,ee,f,R.positions,c.availableImages);N.insert(s[ee].feature,Q,ee,oe,this.index)}}addConstantDashes(s){let c=!1;for(const f of this.layers){const v=f.paint.get("line-dasharray").value,C=f.layout.get("line-cap").value;if("constant"!==v.kind||"constant"!==C.kind)c=!0;else{const S=C.value,R=v.value;if(!R)continue;s.addDash(R,S)}}return c}addFeatureDashes(s,c){const f=this.zoom;for(const v of this.layers){const C=v.paint.get("line-dasharray").value,S=v.layout.get("line-cap").value;if("constant"===C.kind&&"constant"===S.kind)continue;let R,N;if("constant"===C.kind){if(R=C.value,!R)continue}else R=C.evaluate({zoom:f},s);N="constant"===S.kind?S.value:S.evaluate({zoom:f},s),c.addDash(R,N),s.patterns[v.id]=c.getKey(R,N)}}update(s,c,f,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,f,v)}addFeatures(s,c,f,v,C){for(const S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,c,f,v)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,SE)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,fx),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&s.properties.hasOwnProperty("mapbox_clip_start")&&s.properties.hasOwnProperty("mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,c,f,v,C,S){const R=this.layers[0].layout,N=R.get("line-join").evaluate(s,{}),U=R.get("line-cap").evaluate(s,{}),W=R.get("line-miter-limit"),Q=R.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const ee of c)this.addLine(ee,s,N,U,W,Q);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,C,S,v)}addLine(s,c,f,v,C,S){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Le=0;Le<s.length-1;Le++)this.totalDistance+=s[Le].dist(s[Le+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const R="Polygon"===Ym[c.type];let N=s.length;for(;N>=2&&s[N-1].equals(s[N-2]);)N--;let U=0;for(;U<N-1&&s[U].equals(s[U+1]);)U++;if(N<(R?3:2))return;"bevel"===f&&(C=1.05);const W=this.overscaling<=16?122880/(512*this.overscaling):0,Q=this.segments.prepareSegment(10*N,this.layoutVertexArray,this.indexArray);let ee,oe,le,he,Ie;this.e1=this.e2=-1,R&&(ee=s[N-2],Ie=s[U].sub(ee)._unit()._perp());for(let Le=U;Le<N;Le++){if(le=Le===N-1?R?s[U+1]:void 0:s[Le+1],le&&s[Le].equals(le))continue;Ie&&(he=Ie),ee&&(oe=ee),ee=s[Le],Ie=le?le.sub(ee)._unit()._perp():he,he=he||Ie;let ve=he.add(Ie);0===ve.x&&0===ve.y||ve._unit();const Pe=he.x*Ie.x+he.y*Ie.y,He=ve.x*Ie.x+ve.y*Ie.y,Be=0!==He?1/He:1/0,$e=2*Math.sqrt(2-2*He),kt=He<Cu&&oe&&le,St=he.x*Ie.y-he.y*Ie.x>0;if(kt&&Le>U){const Ft=ee.dist(oe);if(Ft>2*W){const Kt=ee.sub(ee.sub(oe)._mult(W/Ft)._round());this.updateDistance(oe,Kt),this.addCurrentVertex(Kt,he,0,0,Q),oe=Kt}}const Gt=oe&&le;let Qt=Gt?f:R?"butt":v;if(Gt&&"round"===Qt&&(Be<S?Qt="miter":Be<=2&&(Qt="fakeround")),"miter"===Qt&&Be>C&&(Qt="bevel"),"bevel"===Qt&&(Be>2&&(Qt="flipbevel"),Be<C&&(Qt="miter")),oe&&this.updateDistance(oe,ee),"miter"===Qt)ve._mult(Be),this.addCurrentVertex(ee,ve,0,0,Q);else if("flipbevel"===Qt){if(Be>100)ve=Ie.mult(-1);else{const Ft=Be*he.add(Ie).mag()/he.sub(Ie).mag();ve._perp()._mult(Ft*(St?-1:1))}this.addCurrentVertex(ee,ve,0,0,Q),this.addCurrentVertex(ee,ve.mult(-1),0,0,Q)}else if("bevel"===Qt||"fakeround"===Qt){const Ft=-Math.sqrt(Be*Be-1),Kt=St?Ft:0,Xt=St?0:Ft;if(oe&&this.addCurrentVertex(ee,he,Kt,Xt,Q),"fakeround"===Qt){const un=Math.round(180*$e/Math.PI/20);for(let pn=1;pn<un;pn++){let Bt=pn/un;if(.5!==Bt){const mi=Bt-.5;Bt+=Bt*mi*(Bt-1)*((1.0904+Pe*(Pe*(3.55645-1.43519*Pe)-3.2452))*mi*mi+(.848013+Pe*(.215638*Pe-1.06021)))}const In=Ie.sub(he)._mult(Bt)._add(he)._unit()._mult(St?-1:1);this.addHalfVertex(ee,In.x,In.y,!1,St,0,Q)}}le&&this.addCurrentVertex(ee,Ie,-Kt,-Xt,Q)}else if("butt"===Qt)this.addCurrentVertex(ee,ve,0,0,Q);else if("square"===Qt){const Ft=oe?1:-1;oe||this.addCurrentVertex(ee,ve,Ft,Ft,Q),this.addCurrentVertex(ee,ve,0,0,Q),oe&&this.addCurrentVertex(ee,ve,Ft,Ft,Q)}else"round"===Qt&&(oe&&(this.addCurrentVertex(ee,he,0,0,Q),this.addCurrentVertex(ee,he,1,1,Q,!0)),le&&(this.addCurrentVertex(ee,Ie,-1,-1,Q,!0),this.addCurrentVertex(ee,Ie,0,0,Q)));if(kt&&Le<N-1){const Ft=ee.dist(le);if(Ft>2*W){const Kt=ee.add(le.sub(ee)._mult(W/Ft)._round());this.updateDistance(ee,Kt),this.addCurrentVertex(Kt,Ie,0,0,Q),ee=Kt}}}}addCurrentVertex(s,c,f,v,C,S=!1){const R=c.y*v-c.x,N=-c.y-c.x*v;this.addHalfVertex(s,c.x+c.y*f,c.y-c.x*f,S,!1,f,C),this.addHalfVertex(s,R,N,S,!0,-v,C)}addHalfVertex({x:s,y:c},f,v,C,S,R,N){this.layoutVertexArray.emplaceBack((s<<1)+(C?1:0),(c<<1)+(S?1:0),Math.round(63*f)+128,Math.round(63*v)+128,1+(0===R?0:R<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const U=N.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,U),N.primitiveLength++),S?this.e2=U:this.e1=U}updateScaledDistance(){if(this.lineClips){const s=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=s*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(s,c){this.distance+=s.dist(c),this.updateScaledDistance()}}Rn(Gf,"LineBucket",{omit:["layers","patternFeatures"]});const $f=new hn({"line-cap":new Pt(Rt.layout_line["line-cap"]),"line-join":new Pt(Rt.layout_line["line-join"]),"line-miter-limit":new yt(Rt.layout_line["line-miter-limit"]),"line-round-limit":new yt(Rt.layout_line["line-round-limit"]),"line-sort-key":new Pt(Rt.layout_line["line-sort-key"])});var Jm={paint:new hn({"line-opacity":new Pt(Rt.paint_line["line-opacity"]),"line-color":new Pt(Rt.paint_line["line-color"]),"line-translate":new yt(Rt.paint_line["line-translate"]),"line-translate-anchor":new yt(Rt.paint_line["line-translate-anchor"]),"line-width":new Pt(Rt.paint_line["line-width"]),"line-gap-width":new Pt(Rt.paint_line["line-gap-width"]),"line-offset":new Pt(Rt.paint_line["line-offset"]),"line-blur":new Pt(Rt.paint_line["line-blur"]),"line-dasharray":new Pt(Rt.paint_line["line-dasharray"]),"line-pattern":new Pt(Rt.paint_line["line-pattern"]),"line-gradient":new tn(Rt.paint_line["line-gradient"]),"line-trim-offset":new yt(Rt.paint_line["line-trim-offset"])}),layout:$f};const Wf=new class extends Pt{constructor(...l){super(...l),pe(this,"useIntegerZoom",!0)}possiblyEvaluate(l,s){return s=new ut(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(l,s)}evaluate(l,s,c,f){return s=Ni({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(l,s,c,f)}}(Jm.paint.properties["line-width"].specification);function pc(l,s){return s>0?s+2*l:l}Wf.useIntegerZoom=!0;const Ny=Jn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),p_=Jn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),zy=Jn([{name:"a_projected_pos",components:4,type:"Float32"}],4);Jn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const G0=Jn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),f_=Jn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Jn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const IE=Jn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),DE=Jn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Jn([{name:"triangle",components:3,type:"Uint16"}]),Jn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Jn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Jn([{type:"Float32",name:"offsetX"}]),Jn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);const Oh=128;function By(l,s){const{expression:c}=s;if("constant"===c.kind)return{kind:"constant",layoutSize:c.evaluate(new ut(l+1))};if("source"===c.kind)return{kind:"source"};{const{zoomStops:f,interpolationType:v}=c;let C=0;for(;C<f.length&&f[C]<=l;)C++;C=Math.max(0,C-1);let S=C;for(;S<f.length&&f[S]<l+1;)S++;S=Math.min(f.length-1,S);const R=f[C],N=f[S];return"composite"===c.kind?{kind:"composite",minZoom:R,maxZoom:N,interpolationType:v}:{kind:"camera",minZoom:R,maxZoom:N,minSize:c.evaluate(new ut(R)),maxSize:c.evaluate(new ut(N)),interpolationType:v}}}function Vy(l,{uSize:s,uSizeT:c},{lowerSize:f,upperSize:v}){return"source"===l.kind?f/Oh:"composite"===l.kind?Oi(f/Oh,v/Oh,c):s}function Qm(l,s){let c=0,f=0;if("constant"===l.kind)f=l.layoutSize;else if("source"!==l.kind){const{interpolationType:v,minZoom:C,maxZoom:S}=l,R=v?It(el.interpolationFactor(v,s,C,S),0,1):0;"camera"===l.kind?f=Oi(l.minSize,l.maxSize,R):c=R}return{uSizeT:c,uSize:f}}var mx=Object.freeze({__proto__:null,getSizeData:By,evaluateSizeForFeature:Vy,evaluateSizeForZoom:Qm,SIZE_PACK_FACTOR:Oh});function Wc(l,s,c){return l.sections.forEach(f=>{f.text=function(v,C,S){const R=C.layout.get("text-transform").evaluate(S,{});return"uppercase"===R?v=v.toLocaleUpperCase():"lowercase"===R&&(v=v.toLocaleLowerCase()),Xe.applyArabicShaping&&(v=Xe.applyArabicShaping(v)),v}(f.text,s,c)}),l}const m_={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function gx(l){return"\ufe36"===l||"\ufe48"===l||"\ufe38"===l||"\ufe44"===l||"\ufe42"===l||"\ufe3e"===l||"\ufe3c"===l||"\ufe3a"===l||"\ufe18"===l||"\ufe40"===l||"\ufe10"===l||"\ufe13"===l||"\ufe14"===l||"\uff40"===l||"\uffe3"===l||"\ufe11"===l||"\ufe12"===l}function _x(l){return"\ufe35"===l||"\ufe47"===l||"\ufe37"===l||"\ufe43"===l||"\ufe41"===l||"\ufe3d"===l||"\ufe3b"===l||"\ufe39"===l||"\ufe17"===l||"\ufe3f"===l}var Zf=no,Uy=function(l,s,c,f,v){var C,S,R=8*v-f-1,N=(1<<R)-1,U=N>>1,W=-7,Q=c?v-1:0,ee=c?-1:1,oe=l[s+Q];for(Q+=ee,C=oe&(1<<-W)-1,oe>>=-W,W+=R;W>0;C=256*C+l[s+Q],Q+=ee,W-=8);for(S=C&(1<<-W)-1,C>>=-W,W+=f;W>0;S=256*S+l[s+Q],Q+=ee,W-=8);if(0===C)C=1-U;else{if(C===N)return S?NaN:1/0*(oe?-1:1);S+=Math.pow(2,f),C-=U}return(oe?-1:1)*S*Math.pow(2,C-f)},yx=function(l,s,c,f,v,C){var S,R,N,U=8*C-v-1,W=(1<<U)-1,Q=W>>1,ee=23===v?Math.pow(2,-24)-Math.pow(2,-77):0,oe=f?0:C-1,le=f?1:-1,he=s<0||0===s&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(R=isNaN(s)?1:0,S=W):(S=Math.floor(Math.log(s)/Math.LN2),s*(N=Math.pow(2,-S))<1&&(S--,N*=2),(s+=S+Q>=1?ee/N:ee*Math.pow(2,1-Q))*N>=2&&(S++,N/=2),S+Q>=W?(R=0,S=W):S+Q>=1?(R=(s*N-1)*Math.pow(2,v),S+=Q):(R=s*Math.pow(2,Q-1)*Math.pow(2,v),S=0));v>=8;l[c+oe]=255&R,oe+=le,R/=256,v-=8);for(S=S<<v|R,U+=v;U>0;l[c+oe]=255&S,oe+=le,S/=256,U-=8);l[c+oe-le]|=128*he};function no(l){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(l)?l:new Uint8Array(l||0),this.pos=0,this.type=0,this.length=this.buf.length}no.Varint=0,no.Fixed64=1,no.Bytes=2,no.Fixed32=5;var Xm=4294967296,eg=1/Xm,g_=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Sd(l){return l.type===no.Bytes?l.readVarint()+l.pos:l.pos+1}function Dd(l,s,c){var f=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));c.realloc(f);for(var v=c.pos-1;v>=l;v--)c.buf[v+f]=c.buf[v]}function $0(l,s){for(var c=0;c<l.length;c++)s.writeVarint(l[c])}function Hy(l,s){for(var c=0;c<l.length;c++)s.writeSVarint(l[c])}function AE(l,s){for(var c=0;c<l.length;c++)s.writeFloat(l[c])}function __(l,s){for(var c=0;c<l.length;c++)s.writeDouble(l[c])}function Lh(l,s){for(var c=0;c<l.length;c++)s.writeBoolean(l[c])}function W0(l,s){for(var c=0;c<l.length;c++)s.writeFixed32(l[c])}function vx(l,s){for(var c=0;c<l.length;c++)s.writeSFixed32(l[c])}function Jp(l,s){for(var c=0;c<l.length;c++)s.writeFixed64(l[c])}function Z0(l,s){for(var c=0;c<l.length;c++)s.writeSFixed64(l[c])}function y_(l,s){return(l[s]|l[s+1]<<8|l[s+2]<<16)+16777216*l[s+3]}function fc(l,s,c){l[c]=s,l[c+1]=s>>>8,l[c+2]=s>>>16,l[c+3]=s>>>24}function Qp(l,s){return(l[s]|l[s+1]<<8|l[s+2]<<16)+(l[s+3]<<24)}function qf(l,s,c){s.glyphs=[],1===l&&c.readMessage(ME,s)}function ME(l,s,c){if(3===l){const{id:f,bitmap:v,width:C,height:S,left:R,top:N,advance:U}=c.readMessage(q0,{});s.glyphs.push({id:f,bitmap:new ip({width:C+6,height:S+6},v),metrics:{width:C,height:S,left:R,top:N,advance:U}})}else 4===l?s.ascender=c.readSVarint():5===l&&(s.descender=c.readSVarint())}function q0(l,s,c){1===l?s.id=c.readVarint():2===l?s.bitmap=c.readBytes():3===l?s.width=c.readVarint():4===l?s.height=c.readVarint():5===l?s.left=c.readSVarint():6===l?s.top=c.readSVarint():7===l&&(s.advance=c.readVarint())}function Kf(l){let s=0,c=0;for(const S of l)s+=S.w*S.h,c=Math.max(c,S.w);l.sort((S,R)=>R.h-S.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),c),h:1/0}];let v=0,C=0;for(const S of l)for(let R=f.length-1;R>=0;R--){const N=f[R];if(!(S.w>N.w||S.h>N.h)){if(S.x=N.x,S.y=N.y,C=Math.max(C,S.y+S.h),v=Math.max(v,S.x+S.w),S.w===N.w&&S.h===N.h){const U=f.pop();R<f.length&&(f[R]=U)}else S.h===N.h?(N.x+=S.w,N.w-=S.w):S.w===N.w?(N.y+=S.h,N.h-=S.h):(f.push({x:N.x+S.w,y:N.y,w:N.w-S.w,h:S.h}),N.y+=S.h,N.h-=S.h);break}}return{w:v,h:C,fill:s/(v*C)||0}}no.prototype={destroy:function(){this.buf=null},readFields:function(l,s,c){for(c=c||this.length;this.pos<c;){var f=this.readVarint(),v=f>>3,C=this.pos;this.type=7&f,l(v,s,this),this.pos===C&&this.skip(f)}return s},readMessage:function(l,s){return this.readFields(l,s,this.readVarint()+this.pos)},readFixed32:function(){var l=y_(this.buf,this.pos);return this.pos+=4,l},readSFixed32:function(){var l=Qp(this.buf,this.pos);return this.pos+=4,l},readFixed64:function(){var l=y_(this.buf,this.pos)+y_(this.buf,this.pos+4)*Xm;return this.pos+=8,l},readSFixed64:function(){var l=y_(this.buf,this.pos)+Qp(this.buf,this.pos+4)*Xm;return this.pos+=8,l},readFloat:function(){var l=Uy(this.buf,this.pos,!0,23,4);return this.pos+=4,l},readDouble:function(){var l=Uy(this.buf,this.pos,!0,52,8);return this.pos+=8,l},readVarint:function(l){var s,c,f=this.buf;return s=127&(c=f[this.pos++]),c<128?s:(s|=(127&(c=f[this.pos++]))<<7,c<128?s:(s|=(127&(c=f[this.pos++]))<<14,c<128?s:(s|=(127&(c=f[this.pos++]))<<21,c<128?s:function(v,C,S){var R,N,U=S.buf;if(R=(112&(N=U[S.pos++]))>>4,N<128||(R|=(127&(N=U[S.pos++]))<<3,N<128)||(R|=(127&(N=U[S.pos++]))<<10,N<128)||(R|=(127&(N=U[S.pos++]))<<17,N<128)||(R|=(127&(N=U[S.pos++]))<<24,N<128)||(R|=(1&(N=U[S.pos++]))<<31,N<128))return function Id(l,s,c){return c?4294967296*s+(l>>>0):4294967296*(s>>>0)+(l>>>0)}(v,R,C);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(c=f[this.pos]))<<28,l,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var l=this.readVarint();return l%2==1?(l+1)/-2:l/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var l=this.readVarint()+this.pos,s=this.pos;return this.pos=l,l-s>=12&&g_?g_.decode(this.buf.subarray(s,l)):function(c,f,v){for(var C="",S=f;S<v;){var R,N,U,W=c[S],Q=null,ee=W>239?4:W>223?3:W>191?2:1;if(S+ee>v)break;1===ee?W<128&&(Q=W):2===ee?128==(192&(R=c[S+1]))&&(Q=(31&W)<<6|63&R)<=127&&(Q=null):3===ee?(N=c[S+2],128==(192&(R=c[S+1]))&&128==(192&N)&&((Q=(15&W)<<12|(63&R)<<6|63&N)<=2047||Q>=55296&&Q<=57343)&&(Q=null)):4===ee&&(N=c[S+2],U=c[S+3],128==(192&(R=c[S+1]))&&128==(192&N)&&128==(192&U)&&((Q=(15&W)<<18|(63&R)<<12|(63&N)<<6|63&U)<=65535||Q>=1114112)&&(Q=null)),null===Q?(Q=65533,ee=1):Q>65535&&(Q-=65536,C+=String.fromCharCode(Q>>>10&1023|55296),Q=56320|1023&Q),C+=String.fromCharCode(Q),S+=ee}return C}(this.buf,s,l)},readBytes:function(){var l=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,l);return this.pos=l,s},readPackedVarint:function(l,s){if(this.type!==no.Bytes)return l.push(this.readVarint(s));var c=Sd(this);for(l=l||[];this.pos<c;)l.push(this.readVarint(s));return l},readPackedSVarint:function(l){if(this.type!==no.Bytes)return l.push(this.readSVarint());var s=Sd(this);for(l=l||[];this.pos<s;)l.push(this.readSVarint());return l},readPackedBoolean:function(l){if(this.type!==no.Bytes)return l.push(this.readBoolean());var s=Sd(this);for(l=l||[];this.pos<s;)l.push(this.readBoolean());return l},readPackedFloat:function(l){if(this.type!==no.Bytes)return l.push(this.readFloat());var s=Sd(this);for(l=l||[];this.pos<s;)l.push(this.readFloat());return l},readPackedDouble:function(l){if(this.type!==no.Bytes)return l.push(this.readDouble());var s=Sd(this);for(l=l||[];this.pos<s;)l.push(this.readDouble());return l},readPackedFixed32:function(l){if(this.type!==no.Bytes)return l.push(this.readFixed32());var s=Sd(this);for(l=l||[];this.pos<s;)l.push(this.readFixed32());return l},readPackedSFixed32:function(l){if(this.type!==no.Bytes)return l.push(this.readSFixed32());var s=Sd(this);for(l=l||[];this.pos<s;)l.push(this.readSFixed32());return l},readPackedFixed64:function(l){if(this.type!==no.Bytes)return l.push(this.readFixed64());var s=Sd(this);for(l=l||[];this.pos<s;)l.push(this.readFixed64());return l},readPackedSFixed64:function(l){if(this.type!==no.Bytes)return l.push(this.readSFixed64());var s=Sd(this);for(l=l||[];this.pos<s;)l.push(this.readSFixed64());return l},skip:function(l){var s=7&l;if(s===no.Varint)for(;this.buf[this.pos++]>127;);else if(s===no.Bytes)this.pos=this.readVarint()+this.pos;else if(s===no.Fixed32)this.pos+=4;else{if(s!==no.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(l,s){this.writeVarint(l<<3|s)},realloc:function(l){for(var s=this.length||16;s<this.pos+l;)s*=2;if(s!==this.length){var c=new Uint8Array(s);c.set(this.buf),this.buf=c,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(l){this.realloc(4),fc(this.buf,l,this.pos),this.pos+=4},writeSFixed32:function(l){this.realloc(4),fc(this.buf,l,this.pos),this.pos+=4},writeFixed64:function(l){this.realloc(8),fc(this.buf,-1&l,this.pos),fc(this.buf,Math.floor(l*eg),this.pos+4),this.pos+=8},writeSFixed64:function(l){this.realloc(8),fc(this.buf,-1&l,this.pos),fc(this.buf,Math.floor(l*eg),this.pos+4),this.pos+=8},writeVarint:function(l){(l=+l||0)>268435455||l<0?function(s,c){var f,v,C,R;if(s>=0?(f=s%4294967296|0,v=s/4294967296|0):(v=~(-s/4294967296),4294967295^(f=~(-s%4294967296))?f=f+1|0:(f=0,v=v+1|0)),s>=0x10000000000000000||s<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),C=f,(R=c).buf[R.pos++]=127&C|128,C>>>=7,R.buf[R.pos++]=127&C|128,C>>>=7,R.buf[R.pos++]=127&C|128,C>>>=7,R.buf[R.pos++]=127&C|128,R.buf[R.pos]=127&(C>>>=7),function(C,S){var R=(7&C)<<4;S.buf[S.pos++]|=R|((C>>>=3)?128:0),C&&(S.buf[S.pos++]=127&C|((C>>>=7)?128:0),C&&(S.buf[S.pos++]=127&C|((C>>>=7)?128:0),C&&(S.buf[S.pos++]=127&C|((C>>>=7)?128:0),C&&(S.buf[S.pos++]=127&C|((C>>>=7)?128:0),C&&(S.buf[S.pos++]=127&C)))))}(v,c)}(l,this):(this.realloc(4),this.buf[this.pos++]=127&l|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))},writeSVarint:function(l){this.writeVarint(l<0?2*-l-1:2*l)},writeBoolean:function(l){this.writeVarint(Boolean(l))},writeString:function(l){l=String(l),this.realloc(4*l.length),this.pos++;var s=this.pos;this.pos=function(f,v,C){for(var S,R,N=0;N<v.length;N++){if((S=v.charCodeAt(N))>55295&&S<57344){if(!R){S>56319||N+1===v.length?(f[C++]=239,f[C++]=191,f[C++]=189):R=S;continue}if(S<56320){f[C++]=239,f[C++]=191,f[C++]=189,R=S;continue}S=R-55296<<10|S-56320|65536,R=null}else R&&(f[C++]=239,f[C++]=191,f[C++]=189,R=null);S<128?f[C++]=S:(S<2048?f[C++]=S>>6|192:(S<65536?f[C++]=S>>12|224:(f[C++]=S>>18|240,f[C++]=S>>12&63|128),f[C++]=S>>6&63|128),f[C++]=63&S|128)}return C}(this.buf,l,this.pos);var c=this.pos-s;c>=128&&Dd(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c},writeFloat:function(l){this.realloc(4),yx(this.buf,l,this.pos,!0,23,4),this.pos+=4},writeDouble:function(l){this.realloc(8),yx(this.buf,l,this.pos,!0,52,8),this.pos+=8},writeBytes:function(l){var s=l.length;this.writeVarint(s),this.realloc(s);for(var c=0;c<s;c++)this.buf[this.pos++]=l[c]},writeRawMessage:function(l,s){this.pos++;var c=this.pos;l(s,this);var f=this.pos-c;f>=128&&Dd(c,f,this),this.pos=c-1,this.writeVarint(f),this.pos+=f},writeMessage:function(l,s,c){this.writeTag(l,no.Bytes),this.writeRawMessage(s,c)},writePackedVarint:function(l,s){s.length&&this.writeMessage(l,$0,s)},writePackedSVarint:function(l,s){s.length&&this.writeMessage(l,Hy,s)},writePackedBoolean:function(l,s){s.length&&this.writeMessage(l,Lh,s)},writePackedFloat:function(l,s){s.length&&this.writeMessage(l,AE,s)},writePackedDouble:function(l,s){s.length&&this.writeMessage(l,__,s)},writePackedFixed32:function(l,s){s.length&&this.writeMessage(l,W0,s)},writePackedSFixed32:function(l,s){s.length&&this.writeMessage(l,vx,s)},writePackedFixed64:function(l,s){s.length&&this.writeMessage(l,Jp,s)},writePackedSFixed64:function(l,s){s.length&&this.writeMessage(l,Z0,s)},writeBytesField:function(l,s){this.writeTag(l,no.Bytes),this.writeBytes(s)},writeFixed32Field:function(l,s){this.writeTag(l,no.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(l,s){this.writeTag(l,no.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(l,s){this.writeTag(l,no.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(l,s){this.writeTag(l,no.Fixed64),this.writeSFixed64(s)},writeVarintField:function(l,s){this.writeTag(l,no.Varint),this.writeVarint(s)},writeSVarintField:function(l,s){this.writeTag(l,no.Varint),this.writeSVarint(s)},writeStringField:function(l,s){this.writeTag(l,no.Bytes),this.writeString(s)},writeFloatField:function(l,s){this.writeTag(l,no.Fixed32),this.writeFloat(s)},writeDoubleField:function(l,s){this.writeTag(l,no.Fixed64),this.writeDouble(s)},writeBooleanField:function(l,s){this.writeVarintField(l,Boolean(s))}};class sp{constructor(s,{pixelRatio:c,version:f,stretchX:v,stretchY:C,content:S}){this.paddedRect=s,this.pixelRatio=c,this.stretchX=v,this.stretchY=C,this.content=S,this.version=f}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Xp{constructor(s,c){const f={},v={};this.haveRenderCallbacks=[];const C=[];this.addImages(s,f,C),this.addImages(c,v,C);const{w:S,h:R}=Kf(C),N=new hc({width:S||1,height:R||1});for(const U in s){const W=s[U],Q=f[U].paddedRect;hc.copy(W.data,N,{x:0,y:0},{x:Q.x+1,y:Q.y+1},W.data)}for(const U in c){const W=c[U],Q=v[U].paddedRect,ee=Q.x+1,oe=Q.y+1,le=W.data.width,he=W.data.height;hc.copy(W.data,N,{x:0,y:0},{x:ee,y:oe},W.data),hc.copy(W.data,N,{x:0,y:he-1},{x:ee,y:oe-1},{width:le,height:1}),hc.copy(W.data,N,{x:0,y:0},{x:ee,y:oe+he},{width:le,height:1}),hc.copy(W.data,N,{x:le-1,y:0},{x:ee-1,y:oe},{width:1,height:he}),hc.copy(W.data,N,{x:0,y:0},{x:ee+le,y:oe},{width:1,height:he})}this.image=N,this.iconPositions=f,this.patternPositions=v}addImages(s,c,f){for(const v in s){const C=s[v],S={x:0,y:0,w:C.data.width+2,h:C.data.height+2};f.push(S),c[v]=new sp(S,C),C.hasRenderCallback&&this.haveRenderCallbacks.push(v)}}patchUpdatedImages(s,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(f=>s.hasImage(f)),s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in s.updatedImages)this.patchUpdatedImage(this.iconPositions[f],s.getImage(f),c),this.patchUpdatedImage(this.patternPositions[f],s.getImage(f),c)}patchUpdatedImage(s,c,f){if(!s||!c||s.version===c.version)return;s.version=c.version;const[v,C]=s.tl;f.update(c.data,void 0,{x:v,y:C})}}Rn(sp,"ImagePosition"),Rn(Xp,"ImageAtlas");const rh={horizontal:1,vertical:2,horizontalOnly:3};class ap{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,c){const f=new ap;return f.scale=s||1,f.fontStack=c,f}static forImage(s){const c=new ap;return c.imageName=s,c}}class v_{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,c){const f=new v_;for(let v=0;v<s.sections.length;v++){const C=s.sections[v];C.image?f.addImageSection(C):f.addTextSection(C,c)}return f}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSections(){return this.sections}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(s){this.text=function(c,f){let v="";for(let C=0;C<c.length;C++){const S=c.charCodeAt(C+1)||null,R=c.charCodeAt(C-1)||null;v+=!f&&(S&&z(S)&&!m_[c[C+1]]||R&&z(R)&&!m_[c[C-1]])||!m_[c[C]]?c[C]:m_[c[C]]}return v}(this.text,s)}trim(){let s=0;for(let f=0;f<this.text.length&&b_[this.text.charCodeAt(f)];f++)s++;let c=this.text.length;for(let f=this.text.length-1;f>=0&&f>=s&&b_[this.text.charCodeAt(f)];f--)c--;this.text=this.text.substring(s,c),this.sectionIndex=this.sectionIndex.slice(s,c)}substring(s,c){const f=new v_;return f.text=this.text.substring(s,c),f.sectionIndex=this.sectionIndex.slice(s,c),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,c)=>Math.max(s,this.sections[c].scale),0)}addTextSection(s,c){this.text+=s.text,this.sections.push(ap.forText(s.scale,s.fontStack||c));const f=this.sections.length-1;for(let v=0;v<s.text.length;++v)this.sectionIndex.push(f)}addImageSection(s){const c=s.image?s.image.name:"";if(0===c.length)return void Ar("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(ap.forImage(c)),this.sectionIndex.push(this.sections.length-1)):Ar("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function jy(l,s,c,f,v,C,S,R,N,U,W,Q,ee,oe,le){const he=v_.fromFeature(l,v);Q===rh.vertical&&he.verticalizePunctuation(ee);let Ie=[];const Le=function($e,kt,St,Gt,Qt,Ft){if(!$e)return[];const Kt=[],Xt=function(In,mi,Pn,Kn,Mn,Yn){let Xi=0;for(let nr=0;nr<In.length();nr++){const Yi=In.getSection(nr);Xi+=Gy(In.getCharCode(nr),Yi,Kn,Mn,mi,Yn)}return Xi/Math.max(1,Math.ceil(Xi/Pn))}($e,kt,St,Gt,Qt,Ft),un=$e.text.indexOf("\u200b")>=0;let pn=0;for(let In=0;In<$e.length();In++){const mi=$e.getSection(In),Pn=$e.getCharCode(In);if(b_[Pn]||(pn+=Gy(Pn,mi,Gt,Qt,kt,Ft)),In<$e.length()-1){const Kn=!((Bt=Pn)<11904||!(Il(Bt)||hs(Bt)||w(Bt)||Oo(Bt)||kf(Bt)||Af(Bt)||Mf(Bt)||Hc(Bt)||zp(Bt)||fu(Bt)||Xu(Bt)||T(Bt)||oc(Bt)||To(Bt)||rc(Bt)||fd(Bt)||pu(Bt)||qn(Bt)||Ys(Bt)||Qd(Bt)));(Zc[Pn]||Kn||mi.imageName)&&Kt.push(w_(In+1,pn,Xt,Kt,oh(Pn,$e.getCharCode(In+1),Kn&&un),!1))}}var Bt;return x_(w_($e.length(),pn,Xt,Kt,0,!0))}(he,U,C,s,f,oe),{processBidirectionalText:ve,processStyledBidirectionalText:Pe}=Xe;if(ve&&1===he.sections.length){const $e=ve(he.toString(),Le);for(const kt of $e){const St=new v_;St.text=kt,St.sections=he.sections;for(let Gt=0;Gt<kt.length;Gt++)St.sectionIndex.push(0);Ie.push(St)}}else if(Pe){const $e=Pe(he.text,he.sectionIndex,Le);for(const kt of $e){const St=new v_;St.text=kt[0],St.sectionIndex=kt[1],St.sections=he.sections,Ie.push(St)}}else Ie=function($e,kt){const St=[],Gt=$e.text;let Qt=0;for(const Ft of kt)St.push($e.substring(Qt,Ft)),Qt=Ft;return Qt<Gt.length&&St.push($e.substring(Qt,Gt.length)),St}(he,Le);const He=[],Be={positionedLines:He,text:he.toString(),top:W[1],bottom:W[1],left:W[0],right:W[0],writingMode:Q,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function($e,kt,St,Gt,Qt,Ft,Kt,Xt,un,pn,Bt,In){let mi=0,Pn=0,Kn=0;const Mn="right"===Xt?1:"left"===Xt?0:.5;let Yn=!1;for(const Ri of Qt){const ar=Ri.getSections();for(const io of ar){if(io.imageName)continue;const So=kt[io.fontStack];if(So&&(Yn=void 0!==So.ascender&&void 0!==So.descender,!Yn))break}if(!Yn)break}let Xi=0;for(const Ri of Qt){Ri.trim();const ar=Ri.getMaxScale(),io=24*(ar-1),So={positionedGlyphs:[],lineOffset:0};$e.positionedLines[Xi]=So;const vo=So.positionedGlyphs;let Io=0;if(!Ri.length()){Pn+=Ft,++Xi;continue}let ro=0,os=0;for(let zr=0;zr<Ri.length();zr++){const Vs=Ri.getSection(zr),Ts=Ri.getSectionIndex(zr),Er=Ri.getCharCode(zr);let Wo=Vs.scale,Us=null,Br=null,ss=null,va=24,ca=0;const Ss=!(un===rh.horizontal||!Bt&&!M(Er)||Bt&&(b_[Er]||(nr=Er,Sh(nr)||Df(nr)||ic(nr)||Qr(nr)||_(nr))));if(Vs.imageName){const Xs=Gt[Vs.imageName];if(!Xs)continue;ss=Vs.imageName,$e.iconsInText=$e.iconsInText||!0,Br=Xs.paddedRect;const ua=Xs.displaySize;Wo=24*Wo/In,Us={width:ua[0],height:ua[1],left:1,top:-3,advance:Ss?ua[1]:ua[0],localGlyph:!1},ca=Yn?-Us.height*Wo:24*ar-17-ua[1]*Wo,va=Us.advance;const Vh=(Ss?ua[0]:ua[1])*Wo-24*ar;Vh>0&&Vh>Io&&(Io=Vh)}else{const Xs=St[Vs.fontStack];if(!Xs)continue;Xs[Er]&&(Br=Xs[Er]);const ua=kt[Vs.fontStack];if(!ua)continue;const Vh=ua.glyphs[Er];if(!Vh)continue;if(Us=Vh.metrics,va=8203!==Er?24:0,Yn){const Uh=void 0!==ua.ascender?Math.abs(ua.ascender):0,yg=void 0!==ua.descender?Math.abs(ua.descender):0,uf=(Uh+yg)*Wo;ro<uf&&(ro=uf,os=(Uh-yg)/2*Wo),ca=-Uh*Wo}else ca=24*(ar-Wo)-17}Ss?($e.verticalizable=!0,vo.push({glyph:Er,imageName:ss,x:mi,y:Pn+ca,vertical:Ss,scale:Wo,localGlyph:Us.localGlyph,fontStack:Vs.fontStack,sectionIndex:Ts,metrics:Us,rect:Br}),mi+=va*Wo+pn):(vo.push({glyph:Er,imageName:ss,x:mi,y:Pn+ca,vertical:Ss,scale:Wo,localGlyph:Us.localGlyph,fontStack:Vs.fontStack,sectionIndex:Ts,metrics:Us,rect:Br}),mi+=Us.advance*Wo+pn)}0!==vo.length&&(Kn=Math.max(mi-pn,Kn),Yn?kE(vo,Mn,Io,os,Ft*ar/2):kE(vo,Mn,Io,0,Ft/2)),mi=0;const Qs=Ft*ar+Io;So.lineOffset=Math.max(Io,io),Pn+=Qs,++Xi}var nr;const Yi=Pn,{horizontalAlign:_i,verticalAlign:Nr}=Jf(Kt);(function(Ri,ar,io,So,vo,Io){const ro=(ar-io)*vo,os=-Io*So;for(const Qs of Ri)for(const zr of Qs.positionedGlyphs)zr.x+=ro,zr.y+=os})($e.positionedLines,Mn,_i,Nr,Kn,Yi),$e.top+=-Nr*Yi,$e.bottom=$e.top+Yi,$e.left+=-_i*Kn,$e.right=$e.left+Kn,$e.hasBaseline=Yn}(Be,s,c,f,Ie,S,R,N,Q,U,ee,le),!function($e){for(const kt of $e)if(0!==kt.positionedGlyphs.length)return!1;return!0}(He)&&Be}const b_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Zc={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Gy(l,s,c,f,v,C){if(s.imageName){const S=f[s.imageName];return S?S.displaySize[0]*s.scale*24/C+v:0}{const S=c[s.fontStack],R=S&&S.glyphs[l];return R?R.metrics.advance*s.scale+v:0}}function Yf(l,s,c,f){const v=Math.pow(l-s,2);return f?l<s?v/2:2*v:v+Math.abs(c)*c}function oh(l,s,c){let f=0;return 10===l&&(f-=1e4),c&&(f+=150),40!==l&&65288!==l||(f+=50),41!==s&&65289!==s||(f+=50),f}function w_(l,s,c,f,v,C){let S=null,R=Yf(s,c,v,C);for(const N of f){const U=Yf(s-N.x,c,v,C)+N.badness;U<=R&&(S=N,R=U)}return{index:l,x:s,priorBreak:S,badness:R}}function x_(l){return l?x_(l.priorBreak).concat(l.index):[]}function Jf(l){let s=.5,c=.5;switch(l){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:s,verticalAlign:c}}function kE(l,s,c,f,v){if(!(s||c||f||v))return;const C=l.length-1,S=l[C],R=(S.x+S.metrics.advance*S.scale)*s;for(let N=0;N<=C;N++)l[N].x-=R,l[N].y+=c+f+v}function RE(l,s,c){const{horizontalAlign:f,verticalAlign:v}=Jf(c),C=s[0]-l.displaySize[0]*f,S=s[1]-l.displaySize[1]*v;return{image:l,top:S,bottom:S+l.displaySize[1],left:C,right:C+l.displaySize[0]}}function tg(l,s,c,f,v,C){const S=l.image;let R;if(S.content){const Ie=S.content,Le=S.pixelRatio||1;R=[Ie[0]/Le,Ie[1]/Le,S.displaySize[0]-Ie[2]/Le,S.displaySize[1]-Ie[3]/Le]}const N=s.left*C,U=s.right*C;let W,Q,ee,oe;"width"===c||"both"===c?(oe=v[0]+N-f[3],Q=v[0]+U+f[1]):(oe=v[0]+(N+U-S.displaySize[0])/2,Q=oe+S.displaySize[0]);const le=s.top*C,he=s.bottom*C;return"height"===c||"both"===c?(W=v[1]+le-f[0],ee=v[1]+he+f[2]):(W=v[1]+(le+he-S.displaySize[1])/2,ee=W+S.displaySize[1]),{image:S,top:W,right:Q,bottom:ee,left:oe,collisionPadding:R}}class lp extends st{constructor(s,c,f,v,C){super(s,c),this.angle=v,this.z=f,void 0!==C&&(this.segment=C)}clone(){return new lp(this.x,this.y,this.z,this.angle,this.segment)}}function bx(l,s,c,f,v){if(void 0===s.segment)return!0;let C=s,S=s.segment+1,R=0;for(;R>-c/2;){if(S--,S<0)return!1;R-=l[S].dist(C),C=l[S]}R+=l[S].dist(l[S+1]),S++;const N=[];let U=0;for(;R<c/2;){const W=l[S],Q=l[S+1];if(!Q)return!1;let ee=l[S-1].angleTo(W)-W.angleTo(Q);for(ee=Math.abs((ee+3*Math.PI)%(2*Math.PI)-Math.PI),N.push({distance:R,angleDelta:ee}),U+=ee;R-N[0].distance>f;)U-=N.shift().angleDelta;if(U>v)return!1;S++,R+=W.dist(Q)}return!0}function ng(l){let s=0;for(let c=0;c<l.length-1;c++)s+=l[c].dist(l[c+1]);return s}function C_(l,s,c){return l?.6*s*c:0}function $y(l,s){return Math.max(l?l.right-l.left:0,s?s.right-s.left:0)}function wx(l,s,c,f,v,C){const S=C_(c,v,C),R=$y(c,f)*C;let N=0;const U=ng(l)/2;for(let W=0;W<l.length-1;W++){const Q=l[W],ee=l[W+1],oe=Q.dist(ee);if(N+oe>U){const le=(U-N)/oe,he=Oi(Q.x,ee.x,le),Ie=Oi(Q.y,ee.y,le),Le=new lp(he,Ie,0,ee.angleTo(Q),W);return!S||bx(l,Le,R,S,s)?Le:void 0}N+=oe}}function xx(l,s,c,f,v,C,S,R,N){const U=C_(f,C,S),W=$y(f,v),Q=W*S,ee=0===l[0].x||l[0].x===N||0===l[0].y||l[0].y===N;return s-Q<s/4&&(s=Q+s/4),Cx(l,ee?s/2*R%s:(W/2+2*C)*S*R%s,s,U,c,Q,ee,!1,N)}function Cx(l,s,c,f,v,C,S,R,N){const U=C/2,W=ng(l);let Q=0,ee=s-c,oe=[];for(let le=0;le<l.length-1;le++){const he=l[le],Ie=l[le+1],Le=he.dist(Ie),ve=Ie.angleTo(he);for(;ee+c<Q+Le;){ee+=c;const Pe=(ee-Q)/Le,He=Oi(he.x,Ie.x,Pe),Be=Oi(he.y,Ie.y,Pe);if(He>=0&&He<N&&Be>=0&&Be<N&&ee-U>=0&&ee+U<=W){const $e=new lp(He,Be,0,ve,le);$e._round(),f&&!bx(l,$e,C,f,v)||oe.push($e)}}Q+=Le}return R||oe.length||S||(oe=Cx(l,Q/2,c,f,v,C,S,!0,N)),oe}function Wy(l,s,c,f,v){const C=[];for(let S=0;S<l.length;S++){const R=l[S];let N;for(let U=0;U<R.length-1;U++){let W=R[U],Q=R[U+1];W.x<s&&Q.x<s||(W.x<s?W=new st(s,W.y+(s-W.x)/(Q.x-W.x)*(Q.y-W.y))._round():Q.x<s&&(Q=new st(s,W.y+(s-W.x)/(Q.x-W.x)*(Q.y-W.y))._round()),W.y<c&&Q.y<c||(W.y<c?W=new st(W.x+(c-W.y)/(Q.y-W.y)*(Q.x-W.x),c)._round():Q.y<c&&(Q=new st(W.x+(c-W.y)/(Q.y-W.y)*(Q.x-W.x),c)._round()),W.x>=f&&Q.x>=f||(W.x>=f?W=new st(f,W.y+(f-W.x)/(Q.x-W.x)*(Q.y-W.y))._round():Q.x>=f&&(Q=new st(f,W.y+(f-W.x)/(Q.x-W.x)*(Q.y-W.y))._round()),W.y>=v&&Q.y>=v||(W.y>=v?W=new st(W.x+(v-W.y)/(Q.y-W.y)*(Q.x-W.x),v)._round():Q.y>=v&&(Q=new st(W.x+(v-W.y)/(Q.y-W.y)*(Q.x-W.x),v)._round()),N&&W.equals(N[N.length-1])||(N=[W],C.push(N)),N.push(Q)))))}}return C}Rn(lp,"Anchor");const ig=1e20;function Ex(l,s,c,f,v,C,S,R,N){for(let U=s;U<s+f;U++)Tx(l,c*C+U,C,v,S,R,N);for(let U=c;U<c+v;U++)Tx(l,U*C+s,1,f,S,R,N)}function Tx(l,s,c,f,v,C,S){C[0]=0,S[0]=-ig,S[1]=ig,v[0]=l[s];for(let R=1,N=0,U=0;R<f;R++){v[R]=l[s+R*c];const W=R*R;do{const Q=C[N];U=(v[R]-v[Q]+W-Q*Q)/(R-Q)/2}while(U<=S[N]&&--N>-1);N++,C[N]=R,S[N]=U,S[N+1]=ig}for(let R=0,N=0;R<f;R++){for(;S[N+1]<R;)N++;const U=C[N],W=R-U;l[s+R*c]=v[U]+W*W}}const Zy={none:0,ideographs:1,all:2};class ef{constructor(s,c,f){this.requestManager=s,this.localGlyphMode=c,this.localFontFamily=f,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(s){this.url=s}getGlyphs(s,c){const f=[];for(const v in s)for(const C of s[v])f.push({stack:v,id:C});ai(f,({stack:v,id:C},S)=>{let R=this.entries[v];R||(R=this.entries[v]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let N=R.glyphs[C];if(void 0!==N)return void S(null,{stack:v,id:C,glyph:N});if(N=this._tinySDF(R,v,C),N)return R.glyphs[C]=N,void S(null,{stack:v,id:C,glyph:N});const U=Math.floor(C/256);if(256*U>65535)return void S(new Error("glyphs > 65535 not supported"));if(R.ranges[U])return void S(null,{stack:v,id:C,glyph:N});let W=R.requests[U];W||(W=R.requests[U]=[],ef.loadGlyphRange(v,U,this.url,this.requestManager,(Q,ee)=>{if(ee){R.ascender=ee.ascender,R.descender=ee.descender;for(const oe in ee.glyphs)this._doesCharSupportLocalGlyph(+oe)||(R.glyphs[+oe]=ee.glyphs[+oe]);R.ranges[U]=!0}for(const oe of W)oe(Q,ee);delete R.requests[U]})),W.push((Q,ee)=>{Q?S(Q):ee&&S(null,{stack:v,id:C,glyph:ee.glyphs[C]||null})})},(v,C)=>{if(v)c(v);else if(C){const S={};for(const{stack:R,id:N,glyph:U}of C)void 0===S[R]&&(S[R]={}),void 0===S[R].glyphs&&(S[R].glyphs={}),S[R].glyphs[N]=U&&{id:U.id,bitmap:U.bitmap.clone(),metrics:U.metrics},S[R].ascender=this.entries[R].ascender,S[R].descender=this.entries[R].descender;c(null,S)}})}_doesCharSupportLocalGlyph(s){return this.localGlyphMode!==Zy.none&&(this.localGlyphMode===Zy.all?!!this.localFontFamily:!!this.localFontFamily&&(fu(s)||Xd(s)||oc(s)||pu(s)||Hc(s)))}_tinySDF(s,c,f){const v=this.localFontFamily;if(!v||!this._doesCharSupportLocalGlyph(f))return;let C=s.tinySDF;if(!C){let he="400";/bold/i.test(c)?he="900":/medium/i.test(c)?he="500":/light/i.test(c)&&(he="200"),C=s.tinySDF=new ef.TinySDF({fontFamily:v,fontWeight:he,fontSize:48,buffer:6,radius:16}),C.fontWeight=he}if(this.localGlyphs[C.fontWeight][f])return this.localGlyphs[C.fontWeight][f];const S=String.fromCharCode(f),{data:R,width:N,height:U,glyphWidth:W,glyphHeight:Q,glyphLeft:ee,glyphTop:oe,glyphAdvance:le}=C.draw(S);return this.localGlyphs[C.fontWeight][f]={id:f,bitmap:new ip({width:N,height:U},R),metrics:{width:W/2,height:Q/2,left:ee/2,top:oe/2-27,advance:le/2,localGlyph:!0}}}}function Sx(l,s,c,f){const v=[],C=l.image,S=C.pixelRatio,R=C.paddedRect.w-2,N=C.paddedRect.h-2,U=l.right-l.left,W=l.bottom-l.top,Q=C.stretchX||[[0,R]],ee=C.stretchY||[[0,N]],oe=(Ft,Kt)=>Ft+Kt[1]-Kt[0],le=Q.reduce(oe,0),he=ee.reduce(oe,0),Ie=R-le,Le=N-he;let ve=0,Pe=le,He=0,Be=he,$e=0,kt=Ie,St=0,Gt=Le;if(C.content&&f){const Ft=C.content;ve=rg(Q,0,Ft[0]),He=rg(ee,0,Ft[1]),Pe=rg(Q,Ft[0],Ft[2]),Be=rg(ee,Ft[1],Ft[3]),$e=Ft[0]-ve,St=Ft[1]-He,kt=Ft[2]-Ft[0]-Pe,Gt=Ft[3]-Ft[1]-Be}const Qt=(Ft,Kt,Xt,un)=>{const pn=og(Ft.stretch-ve,Pe,U,l.left),Bt=sg(Ft.fixed-$e,kt,Ft.stretch,le),In=og(Kt.stretch-He,Be,W,l.top),mi=sg(Kt.fixed-St,Gt,Kt.stretch,he),Pn=og(Xt.stretch-ve,Pe,U,l.left),Kn=sg(Xt.fixed-$e,kt,Xt.stretch,le),Mn=og(un.stretch-He,Be,W,l.top),Yn=sg(un.fixed-St,Gt,un.stretch,he),Xi=new st(pn,In),nr=new st(Pn,In),Yi=new st(Pn,Mn),_i=new st(pn,Mn),Nr=new st(Bt/S,mi/S),Ri=new st(Kn/S,Yn/S),ar=s*Math.PI/180;if(ar){const vo=Math.sin(ar),Io=Math.cos(ar),ro=[Io,-vo,vo,Io];Xi._matMult(ro),nr._matMult(ro),_i._matMult(ro),Yi._matMult(ro)}const io=Ft.stretch+Ft.fixed,So=Kt.stretch+Kt.fixed;return{tl:Xi,tr:nr,bl:_i,br:Yi,tex:{x:C.paddedRect.x+1+io,y:C.paddedRect.y+1+So,w:Xt.stretch+Xt.fixed-io,h:un.stretch+un.fixed-So},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Nr,pixelOffsetBR:Ri,minFontScaleX:kt/S/U,minFontScaleY:Gt/S/W,isSDF:c}};if(f&&(C.stretchX||C.stretchY)){const Ft=tf(Q,Ie,le),Kt=tf(ee,Le,he);for(let Xt=0;Xt<Ft.length-1;Xt++){const un=Ft[Xt],pn=Ft[Xt+1];for(let Bt=0;Bt<Kt.length-1;Bt++)v.push(Qt(un,Kt[Bt],pn,Kt[Bt+1]))}}else v.push(Qt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:R+1},{fixed:0,stretch:N+1}));return v}function rg(l,s,c){let f=0;for(const v of l)f+=Math.max(s,Math.min(c,v[1]))-Math.max(s,Math.min(c,v[0]));return f}function tf(l,s,c){const f=[{fixed:-1,stretch:0}];for(const[v,C]of l){const S=f[f.length-1];f.push({fixed:v-S.stretch,stretch:S.stretch}),f.push({fixed:v-S.stretch,stretch:S.stretch+(C-v)})}return f.push({fixed:s+1,stretch:c}),f}function og(l,s,c,f){return l/s*c+f}function sg(l,s,c,f){return l-s*c/f}function qy(l,s,c,f){const v=s+l.positionedLines[f].lineOffset;return 0===f?c+v/2:c+(v+(s+l.positionedLines[f-1].lineOffset))/2}ef.loadGlyphRange=function(l,s,c,f,v){const C=256*s,S=C+255,R=f.transformRequest(f.normalizeGlyphsURL(c).replace("{fontstack}",l).replace("{range}",`${C}-${S}`),ts.Glyphs);Jr(R,(N,U)=>{if(N)v(N);else if(U){const W={},Q=new Zf(U).readFields(qf,{});for(const ee of Q.glyphs)W[ee.id]=ee;v(null,{glyphs:W,ascender:Q.ascender,descender:Q.descender})}})},ef.TinySDF=class{constructor({fontSize:l=24,buffer:s=3,radius:c=8,cutoff:f=.25,fontFamily:v="sans-serif",fontWeight:C="normal",fontStyle:S="normal"}={}){this.buffer=s,this.cutoff=f,this.radius=c;const R=this.size=l+4*s,N=this._createCanvas(R),U=this.ctx=N.getContext("2d",{willReadFrequently:!0});U.font=`${S} ${C} ${l}px ${v}`,U.textBaseline="alphabetic",U.textAlign="left",U.fillStyle="black",this.gridOuter=new Float64Array(R*R),this.gridInner=new Float64Array(R*R),this.f=new Float64Array(R),this.z=new Float64Array(R+1),this.v=new Uint16Array(R)}_createCanvas(l){const s=document.createElement("canvas");return s.width=s.height=l,s}draw(l){const{width:s,actualBoundingBoxAscent:c,actualBoundingBoxDescent:f,actualBoundingBoxLeft:v,actualBoundingBoxRight:C}=this.ctx.measureText(l),S=Math.ceil(c),R=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(C-v))),N=Math.min(this.size-this.buffer,S+Math.ceil(f)),U=R+2*this.buffer,W=N+2*this.buffer,Q=Math.max(U*W,0),ee=new Uint8ClampedArray(Q),oe={data:ee,width:U,height:W,glyphWidth:R,glyphHeight:N,glyphTop:S,glyphLeft:0,glyphAdvance:s};if(0===R||0===N)return oe;const{ctx:le,buffer:he,gridInner:Ie,gridOuter:Le}=this;le.clearRect(he,he,R,N),le.fillText(l,he,he+S);const ve=le.getImageData(he,he,R,N);Le.fill(ig,0,Q),Ie.fill(0,0,Q);for(let Pe=0;Pe<N;Pe++)for(let He=0;He<R;He++){const Be=ve.data[4*(Pe*R+He)+3]/255;if(0===Be)continue;const $e=(Pe+he)*U+He+he;if(1===Be)Le[$e]=0,Ie[$e]=ig;else{const kt=.5-Be;Le[$e]=kt>0?kt*kt:0,Ie[$e]=kt<0?kt*kt:0}}Ex(Le,0,0,U,W,U,this.f,this.v,this.z),Ex(Ie,he,he,R,N,U,this.f,this.v,this.z);for(let Pe=0;Pe<Q;Pe++){const He=Math.sqrt(Le[Pe])-Math.sqrt(Ie[Pe]);ee[Pe]=Math.round(255-255*(He/this.radius+this.cutoff))}return oe}};class PE{constructor(s=[],c=OE){if(this.data=s,this.length=this.data.length,this.compare=c,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const s=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:c,compare:f}=this,v=c[s];for(;s>0;){const C=s-1>>1,S=c[C];if(f(v,S)>=0)break;c[s]=S,s=C}c[s]=v}_down(s){const{data:c,compare:f}=this,v=this.length>>1,C=c[s];for(;s<v;){let S=1+(s<<1),R=c[S];const N=S+1;if(N<this.length&&f(c[N],R)<0&&(S=N,R=c[N]),f(R,C)>=0)break;c[s]=R,s=S}c[s]=C}}function OE(l,s){return l<s?-1:l>s?1:0}function LE(l,s=1,c=!1){let f=1/0,v=1/0,C=-1/0,S=-1/0;const R=l[0];for(let oe=0;oe<R.length;oe++){const le=R[oe];(!oe||le.x<f)&&(f=le.x),(!oe||le.y<v)&&(v=le.y),(!oe||le.x>C)&&(C=le.x),(!oe||le.y>S)&&(S=le.y)}const N=Math.min(C-f,S-v);let U=N/2;const W=new PE([],Ix);if(0===N)return new st(f,v);for(let oe=f;oe<C;oe+=N)for(let le=v;le<S;le+=N)W.push(new Qf(oe+U,le+U,U,l));let Q=function(oe){let le=0,he=0,Ie=0;const Le=oe[0];for(let ve=0,Pe=Le.length,He=Pe-1;ve<Pe;He=ve++){const Be=Le[ve],$e=Le[He],kt=Be.x*$e.y-$e.x*Be.y;he+=(Be.x+$e.x)*kt,Ie+=(Be.y+$e.y)*kt,le+=3*kt}return new Qf(he/le,Ie/le,0,oe)}(l),ee=W.length;for(;W.length;){const oe=W.pop();(oe.d>Q.d||!Q.d)&&(Q=oe,c&&console.log("found best %d after %d probes",Math.round(1e4*oe.d)/1e4,ee)),oe.max-Q.d<=s||(U=oe.h/2,W.push(new Qf(oe.p.x-U,oe.p.y-U,U,l)),W.push(new Qf(oe.p.x+U,oe.p.y-U,U,l)),W.push(new Qf(oe.p.x-U,oe.p.y+U,U,l)),W.push(new Qf(oe.p.x+U,oe.p.y+U,U,l)),ee+=4)}return c&&(console.log(`num probes: ${ee}`),console.log(`best distance: ${Q.d}`)),Q.p}function Ix(l,s){return s.max-l.max}class Qf{constructor(s,c,f,v){this.p=new st(s,c),this.h=f,this.d=function(C,S){let R=!1,N=1/0;for(let U=0;U<S.length;U++){const W=S[U];for(let Q=0,ee=W.length,oe=ee-1;Q<ee;oe=Q++){const le=W[Q],he=W[oe];le.y>C.y!=he.y>C.y&&C.x<(he.x-le.x)*(C.y-le.y)/(he.y-le.y)+le.x&&(R=!R),N=Math.min(N,M0(C,le,he))}}return(R?1:-1)*Math.sqrt(N)}(this.p,v),this.max=this.d+this.h*Math.SQRT2}}const E_=Number.POSITIVE_INFINITY,TD=Math.sqrt(2);function ag(l,[s,c]){let f=0,v=0;if(c===E_){s<0&&(s=0);const C=s/TD;switch(l){case"top-right":case"top-left":v=C-7;break;case"bottom-right":case"bottom-left":v=7-C;break;case"bottom":v=7-s;break;case"top":v=s-7}switch(l){case"top-right":case"bottom-right":f=-C;break;case"top-left":case"bottom-left":f=C;break;case"left":f=s;break;case"right":f=-s}}else{switch(s=Math.abs(s),c=Math.abs(c),l){case"top-right":case"top-left":case"top":v=c-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-c}switch(l){case"top-right":case"bottom-right":case"right":f=-s;break;case"top-left":case"bottom-left":case"left":f=s}}return[f,v]}function lg(l,s,c,f,v,C,S,R,N,U){l.createArrays(),l.tilePixelRatio=Ci/(512*l.overscaling),l.compareText={},l.iconsNeedLinear=!1;const W=l.layers[0].layout,Q=l.layers[0]._unevaluatedLayout._values,ee={};if("composite"===l.textSizeData.kind){const{minZoom:he,maxZoom:Ie}=l.textSizeData;ee.compositeTextSizes=[Q["text-size"].possiblyEvaluate(new ut(he),R),Q["text-size"].possiblyEvaluate(new ut(Ie),R)]}if("composite"===l.iconSizeData.kind){const{minZoom:he,maxZoom:Ie}=l.iconSizeData;ee.compositeIconSizes=[Q["icon-size"].possiblyEvaluate(new ut(he),R),Q["icon-size"].possiblyEvaluate(new ut(Ie),R)]}ee.layoutTextSize=Q["text-size"].possiblyEvaluate(new ut(N+1),R),ee.layoutIconSize=Q["icon-size"].possiblyEvaluate(new ut(N+1),R),ee.textMaxSize=Q["text-size"].possiblyEvaluate(new ut(18),R);const oe="map"===W.get("text-rotation-alignment")&&"point"!==W.get("symbol-placement"),le=W.get("text-size");for(const he of l.features){const Ie=W.get("text-font").evaluate(he,{},R).join(","),Le=le.evaluate(he,{},R),ve=ee.layoutTextSize.evaluate(he,{},R),Pe=(ee.layoutIconSize.evaluate(he,{},R),{horizontal:{},vertical:void 0}),He=he.text;let Be,$e=[0,0];if(He){const Gt=He.toString(),Qt=24*W.get("text-letter-spacing").evaluate(he,{},R),Ft=24*W.get("text-line-height").evaluate(he,{},R),Kt=P(Gt)?Qt:0,Xt=W.get("text-anchor").evaluate(he,{},R),un=W.get("text-variable-anchor");if(!un){const Pn=W.get("text-radial-offset").evaluate(he,{},R);$e=Pn?ag(Xt,[24*Pn,E_]):W.get("text-offset").evaluate(he,{},R).map(Kn=>24*Kn)}let pn=oe?"center":W.get("text-justify").evaluate(he,{},R);const Bt="point"===W.get("symbol-placement"),In=Bt?24*W.get("text-max-width").evaluate(he,{},R):1/0,mi=Pn=>{l.allowVerticalPlacement&&k(Gt)&&(Pe.vertical=jy(He,s,c,v,Ie,In,Ft,Xt,Pn,Kt,$e,rh.vertical,!0,ve,Le))};if(!oe&&un){const Pn="auto"===pn?un.map(Mn=>sh(Mn)):[pn];let Kn=!1;for(let Mn=0;Mn<Pn.length;Mn++){const Yn=Pn[Mn];if(!Pe.horizontal[Yn])if(Kn)Pe.horizontal[Yn]=Pe.horizontal[0];else{const Xi=jy(He,s,c,v,Ie,In,Ft,"center",Yn,Kt,$e,rh.horizontal,!1,ve,Le);Xi&&(Pe.horizontal[Yn]=Xi,Kn=1===Xi.positionedLines.length)}}mi("left")}else{if("auto"===pn&&(pn=sh(Xt)),Bt||W.get("text-writing-mode").indexOf("horizontal")>=0||!k(Gt)){const Pn=jy(He,s,c,v,Ie,In,Ft,Xt,pn,Kt,$e,rh.horizontal,!1,ve,Le);Pn&&(Pe.horizontal[pn]=Pn)}mi(Bt?"left":pn)}}let kt=!1;if(he.icon&&he.icon.name){const Gt=f[he.icon.name];Gt&&(Be=RE(v[he.icon.name],W.get("icon-offset").evaluate(he,{},R),W.get("icon-anchor").evaluate(he,{},R)),kt=Gt.sdf,void 0===l.sdfIcons?l.sdfIcons=Gt.sdf:l.sdfIcons!==Gt.sdf&&Ar("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Gt.pixelRatio!==l.pixelRatio||0!==W.get("icon-rotate").constantOr(1))&&(l.iconsNeedLinear=!0))}const St=FE(Pe.horizontal)||Pe.vertical;l.iconsInText||(l.iconsInText=!!St&&St.iconsInText),(St||Be)&&SD(l,he,Pe,Be,f,ee,ve,0,$e,kt,S,R,U)}C&&l.generateCollisionDebugBuffers(N,l.collisionBoxArray)}function sh(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function SD(l,s,c,f,v,C,S,R,N,U,W,Q,ee){let oe=C.textMaxSize.evaluate(s,{},Q);void 0===oe&&(oe=S);const le=l.layers[0].layout,he=le.get("icon-offset").evaluate(s,{},Q),Ie=FE(c.horizontal)||c.vertical,Le="globe"===ee.name,ve=S/24,Pe=l.tilePixelRatio*oe/24,He=(Kt=l.overscaling,l.zoom>18&&Kt>2&&(Kt>>=1),Math.max(Ci/(512*Kt),1)*le.get("symbol-spacing")),Be=le.get("text-padding")*l.tilePixelRatio,$e=le.get("icon-padding")*l.tilePixelRatio,kt=it(le.get("text-max-angle")),St="map"===le.get("text-rotation-alignment")&&"point"!==le.get("symbol-placement"),Gt="map"===le.get("icon-rotation-alignment")&&"point"!==le.get("symbol-placement"),Qt=le.get("symbol-placement"),Ft=He/2;var Kt;const Xt=le.get("icon-text-fit");let un;f&&"none"!==Xt&&(l.allowVerticalPlacement&&c.vertical&&(un=tg(f,c.vertical,Xt,le.get("icon-text-fit-padding"),he,ve)),Ie&&(f=tg(f,Ie,Xt,le.get("icon-text-fit-padding"),he,ve)));const pn=(Bt,In,mi)=>{if(In.x<0||In.x>=Ci||In.y<0||In.y>=Ci)return;let Pn=null;if(Le){const{x:Kn,y:Mn,z:Yn}=ee.projectTilePoint(In.x,In.y,mi);Pn={anchor:new lp(Kn,Mn,Yn,0,void 0),up:ee.upVector(mi,In.x,In.y)}}!function(Kn,Mn,Yn,Xi,nr,Yi,_i,Nr,Ri,ar,io,So,vo,Io,ro,os,Qs,zr,Vs,Ts,Er,Wo,Us,Br,ss){const va=Kn.addToLineVertexArray(Mn,Xi);let ca,Ss,Xs,ua,Vh,Uh,yg,uf=0,Vx=0,N_=0,hb=0,Ux=-1,Fi=-1;const Iu={};let tv=Mt("");const mp=Yn?Yn.anchor:Mn;let Od=0,nv=0;if(void 0===Ri._unevaluatedLayout.getValue("text-radial-offset")?[Od,nv]=Ri.layout.get("text-offset").evaluate(Er,{},ss).map(Kc=>24*Kc):(Od=24*Ri.layout.get("text-radial-offset").evaluate(Er,{},ss),nv=E_),Kn.allowVerticalPlacement&&nr.vertical){const Kc=nr.vertical;if(ro)Uh=Ax(Kc),Nr&&(yg=Ax(Nr));else{const gc=Ri.layout.get("text-rotate").evaluate(Er,{},ss)+90;Xs=nf(ar,mp,Mn,io,So,vo,Kc,Io,gc,os),Nr&&(ua=nf(ar,mp,Mn,io,So,vo,Nr,zr,gc))}}if(Yi){const Kc=Ri.layout.get("icon-rotate").evaluate(Er,{},ss),gc="none"!==Ri.layout.get("icon-text-fit"),vg=Sx(Yi,Kc,Us,gc),db=Nr?Sx(Nr,Kc,Us,gc):void 0;Ss=nf(ar,mp,Mn,io,So,vo,Yi,zr,Kc),uf=4*vg.length;const pb=Kn.iconSizeData;let hf=null;"source"===pb.kind?(hf=[Oh*Ri.layout.get("icon-size").evaluate(Er,{},ss)],hf[0]>ah&&Ar(`${Kn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===pb.kind&&(hf=[Oh*Wo.compositeIconSizes[0].evaluate(Er,{},ss),Oh*Wo.compositeIconSizes[1].evaluate(Er,{},ss)],(hf[0]>ah||hf[1]>ah)&&Ar(`${Kn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Kn.addSymbols(Kn.icon,vg,hf,Ts,Vs,Er,!1,Yn,Mn,va.lineStartIndex,va.lineLength,-1,Br,ss),Ux=Kn.icon.placedSymbolArray.length-1,db&&(Vx=4*db.length,Kn.addSymbols(Kn.icon,db,hf,Ts,Vs,Er,rh.vertical,Yn,Mn,va.lineStartIndex,va.lineLength,-1,Br,ss),Fi=Kn.icon.placedSymbolArray.length-1)}for(const Kc in nr.horizontal){const gc=nr.horizontal[Kc];ca||(tv=Mt(gc.text),ro?Vh=Ax(gc):ca=nf(ar,mp,Mn,io,So,vo,gc,Io,Ri.layout.get("text-rotate").evaluate(Er,{},ss),os));const vg=1===gc.positionedLines.length;if(N_+=Dx(Kn,Yn,Mn,gc,_i,Ri,ro,Er,os,va,nr.vertical?rh.horizontal:rh.horizontalOnly,vg?Object.keys(nr.horizontal):[Kc],Iu,Ux,Wo,Br,ss),vg)break}nr.vertical&&(hb+=Dx(Kn,Yn,Mn,nr.vertical,_i,Ri,ro,Er,os,va,rh.vertical,["vertical"],Iu,Fi,Wo,Br,ss));let Hh=-1;const lm=(Kc,gc)=>Kc?Math.max(Kc,gc):gc;Hh=lm(Vh,Hh),Hh=lm(Uh,Hh),Hh=lm(yg,Hh);const Jo=Hh>-1?1:0;Kn.glyphOffsetArray.length>=sf.MAX_GLYPHS&&Ar("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Er.sortKey&&Kn.addToSortKeyRanges(Kn.symbolInstances.length,Er.sortKey),Kn.symbolInstances.emplaceBack(mp.x,mp.y,mp.z,Mn.x,Mn.y,Iu.right>=0?Iu.right:-1,Iu.center>=0?Iu.center:-1,Iu.left>=0?Iu.left:-1,Iu.vertical>=0?Iu.vertical:-1,Ux,Fi,tv,void 0!==ca?ca:Kn.collisionBoxArray.length,void 0!==ca?ca+1:Kn.collisionBoxArray.length,void 0!==Xs?Xs:Kn.collisionBoxArray.length,void 0!==Xs?Xs+1:Kn.collisionBoxArray.length,void 0!==Ss?Ss:Kn.collisionBoxArray.length,void 0!==Ss?Ss+1:Kn.collisionBoxArray.length,ua||Kn.collisionBoxArray.length,ua?ua+1:Kn.collisionBoxArray.length,io,N_,hb,uf,Vx,Jo,0,Od,nv,Hh)}(l,In,Pn,Bt,c,f,v,un,l.layers[0],l.collisionBoxArray,s.index,s.sourceLayerIndex,l.index,Be,St,N,0,$e,Gt,he,s,C,U,W,Q)};if("line"===Qt)for(const Bt of Wy(s.geometry,0,0,Ci,Ci)){const In=xx(Bt,He,kt,c.vertical||Ie,f,24,Pe,l.overscaling,Ci);for(const mi of In)Ie&&Ad(l,Ie.text,Ft,mi)||pn(Bt,mi,Q)}else if("line-center"===Qt){for(const Bt of s.geometry)if(Bt.length>1){const In=wx(Bt,kt,c.vertical||Ie,f,24,Pe);In&&pn(Bt,In,Q)}}else if("Polygon"===s.type)for(const Bt of ih(s.geometry,0)){const In=LE(Bt,16);pn(Bt[0],new lp(In.x,In.y,0,0,void 0),Q)}else if("LineString"===s.type)for(const Bt of s.geometry)pn(Bt,new lp(Bt[0].x,Bt[0].y,0,0,void 0),Q);else if("Point"===s.type)for(const Bt of s.geometry)for(const In of Bt)pn([In],new lp(In.x,In.y,0,0,void 0),Q)}const ah=32640;function Dx(l,s,c,f,v,C,S,R,N,U,W,Q,ee,oe,le,he,Ie){const Le=function(He,Be,$e,kt,St,Gt,Qt,Ft){const Kt=[];if(0===Be.positionedLines.length)return Kt;const Xt=kt.layout.get("text-rotate").evaluate(Gt,{})*Math.PI/180,un=function(Pn){const Kn=Pn[0],Mn=Pn[1],Yn=Kn*Mn;return Yn>0?[Kn,-Mn]:Yn<0?[-Kn,Mn]:0===Kn?[Mn,Kn]:[Mn,-Kn]}($e);let pn=Math.abs(Be.top-Be.bottom);for(const Pn of Be.positionedLines)pn-=Pn.lineOffset;const Bt=Be.positionedLines.length,In=pn/Bt;let mi=Be.top-$e[1];for(let Pn=0;Pn<Bt;++Pn){const Kn=Be.positionedLines[Pn];mi=qy(Be,In,mi,Pn);for(const Mn of Kn.positionedGlyphs){if(!Mn.rect)continue;const Yn=Mn.rect||{};let Xi=4,nr=!0,Yi=1,_i=0;if(Mn.imageName){const Br=Qt[Mn.imageName];if(!Br)continue;if(Br.sdf){Ar("SDF images are not supported in formatted text and will be ignored.");continue}nr=!1,Yi=Br.pixelRatio,Xi=1/Yi}const Nr=(St||Ft)&&Mn.vertical,Ri=Mn.metrics.advance*Mn.scale/2,ar=Mn.metrics,io=Mn.rect;if(null===io)continue;Ft&&Be.verticalizable&&(_i=Mn.imageName?Ri-Mn.metrics.width*Mn.scale/2:0);const So=St?[Mn.x+Ri,Mn.y]:[0,0];let vo=[0,0],Io=[0,0],ro=!1;St||(Nr?(Io=[Mn.x+Ri+un[0],Mn.y+un[1]-_i],ro=!0):vo=[Mn.x+Ri+$e[0],Mn.y+$e[1]-_i]);const os=io.w*Mn.scale/(Yi*(Mn.localGlyph?2:1)),Qs=io.h*Mn.scale/(Yi*(Mn.localGlyph?2:1));let zr,Vs,Ts,Er;if(Nr){const Br=Mn.y-mi,ss=new st(-Ri,Ri-Br),va=-Math.PI/2,ca=new st(...Io);zr=new st(-Ri+vo[0],vo[1]),zr._rotateAround(va,ss)._add(ca),zr.x+=-Br+Ri,zr.y-=(ar.left-Xi)*Mn.scale;const Ss=Mn.imageName?ar.advance*Mn.scale:24*Mn.scale,Xs=String.fromCharCode(Mn.glyph);gx(Xs)?zr.x+=(1-Xi)*Mn.scale:_x(Xs)?zr.x+=Ss-ar.height*Mn.scale+(-Xi-1)*Mn.scale:zr.x+=Mn.imageName||ar.width+2*Xi===io.w&&ar.height+2*Xi===io.h?(Ss-Qs)/2:(Ss-(ar.height+2*Xi)*Mn.scale)/2,Vs=new st(zr.x,zr.y-os),Ts=new st(zr.x+Qs,zr.y),Er=new st(zr.x+Qs,zr.y-os)}else{const Br=(ar.left-Xi)*Mn.scale-Ri+vo[0],ss=(-ar.top-Xi)*Mn.scale+vo[1],va=Br+os,ca=ss+Qs;zr=new st(Br,ss),Vs=new st(va,ss),Ts=new st(Br,ca),Er=new st(va,ca)}if(Xt){let Br;Br=St?new st(0,0):ro?new st(un[0],un[1]):new st($e[0],$e[1]),zr._rotateAround(Xt,Br),Vs._rotateAround(Xt,Br),Ts._rotateAround(Xt,Br),Er._rotateAround(Xt,Br)}const Wo=new st(0,0),Us=new st(0,0);Kt.push({tl:zr,tr:Vs,bl:Ts,br:Er,tex:Yn,writingMode:Be.writingMode,glyphOffset:So,sectionIndex:Mn.sectionIndex,isSDF:nr,pixelOffsetTL:Wo,pixelOffsetBR:Us,minFontScaleX:0,minFontScaleY:0})}}return Kt}(0,f,N,C,S,R,v,l.allowVerticalPlacement),ve=l.textSizeData;let Pe=null;"source"===ve.kind?(Pe=[Oh*C.layout.get("text-size").evaluate(R,{},Ie)],Pe[0]>ah&&Ar(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===ve.kind&&(Pe=[Oh*le.compositeTextSizes[0].evaluate(R,{},Ie),Oh*le.compositeTextSizes[1].evaluate(R,{},Ie)],(Pe[0]>ah||Pe[1]>ah)&&Ar(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),l.addSymbols(l.text,Le,Pe,N,S,R,W,s,c,U.lineStartIndex,U.lineLength,oe,he,Ie);for(const He of Q)ee[He]=l.text.placedSymbolArray.length-1;return 4*Le.length}function FE(l){for(const s in l)return l[s];return null}function nf(l,s,c,f,v,C,S,R,N,U){let W=S.top,Q=S.bottom,ee=S.left,oe=S.right;const le=S.collisionPadding;if(le&&(ee-=le[0],W-=le[1],oe+=le[2],Q+=le[3]),N){const he=new st(ee,W),Ie=new st(oe,W),Le=new st(ee,Q),ve=new st(oe,Q),Pe=it(N);let He=new st(0,0);U&&(He=new st(U[0],U[1])),he._rotateAround(Pe,He),Ie._rotateAround(Pe,He),Le._rotateAround(Pe,He),ve._rotateAround(Pe,He),ee=Math.min(he.x,Ie.x,Le.x,ve.x),oe=Math.max(he.x,Ie.x,Le.x,ve.x),W=Math.min(he.y,Ie.y,Le.y,ve.y),Q=Math.max(he.y,Ie.y,Le.y,ve.y)}return l.emplaceBack(s.x,s.y,s.z,c.x,c.y,ee,W,oe,Q,R,f,v,C),l.length-1}function Ax(l){l.collisionPadding&&(l.top-=l.collisionPadding[1],l.bottom+=l.collisionPadding[3]);const s=l.bottom-l.top;return s>0?Math.max(10,s):null}function Ad(l,s,c,f){const v=l.compareText;if(s in v){const C=v[s];for(let S=C.length-1;S>=0;S--)if(f.dist(C[S])<c)return!0}else v[s]=[];return v[s].push(f),!1}function cg(l,s){const c=l.fovAboveCenter,f=l.elevation?l.elevation.getMinElevationBelowMSL()*s:0,v=(l._camera.position[2]*l.worldSize-f)/Math.cos(l._pitch),C=Math.sin(c)*v/Math.sin(Math.max(Math.PI/2-l._pitch-c,.01)),S=Math.sin(l._pitch)*C+v;return Math.min(1.01*S,v*(1/l._horizonShift))}function Bs(l,s){if(!s.isReprojectedInTileSpace)return{scale:1<<l.z,x:l.x,y:l.y,x2:l.x+1,y2:l.y+1,projection:s};const c=Math.pow(2,-l.z),f=l.x*c,v=(l.x+1)*c,C=l.y*c,S=(l.y+1)*c,R=uc(f),N=uc(v),U=Ua(C),W=Ua(S),Q=s.project(R,U),ee=s.project(N,U),oe=s.project(N,W),le=s.project(R,W);let he=Math.min(Q.x,ee.x,oe.x,le.x),Ie=Math.min(Q.y,ee.y,oe.y,le.y),Le=Math.max(Q.x,ee.x,oe.x,le.x),ve=Math.max(Q.y,ee.y,oe.y,le.y);const Pe=c/16;function He($e,kt,St,Gt,Qt,Ft){const Kt=(St+Qt)/2,Xt=(Gt+Ft)/2,un=s.project(uc(Kt),Ua(Xt)),pn=Math.max(0,he-un.x,Ie-un.y,un.x-Le,un.y-ve);he=Math.min(he,un.x),Le=Math.max(Le,un.x),Ie=Math.min(Ie,un.y),ve=Math.max(ve,un.y),pn>Pe&&(He($e,un,St,Gt,Kt,Xt),He(un,kt,Kt,Xt,Qt,Ft))}He(Q,ee,f,C,v,C),He(ee,oe,v,C,v,S),He(oe,le,v,S,f,S),He(le,Q,f,S,f,C),he-=Pe,Ie-=Pe,Le+=Pe,ve+=Pe;const Be=1/Math.max(Le-he,ve-Ie);return{scale:Be,x:he*Be,y:Ie*Be,x2:Le*Be,y2:ve*Be,projection:s}}const cp=kl(new Float32Array(16));class lh{constructor(s){this.spec=s,this.name=s.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(s,c){return{x:0,y:0,z:0}}unproject(s,c){return new br(0,0)}projectTilePoint(s,c,f){return{x:s,y:c,z:0}}locationPoint(s,c,f=!0){return s._coordinatePoint(s.locationCoordinate(c),f)}pixelsPerMeter(s,c){return Gc(1,s)*c}pixelSpaceConversion(s,c,f){return 1}farthestPixelDistance(s){return cg(s,s.pixelsPerMeter)}pointCoordinate(s,c,f,v){const C=s.horizonLineFromTop(!1),S=new st(c,Math.max(C,f));return s.rayIntersectionCoordinate(s.pointRayIntersection(S,v))}pointCoordinate3D(s,c,f){const v=new st(c,f);if(s.elevation)return s.elevation.pointCoordinate(v);{const C=this.pointCoordinate(s,v.x,v.y,0);return[C.x,C.y,C.z]}}isPointAboveHorizon(s,c){if(s.elevation)return!this.pointCoordinate3D(s,c.x,c.y);const f=s.horizonLineFromTop();return c.y<f}createInversionMatrix(s,c){return cp}createTileMatrix(s,c,f){let v,C,S;const R=f.canonical,N=kl(new Float64Array(16));if(this.isReprojectedInTileSpace){const U=Bs(R,this);v=1,C=U.x+f.wrap*U.scale,S=U.y,yd(N,N,[v/U.scale,v/U.scale,s.pixelsPerMeter/c])}else v=c/s.zoomScale(R.z),C=(R.x+Math.pow(2,R.z)*f.wrap)*v,S=R.y*v;return Hp(N,N,[C,S,0]),yd(N,N,[v/Ci,v/Ci,1]),N}upVector(s,c,f){return[0,0,1]}upVectorScale(s,c,f){return{metersToTile:1}}}class Fh extends lh{constructor(s){super(s),this.range=[4,7],this.center=s.center||[-96,37.5];const[c,f]=this.parallels=s.parallels||[29.5,45.5],v=Math.sin(it(c));this.n=(v+Math.sin(it(f)))/2,this.c=1+v*(2*this.n-v),this.r0=Math.sqrt(this.c)/this.n}project(s,c){const{n:f,c:v,r0:C}=this,S=it(s-this.center[0]),R=it(c),N=Math.sqrt(v-2*f*Math.sin(R))/f;return{x:N*Math.sin(S*f),y:N*Math.cos(S*f)-C,z:0}}unproject(s,c){const{n:f,c:v,r0:C}=this,S=C+c;let R=Math.atan2(s,Math.abs(S))*Math.sign(S);S*f<0&&(R-=Math.PI*Math.sign(s)*Math.sign(S));const N=it(this.center[0])*f;R=wn(R,-Math.PI-N,Math.PI-N);const U=It(zt(R/f)+this.center[0],-180,180),W=Math.asin(It((v-(s*s+S*S)*f*f)/(2*f),-1,1)),Q=It(zt(W),-Da,Da);return new br(U,Q)}}const Xf=1.340264,Md=-.081106,kd=893e-6,Rd=.003796,up=Math.sqrt(3)/2;class ug extends lh{project(s,c){c=c/180*Math.PI,s=s/180*Math.PI;const f=Math.asin(up*Math.sin(c)),v=f*f,C=v*v*v;return{x:.5*(s*Math.cos(f)/(up*(Xf+3*Md*v+C*(7*kd+9*Rd*v)))/Math.PI+.5),y:1-.5*(f*(Xf+Md*v+C*(kd+Rd*v))/Math.PI+1),z:0}}unproject(s,c){s=(2*s-.5)*Math.PI;let f=c=(2*(1-c)-1)*Math.PI,v=f*f,C=v*v*v;for(let W,Q,ee,oe=0;oe<12&&(Q=f*(Xf+Md*v+C*(kd+Rd*v))-c,ee=Xf+3*Md*v+C*(7*kd+9*Rd*v),W=Q/ee,f=It(f-W,-Math.PI/3,Math.PI/3),v=f*f,C=v*v*v,!(Math.abs(W)<1e-12));++oe);const S=up*s*(Xf+3*Md*v+C*(7*kd+9*Rd*v))/Math.cos(f),R=Math.asin(Math.sin(f)/up),N=It(180*S/Math.PI,-180,180),U=It(180*R/Math.PI,-Da,Da);return new br(N,U)}}class em extends lh{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0}project(s,c){return{x:.5+s/360,y:.5-c/360,z:0}}unproject(s,c){const f=360*(s-.5),v=It(360*(.5-c),-Da,Da);return new br(f,v)}}const Nh=Math.PI/2;function hp(l){return Math.tan((Nh+l)/2)}class tm extends lh{constructor(s){super(s),this.center=s.center||[0,30];const[c,f]=this.parallels=s.parallels||[30,30];let v=it(c),C=it(f);this.southernCenter=v+C<0,this.southernCenter&&(v=-v,C=-C);const S=Math.cos(v),R=hp(v);this.n=v===C?Math.sin(v):Math.log(S/Math.cos(C))/Math.log(hp(C)/R),this.f=S*Math.pow(hp(v),this.n)/this.n}project(s,c){c=it(c),this.southernCenter&&(c=-c),s=it(s-this.center[0]);const f=1e-6,{n:v,f:C}=this;C>0?c<-Nh+f&&(c=-Nh+f):c>Nh-f&&(c=Nh-f);const S=C/Math.pow(hp(c),v);let R=S*Math.sin(v*s),N=C-S*Math.cos(v*s);return R=.5*(R/Math.PI+.5),N=.5*(N/Math.PI+.5),{x:R,y:this.southernCenter?N:1-N,z:0}}unproject(s,c){s=(2*s-.5)*Math.PI,this.southernCenter&&(c=1-c),c=(2*(1-c)-.5)*Math.PI;const{n:f,f:v}=this,C=v-c,S=Math.sign(C),R=Math.sign(f)*Math.sqrt(s*s+C*C);let N=Math.atan2(s,Math.abs(C))*S;C*f<0&&(N-=Math.PI*Math.sign(s)*S);const U=It(zt(N/f)+this.center[0],-180,180),W=It(zt(2*Math.atan(Math.pow(v/R,1/f))-Nh),-Da,Da);return new br(U,this.southernCenter?-W:W)}}class K0 extends lh{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(s,c){return{x:kh(s),y:cc(c),z:0}}unproject(s,c){const f=uc(s),v=Ua(c);return new br(f,v)}}const T_=it(Da);class Mx extends lh{project(s,c){const f=(c=it(c))*c,v=f*f;return{x:.5*((s=it(s))*(.8707-.131979*f+v*(v*(.003971*f-.001529*v)-.013791))/Math.PI+.5),y:1-.5*(c*(1.007226+f*(.015085+v*(.028874*f-.044475-.005916*v)))/Math.PI+1),z:0}}unproject(s,c){s=(2*s-.5)*Math.PI;let f=c=(2*(1-c)-1)*Math.PI,v=25,C=0,S=f*f;do{S=f*f;const U=S*S;C=(f*(1.007226+S*(.015085+U*(.028874*S-.044475-.005916*U)))-c)/(1.007226+S*(.045255+U*(.259866*S-.311325-.005916*11*U))),f=It(f-C,-T_,T_)}while(Math.abs(C)>1e-6&&--v>0);S=f*f;const R=It(zt(s/(.8707+S*(S*(S*S*S*(.003971-.001529*S)-.013791)-.131979))),-180,180),N=zt(f);return new br(R,N)}}const Y0=it(Da);class kx extends lh{project(s,c){c=it(c),s=it(s);const f=Math.cos(c),v=2/Math.PI,C=Math.acos(f*Math.cos(s/2)),S=Math.sin(C)/C,R=.5*(s*v+2*f*Math.sin(s/2)/S)||0,N=.5*(c+Math.sin(c)/S)||0;return{x:.5*(R/Math.PI+.5),y:1-.5*(N/Math.PI+1),z:0}}unproject(s,c){let f=s=(2*s-.5)*Math.PI,v=c=(2*(1-c)-1)*Math.PI,C=25;const S=1e-6;let R=0,N=0;do{const U=Math.cos(v),W=Math.sin(v),Q=2*W*U,ee=W*W,oe=U*U,le=Math.cos(f/2),he=Math.sin(f/2),Ie=2*le*he,Le=he*he,ve=1-oe*le*le,Pe=ve?1/ve:0,He=ve?Math.acos(U*le)*Math.sqrt(1/ve):0,Be=.5*(2*He*U*he+2*f/Math.PI)-s,$e=.5*(He*W+v)-c,kt=.5*Pe*(oe*Le+He*U*le*ee)+1/Math.PI,St=Pe*(Ie*Q/4-He*W*he),Gt=.125*Pe*(Q*he-He*W*oe*Ie),Qt=.5*Pe*(ee*le+He*Le*U)+.5,Ft=St*Gt-Qt*kt;R=($e*St-Be*Qt)/Ft,N=(Be*Gt-$e*kt)/Ft,f=It(f-R,-Math.PI,Math.PI),v=It(v-N,-Y0,Y0)}while((Math.abs(R)>S||Math.abs(N)>S)&&--C>0);return new br(zt(f),zt(v))}}class J0 extends lh{constructor(s){super(s),this.center=s.center||[0,0],this.parallels=s.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(it(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(s,c){const{scale:f,cosPhi:v}=this;return{x:it(s)*v*f+.5,y:-Math.sin(it(c))/v*f+.5,z:0}}unproject(s,c){const{scale:f,cosPhi:v}=this,C=-(c-.5)/f,S=It(zt((s-.5)/f)/v,-180,180),R=Math.asin(It(C*v,-1,1)),N=It(zt(R),-Da,Da);return new br(S,N)}}class Q0 extends K0{constructor(s){super(s),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(s,c,f){const v=Pm(s,c,f);return ds(v,v,Om(Pl(f))),{x:v[0],y:v[1],z:v[2]}}locationPoint(s,c){const f=zf(c.lat,c.lng),v=Va([],f),C=s.elevation?s.elevation.getAtPointOrZero(s.locationCoordinate(c),s._centerAltitude):s._centerAltitude;Lf(f,f,v,Gc(1,0)*Ci*C);const S=kl(new Float64Array(16));return Dh(S,s.pixelMatrix,s.globeMatrix),ds(f,f,S),new st(f[0],f[1])}pixelsPerMeter(s,c){return Gc(1,0)*c}pixelSpaceConversion(s,c,f){const v=Gc(1,s)*c,C=Oi(Gc(1,45)*c,v,f);return this.pixelsPerMeter(s,c)/C}createTileMatrix(s,c,f){const v=b0(Pl(f.canonical));return Dh(new Float64Array(16),s.globeMatrix,v)}createInversionMatrix(s,c){const{center:f}=s,v=Om(Pl(c));return Sm(v,v,it(f.lng)),jp(v,v,it(f.lat)),yd(v,v,[s._pixelsPerMercatorPixel,s._pixelsPerMercatorPixel,1]),Float32Array.from(v)}pointCoordinate(s,c,f,v){return Xg(s,c,f,!0)||new zm(0,0)}pointCoordinate3D(s,c,f){const v=this.pointCoordinate(s,c,f,0);return[v.x,v.y,v.z]}isPointAboveHorizon(s,c){return!Xg(s,c.x,c.y,!1)}farthestPixelDistance(s){const c=function(v,C){const S=v.cameraToCenterDistance,R=v._centerAltitude*C,N=v._camera,U=v._camera.forward(),W=bd([],Rl([],U,-S),[0,0,R]),Q=v.worldSize/(2*Math.PI),ee=[0,0,-Q],oe=v.width/v.height,le=Math.tan(v.fovAboveCenter),he=Rl([],N.up(),le),Ie=Rl([],N.right(),le*oe),Le=Va([],bd([],bd([],U,he),Ie)),ve=[];let Pe;if(new Mm(W,Le).closestPointOnSphere(ee,Q,ve)){const He=bd([],ve,ee),Be=Ah([],He,W);Pe=Math.cos(v.fovAboveCenter)*vu(Be)}else{const He=Ah([],W,ee),Be=Ah([],ee,W);Va(Be,Be);const $e=vu(He)-Q;Pe=Math.sqrt($e*($e+2*Q));const kt=Math.acos(Pe/(Q+$e))-Math.acos(bu(U,Be));Pe*=Math.cos(kt)}return 1.01*Pe}(s,this.pixelsPerMeter(s.center.lat,s.worldSize)),f=Lm(s.zoom);if(f>0){const v=cg(s,Gc(1,s.center.lat)*s.worldSize),C=s.worldSize/(2*Math.PI),S=Math.max(s.width,s.height)/s.worldSize*Math.PI;return Oi(c,v+C*(1-Math.cos(S)),Math.pow(f,10))}return c}upVector(s,c,f){return Pm(c,f,s,1)}upVectorScale(s){return{metersToTile:_y(Wp(Pl(s)))}}}function X0(l){const s=l.parallels,c=!!s&&Math.abs(s[0]+s[1])<.01;switch(l.name){case"mercator":return new K0(l);case"equirectangular":return new em(l);case"naturalEarth":return new Mx(l);case"equalEarth":return new ug(l);case"winkelTripel":return new kx(l);case"albers":return c?new J0(l):new Fh(l);case"lambertConformalConic":return c?new J0(l):new tm(l);case"globe":return new Q0(l)}throw new Error(`Invalid projection name: ${l.name}`)}const Eu=V0.types,eb=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function rf(l,s,c,f,v,C,S,R,N,U,W,Q,ee){const oe=R?Math.min(ah,Math.round(R[0])):0,le=R?Math.min(ah,Math.round(R[1])):0;l.emplaceBack(s,c,Math.round(32*f),Math.round(32*v),C,S,(oe<<1)+(N?1:0),le,16*U,16*W,256*Q,256*ee)}function nm(l,s,c,f,v,C,S){l.emplaceBack(s,c,f,v,C,S)}function Ky(l,s,c,f,v){l.emplaceBack(s,c,f,v),l.emplaceBack(s,c,f,v),l.emplaceBack(s,c,f,v),l.emplaceBack(s,c,f,v)}function Rx(l){for(const s of l.sections)if(te(s.text))return!0;return!1}class im{constructor(s){this.layoutVertexArray=new mu,this.indexArray=new Ns,this.programConfigurations=s,this.segments=new Cs,this.dynamicLayoutVertexArray=new Kr,this.opacityVertexArray=new hr,this.placedSymbolArray=new ly,this.globeExtVertexArray=new eo}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(s,c,f,v){this.isEmpty()||(f&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Ny.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,zy.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,eb,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,p_.members,!0)),this.opacityVertexBuffer.itemSize=1),(f||v)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Rn(im,"SymbolBuffers");class S_{constructor(s,c,f){this.layoutVertexArray=new s,this.layoutAttributes=c,this.indexArray=new f,this.segments=new Cs,this.collisionVertexArray=new Fr,this.collisionVertexArrayExt=new Fs}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,G0.members,!0),this.collisionVertexBufferExt=s.createVertexBuffer(this.collisionVertexArrayExt,f_.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Rn(S_,"CollisionBuffers");class sf{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(S=>S.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=kl([]),this.placementViewportMatrix=kl([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=By(this.zoom,c["text-size"]),this.iconSizeData=By(this.zoom,c["icon-size"]);const f=this.layers[0].layout,v=f.get("symbol-sort-key"),C=f.get("symbol-z-order");this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==C&&void 0!==v.constantOr(1),this.sortFeaturesByY=("viewport-y"===C||"auto"===C&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=f.get("text-writing-mode").map(S=>rh[S]),this.stateDependentLayerIds=this.layers.filter(S=>S.isStateDependent()).map(S=>S.id),this.sourceID=s.sourceID,this.projection=s.projection}createArrays(){this.text=new im(new xm(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new im(new xm(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new cy,this.lineVertexArray=new Z,this.symbolInstances=new h0}calculateGlyphDependencies(s,c,f,v,C){for(let S=0;S<s.length;S++)if(c[s.charCodeAt(S)]=!0,v&&C){const R=m_[s.charAt(S)];R&&(c[R.charCodeAt(0)]=!0)}}populate(s,c,f,v){const C=this.layers[0],S=C.layout,R="globe"===this.projection.name,N=S.get("text-font"),U=S.get("text-field"),W=S.get("icon-image"),Q=("constant"!==U.value.kind||U.value.value instanceof uo&&!U.value.value.isEmpty()||U.value.value.toString().length>0)&&("constant"!==N.value.kind||N.value.value.length>0),ee="constant"!==W.value.kind||!!W.value.value||Object.keys(W.parameters).length>0,oe=S.get("symbol-sort-key");if(this.features=[],!Q&&!ee)return;const le=c.iconDependencies,he=c.glyphDependencies,Ie=c.availableImages,Le=new ut(this.zoom);for(const{feature:ve,id:Pe,index:He,sourceLayerIndex:Be}of s){const $e=C._featureFilter.needGeometry,kt=wu(ve,$e);if(!C._featureFilter.filter(Le,kt,f))continue;if($e||(kt.geometry=xd(ve,f,v)),R&&1!==ve.type&&f.z<=5){const Ft=kt.geometry,Kt=.98078528056,Xt=(un,pn)=>bu(Pm(un.x,un.y,f,1),Pm(pn.x,pn.y,f,1))<Kt;for(let un=0;un<Ft.length;un++)Ft[un]=by(Ft[un],Xt)}let St,Gt;if(Q){const Ft=C.getValueAndResolveTokens("text-field",kt,f,Ie),Kt=uo.factory(Ft);Rx(Kt)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Ye()||this.hasRTLText&&Xe.isParsed())&&(St=Wc(Kt,C,kt))}if(ee){const Ft=C.getValueAndResolveTokens("icon-image",kt,f,Ie);Gt=Ft instanceof ko?Ft:ko.fromString(Ft)}if(!St&&!Gt)continue;const Qt=this.sortFeaturesByKey?oe.evaluate(kt,{},f):void 0;if(this.features.push({id:Pe,text:St,icon:Gt,index:He,sourceLayerIndex:Be,geometry:kt.geometry,properties:ve.properties,type:Eu[ve.type],sortKey:Qt}),Gt&&(le[Gt.name]=!0),St){const Ft=N.evaluate(kt,{},f).join(","),Kt="map"===S.get("text-rotation-alignment")&&"point"!==S.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(rh.vertical)>=0;for(const Xt of St.sections)if(Xt.image)le[Xt.image.name]=!0;else{const un=k(St.toString()),pn=Xt.fontStack||Ft,Bt=he[pn]=he[pn]||{};this.calculateGlyphDependencies(Xt.text,Bt,Kt,this.allowVerticalPlacement,un)}}}"line"===S.get("symbol-placement")&&(this.features=function(ve){const Pe={},He={},Be=[];let $e=0;function kt(Ft){Be.push(ve[Ft]),$e++}function St(Ft,Kt,Xt){const un=He[Ft];return delete He[Ft],He[Kt]=un,Be[un].geometry[0].pop(),Be[un].geometry[0]=Be[un].geometry[0].concat(Xt[0]),un}function Gt(Ft,Kt,Xt){const un=Pe[Kt];return delete Pe[Kt],Pe[Ft]=un,Be[un].geometry[0].shift(),Be[un].geometry[0]=Xt[0].concat(Be[un].geometry[0]),un}function Qt(Ft,Kt,Xt){const un=Xt?Kt[0][Kt[0].length-1]:Kt[0][0];return`${Ft}:${un.x}:${un.y}`}for(let Ft=0;Ft<ve.length;Ft++){const Kt=ve[Ft],Xt=Kt.geometry,un=Kt.text?Kt.text.toString():null;if(!un){kt(Ft);continue}const pn=Qt(un,Xt),Bt=Qt(un,Xt,!0);if(pn in He&&Bt in Pe&&He[pn]!==Pe[Bt]){const In=Gt(pn,Bt,Xt),mi=St(pn,Bt,Be[In].geometry);delete Pe[pn],delete He[Bt],He[Qt(un,Be[mi].geometry,!0)]=mi,Be[In].geometry=null}else pn in He?St(pn,Bt,Xt):Bt in Pe?Gt(pn,Bt,Xt):(kt(Ft),Pe[pn]=$e-1,He[Bt]=$e-1)}return Be.filter(Ft=>Ft.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ve,Pe)=>ve.sortKey-Pe.sortKey)}update(s,c,f,v){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,c,this.layers,f,v),this.icon.programConfigurations.updatePaintArrays(s,c,this.layers,f,v))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=X0(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,c){const f=this.lineVertexArray.length;if(void 0!==s.segment)for(const{x:v,y:C}of c)this.lineVertexArray.emplaceBack(v,C);return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(s,c,f,v,C,S,R,N,U,W,Q,ee,oe,le){const he=s.indexArray,Ie=s.layoutVertexArray,Le=s.globeExtVertexArray,ve=s.segments.prepareSegment(4*c.length,Ie,he,this.canOverlap?S.sortKey:void 0),Pe=this.glyphOffsetArray.length,He=ve.vertexLength,Be=this.allowVerticalPlacement&&R===rh.vertical?Math.PI/2:0,$e=S.text&&S.text.sections;for(let St=0;St<c.length;St++){const{tl:Gt,tr:Qt,bl:Ft,br:Kt,tex:Xt,pixelOffsetTL:un,pixelOffsetBR:pn,minFontScaleX:Bt,minFontScaleY:In,glyphOffset:mi,isSDF:Pn,sectionIndex:Kn}=c[St],Mn=ve.vertexLength,Yn=mi[1];if(rf(Ie,U.x,U.y,Gt.x,Yn+Gt.y,Xt.x,Xt.y,f,Pn,un.x,un.y,Bt,In),rf(Ie,U.x,U.y,Qt.x,Yn+Qt.y,Xt.x+Xt.w,Xt.y,f,Pn,pn.x,un.y,Bt,In),rf(Ie,U.x,U.y,Ft.x,Yn+Ft.y,Xt.x,Xt.y+Xt.h,f,Pn,un.x,pn.y,Bt,In),rf(Ie,U.x,U.y,Kt.x,Yn+Kt.y,Xt.x+Xt.w,Xt.y+Xt.h,f,Pn,pn.x,pn.y,Bt,In),N){const{x:Xi,y:nr,z:Yi}=N.anchor,[_i,Nr,Ri]=N.up;nm(Le,Xi,nr,Yi,_i,Nr,Ri),nm(Le,Xi,nr,Yi,_i,Nr,Ri),nm(Le,Xi,nr,Yi,_i,Nr,Ri),nm(Le,Xi,nr,Yi,_i,Nr,Ri),Ky(s.dynamicLayoutVertexArray,Xi,nr,Yi,Be)}else Ky(s.dynamicLayoutVertexArray,U.x,U.y,U.z,Be);he.emplaceBack(Mn,Mn+1,Mn+2),he.emplaceBack(Mn+1,Mn+2,Mn+3),ve.vertexLength+=4,ve.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(mi[0]),St!==c.length-1&&Kn===c[St+1].sectionIndex||s.programConfigurations.populatePaintArrays(Ie.length,S,S.index,{},oe,le,$e&&$e[Kn])}const kt=N?N.anchor:U;s.placedSymbolArray.emplaceBack(kt.x,kt.y,kt.z,U.x,U.y,Pe,this.glyphOffsetArray.length-Pe,He,W,Q,U.segment,f?f[0]:0,f?f[1]:0,v[0],v[1],R,0,!1,0,ee,0)}_commitLayoutVertex(s,c,f,v,C,S,R){s.emplaceBack(c,f,v,C,S,Math.round(R.x),Math.round(R.y))}_addCollisionDebugVertices(s,c,f,v,C,S,R){const N=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),U=N.vertexLength,W=R.tileAnchorX,Q=R.tileAnchorY;for(let oe=0;oe<4;oe++)f.collisionVertexArray.emplaceBack(0,0,0,0);f.collisionVertexArrayExt.emplaceBack(c,-s.padding,-s.padding),f.collisionVertexArrayExt.emplaceBack(c,s.padding,-s.padding),f.collisionVertexArrayExt.emplaceBack(c,s.padding,s.padding),f.collisionVertexArrayExt.emplaceBack(c,-s.padding,s.padding),this._commitLayoutVertex(f.layoutVertexArray,v,C,S,W,Q,new st(s.x1,s.y1)),this._commitLayoutVertex(f.layoutVertexArray,v,C,S,W,Q,new st(s.x2,s.y1)),this._commitLayoutVertex(f.layoutVertexArray,v,C,S,W,Q,new st(s.x2,s.y2)),this._commitLayoutVertex(f.layoutVertexArray,v,C,S,W,Q,new st(s.x1,s.y2)),N.vertexLength+=4;const ee=f.indexArray;ee.emplaceBack(U,U+1),ee.emplaceBack(U+1,U+2),ee.emplaceBack(U+2,U+3),ee.emplaceBack(U+3,U),N.primitiveLength+=4}_addTextDebugCollisionBoxes(s,c,f,v,C,S){for(let R=v;R<C;R++){const N=f.get(R),U=this.getSymbolInstanceTextSize(s,S,c,R);this._addCollisionDebugVertices(N,U,this.textCollisionBox,N.projectedAnchorX,N.projectedAnchorY,N.projectedAnchorZ,S)}}_addIconDebugCollisionBoxes(s,c,f,v,C,S){for(let R=v;R<C;R++){const N=f.get(R),U=this.getSymbolInstanceIconSize(s,c,S.placedIconSymbolIndex);this._addCollisionDebugVertices(N,U,this.iconCollisionBox,N.projectedAnchorX,N.projectedAnchorY,N.projectedAnchorZ,S)}}generateCollisionDebugBuffers(s,c){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new S_(Lo,IE.members,yo),this.iconCollisionBox=new S_(Lo,IE.members,yo);const f=Qm(this.iconSizeData,s),v=Qm(this.textSizeData,s);for(let C=0;C<this.symbolInstances.length;C++){const S=this.symbolInstances.get(C);this._addTextDebugCollisionBoxes(v,s,c,S.textBoxStartIndex,S.textBoxEndIndex,S),this._addTextDebugCollisionBoxes(v,s,c,S.verticalTextBoxStartIndex,S.verticalTextBoxEndIndex,S),this._addIconDebugCollisionBoxes(f,s,c,S.iconBoxStartIndex,S.iconBoxEndIndex,S),this._addIconDebugCollisionBoxes(f,s,c,S.verticalIconBoxStartIndex,S.verticalIconBoxEndIndex,S)}}getSymbolInstanceTextSize(s,c,f,v){const C=this.text.placedSymbolArray.get(c.rightJustifiedTextSymbolIndex>=0?c.rightJustifiedTextSymbolIndex:c.centerJustifiedTextSymbolIndex>=0?c.centerJustifiedTextSymbolIndex:c.leftJustifiedTextSymbolIndex>=0?c.leftJustifiedTextSymbolIndex:c.verticalPlacedTextSymbolIndex>=0?c.verticalPlacedTextSymbolIndex:v),S=Vy(this.textSizeData,s,C)/24;return this.tilePixelRatio*S}getSymbolInstanceIconSize(s,c,f){const v=this.icon.placedSymbolArray.get(f),C=Vy(this.iconSizeData,s,v);return this.tilePixelRatio*C}_commitDebugCollisionVertexUpdate(s,c,f){s.emplaceBack(c,-f,-f),s.emplaceBack(c,f,-f),s.emplaceBack(c,f,f),s.emplaceBack(c,-f,f)}_updateTextDebugCollisionBoxes(s,c,f,v,C,S){for(let R=v;R<C;R++){const N=f.get(R),U=this.getSymbolInstanceTextSize(s,S,c,R);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,U,N.padding)}}_updateIconDebugCollisionBoxes(s,c,f,v,C,S){for(let R=v;R<C;R++){const N=f.get(R),U=this.getSymbolInstanceIconSize(s,c,S);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,U,N.padding)}}updateCollisionDebugBuffers(s,c){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const f=Qm(this.iconSizeData,s),v=Qm(this.textSizeData,s);for(let C=0;C<this.symbolInstances.length;C++){const S=this.symbolInstances.get(C);this._updateTextDebugCollisionBoxes(v,s,c,S.textBoxStartIndex,S.textBoxEndIndex,S),this._updateTextDebugCollisionBoxes(v,s,c,S.verticalTextBoxStartIndex,S.verticalTextBoxEndIndex,S),this._updateIconDebugCollisionBoxes(f,s,c,S.iconBoxStartIndex,S.iconBoxEndIndex,S.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(f,s,c,S.verticalIconBoxStartIndex,S.verticalIconBoxEndIndex,S.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(s,c,f,v,C,S,R,N,U){const W={};if(c<f){const{x1:Q,y1:ee,x2:oe,y2:le,padding:he,projectedAnchorX:Ie,projectedAnchorY:Le,projectedAnchorZ:ve,tileAnchorX:Pe,tileAnchorY:He,featureIndex:Be}=s.get(c);W.textBox={x1:Q,y1:ee,x2:oe,y2:le,padding:he,projectedAnchorX:Ie,projectedAnchorY:Le,projectedAnchorZ:ve,tileAnchorX:Pe,tileAnchorY:He},W.textFeatureIndex=Be}if(v<C){const{x1:Q,y1:ee,x2:oe,y2:le,padding:he,projectedAnchorX:Ie,projectedAnchorY:Le,projectedAnchorZ:ve,tileAnchorX:Pe,tileAnchorY:He,featureIndex:Be}=s.get(v);W.verticalTextBox={x1:Q,y1:ee,x2:oe,y2:le,padding:he,projectedAnchorX:Ie,projectedAnchorY:Le,projectedAnchorZ:ve,tileAnchorX:Pe,tileAnchorY:He},W.verticalTextFeatureIndex=Be}if(S<R){const{x1:Q,y1:ee,x2:oe,y2:le,padding:he,projectedAnchorX:Ie,projectedAnchorY:Le,projectedAnchorZ:ve,tileAnchorX:Pe,tileAnchorY:He,featureIndex:Be}=s.get(S);W.iconBox={x1:Q,y1:ee,x2:oe,y2:le,padding:he,projectedAnchorX:Ie,projectedAnchorY:Le,projectedAnchorZ:ve,tileAnchorX:Pe,tileAnchorY:He},W.iconFeatureIndex=Be}if(N<U){const{x1:Q,y1:ee,x2:oe,y2:le,padding:he,projectedAnchorX:Ie,projectedAnchorY:Le,projectedAnchorZ:ve,tileAnchorX:Pe,tileAnchorY:He,featureIndex:Be}=s.get(N);W.verticalIconBox={x1:Q,y1:ee,x2:oe,y2:le,padding:he,projectedAnchorX:Ie,projectedAnchorY:Le,projectedAnchorZ:ve,tileAnchorX:Pe,tileAnchorY:He},W.verticalIconFeatureIndex=Be}return W}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const f=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,c){const f=s.placedSymbolArray.get(c),v=f.vertexStartIndex+4*f.numGlyphs;for(let C=f.vertexStartIndex;C<v;C+=4)s.indexArray.emplaceBack(C,C+1,C+2),s.indexArray.emplaceBack(C+1,C+2,C+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const c=Math.sin(s),f=Math.cos(s),v=[],C=[],S=[];for(let R=0;R<this.symbolInstances.length;++R){S.push(R);const N=this.symbolInstances.get(R);v.push(0|Math.round(c*N.tileAnchorX+f*N.tileAnchorY)),C.push(N.featureIndex)}return S.sort((R,N)=>v[R]-v[N]||C[N]-C[R]),S}addToSortKeyRanges(s,c){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===c?f.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const f=this.symbolInstances.get(c);this.featureSortOrder.push(f.featureIndex);const{rightJustifiedTextSymbolIndex:v,centerJustifiedTextSymbolIndex:C,leftJustifiedTextSymbolIndex:S,verticalPlacedTextSymbolIndex:R,placedIconSymbolIndex:N,verticalPlacedIconSymbolIndex:U}=f;v>=0&&this.addIndicesForPlacedSymbol(this.text,v),C>=0&&C!==v&&this.addIndicesForPlacedSymbol(this.text,C),S>=0&&S!==C&&S!==v&&this.addIndicesForPlacedSymbol(this.text,S),R>=0&&this.addIndicesForPlacedSymbol(this.text,R),N>=0&&this.addIndicesForPlacedSymbol(this.icon,N),U>=0&&this.addIndicesForPlacedSymbol(this.icon,U)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Rn(sf,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),sf.MAX_GLYPHS=65535,sf.addDynamicAttributes=Ky;const rm=new hn({"symbol-placement":new yt(Rt.layout_symbol["symbol-placement"]),"symbol-spacing":new yt(Rt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new yt(Rt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Pt(Rt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new yt(Rt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new yt(Rt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new yt(Rt.layout_symbol["icon-ignore-placement"]),"icon-optional":new yt(Rt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new yt(Rt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Pt(Rt.layout_symbol["icon-size"]),"icon-text-fit":new yt(Rt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new yt(Rt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Pt(Rt.layout_symbol["icon-image"]),"icon-rotate":new Pt(Rt.layout_symbol["icon-rotate"]),"icon-padding":new yt(Rt.layout_symbol["icon-padding"]),"icon-keep-upright":new yt(Rt.layout_symbol["icon-keep-upright"]),"icon-offset":new Pt(Rt.layout_symbol["icon-offset"]),"icon-anchor":new Pt(Rt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new yt(Rt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new yt(Rt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new yt(Rt.layout_symbol["text-rotation-alignment"]),"text-field":new Pt(Rt.layout_symbol["text-field"]),"text-font":new Pt(Rt.layout_symbol["text-font"]),"text-size":new Pt(Rt.layout_symbol["text-size"]),"text-max-width":new Pt(Rt.layout_symbol["text-max-width"]),"text-line-height":new Pt(Rt.layout_symbol["text-line-height"]),"text-letter-spacing":new Pt(Rt.layout_symbol["text-letter-spacing"]),"text-justify":new Pt(Rt.layout_symbol["text-justify"]),"text-radial-offset":new Pt(Rt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new yt(Rt.layout_symbol["text-variable-anchor"]),"text-anchor":new Pt(Rt.layout_symbol["text-anchor"]),"text-max-angle":new yt(Rt.layout_symbol["text-max-angle"]),"text-writing-mode":new yt(Rt.layout_symbol["text-writing-mode"]),"text-rotate":new Pt(Rt.layout_symbol["text-rotate"]),"text-padding":new yt(Rt.layout_symbol["text-padding"]),"text-keep-upright":new yt(Rt.layout_symbol["text-keep-upright"]),"text-transform":new Pt(Rt.layout_symbol["text-transform"]),"text-offset":new Pt(Rt.layout_symbol["text-offset"]),"text-allow-overlap":new yt(Rt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new yt(Rt.layout_symbol["text-ignore-placement"]),"text-optional":new yt(Rt.layout_symbol["text-optional"])});var hg={paint:new hn({"icon-opacity":new Pt(Rt.paint_symbol["icon-opacity"]),"icon-color":new Pt(Rt.paint_symbol["icon-color"]),"icon-halo-color":new Pt(Rt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Pt(Rt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Pt(Rt.paint_symbol["icon-halo-blur"]),"icon-translate":new yt(Rt.paint_symbol["icon-translate"]),"icon-translate-anchor":new yt(Rt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Pt(Rt.paint_symbol["text-opacity"]),"text-color":new Pt(Rt.paint_symbol["text-color"],{runtimeType:Ms,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new Pt(Rt.paint_symbol["text-halo-color"]),"text-halo-width":new Pt(Rt.paint_symbol["text-halo-width"]),"text-halo-blur":new Pt(Rt.paint_symbol["text-halo-blur"]),"text-translate":new yt(Rt.paint_symbol["text-translate"]),"text-translate-anchor":new yt(Rt.paint_symbol["text-translate-anchor"])}),layout:rm};class I_{constructor(s){this.type=s.property.overrides?s.property.overrides.runtimeType:xo,this.defaultValue=s}evaluate(s){if(s.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(s.formattedSection))return c.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Rn(I_,"FormatSectionOverride",{omit:["defaultValue"]});class D_ extends eh{constructor(s){super(s,hg)}recalculate(s,c){super.recalculate(s,c),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const f=this.layout.get("text-writing-mode");if(f){const v=[];for(const C of f)v.indexOf(C)<0&&v.push(C);this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(s,c,f,v){const C=this.layout.get(s).evaluate(c,{},f,v),S=this._unevaluatedLayout._values[s];return S.isDataDriven()||Ta(S.value)||!C?C:(R=c.properties,C.replace(/{([^{}]+)}/g,(U,W)=>W in R?String(R[W]):""));var R}createBucket(s){return new sf(s)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const s of hg.paint.overridableProperties){if(!D_.hasPaintOverride(this.layout,s))continue;const c=this.paint.get(s),f=new I_(c),v=new wh(f,c.property.specification);let C=null;C="constant"===c.value.kind||"source"===c.value.kind?new Eo("source",v):new El("composite",v,c.value.zoomStops,c.value._interpolationType),this.paint._values[s]=new sn(c.property,C,c.parameters)}}_handleOverridablePaintPropertyUpdate(s,c,f){return!(!this.layout||c.isDataDriven()||f.isDataDriven())&&D_.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,c){const f=s.get("text-field"),v=hg.paint.properties[c];let C=!1;const S=R=>{for(const N of R)if(v.overrides&&v.overrides.hasOverride(N))return void(C=!0)};if("constant"===f.value.kind&&f.value.value instanceof uo)S(f.value.value.sections);else if("source"===f.value.kind){const R=U=>{C||(U instanceof Ca&&fr(U.value)===pl?S(U.value.sections):U instanceof fh?S(U.sections):U.eachChild(R))},N=f.value;N._styleExpression&&R(N._styleExpression.expression)}return C}getProgramConfiguration(s){return new gd(this,s)}}var A_={paint:new hn({"background-color":new yt(Rt.paint_background["background-color"]),"background-pattern":new yt(Rt.paint_background["background-pattern"]),"background-opacity":new yt(Rt.paint_background["background-opacity"])})},mc={paint:new hn({"raster-opacity":new yt(Rt.paint_raster["raster-opacity"]),"raster-hue-rotate":new yt(Rt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new yt(Rt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new yt(Rt.paint_raster["raster-brightness-max"]),"raster-saturation":new yt(Rt.paint_raster["raster-saturation"]),"raster-contrast":new yt(Rt.paint_raster["raster-contrast"]),"raster-resampling":new yt(Rt.paint_raster["raster-resampling"]),"raster-fade-duration":new yt(Rt.paint_raster["raster-fade-duration"])})};class af extends eh{constructor(s){super(s,{}),this.implementation=s}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(s){this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)}onRemove(s){this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)}}var Px={paint:new hn({"sky-type":new yt(Rt.paint_sky["sky-type"]),"sky-atmosphere-sun":new yt(Rt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new yt(Rt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new yt(Rt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new yt(Rt.paint_sky["sky-gradient-radius"]),"sky-gradient":new tn(Rt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new yt(Rt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new yt(Rt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new yt(Rt.paint_sky["sky-opacity"])})};function M_(l,s,c){const f=[0,0,1],v=np([]);return Am(v,v,c?-it(l)+Math.PI:it(l)),$p(v,v,-it(s)),Nw(f,f,v),Va(f,f)}const tb={circle:class extends eh{constructor(l){super(l,Zw)}createBucket(l){return new r_(l)}queryRadius(l){const s=l;return Hm("circle-radius",this,s)+Hm("circle-stroke-width",this,s)+Zp(this.paint.get("circle-translate"))}queryIntersectsFeature(l,s,c,f,v,C,S,R){const N=O0(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),C.angle,l.pixelToTileUnitsFactor),U=this.paint.get("circle-radius").evaluate(s,c)+this.paint.get("circle-stroke-width").evaluate(s,c);return qw(l,f,C,S,R,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),N,U)}getProgramIds(){return["circle"]}getProgramConfiguration(l){return new gd(this,l)}},heatmap:class extends eh{createBucket(l){return new Vf(l)}constructor(l){super(l,L0),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){"heatmap-color"===l&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Cd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(l){return Hm("heatmap-radius",this,l)}queryIntersectsFeature(l,s,c,f,v,C,S,R){const N=this.paint.get("heatmap-radius").evaluate(s,c);return qw(l,f,C,S,R,!0,!0,new st(0,0),N)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(l){return new gd(this,l)}},hillshade:class extends eh{constructor(l){super(l,F0)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends eh{constructor(l){super(l,Ph)}getProgramIds(){const l=this.paint.get("fill-pattern"),s=l&&l.constantOr(1),c=[s?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&c.push(s&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),c}getProgramConfiguration(l){return new gd(this,l)}recalculate(l,s){super.recalculate(l,s);const c=this.paint._values["fill-outline-color"];"constant"===c.value.kind&&void 0===c.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new c_(l)}queryRadius(){return Zp(this.paint.get("fill-translate"))}queryIntersectsFeature(l,s,c,f,v,C){return!l.queryGeometry.isAboveHorizon&&Um(P0(l.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),C.angle,l.pixelToTileUnitsFactor),f)}isTileClipped(){return!0}},"fill-extrusion":class extends eh{constructor(l){super(l,EE)}createBucket(l){return new qm(l)}queryRadius(){return Zp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(l){return new gd(this,l)}queryIntersectsFeature(l,s,c,f,v,C,S,R,N){const U=O0(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),C.angle,l.pixelToTileUnitsFactor),W=this.paint.get("fill-extrusion-height").evaluate(s,c),Q=this.paint.get("fill-extrusion-base").evaluate(s,c),ee=[0,0],oe=R&&C.elevation,le=C.elevation?C.elevation.exaggeration():1,he=l.tile.getBucket(this);if(oe&&he instanceof qm){const He=he.centroidVertexArray,Be=N+1;Be<He.length&&(ee[0]=He.geta_centroid_pos0(Be),ee[1]=He.geta_centroid_pos1(Be))}if(0===ee[0]&&1===ee[1])return!1;"globe"===C.projection.name&&(f=dx([f],[new st(0,0),new st(Ci,Ci)],l.tileID.canonical).map(He=>He.polygon).flat());const Ie=oe?R:null,[Le,ve]=(Be=f,$e=Q,kt=W,St=U,Gt=S,Qt=Ie,Ft=ee,Kt=le,Xt=C.center.lat,"globe"===(He=C).projection.name?function(pn,Bt,In,mi,Pn,Kn,Mn,Yn,Xi,nr,Yi){const _i=[],Nr=[],Ri=pn.projection.upVectorScale(Yi,pn.center.lat,pn.worldSize).metersToTile,ar=[0,0,0,1],io=[0,0,0,1],So=(Io,ro,os,Qs)=>{Io[0]=ro,Io[1]=os,Io[2]=Qs,Io[3]=1},vo=hx();In>0&&(In+=vo),mi+=vo;for(const Io of Bt){const ro=[],os=[];for(const Qs of Io){const zr=Qs.x+Pn.x,Vs=Qs.y+Pn.y,Ts=pn.projection.projectTilePoint(zr,Vs,Yi),Er=pn.projection.upVector(Yi,Qs.x,Qs.y);let Wo=In,Us=mi;if(Mn){const Br=j0(zr,Vs,In,mi,Mn,Yn,Xi,nr);Wo+=Br.base,Us+=Br.top}0!==In?So(ar,Ts.x+Er[0]*Ri*Wo,Ts.y+Er[1]*Ri*Wo,Ts.z+Er[2]*Ri*Wo):So(ar,Ts.x,Ts.y,Ts.z),So(io,Ts.x+Er[0]*Ri*Us,Ts.y+Er[1]*Ri*Us,Ts.z+Er[2]*Ri*Us),ds(ar,ar,Kn),ds(io,io,Kn),ro.push(new Km(ar[0],ar[1],ar[2])),os.push(new Km(io[0],io[1],io[2]))}_i.push(ro),Nr.push(os)}return[_i,Nr]}(He,Be,$e,kt,St,Gt,Qt,Ft,Kt,Xt,l.tileID.canonical):Qt?function(pn,Bt,In,mi,Pn,Kn,Mn,Yn,Xi){const nr=[],Yi=[],_i=[0,0,0,1];for(const Nr of pn){const Ri=[],ar=[];for(const io of Nr){const So=io.x+mi.x,vo=io.y+mi.y,Io=j0(So,vo,Bt,In,Kn,Mn,Yn,Xi);_i[0]=So,_i[1]=vo,_i[2]=Io.base,_i[3]=1,Ff(_i,_i,Pn),_i[3]=Math.max(_i[3],1e-5);const ro=new Km(_i[0]/_i[3],_i[1]/_i[3],_i[2]/_i[3]);_i[0]=So,_i[1]=vo,_i[2]=Io.top,_i[3]=1,Ff(_i,_i,Pn),_i[3]=Math.max(_i[3],1e-5);const os=new Km(_i[0]/_i[3],_i[1]/_i[3],_i[2]/_i[3]);Ri.push(ro),ar.push(os)}nr.push(Ri),Yi.push(ar)}return[nr,Yi]}(Be,$e,kt,St,Gt,Qt,Ft,Kt,Xt):function(pn,Bt,In,mi,Pn){const Kn=[],Mn=[],Yn=Pn[8]*Bt,Xi=Pn[9]*Bt,nr=Pn[10]*Bt,Yi=Pn[11]*Bt,_i=Pn[8]*In,Nr=Pn[9]*In,Ri=Pn[10]*In,ar=Pn[11]*In;for(const io of pn){const So=[],vo=[];for(const Io of io){const ro=Io.x+mi.x,os=Io.y+mi.y,Qs=Pn[0]*ro+Pn[4]*os+Pn[12],zr=Pn[1]*ro+Pn[5]*os+Pn[13],Vs=Pn[2]*ro+Pn[6]*os+Pn[14],Ts=Pn[3]*ro+Pn[7]*os+Pn[15],Er=Qs+Yn,Wo=zr+Xi,Us=Vs+nr,Br=Math.max(Ts+Yi,1e-5),ss=Qs+_i,va=zr+Nr,ca=Vs+Ri,Ss=Math.max(Ts+ar,1e-5);So.push(new Km(Er/Br,Wo/Br,Us/Br)),vo.push(new Km(ss/Ss,va/Ss,ca/Ss))}Kn.push(So),Mn.push(vo)}return[Kn,Mn]}(Be,$e,kt,St,Gt)),Pe=l.queryGeometry;var He,Be,$e,kt,St,Gt,Qt,Ft,Kt,Xt;return function(He,Be,$e){let kt=1/0;Um($e,Be)&&(kt=jf($e,Be[0]));for(let St=0;St<Be.length;St++){const Gt=Be[St],Qt=He[St];for(let Ft=0;Ft<Gt.length-1;Ft++){const Kt=Gt[Ft],Xt=[Kt,Gt[Ft+1],Qt[Ft+1],Qt[Ft],Kt];I0($e,Xt)&&(kt=Math.min(kt,jf($e,Xt)))}}return kt!==1/0&&kt}(Le,ve,Pe.isPointQuery()?Pe.screenBounds:Pe.screenGeometry)}},line:class extends eh{constructor(l){super(l,Jm),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(l){if("line-gradient"===l){const s=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=s._styleExpression&&s._styleExpression.expression instanceof $d,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(l,s){super.recalculate(l,s),this.paint._values["line-floorwidth"]=Wf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new Gf(l)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(l){return new gd(this,l)}queryRadius(l){const s=l,c=pc(Hm("line-width",this,s),Hm("line-gap-width",this,s)),f=Hm("line-offset",this,s);return c/2+Math.abs(f)+Zp(this.paint.get("line-translate"))}queryIntersectsFeature(l,s,c,f,v,C){if(l.queryGeometry.isAboveHorizon)return!1;const S=P0(l.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),C.angle,l.pixelToTileUnitsFactor),R=l.pixelToTileUnitsFactor/2*pc(this.paint.get("line-width").evaluate(s,c),this.paint.get("line-gap-width").evaluate(s,c)),N=this.paint.get("line-offset").evaluate(s,c);return N&&(f=function(U,W){const Q=[],ee=new st(0,0);for(let oe=0;oe<U.length;oe++){const le=U[oe],he=[];for(let Ie=0;Ie<le.length;Ie++){const ve=le[Ie],Pe=le[Ie+1],He=0===Ie?ee:ve.sub(le[Ie-1])._unit()._perp(),Be=Ie===le.length-1?ee:Pe.sub(ve)._unit()._perp(),$e=He._add(Be)._unit();$e._mult(1/($e.x*Be.x+$e.y*Be.y)),he.push($e._mult(W)._add(ve))}Q.push(he)}return Q}(f,N*l.pixelToTileUnitsFactor)),function(U,W,Q){for(let ee=0;ee<W.length;ee++){const oe=W[ee];if(U.length>=3)for(let le=0;le<oe.length;le++)if($c(U,oe[le]))return!0;if(Bf(U,oe,Q))return!0}return!1}(S,f,R)}isTileClipped(){return!0}},symbol:D_,background:class extends eh{constructor(l){super(l,A_)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends eh{constructor(l){super(l,mc)}getProgramIds(){return["raster"]}},sky:class extends eh{constructor(l){super(l,Px),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){"sky-gradient"===l?this._updateColorRamp():"sky-atmosphere-sun"!==l&&"sky-atmosphere-halo-color"!==l&&"sky-atmosphere-color"!==l&&"sky-atmosphere-sun-intensity"!==l||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Cd({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(l){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const s=l.style.light.properties.get("position");return this._lightPosition.azimuthal!==s.azimuthal||this._lightPosition.polar!==s.polar}return!1}getCenter(l,s){if("atmosphere"===this.paint.get("sky-type")){const f=this.paint.get("sky-atmosphere-sun"),v=!f,C=l.style.light,S=C.properties.get("position");return v&&"viewport"===C.properties.get("anchor")&&Ar("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),v?M_(S.azimuthal,90-S.polar,s):M_(f[0],90-f[1],s)}const c=this.paint.get("sky-gradient-center");return M_(c[0],90-c[1],s)}is3D(){return!1}isSky(){return!0}markSkyboxValid(l){this._skyboxInvalidated=!1,this._lightPosition=l.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const l=this.paint.get("sky-type");return"atmosphere"===l?["skyboxCapture","skybox"]:"gradient"===l?["skyboxGradient"]:null}}};class dg{constructor(s,c,f,v){this.context=s,this.format=f,this.texture=s.gl.createTexture(),this.update(c,v)}update(s,c,f){const{width:v,height:C}=s,{context:S}=this,{gl:R}=S,{HTMLImageElement:N,HTMLCanvasElement:U,HTMLVideoElement:W,ImageData:Q,ImageBitmap:ee}=ze;if(R.bindTexture(R.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===R.RGBA&&(!c||!1!==c.premultiply)),f||this.size&&this.size[0]===v&&this.size[1]===C){const{x:oe,y:le}=f||{x:0,y:0};s instanceof N||s instanceof U||s instanceof W||s instanceof Q||ee&&s instanceof ee?R.texSubImage2D(R.TEXTURE_2D,0,oe,le,R.RGBA,R.UNSIGNED_BYTE,s):R.texSubImage2D(R.TEXTURE_2D,0,oe,le,v,C,R.RGBA,R.UNSIGNED_BYTE,s.data)}else this.size=[v,C],s instanceof N||s instanceof U||s instanceof W||s instanceof Q||ee&&s instanceof ee?R.texImage2D(R.TEXTURE_2D,0,this.format,this.format,R.UNSIGNED_BYTE,s):R.texImage2D(R.TEXTURE_2D,0,this.format,v,C,0,this.format,R.UNSIGNED_BYTE,s.data);this.useMipmap=Boolean(c&&c.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&R.generateMipmap(R.TEXTURE_2D)}bind(s,c){const{context:f}=this,{gl:v}=f;v.bindTexture(v.TEXTURE_2D,this.texture),s!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,s),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,this.useMipmap?s===v.NEAREST?v.NEAREST_MIPMAP_NEAREST:v.LINEAR_MIPMAP_NEAREST:s),this.filter=s),c!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,c),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}class Yy{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class k_{constructor(){this.tasks={},this.taskQueue=[],$i(["process"],this),this.invoker=new Yy(this.process),this.nextId=0}add(s,c){const f=this.nextId++,v=function({type:C,isSymbolTile:S,zoom:R}){return R=R||0,"message"===C?0:"maybePrepare"!==C||S?"parseTile"!==C||S?"parseTile"===C&&S?300-R:"maybePrepare"===C&&S?400-R:500:200-R:100-R}(c);if(0===v){Rr();try{s()}finally{}return{cancel:()=>{}}}return this.tasks[f]={fn:s,metadata:c,priority:v,id:f},this.taskQueue.push(f),this.invoker.trigger(),{cancel:()=>{delete this.tasks[f]}}}process(){Rr();try{if(this.taskQueue=this.taskQueue.filter(f=>!!this.tasks[f]),!this.taskQueue.length)return;const s=this.pick();if(null===s)return;const c=this.tasks[s];if(delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),!c)return;c.fn()}finally{}}pick(){let s=null,c=1/0;for(let v=0;v<this.taskQueue.length;v++){const C=this.tasks[this.taskQueue[v]];C.priority<c&&(c=C.priority,s=v)}if(null===s)return null;const f=this.taskQueue[s];return this.taskQueue.splice(s,1),f}remove(){this.invoker.remove()}}class Ox{constructor(s){this._stringToNumber={},this._numberToString=[];for(let c=0;c<s.length;c++){const f=s[c];this._stringToNumber[f]=c,this._numberToString[c]=f}}encode(s){return this._stringToNumber[s]}decode(s){return this._numberToString[s]}}const Lx=["tile","layer","source","sourceLayer","state"];class R_{constructor(s,c,f,v,C){this.type="Feature",this._vectorTileFeature=s,this._z=c,this._x=f,this._y=v,this.properties=s.properties,this.id=C}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(s.id=this.id);for(const c of Lx)void 0!==this[c]&&(s[c]=this[c]);return s}}const lf=new Uint16Array(8184);for(let l=0;l<2046;l++){let s=l+2,c=0,f=0,v=0,C=0,S=0,R=0;for(1&s?v=C=S=32:c=f=R=32;(s>>=1)>1;){const U=c+v>>1,W=f+C>>1;1&s?(v=c,C=f,c=S,f=R):(c=v,f=C,v=S,C=R),S=U,R=W}const N=4*l;lf[N+0]=c,lf[N+1]=f,lf[N+2]=v,lf[N+3]=C}const zh=new Uint16Array(2178),dp=new Uint8Array(1089),pg=new Uint16Array(1089);function P_(l){return 0===l?-.03125:32===l?.03125:0}var fg=Jn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Jy={type:2,extent:Ci,loadGeometry:()=>[[new st(0,0),new st(8193,0),new st(8193,8193),new st(0,8193),new st(0,0)]]};class Qy{constructor(s,c,f,v,C){this.tileID=s,this.uid=zi(),this.uses=0,this.tileSize=c,this.tileZoom=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=C,this.expiredRequestCount=0,this.state="loading",v&&v.transform&&(this.projection=v.transform.projection)}registerFadeDuration(s){const c=s+this.timeAdded;c<ur.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Bs(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,c,f){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(v,C){const S={};if(!C)return S;for(const R of v){const N=R.layerIds.map(U=>C.getLayer(U)).filter(Boolean);if(0!==N.length){R.layers=N,R.stateDependentLayerIds&&(R.stateDependentLayers=R.stateDependentLayerIds.map(U=>N.filter(W=>W.id===U)[0]));for(const U of N)S[U.id]=R}}return S}(s.buckets,c.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const C=this.buckets[v];if(C instanceof sf){if(this.hasSymbolBuckets=!0,!f)break;C.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const C=this.buckets[v];if(C instanceof sf&&C.hasRTLText){this.hasRTLText=!0,Xe.isLoading()||Xe.isLoaded()||"deferred"!==Ye()||We();break}}this.queryPadding=0;for(const v in this.buckets){const C=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(v).queryRadius(C))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas)}else this.collisionBoxArray=new ya}unloadVectorData(){if(this.hasData()){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(s){return this.buckets[s.id]}upload(s){for(const f in this.buckets){const v=this.buckets[f];v.uploadPending()&&v.upload(s)}const c=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new dg(s,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new dg(s,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new dg(s,this.lineAtlas.image,c.ALPHA),this.lineAtlas.uploaded=!0)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,c,f,v,C,S,R,N){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:v,pixelPosMatrix:R,transform:S,params:C,tileTransform:this.tileTransform},s,c,f):{}}querySourceFeatures(s,c){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const v=f.loadVTLayers(),C=c?c.sourceLayer:"",S=v._geojsonTileLayer||v[C];if(!S)return;const R=La(c&&c.filter),{z:N,x:U,y:W}=this.tileID.canonical,Q={z:N,x:U,y:W};for(let ee=0;ee<S.length;ee++){const oe=S.feature(ee);if(R.needGeometry){const Ie=wu(oe,!0);if(!R.filter(new ut(this.tileID.overscaledZ),Ie,this.tileID.canonical))continue}else if(!R.filter(new ut(this.tileID.overscaledZ),oe))continue;const le=f.getId(oe,C),he=new R_(oe,N,U,W,le);he.tile=Q,s.push(he)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const c=this.expirationTime;if(s.cacheControl){const f=Xo(s.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const f=Date.now();let v=!1;if(this.expirationTime>f)v=!1;else if(c)if(this.expirationTime<c)v=!0;else{const C=this.expirationTime-c;C?this.expirationTime=f+Math.max(C,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(s,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(s).length||!c)return;const f=this.latestFeatureIndex.loadVTLayers(),v=c.style.listImages();for(const C in this.buckets){if(!c.style.hasLayer(C))continue;const S=this.buckets[C],R=S.layers[0].sourceLayer||"_geojsonTileLayer",N=f[R],U=s[R];if(!N||!U||0===Object.keys(U).length)continue;if(S.update(U,N,v,this.imageAtlas&&this.imageAtlas.patternPositions||{}),S instanceof Gf||S instanceof c_){const Q=c.style._getSourceCache(S.layers[0].source);c._terrain&&c._terrain.enabled&&Q&&S.programConfigurations.needsUpload&&c._terrain._clearRenderCacheForTile(Q.id,this.tileID)}const W=c&&c.style&&c.style.getLayer(C);W&&(this.queryPadding=Math.max(this.queryPadding,W.queryRadius(S)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ur.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=ur.now()+s}setTexture(s,c){const f=c.context,v=f.gl;this.texture=this.texture||c.getTileTexture(s.width),this.texture?this.texture.update(s,{useMipmap:!0}):(this.texture=new dg(f,s,v.RGBA,{useMipmap:!0}),this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE))}setDependencies(s,c){const f={};for(const v of c)f[v]=!0;this.dependencies[s]=f}hasDependency(s,c){for(const f of s){const v=this.dependencies[f];if(v)for(const C of c)if(v[C])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,c){if(!c||"mercator"===c.name||this._tileDebugBuffer)return;const f=xd(Jy,this.tileID.canonical,this.tileTransform)[0],v=new hi,C=new sc;for(let S=0;S<f.length;S++){const{x:R,y:N}=f[S];v.emplaceBack(R,N),C.emplaceBack(S)}C.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(C),this._tileDebugBuffer=s.createVertexBuffer(v,gy.members),this._tileDebugSegments=Cs.simpleSegment(0,0,v.length,C.length)}_makeTileBoundsBuffers(s,c){if(this._tileBoundsBuffer||!c||"mercator"===c.name)return;const f=xd(Jy,this.tileID.canonical,this.tileTransform)[0];let v,C;if(this.isRaster){const S=function(R,N){const U=Bs(R,N),W=Math.pow(2,R.z);for(let Ie=0;Ie<33;Ie++)for(let Le=0;Le<33;Le++){const ve=uc((R.x+(Le+P_(Le))/32)/W),Pe=Ua((R.y+(Ie+P_(Ie))/32)/W),He=N.project(ve,Pe),Be=33*Ie+Le;zh[2*Be+0]=Math.round((He.x*U.scale-U.x)*Ci),zh[2*Be+1]=Math.round((He.y*U.scale-U.y)*Ci)}dp.fill(0),pg.fill(0);for(let Ie=2045;Ie>=0;Ie--){const Le=4*Ie,ve=lf[Le+0],Pe=lf[Le+1],He=lf[Le+2],Be=lf[Le+3],$e=ve+He>>1,kt=Pe+Be>>1,St=$e+kt-Pe,Gt=kt+ve-$e,Qt=33*Pe+ve,Ft=33*Be+He,Kt=33*kt+$e,Xt=Math.hypot((zh[2*Qt+0]+zh[2*Ft+0])/2-zh[2*Kt+0],(zh[2*Qt+1]+zh[2*Ft+1])/2-zh[2*Kt+1])>=16;dp[Kt]=dp[Kt]||(Xt?1:0),Ie<1022&&(dp[Kt]=dp[Kt]||dp[33*(Pe+Gt>>1)+(ve+St>>1)]||dp[33*(Be+Gt>>1)+(He+St>>1)])}const Q=new Hr,ee=new Ns;let oe=0;function le(Ie,Le){const ve=33*Le+Ie;return 0===pg[ve]&&(Q.emplaceBack(zh[2*ve+0],zh[2*ve+1],Ie*Ci/32,Le*Ci/32),pg[ve]=++oe),pg[ve]-1}function he(Ie,Le,ve,Pe,He,Be){const $e=Ie+ve>>1,kt=Le+Pe>>1;if(Math.abs(Ie-He)+Math.abs(Le-Be)>1&&dp[33*kt+$e])he(He,Be,Ie,Le,$e,kt),he(ve,Pe,He,Be,$e,kt);else{const St=le(Ie,Le),Gt=le(ve,Pe),Qt=le(He,Be);ee.emplaceBack(St,Gt,Qt)}}return he(0,0,32,32,32,0),he(32,32,0,0,0,32),{vertices:Q,indices:ee}}(this.tileID.canonical,c);v=S.vertices,C=S.indices}else{v=new Hr,C=new Ns;for(const{x:R,y:N}of f)v.emplaceBack(R,N,0,0);const S=rp(v.int16,void 0,4);for(let R=0;R<S.length;R+=3)C.emplaceBack(S[R],S[R+1],S[R+2])}this._tileBoundsBuffer=s.createVertexBuffer(v,fg.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(C),this._tileBoundsSegments=Cs.simpleSegment(0,0,v.length,C.length)}_makeGlobeTileDebugBuffers(s,c){const f=c.projection;if(!f||"globe"!==f.name||c.freezeTileCoverage)return;const v=this.tileID.canonical,C=Om(yy(v,c)),S=Lm(c.zoom);let R;S>0&&(R=Zg(new Float64Array(16),c.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,v,c,C,R,S),this._makeGlobeTileDebugTextBuffer(s,v,c,C,R,S)}_globePoint(s,c,f,v,C,S,R){let N=Pm(s,c,f);if(S){const U=1<<f.z,W=kh(v.center.lng),Q=cc(v.center.lat),ee=(f.x+.5)/U-W;let oe=0;ee>.5?oe=-1:ee<-.5&&(oe=1);let le=(s/Ci+f.x)/U+oe,he=(c/Ci+f.y)/U;le=(le-W)*v._pixelsPerMercatorPixel+W,he=(he-Q)*v._pixelsPerMercatorPixel+Q;const Ie=[le*v.worldSize,he*v.worldSize,0];ds(Ie,Ie,S),N=nh(N,Ie,R)}return ds(N,N,C)}_makeGlobeTileDebugBorderBuffer(s,c,f,v,C,S){const R=new hi,N=new sc,U=new Lr,W=(ee,oe,le,he,Ie)=>{const Le=(le-ee)/(Ie-1),ve=(he-oe)/(Ie-1),Pe=R.length;for(let He=0;He<Ie;He++){const Be=ee+He*Le,$e=oe+He*ve;R.emplaceBack(Be,$e);const kt=this._globePoint(Be,$e,c,f,v,C,S);U.emplaceBack(kt[0],kt[1],kt[2]),N.emplaceBack(Pe+He)}},Q=Ci;W(0,0,Q,0,16),W(Q,0,Q,Q,16),W(Q,Q,0,Q,16),W(0,Q,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(N),this._tileDebugBuffer=s.createVertexBuffer(R,gy.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(U,_0.members),this._tileDebugSegments=Cs.simpleSegment(0,0,R.length,N.length)}_makeGlobeTileDebugTextBuffer(s,c,f,v,C,S){const R=new hi,N=new Ns,U=new Lr,W=25;N.reserve(32),R.reserve(W),U.reserve(W);const Q=(ee,oe)=>W*ee+oe;for(let ee=0;ee<W;ee++){const oe=2048*ee;for(let le=0;le<W;le++){const he=2048*le;R.emplaceBack(he,oe);const Ie=this._globePoint(he,oe,c,f,v,C,S);U.emplaceBack(Ie[0],Ie[1],Ie[2])}}for(let ee=0;ee<4;ee++)for(let oe=0;oe<4;oe++){const le=Q(ee,oe),he=Q(ee,oe+1),Ie=Q(ee+1,oe),Le=Q(ee+1,oe+1);N.emplaceBack(le,he,Ie),N.emplaceBack(Ie,he,Le)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(N),this._tileDebugTextBuffer=s.createVertexBuffer(R,gy.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(U,_0.members),this._tileDebugTextSegments=Cs.simpleSegment(0,0,W,32)}}class nb{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,c,f){const v=String(c);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][v]=this.stateChanges[s][v]||{},Ni(this.stateChanges[s][v],f),null===this.deletedStates[s]){this.deletedStates[s]={};for(const C in this.state[s])C!==v&&(this.deletedStates[s][C]=null)}else if(this.deletedStates[s]&&null===this.deletedStates[s][v]){this.deletedStates[s][v]={};for(const C in this.state[s][v])f[C]||(this.deletedStates[s][v][C]=null)}else for(const C in f)this.deletedStates[s]&&this.deletedStates[s][v]&&null===this.deletedStates[s][v][C]&&delete this.deletedStates[s][v][C]}removeFeatureState(s,c,f){if(null===this.deletedStates[s])return;const v=String(c);if(this.deletedStates[s]=this.deletedStates[s]||{},f&&void 0!==c)null!==this.deletedStates[s][v]&&(this.deletedStates[s][v]=this.deletedStates[s][v]||{},this.deletedStates[s][v][f]=null);else if(void 0!==c)if(this.stateChanges[s]&&this.stateChanges[s][v])for(f in this.deletedStates[s][v]={},this.stateChanges[s][v])this.deletedStates[s][v][f]=null;else this.deletedStates[s][v]=null;else this.deletedStates[s]=null}getState(s,c){const f=String(c),v=Ni({},(this.state[s]||{})[f],(this.stateChanges[s]||{})[f]);if(null===this.deletedStates[s])return{};if(this.deletedStates[s]){const C=this.deletedStates[s][c];if(null===C)return{};for(const S in C)delete v[S]}return v}initializeTileState(s,c){s.setFeatureState(this.state,c)}coalesceChanges(s,c){const f={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const C={};for(const S in this.stateChanges[v])this.state[v][S]||(this.state[v][S]={}),Ni(this.state[v][S],this.stateChanges[v][S]),C[S]=this.state[v][S];f[v]=C}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const C={};if(null===this.deletedStates[v])for(const S in this.state[v])C[S]={},this.state[v][S]={};else for(const S in this.deletedStates[v]){if(null===this.deletedStates[v][S])this.state[v][S]={};else if(this.state[v][S])for(const R of Object.keys(this.deletedStates[v][S]))delete this.state[v][S][R];C[S]=this.state[v][S]}f[v]=f[v]||{},Ni(f[v],C)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(f).length)for(const v in s)s[v].setFeatureState(f,c)}}class ib{constructor(s){this.size=s,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(s,c){const f=this.toIdx(s,c);return{min:this.minimums[f],max:this.maximums[f]}}isLeaf(s,c){return this.leaves[this.toIdx(s,c)]}toIdx(s,c){return c*this.size+s}}function rb(l,s,c,f){let v=0,C=Number.MAX_VALUE;for(let S=0;S<3;S++)if(Math.abs(f[S])<1e-15){if(c[S]<l[S]||c[S]>s[S])return null}else{const R=1/f[S];let N=(l[S]-c[S])*R,U=(s[S]-c[S])*R;if(N>U){const W=N;N=U,U=W}if(N>v&&(v=N),U<C&&(C=U),v>C)return null}return v}function ob(l,s,c,f,v,C,S,R,N,U,W){const Q=f-l,ee=v-s,oe=C-c,le=S-l,he=R-s,Ie=N-c,Le=W[1]*Ie-W[2]*he,ve=W[2]*le-W[0]*Ie,Pe=W[0]*he-W[1]*le,He=Q*Le+ee*ve+oe*Pe;if(Math.abs(He)<1e-15)return null;const Be=1/He,$e=U[0]-l,kt=U[1]-s,St=U[2]-c,Gt=($e*Le+kt*ve+St*Pe)*Be;if(Gt<0||Gt>1)return null;const Qt=kt*oe-St*ee,Ft=St*Q-$e*oe,Kt=$e*ee-kt*Q,Xt=(W[0]*Qt+W[1]*Ft+W[2]*Kt)*Be;return Xt<0||Gt+Xt>1?null:(le*Qt+he*Ft+Ie*Kt)*Be}function sb(l,s,c){return(l-s)/(c-s)}function O_(l,s,c,f,v,C,S,R,N){const U=1<<c,W=C-f,Q=S-v,ee=(l+1)/U*W+f,oe=(s+0)/U*Q+v,le=(s+1)/U*Q+v;R[0]=(l+0)/U*W+f,R[1]=oe,N[0]=ee,N[1]=le}class pp{constructor(s){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=s,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const c=function(C){const S=Math.ceil(Math.log2(C.dim/8)),R=[];let N=Math.ceil(Math.pow(2,S));const U=1/N,W=(oe,le,he,Ie,Le)=>{const ve=Ie?1:0,Pe=(oe+1)*he-ve,He=le*he,Be=(le+1)*he-ve;Le[0]=oe*he,Le[1]=He,Le[2]=Pe,Le[3]=Be};let Q=new ib(N);const ee=[];for(let oe=0;oe<N*N;oe++){W(oe%N,Math.floor(oe/N),U,!1,ee);const le=Pd(ee[0],ee[1],C),he=Pd(ee[2],ee[1],C),Ie=Pd(ee[2],ee[3],C),Le=Pd(ee[0],ee[3],C);Q.minimums.push(Math.min(le,he,Ie,Le)),Q.maximums.push(Math.max(le,he,Ie,Le)),Q.leaves.push(1)}for(R.push(Q),N/=2;N>=1;N/=2){const oe=R[R.length-1];Q=new ib(N);for(let le=0;le<N*N;le++){W(le%N,Math.floor(le/N),2,!0,ee);const he=oe.getElevation(ee[0],ee[1]),Ie=oe.getElevation(ee[2],ee[1]),Le=oe.getElevation(ee[2],ee[3]),ve=oe.getElevation(ee[0],ee[3]),Pe=oe.isLeaf(ee[0],ee[1]),He=oe.isLeaf(ee[2],ee[1]),Be=oe.isLeaf(ee[2],ee[3]),$e=oe.isLeaf(ee[0],ee[3]),kt=Math.min(he.min,Ie.min,Le.min,ve.min),St=Math.max(he.max,Ie.max,Le.max,ve.max),Gt=Pe&&He&&Be&&$e;Q.maximums.push(St),Q.minimums.push(kt),Q.leaves.push(St-kt<=5&&Gt?1:0)}R.push(Q)}return R}(this.dem),f=c.length-1,v=c[f];this._addNode(v.minimums[0],v.maximums[0],v.leaves[0]),this._construct(c,0,0,f,0)}raycastRoot(s,c,f,v,C,S,R=1){return rb([s,c,-100],[f,v,this.maximums[0]*R],C,S)}raycast(s,c,f,v,C,S,R=1){if(!this.nodeCount)return null;const N=this.raycastRoot(s,c,f,v,C,S,R);if(null==N)return null;const U=[],W=[],Q=[],ee=[],oe=[{idx:0,t:N,nodex:0,nodey:0,depth:0}];for(;oe.length>0;){const{idx:le,t:he,nodex:Ie,nodey:Le,depth:ve}=oe.pop();if(this.leaves[le]){O_(Ie,Le,ve,s,c,f,v,Q,ee);const He=1<<ve,Be=(Ie+0)/He,$e=(Ie+1)/He,kt=(Le+0)/He,St=(Le+1)/He,Gt=Pd(Be,kt,this.dem)*R,Qt=Pd($e,kt,this.dem)*R,Ft=Pd($e,St,this.dem)*R,Kt=Pd(Be,St,this.dem)*R,Xt=ob(Q[0],Q[1],Gt,ee[0],Q[1],Qt,ee[0],ee[1],Ft,C,S),un=ob(ee[0],ee[1],Ft,Q[0],ee[1],Kt,Q[0],Q[1],Gt,C,S),pn=Math.min(null!==Xt?Xt:Number.MAX_VALUE,null!==un?un:Number.MAX_VALUE);if(pn!==Number.MAX_VALUE)return pn;{const Bt=Lf([],C,S,he);if(ab(Gt,Qt,Kt,Ft,sb(Bt[0],Q[0],ee[0]),sb(Bt[1],Q[1],ee[1]))>=Bt[2])return he}continue}let Pe=0;for(let He=0;He<this._siblingOffset.length;He++){O_((Ie<<1)+this._siblingOffset[He][0],(Le<<1)+this._siblingOffset[He][1],ve+1,s,c,f,v,Q,ee),Q[2]=-100,ee[2]=this.maximums[this.childOffsets[le]+He]*R;const Be=rb(Q,ee,C,S);if(null!=Be){const $e=Be;U[He]=$e;let kt=!1;for(let St=0;St<Pe&&!kt;St++)$e>=U[W[St]]&&(W.splice(St,0,He),kt=!0);kt||(W[Pe]=He),Pe++}}for(let He=0;He<Pe;He++){const Be=W[He];oe.push({idx:this.childOffsets[le]+Be,t:U[Be],nodex:(Ie<<1)+this._siblingOffset[Be][0],nodey:(Le<<1)+this._siblingOffset[Be][1],depth:ve+1})}}return null}_addNode(s,c,f){return this.minimums.push(s),this.maximums.push(c),this.leaves.push(f),this.childOffsets.push(0),this.nodeCount++}_construct(s,c,f,v,C){if(1===s[v].isLeaf(c,f))return;this.childOffsets[C]||(this.childOffsets[C]=this.nodeCount);const S=v-1,R=s[S];let N=0,U=0;for(let W=0;W<this._siblingOffset.length;W++){const Q=2*c+this._siblingOffset[W][0],ee=2*f+this._siblingOffset[W][1],oe=R.getElevation(Q,ee),le=R.isLeaf(Q,ee),he=this._addNode(oe.min,oe.max,le);le&&(N|=1<<W),U||(U=he)}for(let W=0;W<this._siblingOffset.length;W++)N&1<<W||this._construct(s,2*c+this._siblingOffset[W][0],2*f+this._siblingOffset[W][1],S,U+W)}}function ab(l,s,c,f,v,C){return Oi(Oi(l,c,C),Oi(s,f,C),v)}function Pd(l,s,c){const f=c.dim,v=It(l*f-.5,0,f-1),C=It(s*f-.5,0,f-1),S=Math.floor(v),R=Math.floor(C),N=Math.min(S+1,f-1),U=Math.min(R+1,f-1);return ab(c.get(S,R),c.get(N,R),c.get(S,U),c.get(N,U),v-S,C-R)}const L_={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function om(l,s,c){return(256*l*256+256*s+c)/10-1e4}function Fx(l,s,c){return 256*l+s+c/256-32768}class lb{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(s,c,f,v=!1,C=!1){if(this.uid=s,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(f&&"mapbox"!==f&&"terrarium"!==f)return Ar(`"${f}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const S=this.dim=c.height-2,R=new Uint32Array(c.data.buffer);if(this.pixels=new Uint8Array(c.data.buffer),this.encoding=f||"mapbox",this.borderReady=v,!v){for(let N=0;N<S;N++)R[this._idx(-1,N)]=R[this._idx(0,N)],R[this._idx(S,N)]=R[this._idx(S-1,N)],R[this._idx(N,-1)]=R[this._idx(N,0)],R[this._idx(N,S)]=R[this._idx(N,S-1)];R[this._idx(-1,-1)]=R[this._idx(0,0)],R[this._idx(S,-1)]=R[this._idx(S-1,0)],R[this._idx(-1,S)]=R[this._idx(0,S-1)],R[this._idx(S,S)]=R[this._idx(S-1,S-1)],C&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new pp(this)}get(s,c,f=!1){f&&(s=It(s,-1,this.dim),c=It(c,-1,this.dim));const v=4*this._idx(s,c);return("terrarium"===this.encoding?Fx:om)(this.pixels[v],this.pixels[v+1],this.pixels[v+2])}static getUnpackVector(s){return L_[s]}get unpackVector(){return L_[this.encoding]}_idx(s,c){if(s<-1||s>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(s+1)}static pack(s,c){const f=[0,0,0,0],v=lb.getUnpackVector(c);let C=Math.floor((s+v[3])/v[2]);return f[2]=C%256,C=Math.floor(C/256),f[1]=C%256,C=Math.floor(C/256),f[0]=C,f}getPixels(){return new hc({width:this.stride,height:this.stride},this.pixels)}backfillBorder(s,c,f){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let v=c*this.dim,C=c*this.dim+this.dim,S=f*this.dim,R=f*this.dim+this.dim;switch(c){case-1:v=C-1;break;case 1:C=v+1}switch(f){case-1:S=R-1;break;case 1:R=S+1}const N=-c*this.dim,U=-f*this.dim;for(let W=S;W<R;W++)for(let Q=v;Q<C;Q++){const ee=4*this._idx(Q,W),oe=4*this._idx(Q+N,W+U);this.pixels[ee+0]=s.pixels[oe+0],this.pixels[ee+1]=s.pixels[oe+1],this.pixels[ee+2]=s.pixels[oe+2],this.pixels[ee+3]=s.pixels[oe+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Rn(lb,"DEMData"),Rn(pp,"DemMinMaxQuadTree",{omit:["dem"]});class Nx{constructor(s,c){this.max=s,this.onRemove=c,this.reset()}reset(){for(const s in this.data)for(const c of this.data[s])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(s,c,f){const v=s.wrapped().key;void 0===this.data[v]&&(this.data[v]=[]);const C={value:c,timeout:void 0};if(void 0!==f&&(C.timeout=setTimeout(()=>{this.remove(s,C)},f)),this.data[v].push(C),this.order.push(v),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const c=this.data[s].shift();return c.timeout&&clearTimeout(c.timeout),0===this.data[s].length&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),c.value}getByKey(s){const c=this.data[s];return c?c[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,c){if(!this.has(s))return this;const f=s.wrapped().key,v=void 0===c?0:this.data[f].indexOf(c),C=this.data[f][v];return this.data[f].splice(v,1),C.timeout&&clearTimeout(C.timeout),0===this.data[f].length&&delete this.data[f],this.onRemove(C.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(s){const c=[];for(const f in this.data)for(const v of this.data[f])s(v.value)||c.push(v);for(const f of c)this.remove(f.value.tileID,f)}}class Es{constructor(s,c,f){this.func=s,this.mask=c,this.range=f}}Es.ReadOnly=!1,Es.ReadWrite=!0,Es.disabled=new Es(519,Es.ReadOnly,[0,1]);class sm{constructor(s,c,f,v,C,S){this.test=s,this.ref=c,this.mask=f,this.fail=v,this.depthFail=C,this.pass=S}}sm.disabled=new sm({func:519,mask:0},0,0,7680,7680,7680);class Yo{constructor(s,c,f){this.blendFunction=s,this.blendColor=c,this.mask=f}}Yo.Replace=[1,0],Yo.disabled=new Yo(Yo.Replace,Qi.transparent,[!1,!1,!1,!1]),Yo.unblended=new Yo(Yo.Replace,Qi.transparent,[!0,!0,!0,!0]),Yo.alphaBlended=new Yo([1,771],Qi.transparent,[!0,!0,!0,!0]);class Fo{constructor(s,c,f){this.enable=s,this.mode=c,this.frontFace=f}}Fo.disabled=new Fo(!1,1029,2305),Fo.backCCW=new Fo(!0,1029,2305),Fo.backCW=new Fo(!0,1029,2304),Fo.frontCW=new Fo(!0,1028,2304),Fo.frontCCW=new Fo(!0,1028,2305);class fp extends mo{constructor(s,c,f){super(),this.id=s,this._onlySymbols=f,c.on("data",v=>{"source"===v.dataType&&"metadata"===v.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===v.dataType&&"content"===v.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),c.on("error",()=>{this._sourceErrored=!0}),this._source=c,this._tiles={},this._cache=new Nx(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new nb,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(s){this.map=s,this._minTileCacheSize=void 0===this._minTileCacheSize&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles){const c=this._tiles[s];if("loaded"!==c.state&&"errored"!==c.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,c){return s.isSymbolTile=this._onlySymbols,this._source.loadTile(s,c)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s,()=>{})}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s,()=>{})}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const f=this._tiles[c];f.upload(s),f.prepare(this.map.style.imageManager)}}getIds(){return ir(this._tiles).map(s=>s.tileID).sort(Bx).map(s=>s.key)}getRenderableIds(s){const c=[];for(const f in this._tiles)this._isIdRenderable(+f,s)&&c.push(this._tiles[f]);return s?c.sort((f,v)=>{const C=f.tileID,S=v.tileID,R=new st(C.canonical.x,C.canonical.y)._rotate(this.transform.angle),N=new st(S.canonical.x,S.canonical.y)._rotate(this.transform.angle);return C.overscaledZ-S.overscaledZ||N.y-R.y||N.x-R.x}).map(f=>f.tileID.key):c.map(f=>f.tileID).sort(Bx).map(f=>f.key)}hasRenderableParent(s){const c=this.findLoadedParent(s,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(s,c){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(c||!this._tiles[s].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)"errored"!==this._tiles[s].state&&this._reloadTile(+s,"reloading")}}_reloadTile(s,c){const f=this._tiles[s];f&&("loading"!==f.state&&(f.state=c),this._loadTile(f,this._tileLoaded.bind(this,f,s,c)))}_tileLoaded(s,c,f,v){if(v)if(s.state="errored",404!==v.status)this._source.fire(new Mr(v,{tile:s}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const C=this.map.painter.terrain;this.update(this.transform,C.getScaledDemTileSize(),!0),C.resetTileLookupCache(this.id)}else this.update(this.transform);else s.timeAdded=ur.now(),"expired"===f&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(c,s),"raster-dem"===this._source.type&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new ci("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){const c=this.getRenderableIds();for(let v=0;v<c.length;v++){const C=c[v];if(s.neighboringTiles&&s.neighboringTiles[C]){const S=this.getTileByID(C);f(s,S),f(S,s)}}function f(v,C){if(!v.dem||v.dem.borderReady)return;v.needsHillshadePrepare=!0,v.needsDEMTextureUpload=!0;let S=C.tileID.canonical.x-v.tileID.canonical.x;const R=C.tileID.canonical.y-v.tileID.canonical.y,N=Math.pow(2,v.tileID.canonical.z),U=C.tileID.key;0===S&&0===R||Math.abs(R)>1||(Math.abs(S)>1&&(1===Math.abs(S+N)?S+=N:1===Math.abs(S-N)&&(S-=N)),C.dem&&v.dem&&(v.dem.backfillBorder(C.dem,S,R),v.neighboringTiles&&v.neighboringTiles[U]&&(v.neighboringTiles[U].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,c,f,v){for(const C in this._tiles){let S=this._tiles[C];if(v[C]||!S.hasData()||S.tileID.overscaledZ<=c||S.tileID.overscaledZ>f)continue;let R=S.tileID;for(;S&&S.tileID.overscaledZ>c+1;){const U=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[U.key],S&&S.hasData()&&(R=U)}let N=R;for(;N.overscaledZ>c;)if(N=N.scaledTo(N.overscaledZ-1),s[N.key]){v[R.key]=R;break}}}findLoadedParent(s,c){if(s.key in this._loadedParentTiles){const f=this._loadedParentTiles[s.key];return f&&f.tileID.overscaledZ>=c?f:null}for(let f=s.overscaledZ-1;f>=c;f--){const v=s.scaledTo(f),C=this._getLoadedTile(v);if(C)return C}}_getLoadedTile(s){const c=this._tiles[s.key];return c&&c.hasData()?c:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,c){c=c||this._source.tileSize;const f=Math.ceil(s.width/c)+1,v=Math.ceil(s.height/c)+1,C=Math.floor(f*v*5),S="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,C):C,R="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,S):S;this._cache.setMaxSize(R)}handleWrapJump(s){const c=Math.round((s-(void 0===this._prevLng?s:this._prevLng))/360);if(this._prevLng=s,c){const f={};for(const v in this._tiles){const C=this._tiles[v];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+c),f[C.tileID.key]=C}this._tiles=f;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(+v,this._tiles[v])}}update(s,c,f){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!f)return;let v;this.updateCacheSize(s,c),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?v=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(R=>new dc(R.canonical.z,R.wrap,R.canonical.z,R.canonical.x,R.canonical.y)):(v=s.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!f,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(v=v.filter(R=>this._source.hasTile(R)))):v=[];const C=this._updateRetainedTiles(v);if(mg(this._source.type)&&0!==v.length){const R={},N={},U=Object.keys(C);for(const Q of U){const ee=C[Q],oe=this._tiles[Q];if(!oe||oe.fadeEndTime&&oe.fadeEndTime<=ur.now())continue;const le=this.findLoadedParent(ee,Math.max(ee.overscaledZ-fp.maxOverzooming,this._source.minzoom));le&&(this._addTile(le.tileID),R[le.tileID.key]=le.tileID),N[Q]=ee}const W=v[v.length-1].overscaledZ;for(const Q in this._tiles){const ee=this._tiles[Q];if(C[Q]||!ee.hasData())continue;let oe=ee.tileID;for(;oe.overscaledZ>W;){oe=oe.scaledTo(oe.overscaledZ-1);const le=this._tiles[oe.key];if(le&&le.hasData()&&N[oe.key]){C[Q]=ee.tileID;break}}}for(const Q in R)C[Q]||(this._coveredTiles[Q]=!0,C[Q]=R[Q])}for(const R in C)this._tiles[R].clearFadeHold();const S=function(R,N){const U=[];for(const W in R)W in N||U.push(W);return U}(this._tiles,C);for(const R of S){const N=this._tiles[R];N.hasSymbolBuckets&&!N.holdingForFade()?N.setHoldDuration(this.map._fadeDuration):N.hasSymbolBuckets&&!N.symbolFadeFinished()||this._removeTile(+R)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){const c={};if(0===s.length)return c;const f={},v=s.reduce((U,W)=>Math.min(U,W.overscaledZ),1/0),C=s[0].overscaledZ,S=Math.max(C-fp.maxOverzooming,this._source.minzoom),R=Math.max(C+fp.maxUnderzooming,this._source.minzoom),N={};for(const U of s){const W=this._addTile(U);c[U.key]=U,W.hasData()||v<this._source.maxzoom&&(N[U.key]=U)}this._retainLoadedChildren(N,v,R,c);for(const U of s){let W=this._tiles[U.key];if(W.hasData())continue;if(U.canonical.z>=this._source.maxzoom){const ee=U.children(this._source.maxzoom)[0],oe=this.getTile(ee);if(oe&&oe.hasData()){c[ee.key]=ee;continue}}else{const ee=U.children(this._source.maxzoom);if(c[ee[0].key]&&c[ee[1].key]&&c[ee[2].key]&&c[ee[3].key])continue}let Q=W.wasRequested();for(let ee=U.overscaledZ-1;ee>=S;--ee){const oe=U.scaledTo(ee);if(f[oe.key]||(f[oe.key]=!0,W=this.getTile(oe),!W&&Q&&(W=this._addTile(oe)),W&&(c[oe.key]=oe,Q=W.wasRequested(),W.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const c=[];let f,v=this._tiles[s].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){f=this._loadedParentTiles[v.key];break}c.push(v.key);const C=v.scaledTo(v.overscaledZ-1);if(f=this._getLoadedTile(C),f)break;v=C}for(const C of c)this._loadedParentTiles[C]=f}}_addTile(s){let c=this._tiles[s.key];if(c)return c;c=this._cache.getAndRemove(s),c&&(this._setTileReloadTimer(s.key,c),c.tileID=s,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,c)));const f=Boolean(c);if(!f){const v=this.map?this.map.painter:null;c=new Qy(s,this._source.tileSize*s.overscaleFactor(),this.transform.tileZoom,v,this._isRaster),this._loadTile(c,this._tileLoaded.bind(this,c,s.key,c.state))}return c?(c.uses++,this._tiles[s.key]=c,f||this._source.fire(new ci("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null}_setTileReloadTimer(s,c){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const f=c.getExpiryTimeout();f&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},f))}_removeTile(s){const c=this._tiles[s];c&&(c.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),c.uses>0||(c.hasData()&&"reloading"!==c.state?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,c,f){const v=[],C=this.transform;if(!C)return v;const S="globe"===C.projection.name,R=kh(C.center.lng);for(const N in this._tiles){const U=this._tiles[N];if(f&&U.clearQueryDebugViz(),U.holdingForFade())continue;let W;if(S){const Q=U.tileID.canonical;if(0===Q.z){const ee=[Math.abs(It(R,...Su(Q,-1))-R),Math.abs(It(R,...Su(Q,1))-R)];W=[0,2*ee.indexOf(Math.min(...ee))-1]}else{const ee=[Math.abs(It(R,...Su(Q,-1))-R),Math.abs(It(R,...Su(Q,0))-R),Math.abs(It(R,...Su(Q,1))-R)];W=[ee.indexOf(Math.min(...ee))-1]}}else W=[0];for(const Q of W){const ee=s.containsTile(U,C,c,Q);ee&&v.push(ee)}}return v}getVisibleCoordinates(s){const c=this.getRenderableIds(s).map(f=>this._tiles[f].tileID);for(const f of c)f.projMatrix=this.transform.calculateProjMatrix(f.toUnwrapped());return c}hasTransition(){if(this._source.hasTransition())return!0;if(mg(this._source.type))for(const s in this._tiles){const c=this._tiles[s];if(void 0!==c.fadeEndTime&&c.fadeEndTime>=ur.now())return!0}return!1}setFeatureState(s,c,f){this._state.updateState(s=s||"_geojsonTileLayer",c,f)}removeFeatureState(s,c,f){this._state.removeFeatureState(s=s||"_geojsonTileLayer",c,f)}getFeatureState(s,c){return this._state.getState(s=s||"_geojsonTileLayer",c)}setDependencies(s,c,f){const v=this._tiles[s];v&&v.setDependencies(c,f)}reloadTilesForDependencies(s,c){for(const f in this._tiles)this._tiles[f].hasDependency(s,c)&&this._reloadTile(+f,"reloading");this._cache.filter(f=>!f.hasDependency(s,c))}_preloadTiles(s,c){const f=new Map,v=Array.isArray(s)?s:[s],C=this.map.painter.terrain,S=this.usedForTerrain&&C?C.getScaledDemTileSize():this._source.tileSize;for(const R of v){const N=R.coveringTiles({tileSize:S,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const U of N)f.set(U.key,U);this.usedForTerrain&&R.updateElevation(!1)}ai(Array.from(f.values()),(R,N)=>{const U=new Qy(R,this._source.tileSize*R.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(U,W=>{"raster-dem"===this._source.type&&U.dem&&this._backfillDEM(U),N(W,U)})},c)}}function Bx(l,s){const c=Math.abs(2*l.wrap)-+(l.wrap<0),f=Math.abs(2*s.wrap)-+(s.wrap<0);return l.overscaledZ-s.overscaledZ||f-c||s.canonical.y-l.canonical.y||s.canonical.x-l.canonical.x}function mg(l){return"raster"===l||"image"===l||"video"===l||"custom"===l}function Su(l,s){const c=1<<l.z;return[l.x/c+s,(l.x+1)/c+s]}fp.maxOverzooming=10,fp.maxUnderzooming=3;class cf{constructor(s,c,f){this._demTile=s,this._dem=this._demTile.dem,this._scale=c,this._offset=f}static create(s,c,f){const v=f||s.findDEMTileFor(c);if(!v||!v.dem)return;const C=v.dem,S=v.tileID,R=1<<c.canonical.z-S.canonical.z;return new cf(v,v.tileSize/Ci/R,[(c.canonical.x/R-S.canonical.x)*C.dim,(c.canonical.y/R-S.canonical.y)*C.dim])}tileCoordToPixel(s,c){const f=c*this._scale+this._offset[1],v=Math.floor(s*this._scale+this._offset[0]),C=Math.floor(f);return new st(v,C)}getElevationAt(s,c,f,v){const C=s*this._scale+this._offset[0],S=c*this._scale+this._offset[1],R=Math.floor(C),N=Math.floor(S),U=this._dem;return v=!!v,f?Oi(Oi(U.get(R,N,v),U.get(R,N+1,v),S-N),Oi(U.get(R+1,N,v),U.get(R+1,N+1,v),S-N),C-R):U.get(R,N,v)}getElevationAtPixel(s,c,f){return this._dem.get(s,c,!!f)}getMeterToDEM(s){return(1<<this._demTile.tileID.canonical.z)*Gc(1,s)*this._dem.stride}}class gg{constructor(s,c){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Qu(Ci,16,0),this.featureIndexArray=new V,this.promoteId=c}insert(s,c,f,v,C,S=0){const R=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,v,C,S);const N=this.grid;for(let U=0;U<c.length;U++){const W=c[U],Q=[1/0,1/0,-1/0,-1/0];for(let ee=0;ee<W.length;ee++){const oe=W[ee];Q[0]=Math.min(Q[0],oe.x),Q[1]=Math.min(Q[1],oe.y),Q[2]=Math.max(Q[2],oe.x),Q[3]=Math.max(Q[3],oe.y)}Q[0]<Ci&&Q[1]<Ci&&Q[2]>=0&&Q[3]>=0&&N.insert(R,Q[0],Q[1],Q[2],Q[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new ox(new Zf(this.rawTileData)).layers,this.sourceLayerCoder=new Ox(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const s in this.vtLayers)this.vtFeatures[s]=[]}return this.vtLayers}query(s,c,f,v){this.loadVTLayers();const C=s.params||{},S=La(C.filter),R=s.tileResult,N=s.transform,U=R.bufferedTilespaceBounds,W=this.grid.query(U.min.x,U.min.y,U.max.x,U.max.y,(le,he,Ie,Le)=>$w(R.bufferedTilespaceGeometry,le,he,Ie,Le));W.sort(_g);let Q=null;N.elevation&&W.length>0&&(Q=cf.create(N.elevation,this.tileID));const ee={};let oe;for(let le=0;le<W.length;le++){const he=W[le];if(he===oe)continue;oe=he;const Ie=this.featureIndexArray.get(he);let Le=null;this.loadMatchingFeature(ee,Ie,S,C.layers,C.availableImages,c,f,v,(ve,Pe,He,Be=0)=>(Le||(Le=xd(ve,this.tileID.canonical,s.tileTransform)),Pe.queryIntersectsFeature(R,ve,He,Le,this.z,s.transform,s.pixelPosMatrix,Q,Be)))}return ee}loadMatchingFeature(s,c,f,v,C,S,R,N,U){const{featureIndex:W,bucketIndex:Q,sourceLayerIndex:ee,layoutVertexArrayOffset:oe}=c,le=this.bucketLayerIDs[Q];if(v&&!function(ve,Pe){for(let He=0;He<ve.length;He++)if(Pe.indexOf(ve[He])>=0)return!0;return!1}(v,le))return;const he=this.sourceLayerCoder.decode(ee),Ie=this.vtLayers[he].feature(W);if(f.needGeometry){const ve=wu(Ie,!0);if(!f.filter(new ut(this.tileID.overscaledZ),ve,this.tileID.canonical))return}else if(!f.filter(new ut(this.tileID.overscaledZ),Ie))return;const Le=this.getId(Ie,he);for(let ve=0;ve<le.length;ve++){const Pe=le[ve];if(v&&v.indexOf(Pe)<0)continue;const He=S[Pe];if(!He)continue;let Be={};void 0!==Le&&N&&(Be=N.getState(He.sourceLayer||"_geojsonTileLayer",Le));const $e=Ni({},R[Pe]);$e.paint=ev($e.paint,He.paint,Ie,Be,C),$e.layout=ev($e.layout,He.layout,Ie,Be,C);const kt=!U||U(Ie,He,Be,oe);if(!kt)continue;const St=new R_(Ie,this.z,this.x,this.y,Le);St.layer=$e;let Gt=s[Pe];void 0===Gt&&(Gt=s[Pe]=[]),Gt.push({featureIndex:W,feature:St,intersectionZ:kt})}}lookupSymbolFeatures(s,c,f,v,C,S,R,N){const U={};this.loadVTLayers();const W=La(C);for(const Q of s)this.loadMatchingFeature(U,{bucketIndex:f,sourceLayerIndex:v,featureIndex:Q,layoutVertexArrayOffset:0},W,S,R,N,c);return U}loadFeature(s){const{featureIndex:c,sourceLayerIndex:f}=s;this.loadVTLayers();const v=this.sourceLayerCoder.decode(f),C=this.vtFeatures[v];if(C[c])return C[c];const S=this.vtLayers[v].feature(c);return C[c]=S,S}hasLayer(s){for(const c of this.bucketLayerIDs)for(const f of c)if(s===f)return!0;return!1}getId(s,c){let f=s.id;if(this.promoteId){const v="string"==typeof this.promoteId?this.promoteId:this.promoteId[c];null!=v&&(f=s.properties[v]),"boolean"==typeof f&&(f=Number(f))}return f}}function ev(l,s,c,f,v){return Gr(l,(C,S)=>{const R=s instanceof Tt?s.get(S):null;return R&&R.evaluate?R.evaluate(c,f,v):R})}function _g(l,s){return s-l}Rn(gg,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class am{constructor(s,c){this.width=s,this.height=c,this.nextRow=0,this.image=new ip({width:s,height:c}),this.positions={},this.uploaded=!1}getDash(s,c){const f=this.getKey(s,c);return this.positions[f]}trim(){const s=this.width,c=this.height=or(this.nextRow);this.image.resize({width:s,height:c})}getKey(s,c){return s.join(",")+c}getDashRanges(s,c,f){const v=[];let C=s.length%2==1?-s[s.length-1]*f:0,S=s[0]*f,R=!0;v.push({left:C,right:S,isDash:R,zeroLength:0===s[0]});let N=s[0];for(let U=1;U<s.length;U++){R=!R;const W=s[U];C=N*f,N+=W,S=N*f,v.push({left:C,right:S,isDash:R,zeroLength:0===W})}return v}addRoundDash(s,c,f){const v=c/2;for(let C=-f;C<=f;C++){const S=this.width*(this.nextRow+f+C);let R=0,N=s[R];for(let U=0;U<this.width;U++){U/N.right>1&&(N=s[++R]);const W=Math.abs(U-N.left),Q=Math.abs(U-N.right),ee=Math.min(W,Q);let oe;const le=C/f*(v+1);if(N.isDash){const he=v-Math.abs(le);oe=Math.sqrt(ee*ee+he*he)}else oe=v-Math.sqrt(ee*ee+le*le);this.image.data[S+U]=Math.max(0,Math.min(255,oe+128))}}}addRegularDash(s,c){for(let N=s.length-1;N>=0;--N){const U=s[N],W=s[N+1];U.zeroLength?s.splice(N,1):W&&W.isDash===U.isDash&&(W.left=U.left,s.splice(N,1))}const f=s[0],v=s[s.length-1];f.isDash===v.isDash&&(f.left=v.left-this.width,v.right=f.right+this.width);const C=this.width*this.nextRow;let S=0,R=s[S];for(let N=0;N<this.width;N++){N/R.right>1&&(R=s[++S]);const U=Math.abs(N-R.left),W=Math.abs(N-R.right),Q=Math.min(U,W);this.image.data[C+N]=Math.max(0,Math.min(255,(R.isDash?Q:-Q)+c+128))}}addDash(s,c){const f=this.getKey(s,c);if(this.positions[f])return this.positions[f];const v="round"===c,C=v?7:0,S=2*C+1;if(this.nextRow+S>this.height)return Ar("LineAtlas out of space"),null;0===s.length&&s.push(1);let R=0;for(let W=0;W<s.length;W++)s[W]<0&&(Ar("Negative value is found in line dasharray, replacing values with 0"),s[W]=0),R+=s[W];if(0!==R){const W=this.width/R,Q=this.getDashRanges(s,this.width,W);v?this.addRoundDash(Q,W,C):this.addRegularDash(Q,"square"===c?.5*W:0)}const N=this.nextRow+C;this.nextRow+=S;const U={tl:[N,C],br:[R,0]};return this.positions[f]=U,U}}Rn(am,"LineAtlas");class Bh{constructor(s){const c={},f=[];for(const R in s){const N=s[R],U=c[R]={};for(const W in N.glyphs){const Q=N.glyphs[+W];if(!Q||0===Q.bitmap.width||0===Q.bitmap.height)continue;const ee=Q.metrics.localGlyph?2:1,oe={x:0,y:0,w:Q.bitmap.width+2*ee,h:Q.bitmap.height+2*ee};f.push(oe),U[W]=oe}}const{w:v,h:C}=Kf(f),S=new ip({width:v||1,height:C||1});for(const R in s){const N=s[R];for(const U in N.glyphs){const W=N.glyphs[+U];if(!W||0===W.bitmap.width||0===W.bitmap.height)continue;const Q=c[R][U],ee=W.metrics.localGlyph?2:1;ip.copy(W.bitmap,S,{x:0,y:0},{x:Q.x+ee,y:Q.y+ee},W.bitmap)}}this.image=S,this.positions=c}}Rn(Bh,"GlyphAtlas");class ub{constructor(s){this.tileID=new dc(s.tileID.overscaledZ,s.tileID.wrap,s.tileID.canonical.z,s.tileID.canonical.x,s.tileID.canonical.y),this.tileZoom=s.tileZoom,this.uid=s.uid,this.zoom=s.zoom,this.canonical=s.tileID.canonical,this.pixelRatio=s.pixelRatio,this.tileSize=s.tileSize,this.source=s.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=s.showCollisionBoxes,this.collectResourceTiming=!!s.collectResourceTiming,this.returnDependencies=!!s.returnDependencies,this.promoteId=s.promoteId,this.enableTerrain=!!s.enableTerrain,this.isSymbolTile=s.isSymbolTile,this.tileTransform=Bs(s.tileID.canonical,s.projection),this.projection=s.projection}parse(s,c,f,v,C){this.status="parsing",this.data=s,this.collisionBoxArray=new ya;const S=new Ox(Object.keys(s.layers).sort()),R=new gg(this.tileID,this.promoteId);R.bucketLayerIDs=[];const N={},U=new am(256,256),W={featureIndex:R,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:U,availableImages:f},Q=c.familiesBySource[this.source];for(const Be in Q){const $e=s.layers[Be];if(!$e)continue;let kt=!1,St=!1;for(const Ft of Q[Be])"symbol"===Ft[0].type?kt=!0:St=!0;if(!0===this.isSymbolTile&&!kt||!1===this.isSymbolTile&&!St)continue;1===$e.version&&Ar(`Vector tile source "${this.source}" layer "${Be}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Gt=S.encode(Be),Qt=[];for(let Ft=0;Ft<$e.length;Ft++){const Kt=$e.feature(Ft),Xt=R.getId(Kt,Be);Qt.push({feature:Kt,id:Xt,index:Ft,sourceLayerIndex:Gt})}for(const Ft of Q[Be]){const Kt=Ft[0];void 0!==this.isSymbolTile&&"symbol"===Kt.type!==this.isSymbolTile||Kt.minzoom&&this.zoom<Math.floor(Kt.minzoom)||Kt.maxzoom&&this.zoom>=Kt.maxzoom||"none"!==Kt.visibility&&(F_(Ft,this.zoom,f),(N[Kt.id]=Kt.createBucket({index:R.bucketLayerIDs.length,layers:Ft,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Gt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:f})).populate(Qt,W,this.tileID.canonical,this.tileTransform),R.bucketLayerIDs.push(Ft.map(Xt=>Xt.id)))}}let ee,oe,le,he;U.trim();const Ie={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Le=Gr(W.glyphDependencies,Be=>Object.keys(Be).map(Number));Object.keys(Le).length?v.send("getGlyphs",{uid:this.uid,stacks:Le},(Be,$e)=>{ee||(ee=Be,oe=$e,He.call(this))},void 0,!1,Ie):oe={};const ve=Object.keys(W.iconDependencies);ve.length?v.send("getImages",{icons:ve,source:this.source,tileID:this.tileID,type:"icons"},(Be,$e)=>{ee||(ee=Be,le=$e,He.call(this))},void 0,!1,Ie):le={};const Pe=Object.keys(W.patternDependencies);function He(){if(ee)return C(ee);if(oe&&le&&he){const Be=new Bh(oe),$e=new Xp(le,he);for(const kt in N){const St=N[kt];St instanceof sf?(F_(St.layers,this.zoom,f),lg(St,oe,Be.positions,le,$e.iconPositions,this.showCollisionBoxes,f,this.tileID.canonical,this.tileZoom,this.projection)):St.hasPattern&&(St instanceof Gf||St instanceof c_||St instanceof qm)&&(F_(St.layers,this.zoom,f),St.addFeatures(W,this.tileID.canonical,$e.patternPositions,f,this.tileTransform))}this.status="done",C(null,{buckets:ir(N).filter(kt=>!kt.isEmpty()),featureIndex:R,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Be.image,lineAtlas:U,imageAtlas:$e,glyphMap:this.returnDependencies?oe:null,iconMap:this.returnDependencies?le:null,glyphPositions:this.returnDependencies?Be.positions:null})}}Pe.length?v.send("getImages",{icons:Pe,source:this.source,tileID:this.tileID,type:"patterns"},(Be,$e)=>{ee||(ee=Be,he=$e,He.call(this))},void 0,!1,Ie):he={},He.call(this)}}function F_(l,s,c){const f=new ut(s);for(const v of l)v.recalculate(f,c)}class jr{constructor(s){this.entries={},this.scheduler=s}request(s,c,f,v){const C=this.entries[s]=this.entries[s]||{callbacks:[]};if(C.result){const[S,R]=C.result;return this.scheduler?this.scheduler.add(()=>{v(S,R)},c):v(S,R),()=>{}}return C.callbacks.push(v),C.cancel||(C.cancel=f((S,R)=>{C.result=[S,R];for(const N of C.callbacks)this.scheduler?this.scheduler.add(()=>{N(S,R)},c):N(S,R);setTimeout(()=>delete this.entries[s],3e3)})),()=>{C.result||(C.callbacks=C.callbacks.filter(S=>S!==v),C.callbacks.length||(C.cancel(),delete this.entries[s]))}}}function qc(l,s,c){const f=JSON.stringify(l.request);return l.data&&(this.deduped.entries[f]={result:[null,l.data]}),this.deduped.request(f,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom},v=>{const C=Jr(l.request,(S,R,N,U)=>{S?v(S):R&&v(null,{vectorTile:c?void 0:new ox(new Zf(R)),rawData:R,cacheControl:N,expires:U})});return()=>{C.cancel(),v()}},s)}y.ARRAY_TYPE=Ml,y.AUTH_ERR_MSG=En,y.Aabb=al,y.Actor=class{constructor(l,s,c){this.target=l,this.parent=s,this.mapId=c,this.callbacks={},this.cancelCallbacks={},$i(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Rr()?l:ze,this.scheduler=new k_}send(l,s,c,f,v=!1,C){const S=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=C,this.callbacks[S]=c);const R=Ao(this.globalScope)?void 0:[];return this.target.postMessage({id:S,type:l,hasCallback:!!c,targetMapId:f,mustQueue:v,sourceMapId:this.mapId,data:Uc(s,R)},R),{cancel:()=>{c&&delete this.callbacks[S],this.target.postMessage({id:S,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(l){const s=l.data,c=s.id;if(c&&(!s.targetMapId||this.mapId===s.targetMapId))if("<cancel>"===s.type){const f=this.cancelCallbacks[c];delete this.cancelCallbacks[c],f&&f.cancel()}else if(s.mustQueue||Rr()){const f=this.callbacks[c];this.cancelCallbacks[c]=this.scheduler.add(()=>this.processTask(c,s),f&&f.metadata||{type:"message"})}else this.processTask(c,s)}processTask(l,s){if("<response>"===s.type){const c=this.callbacks[l];delete this.callbacks[l],c&&(s.error?c(nc(s.error)):c(null,nc(s.data)))}else{const c=Ao(this.globalScope)?void 0:[],f=s.hasCallback?(C,S)=>{delete this.cancelCallbacks[l],this.target.postMessage({id:l,type:"<response>",sourceMapId:this.mapId,error:C?Uc(C):null,data:Uc(S,c)},c)}:C=>{},v=nc(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,v,f);else if(this.parent.getWorkerSource){const C=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,C[0],v.source)[C[1]](v,f)}else f(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},y.CanonicalTileID=d_,y.Color=Qi,y.ColorMode=Yo,y.CullFaceMode=Fo,y.DEMData=lb,y.DataConstantProperty=yt,y.DedupedRequest=jr,y.DepthMode=Es,y.EXTENT=Ci,y.Elevation=class{isDataAvailableAtPoint(l){const s=this._source();if(this.isUsingMockSource()||!s||l.y<0||l.y>1)return!1;const c=s.getSource().maxzoom,f=1<<c,v=Math.floor(l.x),C=Math.floor((l.x-v)*f),S=Math.floor(l.y*f),R=this.findDEMTileFor(new dc(c,v,c,C,S));return!(!R||!R.dem)}getAtPointOrZero(l,s=0){return this.getAtPoint(l,s)||0}getAtPoint(l,s,c=!0){if(this.isUsingMockSource())return null;null==s&&(s=null);const f=this._source();if(!f||l.y<0||l.y>1)return s;const v=f.getSource().maxzoom,C=1<<v,S=Math.floor(l.x),R=l.x-S,N=new dc(v,S,v,Math.floor(R*C),Math.floor(l.y*C)),U=this.findDEMTileFor(N);if(!U||!U.dem)return s;const W=U.dem,Q=1<<U.tileID.canonical.z,ee=(R*Q-U.tileID.canonical.x)*W.dim,oe=(l.y*Q-U.tileID.canonical.y)*W.dim,le=Math.floor(ee),he=Math.floor(oe);return(c?this.exaggeration():1)*Oi(Oi(W.get(le,he),W.get(le,he+1),oe-he),Oi(W.get(le+1,he),W.get(le+1,he+1),oe-he),ee-le)}getAtTileOffset(l,s,c){const f=1<<l.canonical.z;return this.getAtPointOrZero(new zm(l.wrap+(l.canonical.x+s/Ci)/f,(l.canonical.y+c/Ci)/f))}getAtTileOffsetFunc(l,s,c,f){return v=>{const C=this.getAtTileOffset(l,v.x,v.y),S=f.upVector(l.canonical,v.x,v.y);return Rl(S,S,C*f.upVectorScale(l.canonical,s,c).metersToTile),S}}getForTilePoints(l,s,c,f){if(this.isUsingMockSource())return!1;const v=cf.create(this,l,f);return!!v&&(s.forEach(C=>{C[2]=this.exaggeration()*v.getElevationAt(C[0],C[1],c)}),!0)}getMinMaxForTile(l){if(this.isUsingMockSource())return null;const s=this.findDEMTileFor(l);if(!s||!s.dem)return null;const c=s.dem.tree,f=s.tileID,v=1<<l.canonical.z-f.canonical.z;let C=l.canonical.x/v-f.canonical.x,S=l.canonical.y/v-f.canonical.y,R=0;for(let N=0;N<l.canonical.z-f.canonical.z&&!c.leaves[R];N++){C*=2,S*=2;const U=2*Math.floor(S)+Math.floor(C);R=c.childOffsets[R]+U,C%=1,S%=1}return{min:this.exaggeration()*c.minimums[R],max:this.exaggeration()*c.maximums[R]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(l,s,c){throw new Error("Pure virtual method called.")}pointCoordinate(l){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(l){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},y.ErrorEvent=Mr,y.EvaluationParameters=ut,y.Event=ci,y.Evented=mo,y.FillExtrusionBucket=qm,y.Frustum=km,y.FrustumCorners=y0,y.GLOBE_RADIUS=Mh,y.GLOBE_SCALE_MATCH_LATITUDE=45,y.GLOBE_ZOOM_THRESHOLD_MAX=6,y.GLOBE_ZOOM_THRESHOLD_MIN=5,y.GlobeSharedBuffers=class{constructor(l){this._createGrid(l),this._createPoles(l)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const l of this._poleSegments)l.destroy();for(const l of this._gridSegments)l.withSkirts.destroy(),l.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const l of this._wireframeSegments)l.destroy()}}_fillGridMeshWithLods(l,s){const c=new hi,f=new Ns,v=[],C=l+1+2,S=s[0]+1,R=s[0]+1+(1+s.length),N=(U,W,Q)=>{let ee=U===C-1?U-2:0===U?U:U-1;return ee+=Q?24575:0,[ee,W]};for(let U=0;U<C;++U)c.emplaceBack(...N(U,0,!0));for(let U=0;U<S;++U)for(let W=0;W<C;++W)c.emplaceBack(...N(W,U,(0===W||W===C-1)&&!0));for(let U=0;U<s.length;++U){const W=s[U];for(let Q=0;Q<C;++Q)c.emplaceBack(...N(Q,W,!0))}for(let U=0;U<s.length;++U){const W=f.length,Q=s[U]+1+2,ee=new Ns;for(let he=0;he<Q-1;he++){const Ie=he===Q-2,Le=Ie?C*(R-s.length+U-he):C;for(let ve=0;ve<C-1;ve++){const Pe=he*C+ve;0===he||Ie||0===ve||ve===C-2?(ee.emplaceBack(Pe+1,Pe,Pe+Le),ee.emplaceBack(Pe+Le,Pe+Le+1,Pe+1)):(f.emplaceBack(Pe+1,Pe,Pe+Le),f.emplaceBack(Pe+Le,Pe+Le+1,Pe+1))}}const oe=Cs.simpleSegment(0,W,c.length,f.length-W);for(let he=0;he<ee.uint16.length;he+=3)f.emplaceBack(ee.uint16[he],ee.uint16[he+1],ee.uint16[he+2]);const le=Cs.simpleSegment(0,W,c.length,f.length-W);v.push({withoutSkirts:oe,withSkirts:le})}return{vertices:c,indices:f,segments:v}}_createGrid(l){const s=this._fillGridMeshWithLods(64,ac);this._gridSegments=s.segments,this._gridBuffer=l.createVertexBuffer(s.vertices,gy.members),this._gridIndexBuffer=l.createIndexBuffer(s.indices,!0)}_createPoles(l){const s=new Ns;for(let v=0;v<=64;v++)s.emplaceBack(0,v+1,v+2);this._poleIndexBuffer=l.createIndexBuffer(s,!0);const c=new rl,f=new rl;this._poleSegments=[];for(let v=0,C=0;v<5;v++){const S=360/(1<<v);c.emplaceBack(0,-Mh,0,.5,0),f.emplaceBack(0,-Mh,0,.5,1);for(let R=0;R<=64;R++){const N=R/64,U=Oi(0,S,N),[W,Q,ee]=Rm(jw,x0,U,Mh);c.emplaceBack(W,Q,ee,N,0),f.emplaceBack(W,Q,ee,N,1)}this._poleSegments.push(Cs.simpleSegment(C,0,66,64)),C+=66}this._poleNorthVertexBuffer=l.createVertexBuffer(c,Qg,!1),this._poleSouthVertexBuffer=l.createVertexBuffer(f,Qg,!1)}getGridBuffers(l,s){return[this._gridBuffer,this._gridIndexBuffer,s?this._gridSegments[l].withSkirts:this._gridSegments[l].withoutSkirts]}getPoleBuffers(l){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[l]]}getWirefameBuffers(l,s){if(!this._wireframeSegments){const c=new yo,f=64,v=f+1+2,C=1;this._wireframeSegments=[];for(let S=0,R=0;S<ac.length;S++){const N=ac[S];for(let W=C;W<N+C;W++)for(let Q=C;Q<f+C;Q++){const ee=W*v+Q;c.emplaceBack(ee,ee+1),c.emplaceBack(ee,ee+v),c.emplaceBack(ee,ee+v+1)}const U=N*f*3;this._wireframeSegments.push(Cs.simpleSegment(0,R,(N+1)*v,U)),R+=U}this._wireframeIndexBuffer=l.createIndexBuffer(c)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[s]]}},y.GlyphManager=ef,y.ImagePosition=sp,y.LivePerformanceUtils=$t,y.LngLat=br,y.LngLatBounds=_d,y.LocalGlyphMode=Zy,y.MAX_MERCATOR_LATITUDE=Da,y.MercatorCoordinate=zm,y.ONE_EM=24,y.OverscaledTileID=dc,y.PerformanceMarkers=rt,y.Properties=hn,y.RGBAImage=hc,y.Ray=Mm,y.RequestManager=class{constructor(l,s,c){this._transformRequestFn=l,this._customAccessToken=s,this._silenceAuthErrors=!!c,this._createSkuToken()}_createSkuToken(){const l=function(){let s="";for(let c=0;c<10;c++)s+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",dt,s].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=l.token,this._skuTokenExpiresAt=l.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(l,s){return this._transformRequestFn&&this._transformRequestFn(l,s)||{url:l}}normalizeStyleURL(l,s){if(!rn(l))return l;const c=je(l);return c.path=`/styles/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||s)}normalizeGlyphsURL(l,s){if(!rn(l))return l;const c=je(l);return c.path=`/fonts/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||s)}normalizeSourceURL(l,s,c,f){if(!rn(l))return l;const v=je(l);return v.path=`/v4/${v.authority}.json`,v.params.push("secure"),c&&v.params.push(`language=${c}`),f&&v.params.push(`worldview=${f}`),this._makeAPIURL(v,this._customAccessToken||s)}normalizeSpriteURL(l,s,c,f){const v=je(l);return rn(l)?(v.path=`/styles/v1${v.path}/sprite${s}${c}`,this._makeAPIURL(v,this._customAccessToken||f)):(v.path+=`${s}${c}`,at(v))}normalizeTileURL(l,s,c){if(this._isSkuTokenExpired()&&this._createSkuToken(),l&&!rn(l))return l;const f=je(l);f.path=f.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${s||c&&"raster"!==f.authority&&512===c?"@2x":""}${nt.supported?".webp":"$1"}`),"raster"===f.authority?f.path=`/${Ne.RASTER_URL_PREFIX}${f.path}`:(f.path=f.path.replace(/^.+\/v4\//,"/"),f.path=`/${Ne.TILE_URL_VERSION}${f.path}`);const v=this._customAccessToken||function(C){for(const S of C){const R=S.match(/^access_token=(.*)$/);if(R)return R[1]}return null}(f.params)||Ne.ACCESS_TOKEN;return Ne.REQUIRE_ACCESS_TOKEN&&v&&this._skuToken&&f.params.push(`sku=${this._skuToken}`),this._makeAPIURL(f,v)}canonicalizeTileURL(l,s){const c=je(l);if(!c.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!c.path.match(/\.[\w]+$/))return l;let f="mapbox://";c.path.match(/^\/raster\/v1\//)?f+=`raster/${c.path.replace(`/${Ne.RASTER_URL_PREFIX}/`,"")}`:f+=`tiles/${c.path.replace(`/${Ne.TILE_URL_VERSION}/`,"")}`;let v=c.params;return s&&(v=v.filter(C=>!C.match(/^access_token=/))),v.length&&(f+=`?${v.join("&")}`),f}canonicalizeTileset(l,s){const c=!!s&&rn(s),f=[];for(const v of l.tiles||[])zn(v)?f.push(this.canonicalizeTileURL(v,c)):f.push(v);return f}_makeAPIURL(l,s){const c="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",f=je(Ne.API_URL);if(l.protocol=f.protocol,l.authority=f.authority,"http"===l.protocol){const v=l.params.indexOf("secure");v>=0&&l.params.splice(v,1)}if("/"!==f.path&&(l.path=`${f.path}${l.path}`),!Ne.REQUIRE_ACCESS_TOKEN)return at(l);if(s=s||Ne.ACCESS_TOKEN,!this._silenceAuthErrors){if(!s)throw new Error(`An API access token is required to use Mapbox GL. ${c}`);if("s"===s[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${c}`)}return l.params=l.params.filter(v=>-1===v.indexOf("access_token")),l.params.push(`access_token=${s||""}`),at(l)}},y.ResourceType=ts,y.SegmentVector=Cs,y.SourceCache=fp,y.StencilMode=sm,y.StructArrayLayout1ui2=sc,y.StructArrayLayout2f1f2i16=aa,y.StructArrayLayout2i4=hi,y.StructArrayLayout2ui4=yo,y.StructArrayLayout3f12=Fs,y.StructArrayLayout3ui6=Ns,y.StructArrayLayout4i8=Hr,y.StructArrayLayout5f20=rl,y.Texture=dg,y.Tile=Qy,y.Transitionable=on,y.Uniform1f=xs,y.Uniform1i=class extends la{constructor(l){super(l),this.current=0}set(l,s,c){this.fetchUniformLocation(l,s)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},y.Uniform2f=class extends la{constructor(l){super(l),this.current=[0,0]}set(l,s,c){this.fetchUniformLocation(l,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}},y.Uniform3f=class extends la{constructor(l){super(l),this.current=[0,0,0]}set(l,s,c){this.fetchUniformLocation(l,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}},y.Uniform4f=$g,y.UniformColor=tp,y.UniformMatrix2f=class extends la{constructor(l){super(l),this.current=Wg}set(l,s,c){if(this.fetchUniformLocation(l,s))for(let f=0;f<4;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}},y.UniformMatrix3f=class extends la{constructor(l){super(l),this.current=hy}set(l,s,c){if(this.fetchUniformLocation(l,s))for(let f=0;f<9;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}},y.UniformMatrix4f=class extends la{constructor(l){super(l),this.current=uy}set(l,s,c){if(this.fetchUniformLocation(l,s)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let f=1;f<16;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}},y.UnwrappedTileID=Ly,y.ValidationError=An,y.VectorTileFeature=V0,y.VectorTileWorkerSource=class extends mo{constructor(l,s,c,f,v){super(),this.actor=l,this.layerIndex=s,this.availableImages=c,this.loadVectorData=v||qc,this.loading={},this.loaded={},this.deduped=new jr(l.scheduler),this.isSpriteLoaded=f,this.scheduler=l.scheduler}loadTile(l,s){const c=l.uid,f=l&&l.request,v=f&&f.collectResourceTiming,C=this.loading[c]=new ub(l);C.abort=this.loadVectorData(l,(S,R)=>{const N=!this.loading[c];if(delete this.loading[c],N||S||!R)return C.status="done",N||(this.loaded[c]=C),s(S);const U=R.rawData,W={};R.expires&&(W.expires=R.expires),R.cacheControl&&(W.cacheControl=R.cacheControl),C.vectorTile=R.vectorTile||new ox(new Zf(U));const Q=()=>{C.parse(C.vectorTile,this.layerIndex,this.availableImages,this.actor,(ee,oe)=>{if(ee||!oe)return s(ee);const le={};if(v){const he=ni(f);he.length>0&&(le.resourceTiming=JSON.parse(JSON.stringify(he)))}s(null,Ni({rawTileData:U.slice(0)},oe,W,le))})};this.isSpriteLoaded?Q():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Q,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom}):Q()}),this.loaded=this.loaded||{},this.loaded[c]=C})}reloadTile(l,s){const c=this.loaded,f=l.uid,v=this;if(c&&c[f]){const C=c[f];C.showCollisionBoxes=l.showCollisionBoxes,C.enableTerrain=!!l.enableTerrain,C.projection=l.projection,C.tileTransform=Bs(l.tileID.canonical,l.projection);const S=(R,N)=>{const U=C.reloadCallback;U&&(delete C.reloadCallback,C.parse(C.vectorTile,v.layerIndex,this.availableImages,v.actor,U)),s(R,N)};"parsing"===C.status?C.reloadCallback=S:"done"===C.status&&(C.vectorTile?C.parse(C.vectorTile,this.layerIndex,this.availableImages,this.actor,S):S())}}abortTile(l,s){const c=l.uid,f=this.loading[c];f&&(f.abort&&f.abort(),delete this.loading[c]),s()}removeTile(l,s){const c=this.loaded,f=l.uid;c&&c[f]&&delete c[f],s()}},y.WritingMode=rh,y.ZoomDependentExpression=El,y.add=bd,y.addDynamicAttributes=Ky,y.adjoint=function(l,s){var c=s[0],f=s[1],v=s[2],C=s[3],S=s[4],R=s[5],N=s[6],U=s[7],W=s[8];return l[0]=S*W-R*U,l[1]=v*U-f*W,l[2]=f*R-v*S,l[3]=R*N-C*W,l[4]=c*W-v*N,l[5]=v*C-c*R,l[6]=C*U-S*N,l[7]=f*N-c*U,l[8]=c*S-f*C,l},y.asyncAll=ai,y.bezier=xt,y.bindAll=$i,y.boundsAttributes=fg,y.bufferConvexPolygon=function(l,s){const c=[];for(let f=0;f<l.length;f++){const v=wn(f-1,-1,l.length-1),C=wn(f+1,-1,l.length-1),S=l[f],R=l[C],N=l[v].sub(S).unit(),U=R.sub(S).unit(),W=U.angleWithSep(N.x,N.y),Q=N.add(U).unit().mult(-1*s/Math.sin(W/2));c.push(S.add(Q))}return c},y.cacheEntryPossiblyAdded=function(l){Wn++,Wn>Mo&&(l.getActor().send("enforceCacheSizeLimit",es),Wn=0)},y.calculateGlobeLabelMatrix=function(l,s){const{x:c,y:f}=l.point,v=zs(c,f,l.worldSize/l._pixelsPerMercatorPixel,0,0);return Dh(v,v,b0(Pl(s)))},y.calculateGlobeMatrix=function(l){const{x:s,y:c}=l.point,{lng:f,lat:v}=l._center;return zs(s,c,l.worldSize,f,v)},y.calculateGlobeMercatorMatrix=function(l){const s=l.pixelsPerMeter,c=s/Gc(1,l.center.lat),f=kl(new Float64Array(16));return Hp(f,f,[l.point.x,l.point.y,0]),yd(f,f,[c,c,s]),Float32Array.from(f)},y.circumferenceAtLatitude=Nm,y.clamp=It,y.clearTileCache=function(l){if(!wr())return;const s=ze.caches.delete(Uo);l&&s.catch(l).then(()=>l())},y.clipLine=Wy,y.clone=function(l){var s=new Ml(16);return s[0]=l[0],s[1]=l[1],s[2]=l[2],s[3]=l[3],s[4]=l[4],s[5]=l[5],s[6]=l[6],s[7]=l[7],s[8]=l[8],s[9]=l[9],s[10]=l[10],s[11]=l[11],s[12]=l[12],s[13]=l[13],s[14]=l[14],s[15]=l[15],s},y.clone$1=$r,y.collisionCircleLayout=DE,y.config=Ne,y.conjugate=function(l,s){return l[0]=-s[0],l[1]=-s[1],l[2]=-s[2],l[3]=s[3],l},y.create=function(){var l=new Ml(16);return Ml!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l},y.create$1=py,y.createExpression=Pc,y.createLayout=Jn,y.createStyleLayer=function(l){return"custom"===l.type?new af(l):new tb[l.type](l)},y.cross=Kg,y.degToRad=it,y.distance=function(l,s){return Math.hypot(s[0]-l[0],s[1]-l[1],s[2]-l[2])},y.div=function(l,s,c){return l[0]=s[0]/c[0],l[1]=s[1]/c[1],l[2]=s[2]/c[2],l},y.dot=bu,y.earthRadius=t_,y.ease=Lt,y.easeCubicInOut=gt,y.ecefToLatLng=function([l,s,c]){const f=Math.hypot(l,s,c),v=Math.atan2(l,c),C=.5*Math.PI-Math.acos(-s/f);return new br(zt(v),zt(C))},y.emitValidationErrors=Ju,y.endsWith=bi,y.enforceCacheSizeLimit=function(l){yr(),lo&&lo.then(s=>{s.keys().then(c=>{for(let f=0;f<c.length-l;f++)s.delete(c[f])})})},y.evaluateSizeForFeature=Vy,y.evaluateSizeForZoom=Qm,y.evaluateVariableOffset=ag,y.evented=Fe,y.exactEquals=function(l,s){return l[0]===s[0]&&l[1]===s[1]&&l[2]===s[2]&&l[3]===s[3]},y.exactEquals$1=function(l,s){return l[0]===s[0]&&l[1]===s[1]&&l[2]===s[2]},y.exported=ur,y.exported$1=nt,y.extend=Ni,y.extend$1=Ko,y.fillExtrusionHeightLift=hx,y.filterObject=Vo,y.fromMat4=function(l,s){return l[0]=s[0],l[1]=s[1],l[2]=s[2],l[3]=s[4],l[4]=s[5],l[5]=s[6],l[6]=s[8],l[7]=s[9],l[8]=s[10],l},y.fromQuat=function(l,s){var c=s[0],f=s[1],v=s[2],C=s[3],S=c+c,R=f+f,N=v+v,U=c*S,W=f*S,Q=f*R,ee=v*S,oe=v*R,le=v*N,he=C*S,Ie=C*R,Le=C*N;return l[0]=1-Q-le,l[1]=W+Le,l[2]=ee-Ie,l[3]=0,l[4]=W-Le,l[5]=1-U-le,l[6]=oe+he,l[7]=0,l[8]=ee+Ie,l[9]=oe-he,l[10]=1-U-Q,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l},y.fromRotation=function(l,s){var c=Math.sin(s),f=Math.cos(s);return l[0]=f,l[1]=c,l[2]=0,l[3]=-c,l[4]=f,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},y.fromScaling=Im,y.furthestTileCorner=function(l){const s=Math.round((l+45+360)%360/90)%4;return en[s]},y.getAABBPointSquareDist=function(l,s,c){let f=0;for(let v=0;v<2;++v){const C=c?c[v]:0;l[v]>C&&(f+=(l[v]-C)*(l[v]-C)),s[v]<C&&(f+=(C-s[v])*(C-s[v]))}return f},y.getAnchorAlignment=Jf,y.getAnchorJustification=sh,y.getBounds=function(l){let s=1/0,c=1/0,f=-1/0,v=-1/0;for(const C of l)s=Math.min(s,C.x),c=Math.min(c,C.y),f=Math.max(f,C.x),v=Math.max(v,C.y);return{min:new st(s,c),max:new st(f,v)}},y.getColumn=jn,y.getGridMatrix=function(l,s,c,f){const v=s.getNorth(),C=s.getSouth(),S=s.getWest(),R=s.getEast(),N=1<<l.z,U=R-S,W=v-C,Q=U/64,ee=-W/ac[c],oe=[0,Q,0,ee,0,0,v,S,0];if(l.z>0){const le=180/f;Tm(oe,oe,[le/U+1,0,0,0,le/W+1,0,-.5*le/Q,.5*le/ee,1])}return oe[2]=N,oe[5]=l.x,oe[8]=l.y,oe},y.getImage=qo,y.getJSON=function(l,s){return vs(Ni(l,{type:"json"}),s)},y.getLatitudinalLod=function(l){const s=Da-5;l=It(l,-s,s)/s*90;const c=Math.pow(Math.abs(Math.sin(it(l))),3);return Math.round(c*(ac.length-1))},y.getMapSessionAPI=ot,y.getPerformanceMeasurement=ni,y.getProjection=X0,y.getRTLTextPluginStatus=Ye,y.getReferrer=Ho,y.getTilePoint=function(l,{x:s,y:c},f=0){return new st(((s-f)*l.scale-l.x)*Ci,(c*l.scale-l.y)*Ci)},y.getTileVec3=function(l,s,c=0){return vd(((s.x-c)*l.scale-l.x)*Ci,(s.y*l.scale-l.y)*Ci,C0(s.z,s.y))},y.getVideo=function(l,s){const c=ze.document.createElement("video");c.muted=!0,c.onloadstart=function(){s(null,c)};for(let f=0;f<l.length;f++){const v=ze.document.createElement("source");co(l[f])||(c.crossOrigin="Anonymous"),v.src=l[f],c.appendChild(v)}return{cancel:()=>{}}},y.globeCenterToScreenPoint=function(l){const s=[0,0,0],c=kl(new Float64Array(16));return Dh(c,l.pixelMatrix,l.globeMatrix),ds(s,s,c),new st(s[0],s[1])},y.globeDenormalizeECEF=b0,y.globeECEFOrigin=function(l,s){const c=[0,0,0];return ds(c,c,Om(Pl(s.canonical))),ds(c,c,l),c},y.globeMetersToEcef=_y,y.globeNormalizeECEF=Om,y.globePixelsToTileUnits=function(l,s){return Ci/(512*Math.pow(2,l))*Wp(Pl(s))},y.globePoleMatrixForTile=function(l,s,c){const f=kl(new Float64Array(16)),v=(s/(1<<l)-.5)*Math.PI*2;return Sm(f,c.globeMatrix,v),Float32Array.from(f)},y.globeTileBounds=Pl,y.globeTiltAtLngLat=cE,y.globeToMercatorTransition=Lm,y.globeUseCustomAntiAliasing=function(l,s,c){const f=Lm(c.zoom),v=l.style.map._antialias,C=!!s.extStandardDerivatives,S=s.extStandardDerivativesForceOff||l.terrain&&l.terrain.exaggeration()>0;return 0===f&&!v&&!S&&C},y.identity=kl,y.identity$1=np,y.invert=Zg,y.isFullscreen=function(){return!!ze.document.fullscreenElement||!!ze.document.webkitFullscreenElement},y.isLngLatBehindGlobe=Fm,y.isMapAuthenticated=function(l){return tt.has(l)},y.isMapboxURL=rn,y.isSafariWithAntialiasingBug=function(l){const s=l.navigator?l.navigator.userAgent:null;return!!Ao(l)&&s&&(s.match("Version/15.4")||s.match("Version/15.5")||s.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},y.latFromMercatorY=Ua,y.latLngToECEF=zf,y.len=yD,y.length=vu,y.length$1=function(l){return Math.hypot(l[0],l[1],l[2],l[3])},y.lngFromMercatorX=uc,y.loadVectorTile=qc,y.makeRequest=vs,y.mapValue=function(l,s,c,f,v){return It((l-s)/(c-s)*(v-f)+f,f,v)},y.mercatorScale=hE,y.mercatorXfromLng=kh,y.mercatorYfromLat=cc,y.mercatorZfromAltitude=Gc,y.mul=Fw,y.mul$1=aE,y.multiply=Dh,y.multiply$1=Tm,y.multiply$2=my,y.nextPowerOfTwo=or,y.normalize=Va,y.normalize$1=g0,y.normalize$2=m0,y.number=Oi,y.ortho=function(l,s,c,f,v,C,S){var R=1/(s-c),N=1/(f-v),U=1/(C-S);return l[0]=-2*R,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*N,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*U,l[11]=0,l[12]=(s+c)*R,l[13]=(v+f)*N,l[14]=(S+C)*U,l[15]=1,l},y.pbf=Zf,y.perspective=function(l,s,c,f,v){var C,S=1/Math.tan(s/2);return l[0]=S/c,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=S,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,null!=v&&v!==1/0?(l[10]=(v+f)*(C=1/(f-v)),l[14]=2*v*f*C):(l[10]=-1,l[14]=-2*f),l},y.pick=function(l,s){const c={};for(let f=0;f<s.length;f++){const v=s[f];v in l&&(c[v]=l[v])}return c},y.plugin=Xe,y.pointGeometry=st,y.polesInViewport=function(l){const s=kl(new Float64Array(16));Dh(s,l.pixelMatrix,l.globeMatrix);const c=[0,lc,0],f=[0,th,0];return ds(c,c,s),ds(f,f,s),[c[0]>0&&c[0]<=l.width&&c[1]>0&&c[1]<=l.height&&!Fm(l,new br(l.center.lat,90)),f[0]>0&&f[0]<=l.width&&f[1]>0&&f[1]<=l.height&&!Fm(l,new br(l.center.lat,-90))]},y.polygonContainsPoint=$c,y.polygonIntersectsBox=$w,y.polygonIntersectsPolygon=I0,y.polygonizeBounds=function(l,s,c=0,f=!0){const v=new st(c,c),C=l.sub(v),S=s.add(v),R=[C,new st(S.x,C.y),S,new st(C.x,S.y)];return f&&R.push(C.clone()),R},y.posAttributes=gy,y.postMapLoadEvent=we,y.postPerformanceEvent=Ve,y.postTurnstileEvent=ie,y.potpack=Kf,y.prevPowerOfTwo=function(l){return l<=1?1:Math.pow(2,Math.floor(Math.log(l)/Math.LN2))},y.radToDeg=zt,y.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],y.registerForPluginStateChange=function(l){return l({pluginStatus:Te,pluginURL:de}),Fe.on("pluginStateChange",l),l},y.removeAuthState=function(l){tt.delete(l)},y.renderColorRamp=Cd,y.resample=T0,y.rotateX=jp,y.rotateX$1=$p,y.rotateY=Sm,y.rotateY$1=Am,y.rotateZ=function(l,s,c){var f=Math.sin(c),v=Math.cos(c),C=s[0],S=s[1],R=s[2],N=s[3],U=s[4],W=s[5],Q=s[6],ee=s[7];return s!==l&&(l[8]=s[8],l[9]=s[9],l[10]=s[10],l[11]=s[11],l[12]=s[12],l[13]=s[13],l[14]=s[14],l[15]=s[15]),l[0]=C*v+U*f,l[1]=S*v+W*f,l[2]=R*v+Q*f,l[3]=N*v+ee*f,l[4]=U*v-C*f,l[5]=W*v-S*f,l[6]=Q*v-R*f,l[7]=ee*v-N*f,l},y.rotateZ$1=function(l,s,c){c*=.5;var f=s[0],v=s[1],C=s[2],S=s[3],R=Math.sin(c),N=Math.cos(c);return l[0]=f*N+v*R,l[1]=v*N-f*R,l[2]=C*N+S*R,l[3]=S*N-C*R,l},y.scale=yd,y.scale$1=zw,y.scale$2=Rl,y.scaleAndAdd=Lf,y.set=function(l,s,c,f){return l[0]=s,l[1]=c,l[2]=f,l},y.setCacheLimits=function(l,s){es=l,Mo=s},y.setColumn=function(l,s,c){l[4*s+0]=c[0],l[4*s+1]=c[1],l[4*s+2]=c[2],l[4*s+3]=c[3]},y.setRTLTextPlugin=function(l,s,c=!1){if(Te===ue||Te===fe||Te===_e)throw new Error("setRTLTextPlugin cannot be called multiple times.");de=ur.resolveURL(l),Te=ue,ye=s,Re(),c||We()},y.smoothstep=Vt,y.spec=Rt,y.squaredLength=function(l){var s=l[0],c=l[1],f=l[2];return s*s+c*c+f*f},y.storeAuthState=function(l,s){s?tt.add(l):tt.delete(l)},y.sub=Ah,y.subtract=Gp,y.symbolSize=mx,y.tileAABB=function(l,s,c,f,v,C,S,R,N){if("globe"===N.name)return function vy(l,s,c){const f=s/l.worldSize,v=l.globeMatrix;if(c.z<=1){const St=Pl(c).getCorners();return lE(St,v,f),al.fromPoints(St)}const C=Nf(c),S=v0(C);lE(S,v,f);const R=Number.MAX_VALUE,N=[-R,-R,-R],U=[R,R,R];if(C.contains(l.center)){for(const Qt of S)qg(U,U,Qt),Dm(N,N,Qt);N[2]=0;const St=l.point,Gt=[St.x*f,St.y*f,0];return qg(U,U,Gt),Dm(N,N,Gt),new al(U,N)}const W=[v[12]*f,v[13]*f,v[14]*f],Q=C.getCenter(),ee=It(l.center.lat,-Da,Da),oe=It(Q.lat,-Da,Da),le=kh(l.center.lng),he=cc(ee);let Ie=le-kh(Q.lng);const Le=he-cc(oe);Ie>.5?Ie-=1:Ie<-.5&&(Ie+=1);let ve=0;Math.abs(Ie)>Math.abs(Le)?ve=Ie>=0?1:3:(ve=Le>=0?0:2,Lf(W,W,[v[4]*f,v[5]*f,v[6]*f],-Math.sin(it(Le>=0?C.getSouth():C.getNorth()))*Mh));const Pe=S[ve],He=S[(ve+1)%4],Be=new Uw(Pe,He,W),$e=[e_(Be,0)||Pe[0],e_(Be,1)||Pe[1],e_(Be,2)||Pe[2]],kt=Lm(l.zoom);if(kt>0){const St=function({x:Qt,y:Ft,z:Kt},Xt,un,pn,Bt){const In=1/(1<<Kt);let mi=Qt*In,Pn=mi+In,Kn=Ft*In,Mn=Kn+In,Yn=0;const Xi=(mi+Pn)/2-pn;return Xi>.5?Yn=-1:Xi<-.5&&(Yn=1),mi=((mi+Yn)*Xt-(pn*=Xt))*un+pn,Pn=((Pn+Yn)*Xt-pn)*un+pn,Kn=(Kn*Xt-(Bt*=Xt))*un+Bt,Mn=(Mn*Xt-Bt)*un+Bt,[[mi,Mn,0],[Pn,Mn,0],[Pn,Kn,0],[mi,Kn,0]]}(c,s,l._pixelsPerMercatorPixel,le,he);for(let Qt=0;Qt<S.length;Qt++)nh(S[Qt],St[Qt],kt);const Gt=bd([],St[ve],St[(ve+1)%4]);Rl(Gt,Gt,.5),nh($e,Gt,kt)}for(const St of S)qg(U,U,St),Dm(N,N,St);return U[2]=Math.min(Pe[2],He[2]),qg(U,U,$e),Dm(N,N,$e),new al(U,N)}(l,s,new d_(c,f,v));const U=Bs({z:c,x:f,y:v},N);return new al([(C+U.x/U.scale)*s,s*(U.y/U.scale),S],[(C+U.x2/U.scale)*s,s*(U.y2/U.scale),R])},y.tileCornersToBounds=Nf,y.tileTransform=Bs,y.transformMat3=function(l,s,c){var f=s[0],v=s[1],C=s[2];return l[0]=f*c[0]+v*c[3]+C*c[6],l[1]=f*c[1]+v*c[4]+C*c[7],l[2]=f*c[2]+v*c[5]+C*c[8],l},y.transformMat4=ds,y.transformMat4$1=Ff,y.transformQuat=Nw,y.transitionTileAABBinECEF=yy,y.translate=Hp,y.transpose=function(l,s){if(l===s){var c=s[1],f=s[2],v=s[5];l[1]=s[3],l[2]=s[6],l[3]=c,l[5]=s[7],l[6]=f,l[7]=v}else l[0]=s[0],l[1]=s[3],l[2]=s[6],l[3]=s[1],l[4]=s[4],l[5]=s[7],l[6]=s[2],l[7]=s[5],l[8]=s[8];return l},y.triggerPluginCompletionEvent=Oe,y.uniqueId=zi,y.updateGlobeVertexNormal=function(l,s,c,f,v){const C=5*s+2;l.float32[C+0]=c,l.float32[C+1]=f,l.float32[C+2]=v},y.validateCustomStyleLayer=function(l){const s=[],c=l.id;return void 0===c&&s.push({message:`layers.${c}: missing required property "id"`}),void 0===l.render&&s.push({message:`layers.${c}: missing required method "render"`}),l.renderingMode&&"2d"!==l.renderingMode&&"3d"!==l.renderingMode&&s.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),s},y.validateFilter=l=>Sl(qu(l)),y.validateFog=l=>Sl(Np(l)),y.validateLayer=l=>Sl(hd(l)),y.validateLight=l=>Sl(dd(l)),y.validateSource=l=>Sl(Sa(l)),y.validateStyle=Th,y.validateTerrain=l=>Sl(zc(l)),y.values=ir,y.vectorTile=My,y.version=ht,y.warnOnce=Ar,y.window=ze,y.wrap=wn}),Ct(0,function(y){function ze(re){if("number"==typeof re||"boolean"==typeof re||"string"==typeof re||null==re)return JSON.stringify(re);if(Array.isArray(re)){let ae="[";for(const we of re)ae+=`${ze(we)},`;return`${ae}]`}let ie="{";for(const ae of Object.keys(re).sort())ie+=`${ae}:${ze(re[ae])},`;return`${ie}}`}function ht(re){let ie="";for(const ae of y.refProperties)ie+=`/${ze(re[ae])}`;return ie}class qe{constructor(ie){this.keyCache={},ie&&this.replace(ie)}replace(ie){this._layerConfigs={},this._layers={},this.update(ie,[])}update(ie,ae){for(const De of ie)this._layerConfigs[De.id]=De,(this._layers[De.id]=y.createStyleLayer(De)).compileFilter(),this.keyCache[De.id]&&delete this.keyCache[De.id];for(const De of ae)delete this.keyCache[De],delete this._layerConfigs[De],delete this._layers[De];this.familiesBySource={};const we=function(De,Ve){const Ke={};for(let tt=0;tt<De.length;tt++){const rt=Ve&&Ve[De[tt].id]||ht(De[tt]);Ve&&(Ve[De[tt].id]=rt);let $t=Ke[rt];$t||($t=Ke[rt]=[]),$t.push(De[tt])}const ot=[];for(const tt in Ke)ot.push(Ke[tt]);return ot}(y.values(this._layerConfigs),this.keyCache);for(const De of we){const Ve=De.map(Dn=>this._layers[Dn.id]),Ke=Ve[0];if("none"===Ke.visibility)continue;const ot=Ke.source||"";let tt=this.familiesBySource[ot];tt||(tt=this.familiesBySource[ot]={});const rt=Ke.sourceLayer||"_geojsonTileLayer";let $t=tt[rt];$t||($t=tt[rt]=[]),$t.push(Ve)}}}class Ne{loadTile(ie,ae){const{uid:we,encoding:De,rawImageData:Ve,padding:Ke,buildQuadTree:ot}=ie,tt=y.window.ImageBitmap&&Ve instanceof y.window.ImageBitmap?this.getImageData(Ve,Ke):Ve;ae(null,new y.DEMData(we,tt,De,Ke<1,ot))}getImageData(ie,ae){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ie.width,ie.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ie.width,this.offscreenCanvas.height=ie.height,this.offscreenCanvasContext.drawImage(ie,0,0,ie.width,ie.height);const we=this.offscreenCanvasContext.getImageData(-ae,-ae,ie.width+2*ae,ie.height+2*ae);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),we}}var nt=function re(ie,ae){var we,De=ie&&ie.type;if("FeatureCollection"===De)for(we=0;we<ie.features.length;we++)re(ie.features[we],ae);else if("GeometryCollection"===De)for(we=0;we<ie.geometries.length;we++)re(ie.geometries[we],ae);else if("Feature"===De)re(ie.geometry,ae);else if("Polygon"===De)fn(ie.coordinates,ae);else if("MultiPolygon"===De)for(we=0;we<ie.coordinates.length;we++)fn(ie.coordinates[we],ae);return ie};function fn(re,ie){if(0!==re.length){ft(re[0],ie);for(var ae=1;ae<re.length;ae++)ft(re[ae],!ie)}}function ft(re,ie){for(var ae=0,we=0,De=0,Ve=re.length,Ke=Ve-1;De<Ve;Ke=De++){var ot=(re[De][0]-re[Ke][0])*(re[Ke][1]+re[De][1]),tt=ae+ot;we+=Math.abs(ae)>=Math.abs(ot)?ae-tt+ot:ot-tt+ae,ae=tt}ae+we>=0!=!!ie&&re.reverse()}const ln=y.VectorTileFeature.prototype.toGeoJSON;class Ze{constructor(ie){this._feature=ie,this.extent=y.EXTENT,this.type=ie.type,this.properties=ie.tags,"id"in ie&&!isNaN(ie.id)&&(this.id=parseInt(ie.id,10))}loadGeometry(){if(1===this._feature.type){const ie=[];for(const ae of this._feature.geometry)ie.push([new y.pointGeometry(ae[0],ae[1])]);return ie}{const ie=[];for(const ae of this._feature.geometry){const we=[];for(const De of ae)we.push(new y.pointGeometry(De[0],De[1]));ie.push(we)}return ie}}toGeoJSON(ie,ae,we){return ln.call(this,ie,ae,we)}}class Je{constructor(ie){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=y.EXTENT,this.length=ie.length,this._features=ie}feature(ie){return new Ze(this._features[ie])}}var dt={},Ot={get exports(){return dt},set exports(re){dt=re}},Jt=y.pointGeometry,st=y.vectorTile.VectorTileFeature,Zt=nn;function nn(re,ie){this.options=ie||{},this.features=re,this.length=re.length}function yn(re,ie){this.id="number"==typeof re.id?re.id:void 0,this.type=re.type,this.rawGeometry=1===re.type?[re.geometry]:re.geometry,this.properties=re.tags,this.extent=ie||4096}nn.prototype.feature=function(re){return new yn(this.features[re],this.options.extent)},yn.prototype.loadGeometry=function(){var re=this.rawGeometry;this.geometry=[];for(var ie=0;ie<re.length;ie++){for(var ae=re[ie],we=[],De=0;De<ae.length;De++)we.push(new Jt(ae[De][0],ae[De][1]));this.geometry.push(we)}return this.geometry},yn.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var re=this.geometry,ie=1/0,ae=-1/0,we=1/0,De=-1/0,Ve=0;Ve<re.length;Ve++)for(var Ke=re[Ve],ot=0;ot<Ke.length;ot++){var tt=Ke[ot];ie=Math.min(ie,tt.x),ae=Math.max(ae,tt.x),we=Math.min(we,tt.y),De=Math.max(De,tt.y)}return[ie,we,ae,De]},yn.prototype.toGeoJSON=st.prototype.toGeoJSON;var it=y.pbf,zt=Zt;function en(re){var ie=new it;return function(ae,we){for(var De in ae.layers)we.writeMessage(3,gt,ae.layers[De])}(re,ie),ie.finish()}function gt(re,ie){var ae;ie.writeVarintField(15,re.version||1),ie.writeStringField(1,re.name||""),ie.writeVarintField(5,re.extent||4096);var we={keys:[],values:[],keycache:{},valuecache:{}};for(ae=0;ae<re.length;ae++)we.feature=re.feature(ae),ie.writeMessage(2,xt,we);var De=we.keys;for(ae=0;ae<De.length;ae++)ie.writeStringField(3,De[ae]);var Ve=we.values;for(ae=0;ae<Ve.length;ae++)ie.writeMessage(4,ai,Ve[ae])}function xt(re,ie){var ae=re.feature;void 0!==ae.id&&ie.writeVarintField(1,ae.id),ie.writeMessage(2,Lt,re),ie.writeVarintField(3,ae.type),ie.writeMessage(4,wn,ae)}function Lt(re,ie){var ae=re.feature,we=re.keys,De=re.values,Ve=re.keycache,Ke=re.valuecache;for(var ot in ae.properties){var tt=ae.properties[ot],rt=Ve[ot];if(null!==tt){void 0===rt&&(we.push(ot),Ve[ot]=rt=we.length-1),ie.writeVarint(rt);var $t=typeof tt;"string"!==$t&&"boolean"!==$t&&"number"!==$t&&(tt=JSON.stringify(tt));var Dn=$t+":"+tt,cn=Ke[Dn];void 0===cn&&(De.push(tt),Ke[Dn]=cn=De.length-1),ie.writeVarint(cn)}}}function It(re,ie){return(ie<<3)+(7&re)}function Vt(re){return re<<1^re>>31}function wn(re,ie){for(var ae=re.loadGeometry(),we=re.type,De=0,Ve=0,Ke=ae.length,ot=0;ot<Ke;ot++){var tt=ae[ot],rt=1;1===we&&(rt=tt.length),ie.writeVarint(It(1,rt));for(var $t=3===we?tt.length-1:tt.length,Dn=0;Dn<$t;Dn++){1===Dn&&1!==we&&ie.writeVarint(It(2,$t-1));var cn=tt[Dn].x-De,ni=tt[Dn].y-Ve;ie.writeVarint(Vt(cn)),ie.writeVarint(Vt(ni)),De+=cn,Ve+=ni}3===we&&ie.writeVarint(It(7,1))}}function ai(re,ie){var ae=typeof re;"string"===ae?ie.writeStringField(1,re):"boolean"===ae?ie.writeBooleanField(7,re):"number"===ae&&(re%1!=0?ie.writeDoubleField(3,re):re<0?ie.writeSVarintField(6,re):ie.writeVarintField(5,re))}function ir(re,ie,ae,we,De,Ve){if(De-we<=ae)return;const Ke=we+De>>1;Ni(re,ie,Ke,we,De,Ve%2),ir(re,ie,ae,we,Ke-1,Ve+1),ir(re,ie,ae,Ke+1,De,Ve+1)}function Ni(re,ie,ae,we,De,Ve){for(;De>we;){if(De-we>600){const rt=De-we+1,$t=ae-we+1,Dn=Math.log(rt),cn=.5*Math.exp(2*Dn/3),ni=.5*Math.sqrt(Dn*cn*(rt-cn)/rt)*($t-rt/2<0?-1:1);Ni(re,ie,ae,Math.max(we,Math.floor(ae-$t*cn/rt+ni)),Math.min(De,Math.floor(ae+(rt-$t)*cn/rt+ni)),Ve)}const Ke=ie[2*ae+Ve];let ot=we,tt=De;for(vi(re,ie,we,ae),ie[2*De+Ve]>Ke&&vi(re,ie,we,De);ot<tt;){for(vi(re,ie,ot,tt),ot++,tt--;ie[2*ot+Ve]<Ke;)ot++;for(;ie[2*tt+Ve]>Ke;)tt--}ie[2*we+Ve]===Ke?vi(re,ie,we,tt):(tt++,vi(re,ie,tt,De)),tt<=ae&&(we=tt+1),ae<=tt&&(De=tt-1)}}function vi(re,ie,ae,we){zi(re,ae,we),zi(ie,2*ae,2*we),zi(ie,2*ae+1,2*we+1)}function zi(re,ie,ae){const we=re[ie];re[ie]=re[ae],re[ae]=we}function ri(re,ie,ae,we){const De=re-ae,Ve=ie-we;return De*De+Ve*Ve}Ot.exports=en,dt.fromVectorTileJs=en,dt.fromGeojsonVt=function(re,ie){ie=ie||{};var ae={};for(var we in re)ae[we]=new zt(re[we].features,ie),ae[we].name=we,ae[we].version=ie.version,ae[we].extent=ie.extent;return en({layers:ae})},dt.GeoJSONWrapper=zt;const or=re=>re[0],Bo=re=>re[1];class $i{constructor(ie,ae=or,we=Bo,De=64,Ve=Float64Array){this.nodeSize=De,this.points=ie;const Ke=ie.length<65536?Uint16Array:Uint32Array,ot=this.ids=new Ke(ie.length),tt=this.coords=new Ve(2*ie.length);for(let rt=0;rt<ie.length;rt++)ot[rt]=rt,tt[2*rt]=ae(ie[rt]),tt[2*rt+1]=we(ie[rt]);ir(ot,tt,De,0,ot.length-1,0)}range(ie,ae,we,De){return function(Ve,Ke,ot,tt,rt,$t,Dn){const cn=[0,Ve.length-1,0],ni=[];let Xn,Nn;for(;cn.length;){const di=cn.pop(),Li=cn.pop(),ur=cn.pop();if(Li-ur<=Dn){for(let ci=ur;ci<=Li;ci++)Xn=Ke[2*ci],Nn=Ke[2*ci+1],Xn>=ot&&Xn<=rt&&Nn>=tt&&Nn<=$t&&ni.push(Ve[ci]);continue}const li=Math.floor((ur+Li)/2);Xn=Ke[2*li],Nn=Ke[2*li+1],Xn>=ot&&Xn<=rt&&Nn>=tt&&Nn<=$t&&ni.push(Ve[li]);const vr=(di+1)%2;(0===di?ot<=Xn:tt<=Nn)&&(cn.push(ur),cn.push(li-1),cn.push(vr)),(0===di?rt>=Xn:$t>=Nn)&&(cn.push(li+1),cn.push(Li),cn.push(vr))}return ni}(this.ids,this.coords,ie,ae,we,De,this.nodeSize)}within(ie,ae,we){return function(De,Ve,Ke,ot,tt,rt){const $t=[0,De.length-1,0],Dn=[],cn=tt*tt;for(;$t.length;){const ni=$t.pop(),Xn=$t.pop(),Nn=$t.pop();if(Xn-Nn<=rt){for(let vr=Nn;vr<=Xn;vr++)ri(Ve[2*vr],Ve[2*vr+1],Ke,ot)<=cn&&Dn.push(De[vr]);continue}const di=Math.floor((Nn+Xn)/2),Li=Ve[2*di],ur=Ve[2*di+1];ri(Li,ur,Ke,ot)<=cn&&Dn.push(De[di]);const li=(ni+1)%2;(0===ni?Ke-tt<=Li:ot-tt<=ur)&&($t.push(Nn),$t.push(di-1),$t.push(li)),(0===ni?Ke+tt>=Li:ot+tt>=ur)&&($t.push(di+1),$t.push(Xn),$t.push(li))}return Dn}(this.ids,this.coords,ie,ae,we,this.nodeSize)}}const bi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:re=>re},Gr=Math.fround||(Vo=new Float32Array(1),re=>(Vo[0]=+re,Vo[0]));var Vo;class $r{constructor(ie){this.options=Ao(Object.create(bi),ie),this.trees=new Array(this.options.maxZoom+1)}load(ie){const{log:ae,minZoom:we,maxZoom:De,nodeSize:Ve}=this.options;ae&&console.time("total time");const Ke=`prepare ${ie.length} points`;ae&&console.time(Ke),this.points=ie;let ot=[];for(let tt=0;tt<ie.length;tt++)ie[tt].geometry&&ot.push(Ar(ie[tt],tt));this.trees[De+1]=new $i(ot,Pr,jn,Ve,Float32Array),ae&&console.timeEnd(Ke);for(let tt=De;tt>=we;tt--){const rt=+Date.now();ot=this._cluster(ot,tt),this.trees[tt]=new $i(ot,Pr,jn,Ve,Float32Array),ae&&console.log("z%d: %d clusters in %dms",tt,ot.length,+Date.now()-rt)}return ae&&console.timeEnd("total time"),this}getClusters(ie,ae){let we=((ie[0]+180)%360+360)%360-180;const De=Math.max(-90,Math.min(90,ie[1]));let Ve=180===ie[2]?180:((ie[2]+180)%360+360)%360-180;const Ke=Math.max(-90,Math.min(90,ie[3]));if(ie[2]-ie[0]>=360)we=-180,Ve=180;else if(we>Ve){const $t=this.getClusters([we,De,180,Ke],ae),Dn=this.getClusters([-180,De,Ve,Ke],ae);return $t.concat(Dn)}const ot=this.trees[this._limitZoom(ae)],tt=ot.range(Rr(we),Xo(Ke),Rr(Ve),Xo(De)),rt=[];for(const $t of tt){const Dn=ot.points[$t];rt.push(Dn.numPoints?ys(Dn):this.points[Dn.index])}return rt}getChildren(ie){const ae=this._getOriginId(ie),we=this._getOriginZoom(ie),De="No cluster with the specified id.",Ve=this.trees[we];if(!Ve)throw new Error(De);const Ke=Ve.points[ae];if(!Ke)throw new Error(De);const ot=this.options.radius/(this.options.extent*Math.pow(2,we-1)),tt=Ve.within(Ke.x,Ke.y,ot),rt=[];for(const $t of tt){const Dn=Ve.points[$t];Dn.parentId===ie&&rt.push(Dn.numPoints?ys(Dn):this.points[Dn.index])}if(0===rt.length)throw new Error(De);return rt}getLeaves(ie,ae,we){const De=[];return this._appendLeaves(De,ie,ae=ae||10,we=we||0,0),De}getTile(ie,ae,we){const De=this.trees[this._limitZoom(ie)],Ve=Math.pow(2,ie),{extent:Ke,radius:ot}=this.options,tt=ot/Ke,rt=(we-tt)/Ve,$t=(we+1+tt)/Ve,Dn={features:[]};return this._addTileFeatures(De.range((ae-tt)/Ve,rt,(ae+1+tt)/Ve,$t),De.points,ae,we,Ve,Dn),0===ae&&this._addTileFeatures(De.range(1-tt/Ve,rt,1,$t),De.points,Ve,we,Ve,Dn),ae===Ve-1&&this._addTileFeatures(De.range(0,rt,tt/Ve,$t),De.points,-1,we,Ve,Dn),Dn.features.length?Dn:null}getClusterExpansionZoom(ie){let ae=this._getOriginZoom(ie)-1;for(;ae<=this.options.maxZoom;){const we=this.getChildren(ie);if(ae++,1!==we.length)break;ie=we[0].properties.cluster_id}return ae}_appendLeaves(ie,ae,we,De,Ve){const Ke=this.getChildren(ae);for(const ot of Ke){const tt=ot.properties;if(tt&&tt.cluster?Ve+tt.point_count<=De?Ve+=tt.point_count:Ve=this._appendLeaves(ie,tt.cluster_id,we,De,Ve):Ve<De?Ve++:ie.push(ot),ie.length===we)break}return Ve}_addTileFeatures(ie,ae,we,De,Ve,Ke){for(const ot of ie){const tt=ae[ot],rt=tt.numPoints;let $t,Dn,cn;if(rt)$t=qi(tt),Dn=tt.x,cn=tt.y;else{const Nn=this.points[tt.index];$t=Nn.properties,Dn=Rr(Nn.geometry.coordinates[0]),cn=Xo(Nn.geometry.coordinates[1])}const ni={type:1,geometry:[[Math.round(this.options.extent*(Dn*Ve-we)),Math.round(this.options.extent*(cn*Ve-De))]],tags:$t};let Xn;rt?Xn=tt.id:this.options.generateId?Xn=tt.index:this.points[tt.index].id&&(Xn=this.points[tt.index].id),void 0!==Xn&&(ni.id=Xn),Ke.features.push(ni)}}_limitZoom(ie){return Math.max(this.options.minZoom,Math.min(Math.floor(+ie),this.options.maxZoom+1))}_cluster(ie,ae){const we=[],{radius:De,extent:Ve,reduce:Ke,minPoints:ot}=this.options,tt=De/(Ve*Math.pow(2,ae));for(let rt=0;rt<ie.length;rt++){const $t=ie[rt];if($t.zoom<=ae)continue;$t.zoom=ae;const Dn=this.trees[ae+1],cn=Dn.within($t.x,$t.y,tt),ni=$t.numPoints||1;let Xn=ni;for(const Nn of cn){const di=Dn.points[Nn];di.zoom>ae&&(Xn+=di.numPoints||1)}if(Xn>ni&&Xn>=ot){let Nn=$t.x*ni,di=$t.y*ni,Li=Ke&&ni>1?this._map($t,!0):null;const ur=(rt<<5)+(ae+1)+this.points.length;for(const li of cn){const vr=Dn.points[li];if(vr.zoom<=ae)continue;vr.zoom=ae;const ci=vr.numPoints||1;Nn+=vr.x*ci,di+=vr.y*ci,vr.parentId=ur,Ke&&(Li||(Li=this._map($t,!0)),Ke(Li,this._map(vr)))}$t.parentId=ur,we.push(fo(Nn/Xn,di/Xn,ur,Xn,Li))}else if(we.push($t),Xn>1)for(const Nn of cn){const di=Dn.points[Nn];di.zoom<=ae||(di.zoom=ae,we.push(di))}}return we}_getOriginId(ie){return ie-this.points.length>>5}_getOriginZoom(ie){return(ie-this.points.length)%32}_map(ie,ae){if(ie.numPoints)return ae?Ao({},ie.properties):ie.properties;const we=this.points[ie.index].properties,De=this.options.map(we);return ae&&De===we?Ao({},De):De}}function fo(re,ie,ae,we,De){return{x:Gr(re),y:Gr(ie),zoom:1/0,id:ae,parentId:-1,numPoints:we,properties:De}}function Ar(re,ie){const[ae,we]=re.geometry.coordinates;return{x:Gr(Rr(ae)),y:Gr(Xo(we)),zoom:1/0,index:ie,parentId:-1}}function ys(re){return{type:"Feature",id:re.id,properties:qi(re),geometry:{type:"Point",coordinates:[(ie=re.x,360*(ie-.5)),Gs(re.y)]}};var ie}function qi(re){const ie=re.numPoints,ae=ie>=1e4?`${Math.round(ie/1e3)}k`:ie>=1e3?Math.round(ie/100)/10+"k":ie;return Ao(Ao({},re.properties),{cluster:!0,cluster_id:re.id,point_count:ie,point_count_abbreviated:ae})}function Rr(re){return re/360+.5}function Xo(re){const ie=Math.sin(re*Math.PI/180),ae=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return ae<0?0:ae>1?1:ae}function Gs(re){const ie=(180-360*re)*Math.PI/180;return 360*Math.atan(Math.exp(ie))/Math.PI-90}function Ao(re,ie){for(const ae in ie)re[ae]=ie[ae];return re}function Pr(re){return re.x}function jn(re){return re.y}function Uo(re,ie,ae,we){for(var De,Ve=we,Ke=ae-ie>>1,ot=ae-ie,tt=re[ie],rt=re[ie+1],$t=re[ae],Dn=re[ae+1],cn=ie+3;cn<ae;cn+=3){var ni=lo(re[cn],re[cn+1],tt,rt,$t,Dn);if(ni>Ve)De=cn,Ve=ni;else if(ni===Ve){var Xn=Math.abs(cn-Ke);Xn<ot&&(De=cn,ot=Xn)}}Ve>we&&(De-ie>3&&Uo(re,ie,De,we),re[De+2]=Ve,ae-De>3&&Uo(re,De,ae,we))}function lo(re,ie,ae,we,De,Ve){var Ke=De-ae,ot=Ve-we;if(0!==Ke||0!==ot){var tt=((re-ae)*Ke+(ie-we)*ot)/(Ke*Ke+ot*ot);tt>1?(ae=De,we=Ve):tt>0&&(ae+=Ke*tt,we+=ot*tt)}return(Ke=re-ae)*Ke+(ot=ie-we)*ot}function Wr(re,ie,ae,we){var De={id:void 0===re?null:re,type:ie,geometry:ae,tags:we,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ve){var Ke=Ve.geometry,ot=Ve.type;if("Point"===ot||"MultiPoint"===ot||"LineString"===ot)es(Ve,Ke);else if("Polygon"===ot||"MultiLineString"===ot)for(var tt=0;tt<Ke.length;tt++)es(Ve,Ke[tt]);else if("MultiPolygon"===ot)for(tt=0;tt<Ke.length;tt++)for(var rt=0;rt<Ke[tt].length;rt++)es(Ve,Ke[tt][rt])}(De),De}function es(re,ie){for(var ae=0;ae<ie.length;ae+=3)re.minX=Math.min(re.minX,ie[ae]),re.minY=Math.min(re.minY,ie[ae+1]),re.maxX=Math.max(re.maxX,ie[ae]),re.maxY=Math.max(re.maxY,ie[ae+1])}function Mo(re,ie,ae,we){if(ie.geometry){var De=ie.geometry.coordinates,Ve=ie.geometry.type,Ke=Math.pow(ae.tolerance/((1<<ae.maxZoom)*ae.extent),2),ot=[],tt=ie.id;if(ae.promoteId?tt=ie.properties[ae.promoteId]:ae.generateId&&(tt=we||0),"Point"===Ve)wr(De,ot);else if("MultiPoint"===Ve)for(var rt=0;rt<De.length;rt++)wr(De[rt],ot);else if("LineString"===Ve)yr(De,ot,Ke,!1);else if("MultiLineString"===Ve){if(ae.lineMetrics){for(rt=0;rt<De.length;rt++)yr(De[rt],ot=[],Ke,!1),re.push(Wr(tt,"LineString",ot,ie.properties));return}ui(De,ot,Ke,!1)}else if("Polygon"===Ve)ui(De,ot,Ke,!0);else{if("MultiPolygon"!==Ve){if("GeometryCollection"===Ve){for(rt=0;rt<ie.geometry.geometries.length;rt++)Mo(re,{id:tt,geometry:ie.geometry.geometries[rt],properties:ie.properties},ae,we);return}throw new Error("Input data is not a valid GeoJSON object.")}for(rt=0;rt<De.length;rt++){var $t=[];ui(De[rt],$t,Ke,!0),ot.push($t)}}re.push(Wr(tt,Ve,ot,ie.properties))}}function wr(re,ie){ie.push(Wn(re[0])),ie.push(ts(re[1])),ie.push(0)}function yr(re,ie,ae,we){for(var De,Ve,Ke=0,ot=0;ot<re.length;ot++){var tt=Wn(re[ot][0]),rt=ts(re[ot][1]);ie.push(tt),ie.push(rt),ie.push(0),ot>0&&(Ke+=we?(De*rt-tt*Ve)/2:Math.sqrt(Math.pow(tt-De,2)+Math.pow(rt-Ve,2))),De=tt,Ve=rt}var $t=ie.length-3;ie[2]=1,Uo(ie,0,$t,ae),ie[$t+2]=1,ie.size=Math.abs(Ke),ie.start=0,ie.end=ie.size}function ui(re,ie,ae,we){for(var De=0;De<re.length;De++){var Ve=[];yr(re[De],Ve,ae,we),ie.push(Ve)}}function Wn(re){return re/360+.5}function ts(re){var ie=Math.sin(re*Math.PI/180),ae=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return ae<0?0:ae>1?1:ae}function Ur(re,ie,ae,we,De,Ve,Ke,ot){if(we/=ie,Ve>=(ae/=ie)&&Ke<we)return re;if(Ke<ae||Ve>=we)return null;for(var tt=[],rt=0;rt<re.length;rt++){var $t=re[rt],Dn=$t.geometry,cn=$t.type,ni=0===De?$t.minX:$t.minY,Xn=0===De?$t.maxX:$t.maxY;if(ni>=ae&&Xn<we)tt.push($t);else if(!(Xn<ae||ni>=we)){var Nn=[];if("Point"===cn||"MultiPoint"===cn)Ho(Dn,Nn,ae,we,De);else if("LineString"===cn)vs(Dn,Nn,ae,we,De,!1,ot.lineMetrics);else if("MultiLineString"===cn)co(Dn,Nn,ae,we,De,!1);else if("Polygon"===cn)co(Dn,Nn,ae,we,De,!0);else if("MultiPolygon"===cn)for(var di=0;di<Dn.length;di++){var Li=[];co(Dn[di],Li,ae,we,De,!0),Li.length&&Nn.push(Li)}if(Nn.length){if(ot.lineMetrics&&"LineString"===cn){for(di=0;di<Nn.length;di++)tt.push(Wr($t.id,cn,Nn[di],$t.tags));continue}"LineString"!==cn&&"MultiLineString"!==cn||(1===Nn.length?(cn="LineString",Nn=Nn[0]):cn="MultiLineString"),"Point"!==cn&&"MultiPoint"!==cn||(cn=3===Nn.length?"Point":"MultiPoint"),tt.push(Wr($t.id,cn,Nn,$t.tags))}}}return tt.length?tt:null}function Ho(re,ie,ae,we,De){for(var Ve=0;Ve<re.length;Ve+=3){var Ke=re[Ve+De];Ke>=ae&&Ke<=we&&(ie.push(re[Ve]),ie.push(re[Ve+1]),ie.push(re[Ve+2]))}}function vs(re,ie,ae,we,De,Ve,Ke){for(var ot,tt,rt=Jr(re),$t=0===De?cs:Bi,Dn=re.start,cn=0;cn<re.length-3;cn+=3){var ni=re[cn],Xn=re[cn+1],Nn=re[cn+2],di=re[cn+3],Li=re[cn+4],ur=0===De?ni:Xn,li=0===De?di:Li,vr=!1;Ke&&(ot=Math.sqrt(Math.pow(ni-di,2)+Math.pow(Xn-Li,2))),ur<ae?li>ae&&(tt=$t(rt,ni,Xn,di,Li,ae),Ke&&(rt.start=Dn+ot*tt)):ur>we?li<we&&(tt=$t(rt,ni,Xn,di,Li,we),Ke&&(rt.start=Dn+ot*tt)):mr(rt,ni,Xn,Nn),li<ae&&ur>=ae&&(tt=$t(rt,ni,Xn,di,Li,ae),vr=!0),li>we&&ur<=we&&(tt=$t(rt,ni,Xn,di,Li,we),vr=!0),!Ve&&vr&&(Ke&&(rt.end=Dn+ot*tt),ie.push(rt),rt=Jr(re)),Ke&&(Dn+=ot)}var ci=re.length-3;ni=re[ci],Xn=re[ci+1],Nn=re[ci+2],(ur=0===De?ni:Xn)>=ae&&ur<=we&&mr(rt,ni,Xn,Nn),ci=rt.length-3,Ve&&ci>=3&&(rt[ci]!==rt[0]||rt[ci+1]!==rt[1])&&mr(rt,rt[0],rt[1],rt[2]),rt.length&&ie.push(rt)}function Jr(re){var ie=[];return ie.size=re.size,ie.start=re.start,ie.end=re.end,ie}function co(re,ie,ae,we,De,Ve){for(var Ke=0;Ke<re.length;Ke++)vs(re[Ke],ie,ae,we,De,Ve,!1)}function mr(re,ie,ae,we){re.push(ie),re.push(ae),re.push(we)}function cs(re,ie,ae,we,De,Ve){var Ke=(Ve-ie)/(we-ie);return re.push(Ve),re.push(ae+(De-ae)*Ke),re.push(1),Ke}function Bi(re,ie,ae,we,De,Ve){var Ke=(Ve-ae)/(De-ae);return re.push(ie+(we-ie)*Ke),re.push(Ve),re.push(1),Ke}function qo(re,ie){for(var ae=[],we=0;we<re.length;we++){var De,Ve=re[we],Ke=Ve.type;if("Point"===Ke||"MultiPoint"===Ke||"LineString"===Ke)De=En(Ve.geometry,ie);else if("MultiLineString"===Ke||"Polygon"===Ke){De=[];for(var ot=0;ot<Ve.geometry.length;ot++)De.push(En(Ve.geometry[ot],ie))}else if("MultiPolygon"===Ke)for(De=[],ot=0;ot<Ve.geometry.length;ot++){for(var tt=[],rt=0;rt<Ve.geometry[ot].length;rt++)tt.push(En(Ve.geometry[ot][rt],ie));De.push(tt)}ae.push(Wr(Ve.id,Ke,De,Ve.tags))}return ae}function En(re,ie){var ae=[];ae.size=re.size,void 0!==re.start&&(ae.start=re.start,ae.end=re.end);for(var we=0;we<re.length;we+=3)ae.push(re[we]+ie,re[we+1],re[we+2]);return ae}function rn(re,ie){if(re.transformed)return re;var ae,we,De,Ve=1<<re.z,Ke=re.x,ot=re.y;for(ae=0;ae<re.features.length;ae++){var tt=re.features[ae],rt=tt.geometry,$t=tt.type;if(tt.geometry=[],1===$t)for(we=0;we<rt.length;we+=2)tt.geometry.push(zn(rt[we],rt[we+1],ie,Ve,Ke,ot));else for(we=0;we<rt.length;we++){var Dn=[];for(De=0;De<rt[we].length;De+=2)Dn.push(zn(rt[we][De],rt[we][De+1],ie,Ve,Ke,ot));tt.geometry.push(Dn)}}return re.transformed=!0,re}function zn(re,ie,ae,we,De,Ve){return[Math.round(ae*(re*we-De)),Math.round(ae*(ie*we-Ve))]}function wi(re,ie,ae,we,De){for(var Ve=ie===De.maxZoom?0:De.tolerance/((1<<ie)*De.extent),Ke={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ae,y:we,z:ie,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ot=0;ot<re.length;ot++){Ke.numFeatures++,Di(Ke,re[ot],Ve,De);var tt=re[ot].minX,rt=re[ot].minY,$t=re[ot].maxX,Dn=re[ot].maxY;tt<Ke.minX&&(Ke.minX=tt),rt<Ke.minY&&(Ke.minY=rt),$t>Ke.maxX&&(Ke.maxX=$t),Dn>Ke.maxY&&(Ke.maxY=Dn)}return Ke}function Di(re,ie,ae,we){var De=ie.geometry,Ve=ie.type,Ke=[];if("Point"===Ve||"MultiPoint"===Ve)for(var ot=0;ot<De.length;ot+=3)Ke.push(De[ot]),Ke.push(De[ot+1]),re.numPoints++,re.numSimplified++;else if("LineString"===Ve)er(Ke,De,re,ae,!1,!1);else if("MultiLineString"===Ve||"Polygon"===Ve)for(ot=0;ot<De.length;ot++)er(Ke,De[ot],re,ae,"Polygon"===Ve,0===ot);else if("MultiPolygon"===Ve)for(var tt=0;tt<De.length;tt++){var rt=De[tt];for(ot=0;ot<rt.length;ot++)er(Ke,rt[ot],re,ae,!0,0===ot)}if(Ke.length){var $t=ie.tags||null;if("LineString"===Ve&&we.lineMetrics){for(var Dn in $t={},ie.tags)$t[Dn]=ie.tags[Dn];$t.mapbox_clip_start=De.start/De.size,$t.mapbox_clip_end=De.end/De.size}var cn={geometry:Ke,type:"Polygon"===Ve||"MultiPolygon"===Ve?3:"LineString"===Ve||"MultiLineString"===Ve?2:1,tags:$t};null!==ie.id&&(cn.id=ie.id),re.features.push(cn)}}function er(re,ie,ae,we,De,Ve){var Ke=we*we;if(we>0&&ie.size<(De?Ke:we))ae.numPoints+=ie.length/3;else{for(var ot=[],tt=0;tt<ie.length;tt+=3)(0===we||ie[tt+2]>Ke)&&(ae.numSimplified++,ot.push(ie[tt]),ot.push(ie[tt+1])),ae.numPoints++;De&&function(rt,$t){for(var Dn=0,cn=0,ni=rt.length,Xn=ni-2;cn<ni;Xn=cn,cn+=2)Dn+=(rt[cn]-rt[Xn])*(rt[cn+1]+rt[Xn+1]);if(Dn>0===$t)for(cn=0,ni=rt.length;cn<ni/2;cn+=2){var Nn=rt[cn],di=rt[cn+1];rt[cn]=rt[ni-2-cn],rt[cn+1]=rt[ni-1-cn],rt[ni-2-cn]=Nn,rt[ni-1-cn]=di}}(ot,Ve),re.push(ot)}}function Qe(re,ie){var ae=(ie=this.options=function(De,Ve){for(var Ke in Ve)De[Ke]=Ve[Ke];return De}(Object.create(this.options),ie)).debug;if(ae&&console.time("preprocess data"),ie.maxZoom<0||ie.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ie.promoteId&&ie.generateId)throw new Error("promoteId and generateId cannot be used together.");var De,Ve,Ke,ot,tt,rt,we=function(De,Ve){var Ke=[];if("FeatureCollection"===De.type)for(var ot=0;ot<De.features.length;ot++)Mo(Ke,De.features[ot],Ve,ot);else Mo(Ke,"Feature"===De.type?De:{geometry:De},Ve);return Ke}(re,ie);this.tiles={},this.tileCoords=[],ae&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ie.indexMaxZoom,ie.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ot=De=we,tt=Ur(De,1,-1-(Ke=(Ve=ie).buffer/Ve.extent),Ke,0,-1,2,Ve),rt=Ur(De,1,1-Ke,2+Ke,0,-1,2,Ve),(tt||rt)&&(ot=Ur(De,1,-Ke,1+Ke,0,-1,2,Ve)||[],tt&&(ot=qo(tt,1).concat(ot)),rt&&(ot=ot.concat(qo(rt,-1)))),(we=ot).length&&this.splitTile(we,0,0,0),ae&&(we.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function je(re,ie,ae){return 32*((1<<re)*ae+ie)+re}function at(re,ie){const ae=re.tileID.canonical;if(!this._geoJSONIndex)return ie(null,null);const we=this._geoJSONIndex.getTile(ae.z,ae.x,ae.y);if(!we)return ie(null,null);const De=new Je(we.features);let Ve=dt(De);0===Ve.byteOffset&&Ve.byteLength===Ve.buffer.byteLength||(Ve=new Uint8Array(Ve)),ie(null,{vectorTile:De,rawData:Ve.buffer})}Qe.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Qe.prototype.splitTile=function(re,ie,ae,we,De,Ve,Ke){for(var ot=[re,ie,ae,we],tt=this.options,rt=tt.debug;ot.length;){we=ot.pop(),ae=ot.pop(),ie=ot.pop(),re=ot.pop();var $t=1<<ie,Dn=je(ie,ae,we),cn=this.tiles[Dn];if(!cn&&(rt>1&&console.time("creation"),cn=this.tiles[Dn]=wi(re,ie,ae,we,tt),this.tileCoords.push({z:ie,x:ae,y:we}),rt)){rt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ie,ae,we,cn.numFeatures,cn.numPoints,cn.numSimplified),console.timeEnd("creation"));var ni="z"+ie;this.stats[ni]=(this.stats[ni]||0)+1,this.total++}if(cn.source=re,De){if(ie===tt.maxZoom||ie===De)continue;var Xn=1<<De-ie;if(ae!==Math.floor(Ve/Xn)||we!==Math.floor(Ke/Xn))continue}else if(ie===tt.indexMaxZoom||cn.numPoints<=tt.indexMaxPoints)continue;if(cn.source=null,0!==re.length){rt>1&&console.time("clipping");var Nn,di,Li,ur,li,vr,ci=.5*tt.buffer/tt.extent,Mr=.5-ci,mo=.5+ci,Rt=1+ci;Nn=di=Li=ur=null,li=Ur(re,$t,ae-ci,ae+mo,0,cn.minX,cn.maxX,tt),vr=Ur(re,$t,ae+Mr,ae+Rt,0,cn.minX,cn.maxX,tt),re=null,li&&(Nn=Ur(li,$t,we-ci,we+mo,1,cn.minY,cn.maxY,tt),di=Ur(li,$t,we+Mr,we+Rt,1,cn.minY,cn.maxY,tt),li=null),vr&&(Li=Ur(vr,$t,we-ci,we+mo,1,cn.minY,cn.maxY,tt),ur=Ur(vr,$t,we+Mr,we+Rt,1,cn.minY,cn.maxY,tt),vr=null),rt>1&&console.timeEnd("clipping"),ot.push(Nn||[],ie+1,2*ae,2*we),ot.push(di||[],ie+1,2*ae,2*we+1),ot.push(Li||[],ie+1,2*ae+1,2*we),ot.push(ur||[],ie+1,2*ae+1,2*we+1)}}},Qe.prototype.getTile=function(re,ie,ae){var we=this.options,De=we.extent,Ve=we.debug;if(re<0||re>24)return null;var Ke=1<<re,ot=je(re,ie=(ie%Ke+Ke)%Ke,ae);if(this.tiles[ot])return rn(this.tiles[ot],De);Ve>1&&console.log("drilling down to z%d-%d-%d",re,ie,ae);for(var tt,rt=re,$t=ie,Dn=ae;!tt&&rt>0;)rt--,$t=Math.floor($t/2),Dn=Math.floor(Dn/2),tt=this.tiles[je(rt,$t,Dn)];return tt&&tt.source?(Ve>1&&console.log("found parent tile z%d-%d-%d",rt,$t,Dn),Ve>1&&console.time("drilling down"),this.splitTile(tt.source,rt,$t,Dn,re,ie,ae),Ve>1&&console.timeEnd("drilling down"),this.tiles[ot]?rn(this.tiles[ot],De):null):null};class Ue extends y.VectorTileWorkerSource{constructor(ie,ae,we,De,Ve){super(ie,ae,we,De,at),Ve&&(this.loadGeoJSON=Ve)}loadData(ie,ae){const we=ie&&ie.request,De=we&&we.collectResourceTiming;this.loadGeoJSON(ie,(Ve,Ke)=>{if(Ve||!Ke)return ae(Ve);if("object"!=typeof Ke)return ae(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));{nt(Ke,!0);try{if(ie.filter){const tt=y.createExpression(ie.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===tt.result)throw new Error(tt.value.map($t=>`${$t.key}: ${$t.message}`).join(", "));Ke={type:"FeatureCollection",features:Ke.features.filter($t=>tt.value.evaluate({zoom:0},$t))}}this._geoJSONIndex=ie.cluster?new $r(function({superclusterOptions:tt,clusterProperties:rt}){if(!rt||!tt)return tt;const $t={},Dn={},cn={accumulated:null,zoom:0},ni={properties:null},Xn=Object.keys(rt);for(const Nn of Xn){const[di,Li]=rt[Nn],ur=y.createExpression(Li),li=y.createExpression("string"==typeof di?[di,["accumulated"],["get",Nn]]:di);$t[Nn]=ur.value,Dn[Nn]=li.value}return tt.map=Nn=>{ni.properties=Nn;const di={};for(const Li of Xn)di[Li]=$t[Li].evaluate(cn,ni);return di},tt.reduce=(Nn,di)=>{ni.properties=di;for(const Li of Xn)cn.accumulated=Nn[Li],Nn[Li]=Dn[Li].evaluate(cn,ni)},tt}(ie)).load(Ke.features):new Qe(tt=Ke,ie.geojsonVtOptions)}catch(tt){return ae(tt)}this.loaded={};const ot={};if(De){const tt=y.getPerformanceMeasurement(we);tt&&(ot.resourceTiming={},ot.resourceTiming[ie.source]=JSON.parse(JSON.stringify(tt)))}ae(null,ot)}var tt})}reloadTile(ie,ae){const we=this.loaded;return we&&we[ie.uid]?super.reloadTile(ie,ae):this.loadTile(ie,ae)}loadGeoJSON(ie,ae){if(ie.request)y.getJSON(ie.request,ae);else{if("string"!=typeof ie.data)return ae(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));try{return ae(null,JSON.parse(ie.data))}catch{return ae(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ie,ae){try{ae(null,this._geoJSONIndex.getClusterExpansionZoom(ie.clusterId))}catch(we){ae(we)}}getClusterChildren(ie,ae){try{ae(null,this._geoJSONIndex.getChildren(ie.clusterId))}catch(we){ae(we)}}getClusterLeaves(ie,ae){try{ae(null,this._geoJSONIndex.getLeaves(ie.clusterId,ie.limit,ie.offset))}catch(we){ae(we)}}}class Ce{constructor(ie){this.self=ie,this.actor=new y.Actor(ie,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=y.getProjection({name:"mercator"}),this.workerSourceTypes={vector:y.VectorTileWorkerSource,geojson:Ue},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ae,we)=>{if(this.workerSourceTypes[ae])throw new Error(`Worker source with name "${ae}" already registered.`);this.workerSourceTypes[ae]=we},this.self.registerRTLTextPlugin=ae=>{if(y.plugin.isParsed())throw new Error("RTL text plugin already registered.");y.plugin.applyArabicShaping=ae.applyArabicShaping,y.plugin.processBidirectionalText=ae.processBidirectionalText,y.plugin.processStyledBidirectionalText=ae.processStyledBidirectionalText}}clearCaches(ie,ae,we){delete this.layerIndexes[ie],delete this.availableImages[ie],delete this.workerSources[ie],delete this.demWorkerSources[ie],we()}checkIfReady(ie,ae,we){we()}setReferrer(ie,ae){this.referrer=ae}spriteLoaded(ie,ae){this.isSpriteLoaded[ie]=ae;for(const we in this.workerSources[ie]){const De=this.workerSources[ie][we];for(const Ve in De)De[Ve]instanceof y.VectorTileWorkerSource&&(De[Ve].isSpriteLoaded=ae,De[Ve].fire(new y.Event("isSpriteLoaded")))}}setImages(ie,ae,we){this.availableImages[ie]=ae;for(const De in this.workerSources[ie]){const Ve=this.workerSources[ie][De];for(const Ke in Ve)Ve[Ke].availableImages=ae}we()}enableTerrain(ie,ae,we){this.terrain=ae,we()}setProjection(ie,ae){this.projections[ie]=y.getProjection(ae)}setLayers(ie,ae,we){this.getLayerIndex(ie).replace(ae),we()}updateLayers(ie,ae,we){this.getLayerIndex(ie).update(ae.layers,ae.removedIds),we()}loadTile(ie,ae,we){const De=this.enableTerrain?y.extend({enableTerrain:this.terrain},ae):ae;De.projection=this.projections[ie]||this.defaultProjection,this.getWorkerSource(ie,ae.type,ae.source).loadTile(De,we)}loadDEMTile(ie,ae,we){const De=this.enableTerrain?y.extend({buildQuadTree:this.terrain},ae):ae;this.getDEMWorkerSource(ie,ae.source).loadTile(De,we)}reloadTile(ie,ae,we){const De=this.enableTerrain?y.extend({enableTerrain:this.terrain},ae):ae;De.projection=this.projections[ie]||this.defaultProjection,this.getWorkerSource(ie,ae.type,ae.source).reloadTile(De,we)}abortTile(ie,ae,we){this.getWorkerSource(ie,ae.type,ae.source).abortTile(ae,we)}removeTile(ie,ae,we){this.getWorkerSource(ie,ae.type,ae.source).removeTile(ae,we)}removeSource(ie,ae,we){if(!this.workerSources[ie]||!this.workerSources[ie][ae.type]||!this.workerSources[ie][ae.type][ae.source])return;const De=this.workerSources[ie][ae.type][ae.source];delete this.workerSources[ie][ae.type][ae.source],void 0!==De.removeSource?De.removeSource(ae,we):we()}loadWorkerSource(ie,ae,we){try{this.self.importScripts(ae.url),we()}catch(De){we(De.toString())}}syncRTLPluginState(ie,ae,we){try{y.plugin.setState(ae);const De=y.plugin.getPluginURL();if(y.plugin.isLoaded()&&!y.plugin.isParsed()&&null!=De){this.self.importScripts(De);const Ve=y.plugin.isParsed();we(Ve?void 0:new Error(`RTL Text Plugin failed to import scripts from ${De}`),Ve)}}catch(De){we(De.toString())}}getAvailableImages(ie){let ae=this.availableImages[ie];return ae||(ae=[]),ae}getLayerIndex(ie){let ae=this.layerIndexes[ie];return ae||(ae=this.layerIndexes[ie]=new qe),ae}getWorkerSource(ie,ae,we){return this.workerSources[ie]||(this.workerSources[ie]={}),this.workerSources[ie][ae]||(this.workerSources[ie][ae]={}),this.workerSources[ie][ae][we]||(this.workerSources[ie][ae][we]=new this.workerSourceTypes[ae]({send:(Ve,Ke,ot,tt,rt,$t)=>{this.actor.send(Ve,Ke,ot,ie,rt,$t)},scheduler:this.actor.scheduler},this.getLayerIndex(ie),this.getAvailableImages(ie),this.isSpriteLoaded[ie])),this.workerSources[ie][ae][we]}getDEMWorkerSource(ie,ae){return this.demWorkerSources[ie]||(this.demWorkerSources[ie]={}),this.demWorkerSources[ie][ae]||(this.demWorkerSources[ie][ae]=new Ne),this.demWorkerSources[ie][ae]}enforceCacheSizeLimit(ie,ae){y.enforceCacheSizeLimit(ae)}getWorkerPerformanceMetrics(ie,ae,we){we(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ce(self)),Ce}),Ct(0,function(y){function ze(w,h){if(Array.isArray(w)){if(!Array.isArray(h)||w.length!==h.length)return!1;for(let _=0;_<w.length;_++)if(!ze(w[_],h[_]))return!1;return!0}if("object"==typeof w&&null!==w&&null!==h){if("object"!=typeof h||Object.keys(w).length!==Object.keys(h).length)return!1;for(const _ in w)if(!ze(w[_],h[_]))return!1;return!0}return w===h}var ht=qe;function qe(w){return h=w,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var T,k,P=new Blob([""],{type:"text/javascript"}),I=URL.createObjectURL(P);try{k=new Worker(I),T=!0}catch{T=!1}return k&&k.terminate(),URL.revokeObjectURL(I),T}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var T=document.createElement("canvas");T.width=T.height=1;var k=T.getContext("2d");if(!k)return!1;var P=k.getImageData(0,0,1,1);return P&&P.width===T.width}()||(void 0===Ne[_=h&&h.failIfMajorPerformanceCaveat]&&(Ne[_]=function(T){var k,I,M,z,P=(I=T,M=document.createElement("canvas"),(z=Object.create(qe.webGLContextAttributes)).failIfMajorPerformanceCaveat=I,M.getContext("webgl",z)||M.getContext("experimental-webgl",z));if(!P)return!1;try{k=P.createShader(P.VERTEX_SHADER)}catch{return!1}return!(!k||P.isContextLost())&&(P.shaderSource(k,"void main() {}"),P.compileShader(k),!0===P.getShaderParameter(k,P.COMPILE_STATUS))}(_)),!Ne[_]||document.documentMode));var h,_}var Ne={};function nt(w,h,_){const T=y.window.document.createElement(w);return void 0!==h&&(T.className=h),_&&_.appendChild(T),T}function fn(w,h,_){const T=y.window.document.createElementNS("http://www.w3.org/2000/svg",w);for(const k of Object.keys(h))T.setAttributeNS(null,k,h[k]);return _&&_.appendChild(T),T}qe.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const ft=y.window.document&&y.window.document.documentElement.style,ln=ft&&void 0!==ft.userSelect?"userSelect":"WebkitUserSelect";let Ze;function Je(){ft&&ln&&(Ze=ft[ln],ft[ln]="none")}function dt(){ft&&ln&&(ft[ln]=Ze)}function Ot(w){w.preventDefault(),w.stopPropagation(),y.window.removeEventListener("click",Ot,!0)}function Jt(){y.window.addEventListener("click",Ot,!0),y.window.setTimeout(()=>{y.window.removeEventListener("click",Ot,!0)},0)}function st(w,h){const _=w.getBoundingClientRect();return yn(w,_,h)}function Zt(w,h){const _=w.getBoundingClientRect(),T=[];for(let k=0;k<h.length;k++)T.push(yn(w,_,h[k]));return T}function nn(w){return void 0!==y.window.InstallTrigger&&2===w.button&&w.ctrlKey&&y.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:w.button}function yn(w,h,_){const T=w.offsetWidth===h.width?1:w.offsetWidth/h.width;return new y.pointGeometry((_.clientX-h.left)*T,(_.clientY-h.top)*T)}function it(w,h){var _=h[0],T=h[1],k=h[2],P=h[3],I=_*P-k*T;return I?(w[0]=P*(I=1/I),w[1]=-T*I,w[2]=-k*I,w[3]=_*I,w):null}function zt(w){const{userImage:h}=w;return!!(h&&h.render&&h.render())&&(w.data.replace(new Uint8Array(h.data.buffer)),!0)}class en extends y.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new y.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(h){if(this.loaded!==h&&(this.loaded=h,h)){for(const{ids:_,callback:T}of this.requestors)this._notify(_,T);this.requestors=[]}}hasImage(h){return!!this.getImage(h)}getImage(h){return this.images[h]}addImage(h,_){this._validate(h,_)&&(this.images[h]=_)}_validate(h,_){let T=!0;return this._validateStretch(_.stretchX,_.data&&_.data.width)||(this.fire(new y.ErrorEvent(new Error(`Image "${h}" has invalid "stretchX" value`))),T=!1),this._validateStretch(_.stretchY,_.data&&_.data.height)||(this.fire(new y.ErrorEvent(new Error(`Image "${h}" has invalid "stretchY" value`))),T=!1),this._validateContent(_.content,_)||(this.fire(new y.ErrorEvent(new Error(`Image "${h}" has invalid "content" value`))),T=!1),T}_validateStretch(h,_){if(!h)return!0;let T=0;for(const k of h){if(k[0]<T||k[1]<k[0]||_<k[1])return!1;T=k[1]}return!0}_validateContent(h,_){return!(h&&(4!==h.length||h[0]<0||_.data.width<h[0]||h[1]<0||_.data.height<h[1]||h[2]<0||_.data.width<h[2]||h[3]<0||_.data.height<h[3]||h[2]<h[0]||h[3]<h[1]))}updateImage(h,_){_.version=this.images[h].version+1,this.images[h]=_,this.updatedImages[h]=!0}removeImage(h){const _=this.images[h];delete this.images[h],delete this.patterns[h],_.userImage&&_.userImage.onRemove&&_.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(h,_){let T=!0;if(!this.isLoaded())for(const k of h)this.images[k]||(T=!1);this.isLoaded()||T?this._notify(h,_):this.requestors.push({ids:h,callback:_})}_notify(h,_){const T={};for(const k of h){this.images[k]||this.fire(new y.Event("styleimagemissing",{id:k}));const P=this.images[k];P?T[k]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:Boolean(P.userImage&&P.userImage.render)}:y.warnOnce(`Image "${k}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}_(null,T)}getPixelSize(){const{width:h,height:_}=this.atlasImage;return{width:h,height:_}}getPattern(h){const _=this.patterns[h],T=this.getImage(h);if(!T)return null;if(_&&_.position.version===T.version)return _.position;if(_)_.position.version=T.version;else{const k={w:T.data.width+2,h:T.data.height+2,x:0,y:0},P=new y.ImagePosition(k,T);this.patterns[h]={bin:k,position:P}}return this._updatePatternAtlas(),this.patterns[h].position}bind(h){const _=h.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new y.Texture(h,this.atlasImage,_.RGBA),this.atlasTexture&&this.atlasTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE)}_updatePatternAtlas(){const h=[];for(const P in this.patterns)h.push(this.patterns[P].bin);const{w:_,h:T}=y.potpack(h),k=this.atlasImage;k.resize({width:_||1,height:T||1});for(const P in this.patterns){const{bin:I}=this.patterns[P],M=I.x+1,z=I.y+1,G=this.images[P].data,$=G.width,te=G.height;y.RGBAImage.copy(G,k,{x:0,y:0},{x:M,y:z},{width:$,height:te}),y.RGBAImage.copy(G,k,{x:0,y:te-1},{x:M,y:z-1},{width:$,height:1}),y.RGBAImage.copy(G,k,{x:0,y:0},{x:M,y:z+te},{width:$,height:1}),y.RGBAImage.copy(G,k,{x:$-1,y:0},{x:M-1,y:z},{width:1,height:te}),y.RGBAImage.copy(G,k,{x:0,y:0},{x:M+$,y:z},{width:1,height:te})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(h){for(const _ of h){if(this.callbackDispatchedThisFrame[_])continue;this.callbackDispatchedThisFrame[_]=!0;const T=this.images[_];zt(T)&&this.updateImage(_,T)}}}const gt=new y.Properties({anchor:new y.DataConstantProperty(y.spec.light.anchor),position:new class{constructor(){this.specification=y.spec.light.position}possiblyEvaluate(w,h){return function([_,T,k]){const P=y.degToRad(T+90),I=y.degToRad(k);return{x:_*Math.cos(P)*Math.sin(I),y:_*Math.sin(P)*Math.sin(I),z:_*Math.cos(I),azimuthal:T,polar:k}}(w.expression.evaluate(h))}interpolate(w,h,_){return{x:y.number(w.x,h.x,_),y:y.number(w.y,h.y,_),z:y.number(w.z,h.z,_),azimuthal:y.number(w.azimuthal,h.azimuthal,_),polar:y.number(w.polar,h.polar,_)}}},color:new y.DataConstantProperty(y.spec.light.color),intensity:new y.DataConstantProperty(y.spec.light.intensity)}),xt="-transition";class Lt extends y.Evented{constructor(h){super(),this._transitionable=new y.Transitionable(gt),this.setLight(h),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(h,_={}){if(!this._validate(y.validateLight,h,_))for(const T in h){const k=h[T];y.endsWith(T,xt)?this._transitionable.setTransition(T.slice(0,-xt.length),k):this._transitionable.setValue(T,k)}}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,_,T){return(!T||!1!==T.validate)&&y.emitValidationErrors(this,h.call(y.validateStyle,y.extend({value:_,style:{glyphs:!0,sprite:!0},styleSpec:y.spec})))}}const It=new y.Properties({source:new y.DataConstantProperty(y.spec.terrain.source),exaggeration:new y.DataConstantProperty(y.spec.terrain.exaggeration)}),Vt="-transition";class wn extends y.Evented{constructor(h,_){super(),this._transitionable=new y.Transitionable(It),this.set(h),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=_}get(){return this._transitionable.serialize()}set(h){for(const _ in h){const T=h[_];y.endsWith(_,Vt)?this._transitionable.setTransition(_.slice(0,-Vt.length),T):this._transitionable.setValue(_,T)}}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}}function ai(w,h,_,T){const k=y.smoothstep(45,65,_),[P,I]=ir(w,T),M=y.length(h);let z=1-Math.min(1,Math.exp((M-P)/(I-P)*-6));return z*=z*z,z=Math.min(1,1.00747*z),z*k*w.alpha}function ir(w,h){const _=.5/Math.tan(.5*h);return[w.range[0]+_,w.range[1]+_]}const Ni=new y.Properties({range:new y.DataConstantProperty(y.spec.fog.range),color:new y.DataConstantProperty(y.spec.fog.color),"high-color":new y.DataConstantProperty(y.spec.fog["high-color"]),"space-color":new y.DataConstantProperty(y.spec.fog["space-color"]),"horizon-blend":new y.DataConstantProperty(y.spec.fog["horizon-blend"]),"star-intensity":new y.DataConstantProperty(y.spec.fog["star-intensity"])}),vi="-transition";class zi extends y.Evented{constructor(h,_){super(),this._transitionable=new y.Transitionable(Ni),this.set(h),this._transitioning=this._transitionable.untransitioned(),this._transform=_}get state(){const h=this._transform,_="globe"===h.projection.name,T=y.globeToMercatorTransition(h.zoom),k=this.properties.get("range"),P=[.5,3];return{range:_?[y.number(P[0],k[0],T),y.number(P[1],k[1],T)]:k,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(h,_={}){if(!this._validate(y.validateFog,h,_)){for(const T of Object.keys(y.spec.fog))h&&void 0===h[T]&&(h[T]=y.spec.fog[T].default);for(const T in h){const k=h[T];y.endsWith(T,vi)?this._transitionable.setTransition(T.slice(0,-vi.length),k):this._transitionable.setValue(T,k)}}}getOpacity(h){if(!this._transform.projection.supportsFog)return 0;const _=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:y.smoothstep(45,65,h))*_.a}getOpacityAtLatLng(h,_){return this._transform.projection.supportsFog?function(T,k,P){const I=y.MercatorCoordinate.fromLngLat(k),M=P.elevation?P.elevation.getAtPointOrZero(I):0,z=[I.x,I.y,M];return y.transformMat4(z,z,P.mercatorFogMatrix),ai(T,z,P.pitch,P._fov)}(this.state,h,_):0}getFovAdjustedRange(h){return this._transform.projection.supportsFog?ir(this.state,h):[0,1]}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,_,T){return(!T||!1!==T.validate)&&y.emitValidationErrors(this,h.call(y.validateStyle,y.extend({value:_,style:{glyphs:!0,sprite:!0},styleSpec:y.spec})))}}class ri{constructor(h,_){this.workerPool=h,this.actors=[],this.currentActor=0,this.id=y.uniqueId();const T=this.workerPool.acquire(this.id);for(let k=0;k<T.length;k++){const P=new ri.Actor(T[k],_,this.id);P.name=`Worker ${k}`,this.actors.push(P)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(h,_,T){y.asyncAll(this.actors,(k,P)=>{k.send(h,_,P)},T=T||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(h=>{h.remove()}),this.actors=[],this.workerPool.release(this.id)}}function or(w,h,_){return h*(y.EXTENT/(w.tileSize*Math.pow(2,_-w.tileID.overscaledZ)))}ri.Actor=y.Actor;class Bo{constructor(h,_,T,k){this.screenBounds=h,this.cameraPoint=_,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=T,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,k)}static createFromScreenPoints(h,_){let T,k;if(h instanceof y.pointGeometry||"number"==typeof h[0]){const P=y.pointGeometry.convert(h);T=[P],k=_.isPointAboveHorizon(P)}else{const P=y.pointGeometry.convert(h[0]),I=y.pointGeometry.convert(h[1]);T=[P,I],k=y.polygonizeBounds(P,I).every(M=>_.isPointAboveHorizon(M))}return new Bo(T,_.getCameraPoint(),k,_)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(h){return y.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],h)}bufferedCameraGeometry(h){const _=this.screenBounds[0],T=1===this.screenBounds.length?this.screenBounds[0].add(new y.pointGeometry(1,1)):this.screenBounds[1],k=y.polygonizeBounds(_,T,0,!1);return this.cameraPoint.y>T.y&&(this.cameraPoint.x>_.x&&this.cameraPoint.x<T.x?k.splice(3,0,this.cameraPoint):this.cameraPoint.x>=T.x?k[2]=this.cameraPoint:this.cameraPoint.x<=_.x&&(k[3]=this.cameraPoint)),y.bufferConvexPolygon(k,h)}bufferedCameraGeometryGlobe(h){const _=this.screenBounds[0],T=1===this.screenBounds.length?this.screenBounds[0].add(new y.pointGeometry(1,1)):this.screenBounds[1],k=y.polygonizeBounds(_,T,h),P=this.cameraPoint.clone();switch(3*((P.y>_.y)+(P.y>T.y))+((P.x>_.x)+(P.x>T.x))){case 0:k[0]=P,k[4]=P.clone();break;case 1:k.splice(1,0,P);break;case 2:k[1]=P;break;case 3:k.splice(4,0,P);break;case 5:k.splice(2,0,P);break;case 6:k[3]=P;break;case 7:k.splice(3,0,P);break;case 8:k[2]=P}return k}containsTile(h,_,T,k=0){const P=h.queryPadding/_._pixelsPerMercatorPixel+1,I=T?this._bufferedCameraMercator(P,_):this._bufferedScreenMercator(P,_);let M=h.tileID.wrap+(I.unwrapped?k:0);const z=I.polygon.map(Te=>y.getTilePoint(h.tileTransform,Te,M));if(!y.polygonIntersectsBox(z,0,0,y.EXTENT,y.EXTENT))return;M=h.tileID.wrap+(this.screenGeometryMercator.unwrapped?k:0);const G=this.screenGeometryMercator.polygon.map(Te=>y.getTileVec3(h.tileTransform,Te,M)),$=G.map(Te=>new y.pointGeometry(Te[0],Te[1])),te=_.getFreeCameraOptions().position||new y.MercatorCoordinate(0,0,0),ue=y.getTileVec3(h.tileTransform,te,M),fe=G.map(Te=>{const de=y.sub(Te,Te,ue);return y.normalize(de,de),new y.Ray(ue,de)}),_e=or(h,1,_.zoom)*_._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:$,tilespaceRays:fe,bufferedTilespaceGeometry:z,bufferedTilespaceBounds:(ye=y.getBounds(z),ye.min.x=y.clamp(ye.min.x,0,y.EXTENT),ye.min.y=y.clamp(ye.min.y,0,y.EXTENT),ye.max.x=y.clamp(ye.max.x,0,y.EXTENT),ye.max.y=y.clamp(ye.max.y,0,y.EXTENT),ye),tile:h,tileID:h.tileID,pixelToTileUnitsFactor:_e};var ye}_bufferedScreenMercator(h,_){const T=Gr(h);if(this._screenRaycastCache[T])return this._screenRaycastCache[T];{let k;return k="globe"===_.projection.name?this._projectAndResample(this.bufferedScreenGeometry(h),_):{polygon:this.bufferedScreenGeometry(h).map(P=>_.pointCoordinate3D(P)),unwrapped:!0},this._screenRaycastCache[T]=k,k}}_bufferedCameraMercator(h,_){const T=Gr(h);if(this._cameraRaycastCache[T])return this._cameraRaycastCache[T];{let k;return k="globe"===_.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(h),_):{polygon:this.bufferedCameraGeometry(h).map(P=>_.pointCoordinate3D(P)),unwrapped:!0},this._cameraRaycastCache[T]=k,k}}_projectAndResample(h,_){const T=function(P,I){const M=y.multiply([],I.pixelMatrix,I.globeMatrix),z=[0,-y.GLOBE_RADIUS,0,1],G=[0,y.GLOBE_RADIUS,0,1],$=[0,0,0,1];y.transformMat4$1(z,z,M),y.transformMat4$1(G,G,M),y.transformMat4$1($,$,M);const te=new y.pointGeometry(z[0]/z[3],z[1]/z[3]),ue=new y.pointGeometry(G[0]/G[3],G[1]/G[3]),fe=y.polygonContainsPoint(P,te)&&z[3]<$[3],_e=y.polygonContainsPoint(P,ue)&&G[3]<$[3];if(!fe&&!_e)return null;const ye=function(Xe,ut,Et){for(let At=1;At<Xe.length;At++){const on=bi(ut.pointCoordinate3D(Xe[At-1]).x),wt=bi(ut.pointCoordinate3D(Xe[At]).x);if(Et<0){if(on<wt)return{idx:At,t:-on/(wt-1-on)}}else if(wt<on)return{idx:At,t:(1-on)/(wt+1-on)}}return null}(P,I,fe?-1:1);if(!ye)return null;const{idx:Te,t:de}=ye;let Oe=Te>1?$i(P.slice(0,Te),I):[],Re=Te<P.length?$i(P.slice(Te),I):[];Oe=Oe.map(Xe=>new y.pointGeometry(bi(Xe.x),Xe.y)),Re=Re.map(Xe=>new y.pointGeometry(bi(Xe.x),Xe.y));const Fe=[...Oe];0===Fe.length&&Fe.push(Re[Re.length-1]);const Ye=y.number(Fe[Fe.length-1].y,(0===Re.length?Oe[0]:Re[0]).y,de);let We;return We=fe?[new y.pointGeometry(0,Ye),new y.pointGeometry(0,0),new y.pointGeometry(1,0),new y.pointGeometry(1,Ye)]:[new y.pointGeometry(1,Ye),new y.pointGeometry(1,1),new y.pointGeometry(0,1),new y.pointGeometry(0,Ye)],Fe.push(...We),0===Re.length?Fe.push(Oe[0]):Fe.push(...Re),{polygon:Fe.map(Xe=>new y.MercatorCoordinate(Xe.x,Xe.y)),unwrapped:!1}}(h,_);if(T)return T;const k=function(P,I){let M=!1,z=-1/0,G=0;for(let te=0;te<P.length-1;te++)P[te].x>z&&(z=P[te].x,G=te);for(let te=0;te<P.length-1;te++){const ue=(G+te)%(P.length-1),fe=P[ue],_e=P[ue+1];Math.abs(fe.x-_e.x)>.5&&(fe.x<_e.x?(fe.x+=1,0===ue&&(P[P.length-1].x+=1)):(_e.x+=1,ue+1===P.length-1&&(P[0].x+=1)),M=!0)}const $=y.mercatorXfromLng(I.center.lng);return M&&$<Math.abs($-1)&&P.forEach(te=>{te.x-=1}),{polygon:P,unwrapped:M}}($i(h,_).map(P=>new y.pointGeometry(bi(P.x),P.y)),_);return{polygon:k.polygon.map(P=>new y.MercatorCoordinate(P.x,P.y)),unwrapped:k.unwrapped}}}function $i(w,h){return y.resample(w,_=>{const T=h.pointCoordinate3D(_);_.x=T.x,_.y=T.y},1/256)}function bi(w){return w<0?1+w%1:w%1}function Gr(w){return 100*w|0}function Vo(w,h,_,T,k){const P=function(I,M){if(I)return k(I);if(M){w.url&&M.tiles&&w.tiles&&delete w.tiles;const z=y.pick(y.extend(M,w),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);M.vector_layers&&(z.vectorLayers=M.vector_layers,z.vectorLayerIds=z.vectorLayers.map(G=>G.id)),z.tiles=h.canonicalizeTileset(z,w.url),k(null,z)}};return w.url?y.getJSON(h.transformRequest(h.normalizeSourceURL(w.url,null,_,T),y.ResourceType.Source),P):y.exported.frame(()=>P(null,w))}class $r{constructor(h,_,T){this.bounds=y.LngLatBounds.convert(this.validateBounds(h)),this.minzoom=_||0,this.maxzoom=T||24}validateBounds(h){return Array.isArray(h)&&4===h.length?[Math.max(-180,h[0]),Math.max(-90,h[1]),Math.min(180,h[2]),Math.min(90,h[3])]:[-180,-90,180,90]}contains(h){const _=Math.pow(2,h.z),T=Math.floor(y.mercatorXfromLng(this.bounds.getWest())*_),k=Math.floor(y.mercatorYfromLat(this.bounds.getNorth())*_),P=Math.ceil(y.mercatorXfromLng(this.bounds.getEast())*_),I=Math.ceil(y.mercatorYfromLat(this.bounds.getSouth())*_);return h.x>=T&&h.x<P&&h.y>=k&&h.y<I}}class fo{constructor(h,_,T){this.context=h;const k=h.gl;this.buffer=k.createBuffer(),this.dynamicDraw=Boolean(T),this.context.unbindVAO(),h.bindElementBuffer.set(this.buffer),k.bufferData(k.ELEMENT_ARRAY_BUFFER,_.arrayBuffer,this.dynamicDraw?k.DYNAMIC_DRAW:k.STATIC_DRAW),this.dynamicDraw||_.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(h){const _=this.context.gl;this.context.unbindVAO(),this.bind(),_.bufferSubData(_.ELEMENT_ARRAY_BUFFER,0,h.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ar={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ys{constructor(h,_,T,k){this.length=_.length,this.attributes=T,this.itemSize=_.bytesPerElement,this.dynamicDraw=k,this.context=h;const P=h.gl;this.buffer=P.createBuffer(),h.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,_.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||_.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(h){const _=this.context.gl;this.bind(),_.bufferSubData(_.ARRAY_BUFFER,0,h.arrayBuffer)}enableAttributes(h,_){for(let T=0;T<this.attributes.length;T++){const k=_.attributes[this.attributes[T].name];void 0!==k&&h.enableVertexAttribArray(k)}}setVertexAttribPointers(h,_,T){for(let k=0;k<this.attributes.length;k++){const P=this.attributes[k],I=_.attributes[P.name];void 0!==I&&h.vertexAttribPointer(I,P.components,h[Ar[P.type]],!1,this.itemSize,P.offset+this.itemSize*(T||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class qi{constructor(h){this.gl=h.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(h){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Rr extends qi{getDefault(){return y.Color.transparent}set(h){const _=this.current;(h.r!==_.r||h.g!==_.g||h.b!==_.b||h.a!==_.a||this.dirty)&&(this.gl.clearColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class Xo extends qi{getDefault(){return 1}set(h){(h!==this.current||this.dirty)&&(this.gl.clearDepth(h),this.current=h,this.dirty=!1)}}class Gs extends qi{getDefault(){return 0}set(h){(h!==this.current||this.dirty)&&(this.gl.clearStencil(h),this.current=h,this.dirty=!1)}}class Ao extends qi{getDefault(){return[!0,!0,!0,!0]}set(h){const _=this.current;(h[0]!==_[0]||h[1]!==_[1]||h[2]!==_[2]||h[3]!==_[3]||this.dirty)&&(this.gl.colorMask(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class Pr extends qi{getDefault(){return!0}set(h){(h!==this.current||this.dirty)&&(this.gl.depthMask(h),this.current=h,this.dirty=!1)}}class jn extends qi{getDefault(){return 255}set(h){(h!==this.current||this.dirty)&&(this.gl.stencilMask(h),this.current=h,this.dirty=!1)}}class Uo extends qi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(h){const _=this.current;(h.func!==_.func||h.ref!==_.ref||h.mask!==_.mask||this.dirty)&&(this.gl.stencilFunc(h.func,h.ref,h.mask),this.current=h,this.dirty=!1)}}class lo extends qi{getDefault(){const h=this.gl;return[h.KEEP,h.KEEP,h.KEEP]}set(h){const _=this.current;(h[0]!==_[0]||h[1]!==_[1]||h[2]!==_[2]||this.dirty)&&(this.gl.stencilOp(h[0],h[1],h[2]),this.current=h,this.dirty=!1)}}class Wr extends qi{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;h?_.enable(_.STENCIL_TEST):_.disable(_.STENCIL_TEST),this.current=h,this.dirty=!1}}class es extends qi{getDefault(){return[0,1]}set(h){const _=this.current;(h[0]!==_[0]||h[1]!==_[1]||this.dirty)&&(this.gl.depthRange(h[0],h[1]),this.current=h,this.dirty=!1)}}class Mo extends qi{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;h?_.enable(_.DEPTH_TEST):_.disable(_.DEPTH_TEST),this.current=h,this.dirty=!1}}class wr extends qi{getDefault(){return this.gl.LESS}set(h){(h!==this.current||this.dirty)&&(this.gl.depthFunc(h),this.current=h,this.dirty=!1)}}class yr extends qi{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;h?_.enable(_.BLEND):_.disable(_.BLEND),this.current=h,this.dirty=!1}}class ui extends qi{getDefault(){const h=this.gl;return[h.ONE,h.ZERO]}set(h){const _=this.current;(h[0]!==_[0]||h[1]!==_[1]||this.dirty)&&(this.gl.blendFunc(h[0],h[1]),this.current=h,this.dirty=!1)}}class Wn extends qi{getDefault(){return y.Color.transparent}set(h){const _=this.current;(h.r!==_.r||h.g!==_.g||h.b!==_.b||h.a!==_.a||this.dirty)&&(this.gl.blendColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class ts extends qi{getDefault(){return this.gl.FUNC_ADD}set(h){(h!==this.current||this.dirty)&&(this.gl.blendEquation(h),this.current=h,this.dirty=!1)}}class Ur extends qi{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;h?_.enable(_.CULL_FACE):_.disable(_.CULL_FACE),this.current=h,this.dirty=!1}}class Ho extends qi{getDefault(){return this.gl.BACK}set(h){(h!==this.current||this.dirty)&&(this.gl.cullFace(h),this.current=h,this.dirty=!1)}}class vs extends qi{getDefault(){return this.gl.CCW}set(h){(h!==this.current||this.dirty)&&(this.gl.frontFace(h),this.current=h,this.dirty=!1)}}class Jr extends qi{getDefault(){return null}set(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)}}class co extends qi{getDefault(){return this.gl.TEXTURE0}set(h){(h!==this.current||this.dirty)&&(this.gl.activeTexture(h),this.current=h,this.dirty=!1)}}class mr extends qi{getDefault(){const h=this.gl;return[0,0,h.drawingBufferWidth,h.drawingBufferHeight]}set(h){const _=this.current;(h[0]!==_[0]||h[1]!==_[1]||h[2]!==_[2]||h[3]!==_[3]||this.dirty)&&(this.gl.viewport(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class cs extends qi{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;_.bindFramebuffer(_.FRAMEBUFFER,h),this.current=h,this.dirty=!1}}class Bi extends qi{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;_.bindRenderbuffer(_.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class qo extends qi{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;_.bindTexture(_.TEXTURE_2D,h),this.current=h,this.dirty=!1}}class En extends qi{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;_.bindBuffer(_.ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class rn extends qi{getDefault(){return null}set(h){const _=this.gl;_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class zn extends qi{constructor(h){super(h),this.vao=h.extVertexArrayObject}getDefault(){return null}set(h){this.vao&&(h!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(h),this.current=h,this.dirty=!1)}}class wi extends qi{getDefault(){return 4}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_ALIGNMENT,h),this.current=h,this.dirty=!1}}class Di extends qi{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h),this.current=h,this.dirty=!1}}class er extends qi{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,h),this.current=h,this.dirty=!1}}class Qe extends qi{constructor(h,_){super(h),this.context=h,this.parent=_}getDefault(){return null}}class je extends Qe{setDirty(){this.dirty=!0}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const _=this.gl;_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,h,0),this.current=h,this.dirty=!1}}class at extends Qe{attachment(){return this.gl.DEPTH_ATTACHMENT}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const _=this.gl;_.framebufferRenderbuffer(_.FRAMEBUFFER,this.attachment(),_.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class Ue extends at{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ce{constructor(h,_,T,k){this.context=h,this.width=_,this.height=T;const P=this.framebuffer=h.gl.createFramebuffer();this.colorAttachment=new je(h,P),k&&(this.depthAttachment=new at(h,P))}destroy(){const h=this.context.gl,_=this.colorAttachment.get();if(_&&h.deleteTexture(_),this.depthAttachment){const T=this.depthAttachment.get();T&&h.deleteRenderbuffer(T)}h.deleteFramebuffer(this.framebuffer)}}class re{constructor(h,_=!1){if(this.gl=h,this.isWebGL2=_,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),_){const T=h;this.extVertexArrayObject={createVertexArrayOES:T.createVertexArray.bind(h),deleteVertexArrayOES:T.deleteVertexArray.bind(h),bindVertexArrayOES:T.bindVertexArray.bind(h)}}this.clearColor=new Rr(this),this.clearDepth=new Xo(this),this.clearStencil=new Gs(this),this.colorMask=new Ao(this),this.depthMask=new Pr(this),this.stencilMask=new jn(this),this.stencilFunc=new Uo(this),this.stencilOp=new lo(this),this.stencilTest=new Wr(this),this.depthRange=new es(this),this.depthTest=new Mo(this),this.depthFunc=new wr(this),this.blend=new yr(this),this.blendFunc=new ui(this),this.blendColor=new Wn(this),this.blendEquation=new ts(this),this.cullFace=new Ur(this),this.cullFaceSide=new Ho(this),this.frontFace=new vs(this),this.program=new Jr(this),this.activeTexture=new co(this),this.viewport=new mr(this),this.bindFramebuffer=new cs(this),this.bindRenderbuffer=new Bi(this),this.bindTexture=new qo(this),this.bindVertexBuffer=new En(this),this.bindElementBuffer=new rn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new zn(this),this.pixelStoreUnpack=new wi(this),this.pixelStoreUnpackPremultiplyAlpha=new Di(this),this.pixelStoreUnpackFlipY=new er(this),this.extTextureFilterAnisotropic=h.getExtension("EXT_texture_filter_anisotropic")||h.getExtension("MOZ_EXT_texture_filter_anisotropic")||h.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=h.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=h.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=h.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=h.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),_||(this.extTextureHalfFloat=h.getExtension("OES_texture_half_float")),(_||this.extTextureHalfFloat&&h.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=h.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=_||h.getExtension("OES_standard_derivatives"),this.extTimerQuery=h.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=h.getParameter(h.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(h,_){return new fo(this,h,_)}createVertexBuffer(h,_,T){return new ys(this,h,_,T)}createRenderbuffer(h,_,T){const k=this.gl,P=k.createRenderbuffer();return this.bindRenderbuffer.set(P),k.renderbufferStorage(k.RENDERBUFFER,h,_,T),this.bindRenderbuffer.set(null),P}createFramebuffer(h,_,T){return new Ce(this,h,_,T)}clear({color:h,depth:_,stencil:T}){const k=this.gl;let P=0;h&&(P|=k.COLOR_BUFFER_BIT,this.clearColor.set(h),this.colorMask.set([!0,!0,!0,!0])),void 0!==_&&(P|=k.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(_),this.depthMask.set(!0)),void 0!==T&&(P|=k.STENCIL_BUFFER_BIT,this.clearStencil.set(T),this.stencilMask.set(255)),k.clear(P)}setCullFace(h){!1===h.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(h.mode),this.frontFace.set(h.frontFace))}setDepthMode(h){h.func!==this.gl.ALWAYS||h.mask?(this.depthTest.set(!0),this.depthFunc.set(h.func),this.depthMask.set(h.mask),this.depthRange.set(h.range)):this.depthTest.set(!1)}setStencilMode(h){h.test.func!==this.gl.ALWAYS||h.mask?(this.stencilTest.set(!0),this.stencilMask.set(h.mask),this.stencilOp.set([h.fail,h.depthFail,h.pass]),this.stencilFunc.set({func:h.test.func,ref:h.ref,mask:h.test.mask})):this.stencilTest.set(!1)}setColorMode(h){ze(h.blendFunction,y.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(h.blendFunction),this.blendColor.set(h.blendColor)),this.colorMask.set(h.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class ie extends y.Evented{constructor(h,_,T,k){if(super(),this.id=h,this.dispatcher=T,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,y.extend(this,y.pick(_,["url","scheme","tileSize","promoteId"])),this._options=y.extend({type:"vector"},_),this._collectResourceTiming=_.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(k),this._tileWorkers={},this._deduped=new y.DedupedRequest}load(h){this._loaded=!1,this.fire(new y.Event("dataloading",{dataType:"source"}));const _=Array.isArray(this.map._language)?this.map._language.join():this.map._language,T=this.map._worldview;this._tileJSONRequest=Vo(this._options,this.map._requestManager,_,T,(k,P)=>{this._tileJSONRequest=null,this._loaded=!0,k?(_&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${_}`),T&&2!==T.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${T}`),this.fire(new y.ErrorEvent(k))):P&&(y.extend(this,P),P.bounds&&(this.tileBounds=new $r(P.bounds,this.minzoom,this.maxzoom)),y.postTurnstileEvent(P.tiles,this.map._requestManager._customAccessToken),this.fire(new y.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new y.Event("data",{dataType:"source",sourceDataType:"content"}))),h&&h(k)})}loaded(){return this._loaded}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return y.extend({},this._options)}loadTile(h,_){const T=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),k={request:this.map._requestManager.transformRequest(T,y.ResourceType.Tile),data:void 0,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:y.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:h.isSymbolTile};if(k.request.collectResourceTiming=this._collectResourceTiming,h.actor&&"expired"!==h.state)"loading"===h.state?h.reloadCallback=_:h.request=h.actor.send("reloadTile",k,P.bind(this));else if(h.actor=this._tileWorkers[T]=this._tileWorkers[T]||this.dispatcher.getActor(),this.dispatcher.ready)h.request=h.actor.send("loadTile",k,P.bind(this),void 0,!0);else{const I=y.loadVectorTile.call({deduped:this._deduped},k,(M,z)=>{M||!z?P.call(this,M):(k.data={cacheControl:z.cacheControl,expires:z.expires,rawData:z.rawData.slice(0)},h.actor&&h.actor.send("loadTile",k,P.bind(this),void 0,!0))},!0);h.request={cancel:I}}function P(I,M){return delete h.request,h.aborted?_(null):I&&404!==I.status?_(I):(M&&M.resourceTiming&&(h.resourceTiming=M.resourceTiming),this.map._refreshExpiredTiles&&M&&h.setExpiryData(M),h.loadVectorData(M,this.map.painter),y.cacheEntryPossiblyAdded(this.dispatcher),_(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id})}unloadTile(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ae extends y.Evented{constructor(h,_,T,k){super(),this.id=h,this.dispatcher=T,this.setEventedParent(k),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=y.extend({type:"raster"},_),y.extend(this,y.pick(_,["url","scheme","tileSize"]))}load(h){this._loaded=!1,this.fire(new y.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Vo(this._options,this.map._requestManager,null,null,(_,T)=>{this._tileJSONRequest=null,this._loaded=!0,_?this.fire(new y.ErrorEvent(_)):T&&(y.extend(this,T),T.bounds&&(this.tileBounds=new $r(T.bounds,this.minzoom,this.maxzoom)),y.postTurnstileEvent(T.tiles),this.fire(new y.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new y.Event("data",{dataType:"source",sourceDataType:"content"}))),h&&h(_)})}loaded(){return this._loaded}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return y.extend({},this._options)}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,_){const T=y.exported.devicePixelRatio>=2,k=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),T,this.tileSize);h.request=y.getImage(this.map._requestManager.transformRequest(k,y.ResourceType.Tile),(P,I,M,z)=>(delete h.request,h.aborted?(h.state="unloaded",_(null)):P?(h.state="errored",_(P)):I?(this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:M,expires:z}),h.setTexture(I,this.map.painter),h.state="loaded",y.cacheEntryPossiblyAdded(this.dispatcher),void _(null)):_(null)))}static loadTileData(h,_,T){h.setTexture(_,T)}static unloadTileData(h,_){h.texture&&_.saveTileTexture(h.texture)}abortTile(h,_){h.request&&(h.request.cancel(),delete h.request),_()}unloadTile(h,_){h.texture&&this.map.painter.saveTileTexture(h.texture),_()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let we;function De(w,h,_,T,k,P,I,M){const z=[w,_,k,h,T,P,1,1,1],G=[I,M,1],$=y.adjoint([],z),[te,ue,fe]=y.transformMat3(G,G,y.transpose($,$));return y.multiply$1(z,[te,0,0,0,ue,0,0,0,fe],z)}class Ve extends y.Evented{constructor(h,_,T,k){super(),this.id=h,this.dispatcher=T,this.coordinates=_.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(k),this.options=_,this._dirty=!1}load(h,_){this._loaded=_||!1,this.fire(new y.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=y.getImage(this.map._requestManager.transformRequest(this.url,y.ResourceType.Image),(T,k)=>{if(this._imageRequest=null,this._loaded=!0,T)this.fire(new y.ErrorEvent(T));else if(k){const{HTMLImageElement:P}=y.window;this.image=k instanceof P?y.exported.getImageData(k):k,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,h&&(this.coordinates=h),this._finishLoading()}})}loaded(){return this._loaded}updateImage(h){return this.image&&h.url?(this._imageRequest&&h.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=h.url,this.load(h.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new y.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(h){this.map=h,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(h){this.coordinates=h,this._boundsArray=void 0;const _=h.map(y.MercatorCoordinate.fromLngLat);return this.tileID=function(T){let k=1/0,P=1/0,I=-1/0,M=-1/0;for(const te of T)k=Math.min(k,te.x),P=Math.min(P,te.y),I=Math.max(I,te.x),M=Math.max(M,te.y);const z=Math.max(I-k,M-P),G=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),$=Math.pow(2,G);return new y.CanonicalTileID(G,Math.floor((k+I)/2*$),Math.floor((P+M)/2*$))}(_),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new y.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(h){for(const z in this.tiles){const G=this.tiles[z];"loaded"!==G.state&&(G.state="loaded",G.texture=this.texture)}if(this._boundsArray)return;const _=y.tileTransform(this.tileID,this.map.transform.projection),[T,k,P,I]=this.coordinates.map(z=>{const G=_.projection.project(z[0],z[1]);return y.getTilePoint(_,G)._round()});this.perspectiveTransform=function(z,G,$,te,ue,fe,_e,ye,Te,de){const Oe=De(0,0,z,0,0,G,z,G),Re=De($,te,ue,fe,_e,ye,Te,de);return y.multiply$1(Re,y.adjoint(Oe,Oe),Re),[Re[6]/Re[8]*z/y.EXTENT,Re[7]/Re[8]*G/y.EXTENT]}(this.width,this.height,T.x,T.y,k.x,k.y,I.x,I.y,P.x,P.y);const M=this._boundsArray=new y.StructArrayLayout4i8;M.emplaceBack(T.x,T.y,0,0),M.emplaceBack(k.x,k.y,y.EXTENT,0),M.emplaceBack(I.x,I.y,0,y.EXTENT),M.emplaceBack(P.x,P.y,y.EXTENT,y.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=h.createVertexBuffer(M,y.boundsAttributes.members),this.boundsSegments=y.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const h=this.map.painter.context,_=h.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new y.Texture(h,this.image,_.RGBA),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(h)}loadTile(h,_){this.tileID&&this.tileID.equals(h.tileID.canonical)?(this.tiles[String(h.tileID.wrap)]=h,h.buckets={},_(null)):(h.state="errored",_(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Ke={vector:ie,raster:ae,"raster-dem":class extends ae{constructor(w,h,_,T){super(w,h,_,T),this.type="raster-dem",this.maxzoom=22,this._options=y.extend({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox"}loadTile(w,h){const _=this.map._requestManager.normalizeTileURL(w.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function T(k,P){k&&(w.state="errored",h(k)),P&&(w.dem=P,w.dem.onDeserialize(),w.needsHillshadePrepare=!0,w.needsDEMTextureUpload=!0,w.state="loaded",h(null))}w.request=y.getImage(this.map._requestManager.transformRequest(_,y.ResourceType.Tile),function(k,P,I,M){if(delete w.request,w.aborted)w.state="unloaded",h(null);else if(k)w.state="errored",h(k);else if(P){this.map._refreshExpiredTiles&&w.setExpiryData({cacheControl:I,expires:M});const z=y.window.ImageBitmap&&P instanceof y.window.ImageBitmap&&(null==we&&(we=y.window.OffscreenCanvas&&new y.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof y.window.createImageBitmap),we),G=1-(P.width-y.prevPowerOfTwo(P.width))/2;G<1||w.neighboringTiles||(w.neighboringTiles=this._getNeighboringTiles(w.tileID));const $=z?P:y.exported.getImageData(P,G),te={uid:w.uid,coord:w.tileID,source:this.id,rawImageData:$,encoding:this.encoding,padding:G};w.actor&&"expired"!==w.state||(w.actor=this.dispatcher.getActor(),w.actor.send("loadDEMTile",te,T.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(w){const h=w.canonical,_=Math.pow(2,h.z),T=(h.x-1+_)%_,k=0===h.x?w.wrap-1:w.wrap,P=(h.x+1+_)%_,I=h.x+1===_?w.wrap+1:w.wrap,M={};return M[new y.OverscaledTileID(w.overscaledZ,k,h.z,T,h.y).key]={backfilled:!1},M[new y.OverscaledTileID(w.overscaledZ,I,h.z,P,h.y).key]={backfilled:!1},h.y>0&&(M[new y.OverscaledTileID(w.overscaledZ,k,h.z,T,h.y-1).key]={backfilled:!1},M[new y.OverscaledTileID(w.overscaledZ,w.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},M[new y.OverscaledTileID(w.overscaledZ,I,h.z,P,h.y-1).key]={backfilled:!1}),h.y+1<_&&(M[new y.OverscaledTileID(w.overscaledZ,k,h.z,T,h.y+1).key]={backfilled:!1},M[new y.OverscaledTileID(w.overscaledZ,w.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},M[new y.OverscaledTileID(w.overscaledZ,I,h.z,P,h.y+1).key]={backfilled:!1}),M}unloadTile(w){w.demTexture&&this.map.painter.saveTileTexture(w.demTexture),w.fbo&&(w.fbo.destroy(),delete w.fbo),w.dem&&delete w.dem,delete w.neighboringTiles,w.state="unloaded"}},geojson:class extends y.Evented{constructor(w,h,_,T){super(),this.id=w,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=_.getActor(),this.setEventedParent(T),this._data=h.data,this._options=y.extend({},h),this._collectResourceTiming=h.collectResourceTiming,void 0!==h.maxzoom&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;const k=y.EXTENT/this.tileSize;this.workerOptions=y.extend({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(void 0!==h.buffer?h.buffer:128)*k,tolerance:(void 0!==h.tolerance?h.tolerance:.375)*k,extent:y.EXTENT,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:void 0!==h.clusterMaxZoom?h.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:y.EXTENT,radius:(void 0!==h.clusterRadius?h.clusterRadius:50)*k,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions)}onAdd(w){this.map=w,this.setData(this._data)}setData(w){return this._data=w,this._updateWorkerData(),this}getClusterExpansionZoom(w,h){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:w,source:this.id},h),this}getClusterChildren(w,h){return this.actor.send("geojson.getClusterChildren",{clusterId:w,source:this.id},h),this}getClusterLeaves(w,h,_,T){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:w,limit:h,offset:_},T),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new y.Event("dataloading",{dataType:"source"})),this._loaded=!1;const w=y.extend({},this.workerOptions),h=this._data;"string"==typeof h?(w.request=this.map._requestManager.transformRequest(y.exported.resolveURL(h),y.ResourceType.Source),w.request.collectResourceTiming=this._collectResourceTiming):w.data=JSON.stringify(h),this._pendingLoad=this.actor.send(`${this.type}.loadData`,w,(_,T)=>{if(this._loaded=!0,this._pendingLoad=null,_)this.fire(new y.ErrorEvent(_));else{const k={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&T&&T.resourceTiming&&T.resourceTiming[this.id]&&(k.resourceTiming=T.resourceTiming[this.id]),this.fire(new y.Event("data",k)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(w,h){const _=w.actor?"reloadTile":"loadTile";w.actor=this.actor,w.request=this.actor.send(_,{type:this.type,uid:w.uid,tileID:w.tileID,tileZoom:w.tileZoom,zoom:w.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:y.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(T,k)=>(delete w.request,w.unloadVectorData(),w.aborted?h(null):T?h(T):(w.loadVectorData(k,this.map.painter,"reloadTile"===_),h(null))),void 0,"loadTile"===_)}abortTile(w){w.request&&(w.request.cancel(),delete w.request),w.aborted=!0}unloadTile(w){w.unloadVectorData(),this.actor.send("removeTile",{uid:w.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return y.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ve{constructor(w,h,_,T){super(w,h,_,T),this.roundZoom=!0,this.type="video",this.options=h}load(){this._loaded=!1;const w=this.options;this.urls=[];for(const h of w.urls)this.urls.push(this.map._requestManager.transformRequest(h,y.ResourceType.Source).url);y.getVideo(this.urls,(h,_)=>{this._loaded=!0,h?this.fire(new y.ErrorEvent(h)):_&&(this.video=_,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(w){if(this.video){const h=this.video.seekable;w<h.start(0)||w>h.end(0)?this.fire(new y.ErrorEvent(new y.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${h.start(0)} and ${h.end(0)}-second mark.`))):this.video.currentTime=w}}getVideo(){return this.video}onAdd(w){this.map||(this.map=w,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const w=this.map.painter.context,h=w.gl;this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new y.Texture(w,this.video,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(w)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ve,canvas:class extends Ve{constructor(w,h,_,T){super(w,h,_,T),h.coordinates?Array.isArray(h.coordinates)&&4===h.coordinates.length&&!h.coordinates.some(k=>!Array.isArray(k)||2!==k.length||k.some(P=>"number"!=typeof P))||this.fire(new y.ErrorEvent(new y.ValidationError(`sources.${w}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new y.ErrorEvent(new y.ValidationError(`sources.${w}`,null,'missing required property "coordinates"'))),h.animate&&"boolean"!=typeof h.animate&&this.fire(new y.ErrorEvent(new y.ValidationError(`sources.${w}`,null,'optional "animate" property must be a boolean value'))),h.canvas?"string"==typeof h.canvas||h.canvas instanceof y.window.HTMLCanvasElement||this.fire(new y.ErrorEvent(new y.ValidationError(`sources.${w}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new y.ErrorEvent(new y.ValidationError(`sources.${w}`,null,'missing required property "canvas"'))),this.options=h,this.animate=void 0===h.animate||h.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof y.window.HTMLCanvasElement?this.options.canvas:y.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new y.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(w){this.map=w,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let w=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,w=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,w=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const h=this.map.painter.context;this.texture?(w||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new y.Texture(h,this.canvas,h.gl.RGBA,{premultiply:!0}),this._prepareData(h)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const w of[this.canvas.width,this.canvas.height])if(isNaN(w)||w<=0)return!0;return!1}},custom:class extends y.Evented{constructor(w,h,_,T){super(),this.id=w,this.type="custom",this._dataType="raster",this._dispatcher=_,this._implementation=h,this.setEventedParent(T),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new y.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new y.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new $r(this._implementation.bounds,this.minzoom,this.maxzoom)),h.update=this._update.bind(this),h.clearTiles=this._clearTiles.bind(this),h.coveringTiles=this._coveringTiles.bind(this),y.extend(this,y.pick(h,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return y.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new y.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new y.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(w){this._map=w,this._loaded=!1,this.fire(new y.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(w),this.load()}onRemove(w){this._implementation.onRemove&&this._implementation.onRemove(w)}hasTile(w){if(this._implementation.hasTile){const{x:h,y:_,z:T}=w.canonical;return this._implementation.hasTile({x:h,y:_,z:T})}return!this.tileBounds||this.tileBounds.contains(w.canonical)}loadTile(w,h){const{x:_,y:T,z:k}=w.tileID.canonical,P=new y.window.AbortController;w.request=Promise.resolve(this._implementation.loadTile({x:_,y:T,z:k},{signal:P.signal})).then(function(I){return delete w.request,w.aborted?(w.state="unloaded",h(null)):void 0===I?(w.state="errored",h(null)):null===I?(this.loadTileData(w,{width:this.tileSize,height:this.tileSize,data:null}),w.state="loaded",h(null)):(M=I)instanceof y.window.ImageData||M instanceof y.window.HTMLCanvasElement||M instanceof y.window.ImageBitmap||M instanceof y.window.HTMLImageElement?(this.loadTileData(w,I),w.state="loaded",void h(null)):(w.state="errored",h(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var M}.bind(this)).catch(I=>{20!==I.code&&(w.state="errored",h(I))}),w.request.cancel=()=>P.abort()}loadTileData(w,h){ae.loadTileData(w,h,this._map.painter)}unloadTileData(w){ae.unloadTileData(w,this._map.painter)}unloadTile(w,h){if(this.unloadTileData(w),this._implementation.unloadTile){const{x:_,y:T,z:k}=w.tileID.canonical;this._implementation.unloadTile({x:_,y:T,z:k})}h()}abortTile(w,h){w.request&&w.request.cancel&&(w.request.cancel(),delete w.request),h()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(w=>({x:w.canonical.x,y:w.canonical.y,z:w.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new y.Event("data",{dataType:"source",sourceDataType:"content"}))}}},ot=function(w,h,_,T){const k=new Ke[h.type](w,h,_,T);if(k.id!==w)throw new Error(`Expected Source id to be ${w} instead of ${k.id}`);return y.bindAll(["load","abort","unload","serialize","prepare"],k),k};function tt(w,h){const _=y.identity([]);return y.scale(_,_,[.5*w.width,.5*-w.height,1]),y.translate(_,_,[1,-1,0]),y.multiply(_,_,w.calculateProjMatrix(h.toUnwrapped())),Float32Array.from(_)}function rt(w,h,_,T,k,P,I,M=!1){const z=w.tilesIn(T,I,M);z.sort(Dn);const G=[];for(const te of z)G.push({wrappedTileID:te.tile.tileID.wrapped().key,queryResults:te.tile.queryRenderedFeatures(h,_,w._state,te,k,P,tt(w.transform,te.tile.tileID),M)});const $=function(te){const ue={},fe={};for(const _e of te){const ye=_e.queryResults,Te=_e.wrappedTileID,de=fe[Te]=fe[Te]||{};for(const Oe in ye){const Re=ye[Oe],Fe=de[Oe]=de[Oe]||{},Ye=ue[Oe]=ue[Oe]||[];for(const We of Re)Fe[We.featureIndex]||(Fe[We.featureIndex]=!0,Ye.push(We))}}return ue}(G);for(const te in $)$[te].forEach(ue=>{const fe=ue.feature,_e=fe.layer;_e&&"background"!==_e.type&&"sky"!==_e.type&&(fe.source=_e.source,_e["source-layer"]&&(fe.sourceLayer=_e["source-layer"]),fe.state=void 0!==fe.id?w.getFeatureState(_e["source-layer"],fe.id):{})});return $}function $t(w,h){const _=w.getRenderableIds().map(P=>w.getTileByID(P)),T=[],k={};for(let P=0;P<_.length;P++){const I=_[P],M=I.tileID.canonical.key;k[M]||(k[M]=!0,I.querySourceFeatures(T,h))}return T}function Dn(w,h){const _=w.tileID,T=h.tileID;return _.overscaledZ-T.overscaledZ||_.canonical.y-T.canonical.y||_.wrap-T.wrap||_.canonical.x-T.canonical.x}function cn(){return null!=qn.workerClass?new qn.workerClass:new y.window.Worker(qn.workerUrl)}const ni="mapboxgl_preloaded_worker_pool";class Xn{constructor(){this.active={}}acquire(h){if(!this.workers)for(this.workers=[];this.workers.length<Xn.workerCount;)this.workers.push(new cn);return this.active[h]=!0,this.workers.slice()}release(h){delete this.active[h],0===this.numActive()&&(this.workers.forEach(_=>{_.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ni]}numActive(){return Object.keys(this.active).length}}let Nn;function di(){return Nn||(Nn=new Xn),Nn}function Li(w,h){const _={};for(const T in w)"ref"!==T&&(_[T]=w[T]);return y.refProperties.forEach(T=>{T in h&&(_[T]=h[T])}),_}function ur(w){w=w.slice();const h=Object.create(null);for(let _=0;_<w.length;_++)h[w[_].id]=w[_];for(let _=0;_<w.length;_++)"ref"in w[_]&&(w[_]=Li(w[_],h[w[_].ref]));return w}Xn.workerCount=2;const li={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function vr(w,h,_){_.push({command:li.addSource,args:[w,h[w]]})}function ci(w,h,_){h.push({command:li.removeSource,args:[w]}),_[w]=!0}function Mr(w,h,_,T){ci(w,_,T),vr(w,h,_)}function mo(w,h,_){let T;for(T in w[_])if(w[_].hasOwnProperty(T)&&"data"!==T&&!ze(w[_][T],h[_][T]))return!1;for(T in h[_])if(h[_].hasOwnProperty(T)&&"data"!==T&&!ze(w[_][T],h[_][T]))return!1;return!0}function Rt(w,h,_,T,k,P){let I;for(I in h=h||{},w=w||{})w.hasOwnProperty(I)&&(ze(w[I],h[I])||_.push({command:P,args:[T,I,h[I],k]}));for(I in h)h.hasOwnProperty(I)&&!w.hasOwnProperty(I)&&(ze(w[I],h[I])||_.push({command:P,args:[T,I,h[I],k]}))}function Ko(w){return w.id}function Sr(w,h){return w[h.id]=h,w}class Vn{constructor(h,_){this.reset(h,_)}reset(h,_){this.points=h||[],this._distances=[0];for(let T=1;T<this.points.length;T++)this._distances[T]=this._distances[T-1]+this.points[T].dist(this.points[T-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(_||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(h){if(1===this.points.length)return this.points[0];h=y.clamp(h,0,1);let _=1,T=this._distances[_];const k=h*this.paddedLength+this.padding;for(;T<k&&_<this._distances.length;)T=this._distances[++_];const P=_-1,I=this._distances[P],M=T-I,z=M>0?(k-I)/M:0;return this.points[P].mult(1-z).add(this.points[_].mult(z))}}class Vi{constructor(h,_,T){const k=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(h/T),this.yCellCount=Math.ceil(_/T);for(let I=0;I<this.xCellCount*this.yCellCount;I++)k.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=h,this.height=_,this.xScale=this.xCellCount/h,this.yScale=this.yCellCount/_,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(h,_,T,k,P){this._forEachCell(_,T,k,P,this._insertBoxCell,this.boxUid++),this.boxKeys.push(h),this.bboxes.push(_),this.bboxes.push(T),this.bboxes.push(k),this.bboxes.push(P)}insertCircle(h,_,T,k){this._forEachCell(_-k,T-k,_+k,T+k,this._insertCircleCell,this.circleUid++),this.circleKeys.push(h),this.circles.push(_),this.circles.push(T),this.circles.push(k)}_insertBoxCell(h,_,T,k,P,I){this.boxCells[P].push(I)}_insertCircleCell(h,_,T,k,P,I){this.circleCells[P].push(I)}_query(h,_,T,k,P,I){if(T<0||h>this.width||k<0||_>this.height)return!P&&[];const M=[];if(h<=0&&_<=0&&this.width<=T&&this.height<=k){if(P)return!0;for(let z=0;z<this.boxKeys.length;z++)M.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const G=this.circles[3*z],$=this.circles[3*z+1],te=this.circles[3*z+2];M.push({key:this.circleKeys[z],x1:G-te,y1:$-te,x2:G+te,y2:$+te})}return I?M.filter(I):M}return this._forEachCell(h,_,T,k,this._queryCell,M,{hitTest:P,seenUids:{box:{},circle:{}}},I),P?M.length>0:M}_queryCircle(h,_,T,k,P){const I=h-T,M=h+T,z=_-T,G=_+T;if(M<0||I>this.width||G<0||z>this.height)return!k&&[];const $=[];return this._forEachCell(I,z,M,G,this._queryCellCircle,$,{hitTest:k,circle:{x:h,y:_,radius:T},seenUids:{box:{},circle:{}}},P),k?$.length>0:$}query(h,_,T,k,P){return this._query(h,_,T,k,!1,P)}hitTest(h,_,T,k,P){return this._query(h,_,T,k,!0,P)}hitTestCircle(h,_,T,k){return this._queryCircle(h,_,T,!0,k)}_queryCell(h,_,T,k,P,I,M,z){const G=M.seenUids,$=this.boxCells[P];if(null!==$){const ue=this.bboxes;for(const fe of $)if(!G.box[fe]){G.box[fe]=!0;const _e=4*fe;if(h<=ue[_e+2]&&_<=ue[_e+3]&&T>=ue[_e+0]&&k>=ue[_e+1]&&(!z||z(this.boxKeys[fe]))){if(M.hitTest)return I.push(!0),!0;I.push({key:this.boxKeys[fe],x1:ue[_e],y1:ue[_e+1],x2:ue[_e+2],y2:ue[_e+3]})}}}const te=this.circleCells[P];if(null!==te){const ue=this.circles;for(const fe of te)if(!G.circle[fe]){G.circle[fe]=!0;const _e=3*fe;if(this._circleAndRectCollide(ue[_e],ue[_e+1],ue[_e+2],h,_,T,k)&&(!z||z(this.circleKeys[fe]))){if(M.hitTest)return I.push(!0),!0;{const ye=ue[_e],Te=ue[_e+1],de=ue[_e+2];I.push({key:this.circleKeys[fe],x1:ye-de,y1:Te-de,x2:ye+de,y2:Te+de})}}}}}_queryCellCircle(h,_,T,k,P,I,M,z){const G=M.circle,$=M.seenUids,te=this.boxCells[P];if(null!==te){const fe=this.bboxes;for(const _e of te)if(!$.box[_e]){$.box[_e]=!0;const ye=4*_e;if(this._circleAndRectCollide(G.x,G.y,G.radius,fe[ye+0],fe[ye+1],fe[ye+2],fe[ye+3])&&(!z||z(this.boxKeys[_e])))return I.push(!0),!0}}const ue=this.circleCells[P];if(null!==ue){const fe=this.circles;for(const _e of ue)if(!$.circle[_e]){$.circle[_e]=!0;const ye=3*_e;if(this._circlesCollide(fe[ye],fe[ye+1],fe[ye+2],G.x,G.y,G.radius)&&(!z||z(this.circleKeys[_e])))return I.push(!0),!0}}}_forEachCell(h,_,T,k,P,I,M,z){const G=this._convertToXCellCoord(h),$=this._convertToYCellCoord(_),te=this._convertToXCellCoord(T),ue=this._convertToYCellCoord(k);for(let fe=G;fe<=te;fe++)for(let _e=$;_e<=ue;_e++)if(P.call(this,h,_,T,k,this.xCellCount*_e+fe,I,M,z))return}_convertToXCellCoord(h){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(h*this.xScale)))}_convertToYCellCoord(h){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(h*this.yScale)))}_circlesCollide(h,_,T,k,P,I){const M=k-h,z=P-_,G=T+I;return G*G>M*M+z*z}_circleAndRectCollide(h,_,T,k,P,I,M){const z=(I-k)/2,G=Math.abs(h-(k+z));if(G>z+T)return!1;const $=(M-P)/2,te=Math.abs(_-(P+$));if(te>$+T)return!1;if(G<=z||te<=$)return!0;const ue=G-z,fe=te-$;return ue*ue+fe*fe<=T*T}}const Pi=Math.tan(85*Math.PI/180);function ns(w,h,_,T,k,P,I){const M=y.create();if(_)if("globe"===P.name){const z=y.calculateGlobeLabelMatrix(k,h);y.multiply(M,M,z)}else{const z=it([],I);M[0]=z[0],M[1]=z[1],M[4]=z[2],M[5]=z[3],T||y.rotateZ(M,M,k.angle)}else y.multiply(M,k.labelPlaneMatrix,w);return M}function Ka(w,h,_,T,k,P,I){const M=ns(w,h,_,T,k,P,I);return"globe"===P.name&&_||(M[2]=M[6]=M[10]=M[14]=0),M}function xo(w,h,_,T,k,P,I){if(_){if("globe"===P.name){const M=ns(w,h,_,T,k,P,I);return y.invert(M,M),y.multiply(M,w,M),M}{const M=y.clone(w),z=y.identity([]);return z[0]=I[0],z[1]=I[1],z[4]=I[2],z[5]=I[3],y.multiply(M,M,z),T||y.rotateZ(M,M,-k.angle),M}}return k.glCoordMatrix}function vn(w,h,_,T){const k=[w,h,_,1];_?y.transformMat4$1(k,k,T):Cc(k,k,T);const P=k[3];return k[0]/=P,k[1]/=P,k[2]/=P,k}function Hn(w,h){return Math.min(.5+w/h*.5,1.5)}function Ui(w,h){const _=w[0]/w[3],T=w[1]/w[3];return _>=-h[0]&&_<=h[0]&&T>=-h[1]&&T<=h[1]}function Ms(w,h,_,T,k,P,I,M,z,G){const $=_.transform,te=T?w.textSizeData:w.iconSizeData,ue=y.evaluateSizeForZoom(te,_.transform.zoom),fe="globe"===$.projection.name,_e=[256/_.width*2+1,256/_.height*2+1],ye=T?w.text.dynamicLayoutVertexArray:w.icon.dynamicLayoutVertexArray;ye.clear();let Te=null;fe&&(Te=T?w.text.globeExtVertexArray:w.icon.globeExtVertexArray);const de=w.lineVertexArray,Oe=T?w.text.placedSymbolArray:w.icon.placedSymbolArray,Re=_.transform.width/_.transform.height;let Fe,Ye=!1;for(let We=0;We<Oe.length;We++){const Xe=Oe.get(We),{numGlyphs:ut,writingMode:Et}=Xe;if(Et!==y.WritingMode.vertical||Ye||Fe===y.WritingMode.horizontal||(Ye=!0),Fe=Et,(Xe.hidden||Et===y.WritingMode.vertical)&&!Ye){xr(ut,ye);continue}Ye=!1;const At=new y.pointGeometry(Xe.tileAnchorX,Xe.tileAnchorY);let{x:on,y:wt,z:qt}=$.projection.projectTilePoint(At.x,At.y,G.canonical);if(z){const[ki,Gn,On]=z(At);on+=ki,wt+=Gn,qt+=On}const Nt=[on,wt,qt,1];if(y.transformMat4$1(Nt,Nt,h),!Ui(Nt,_e)){xr(ut,ye);continue}const sn=Hn(_.transform.cameraToCenterDistance,Nt[3]),Tt=y.evaluateSizeForFeature(te,ue,Xe),yt=I?Tt/sn:Tt*sn,Pt=vn(on,wt,qt,k);if(Pt[3]<=0){xr(ut,ye);continue}let tn={};const hn=I?null:z,$n=Hl(Xe,yt,!1,M,h,k,P,w.glyphOffsetArray,de,ye,Te,Pt,At,tn,Re,hn,$.projection,G,I);Ye=$n.useVertical,hn&&$n.needsFlipping&&(tn={}),($n.notEnoughRoom||Ye||$n.needsFlipping&&Hl(Xe,yt,!0,M,h,k,P,w.glyphOffsetArray,de,ye,Te,Pt,At,tn,Re,hn,$.projection,G,I).notEnoughRoom)&&xr(ut,ye)}T?(w.text.dynamicLayoutVertexBuffer.updateData(ye),Te&&w.text.globeExtVertexBuffer.updateData(Te)):(w.icon.dynamicLayoutVertexBuffer.updateData(ye),Te&&w.icon.globeExtVertexBuffer.updateData(Te))}function Zn(w,h,_,T,k,P,I,M,z,G,$,te,ue,fe,_e,ye){const{lineStartIndex:Te,glyphStartIndex:de,segment:Oe}=M,Re=de+M.numGlyphs,Fe=Te+M.lineLength,Ye=h.getoffsetX(de),We=h.getoffsetX(Re-1),Xe=kr(w*Ye,_,T,k,P,I,Oe,Te,Fe,z,G,$,te,ue,!0,fe,_e,ye);if(!Xe)return null;const ut=kr(w*We,_,T,k,P,I,Oe,Te,Fe,z,G,$,te,ue,!0,fe,_e,ye);return ut?{first:Xe,last:ut}:null}function Hi(w,h,_,T){return w===y.WritingMode.horizontal&&Math.abs(T)>Math.abs(_)?{useVertical:!0}:w===y.WritingMode.vertical?T>0?{needsFlipping:!0}:null:0!==h&&(0===(k=_)||Math.abs(T/k)>Pi)?1===h?{needsFlipping:!0}:null:_<0?{needsFlipping:!0}:null;var k}function Hl(w,h,_,T,k,P,I,M,z,G,$,te,ue,fe,_e,ye,Te,de,Oe){const Re=h/24,Fe=w.lineOffsetX*Re,Ye=w.lineOffsetY*Re,{lineStartIndex:We,glyphStartIndex:Xe,numGlyphs:ut,segment:Et,writingMode:At,flipState:on}=w,wt=We+w.lineLength,qt=Nt=>{if($){const[Pt,tn,hn]=Nt.up,$n=G.length;y.updateGlobeVertexNormal($,$n+0,Pt,tn,hn),y.updateGlobeVertexNormal($,$n+1,Pt,tn,hn),y.updateGlobeVertexNormal($,$n+2,Pt,tn,hn),y.updateGlobeVertexNormal($,$n+3,Pt,tn,hn)}const[sn,Tt,yt]=Nt.point;y.addDynamicAttributes(G,sn,Tt,yt,Nt.angle)};if(ut>1){const Nt=Zn(Re,M,Fe,Ye,_,te,ue,w,z,P,fe,ye,!1,Te,de,Oe);if(!Nt)return{notEnoughRoom:!0};if(T&&!_){let[sn,Tt,yt]=Nt.first.point,[Pt,tn,hn]=Nt.last.point;[sn,Tt]=vn(sn,Tt,yt,I),[Pt,tn]=vn(Pt,tn,hn,I);const $n=Hi(At,on,(Pt-sn)*_e,tn-Tt);if(w.flipState=$n&&$n.needsFlipping?1:2,$n)return $n}qt(Nt.first);for(let sn=Xe+1;sn<Xe+ut-1;sn++){const Tt=kr(Re*M.getoffsetX(sn),Fe,Ye,_,te,ue,Et,We,wt,z,P,fe,ye,!1,!1,Te,de,Oe);if(!Tt)return G.length-=4*(sn-Xe),{notEnoughRoom:!0};qt(Tt)}qt(Nt.last)}else{if(T&&!_){const sn=vn(ue.x,ue.y,0,k),Tt=We+Et+1,yt=new y.pointGeometry(z.getx(Tt),z.gety(Tt)),Pt=vn(yt.x,yt.y,0,k),tn=Pt[3]>0?Pt:$s(ue,yt,sn,1,k,void 0,Te,de.canonical),hn=Hi(At,on,(tn[0]-sn[0])*_e,tn[1]-sn[1]);if(w.flipState=hn&&hn.needsFlipping?1:2,hn)return hn}const Nt=kr(Re*M.getoffsetX(Xe),Fe,Ye,_,te,ue,Et,We,wt,z,P,fe,ye,!1,!1,Te,de,Oe);if(!Nt)return{notEnoughRoom:!0};qt(Nt)}return{}}function pl(w,h,_,T,k){const{x:P,y:I,z:M}=T.projectTilePoint(w.x,w.y,h);if(!k)return vn(P,I,M,_);const[z,G,$]=k(w);return vn(P+z,I+G,M+$,_)}function $s(w,h,_,T,k,P,I,M){const z=pl(w.sub(h)._unit()._add(w),M,k,I,P);return y.sub(z,_,z),y.normalize(z,z),y.scaleAndAdd(z,_,z,T)}function kr(w,h,_,T,k,P,I,M,z,G,$,te,ue,fe,_e,ye,Te,de){const Oe=T?w-h:w+h;let Re=Oe>0?1:-1,Fe=0;T&&(Re*=-1,Fe=Math.PI),Re<0&&(Fe+=Math.PI);let Ye=M+I+(Re>0?0:1)|0,We=k,Xe=k,ut=0,Et=0;const At=Math.abs(Oe),on=[],wt=[];let qt=P,Nt=qt;const sn=()=>$s(Nt,qt,Xe,At-ut+1,$,ue,ye,Te.canonical);for(;ut+Et<=At;){if(Ye+=Re,Ye<M||Ye>=z)return null;if(Xe=We,Nt=qt,on.push(Xe),fe&&wt.push(Nt),qt=new y.pointGeometry(G.getx(Ye),G.gety(Ye)),We=te[Ye],!We){const On=pl(qt,Te.canonical,$,ye,ue);We=On[3]>0?te[Ye]=On:sn()}ut+=Et,Et=y.distance(Xe,We)}_e&&ue&&(te[Ye]&&(We=sn(),Et=y.distance(Xe,We)),te[Ye]=We);const Tt=(At-ut)/Et,yt=qt.sub(Nt)._mult(Tt)._add(Nt),Pt=y.sub([],We,Xe),tn=y.scaleAndAdd([],Xe,Pt,Tt);let hn=[0,0,1],$n=Pt[0],ki=Pt[1];if(de&&(hn=ye.upVector(Te.canonical,yt.x,yt.y),0!==hn[0]||0!==hn[1]||1!==hn[2])){const On=[hn[2],0,-hn[0]],Jn=y.cross([],hn,On);y.normalize(On,On),y.normalize(Jn,Jn),$n=y.dot(Pt,On),ki=y.dot(Pt,Jn)}if(_){const On=y.cross([],hn,Pt);y.normalize(On,On),y.scaleAndAdd(tn,tn,On,_*Re)}const Gn=Fe+Math.atan2(ki,$n);return on.push(tn),fe&&wt.push(yt),{point:tn,angle:Gn,path:on,tilePath:wt,up:hn}}function xr(w,h){const _=h.length,T=_+4*w;h.resize(T),h.float32.fill(-1/0,4*_,4*T)}function Cc(w,h,_){const T=h[0],k=h[1];return w[0]=_[0]*T+_[4]*k+_[12],w[1]=_[1]*T+_[5]*k+_[13],w[3]=_[3]*T+_[7]*k+_[15],w}const Zr=100;class ta{constructor(h,_,T=new Vi(h.width+200,h.height+200,25),k=new Vi(h.width+200,h.height+200,25)){this.transform=h,this.grid=T,this.ignoredGrid=k,this.pitchfactor=Math.cos(h._pitch)*h.cameraToCenterDistance,this.screenRightBoundary=h.width+Zr,this.screenBottomBoundary=h.height+Zr,this.gridRightBoundary=h.width+200,this.gridBottomBoundary=h.height+200,this.fogState=_}placeCollisionBox(h,_,T,k,P,I,M,z){let G=T.projectedAnchorX,$=T.projectedAnchorY,te=T.projectedAnchorZ;const ue=T.elevation,fe=T.tileID,_e=h.getProjection();if(ue&&fe){const[We,Xe,ut]=_e.upVector(fe.canonical,T.tileAnchorX,T.tileAnchorY),Et=_e.upVectorScale(fe.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;G+=We*ue*Et,$+=Xe*ue*Et,te+=ut*ue*Et}const ye=this.projectAndGetPerspectiveRatio(M,G,$,te,T.tileID,"globe"===_e.name||!!ue||this.transform.pitch>0,_e),Te=I*ye.perspectiveRatio,de=(T.x1*_+k.x-T.padding)*Te+ye.point.x,Oe=(T.y1*_+k.y-T.padding)*Te+ye.point.y,Re=(T.x2*_+k.x+T.padding)*Te+ye.point.x,Fe=(T.y2*_+k.y+T.padding)*Te+ye.point.y,Ye=ye.perspectiveRatio<=.55||ye.occluded;return!this.isInsideGrid(de,Oe,Re,Fe)||!P&&this.grid.hitTest(de,Oe,Re,Fe,z)||Ye?{box:[],offscreen:!1,occluded:ye.occluded}:{box:[de,Oe,Re,Fe],offscreen:this.isOffscreen(de,Oe,Re,Fe),occluded:!1}}placeCollisionCircles(h,_,T,k,P,I,M,z,G,$,te,ue,fe,_e,ye){const Te=[],de=this.transform.elevation,Oe=h.getProjection(),Re=de?de.getAtTileOffsetFunc(ye,this.transform.center.lat,this.transform.worldSize,Oe):null,Fe=new y.pointGeometry(T.tileAnchorX,T.tileAnchorY);let{x:Ye,y:We,z:Xe}=Oe.projectTilePoint(Fe.x,Fe.y,ye.canonical);if(Re){const[yt,Pt,tn]=Re(Fe);Ye+=yt,We+=Pt,Xe+=tn}const ut="globe"===Oe.name,Et=this.projectAndGetPerspectiveRatio(M,Ye,We,Xe,ye,ut||!!de||this.transform.pitch>0,Oe),{perspectiveRatio:At}=Et,on=(te?I/At:I*At)/y.ONE_EM,wt=vn(Ye,We,Xe,z),qt=Et.signedDistanceFromCamera>0?Zn(on,P,T.lineOffsetX*on,T.lineOffsetY*on,!1,wt,Fe,T,k,z,{},de&&!te?Re:null,te&&!!de,Oe,ye,te):null;let Nt=!1,sn=!1,Tt=!0;if(qt&&!Et.occluded){const yt=.5*fe*At+_e,Pt=new y.pointGeometry(-100,-100),tn=new y.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),hn=new Vn,{first:$n,last:ki}=qt,Gn=$n.path.length;let On=[];for(let hi=Gn-1;hi>=1;hi--)On.push($n.path[hi]);for(let hi=1;hi<ki.path.length;hi++)On.push(ki.path[hi]);const Jn=2.5*yt;G&&(On=On.map(([hi,Lr,Hr],Xr)=>(Re&&!ut&&(Hr=Re(Xr<Gn-1?$n.tilePath[Gn-1-Xr]:ki.tilePath[Xr-Gn+2])[2]),vn(hi,Lr,Hr,G))),On.some(hi=>hi[3]<=0)&&(On=[]));let sr=[];if(On.length>0){let hi=1/0,Lr=-1/0,Hr=1/0,Xr=-1/0;for(const Kr of On)hi=Math.min(hi,Kr[0]),Hr=Math.min(Hr,Kr[1]),Lr=Math.max(Lr,Kr[0]),Xr=Math.max(Xr,Kr[1]);Lr>=Pt.x&&hi<=tn.x&&Xr>=Pt.y&&Hr<=tn.y&&(sr=[On.map(Kr=>new y.pointGeometry(Kr[0],Kr[1]))],(hi<Pt.x||Lr>tn.x||Hr<Pt.y||Xr>tn.y)&&(sr=y.clipLine(sr,Pt.x,Pt.y,tn.x,tn.y)))}for(const hi of sr){hn.reset(hi,.25*yt);let Lr=0;Lr=hn.length<=.5*yt?1:Math.ceil(hn.paddedLength/Jn)+1;for(let Hr=0;Hr<Lr;Hr++){const Xr=Hr/Math.max(Lr-1,1),Kr=hn.lerp(Xr),is=Kr.x+Zr,sa=Kr.y+Zr;Te.push(is,sa,yt,0);const Dl=is-yt,mu=sa-yt,eo=is+yt,hr=sa+yt;if(Tt=Tt&&this.isOffscreen(Dl,mu,eo,hr),sn=sn||this.isInsideGrid(Dl,mu,eo,hr),!_&&this.grid.hitTestCircle(is,sa,yt,ue)&&(Nt=!0,!$))return{circles:[],offscreen:!1,collisionDetected:Nt,occluded:!1}}}}return{circles:!$&&Nt||!sn?[]:Te,offscreen:Tt,collisionDetected:Nt,occluded:Et.occluded}}queryRenderedSymbols(h){if(0===h.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const _=[];let T=1/0,k=1/0,P=-1/0,I=-1/0;for(const $ of h){const te=new y.pointGeometry($.x+Zr,$.y+Zr);T=Math.min(T,te.x),k=Math.min(k,te.y),P=Math.max(P,te.x),I=Math.max(I,te.y),_.push(te)}const M=this.grid.query(T,k,P,I).concat(this.ignoredGrid.query(T,k,P,I)),z={},G={};for(const $ of M){const te=$.key;if(void 0===z[te.bucketInstanceId]&&(z[te.bucketInstanceId]={}),z[te.bucketInstanceId][te.featureIndex])continue;const ue=[new y.pointGeometry($.x1,$.y1),new y.pointGeometry($.x2,$.y1),new y.pointGeometry($.x2,$.y2),new y.pointGeometry($.x1,$.y2)];y.polygonIntersectsPolygon(_,ue)&&(z[te.bucketInstanceId][te.featureIndex]=!0,void 0===G[te.bucketInstanceId]&&(G[te.bucketInstanceId]=[]),G[te.bucketInstanceId].push(te.featureIndex))}return G}insertCollisionBox(h,_,T,k,P){(_?this.ignoredGrid:this.grid).insert({bucketInstanceId:T,featureIndex:k,collisionGroupID:P},h[0],h[1],h[2],h[3])}insertCollisionCircles(h,_,T,k,P){const I=_?this.ignoredGrid:this.grid,M={bucketInstanceId:T,featureIndex:k,collisionGroupID:P};for(let z=0;z<h.length;z+=4)I.insertCircle(M,h[z],h[z+1],h[z+2])}projectAndGetPerspectiveRatio(h,_,T,k,P,I,M){const z=[_,T,k,1];let G=!1;k||this.transform.pitch>0?(y.transformMat4$1(z,z,h),this.fogState&&P&&"globe"!==M.name&&(G=function(fe,_e,ye,Te,de,Oe){const Re=Oe.calculateFogTileMatrix(de),Fe=[_e,ye,Te];return y.transformMat4(Fe,Fe,Re),ai(fe,Fe,Oe.pitch,Oe._fov)}(this.fogState,_,T,k,P.toUnwrapped(),this.transform)>.9)):Cc(z,z,h);const $=z[3];return{point:new y.pointGeometry((z[0]/$+1)/2*this.transform.width+Zr,(-z[1]/$+1)/2*this.transform.height+Zr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(M)/$*.5,1.5),signedDistanceFromCamera:$,occluded:I&&z[2]>$||G}}isOffscreen(h,_,T,k){return T<Zr||h>=this.screenRightBoundary||k<Zr||_>this.screenBottomBoundary}isInsideGrid(h,_,T,k){return T>=0&&h<this.gridRightBoundary&&k>=0&&_<this.gridBottomBoundary}getViewportMatrix(){const h=y.identity([]);return y.translate(h,h,[-100,-100,0]),h}}function qr(w,h,_){const T=h.createTileMatrix(w,w.worldSize,_.toUnwrapped());return y.multiply(new Float32Array(16),w.projMatrix,T)}function Ki(w,h,_){if(h.projection.name===_.projection.name)return w.projMatrix;const T=_.clone();return T.setProjection(h.projection),qr(T,h.getProjection(),w)}function Ya(w,h,_){return h.name===_.projection.name?w.projMatrix:qr(_,h,w)}class ks{constructor(h,_,T,k){this.opacity=h?Math.max(0,Math.min(1,h.opacity+(h.placed?_:-_))):k&&T?1:0,this.placed=T}isHidden(){return 0===this.opacity&&!this.placed}}class fl{constructor(h,_,T,k,P,I=!1){this.text=new ks(h?h.text:null,_,T,P),this.icon=new ks(h?h.icon:null,_,k,P),this.clipped=I}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class jl{constructor(h,_,T,k=!1){this.text=h,this.icon=_,this.skipFade=T,this.clipped=k}}class Ja{constructor(){this.invProjMatrix=y.create(),this.viewportMatrix=y.create(),this.circles=[]}}class go{constructor(h,_,T,k,P){this.bucketInstanceId=h,this.featureIndex=_,this.sourceLayerIndex=T,this.bucketIndex=k,this.tileID=P}}class Qi{constructor(h){this.crossSourceCollisions=h,this.maxGroupID=0,this.collisionGroups={}}get(h){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[h]){const _=++this.maxGroupID;this.collisionGroups[h]={ID:_,predicate:T=>T.collisionGroupID===_}}return this.collisionGroups[h]}}function jd(w,h,_,T,k){const{horizontalAlign:P,verticalAlign:I}=y.getAnchorAlignment(w),M=-(P-.5)*h,z=-(I-.5)*_,G=y.evaluateVariableOffset(w,T);return new y.pointGeometry(M+G[0]*k,z+G[1]*k)}function Rs(w,h,_,T,k){const P=new y.pointGeometry(w,h);return _&&P._rotate(T?k:-k),P}class uo{constructor(h,_,T,k,P){this.transform=h.clone(),this.projection=h.projection.name,this.collisionIndex=new ta(this.transform,P),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=_,this.retainedQueryData={},this.collisionGroups=new Qi(T),this.collisionCircleArrays={},this.prevPlacement=k,k&&(k.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(h,_,T,k){const P=T.getBucket(_),I=T.latestFeatureIndex;if(!P||!I||_.id!==P.layerIds[0])return;const M=P.layers[0].layout,z=T.collisionBoxArray,G=Math.pow(2,this.transform.zoom-T.tileID.overscaledZ),$=T.tileSize/y.EXTENT,te=T.tileID.toUnwrapped();this.transform.setProjection(P.projection);const ue=(fe=T.tileID,_e=P.getProjection(),ye=this.transform,_e.name===this.projection?ye.calculateProjMatrix(fe.toUnwrapped()):qr(ye,_e,fe));var fe,_e,ye;const Te="map"===M.get("text-pitch-alignment"),de="map"===M.get("text-rotation-alignment");_.compileFilter();const Oe=_.dynamicFilter(),Re=_.dynamicFilterNeedsFeature(),Fe=this.transform.calculatePixelsToTileUnitsMatrix(T),Ye=Ka(ue,T.tileID.canonical,Te,de,this.transform,P.getProjection(),Fe);let We=null;if(Te){const Et=xo(ue,T.tileID.canonical,Te,de,this.transform,P.getProjection(),Fe);We=y.multiply([],this.transform.labelPlaneMatrix,Et)}let Xe=null;Oe&&T.latestFeatureIndex&&(Xe={unwrappedTileID:te,dynamicFilter:Oe,dynamicFilterNeedsFeature:Re,featureIndex:T.latestFeatureIndex}),this.retainedQueryData[P.bucketInstanceId]=new go(P.bucketInstanceId,I,P.sourceLayerIndex,P.index,T.tileID);const ut={bucket:P,layout:M,posMatrix:ue,textLabelPlaneMatrix:Ye,labelToScreenMatrix:We,clippingData:Xe,scale:G,textPixelRatio:$,holdingForFade:T.holdingForFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:y.evaluateSizeForZoom(P.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:y.evaluateSizeForZoom(P.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(P.sourceID)};if(k)for(const Et of P.sortKeyRanges){const{sortKey:At,symbolInstanceStart:on,symbolInstanceEnd:wt}=Et;h.push({sortKey:At,symbolInstanceStart:on,symbolInstanceEnd:wt,parameters:ut})}else h.push({symbolInstanceStart:0,symbolInstanceEnd:P.symbolInstances.length,parameters:ut})}attemptAnchorPlacement(h,_,T,k,P,I,M,z,G,$,te,ue,fe,_e,ye,Te,de,Oe){const{textOffset0:Re,textOffset1:Fe,crossTileID:Ye}=ue,We=[Re,Fe],Xe=jd(h,T,k,We,P),ut=this.collisionIndex.placeCollisionBox(_e,P,_,Rs(Xe.x,Xe.y,I,M,this.transform.angle),te,z,G,$.predicate);if(Te){const Et=_e.getSymbolInstanceIconSize(Oe,this.transform.zoom,ue.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(_e,Et,Te,Rs(Xe.x,Xe.y,I,M,this.transform.angle),te,z,G,$.predicate).box.length)return}if(ut.box.length>0){let Et;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ye]&&this.prevPlacement.placements[Ye]&&this.prevPlacement.placements[Ye].text&&(Et=this.prevPlacement.variableOffsets[Ye].anchor),this.variableOffsets[Ye]={textOffset:We,width:T,height:k,anchor:h,textScale:P,prevAnchor:Et},this.markUsedJustification(_e,h,ue,ye),_e.allowVerticalPlacement&&(this.markUsedOrientation(_e,ye,ue),this.placedOrientations[Ye]=ye),{shift:Xe,placedGlyphBoxes:ut}}}placeLayerBucketPart(h,_,T,k){const{bucket:P,layout:I,posMatrix:M,textLabelPlaneMatrix:z,labelToScreenMatrix:G,clippingData:$,textPixelRatio:te,holdingForFade:ue,collisionBoxArray:fe,partiallyEvaluatedTextSize:_e,partiallyEvaluatedIconSize:ye,collisionGroup:Te}=h.parameters,de=I.get("text-optional"),Oe=I.get("icon-optional"),Re=I.get("text-allow-overlap"),Fe=I.get("icon-allow-overlap"),Ye="map"===I.get("text-rotation-alignment"),We="map"===I.get("text-pitch-alignment"),Xe="none"!==I.get("icon-text-fit"),ut="viewport-y"===I.get("symbol-z-order");this.transform.setProjection(P.projection);let Et=Re&&(Fe||!P.hasIconData()||Oe),At=Fe&&(Re||!P.hasTextData()||de);!P.collisionArrays&&fe&&P.deserializeCollisionBoxes(fe),T&&k&&P.updateCollisionDebugBuffers(this.transform.zoom,fe);const on=(wt,qt,Nt)=>{const{crossTileID:sn,numVerticalGlyphVertices:Tt}=wt;if($){const eo={zoom:this.transform.zoom,pitch:this.transform.pitch};let hr=null;if($.dynamicFilterNeedsFeature){const gr=this.retainedQueryData[P.bucketInstanceId];hr=$.featureIndex.loadFeature({featureIndex:wt.featureIndex,bucketIndex:gr.bucketIndex,sourceLayerIndex:gr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,$.dynamicFilter)(eo,hr,this.retainedQueryData[P.bucketInstanceId].tileID.canonical,new y.pointGeometry(wt.tileAnchorX,wt.tileAnchorY),this.transform.calculateDistanceTileData($.unwrappedTileID)))return this.placements[sn]=new jl(!1,!1,!1,!0),void(_[sn]=!0)}if(_[sn])return;if(ue)return void(this.placements[sn]=new jl(!1,!1,!1));let yt=!1,Pt=!1,tn=!0,hn=!1,$n=!1,ki=null,Gn={box:null,offscreen:null,occluded:null},On={box:null,offscreen:null,occluded:null},Jn=null,sr=null,hi=null,Lr=0,Hr=0,Xr=0;Nt.textFeatureIndex?Lr=Nt.textFeatureIndex:wt.useRuntimeCollisionCircles&&(Lr=wt.featureIndex),Nt.verticalTextFeatureIndex&&(Hr=Nt.verticalTextFeatureIndex);const Kr=eo=>{eo.tileID=this.retainedQueryData[P.bucketInstanceId].tileID;const hr=this.transform.elevation;(hr||eo.elevation)&&(eo.elevation=hr?hr.getAtTileOffset(eo.tileID,eo.tileAnchorX,eo.tileAnchorY):0)},is=Nt.textBox;if(is){Kr(is);const eo=gr=>{let Lo=y.WritingMode.horizontal;if(P.allowVerticalPlacement&&!gr&&this.prevPlacement){const aa=this.prevPlacement.placedOrientations[sn];aa&&(this.placedOrientations[sn]=aa,Lo=aa,this.markUsedOrientation(P,Lo,wt))}return Lo},hr=(gr,Lo)=>{if(P.allowVerticalPlacement&&Tt>0&&Nt.verticalTextBox){for(const aa of P.writingModes)if(aa===y.WritingMode.vertical?(Gn=Lo(),On=Gn):Gn=gr(),Gn&&Gn.box&&Gn.box.length)break}else Gn=gr()};if(I.get("text-variable-anchor")){let gr=I.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[sn]){const Fr=this.prevPlacement.variableOffsets[sn];gr.indexOf(Fr.anchor)>0&&(gr=gr.filter(Fs=>Fs!==Fr.anchor),gr.unshift(Fr.anchor))}const Lo=(Fr,Fs,Ns)=>{const gu=P.getSymbolInstanceTextSize(_e,wt,this.transform.zoom,qt),Ih=(Fr.x2-Fr.x1)*gu+2*Fr.padding,Ba=(Fr.y2-Fr.y1)*gu+2*Fr.padding,rl=Xe&&!Fe?Fs:null;rl&&Kr(rl);let to={box:[],offscreen:!1,occluded:!1};const yo=Re?2*gr.length:gr.length;for(let sc=0;sc<yo;++sc){const md=this.attemptAnchorPlacement(gr[sc%gr.length],Fr,Ih,Ba,gu,Ye,We,te,M,Te,sc>=gr.length,wt,qt,P,Ns,rl,_e,ye);if(md&&(to=md.placedGlyphBoxes,to&&to.box&&to.box.length)){yt=!0,ki=md.shift;break}}return to};hr(()=>Lo(is,Nt.iconBox,y.WritingMode.horizontal),()=>{const Fr=Nt.verticalTextBox;return Fr&&Kr(Fr),P.allowVerticalPlacement&&!(Gn&&Gn.box&&Gn.box.length)&&Tt>0&&Fr?Lo(Fr,Nt.verticalIconBox,y.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Gn&&(yt=Gn.box,tn=Gn.offscreen,hn=Gn.occluded);const aa=eo(Gn&&Gn.box);if(!yt&&this.prevPlacement){const Fr=this.prevPlacement.variableOffsets[sn];Fr&&(this.variableOffsets[sn]=Fr,this.markUsedJustification(P,Fr.anchor,wt,aa))}}else{const gr=(Lo,aa)=>{const Fr=P.getSymbolInstanceTextSize(_e,wt,this.transform.zoom,qt),Fs=this.collisionIndex.placeCollisionBox(P,Fr,Lo,new y.pointGeometry(0,0),Re,te,M,Te.predicate);return Fs&&Fs.box&&Fs.box.length&&(this.markUsedOrientation(P,aa,wt),this.placedOrientations[sn]=aa),Fs};hr(()=>gr(is,y.WritingMode.horizontal),()=>{const Lo=Nt.verticalTextBox;return P.allowVerticalPlacement&&Tt>0&&Lo?(Kr(Lo),gr(Lo,y.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),eo(Gn&&Gn.box&&Gn.box.length)}}if(Jn=Gn,yt=Jn&&Jn.box&&Jn.box.length>0,tn=Jn&&Jn.offscreen,hn=Jn&&Jn.occluded,wt.useRuntimeCollisionCircles){const eo=P.text.placedSymbolArray.get(wt.centerJustifiedTextSymbolIndex>=0?wt.centerJustifiedTextSymbolIndex:wt.verticalPlacedTextSymbolIndex),hr=y.evaluateSizeForFeature(P.textSizeData,_e,eo),gr=I.get("text-padding");sr=this.collisionIndex.placeCollisionCircles(P,Re,eo,P.lineVertexArray,P.glyphOffsetArray,hr,M,z,G,T,We,Te.predicate,wt.collisionCircleDiameter*hr/y.ONE_EM,gr,this.retainedQueryData[P.bucketInstanceId].tileID),yt=Re||sr.circles.length>0&&!sr.collisionDetected,tn=tn&&sr.offscreen,hn=sr.occluded}if(Nt.iconFeatureIndex&&(Xr=Nt.iconFeatureIndex),Nt.iconBox){const eo=hr=>{Kr(hr);const gr=Xe&&ki?Rs(ki.x,ki.y,Ye,We,this.transform.angle):new y.pointGeometry(0,0),Lo=P.getSymbolInstanceIconSize(ye,this.transform.zoom,wt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(P,Lo,hr,gr,Fe,te,M,Te.predicate)};On&&On.box&&On.box.length&&Nt.verticalIconBox?(hi=eo(Nt.verticalIconBox),Pt=hi.box.length>0):(hi=eo(Nt.iconBox),Pt=hi.box.length>0),tn=tn&&hi.offscreen,$n=hi.occluded}const sa=de||0===wt.numHorizontalGlyphVertices&&0===Tt,Dl=Oe||0===wt.numIconVertices;if(sa||Dl?Dl?sa||(Pt=Pt&&yt):yt=Pt&&yt:Pt=yt=Pt&&yt,yt&&Jn&&Jn.box&&this.collisionIndex.insertCollisionBox(Jn.box,I.get("text-ignore-placement"),P.bucketInstanceId,On&&On.box&&Hr?Hr:Lr,Te.ID),Pt&&hi&&this.collisionIndex.insertCollisionBox(hi.box,I.get("icon-ignore-placement"),P.bucketInstanceId,Xr,Te.ID),sr&&(yt&&this.collisionIndex.insertCollisionCircles(sr.circles,I.get("text-ignore-placement"),P.bucketInstanceId,Lr,Te.ID),T)){const eo=P.bucketInstanceId;let hr=this.collisionCircleArrays[eo];void 0===hr&&(hr=this.collisionCircleArrays[eo]=new Ja);for(let gr=0;gr<sr.circles.length;gr+=4)hr.circles.push(sr.circles[gr+0]),hr.circles.push(sr.circles[gr+1]),hr.circles.push(sr.circles[gr+2]),hr.circles.push(sr.collisionDetected?1:0)}const mu="globe"!==P.projection.name;Et=Et&&(mu||!hn),At=At&&(mu||!$n),this.placements[sn]=new jl(yt||Et,Pt||At,tn||P.justReloaded),_[sn]=!0};if(ut){const wt=P.getSortedSymbolIndexes(this.transform.angle);for(let qt=wt.length-1;qt>=0;--qt){const Nt=wt[qt];on(P.symbolInstances.get(Nt),Nt,P.collisionArrays[Nt])}}else for(let wt=h.symbolInstanceStart;wt<h.symbolInstanceEnd;wt++)on(P.symbolInstances.get(wt),wt,P.collisionArrays[wt]);if(T&&P.bucketInstanceId in this.collisionCircleArrays){const wt=this.collisionCircleArrays[P.bucketInstanceId];y.invert(wt.invProjMatrix,M),wt.viewportMatrix=this.collisionIndex.getViewportMatrix()}P.justReloaded=!1}markUsedJustification(h,_,T,k){const{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:M,verticalPlacedTextSymbolIndex:z,crossTileID:G}=T,$=y.getAnchorJustification(_),te=k===y.WritingMode.vertical?z:"left"===$?P:"center"===$?I:"right"===$?M:-1;P>=0&&(h.text.placedSymbolArray.get(P).crossTileID=te>=0&&P!==te?0:G),I>=0&&(h.text.placedSymbolArray.get(I).crossTileID=te>=0&&I!==te?0:G),M>=0&&(h.text.placedSymbolArray.get(M).crossTileID=te>=0&&M!==te?0:G),z>=0&&(h.text.placedSymbolArray.get(z).crossTileID=te>=0&&z!==te?0:G)}markUsedOrientation(h,_,T){const k=_===y.WritingMode.horizontal||_===y.WritingMode.horizontalOnly?_:0,P=_===y.WritingMode.vertical?_:0,{leftJustifiedTextSymbolIndex:I,centerJustifiedTextSymbolIndex:M,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:G}=T,$=h.text.placedSymbolArray;I>=0&&($.get(I).placedOrientation=k),M>=0&&($.get(M).placedOrientation=k),z>=0&&($.get(z).placedOrientation=k),G>=0&&($.get(G).placedOrientation=P)}commit(h){this.commitTime=h,this.zoomAtLastRecencyCheck=this.transform.zoom;const _=this.prevPlacement;let T=!1;this.prevZoomAdjustment=_?_.zoomAdjustment(this.transform.zoom):0;const k=_?_.symbolFadeChange(h):1,P=_?_.opacities:{},I=_?_.variableOffsets:{},M=_?_.placedOrientations:{};for(const z in this.placements){const G=this.placements[z],$=P[z];$?(this.opacities[z]=new fl($,k,G.text,G.icon,null,G.clipped),T=T||G.text!==$.text.placed||G.icon!==$.icon.placed):(this.opacities[z]=new fl(null,k,G.text,G.icon,G.skipFade,G.clipped),T=T||G.text||G.icon)}for(const z in P){const G=P[z];if(!this.opacities[z]){const $=new fl(G,k,!1,!1);$.isHidden()||(this.opacities[z]=$,T=T||G.text.placed||G.icon.placed)}}for(const z in I)this.variableOffsets[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.variableOffsets[z]=I[z]);for(const z in M)this.placedOrientations[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.placedOrientations[z]=M[z]);T?this.lastPlacementChangeTime=h:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=_?_.lastPlacementChangeTime:h)}updateLayerOpacities(h,_){const T={};for(const k of _){const P=k.getBucket(h);P&&k.latestFeatureIndex&&h.id===P.layerIds[0]&&this.updateBucketOpacities(P,T,k.collisionBoxArray)}}updateBucketOpacities(h,_,T){h.hasTextData()&&h.text.opacityVertexArray.clear(),h.hasIconData()&&h.icon.opacityVertexArray.clear(),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexArray.clear(),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexArray.clear();const k=h.layers[0].layout,P=!!h.layers[0].dynamicFilter(),I=new fl(null,0,!1,!1,!0),M=k.get("text-allow-overlap"),z=k.get("icon-allow-overlap"),G=k.get("text-variable-anchor"),$="map"===k.get("text-rotation-alignment"),te="map"===k.get("text-pitch-alignment"),ue="none"!==k.get("icon-text-fit"),fe=new fl(null,0,M&&(z||!h.hasIconData()||k.get("icon-optional")),z&&(M||!h.hasTextData()||k.get("text-optional")),!0);!h.collisionArrays&&T&&(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData())&&h.deserializeCollisionBoxes(T);const _e=(Te,de,Oe)=>{for(let Re=0;Re<de/4;Re++)Te.opacityVertexArray.emplaceBack(Oe)};let ye=0;for(let Te=0;Te<h.symbolInstances.length;Te++){const de=h.symbolInstances.get(Te),{numHorizontalGlyphVertices:Oe,numVerticalGlyphVertices:Re,crossTileID:Fe,numIconVertices:Ye}=de;let We=this.opacities[Fe];_[Fe]?We=I:We||(We=fe,this.opacities[Fe]=We),_[Fe]=!0;const Xe=Oe>0||Re>0,ut=Ye>0,Et=this.placedOrientations[Fe],At=Et===y.WritingMode.vertical,on=Et===y.WritingMode.horizontal||Et===y.WritingMode.horizontalOnly;if(!Xe&&!ut||We.isHidden()||ye++,Xe){const wt=Ec(We.text);_e(h.text,Oe,At?ph:wt),_e(h.text,Re,on?ph:wt);const qt=We.text.isHidden(),{leftJustifiedTextSymbolIndex:Nt,centerJustifiedTextSymbolIndex:sn,rightJustifiedTextSymbolIndex:Tt,verticalPlacedTextSymbolIndex:yt}=de,Pt=h.text.placedSymbolArray,tn=qt||At?1:0;Nt>=0&&(Pt.get(Nt).hidden=tn),sn>=0&&(Pt.get(sn).hidden=tn),Tt>=0&&(Pt.get(Tt).hidden=tn),yt>=0&&(Pt.get(yt).hidden=qt||on?1:0);const hn=this.variableOffsets[Fe];hn&&this.markUsedJustification(h,hn.anchor,de,Et);const $n=this.placedOrientations[Fe];$n&&(this.markUsedJustification(h,"left",de,$n),this.markUsedOrientation(h,$n,de))}if(ut){const wt=Ec(We.icon),{placedIconSymbolIndex:qt,verticalPlacedIconSymbolIndex:Nt}=de,sn=h.icon.placedSymbolArray,Tt=We.icon.isHidden()?1:0;qt>=0&&(_e(h.icon,Ye,At?ph:wt),sn.get(qt).hidden=Tt),Nt>=0&&(_e(h.icon,de.numVerticalIconVertices,on?ph:wt),sn.get(Nt).hidden=Tt)}if(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData()){const wt=h.collisionArrays[Te];if(wt){let qt=new y.pointGeometry(0,0),Nt=!0;if(wt.textBox||wt.verticalTextBox){if(G){const Tt=this.variableOffsets[Fe];Tt?(qt=jd(Tt.anchor,Tt.width,Tt.height,Tt.textOffset,Tt.textScale),$&&qt._rotate(te?this.transform.angle:-this.transform.angle)):Nt=!1}P&&(Nt=!We.clipped),wt.textBox&&ko(h.textCollisionBox.collisionVertexArray,We.text.placed,!Nt||At,qt.x,qt.y),wt.verticalTextBox&&ko(h.textCollisionBox.collisionVertexArray,We.text.placed,!Nt||on,qt.x,qt.y)}const sn=Nt&&Boolean(!on&&wt.verticalIconBox);wt.iconBox&&ko(h.iconCollisionBox.collisionVertexArray,We.icon.placed,sn,ue?qt.x:0,ue?qt.y:0),wt.verticalIconBox&&ko(h.iconCollisionBox.collisionVertexArray,We.icon.placed,!sn,ue?qt.x:0,ue?qt.y:0)}}}if(h.fullyClipped=0===ye,h.sortFeatures(this.transform.angle),this.retainedQueryData[h.bucketInstanceId]&&(this.retainedQueryData[h.bucketInstanceId].featureSortOrder=h.featureSortOrder),h.hasTextData()&&h.text.opacityVertexBuffer&&h.text.opacityVertexBuffer.updateData(h.text.opacityVertexArray),h.hasIconData()&&h.icon.opacityVertexBuffer&&h.icon.opacityVertexBuffer.updateData(h.icon.opacityVertexArray),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexBuffer&&h.iconCollisionBox.collisionVertexBuffer.updateData(h.iconCollisionBox.collisionVertexArray),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexBuffer&&h.textCollisionBox.collisionVertexBuffer.updateData(h.textCollisionBox.collisionVertexArray),h.bucketInstanceId in this.collisionCircleArrays){const Te=this.collisionCircleArrays[h.bucketInstanceId];h.placementInvProjMatrix=Te.invProjMatrix,h.placementViewportMatrix=Te.viewportMatrix,h.collisionCircleArray=Te.circles,delete this.collisionCircleArrays[h.bucketInstanceId]}}symbolFadeChange(h){return 0===this.fadeDuration?1:(h-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(h){return Math.max(0,(this.transform.zoom-h)/1.5)}hasTransitions(h){return this.stale||h-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(h,_){const T=this.zoomAtLastRecencyCheck===_?1-this.zoomAdjustment(_):1;return this.zoomAtLastRecencyCheck=_,this.commitTime+this.fadeDuration*T>h}setStale(){this.stale=!0}}function ko(w,h,_,T,k){w.emplaceBack(h?1:0,_?1:0,T||0,k||0),w.emplaceBack(h?1:0,_?1:0,T||0,k||0),w.emplaceBack(h?1:0,_?1:0,T||0,k||0),w.emplaceBack(h?1:0,_?1:0,T||0,k||0)}const Nu=Math.pow(2,25),zu=Math.pow(2,24),fr=Math.pow(2,17),Xh=Math.pow(2,16),Bu=Math.pow(2,9),Ca=Math.pow(2,8),jo=Math.pow(2,1);function Ec(w){if(0===w.opacity&&!w.placed)return 0;if(1===w.opacity&&w.placed)return 4294967295;const h=w.placed?1:0,_=Math.floor(127*w.opacity);return _*Nu+h*zu+_*fr+h*Xh+_*Bu+h*Ca+_*jo+h}const ph=0;class Gl{constructor(h){this._sortAcrossTiles="viewport-y"!==h.layout.get("symbol-z-order")&&void 0!==h.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(h,_,T,k,P){const I=this._bucketParts;for(;this._currentTileIndex<h.length;)if(_.getBucketParts(I,k,h[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,P())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,I.sort((M,z)=>M.sortKey-z.sortKey));this._currentPartIndex<I.length;){const M=I[this._currentPartIndex];if(_.placeLayerBucketPart(M,this._seenCrossTileIDs,T,0===M.symbolInstanceStart),this._currentPartIndex++,P())return!0}return!1}}class fh{constructor(h,_,T,k,P,I,M,z){this.placement=new uo(h,P,I,M,z),this._currentPlacementIndex=_.length-1,this._forceFullPlacement=T,this._showCollisionBoxes=k,this._done=!1}isDone(){return this._done}continuePlacement(h,_,T){const k=y.exported.now(),P=()=>{const I=y.exported.now()-k;return!this._forceFullPlacement&&I>2};for(;this._currentPlacementIndex>=0;){const I=_[h[this._currentPlacementIndex]],M=this.placement.collisionIndex.transform.zoom;if("symbol"===I.type&&(!I.minzoom||I.minzoom<=M)&&(!I.maxzoom||I.maxzoom>M)){if(this._inProgressLayer||(this._inProgressLayer=new Gl(I)),this._inProgressLayer.continuePlacement(T[I.source],this.placement,this._showCollisionBoxes,I,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(h){return this.placement.commit(h),this.placement}}const Gd=512/y.EXTENT/2;class mh{constructor(h,_,T){this.tileID=h,this.indexedSymbolInstances={},this.bucketInstanceId=T;for(let k=0;k<_.length;k++){const P=_.get(k),I=P.key;this.indexedSymbolInstances[I]||(this.indexedSymbolInstances[I]=[]),this.indexedSymbolInstances[I].push({crossTileID:P.crossTileID,coord:this.getScaledCoordinates(P,h)})}}getScaledCoordinates(h,_){const T=Gd/Math.pow(2,_.canonical.z-this.tileID.canonical.z);return{x:Math.floor((_.canonical.x*y.EXTENT+h.tileAnchorX)*T),y:Math.floor((_.canonical.y*y.EXTENT+h.tileAnchorY)*T)}}findMatches(h,_,T){const k=this.tileID.canonical.z<_.canonical.z?1:Math.pow(2,this.tileID.canonical.z-_.canonical.z);for(let P=0;P<h.length;P++){const I=h.get(P);if(I.crossTileID)continue;const M=this.indexedSymbolInstances[I.key];if(!M)continue;const z=this.getScaledCoordinates(I,_);for(const G of M)if(Math.abs(G.coord.x-z.x)<=k&&Math.abs(G.coord.y-z.y)<=k&&!T[G.crossTileID]){T[G.crossTileID]=!0,I.crossTileID=G.crossTileID;break}}}}class kp{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class na{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(h){const _=Math.round((h-this.lng)/360);if(0!==_)for(const T in this.indexes){const k=this.indexes[T],P={};for(const I in k){const M=k[I];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+_),P[M.tileID.key]=M}this.indexes[T]=P}this.lng=h}addBucket(h,_,T){if(this.indexes[h.overscaledZ]&&this.indexes[h.overscaledZ][h.key]){if(this.indexes[h.overscaledZ][h.key].bucketInstanceId===_.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(h.overscaledZ,this.indexes[h.overscaledZ][h.key])}for(let P=0;P<_.symbolInstances.length;P++)_.symbolInstances.get(P).crossTileID=0;this.usedCrossTileIDs[h.overscaledZ]||(this.usedCrossTileIDs[h.overscaledZ]={});const k=this.usedCrossTileIDs[h.overscaledZ];for(const P in this.indexes){const I=this.indexes[P];if(Number(P)>h.overscaledZ)for(const M in I){const z=I[M];z.tileID.isChildOf(h)&&z.findMatches(_.symbolInstances,h,k)}else{const M=I[h.scaledTo(Number(P)).key];M&&M.findMatches(_.symbolInstances,h,k)}}for(let P=0;P<_.symbolInstances.length;P++){const I=_.symbolInstances.get(P);I.crossTileID||(I.crossTileID=T.generate(),k[I.crossTileID]=!0)}return void 0===this.indexes[h.overscaledZ]&&(this.indexes[h.overscaledZ]={}),this.indexes[h.overscaledZ][h.key]=new mh(h,_.symbolInstances,_.bucketInstanceId),!0}removeBucketCrossTileIDs(h,_){for(const T in _.indexedSymbolInstances)for(const k of _.indexedSymbolInstances[T])delete this.usedCrossTileIDs[h][k.crossTileID]}removeStaleBuckets(h){let _=!1;for(const T in this.indexes){const k=this.indexes[T];for(const P in k)h[k[P].bucketInstanceId]||(this.removeBucketCrossTileIDs(T,k[P]),delete k[P],_=!0)}return _}}class Qa{constructor(){this.layerIndexes={},this.crossTileIDs=new kp,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(h,_,T,k){let P=this.layerIndexes[h.id];void 0===P&&(P=this.layerIndexes[h.id]=new na);let I=!1;const M={};"globe"!==k.name&&P.handleWrapJump(T);for(const z of _){const G=z.getBucket(h);G&&h.id===G.layerIds[0]&&(G.bucketInstanceId||(G.bucketInstanceId=++this.maxBucketInstanceId),P.addBucket(z.tileID,G,this.crossTileIDs)&&(I=!0),M[G.bucketInstanceId]=!0)}return P.removeStaleBuckets(M)&&(I=!0),I}pruneUnusedLayers(h){const _={};h.forEach(T=>{_[T]=!0});for(const T in this.layerIndexes)_[T]||delete this.layerIndexes[T]}}const ed=(w,h)=>y.emitValidationErrors(w,h&&h.filter(_=>"source.canvas"!==_.identifier)),Tc=y.pick(li,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),tr=y.pick(li,["setCenter","setZoom","setBearing","setPitch"]),Sc={version:8,layers:[],sources:{}},$l={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class ia extends y.Evented{constructor(h,_={}){super(),this.map=h,this.dispatcher=new ri(di(),this),this.imageManager=new en,this.imageManager.setEventedParent(this),this.glyphManager=new y.GlyphManager(h._requestManager,_.localFontFamily?y.LocalGlyphMode.all:_.localIdeographFontFamily?y.LocalGlyphMode.ideographs:y.LocalGlyphMode.none,_.localFontFamily||_.localIdeographFontFamily),this.crossTileSymbolIndex=new Qa,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",y.getReferrer());const T=this;this._rtlTextPluginCallback=ia.registerForPluginStateChange(k=>{T.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:k.pluginStatus,pluginURL:k.pluginURL},(P,I)=>{if(y.triggerPluginCompletionEvent(P),I&&I.every(M=>M))for(const M in T._sourceCaches){const z=T._sourceCaches[M],G=z.getSource().type;"vector"!==G&&"geojson"!==G||z.reload()}})}),this.on("data",k=>{if("source"!==k.dataType||"metadata"!==k.sourceDataType)return;const P=this.getSource(k.sourceId);if(P&&P.vectorLayerIds)for(const I in this._layers){const M=this._layers[I];M.source===P.id&&this._validateLayer(M)}})}loadURL(h,_={}){this.fire(new y.Event("dataloading",{dataType:"style"}));const T="boolean"==typeof _.validate?_.validate:!y.isMapboxURL(h);h=this.map._requestManager.normalizeStyleURL(h,_.accessToken);const k=this.map._requestManager.transformRequest(h,y.ResourceType.Style);this._request=y.getJSON(k,(P,I)=>{this._request=null,P?this.fire(new y.ErrorEvent(P)):I&&this._load(I,T)})}loadJSON(h,_={}){this.fire(new y.Event("dataloading",{dataType:"style"})),this._request=y.exported.frame(()=>{this._request=null,this._load(h,!1!==_.validate)})}loadEmpty(){this.fire(new y.Event("dataloading",{dataType:"style"})),this._load(Sc,!1)}_updateLayerCount(h,_){const T=_?1:-1;h.is3D()&&(this._num3DLayers+=T),"circle"===h.type&&(this._numCircleLayers+=T),"symbol"===h.type&&(this._numSymbolLayers+=T)}_load(h,_){if(_&&ed(this,y.validateStyle(h)))return;this._loaded=!0,this.stylesheet=y.clone$1(h),this._updateMapProjection();for(const k in h.sources)this.addSource(k,h.sources[k],{validate:!1});this._changed=!1,h.sprite?this._loadSprite(h.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(h.glyphs);const T=ur(this.stylesheet.layers);this._order=T.map(k=>k.id),this._layers={},this._serializedLayers={};for(const k of T){const P=y.createStyleLayer(k);P.setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=P,this._serializedLayers[P.id]=P.serialize(),this._updateLayerCount(P,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Lt(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new y.Event("data",{dataType:"style"})),this.fire(new y.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(h){h?this.stylesheet.projection=h:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(h){this._spriteRequest=function(_,T,k){let P,I,M;const z=y.exported.devicePixelRatio>1?"@2x":"";let G=y.getJSON(T.transformRequest(T.normalizeSpriteURL(_,z,".json"),y.ResourceType.SpriteJSON),(ue,fe)=>{G=null,M||(M=ue,P=fe,te())}),$=y.getImage(T.transformRequest(T.normalizeSpriteURL(_,z,".png"),y.ResourceType.SpriteImage),(ue,fe)=>{$=null,M||(M=ue,I=fe,te())});function te(){if(M)k(M);else if(P&&I){const ue=y.exported.getImageData(I),fe={};for(const _e in P){const{width:ye,height:Te,x:de,y:Oe,sdf:Re,pixelRatio:Fe,stretchX:Ye,stretchY:We,content:Xe}=P[_e],ut=new y.RGBAImage({width:ye,height:Te});y.RGBAImage.copy(ue,ut,{x:de,y:Oe},{x:0,y:0},{width:ye,height:Te}),fe[_e]={data:ut,pixelRatio:Fe,sdf:Re,stretchX:Ye,stretchY:We,content:Xe}}k(null,fe)}}return{cancel(){G&&(G.cancel(),G=null),$&&($.cancel(),$=null)}}}(h,this.map._requestManager,(_,T)=>{if(this._spriteRequest=null,_)this.fire(new y.ErrorEvent(_));else if(T)for(const k in T)this.imageManager.addImage(k,T[k]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new y.Event("data",{dataType:"style"}))})}_validateLayer(h){const _=this.getSource(h.source);if(!_)return;const T=h.sourceLayer;T&&("geojson"===_.type||_.vectorLayerIds&&-1===_.vectorLayerIds.indexOf(T))&&this.fire(new y.ErrorEvent(new Error(`Source layer "${T}" does not exist on source "${_.id}" as specified by style layer "${h.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const h in this._sourceCaches)if(!this._sourceCaches[h].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(h){const _=[];for(const T of h){const k=this._layers[T];"custom"!==k.type&&_.push(k.serialize())}return _}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const h in this._sourceCaches)if(this._sourceCaches[h].hasTransition())return!0;for(const h in this._layers)if(this._layers[h].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(h){return!!this.terrain&&("function"==typeof h.isLayerDraped?h.isLayerDraped():$l[h.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(h){if(!this._loaded)return;const _=this._changed;if(this._changed){const k=Object.keys(this._updatedLayers),P=Object.keys(this._removedLayers);(k.length||P.length)&&this._updateWorkerLayers(k,P);for(const I in this._updatedSources){const M=this._updatedSources[I];"reload"===M?this._reloadSource(I):"clear"===M&&this._clearSource(I)}this._updateTilesForChangedImages();for(const I in this._updatedPaintProps)this._layers[I].updateTransitions(h);this.light.updateTransitions(h),this.fog&&this.fog.updateTransitions(h),this._resetUpdates()}const T={};for(const k in this._sourceCaches){const P=this._sourceCaches[k];T[k]=P.used,P.used=!1}for(const k of this._order){const P=this._layers[k];if(P.recalculate(h,this._availableImages),!P.isHidden(h.zoom)){const M=this._getLayerSourceCache(P);M&&(M.used=!0)}const I=this.map.painter;if(I){const M=P.getProgramIds();if(!M)continue;const z=P.getProgramConfiguration(h.zoom);for(const G of M)I.useProgram(G,z)}}for(const k in T){const P=this._sourceCaches[k];T[k]!==P.used&&P.getSource().fire(new y.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:P.getSource().id}))}this.light.recalculate(h),this.terrain&&this.terrain.recalculate(h),this.fog&&this.fog.recalculate(h),this.z=h.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),_&&this.fire(new y.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const h=Object.keys(this._changedImages);if(h.length){for(const _ in this._sourceCaches)this._sourceCaches[_].reloadTilesForDependencies(["icons","patterns"],h);this._changedImages={}}}_updateWorkerLayers(h,_){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(h),removedIds:_})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(h){if(this._checkLoaded(),ed(this,y.validateStyle(h)))return!1;(h=y.clone$1(h)).layers=ur(h.layers);const _=function(k,P){if(!k)return[{command:li.setStyle,args:[P]}];let I=[];try{if(!ze(k.version,P.version))return[{command:li.setStyle,args:[P]}];ze(k.center,P.center)||I.push({command:li.setCenter,args:[P.center]}),ze(k.zoom,P.zoom)||I.push({command:li.setZoom,args:[P.zoom]}),ze(k.bearing,P.bearing)||I.push({command:li.setBearing,args:[P.bearing]}),ze(k.pitch,P.pitch)||I.push({command:li.setPitch,args:[P.pitch]}),ze(k.sprite,P.sprite)||I.push({command:li.setSprite,args:[P.sprite]}),ze(k.glyphs,P.glyphs)||I.push({command:li.setGlyphs,args:[P.glyphs]}),ze(k.transition,P.transition)||I.push({command:li.setTransition,args:[P.transition]}),ze(k.light,P.light)||I.push({command:li.setLight,args:[P.light]}),ze(k.fog,P.fog)||I.push({command:li.setFog,args:[P.fog]}),ze(k.projection,P.projection)||I.push({command:li.setProjection,args:[P.projection]});const M={},z=[];!function(te,ue,fe,_e){let ye;for(ye in ue=ue||{},te=te||{})te.hasOwnProperty(ye)&&(ue.hasOwnProperty(ye)||ci(ye,fe,_e));for(ye in ue){if(!ue.hasOwnProperty(ye))continue;const Te=ue[ye];te.hasOwnProperty(ye)?ze(te[ye],Te)||("geojson"===te[ye].type&&"geojson"===Te.type&&mo(te,ue,ye)?fe.push({command:li.setGeoJSONSourceData,args:[ye,Te.data]}):Mr(ye,ue,fe,_e)):vr(ye,ue,fe)}}(k.sources,P.sources,z,M);const G=[];k.layers&&k.layers.forEach(te=>{te.source&&M[te.source]?I.push({command:li.removeLayer,args:[te.id]}):G.push(te)});let $=k.terrain;$&&M[$.source]&&(I.push({command:li.setTerrain,args:[void 0]}),$=void 0),I=I.concat(z),ze($,P.terrain)||I.push({command:li.setTerrain,args:[P.terrain]}),function(te,ue,fe){ue=ue||[];const _e=(te=te||[]).map(Ko),ye=ue.map(Ko),Te=te.reduce(Sr,{}),de=ue.reduce(Sr,{}),Oe=_e.slice(),Re=Object.create(null);let Fe,Ye,We,Xe,ut,Et,At;for(Fe=0,Ye=0;Fe<_e.length;Fe++)We=_e[Fe],de.hasOwnProperty(We)?Ye++:(fe.push({command:li.removeLayer,args:[We]}),Oe.splice(Oe.indexOf(We,Ye),1));for(Fe=0,Ye=0;Fe<ye.length;Fe++)We=ye[ye.length-1-Fe],Oe[Oe.length-1-Fe]!==We&&(Te.hasOwnProperty(We)?(fe.push({command:li.removeLayer,args:[We]}),Oe.splice(Oe.lastIndexOf(We,Oe.length-Ye),1)):Ye++,Et=Oe[Oe.length-Fe],fe.push({command:li.addLayer,args:[de[We],Et]}),Oe.splice(Oe.length-Fe,0,We),Re[We]=!0);for(Fe=0;Fe<ye.length;Fe++)if(We=ye[Fe],Xe=Te[We],ut=de[We],!Re[We]&&!ze(Xe,ut))if(ze(Xe.source,ut.source)&&ze(Xe["source-layer"],ut["source-layer"])&&ze(Xe.type,ut.type)){for(At in Rt(Xe.layout,ut.layout,fe,We,null,li.setLayoutProperty),Rt(Xe.paint,ut.paint,fe,We,null,li.setPaintProperty),ze(Xe.filter,ut.filter)||fe.push({command:li.setFilter,args:[We,ut.filter]}),ze(Xe.minzoom,ut.minzoom)&&ze(Xe.maxzoom,ut.maxzoom)||fe.push({command:li.setLayerZoomRange,args:[We,ut.minzoom,ut.maxzoom]}),Xe)Xe.hasOwnProperty(At)&&"layout"!==At&&"paint"!==At&&"filter"!==At&&"metadata"!==At&&"minzoom"!==At&&"maxzoom"!==At&&(0===At.indexOf("paint.")?Rt(Xe[At],ut[At],fe,We,At.slice(6),li.setPaintProperty):ze(Xe[At],ut[At])||fe.push({command:li.setLayerProperty,args:[We,At,ut[At]]}));for(At in ut)ut.hasOwnProperty(At)&&!Xe.hasOwnProperty(At)&&"layout"!==At&&"paint"!==At&&"filter"!==At&&"metadata"!==At&&"minzoom"!==At&&"maxzoom"!==At&&(0===At.indexOf("paint.")?Rt(Xe[At],ut[At],fe,We,At.slice(6),li.setPaintProperty):ze(Xe[At],ut[At])||fe.push({command:li.setLayerProperty,args:[We,At,ut[At]]}))}else fe.push({command:li.removeLayer,args:[We]}),Et=Oe[Oe.lastIndexOf(We)+1],fe.push({command:li.addLayer,args:[ut,Et]})}(G,P.layers,I)}catch(M){console.warn("Unable to compute style diff:",M),I=[{command:li.setStyle,args:[P]}]}return I}(this.serialize(),h).filter(k=>!(k.command in tr));if(0===_.length)return!1;const T=_.filter(k=>!(k.command in Tc));if(T.length>0)throw new Error(`Unimplemented: ${T.map(k=>k.command).join(", ")}.`);return _.forEach(k=>{"setTransition"!==k.command&&"setProjection"!==k.command&&this[k.command].apply(this,k.args)}),this.stylesheet=h,this._updateMapProjection(),!0}addImage(h,_){return this.getImage(h)?this.fire(new y.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(h,_),this._afterImageUpdated(h),this)}updateImage(h,_){this.imageManager.updateImage(h,_)}getImage(h){return this.imageManager.getImage(h)}removeImage(h){return this.getImage(h)?(this.imageManager.removeImage(h),this._afterImageUpdated(h),this):this.fire(new y.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(h){this._availableImages=this.imageManager.listImages(),this._changedImages[h]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new y.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(h,_,T={}){if(this._checkLoaded(),void 0!==this.getSource(h))throw new Error("There is already a source with this ID");if(!_.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(_).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(_.type)>=0&&this._validate(y.validateSource,`sources.${h}`,_,null,T))return;this.map&&this.map._collectResourceTiming&&(_.collectResourceTiming=!0);const k=ot(h,_,this.dispatcher,this);k.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(h),source:k.serialize(),sourceId:h}));const P=I=>{const M=(I?"symbol:":"other:")+h,z=this._sourceCaches[M]=new y.SourceCache(M,k,I);(I?this._symbolSourceCaches:this._otherSourceCaches)[h]=z,z.style=this,z.onAdd(this.map)};P(!1),"vector"!==_.type&&"geojson"!==_.type||P(!0),k.onAdd&&k.onAdd(this.map),this._changed=!0}removeSource(h){this._checkLoaded();const _=this.getSource(h);if(!_)throw new Error("There is no source with this ID");for(const k in this._layers)if(this._layers[k].source===h)return this.fire(new y.ErrorEvent(new Error(`Source "${h}" cannot be removed while layer "${k}" is using it.`)));if(this.terrain&&this.terrain.get().source===h)return this.fire(new y.ErrorEvent(new Error(`Source "${h}" cannot be removed while terrain is using it.`)));const T=this._getSourceCaches(h);for(const k of T)delete this._sourceCaches[k.id],delete this._updatedSources[k.id],k.fire(new y.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:k.getSource().id})),k.setEventedParent(null),k.clearTiles();return delete this._otherSourceCaches[h],delete this._symbolSourceCaches[h],_.setEventedParent(null),_.onRemove&&_.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(h,_){this._checkLoaded(),this.getSource(h).setData(_),this._changed=!0}getSource(h){const _=this._getSourceCache(h);return _&&_.getSource()}_getSources(){const h=[];for(const _ in this._otherSourceCaches){const T=this._getSourceCache(_);T&&h.push(T.getSource())}return h}addLayer(h,_,T={}){this._checkLoaded();const k=h.id;if(this.getLayer(k))return void this.fire(new y.ErrorEvent(new Error(`Layer with id "${k}" already exists on this map`)));let P;if("custom"===h.type){if(ed(this,y.validateCustomStyleLayer(h)))return;P=y.createStyleLayer(h)}else{if("object"==typeof h.source&&(this.addSource(k,h.source),h=y.clone$1(h),h=y.extend(h,{source:k})),this._validate(y.validateLayer,`layers.${k}`,h,{arrayIndex:-1},T))return;P=y.createStyleLayer(h),this._validateLayer(P),P.setEventedParent(this,{layer:{id:k}}),this._serializedLayers[P.id]=P.serialize(),this._updateLayerCount(P,!0)}const I=_?this._order.indexOf(_):this._order.length;if(_&&-1===I)return void this.fire(new y.ErrorEvent(new Error(`Layer with id "${_}" does not exist on this map.`)));this._order.splice(I,0,k),this._layerOrderChanged=!0,this._layers[k]=P;const M=this._getLayerSourceCache(P);if(this._removedLayers[k]&&P.source&&M&&"custom"!==P.type){const z=this._removedLayers[k];delete this._removedLayers[k],z.type!==P.type?this._updatedSources[P.source]="clear":(this._updatedSources[P.source]="reload",M.pause())}this._updateLayer(P),P.onAdd&&P.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(h,_){if(this._checkLoaded(),this._changed=!0,!this._layers[h])return void this.fire(new y.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be moved.`)));if(h===_)return;const T=this._order.indexOf(h);this._order.splice(T,1);const k=_?this._order.indexOf(_):this._order.length;_&&-1===k?this.fire(new y.ErrorEvent(new Error(`Layer with id "${_}" does not exist on this map.`))):(this._order.splice(k,0,h),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(h){this._checkLoaded();const _=this._layers[h];if(!_)return void this.fire(new y.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be removed.`)));_.setEventedParent(null),this._updateLayerCount(_,!1);const T=this._order.indexOf(h);this._order.splice(T,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[h]=_,delete this._layers[h],delete this._serializedLayers[h],delete this._updatedLayers[h],delete this._updatedPaintProps[h],_.onRemove&&_.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(h){return this._layers[h]}hasLayer(h){return h in this._layers}hasLayerType(h){for(const _ in this._layers)if(this._layers[_].type===h)return!0;return!1}setLayerZoomRange(h,_,T){this._checkLoaded();const k=this.getLayer(h);k?k.minzoom===_&&k.maxzoom===T||(null!=_&&(k.minzoom=_),null!=T&&(k.maxzoom=T),this._updateLayer(k)):this.fire(new y.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(h,_,T={}){this._checkLoaded();const k=this.getLayer(h);if(k){if(!ze(k.filter,_))return null==_?(k.filter=void 0,void this._updateLayer(k)):void(this._validate(y.validateFilter,`layers.${k.id}.filter`,_,{layerType:k.type},T)||(k.filter=y.clone$1(_),this._updateLayer(k)))}else this.fire(new y.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be filtered.`)))}getFilter(h){const _=this.getLayer(h);return _&&y.clone$1(_.filter)}setLayoutProperty(h,_,T,k={}){this._checkLoaded();const P=this.getLayer(h);P?ze(P.getLayoutProperty(_),T)||(P.setLayoutProperty(_,T,k),this._updateLayer(P)):this.fire(new y.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(h,_){const T=this.getLayer(h);if(T)return T.getLayoutProperty(_);this.fire(new y.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style.`)))}setPaintProperty(h,_,T,k={}){this._checkLoaded();const P=this.getLayer(h);P?ze(P.getPaintProperty(_),T)||(P.setPaintProperty(_,T,k)&&this._updateLayer(P),this._changed=!0,this._updatedPaintProps[h]=!0):this.fire(new y.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(h,_){const T=this.getLayer(h);return T&&T.getPaintProperty(_)}setFeatureState(h,_){this._checkLoaded();const T=h.source,k=h.sourceLayer,P=this.getSource(T);if(!P)return void this.fire(new y.ErrorEvent(new Error(`The source '${T}' does not exist in the map's style.`)));const I=P.type;if("geojson"===I&&k)return void this.fire(new y.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===I&&!k)return void this.fire(new y.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===h.id&&this.fire(new y.ErrorEvent(new Error("The feature id parameter must be provided.")));const M=this._getSourceCaches(T);for(const z of M)z.setFeatureState(k,h.id,_)}removeFeatureState(h,_){this._checkLoaded();const T=h.source,k=this.getSource(T);if(!k)return void this.fire(new y.ErrorEvent(new Error(`The source '${T}' does not exist in the map's style.`)));const P=k.type,I="vector"===P?h.sourceLayer:void 0;if("vector"===P&&!I)return void this.fire(new y.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(_&&"string"!=typeof h.id&&"number"!=typeof h.id)return void this.fire(new y.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const M=this._getSourceCaches(T);for(const z of M)z.removeFeatureState(I,h.id,_)}getFeatureState(h){this._checkLoaded();const _=h.source,T=h.sourceLayer,k=this.getSource(_);if(k){if("vector"!==k.type||T)return void 0===h.id&&this.fire(new y.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(_)[0].getFeatureState(T,h.id);this.fire(new y.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new y.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)))}getTransition(){return y.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const h={};for(const _ in this._sourceCaches){const T=this._sourceCaches[_].getSource();h[T.id]||(h[T.id]=T.serialize())}return y.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:h,layers:this._serializeLayers(this._order)},_=>void 0!==_)}_updateLayer(h){this._updatedLayers[h.id]=!0;const _=this._getLayerSourceCache(h);h.source&&!this._updatedSources[h.source]&&_&&"raster"!==_.getSource().type&&(this._updatedSources[h.source]="reload",_.pause()),this._changed=!0,h.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(h){const _=I=>"fill-extrusion"===this._layers[I].type,T={},k=[];for(let I=this._order.length-1;I>=0;I--){const M=this._order[I];if(_(M)){T[M]=I;for(const z of h){const G=z[M];if(G)for(const $ of G)k.push($)}}}k.sort((I,M)=>M.intersectionZ-I.intersectionZ);const P=[];for(let I=this._order.length-1;I>=0;I--){const M=this._order[I];if(_(M))for(let z=k.length-1;z>=0;z--){const G=k[z].feature;if(T[G.layer.id]<I)break;P.push(G),k.pop()}else for(const z of h){const G=z[M];if(G)for(const $ of G)P.push($.feature)}}return P}queryRenderedFeatures(h,_,T){_&&_.filter&&this._validate(y.validateFilter,"queryRenderedFeatures.filter",_.filter,null,_);const k={};if(_&&_.layers){if(!Array.isArray(_.layers))return this.fire(new y.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const z of _.layers){const G=this._layers[z];if(!G)return this.fire(new y.ErrorEvent(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];k[G.source]=!0}}const P=[];_.availableImages=this._availableImages;const I=_&&_.layers?_.layers.some(z=>{const G=this.getLayer(z);return G&&G.is3D()}):this.has3DLayers(),M=Bo.createFromScreenPoints(h,T);for(const z in this._sourceCaches){const G=this._sourceCaches[z].getSource().id;_.layers&&!k[G]||P.push(rt(this._sourceCaches[z],this._layers,this._serializedLayers,M,_,T,I,!!this.map._showQueryGeometry))}return this.placement&&P.push(function(z,G,$,te,ue,fe,_e){const ye={},Te=fe.queryRenderedSymbols(te),de=[];for(const Oe of Object.keys(Te).map(Number))de.push(_e[Oe]);de.sort(Dn);for(const Oe of de){const Re=Oe.featureIndex.lookupSymbolFeatures(Te[Oe.bucketInstanceId],G,Oe.bucketIndex,Oe.sourceLayerIndex,ue.filter,ue.layers,ue.availableImages,z);for(const Fe in Re){const Ye=ye[Fe]=ye[Fe]||[],We=Re[Fe];We.sort((Xe,ut)=>{const Et=Oe.featureSortOrder;if(Et){const At=Et.indexOf(Xe.featureIndex);return Et.indexOf(ut.featureIndex)-At}return ut.featureIndex-Xe.featureIndex});for(const Xe of We)Ye.push(Xe)}}for(const Oe in ye)ye[Oe].forEach(Re=>{const Fe=Re.feature,Ye=$(z[Oe]);if(!Ye)return;const We=Ye.getFeatureState(Fe.layer["source-layer"],Fe.id);Fe.source=Fe.layer.source,Fe.layer["source-layer"]&&(Fe.sourceLayer=Fe.layer["source-layer"]),Fe.state=We});return ye}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),M.screenGeometry,_,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(P)}querySourceFeatures(h,_){_&&_.filter&&this._validate(y.validateFilter,"querySourceFeatures.filter",_.filter,null,_);const T=this._getSourceCaches(h);let k=[];for(const P of T)k=k.concat($t(P,_));return k}addSourceType(h,_,T){return ia.getSourceType(h)?T(new Error(`A source type called "${h}" already exists.`)):(ia.setSourceType(h,_),_.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:h,url:_.workerSourceURL},T):T(null,null))}getLight(){return this.light.getLight()}setLight(h,_={}){this._checkLoaded();const T=this.light.getLight();let k=!1;for(const I in h)if(!ze(h[I],T[I])){k=!0;break}if(!k)return;const P=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(h,_),this.light.updateTransitions(P)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(h,_=1){if(this._checkLoaded(),!h)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let T=h;if(1===_){if("object"==typeof T.source){const k="terrain-dem-src";this.addSource(k,T.source),T=y.clone$1(T),T=y.extend(T,{source:k})}if(this._validate(y.validateTerrain,"terrain",T))return}if(!this.terrain||this.terrain&&_!==this.terrain.drapeRenderMode){if(!T)return;this._createTerrain(T,_)}else{const k=this.terrain,P=k.get();for(const I of Object.keys(y.spec.terrain))!T.hasOwnProperty(I)&&y.spec.terrain[I].default&&(T[I]=y.spec.terrain[I].default);for(const I in T)if(!ze(T[I],P[I])){k.set(T),this.stylesheet.terrain=T;const M=this._setTransitionParameters({duration:0});k.updateTransitions(M);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(h){const _=this.fog=new zi(h,this.map.transform);this.stylesheet.fog=h;const T=this._setTransitionParameters({duration:0});_.updateTransitions(T)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const h of this.map._markers)h._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(h){if(this._checkLoaded(),!h)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const _=this.fog,T=_.get();0===Object.keys(h).length&&_.set(h);for(const k in h)if(!ze(h[k],T[k])){_.set(h),this.stylesheet.fog=h;const P=this._setTransitionParameters({duration:0});_.updateTransitions(P);break}}else this._createFog(h);this._markersNeedUpdate=!0}_setTransitionParameters(h){return{now:y.exported.now(),transition:y.extend(h,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const h=this._order.filter(T=>this.isLayerDraped(this._layers[T])),_=this._order.filter(T=>!this.isLayerDraped(this._layers[T]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...h),this._drapedFirstOrder.push(..._)}_createTerrain(h,_){const T=this.terrain=new wn(h,_);this.stylesheet.terrain=h,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const k=this._setTransitionParameters({duration:0});T.updateTransitions(k)}_force3DLayerUpdate(){for(const h in this._layers){const _=this._layers[h];"fill-extrusion"===_.type&&this._updateLayer(_)}}_forceSymbolLayerUpdate(){for(const h in this._layers){const _=this._layers[h];"symbol"===_.type&&this._updateLayer(_)}}_validate(h,_,T,k,P={}){return(!P||!1!==P.validate)&&ed(this,h.call(y.validateStyle,y.extend({key:_,style:this.serialize(),value:T,styleSpec:y.spec},k)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),y.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const h in this._layers)this._layers[h].setEventedParent(null);for(const h in this._sourceCaches)this._sourceCaches[h].clearTiles(),this._sourceCaches[h].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(h){const _=this._getSourceCaches(h);for(const T of _)T.clearTiles()}_reloadSource(h){const _=this._getSourceCaches(h);for(const T of _)T.resume(),T.reload()}_reloadSources(){for(const h of this._getSources())h.reload&&h.reload()}_updateSources(h){for(const _ in this._sourceCaches)this._sourceCaches[_].update(h)}_generateCollisionBoxes(){for(const h in this._sourceCaches){const _=this._sourceCaches[h];_.resume(),_.reload()}}_updatePlacement(h,_,T,k,P=!1){let I=!1,M=!1;const z={};for(const G of this._order){const $=this._layers[G];if("symbol"!==$.type)continue;if(!z[$.source]){const ue=this._getLayerSourceCache($);if(!ue)continue;z[$.source]=ue.getRenderableIds(!0).map(fe=>ue.getTileByID(fe)).sort((fe,_e)=>_e.tileID.overscaledZ-fe.tileID.overscaledZ||(fe.tileID.isLessThan(_e.tileID)?-1:1))}const te=this.crossTileSymbolIndex.addLayer($,z[$.source],h.center.lng,h.projection);I=I||te}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),P=P||this._layerOrderChanged||0===T,this._layerOrderChanged&&this.fire(new y.Event("neworder")),(P||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(y.exported.now(),h.zoom))&&(this.pauseablePlacement=new fh(h,this._order,P,_,T,k,this.placement,this.fog&&h.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,z),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(y.exported.now()),M=!0),I&&this.pauseablePlacement.placement.setStale()),M||I)for(const G of this._order){const $=this._layers[G];"symbol"===$.type&&this.placement.updateLayerOpacities($,z[$.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(y.exported.now())}_releaseSymbolFadeTiles(){for(const h in this._sourceCaches)this._sourceCaches[h].releaseSymbolFadeTiles()}getImages(h,_,T){this.imageManager.getImages(_.icons,T),this._updateTilesForChangedImages();const k=P=>{P&&P.setDependencies(_.tileID.key,_.type,_.icons)};k(this._otherSourceCaches[_.source]),k(this._symbolSourceCaches[_.source])}getGlyphs(h,_,T){this.glyphManager.getGlyphs(_.stacks,T)}getResource(h,_,T){return y.makeRequest(_,T)}_getSourceCache(h){return this._otherSourceCaches[h]}_getLayerSourceCache(h){return"symbol"===h.type?this._symbolSourceCaches[h.source]:this._otherSourceCaches[h.source]}_getSourceCaches(h){const _=[];return this._otherSourceCaches[h]&&_.push(this._otherSourceCaches[h]),this._symbolSourceCaches[h]&&_.push(this._symbolSourceCaches[h]),_}_isSourceCacheLoaded(h){const _=this._getSourceCaches(h);return 0===_.length?(this.fire(new y.ErrorEvent(new Error(`There is no source with ID '${h}'`))),!1):_.every(T=>T.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ia.getSourceType=function(w){return Ke[w]},ia.setSourceType=function(w,h){Ke[w]=h},ia.registerForPluginStateChange=y.registerForPluginStateChange;var tu="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",wf="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",ml="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",Wl="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",nu="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let iu={},Vu={};const Xa=[];gl(tu,Xa),gl(ml,Xa),gl(Wl,Xa),gl(nu,Xa),iu=Mi("",ml),Vu=Mi(nu,Wl);const Ic=Mi("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),Dc=tu,gh="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var Zl={background:Mi("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Mi("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Mi("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Mi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Mi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Mi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Mi("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Mi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Mi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:Mi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Mi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Mi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Mi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Mi("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Mi("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Mi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Mi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Mi("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Mi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Mi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Mi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:Mi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:Mi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:Mi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:Mi("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Mi("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",wf),skyboxGradient:Mi("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",wf),skyboxCapture:Mi("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Mi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:Mi("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function gl(w,h){const _=w.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let T of _)if(T=T.trim(),"#"===T[0]&&T.includes("if")&&!T.includes("endif")){T=T.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const k=T.split(" ");for(const P of k)h.includes(P)||h.push(P)}}function Mi(w,h){const _=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,T=h.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),k={},P=[...Xa];return gl(w,P),gl(h,P),{fragmentSource:w=w.replace(_,(I,M,z,G,$)=>(k[$]=!0,"define"===M?`\n#ifndef HAS_UNIFORM_u_${$}\nvarying ${z} ${G} ${$};\n#else\nuniform ${z} ${G} u_${$};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${$}\n    ${z} ${G} ${$} = u_${$};\n#endif\n`)),vertexSource:h=h.replace(_,(I,M,z,G,$)=>{const te="float"===G?"vec2":"vec4",ue=$.match(/color/)?"color":te;return k[$]?"define"===M?`\n#ifndef HAS_UNIFORM_u_${$}\nuniform lowp float u_${$}_t;\nattribute ${z} ${te} a_${$};\nvarying ${z} ${G} ${$};\n#else\nuniform ${z} ${G} u_${$};\n#endif\n`:"vec4"===ue?`\n#ifndef HAS_UNIFORM_u_${$}\n    ${$} = a_${$};\n#else\n    ${z} ${G} ${$} = u_${$};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${$}\n    ${$} = unpack_mix_${ue}(a_${$}, u_${$}_t);\n#else\n    ${z} ${G} ${$} = u_${$};\n#endif\n`:"define"===M?`\n#ifndef HAS_UNIFORM_u_${$}\nuniform lowp float u_${$}_t;\nattribute ${z} ${te} a_${$};\n#else\nuniform ${z} ${G} u_${$};\n#endif\n`:"vec4"===ue?`\n#ifndef HAS_UNIFORM_u_${$}\n    ${z} ${G} ${$} = a_${$};\n#else\n    ${z} ${G} ${$} = u_${$};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${$}\n    ${z} ${G} ${$} = unpack_mix_${ue}(a_${$}, u_${$}_t);\n#else\n    ${z} ${G} ${$} = u_${$};\n#endif\n`}),staticAttributes:T,usedDefines:P}}class Ro{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(h,_,T,k,P,I,M){this.context=h;let z=this.boundPaintVertexBuffers.length!==k.length;for(let $=0;!z&&$<k.length;$++)this.boundPaintVertexBuffers[$]!==k[$]&&(z=!0);let G=this.boundDynamicVertexBuffers.length!==M.length;for(let $=0;!G&&$<M.length;$++)this.boundDynamicVertexBuffers[$]!==M[$]&&(G=!0);if(!h.extVertexArrayObject||!this.vao||this.boundProgram!==_||this.boundLayoutVertexBuffer!==T||z||G||this.boundIndexBuffer!==P||this.boundVertexOffset!==I)this.freshBind(_,T,k,P,I,M);else{h.bindVertexArrayOES.set(this.vao);for(const $ of M)$&&$.bind();P&&P.dynamicDraw&&P.bind()}}freshBind(h,_,T,k,P,I){let M;const z=h.numAttributes,G=this.context,$=G.gl;if(G.extVertexArrayObject)this.vao&&this.destroy(),this.vao=G.extVertexArrayObject.createVertexArrayOES(),G.bindVertexArrayOES.set(this.vao),M=0,this.boundProgram=h,this.boundLayoutVertexBuffer=_,this.boundPaintVertexBuffers=T,this.boundIndexBuffer=k,this.boundVertexOffset=P,this.boundDynamicVertexBuffers=I;else{M=G.currentNumAttributes||0;for(let te=z;te<M;te++)$.disableVertexAttribArray(te)}_.enableAttributes($,h),_.bind(),_.setVertexAttribPointers($,h,P);for(const te of T)te.enableAttributes($,h),te.bind(),te.setVertexAttribPointers($,h,P);for(const te of I)te&&(te.enableAttributes($,h),te.bind(),te.setVertexAttribPointers($,h,P));k&&k.bind(),G.currentNumAttributes=z}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function _h(w,h){const _=Math.pow(2,h.canonical.z),T=h.canonical.y;return[new y.MercatorCoordinate(0,T/_).toLngLat().lat,new y.MercatorCoordinate(0,(T+1)/_).toLngLat().lat]}function _o(w,h,_,T,k,P,I){const M=w.context,z=M.gl,G=_.fbo;if(!G)return;w.prepareDrawTile();const $=w.useProgram("hillshade");M.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,G.colorAttachment.get());const te=((ye,Te,de,Oe)=>{const Re=de.paint.get("hillshade-shadow-color"),Fe=de.paint.get("hillshade-highlight-color"),Ye=de.paint.get("hillshade-accent-color");let We=de.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===de.paint.get("hillshade-illumination-anchor")&&(We-=ye.transform.angle);const Xe=!ye.options.moving;return{u_matrix:Oe||ye.transform.calculateProjMatrix(Te.tileID.toUnwrapped(),Xe),u_image:0,u_latrange:_h(0,Te.tileID),u_light:[de.paint.get("hillshade-exaggeration"),We],u_shadow:Re,u_highlight:Fe,u_accent:Ye}})(w,_,T,w.terrain?h.projMatrix:null);w.prepareDrawProgram(M,$,h.toUnwrapped());const{tileBoundsBuffer:ue,tileBoundsIndexBuffer:fe,tileBoundsSegments:_e}=w.getTileBoundsBuffers(_);$.draw(M,z.TRIANGLES,k,P,I,y.CullFaceMode.disabled,te,T.id,ue,fe,_e)}function Uu(w,h,_){if(!h.needsDEMTextureUpload)return;const T=w.context,k=T.gl;T.pixelStoreUnpackPremultiplyAlpha.set(!1),h.demTexture=h.demTexture||w.getTileTexture(_.stride);const P=_.getPixels();h.demTexture?h.demTexture.update(P,{premultiply:!1}):h.demTexture=new y.Texture(T,P,k.RGBA,{premultiply:!1}),h.needsDEMTextureUpload=!1}function Pa(w,h,_,T,k,P){const I=w.context,M=I.gl;if(!h.dem)return;const z=h.dem;if(I.activeTexture.set(M.TEXTURE1),Uu(w,h,z),!h.demTexture)return;h.demTexture.bind(M.NEAREST,M.CLAMP_TO_EDGE);const G=z.dim;I.activeTexture.set(M.TEXTURE0);let $=h.fbo;if(!$){const _e=new y.Texture(I,{width:G,height:G,data:null},M.RGBA);_e.bind(M.LINEAR,M.CLAMP_TO_EDGE),$=h.fbo=I.createFramebuffer(G,G,!0),$.colorAttachment.set(_e.texture)}I.bindFramebuffer.set($.framebuffer),I.viewport.set([0,0,G,G]);const{tileBoundsBuffer:te,tileBoundsIndexBuffer:ue,tileBoundsSegments:fe}=w.getMercatorTileBoundsBuffers();w.useProgram("hillshadePrepare").draw(I,M.TRIANGLES,T,k,P,y.CullFaceMode.disabled,((_e,ye)=>{const Te=ye.stride,de=y.create();return y.ortho(de,0,y.EXTENT,-y.EXTENT,0,0,1),y.translate(de,de,[0,-y.EXTENT,0]),{u_matrix:de,u_image:1,u_dimension:[Te,Te],u_zoom:_e.overscaledZ,u_unpack:ye.unpackVector}})(h.tileID,z),_.id,te,ue,fe),h.needsHillshadePrepare=!1}const Ps=w=>({u_matrix:new y.UniformMatrix4f(w),u_image0:new y.Uniform1i(w),u_skirt_height:new y.Uniform1f(w)}),_l=(w,h)=>({u_matrix:w,u_image0:0,u_skirt_height:h}),ru=(w,h,_,T,k,P,I,M,z,G,$,te,ue,fe,_e)=>({u_proj_matrix:Float32Array.from(w),u_globe_matrix:h,u_normalize_matrix:Float32Array.from(T),u_merc_matrix:_,u_zoom_transition:k,u_merc_center:P,u_image0:0,u_frustum_tl:I,u_frustum_tr:M,u_frustum_br:z,u_frustum_bl:G,u_globe_pos:$,u_globe_radius:te,u_viewport:ue,u_grid_matrix:_e?Float32Array.from(_e):new Float32Array(9),u_skirt_height:fe});function Oa(w,h){return null!=w&&null!=h&&!(!w.hasData()||!h.hasData())&&null!=w.demTexture&&null!=h.demTexture&&w.tileID.key!==h.tileID.key}const Co=new class{constructor(){this.operations={}}newMorphing(w,h,_,T,k){if(w in this.operations){const P=this.operations[w];P.to.tileID.key!==_.tileID.key&&(P.queued=_)}else this.operations[w]={startTime:T,phase:0,duration:k,from:h,to:_,queued:null}}getMorphValuesForProxy(w){if(!(w in this.operations))return null;const h=this.operations[w];return{from:h.from,to:h.to,phase:h.phase}}update(w){for(const h in this.operations){const _=this.operations[h];for(_.phase=(w-_.startTime)/_.duration;_.phase>=1||!this._validOp(_);)if(!this._nextOp(_,w)){delete this.operations[h];break}}}_nextOp(w,h){return!!w.queued&&(w.from=w.to,w.to=w.queued,w.queued=null,w.phase=0,w.startTime=h,!0)}_validOp(w){return w.from.hasData()&&w.to.hasData()}},yl={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function vl(w){return 6*Math.pow(1.5,22-w)}function $d(w,h){const _=1<<w.z;return!h&&(0===w.x||w.x===_-1)||0===w.y||w.y===_-1}const Oi=w=>({u_matrix:w});function Hu(w,h,_,T,k){if(k>0){const P=y.exported.now(),I=(P-w.timeAdded)/k,M=h?(P-h.timeAdded)/k:-1,z=_.getSource(),G=T.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),$=!h||Math.abs(h.tileID.overscaledZ-G)>Math.abs(w.tileID.overscaledZ-G),te=$&&w.refreshedUponExpiration?1:y.clamp($?I:1-M,0,1);return w.refreshedUponExpiration&&I>=1&&(w.refreshedUponExpiration=!1),h?{opacity:1,mix:1-te}:{opacity:te,mix:0}}return{opacity:1,mix:0}}class Ac extends y.SourceCache{constructor(h){const _={type:"raster-dem",maxzoom:h.transform.maxZoom},T=new ri(di(),null),k=ot("mock-dem",_,T,h.style);super("mock-dem",k,!1),k.setEventedParent(this),this._sourceLoaded=!0}_loadTile(h,_){h.state="loaded",_(null)}}class Wi extends y.SourceCache{constructor(h){const _=ot("proxy",{type:"geojson",maxzoom:h.transform.maxZoom},new ri(di(),null),h.style);super("proxy",_,!1),_.setEventedParent(this),this.map=this.getSource().map=h,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(h,_,T){if(h.freezeTileCoverage)return;this.transform=h;const k=h.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((P,I)=>{if(P[I.key]="",!this._tiles[I.key]){const M=new y.Tile(I,this._source.tileSize*I.overscaleFactor(),h.tileZoom);M.state="loaded",this._tiles[I.key]=M}return P},{});for(const P in this._tiles)P in k||(this.freeFBO(P),this._tiles[P].unloadVectorData(),delete this._tiles[P])}freeFBO(h){const _=this.proxyCachedFBO[h];if(void 0!==_){const T=Object.values(_);this.renderCachePool.push(...T),delete this.proxyCachedFBO[h]}}deallocRenderCache(){this.renderCache.forEach(h=>h.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Mc extends y.OverscaledTileID{constructor(h,_,T){super(h.overscaledZ,h.wrap,h.canonical.z,h.canonical.x,h.canonical.y),this.proxyTileKey=_,this.projMatrix=T}}class td extends y.Elevation{constructor(h,_){super(),this.painter=h,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[T,k,P]=function(z){const G=new y.StructArrayLayout2i4,$=new y.StructArrayLayout3ui6;G.reserve(17161),$.reserve(33800);const ue=y.EXTENT/128,fe=y.EXTENT+ue/2,_e=fe+ue;for(let Te=-ue;Te<_e;Te+=ue)for(let de=-ue;de<_e;de+=ue){const Oe=de<0||de>fe||Te<0||Te>fe?24575:0,Re=y.clamp(Math.round(de),0,y.EXTENT),Fe=y.clamp(Math.round(Te),0,y.EXTENT);G.emplaceBack(Re+Oe,Fe)}const ye=(Te,de)=>{const Oe=131*de+Te;$.emplaceBack(Oe+1,Oe,Oe+131),$.emplaceBack(Oe+131,Oe+131+1,Oe+1)};for(let Te=1;Te<129;Te++)for(let de=1;de<129;de++)ye(de,Te);return[0,129].forEach(Te=>{for(let de=0;de<130;de++)ye(de,Te),ye(Te,de)}),[G,$,32768]}(),I=h.context;this.gridBuffer=I.createVertexBuffer(T,y.posAttributes.members),this.gridIndexBuffer=I.createIndexBuffer(k),this.gridSegments=y.SegmentVector.simpleSegment(0,0,T.length,k.length),this.gridNoSkirtSegments=y.SegmentVector.simpleSegment(0,0,T.length,P),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Wi(_.map),this.orthoMatrix=y.create(),y.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,y.EXTENT,0,y.EXTENT,0,1);const M=I.gl;this._overlapStencilMode=new y.StencilMode({func:M.GEQUAL,mask:255},0,255,M.KEEP,M.KEEP,M.REPLACE),this._previousZoom=h.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=_,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Ac(_.map)}set style(h){h.on("data",this._onStyleDataEvent.bind(this)),h.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=h,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(h,_,T){if(h&&h.terrain){this._style!==h&&(this.style=h),this.enabled=!0;const k=h.terrain.properties;this.sourceCache=0===h.terrain.drapeRenderMode?this._mockSourceCache:h._getSourceCache(k.get("source")),this._exaggeration=k.get("exaggeration");const P=()=>{this.sourceCache.used&&y.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const I=this.getScaledDemTileSize();this.sourceCache.update(_,I,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,P(),this._initializing=!0),P(),_.updateElevation(!0,T),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(_),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(h){this._findCoveringTileCache[h]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const h=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==h.efficiency&&y.warnOnce(`Terrain render cache efficiency is not optimal (${h.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${h.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(h){h.coord&&"source"===h.dataType?this._clearRenderCacheForTile(h.sourceCacheId,h.coord):"style"===h.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const h in this._style._sourceCaches)this._style._sourceCaches[h].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(h=>h.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const h=2*this.proxySourceCache.getSource().tileSize;return[h,h]}set useVertexMorphing(h){this._useVertexMorphing=h}updateTileBinding(h){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const _=this.proxySourceCache,T=this.painter.transform;this._initializing&&(this._initializing=0===T._centerAltitude&&-1===this.getAtPointOrZero(y.MercatorCoordinate.fromLngLat(T.center),-1),this._emptyDEMTextureDirty=!this._initializing);const k=this.proxyCoords=_.getIds().map(z=>{const G=_.getTileByID(z).tileID;return G.projMatrix=T.calculateProjMatrix(G.toUnwrapped()),G});(function(z,G){const $=G.transform.pointCoordinate(G.transform.getCameraPoint()),te=new y.pointGeometry($.x,$.y);z.sort((ue,fe)=>{if(fe.overscaledZ-ue.overscaledZ)return fe.overscaledZ-ue.overscaledZ;const _e=new y.pointGeometry(ue.canonical.x+(1<<ue.canonical.z)*ue.wrap,ue.canonical.y),ye=new y.pointGeometry(fe.canonical.x+(1<<fe.canonical.z)*fe.wrap,fe.canonical.y),Te=te.mult(1<<ue.canonical.z);return Te.x-=.5,Te.y-=.5,Te.distSqr(_e)-Te.distSqr(ye)})})(k,this.painter),this._previousZoom=T.zoom;const P=this.proxyToSource||{};this.proxyToSource={},k.forEach(z=>{this.proxyToSource[z.key]={}}),this.terrainTileForTile={};const I=this._style._sourceCaches;for(const z in I){const G=I[z];if(!G.used||(G!==this.sourceCache&&this.resetTileLookupCache(G.id),this._setupProxiedCoordsForOrtho(G,h[z],P),G.usedForTerrain))continue;const $=h[z];G.getSource().reparseOverscaled&&this._assignTerrainTiles($)}this.proxiedCoords[_.id]=k.map(z=>new Mc(z,z.key,this.orthoMatrix)),this._assignTerrainTiles(k),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(P),this.renderingToTexture=!1,this._updateTimestamp=y.exported.now();const M={};this._visibleDemTiles=[];for(const z of this.proxyCoords){const G=this.terrainTileForTile[z.key];if(!G)continue;const $=G.tileID.key;$ in M||(this._visibleDemTiles.push(G),M[$]=$)}}_assignTerrainTiles(h){this._initializing||h.forEach(_=>{if(this.terrainTileForTile[_.key])return;const T=this._findTileCoveringTileID(_,this.sourceCache);T&&(this.terrainTileForTile[_.key]=T)})}_prepareDEMTextures(){const h=this.painter.context,_=h.gl;for(const T in this.terrainTileForTile){const k=this.terrainTileForTile[T],P=k.dem;!P||k.demTexture&&!k.needsDEMTextureUpload||(h.activeTexture.set(_.TEXTURE1),Uu(this.painter,k,P))}}_prepareDemTileUniforms(h,_,T,k){if(!_||null==_.demTexture)return!1;const P=h.tileID.canonical,I=Math.pow(2,_.tileID.canonical.z-P.z),M=k||"";return T[`u_dem_tl${M}`]=[P.x*I%1,P.y*I%1],T[`u_dem_scale${M}`]=I,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const h=this.painter.context,_=h.gl;if(!this._emptyDepthBufferTexture){const T=new y.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new y.Texture(h,T,_.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let h=0;const _=this._visibleDemTiles.reduce((T,k)=>{if(!k.dem)return T;const P=k.dem.tree.minimums[0];return P>0&&h++,T+P},0);return h?_/h:0}_updateEmptyDEMTexture(){const h=this.painter.context,_=h.gl;h.activeTexture.set(_.TEXTURE2);const T=this._getLoadedAreaMinimum(),k=new y.RGBAImage({width:1,height:1},new Uint8Array(y.DEMData.pack(T,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let P=this._emptyDEMTexture;return P?P.update(k,{premultiply:!1}):P=this._emptyDEMTexture=new y.Texture(h,k,_.RGBA,{premultiply:!1}),P}setupElevationDraw(h,_,T){const k=this.painter.context,P=k.gl,I=(M=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:y.DEMData.getUnpackVector(M),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var M;I.u_dem_size=this.sourceCache.getSource().tileSize,I.u_exaggeration=this.exaggeration();let z=null,G=null,$=1;if(T&&T.morphing&&this._useVertexMorphing){const te=T.morphing.srcDemTile,ue=T.morphing.dstDemTile;$=T.morphing.phase,te&&ue&&(this._prepareDemTileUniforms(h,te,I,"_prev")&&(G=te),this._prepareDemTileUniforms(h,ue,I)&&(z=ue))}if(G&&z?(k.activeTexture.set(P.TEXTURE2),z.demTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE,P.NEAREST),k.activeTexture.set(P.TEXTURE4),G.demTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE,P.NEAREST),I.u_dem_lerp=$):(z=this.terrainTileForTile[h.tileID.key],k.activeTexture.set(P.TEXTURE2),(this._prepareDemTileUniforms(h,z,I)?z.demTexture:this.emptyDEMTexture).bind(P.NEAREST,P.CLAMP_TO_EDGE)),k.activeTexture.set(P.TEXTURE3),T&&T.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE),this._depthFBO&&(I.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE),I.u_depth_size_inv=[1,1]),T&&T.useMeterToDem&&z){const te=(1<<z.tileID.canonical.z)*y.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;I.u_meter_to_dem=te}if(T&&T.labelPlaneMatrixInv&&(I.u_label_plane_matrix_inv=T.labelPlaneMatrixInv),_.setTerrainUniformValues(k,I),"globe"===this.painter.transform.projection.name){const te=this.globeUniformValues(this.painter.transform,h.tileID.canonical,T&&T.useDenormalizedUpVectorScale);_.setGlobeUniformValues(k,te)}}globeUniformValues(h,_,T){const k=h.projection;return{u_tile_tl_up:k.upVector(_,0,0),u_tile_tr_up:k.upVector(_,y.EXTENT,0),u_tile_br_up:k.upVector(_,y.EXTENT,y.EXTENT),u_tile_bl_up:k.upVector(_,0,y.EXTENT),u_tile_up_scale:T?y.globeMetersToEcef(1):k.upVectorScale(_,h.center.lat,h.worldSize).metersToTile}}renderToBackBuffer(h){const _=this.painter,T=this.painter.context;0!==h.length&&(T.bindFramebuffer.set(null),T.viewport.set([0,0,_.width,_.height]),_.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(k,P,I,M,z){if("globe"===k.transform.projection.name)!function(G,$,te,ue,fe){const _e=G.context,ye=_e.gl;let Te,de;const Oe=G.options.showTerrainWireframe?2:0,Re=G.transform,Fe=y.globeUseCustomAntiAliasing(G,_e,Re),Ye=(sn,Tt)=>{if(de===sn)return;const yt=[yl[sn],"PROJECTION_GLOBE_VIEW"];Fe&&yt.push("CUSTOM_ANTIALIASING"),Tt&&yt.push(yl[Oe]),Te=G.useProgram("globeRaster",null,yt),de=sn},We=G.colorModeForRenderPass(),Xe=new y.DepthMode(ye.LEQUAL,y.DepthMode.ReadWrite,G.depthRangeFor3D);Co.update(fe);const ut=y.calculateGlobeMercatorMatrix(Re),Et=[y.mercatorXfromLng(Re.center.lng),y.mercatorYfromLat(Re.center.lat)],At=Oe?[!1,!0]:[!1],on=G.globeSharedBuffers,wt=[Re.width*y.exported.devicePixelRatio,Re.height*y.exported.devicePixelRatio],qt=Float32Array.from(Re.globeMatrix),Nt={useDenormalizedUpVectorScale:!0};if(At.forEach(sn=>{const Tt=G.transform,yt=vl(Tt.zoom)*$.exaggeration();de=-1;const Pt=sn?ye.LINES:ye.TRIANGLES;for(const tn of ue){const hn=te.getTile(tn),$n=y.StencilMode.disabled,ki=$.prevTerrainTileForTile[tn.key],Gn=$.terrainTileForTile[tn.key];Oa(ki,Gn)&&Co.newMorphing(tn.key,ki,Gn,fe,250),_e.activeTexture.set(ye.TEXTURE0),hn.texture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE);const On=Co.getMorphValuesForProxy(tn.key),Jn=On?1:0;On&&y.extend$1(Nt,{morphing:{srcDemTile:On.from,dstDemTile:On.to,phase:y.easeCubicInOut(On.phase)}});const sr=y.tileCornersToBounds(tn.canonical),hi=y.getLatitudinalLod(sr.getCenter().lat),Lr=y.getGridMatrix(tn.canonical,sr,hi,Tt.worldSize/Tt._pixelsPerMercatorPixel),Hr=y.globeNormalizeECEF(y.globeTileBounds(tn.canonical)),Xr=ru(Tt.projMatrix,qt,ut,Hr,y.globeToMercatorTransition(Tt.zoom),Et,Tt.frustumCorners.TL,Tt.frustumCorners.TR,Tt.frustumCorners.BR,Tt.frustumCorners.BL,Tt.globeCenterInViewSpace,Tt.globeRadius,wt,yt,Lr);if(Ye(Jn,sn),$.setupElevationDraw(hn,Te,Nt),G.prepareDrawProgram(_e,Te,tn.toUnwrapped()),on){const[Kr,is,sa]=sn?on.getWirefameBuffers(G.context,hi):on.getGridBuffers(hi,0!==yt);Te.draw(_e,Pt,Xe,$n,We,y.CullFaceMode.backCCW,Xr,"globe_raster",Kr,is,sa)}}}),on){const sn=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Fe&&sn.push("CUSTOM_ANTIALIASING"),Te=G.useProgram("globeRaster",null,sn);for(const Tt of ue){const{x:yt,y:Pt,z:tn}=Tt.canonical,hn=0===Pt,$n=Pt===(1<<tn)-1,[ki,Gn,On,Jn]=on.getPoleBuffers(tn);if(Jn&&(hn||$n)){const sr=te.getTile(Tt);_e.activeTexture.set(ye.TEXTURE0),sr.texture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE);let hi=y.globePoleMatrixForTile(tn,yt,Re);const Lr=y.globeNormalizeECEF(y.globeTileBounds(Tt.canonical)),Hr=(Xr,Kr)=>Xr.draw(_e,ye.TRIANGLES,Xe,y.StencilMode.disabled,We,y.CullFaceMode.disabled,ru(Re.projMatrix,hi,hi,Lr,0,Et,Re.frustumCorners.TL,Re.frustumCorners.TR,Re.frustumCorners.BR,Re.frustumCorners.BL,Re.globeCenterInViewSpace,Re.globeRadius,wt,0),"globe_pole_raster",Kr,On,Jn);$.setupElevationDraw(sr,Te,Nt),G.prepareDrawProgram(_e,Te,Tt.toUnwrapped()),hn&&Hr(Te,ki),$n&&(hi=y.scale(y.create(),hi,[1,-1,1]),Hr(Te,Gn))}}}}(k,P,I,M,z);else{const G=k.context,$=G.gl;let te,ue;const fe=k.options.showTerrainWireframe?2:0,_e=(Re,Fe)=>{if(ue===Re)return;const Ye=[yl[Re]];Fe&&Ye.push(yl[fe]),te=k.useProgram("terrainRaster",null,Ye),ue=Re},ye=k.colorModeForRenderPass(),Te=new y.DepthMode($.LEQUAL,y.DepthMode.ReadWrite,k.depthRangeFor3D);Co.update(z);const de=k.transform,Oe=vl(de.zoom)*P.exaggeration();(fe?[!1,!0]:[!1]).forEach(Re=>{ue=-1;const Fe=Re?$.LINES:$.TRIANGLES,[Ye,We]=Re?P.getWirefameBuffer():[P.gridIndexBuffer,P.gridSegments];for(const Xe of M){const ut=I.getTile(Xe),Et=y.StencilMode.disabled,At=P.prevTerrainTileForTile[Xe.key],on=P.terrainTileForTile[Xe.key];Oa(At,on)&&Co.newMorphing(Xe.key,At,on,z,250),G.activeTexture.set($.TEXTURE0),ut.texture.bind($.LINEAR,$.CLAMP_TO_EDGE,$.LINEAR_MIPMAP_NEAREST);const wt=Co.getMorphValuesForProxy(Xe.key),qt=wt?1:0;let Nt;wt&&(Nt={morphing:{srcDemTile:wt.from,dstDemTile:wt.to,phase:y.easeCubicInOut(wt.phase)}});const sn=_l(Xe.projMatrix,$d(Xe.canonical,de.renderWorldCopies)?Oe/10:Oe);_e(qt,Re),P.setupElevationDraw(ut,te,Nt),k.prepareDrawProgram(G,te,Xe.toUnwrapped()),te.draw(G,Fe,Te,Et,ye,y.CullFaceMode.backCCW,sn,"terrain_raster",P.gridBuffer,Ye,We)}})}}(_,this,this.proxySourceCache,h,this._updateTimestamp),this.renderingToTexture=!0,_.gpuTimingDeferredRenderEnd(),h.splice(0,h.length))}renderBatch(h){if(0===this._drapedRenderBatches.length)return h+1;this.renderingToTexture=!0;const _=this.painter,T=this.painter.context,k=this.proxySourceCache,P=this.proxiedCoords[k.id],I=this._drapedRenderBatches.shift(),M=[],z=_.style.order;let G=0;for(const $ of P){const te=k.getTileByID($.proxyTileKey),ue=k.proxyCachedFBO[$.key]?k.proxyCachedFBO[$.key][h]:void 0,fe=void 0!==ue?k.renderCache[ue]:this.pool[G++],_e=void 0!==ue;if(te.texture=fe.tex,_e&&!fe.dirty){M.push(te.tileID);continue}let ye;T.bindFramebuffer.set(fe.fb.framebuffer),this.renderedToTile=!1,fe.dirty&&(T.clear({color:y.Color.transparent,stencil:0}),fe.dirty=!1);for(let Te=I.start;Te<=I.end;++Te){const de=_.style._layers[z[Te]];if(de.isHidden(_.transform.zoom))continue;const Oe=_.style._getLayerSourceCache(de),Re=Oe?this.proxyToSource[$.key][Oe.id]:[$];if(!Re)continue;const Fe=Re;T.viewport.set([0,0,fe.fb.width,fe.fb.height]),ye!==(Oe?Oe.id:null)&&(this._setupStencil(fe,Re,de,Oe),ye=Oe?Oe.id:null),_.renderLayer(_,Oe,de,Fe)}this.renderedToTile?(fe.dirty=!0,M.push(te.tileID)):_e||--G,5===G&&(G=0,this.renderToBackBuffer(M))}return this.renderToBackBuffer(M),this.renderingToTexture=!1,T.bindFramebuffer.set(null),T.viewport.set([0,0,_.width,_.height]),I.end+1}postRender(){}renderCacheEfficiency(h){const _=h.order.length;if(0===_)return{efficiency:100};let T,k=0,P=0,I=!1;for(let M=0;M<_;++M){const z=h._layers[h.order[M]];this._style.isLayerDraped(z)?(I&&++k,++P):I||(I=!0,T=z.id)}return 0===P?{efficiency:100}:{efficiency:100*(1-k/P),firstUndrapedLayer:T}}getMinElevationBelowMSL(){let h=0;return this._visibleDemTiles.filter(_=>_.dem).forEach(_=>{h=Math.min(h,_.dem.tree.minimums[0])}),0===h?h:(h-30)*this._exaggeration}raycast(h,_,T){if(!this._visibleDemTiles)return null;const k=this._visibleDemTiles.filter(P=>P.dem).map(P=>{const I=P.tileID,M=1<<I.overscaledZ,{x:z,y:G}=I.canonical,$=z/M,te=(z+1)/M,ue=G/M,fe=(G+1)/M;return{minx:$,miny:ue,maxx:te,maxy:fe,t:P.dem.tree.raycastRoot($,ue,te,fe,h,_,T),tile:P}});k.sort((P,I)=>(null!==P.t?P.t:Number.MAX_VALUE)-(null!==I.t?I.t:Number.MAX_VALUE));for(const P of k){if(null==P.t)return null;const I=P.tile.dem.tree.raycast(P.minx,P.miny,P.maxx,P.maxy,h,_,T);if(null!=I)return I}return null}_createFBO(){const h=this.painter.context,_=h.gl,T=this.drapeBufferSize;h.activeTexture.set(_.TEXTURE0);const k=new y.Texture(h,{width:T[0],height:T[1],data:null},_.RGBA);k.bind(_.LINEAR,_.CLAMP_TO_EDGE);const P=h.createFramebuffer(T[0],T[1],!1);return P.colorAttachment.set(k.texture),P.depthAttachment=new Ue(h,P.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=h.createRenderbuffer(h.gl.DEPTH_STENCIL,T[0],T[1]),this._stencilRef=0,P.depthAttachment.set(this._sharedDepthStencil),h.clear({stencil:0})):P.depthAttachment.set(this._sharedDepthStencil),h.extTextureFilterAnisotropic&&!h.extTextureFilterAnisotropicForceOff&&_.texParameterf(_.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax),{fb:P,tex:k,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const h in this._style._sourceCaches)if(this._style._sourceCaches[h].hasTransition())return!0;return this._style.order.some(h=>{const _=this._style._layers[h],T=_.isHidden(this.painter.transform.zoom);return"custom"===_.type?!T&&_.shouldRedrape():!T&&_.hasTransition()})}_clearLineLayersFromRenderCache(){let h=!1;for(const T of this._style._getSources())if(T instanceof ie){h=!0;break}if(!h)return;const _={};for(let T=0;T<this._style.order.length;++T){const k=this._style._layers[this._style.order[T]],P=this._style._getLayerSourceCache(k);if(P&&!_[P.id]&&!k.isHidden(this.painter.transform.zoom)&&"line"===k.type&&k.widthExpression()instanceof y.ZoomDependentExpression){_[P.id]=!0;for(const I of this.proxyCoords){const M=this.proxyToSource[I.key][P.id];if(M)for(const z of M)this._clearRenderCacheForTile(P.id,z)}}}}_clearRasterLayersFromRenderCache(){let h=!1;for(const T in this._style._sourceCaches)if(this._style._sourceCaches[T]._source instanceof ae){h=!0;break}if(!h)return;const _={};for(let T=0;T<this._style.order.length;++T){const k=this._style._layers[this._style.order[T]],P=this._style._getLayerSourceCache(k);if(!P||_[P.id]||k.isHidden(this.painter.transform.zoom)||"raster"!==k.type)continue;const I=k.paint.get("raster-fade-duration");for(const M of this.proxyCoords){const z=this.proxyToSource[M.key][P.id];if(z)for(const G of z){const $=Hu(P.getTile(G),P.findLoadedParent(G,0),P,this.painter.transform,I);(1!==$.opacity||0!==$.mix)&&this._clearRenderCacheForTile(P.id,G)}}}}_setupDrapedRenderBatches(){const h=this._style.order,_=h.length;if(0===_)return;const T=[];let k,P=0,I=this._style._layers[h[P]];for(;!this._style.isLayerDraped(I)&&I.isHidden(this.painter.transform.zoom)&&++P<_;)I=this._style._layers[h[P]];for(;P<_;++P){const M=this._style._layers[h[P]];M.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(M)?void 0===k&&(k=P):void 0!==k&&(T.push({start:k,end:P-1}),k=void 0))}void 0!==k&&T.push({start:k,end:P-1}),this._drapedRenderBatches=T}_setupRenderCache(h){const _=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,_.renderCache.length>_.renderCachePool.length){const I=Object.values(_.proxyCachedFBO);_.proxyCachedFBO={};for(let M=0;M<I.length;++M){const z=Object.values(I[M]);_.renderCachePool.push(...z)}}return}this._clearRasterLayersFromRenderCache();const T=this.proxyCoords,k=this._tilesDirty;for(let I=T.length-1;I>=0;I--){const M=T[I];if(_.getTileByID(M.key),void 0!==_.proxyCachedFBO[M.key]){const z=h[M.key],G=this.proxyToSource[M.key];let $=0;for(const te in G){const ue=G[te],fe=z[te];if(!fe||fe.length!==ue.length||ue.some((_e,ye)=>_e!==fe[ye]||k[te]&&k[te].hasOwnProperty(_e.key))){$=-1;break}++$}for(const te in _.proxyCachedFBO[M.key])_.renderCache[_.proxyCachedFBO[M.key][te]].dirty=$<0||$!==Object.values(z).length}}const P=[...this._drapedRenderBatches];P.sort((I,M)=>M.end-M.start-(I.end-I.start));for(const I of P)for(const M of T){if(_.proxyCachedFBO[M.key])continue;let z=_.renderCachePool.pop();void 0===z&&_.renderCache.length<50&&(z=_.renderCache.length,_.renderCache.push(this._createFBO())),void 0!==z&&(_.proxyCachedFBO[M.key]={},_.proxyCachedFBO[M.key][I.start]=z,_.renderCache[z].dirty=!0)}this._tilesDirty={}}_setupStencil(h,_,T,k){if(!k||!this._sourceTilesOverlap[k.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const P=this.painter.context,I=P.gl;if(_.length<=1)return void(this._overlapStencilType=!1);let M;if(T.isTileClipped())M=_.length,this._overlapStencilMode.test={func:I.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(_[0].overscaledZ>_[_.length-1].overscaledZ))return void(this._overlapStencilType=!1);M=1,this._overlapStencilMode.test={func:I.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+M>255&&(P.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=M,this._overlapStencilMode.ref=this._stencilRef,T.isTileClipped()&&this._renderTileClippingMasks(_,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(h){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[h.key]),this._overlapStencilMode):y.StencilMode.disabled}_renderTileClippingMasks(h,_){const T=this.painter,k=this.painter.context,P=k.gl;T._tileClippingMaskIDs={},k.setColorMode(y.ColorMode.disabled),k.setDepthMode(y.DepthMode.disabled);const I=T.useProgram("clippingMask");for(const M of h){const z=T._tileClippingMaskIDs[M.key]=--_;I.draw(k,P.TRIANGLES,y.DepthMode.disabled,new y.StencilMode({func:P.ALWAYS,mask:0},z,255,P.KEEP,P.KEEP,P.REPLACE),y.ColorMode.disabled,y.CullFaceMode.disabled,Oi(M.projMatrix),"$clipping",T.tileExtentBuffer,T.quadTriangleIndexBuffer,T.tileExtentSegments)}}pointCoordinate(h){const _=this.painter.transform;if(h.x<0||h.x>_.width||h.y<0||h.y>_.height)return null;const T=[h.x,h.y,1,1];y.transformMat4$1(T,T,_.pixelMatrixInverse),y.scale$1(T,T,1/T[3]),T[0]/=_.worldSize,T[1]/=_.worldSize;const k=_._camera.position,P=y.mercatorZfromAltitude(1,_.center.lat),I=[k[0],k[1],k[2]/P,0],M=y.subtract([],T.slice(0,3),I);y.normalize(M,M);const z=this.raycast(I,M,this._exaggeration);return null!==z&&z?(y.scaleAndAdd(I,I,M,z),I[3]=I[2],I[2]*=P,I):null}drawDepth(){const h=this.painter,_=h.context,T=this.proxySourceCache,k=Math.ceil(h.width),P=Math.ceil(h.height);if(!this._depthFBO||this._depthFBO.width===k&&this._depthFBO.height===P||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const I=_.gl,M=_.createFramebuffer(k,P,!0);_.activeTexture.set(I.TEXTURE0);const z=new y.Texture(_,{width:k,height:P,data:null},I.RGBA);z.bind(I.NEAREST,I.CLAMP_TO_EDGE),M.colorAttachment.set(z.texture);const G=_.createRenderbuffer(_.gl.DEPTH_COMPONENT16,k,P);M.depthAttachment.set(G),this._depthFBO=M,this._depthTexture=z}_.bindFramebuffer.set(this._depthFBO.framebuffer),_.viewport.set([0,0,k,P]),function(I,M,z,G){if("globe"===I.transform.projection.name)return;const $=I.context,te=$.gl;$.clear({depth:1});const ue=I.useProgram("terrainDepth"),fe=new y.DepthMode(te.LESS,y.DepthMode.ReadWrite,I.depthRangeFor3D);for(const _e of G){const ye=z.getTile(_e),Te=_l(_e.projMatrix,0);M.setupElevationDraw(ye,ue),ue.draw($,te.TRIANGLES,fe,y.StencilMode.disabled,y.ColorMode.unblended,y.CullFaceMode.backCCW,Te,"terrain_depth",M.gridBuffer,M.gridIndexBuffer,M.gridNoSkirtSegments)}}(h,this,T,this.proxyCoords)}_setupProxiedCoordsForOrtho(h,_,T){if(h.getSource()instanceof Ve)return this._setupProxiedCoordsForImageSource(h,_,T);this._findCoveringTileCache[h.id]=this._findCoveringTileCache[h.id]||{};const k=this.proxiedCoords[h.id]=[],P=this.proxyCoords;for(let M=0;M<P.length;M++){const z=P[M],G=this._findTileCoveringTileID(z,h);if(G){const $=this._createProxiedId(z,G,T[z.key]&&T[z.key][h.id]);k.push($),this.proxyToSource[z.key][h.id]=[$]}}let I=!1;for(let M=0;M<_.length;M++){const z=h.getTile(_[M]);if(!z||!z.hasData())continue;const G=this._findTileCoveringTileID(z.tileID,this.proxySourceCache);if(G&&G.tileID.canonical.z!==z.tileID.canonical.z){const $=this.proxyToSource[G.tileID.key][h.id],te=this._createProxiedId(G.tileID,z,T[G.tileID.key]&&T[G.tileID.key][h.id]);$?$.splice($.length-1,0,te):this.proxyToSource[G.tileID.key][h.id]=[te],k.push(te),I=!0}}this._sourceTilesOverlap[h.id]=I}_setupProxiedCoordsForImageSource(h,_,T){if(!h.getSource().loaded())return;const k=this.proxiedCoords[h.id]=[],P=this.proxyCoords,I=h.getSource(),M=new y.pointGeometry(I.tileID.x,I.tileID.y)._div(1<<I.tileID.z),z=I.coordinates.map(y.MercatorCoordinate.fromLngLat).reduce(($,te)=>($.min.x=Math.min($.min.x,te.x-M.x),$.min.y=Math.min($.min.y,te.y-M.y),$.max.x=Math.max($.max.x,te.x-M.x),$.max.y=Math.max($.max.y,te.y-M.y),$),{min:new y.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new y.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),G=($,te)=>{const ue=$.wrap+$.canonical.x/(1<<$.canonical.z),fe=$.canonical.y/(1<<$.canonical.z),_e=y.EXTENT/(1<<$.canonical.z),ye=te.wrap+te.canonical.x/(1<<te.canonical.z),Te=te.canonical.y/(1<<te.canonical.z);return ue+_e<ye+z.min.x||ue>ye+z.max.x||fe+_e<Te+z.min.y||fe>Te+z.max.y};for(let $=0;$<P.length;$++){const te=P[$];for(let ue=0;ue<_.length;ue++){const fe=h.getTile(_[ue]);if(!fe||!fe.hasData()||G(te,fe.tileID))continue;const _e=this._createProxiedId(te,fe,T[te.key]&&T[te.key][h.id]),ye=this.proxyToSource[te.key][h.id];ye?ye.push(_e):this.proxyToSource[te.key][h.id]=[_e],k.push(_e)}}}_createProxiedId(h,_,T){let k=this.orthoMatrix;if(T){const P=T.find(I=>I.key===_.tileID.key);if(P)return P}if(_.tileID.key!==h.key){const P=h.canonical.z-_.tileID.canonical.z;let I,M,z;k=y.create();const G=_.tileID.wrap-h.wrap<<h.overscaledZ;P>0?(I=y.EXTENT>>P,M=I*((_.tileID.canonical.x<<P)-h.canonical.x+G),z=I*((_.tileID.canonical.y<<P)-h.canonical.y)):(I=y.EXTENT<<-P,M=y.EXTENT*(_.tileID.canonical.x-(h.canonical.x+G<<-P)),z=y.EXTENT*(_.tileID.canonical.y-(h.canonical.y<<-P))),y.ortho(k,0,I,0,I,0,1),y.translate(k,k,[M,z,0])}return new Mc(_.tileID,h.key,k)}_findTileCoveringTileID(h,_){let T=_.getTile(h);if(T&&T.hasData())return T;const k=this._findCoveringTileCache[_.id],P=k[h.key];if(T=P?_.getTileByID(P):null,T&&T.hasData()||null===P)return T;let I=T?T.tileID:h,M=I.overscaledZ;const z=_.getSource().minzoom,G=[];if(!P){const te=_.getSource().maxzoom;if(h.canonical.z>=te){const ue=h.canonical.z-te;_.getSource().reparseOverscaled?(M=Math.max(h.canonical.z+2,_.transform.tileZoom),I=new y.OverscaledTileID(M,h.wrap,te,h.canonical.x>>ue,h.canonical.y>>ue)):0!==ue&&(M=te,I=new y.OverscaledTileID(M,h.wrap,te,h.canonical.x>>ue,h.canonical.y>>ue))}I.key!==h.key&&(G.push(I.key),T=_.getTile(I))}const $=te=>{G.forEach(ue=>{k[ue]=te}),G.length=0};for(M-=1;M>=z&&(!T||!T.hasData());M--){T&&$(T.tileID.key);const te=I.calculateScaledKey(M);if(T=_.getTileByID(te),T&&T.hasData())break;const ue=k[te];if(null===ue)break;void 0===ue?G.push(te):T=_.getTileByID(ue)}return $(T?T.tileID.key:null),T&&T.hasData()?T:null}findDEMTileFor(h){return this.enabled?this._findTileCoveringTileID(h,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(h,_){let T=this._tilesDirty[h];T||(T=this._tilesDirty[h]={}),T[_.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const h=function(_){let T=0;const k=new y.StructArrayLayout2ui4,P=131;for(let I=1;I<129;I++){for(let M=1;M<129;M++)T=I*P+M,k.emplaceBack(T,T+1),k.emplaceBack(T,T+P),k.emplaceBack(T+1,T+P),128===I&&k.emplaceBack(T+P,T+P+1);k.emplaceBack(T+1,T+1+P)}return k}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(h),this.wireframeSegments=y.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,h.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class ju{static cacheKey(h,_,T,k){let P=`${_}${k?k.cacheKey:""}`;for(const I of T)h.usedDefines.includes(I)&&(P+=`/${I}`);return P}constructor(h,_,T,k,P,I){const M=h.gl;this.program=M.createProgram();const z=function(de){const Oe=[];for(let Re=0;Re<de.length;Re++){if(null===de[Re])continue;const Fe=de[Re].split(" ");Oe.push(Fe.pop())}return Oe}(T.staticAttributes),G=k?k.getBinderAttributes():[],$=z.concat(G);let te=k?k.defines():[];te=te.concat(I.map(de=>`#define ${de}`));const ue=h.isWebGL2?"#version 300 es\n":"",fe=ue+te.concat(h.extStandardDerivatives&&0===ue.length?"#extension GL_OES_standard_derivatives : enable\n".concat(gh):gh,gh,Dc,Ic.fragmentSource,Vu.fragmentSource,T.fragmentSource).join("\n"),_e=ue+te.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",Dc,Ic.vertexSource,Vu.vertexSource,iu.vertexSource,T.vertexSource).join("\n"),ye=M.createShader(M.FRAGMENT_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);M.shaderSource(ye,fe),M.compileShader(ye),M.attachShader(this.program,ye);const Te=M.createShader(M.VERTEX_SHADER);if(M.isContextLost())this.failedToCreate=!0;else{M.shaderSource(Te,_e),M.compileShader(Te),M.attachShader(this.program,Te),this.attributes={},this.numAttributes=$.length;for(let de=0;de<this.numAttributes;de++)$[de]&&(M.bindAttribLocation(this.program,de,$[de]),this.attributes[$[de]]=de);M.linkProgram(this.program),M.deleteShader(Te),M.deleteShader(ye),this.fixedUniforms=P(h),this.binderUniforms=k?k.getUniforms(h):[],I.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new y.Uniform1i(de=h),u_dem_prev:new y.Uniform1i(de),u_dem_unpack:new y.Uniform4f(de),u_dem_tl:new y.Uniform2f(de),u_dem_scale:new y.Uniform1f(de),u_dem_tl_prev:new y.Uniform2f(de),u_dem_scale_prev:new y.Uniform1f(de),u_dem_size:new y.Uniform1f(de),u_dem_lerp:new y.Uniform1f(de),u_exaggeration:new y.Uniform1f(de),u_depth:new y.Uniform1i(de),u_depth_size_inv:new y.Uniform2f(de),u_meter_to_dem:new y.Uniform1f(de),u_label_plane_matrix_inv:new y.UniformMatrix4f(de)}),I.includes("GLOBE")&&(this.globeUniforms=(de=>({u_tile_tl_up:new y.Uniform3f(de),u_tile_tr_up:new y.Uniform3f(de),u_tile_br_up:new y.Uniform3f(de),u_tile_bl_up:new y.Uniform3f(de),u_tile_up_scale:new y.Uniform1f(de)}))(h)),I.includes("FOG")&&(this.fogUniforms=(de=>({u_fog_matrix:new y.UniformMatrix4f(de),u_fog_range:new y.Uniform2f(de),u_fog_color:new y.Uniform4f(de),u_fog_horizon_blend:new y.Uniform1f(de),u_fog_temporal_offset:new y.Uniform1f(de),u_frustum_tl:new y.Uniform3f(de),u_frustum_tr:new y.Uniform3f(de),u_frustum_br:new y.Uniform3f(de),u_frustum_bl:new y.Uniform3f(de),u_globe_pos:new y.Uniform3f(de),u_globe_radius:new y.Uniform1f(de),u_globe_transition:new y.Uniform1f(de),u_is_globe:new y.Uniform1i(de),u_viewport:new y.Uniform2f(de)}))(h))}var de}setTerrainUniformValues(h,_){if(!this.terrainUniforms)return;const T=this.terrainUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const k in _)T[k]&&T[k].set(this.program,k,_[k])}}setGlobeUniformValues(h,_){if(!this.globeUniforms)return;const T=this.globeUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const k in _)T[k]&&T[k].set(this.program,k,_[k])}}setFogUniformValues(h,_){if(!this.fogUniforms)return;const T=this.fogUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const k in _)T[k].set(this.program,k,_[k])}}draw(h,_,T,k,P,I,M,z,G,$,te,ue,fe,_e,ye){const Te=h.gl;if(this.failedToCreate)return;h.program.set(this.program),h.setDepthMode(T),h.setStencilMode(k),h.setColorMode(P),h.setCullFace(I);for(const Oe of Object.keys(this.fixedUniforms))this.fixedUniforms[Oe].set(this.program,Oe,M[Oe]);_e&&_e.setUniforms(this.program,h,this.binderUniforms,ue,{zoom:fe});const de={[Te.LINES]:2,[Te.TRIANGLES]:3,[Te.LINE_STRIP]:1}[_];for(const Oe of te.get()){const Re=Oe.vaos||(Oe.vaos={});(Re[z]||(Re[z]=new Ro)).bind(h,this,G,_e?_e.getPaintVertexBuffers():[],$,Oe.vertexOffset,ye||[]),Te.drawElements(_,Oe.primitiveLength*de,Te.UNSIGNED_SHORT,Oe.primitiveOffset*de*2)}}}function Rp(w,h){const _=Math.pow(2,h.tileID.overscaledZ),T=h.tileSize*Math.pow(2,w.transform.tileZoom)/_,k=T*(h.tileID.canonical.x+h.tileID.wrap*_),P=T*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_tile_units_to_pixels:1/or(h,1,w.transform.tileZoom),u_pixel_coord_upper:[k>>16,P>>16],u_pixel_coord_lower:[65535&k,65535&P]}}const yh=y.create(),vh=(w,h,_,T,k,P,I,M,z,G,$)=>{const te=h.style.light,ue=te.properties.get("position"),fe=[ue.x,ue.y,ue.z],_e=y.create$1();"viewport"===te.properties.get("anchor")&&(y.fromRotation(_e,-h.transform.angle),y.transformMat3(fe,fe,_e));const ye=te.properties.get("color"),Te=h.transform,de={u_matrix:w,u_lightpos:fe,u_lightintensity:te.properties.get("intensity"),u_lightcolor:[ye.r,ye.g,ye.b],u_vertical_gradient:+_,u_opacity:T,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:yh,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:k,u_edge_radius:P};return"globe"===Te.projection.name&&(de.u_tile_id=[I.canonical.x,I.canonical.y,1<<I.canonical.z],de.u_zoom_transition=z,de.u_inv_rot_matrix=$,de.u_merc_center=G,de.u_up_dir=Te.projection.upVector(new y.CanonicalTileID(0,0,0),G[0]*y.EXTENT,G[1]*y.EXTENT),de.u_height_lift=M),de},Gu=(w,h,_,T,k,P,I,M,z,G,$,te)=>{const ue=vh(w,h,_,T,k,P,I,z,G,$,te),fe={u_height_factor:-Math.pow(2,I.overscaledZ)/M.tileSize/8};return y.extend(ue,Rp(h,M),fe)},Wd=w=>({u_matrix:w}),dn=(w,h,_)=>y.extend(Wd(w),Rp(h,_)),xi=(w,h)=>({u_matrix:w,u_world:h}),Pp=(w,h,_,T)=>y.extend(dn(w,h,_),{u_world:T}),Op=y.create(),Go=(w,h,_,T,k,P)=>{const I=w.transform,M="globe"===I.projection.name;let z;if("map"===P.paint.get("circle-pitch-alignment"))if(M){const $=y.globePixelsToTileUnits(I.zoom,h.canonical)*I._pixelsPerMercatorPixel;z=Float32Array.from([$,0,0,$])}else z=I.calculatePixelsToTileUnitsMatrix(_);else z=new Float32Array([I.pixelsToGLUnits[0],0,0,I.pixelsToGLUnits[1]]);const G={u_camera_to_center_distance:I.cameraToCenterDistance,u_matrix:w.translatePosMatrix(h.projMatrix,_,P.paint.get("circle-translate"),P.paint.get("circle-translate-anchor")),u_device_pixel_ratio:y.exported.devicePixelRatio,u_extrude_scale:z,u_inv_rot_matrix:Op,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(M){G.u_inv_rot_matrix=T,G.u_merc_center=k,G.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],G.u_zoom_transition=y.globeToMercatorTransition(I.zoom);const $=k[0]*y.EXTENT,te=k[1]*y.EXTENT;G.u_up_dir=I.projection.upVector(new y.CanonicalTileID(0,0,0),$,te)}return G},ou=w=>{const h=[];return"map"===w.paint.get("circle-pitch-alignment")&&h.push("PITCH_WITH_MAP"),"map"===w.paint.get("circle-pitch-scale")&&h.push("SCALE_WITH_MAP"),h},su=(w,h,_,T)=>{const k=y.EXTENT/_.tileSize;return{u_matrix:w,u_camera_to_center_distance:h.getCameraToCenterDistance(T),u_extrude_scale:[h.pixelsToGLUnits[0]/k,h.pixelsToGLUnits[1]/k]}},ga=(w,h,_=1)=>({u_matrix:w,u_color:h,u_overlay:0,u_overlay_scale:_}),ql=y.create(),el=(w,h,_,T,k,P,I)=>{const M=w.transform,z="globe"===M.projection.name,G=z?y.globePixelsToTileUnits(M.zoom,h.canonical)*M._pixelsPerMercatorPixel:or(_,1,P),$={u_matrix:h.projMatrix,u_extrude_scale:G,u_intensity:I,u_inv_rot_matrix:ql,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(z){$.u_inv_rot_matrix=T,$.u_merc_center=k,$.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],$.u_zoom_transition=y.globeToMercatorTransition(M.zoom);const te=k[0]*y.EXTENT,ue=k[1]*y.EXTENT;$.u_up_dir=M.projection.upVector(new y.CanonicalTileID(0,0,0),te,ue)}return $},$u=(w,h,_,T,k,P,I)=>{const M=w.transform,z=M.calculatePixelsToTileUnitsMatrix(h);return{u_matrix:bs(w,h,_,T),u_pixels_to_tile_units:z,u_device_pixel_ratio:P,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:k,u_texsize:Ws(_)?h.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:bl(h,w.transform),u_alpha_discard_threshold:0,u_trim_offset:I}},vm=(w,h,_,T,k)=>{const P=w.transform;return{u_matrix:bs(w,h,_,T),u_texsize:h.imageAtlasTexture.size,u_pixels_to_tile_units:P.calculatePixelsToTileUnitsMatrix(h),u_device_pixel_ratio:k,u_image:0,u_tile_units_to_pixels:bl(h,P),u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function bl(w,h){return 1/or(w,1,h.tileZoom)}function bs(w,h,_,T){return w.translatePosMatrix(T||h.tileID.projMatrix,h,_.paint.get("line-translate"),_.paint.get("line-translate-anchor"))}function Ws(w){const h=w.paint.get("line-dasharray").value;return h.value||"constant"!==h.kind}const nd=(w,h,_,T,k,P)=>{return{u_matrix:w,u_tl_parent:h,u_scale_parent:_,u_fade_t:T.mix,u_opacity:T.opacity*k.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:k.paint.get("raster-brightness-min"),u_brightness_high:k.paint.get("raster-brightness-max"),u_saturation_factor:(M=k.paint.get("raster-saturation"),M>0?1-1/(1.001-M):-M),u_contrast_factor:(I=k.paint.get("raster-contrast"),I>0?1/(1-I):1+I),u_spin_weights:Zs(k.paint.get("raster-hue-rotate")),u_perspective_transform:P};var I,M};function Zs(w){w*=Math.PI/180;const h=Math.sin(w),_=Math.cos(w);return[(2*_+1)/3,(-Math.sqrt(3)*h-_+1)/3,(Math.sqrt(3)*h-_+1)/3]}const Kl=y.create(),id=(w,h,_,T,k,P,I,M,z,G,$,te,ue,fe,_e,ye)=>{const Te=k.transform,de={u_is_size_zoom_constant:+("constant"===w||"source"===w),u_is_size_feature_constant:+("constant"===w||"camera"===w),u_size_t:h?h.uSizeT:0,u_size:h?h.uSize:0,u_camera_to_center_distance:Te.cameraToCenterDistance,u_rotate_symbol:+_,u_aspect_ratio:Te.width/Te.height,u_fade_change:k.options.fadeDuration?k.symbolFadeChange:1,u_matrix:P,u_label_plane_matrix:I,u_coord_matrix:M,u_is_text:+z,u_pitch_with_map:+T,u_texsize:G,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Kl,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Kl,u_up_vector:[0,-1,0]};return"globe"===ye.name&&(de.u_tile_id=[$.canonical.x,$.canonical.y,1<<$.canonical.z],de.u_zoom_transition=te,de.u_inv_rot_matrix=fe,de.u_merc_center=ue,de.u_camera_forward=Te._camera.forward(),de.u_ecef_origin=y.globeECEFOrigin(Te.globeMatrix,$.toUnwrapped()),de.u_tile_matrix=Float32Array.from(Te.globeMatrix),de.u_up_vector=_e),de},au=(w,h,_,T,k,P,I,M,z,G,$,te,ue,fe,_e,ye,Te)=>y.extend(id(w,h,_,T,k,P,I,M,z,G,te,ue,fe,_e,ye,Te),{u_gamma_scale:T?k.transform.cameraToCenterDistance*Math.cos(k.terrain?0:k.transform._pitch):1,u_device_pixel_ratio:y.exported.devicePixelRatio,u_is_halo:+$}),lu=(w,h,_,T,k,P,I,M,z,G,$,te,ue,fe,_e,ye)=>y.extend(au(w,h,_,T,k,P,I,M,!0,z,!0,$,te,ue,fe,_e,ye),{u_texsize_icon:G,u_texture_icon:1}),xf=(w,h,_)=>({u_matrix:w,u_opacity:h,u_color:_}),Yl=(w,h,_,T,k)=>y.extend(function(P,I,M){const z=I.imageManager.getPattern(P.toString()),{width:G,height:$}=I.imageManager.getPixelSize(),te=Math.pow(2,M.tileID.overscaledZ),ue=M.tileSize*Math.pow(2,I.transform.tileZoom)/te,fe=ue*(M.tileID.canonical.x+M.tileID.wrap*te),_e=ue*M.tileID.canonical.y;return{u_image:0,u_pattern_tl:z.tl,u_pattern_br:z.br,u_texsize:[G,$],u_pattern_size:z.displaySize,u_tile_units_to_pixels:1/or(M,1,I.transform.tileZoom),u_pixel_coord_upper:[fe>>16,_e>>16],u_pixel_coord_lower:[65535&fe,65535&_e]}}(T,_,k),{u_matrix:w,u_opacity:h}),rd={fillExtrusion:w=>({u_matrix:new y.UniformMatrix4f(w),u_lightpos:new y.Uniform3f(w),u_lightintensity:new y.Uniform1f(w),u_lightcolor:new y.Uniform3f(w),u_vertical_gradient:new y.Uniform1f(w),u_opacity:new y.Uniform1f(w),u_edge_radius:new y.Uniform1f(w),u_ao:new y.Uniform2f(w),u_tile_id:new y.Uniform3f(w),u_zoom_transition:new y.Uniform1f(w),u_inv_rot_matrix:new y.UniformMatrix4f(w),u_merc_center:new y.Uniform2f(w),u_up_dir:new y.Uniform3f(w),u_height_lift:new y.Uniform1f(w)}),fillExtrusionPattern:w=>({u_matrix:new y.UniformMatrix4f(w),u_lightpos:new y.Uniform3f(w),u_lightintensity:new y.Uniform1f(w),u_lightcolor:new y.Uniform3f(w),u_vertical_gradient:new y.Uniform1f(w),u_height_factor:new y.Uniform1f(w),u_edge_radius:new y.Uniform1f(w),u_ao:new y.Uniform2f(w),u_tile_id:new y.Uniform3f(w),u_zoom_transition:new y.Uniform1f(w),u_inv_rot_matrix:new y.UniformMatrix4f(w),u_merc_center:new y.Uniform2f(w),u_up_dir:new y.Uniform3f(w),u_height_lift:new y.Uniform1f(w),u_image:new y.Uniform1i(w),u_texsize:new y.Uniform2f(w),u_pixel_coord_upper:new y.Uniform2f(w),u_pixel_coord_lower:new y.Uniform2f(w),u_tile_units_to_pixels:new y.Uniform1f(w),u_opacity:new y.Uniform1f(w)}),fill:w=>({u_matrix:new y.UniformMatrix4f(w)}),fillPattern:w=>({u_matrix:new y.UniformMatrix4f(w),u_image:new y.Uniform1i(w),u_texsize:new y.Uniform2f(w),u_pixel_coord_upper:new y.Uniform2f(w),u_pixel_coord_lower:new y.Uniform2f(w),u_tile_units_to_pixels:new y.Uniform1f(w)}),fillOutline:w=>({u_matrix:new y.UniformMatrix4f(w),u_world:new y.Uniform2f(w)}),fillOutlinePattern:w=>({u_matrix:new y.UniformMatrix4f(w),u_world:new y.Uniform2f(w),u_image:new y.Uniform1i(w),u_texsize:new y.Uniform2f(w),u_pixel_coord_upper:new y.Uniform2f(w),u_pixel_coord_lower:new y.Uniform2f(w),u_tile_units_to_pixels:new y.Uniform1f(w)}),circle:w=>({u_camera_to_center_distance:new y.Uniform1f(w),u_extrude_scale:new y.UniformMatrix2f(w),u_device_pixel_ratio:new y.Uniform1f(w),u_matrix:new y.UniformMatrix4f(w),u_inv_rot_matrix:new y.UniformMatrix4f(w),u_merc_center:new y.Uniform2f(w),u_tile_id:new y.Uniform3f(w),u_zoom_transition:new y.Uniform1f(w),u_up_dir:new y.Uniform3f(w)}),collisionBox:w=>({u_matrix:new y.UniformMatrix4f(w),u_camera_to_center_distance:new y.Uniform1f(w),u_extrude_scale:new y.Uniform2f(w)}),collisionCircle:w=>({u_matrix:new y.UniformMatrix4f(w),u_inv_matrix:new y.UniformMatrix4f(w),u_camera_to_center_distance:new y.Uniform1f(w),u_viewport_size:new y.Uniform2f(w)}),debug:w=>({u_color:new y.UniformColor(w),u_matrix:new y.UniformMatrix4f(w),u_overlay:new y.Uniform1i(w),u_overlay_scale:new y.Uniform1f(w)}),clippingMask:w=>({u_matrix:new y.UniformMatrix4f(w)}),heatmap:w=>({u_extrude_scale:new y.Uniform1f(w),u_intensity:new y.Uniform1f(w),u_matrix:new y.UniformMatrix4f(w),u_inv_rot_matrix:new y.UniformMatrix4f(w),u_merc_center:new y.Uniform2f(w),u_tile_id:new y.Uniform3f(w),u_zoom_transition:new y.Uniform1f(w),u_up_dir:new y.Uniform3f(w)}),heatmapTexture:w=>({u_image:new y.Uniform1i(w),u_color_ramp:new y.Uniform1i(w),u_opacity:new y.Uniform1f(w)}),hillshade:w=>({u_matrix:new y.UniformMatrix4f(w),u_image:new y.Uniform1i(w),u_latrange:new y.Uniform2f(w),u_light:new y.Uniform2f(w),u_shadow:new y.UniformColor(w),u_highlight:new y.UniformColor(w),u_accent:new y.UniformColor(w)}),hillshadePrepare:w=>({u_matrix:new y.UniformMatrix4f(w),u_image:new y.Uniform1i(w),u_dimension:new y.Uniform2f(w),u_zoom:new y.Uniform1f(w),u_unpack:new y.Uniform4f(w)}),line:w=>({u_matrix:new y.UniformMatrix4f(w),u_pixels_to_tile_units:new y.UniformMatrix2f(w),u_device_pixel_ratio:new y.Uniform1f(w),u_units_to_pixels:new y.Uniform2f(w),u_dash_image:new y.Uniform1i(w),u_gradient_image:new y.Uniform1i(w),u_image_height:new y.Uniform1f(w),u_texsize:new y.Uniform2f(w),u_tile_units_to_pixels:new y.Uniform1f(w),u_alpha_discard_threshold:new y.Uniform1f(w),u_trim_offset:new y.Uniform2f(w)}),linePattern:w=>({u_matrix:new y.UniformMatrix4f(w),u_texsize:new y.Uniform2f(w),u_pixels_to_tile_units:new y.UniformMatrix2f(w),u_device_pixel_ratio:new y.Uniform1f(w),u_image:new y.Uniform1i(w),u_units_to_pixels:new y.Uniform2f(w),u_tile_units_to_pixels:new y.Uniform1f(w),u_alpha_discard_threshold:new y.Uniform1f(w)}),raster:w=>({u_matrix:new y.UniformMatrix4f(w),u_tl_parent:new y.Uniform2f(w),u_scale_parent:new y.Uniform1f(w),u_fade_t:new y.Uniform1f(w),u_opacity:new y.Uniform1f(w),u_image0:new y.Uniform1i(w),u_image1:new y.Uniform1i(w),u_brightness_low:new y.Uniform1f(w),u_brightness_high:new y.Uniform1f(w),u_saturation_factor:new y.Uniform1f(w),u_contrast_factor:new y.Uniform1f(w),u_spin_weights:new y.Uniform3f(w),u_perspective_transform:new y.Uniform2f(w)}),symbolIcon:w=>({u_is_size_zoom_constant:new y.Uniform1i(w),u_is_size_feature_constant:new y.Uniform1i(w),u_size_t:new y.Uniform1f(w),u_size:new y.Uniform1f(w),u_camera_to_center_distance:new y.Uniform1f(w),u_rotate_symbol:new y.Uniform1i(w),u_aspect_ratio:new y.Uniform1f(w),u_fade_change:new y.Uniform1f(w),u_matrix:new y.UniformMatrix4f(w),u_label_plane_matrix:new y.UniformMatrix4f(w),u_coord_matrix:new y.UniformMatrix4f(w),u_is_text:new y.Uniform1i(w),u_pitch_with_map:new y.Uniform1i(w),u_texsize:new y.Uniform2f(w),u_tile_id:new y.Uniform3f(w),u_zoom_transition:new y.Uniform1f(w),u_inv_rot_matrix:new y.UniformMatrix4f(w),u_merc_center:new y.Uniform2f(w),u_camera_forward:new y.Uniform3f(w),u_tile_matrix:new y.UniformMatrix4f(w),u_up_vector:new y.Uniform3f(w),u_ecef_origin:new y.Uniform3f(w),u_texture:new y.Uniform1i(w)}),symbolSDF:w=>({u_is_size_zoom_constant:new y.Uniform1i(w),u_is_size_feature_constant:new y.Uniform1i(w),u_size_t:new y.Uniform1f(w),u_size:new y.Uniform1f(w),u_camera_to_center_distance:new y.Uniform1f(w),u_rotate_symbol:new y.Uniform1i(w),u_aspect_ratio:new y.Uniform1f(w),u_fade_change:new y.Uniform1f(w),u_matrix:new y.UniformMatrix4f(w),u_label_plane_matrix:new y.UniformMatrix4f(w),u_coord_matrix:new y.UniformMatrix4f(w),u_is_text:new y.Uniform1i(w),u_pitch_with_map:new y.Uniform1i(w),u_texsize:new y.Uniform2f(w),u_texture:new y.Uniform1i(w),u_gamma_scale:new y.Uniform1f(w),u_device_pixel_ratio:new y.Uniform1f(w),u_tile_id:new y.Uniform3f(w),u_zoom_transition:new y.Uniform1f(w),u_inv_rot_matrix:new y.UniformMatrix4f(w),u_merc_center:new y.Uniform2f(w),u_camera_forward:new y.Uniform3f(w),u_tile_matrix:new y.UniformMatrix4f(w),u_up_vector:new y.Uniform3f(w),u_ecef_origin:new y.Uniform3f(w),u_is_halo:new y.Uniform1i(w)}),symbolTextAndIcon:w=>({u_is_size_zoom_constant:new y.Uniform1i(w),u_is_size_feature_constant:new y.Uniform1i(w),u_size_t:new y.Uniform1f(w),u_size:new y.Uniform1f(w),u_camera_to_center_distance:new y.Uniform1f(w),u_rotate_symbol:new y.Uniform1i(w),u_aspect_ratio:new y.Uniform1f(w),u_fade_change:new y.Uniform1f(w),u_matrix:new y.UniformMatrix4f(w),u_label_plane_matrix:new y.UniformMatrix4f(w),u_coord_matrix:new y.UniformMatrix4f(w),u_is_text:new y.Uniform1i(w),u_pitch_with_map:new y.Uniform1i(w),u_texsize:new y.Uniform2f(w),u_texsize_icon:new y.Uniform2f(w),u_texture:new y.Uniform1i(w),u_texture_icon:new y.Uniform1i(w),u_gamma_scale:new y.Uniform1f(w),u_device_pixel_ratio:new y.Uniform1f(w),u_is_halo:new y.Uniform1i(w)}),background:w=>({u_matrix:new y.UniformMatrix4f(w),u_opacity:new y.Uniform1f(w),u_color:new y.UniformColor(w)}),backgroundPattern:w=>({u_matrix:new y.UniformMatrix4f(w),u_opacity:new y.Uniform1f(w),u_image:new y.Uniform1i(w),u_pattern_tl:new y.Uniform2f(w),u_pattern_br:new y.Uniform2f(w),u_texsize:new y.Uniform2f(w),u_pattern_size:new y.Uniform2f(w),u_pixel_coord_upper:new y.Uniform2f(w),u_pixel_coord_lower:new y.Uniform2f(w),u_tile_units_to_pixels:new y.Uniform1f(w)}),terrainRaster:Ps,terrainDepth:Ps,skybox:w=>({u_matrix:new y.UniformMatrix4f(w),u_sun_direction:new y.Uniform3f(w),u_cubemap:new y.Uniform1i(w),u_opacity:new y.Uniform1f(w),u_temporal_offset:new y.Uniform1f(w)}),skyboxGradient:w=>({u_matrix:new y.UniformMatrix4f(w),u_color_ramp:new y.Uniform1i(w),u_center_direction:new y.Uniform3f(w),u_radius:new y.Uniform1f(w),u_opacity:new y.Uniform1f(w),u_temporal_offset:new y.Uniform1f(w)}),skyboxCapture:w=>({u_matrix_3f:new y.UniformMatrix3f(w),u_sun_direction:new y.Uniform3f(w),u_sun_intensity:new y.Uniform1f(w),u_color_tint_r:new y.Uniform4f(w),u_color_tint_m:new y.Uniform4f(w),u_luminance:new y.Uniform1f(w)}),globeRaster:w=>({u_proj_matrix:new y.UniformMatrix4f(w),u_globe_matrix:new y.UniformMatrix4f(w),u_normalize_matrix:new y.UniformMatrix4f(w),u_merc_matrix:new y.UniformMatrix4f(w),u_zoom_transition:new y.Uniform1f(w),u_merc_center:new y.Uniform2f(w),u_image0:new y.Uniform1i(w),u_grid_matrix:new y.UniformMatrix3f(w),u_skirt_height:new y.Uniform1f(w),u_frustum_tl:new y.Uniform3f(w),u_frustum_tr:new y.Uniform3f(w),u_frustum_br:new y.Uniform3f(w),u_frustum_bl:new y.Uniform3f(w),u_globe_pos:new y.Uniform3f(w),u_globe_radius:new y.Uniform1f(w),u_viewport:new y.Uniform2f(w)}),globeAtmosphere:w=>({u_frustum_tl:new y.Uniform3f(w),u_frustum_tr:new y.Uniform3f(w),u_frustum_br:new y.Uniform3f(w),u_frustum_bl:new y.Uniform3f(w),u_horizon:new y.Uniform1f(w),u_transition:new y.Uniform1f(w),u_fadeout_range:new y.Uniform1f(w),u_color:new y.Uniform4f(w),u_high_color:new y.Uniform4f(w),u_space_color:new y.Uniform4f(w),u_star_intensity:new y.Uniform1f(w),u_star_density:new y.Uniform1f(w),u_star_size:new y.Uniform1f(w),u_temporal_offset:new y.Uniform1f(w),u_horizon_angle:new y.Uniform1f(w),u_rotation_matrix:new y.UniformMatrix4f(w)})};let Jl;function od(w,h,_,T,k,P,I){const M=w.context,z=M.gl,G=w.transform,$=w.useProgram("collisionBox"),te=[];let ue=0,fe=0;for(let Fe=0;Fe<T.length;Fe++){const Ye=T[Fe],We=h.getTile(Ye),Xe=We.getBucket(_);if(!Xe)continue;const ut=Ki(Ye,Xe,G);let Et=ut;0===k[0]&&0===k[1]||(Et=w.translatePosMatrix(ut,We,k,P));const At=I?Xe.textCollisionBox:Xe.iconCollisionBox,on=Xe.collisionCircleArray;if(on.length>0){const wt=y.create(),qt=Et;y.mul(wt,Xe.placementInvProjMatrix,G.glCoordMatrix),y.mul(wt,wt,Xe.placementViewportMatrix),te.push({circleArray:on,circleOffset:fe,transform:qt,invTransform:wt,projection:Xe.getProjection()}),ue+=on.length/4,fe=ue}At&&(w.terrain&&w.terrain.setupElevationDraw(We,$),$.draw(M,z.LINES,y.DepthMode.disabled,y.StencilMode.disabled,w.colorModeForRenderPass(),y.CullFaceMode.disabled,su(Et,G,We,Xe.getProjection()),_.id,At.layoutVertexBuffer,At.indexBuffer,At.segments,null,G.zoom,null,[At.collisionVertexBuffer,At.collisionVertexBufferExt]))}if(!I||!te.length)return;const _e=w.useProgram("collisionCircle"),ye=new y.StructArrayLayout2f1f2i16;ye.resize(4*ue),ye._trim();let Te=0;for(const Fe of te)for(let Ye=0;Ye<Fe.circleArray.length/4;Ye++){const We=4*Ye,Xe=Fe.circleArray[We+0],ut=Fe.circleArray[We+1],Et=Fe.circleArray[We+2],At=Fe.circleArray[We+3];ye.emplace(Te++,Xe,ut,Et,At,0),ye.emplace(Te++,Xe,ut,Et,At,1),ye.emplace(Te++,Xe,ut,Et,At,2),ye.emplace(Te++,Xe,ut,Et,At,3)}(!Jl||Jl.length<2*ue)&&(Jl=function(Fe){const Ye=2*Fe,We=new y.StructArrayLayout3ui6;We.resize(Ye),We._trim();for(let Xe=0;Xe<Ye;Xe++){const ut=6*Xe;We.uint16[ut+0]=4*Xe+0,We.uint16[ut+1]=4*Xe+1,We.uint16[ut+2]=4*Xe+2,We.uint16[ut+3]=4*Xe+2,We.uint16[ut+4]=4*Xe+3,We.uint16[ut+5]=4*Xe+0}return We}(ue));const de=M.createIndexBuffer(Jl,!0),Oe=M.createVertexBuffer(ye,y.collisionCircleLayout.members,!0);for(const Fe of te){const Ye={u_matrix:Fe.transform,u_inv_matrix:Fe.invTransform,u_camera_to_center_distance:(Re=G).getCameraToCenterDistance(Fe.projection),u_viewport_size:[Re.width,Re.height]};_e.draw(M,z.TRIANGLES,y.DepthMode.disabled,y.StencilMode.disabled,w.colorModeForRenderPass(),y.CullFaceMode.disabled,Ye,_.id,Oe,de,y.SegmentVector.simpleSegment(0,2*Fe.circleOffset,Fe.circleArray.length,Fe.circleArray.length/2),null,G.zoom)}var Re;Oe.destroy(),de.destroy()}const sd=y.create();function Lp({width:w,height:h,anchor:_,textOffset:T,textScale:k},P){const{horizontalAlign:I,verticalAlign:M}=y.getAnchorAlignment(_),z=-(I-.5)*w,G=-(M-.5)*h,$=y.evaluateVariableOffset(_,T);return new y.pointGeometry((z/k+$[0])*P,(G/k+$[1])*P)}function Ql(w,h,_,T,k,P,I,M,z,G,$){const te=w.text.placedSymbolArray,ue=w.text.dynamicLayoutVertexArray,fe=w.icon.dynamicLayoutVertexArray,_e={},ye=w.getProjection(),Te=Ya(M,ye,P),de=P.elevation,Oe=ye.upVectorScale(M.canonical,P.center.lat,P.worldSize).metersToTile;ue.clear();for(let Re=0;Re<te.length;Re++){const Fe=te.get(Re),{tileAnchorX:Ye,tileAnchorY:We,numGlyphs:Xe}=Fe,Et=Fe.hidden||!Fe.crossTileID||w.allowVerticalPlacement&&!Fe.placedOrientation?null:T[Fe.crossTileID];if(Et){let At=0,on=0,wt=0;if(de){const $n=de?de.getAtTileOffset(M,Ye,We):0,[ki,Gn,On]=ye.upVector(M.canonical,Ye,We);At=$n*ki*Oe,on=$n*Gn*Oe,wt=$n*On*Oe}let[qt,Nt,sn,Tt]=vn(Fe.projectedAnchorX+At,Fe.projectedAnchorY+on,Fe.projectedAnchorZ+wt,_?Te:I);const yt=Hn(P.getCameraToCenterDistance(ye),Tt);let Pt=k.evaluateSizeForFeature(w.textSizeData,G,Fe)*yt/y.ONE_EM;_&&(Pt*=w.tilePixelRatio/z);const tn=Lp(Et,Pt);_?(({x:qt,y:Nt,z:sn}=ye.projectTilePoint(Ye+tn.x,We+tn.y,M.canonical)),[qt,Nt,sn]=vn(qt+At,Nt+on,sn+wt,I)):(h&&tn._rotate(-P.angle),qt+=tn.x,Nt+=tn.y,sn=0);const hn=w.allowVerticalPlacement&&Fe.placedOrientation===y.WritingMode.vertical?Math.PI/2:0;for(let $n=0;$n<Xe;$n++)y.addDynamicAttributes(ue,qt,Nt,sn,hn);$&&Fe.associatedIconIndex>=0&&(_e[Fe.associatedIconIndex]={x:qt,y:Nt,z:sn,angle:hn})}else xr(Xe,ue)}if($){fe.clear();const Re=w.icon.placedSymbolArray;for(let Fe=0;Fe<Re.length;Fe++){const Ye=Re.get(Fe),{numGlyphs:We}=Ye,Xe=_e[Fe];if(Ye.hidden||!Xe)xr(We,fe);else{const{x:ut,y:Et,z:At,angle:on}=Xe;for(let wt=0;wt<We;wt++)y.addDynamicAttributes(fe,ut,Et,At,on)}}w.icon.dynamicLayoutVertexBuffer.updateData(fe)}w.text.dynamicLayoutVertexBuffer.updateData(ue)}function bm(w,h,_){return _.iconsInText&&h?"symbolTextAndIcon":w?"symbolSDF":"symbolIcon"}function Cf(w,h,_,T,k,P,I,M,z,G,$,te){const ue=w.context,fe=ue.gl,_e=w.transform,ye="map"===M,Te="map"===z,de=ye&&"point"!==_.layout.get("symbol-placement"),Oe=ye&&!Te&&!de,Re=void 0!==_.layout.get("symbol-sort-key").constantOr(1);let Fe=!1;const Ye=w.depthModeForSublayer(0,y.DepthMode.ReadOnly),We=[y.mercatorXfromLng(_e.center.lng),y.mercatorYfromLat(_e.center.lat)],Xe=_.layout.get("text-variable-anchor"),ut="globe"===_e.projection.name,Et=[],At=[0,-1,0];let on=At;!ut&&!_e.mercatorFromTransition||ye||(on=function(wt){const qt=wt._camera.getWorldToCamera(wt.worldSize,1),Nt=y.multiply([],qt,wt.globeMatrix);y.invert(Nt,Nt);const sn=[0,0,0],Tt=[0,1,0,0];return y.transformMat4$1(Tt,Tt,Nt),sn[0]=Tt[0],sn[1]=Tt[1],sn[2]=Tt[2],y.normalize(sn,sn),sn}(_e));for(const wt of T){const qt=h.getTile(wt),Nt=qt.getBucket(_);if(!Nt||"mercator"===Nt.projection.name&&ut)continue;const sn=k?Nt.text:Nt.icon;if(!sn||Nt.fullyClipped||!sn.segments.get().length)continue;const Tt=sn.programConfigurations.get(_.id),yt=k||Nt.sdfIcons,Pt=k?Nt.textSizeData:Nt.iconSizeData,tn=Te||0!==_e.pitch,hn=y.evaluateSizeForZoom(Pt,_e.zoom);let $n,ki,Gn,On,Jn=[0,0],sr=null;if(k)ki=qt.glyphAtlasTexture,Gn=fe.LINEAR,$n=qt.glyphAtlasTexture.size,Nt.iconsInText&&(Jn=qt.imageAtlasTexture.size,sr=qt.imageAtlasTexture,On=tn||w.options.rotating||w.options.zooming||"composite"===Pt.kind||"camera"===Pt.kind?fe.LINEAR:fe.NEAREST);else{const Ba=1!==_.layout.get("icon-size").constantOr(0)||Nt.iconsNeedLinear;ki=qt.imageAtlasTexture,Gn=yt||w.options.rotating||w.options.zooming||Ba||tn?fe.LINEAR:fe.NEAREST,$n=qt.imageAtlasTexture.size}const hi="globe"===Nt.projection.name,Lr=hi?on:At,Hr=hi?y.globeToMercatorTransition(_e.zoom):0,Xr=Ya(wt,Nt.getProjection(),_e),Kr=_e.calculatePixelsToTileUnitsMatrix(qt),is=ns(Xr,qt.tileID.canonical,Te,ye,_e,Nt.getProjection(),Kr),sa=w.terrain&&Te&&de?y.invert(y.create(),is):sd,Dl=xo(Xr,qt.tileID.canonical,Te,ye,_e,Nt.getProjection(),Kr),mu=Xe&&Nt.hasTextData(),eo="none"!==_.layout.get("icon-text-fit")&&mu&&Nt.hasIconData();if(de){const Ba=_e.elevation,rl=Ba?Ba.getAtTileOffsetFunc(wt,_e.center.lat,_e.worldSize,Nt.getProjection()):null,to=Ka(Xr,qt.tileID.canonical,Te,ye,_e,Nt.getProjection(),Kr);Ms(Nt,Xr,w,k,to,Dl,Te,G,rl,wt)}const hr=de||k&&Xe||eo,gr=w.translatePosMatrix(Xr,qt,P,I),Lo=hr?sd:is,aa=w.translatePosMatrix(Dl,qt,P,I,!0),Fr=Nt.getProjection().createInversionMatrix(_e,wt.canonical),Fs=[];w.terrainRenderModeElevated()&&Te&&Fs.push("PITCH_WITH_MAP_TERRAIN"),hi&&Fs.push("PROJECTION_GLOBE_VIEW"),hr&&Fs.push("PROJECTED_POS_ON_VIEWPORT");const Ns=yt&&0!==_.paint.get(k?"text-halo-width":"icon-halo-width").constantOr(1);let gu;gu=yt?Nt.iconsInText?lu(Pt.kind,hn,Oe,Te,w,gr,Lo,aa,$n,Jn,wt,Hr,We,Fr,Lr,Nt.getProjection()):au(Pt.kind,hn,Oe,Te,w,gr,Lo,aa,k,$n,!0,wt,Hr,We,Fr,Lr,Nt.getProjection()):id(Pt.kind,hn,Oe,Te,w,gr,Lo,aa,k,$n,wt,Hr,We,Fr,Lr,Nt.getProjection());const Ih={program:w.useProgram(bm(yt,k,Nt),Tt,Fs),buffers:sn,uniformValues:gu,atlasTexture:ki,atlasTextureIcon:sr,atlasInterpolation:Gn,atlasInterpolationIcon:On,isSDF:yt,hasHalo:Ns,tile:qt,labelPlaneMatrixInv:sa};if(Re&&Nt.canOverlap){Fe=!0;const Ba=sn.segments.get();for(const rl of Ba)Et.push({segments:new y.SegmentVector([rl]),sortKey:rl.sortKey,state:Ih})}else Et.push({segments:sn.segments,sortKey:0,state:Ih})}Fe&&Et.sort((wt,qt)=>wt.sortKey-qt.sortKey);for(const wt of Et){const qt=wt.state;if(w.terrain&&w.terrain.setupElevationDraw(qt.tile,qt.program,{useDepthForOcclusion:!ut,labelPlaneMatrixInv:qt.labelPlaneMatrixInv}),ue.activeTexture.set(fe.TEXTURE0),qt.atlasTexture.bind(qt.atlasInterpolation,fe.CLAMP_TO_EDGE),qt.atlasTextureIcon&&(ue.activeTexture.set(fe.TEXTURE1),qt.atlasTextureIcon&&qt.atlasTextureIcon.bind(qt.atlasInterpolationIcon,fe.CLAMP_TO_EDGE)),qt.isSDF){const Nt=qt.uniformValues;qt.hasHalo&&(Nt.u_is_halo=1,Ef(qt.buffers,wt.segments,_,w,qt.program,Ye,$,te,Nt)),Nt.u_is_halo=0}Ef(qt.buffers,wt.segments,_,w,qt.program,Ye,$,te,qt.uniformValues)}}function Ef(w,h,_,T,k,P,I,M,z){const G=T.context,$=[w.dynamicLayoutVertexBuffer,w.opacityVertexBuffer,w.globeExtVertexBuffer];k.draw(G,G.gl.TRIANGLES,P,I,M,y.CullFaceMode.disabled,z,_.id,w.layoutVertexBuffer,w.indexBuffer,h,_.paint,T.transform.zoom,w.programConfigurations.get(_.id),$)}function Zd(w,h,_,T,k,P,I){const M=w.context.gl,z=_.paint.get("fill-pattern"),G=z&&z.constantOr(1);let $,te,ue,fe,_e;I?(te=G&&!_.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=M.LINES):(te=G?"fillPattern":"fill",$=M.TRIANGLES);for(const ye of T){const Te=h.getTile(ye);if(G&&!Te.patternsLoaded())continue;const de=Te.getBucket(_);if(!de)continue;w.prepareDrawTile();const Oe=de.programConfigurations.get(_.id),Re=w.useProgram(te,Oe);G&&(w.context.activeTexture.set(M.TEXTURE0),Te.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),Oe.updatePaintBuffers());const Fe=z.constantOr(null);if(Fe&&Te.imageAtlas){const We=Te.imageAtlas.patternPositions[Fe.toString()];We&&Oe.setConstantPatternPositions(We)}const Ye=w.translatePosMatrix(ye.projMatrix,Te,_.paint.get("fill-translate"),_.paint.get("fill-translate-anchor"));if(I){fe=de.indexBuffer2,_e=de.segments2;const We=w.terrain&&w.terrain.renderingToTexture?w.terrain.drapeBufferSize:[M.drawingBufferWidth,M.drawingBufferHeight];ue="fillOutlinePattern"===te&&G?Pp(Ye,w,Te,We):xi(Ye,We)}else fe=de.indexBuffer,_e=de.segments,ue=G?dn(Ye,w,Te):Wd(Ye);w.prepareDrawProgram(w.context,Re,ye.toUnwrapped()),Re.draw(w.context,$,k,w.stencilModeForClipping(ye),P,y.CullFaceMode.disabled,ue,_.id,de.layoutVertexBuffer,fe,_e,_.paint,w.transform.zoom,Oe)}}function Fp(w,h,_,T,k,P,I){const M=w.context,z=M.gl,G=w.transform,$=_.paint.get("fill-extrusion-pattern"),te=$.constantOr(1),ue=_.paint.get("fill-extrusion-opacity"),fe=[_.paint.get("fill-extrusion-ambient-occlusion-intensity"),_.paint.get("fill-extrusion-ambient-occlusion-radius")],_e=_.layout.get("fill-extrusion-edge-radius"),ye="globe"===G.projection.name?y.fillExtrusionHeightLift():0,Te="globe"===G.projection.name,de=Te?y.globeToMercatorTransition(G.zoom):0,Oe=[y.mercatorXfromLng(G.center.lng),y.mercatorYfromLat(G.center.lat)],Re=[];Te&&Re.push("PROJECTION_GLOBE_VIEW"),fe[0]>0&&Re.push("FAUX_AO");for(const Fe of T){const Ye=h.getTile(Fe),We=Ye.getBucket(_);if(!We||We.projection.name!==G.projection.name)continue;const Xe=We.programConfigurations.get(_.id),ut=w.useProgram(te?"fillExtrusionPattern":"fillExtrusion",Xe,Re);if(w.terrain){const sn=w.terrain;if(w.style.terrainSetForDrapingOnly())sn.setupElevationDraw(Ye,ut,{useMeterToDem:!0});else{if(!We.enableTerrain)continue;if(sn.setupElevationDraw(Ye,ut,{useMeterToDem:!0}),ay(M,h,Fe,We,_,sn),!We.centroidVertexBuffer){const Tt=ut.attributes.a_centroid_pos;void 0!==Tt&&z.vertexAttrib2f(Tt,0,0)}}}te&&(w.context.activeTexture.set(z.TEXTURE0),Ye.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),Xe.updatePaintBuffers());const Et=$.constantOr(null);if(Et&&Ye.imageAtlas){const sn=Ye.imageAtlas.patternPositions[Et.toString()];sn&&Xe.setConstantPatternPositions(sn)}const At=w.translatePosMatrix(Fe.projMatrix,Ye,_.paint.get("fill-extrusion-translate"),_.paint.get("fill-extrusion-translate-anchor")),on=G.projection.createInversionMatrix(G,Fe.canonical),wt=_.paint.get("fill-extrusion-vertical-gradient"),qt=te?Gu(At,w,wt,ue,fe,_e,Fe,Ye,ye,de,Oe,on):vh(At,w,wt,ue,fe,_e,Fe,ye,de,Oe,on);w.prepareDrawProgram(M,ut,Fe.toUnwrapped());const Nt=[];w.terrain&&Nt.push(We.centroidVertexBuffer),Te&&Nt.push(We.layoutVertexExtBuffer),ut.draw(M,M.gl.TRIANGLES,k,P,I,y.CullFaceMode.backCCW,qt,_.id,We.layoutVertexBuffer,We.indexBuffer,We.segments,_.paint,w.transform.zoom,Xe,Nt)}}function ay(w,h,_,T,k,P){const I=[de=>{let Oe=de.canonical.x-1,Re=de.wrap;return Oe<0&&(Oe=(1<<de.canonical.z)-1,Re--),new y.OverscaledTileID(de.overscaledZ,Re,de.canonical.z,Oe,de.canonical.y)},de=>{let Oe=de.canonical.x+1,Re=de.wrap;return Oe===1<<de.canonical.z&&(Oe=0,Re++),new y.OverscaledTileID(de.overscaledZ,Re,de.canonical.z,Oe,de.canonical.y)},de=>new y.OverscaledTileID(de.overscaledZ,de.wrap,de.canonical.z,de.canonical.x,(0===de.canonical.y?1<<de.canonical.z:de.canonical.y)-1),de=>new y.OverscaledTileID(de.overscaledZ,de.wrap,de.canonical.z,de.canonical.x,de.canonical.y===(1<<de.canonical.z)-1?0:de.canonical.y+1)],M=de=>{const Oe=h.getSource().minzoom,Re=Ye=>{const We=h.getTileByID(Ye);if(We&&We.hasData())return We.getBucket(k)},Fe=[0,-1,1];for(const Ye of Fe){if(de.overscaledZ+Ye<Oe)continue;const We=Re(de.calculateScaledKey(de.overscaledZ+Ye));if(We)return We}},z=[0,0,0],G=(de,Oe)=>(z[0]=Math.min(de.min.y,Oe.min.y),z[1]=Math.max(de.max.y,Oe.max.y),z[2]=y.EXTENT-Oe.min.x>de.max.x?Oe.min.x-y.EXTENT:de.max.x,z),$=(de,Oe)=>(z[0]=Math.min(de.min.x,Oe.min.x),z[1]=Math.max(de.max.x,Oe.max.x),z[2]=y.EXTENT-Oe.min.y>de.max.y?Oe.min.y-y.EXTENT:de.max.y,z),te=[(de,Oe)=>G(de,Oe),(de,Oe)=>G(Oe,de),(de,Oe)=>$(de,Oe),(de,Oe)=>$(Oe,de)],ue=new y.pointGeometry(0,0);let fe,_e,ye;const Te=(de,Oe,Re,Fe,Ye)=>{const We=[[Fe?Re:de,Fe?de:Re,0],[Fe?Re:Oe,Fe?Oe:Re,0]],Xe=Ye<0?y.EXTENT+Ye:Ye,ut=[Fe?Xe:(de+Oe)/2,Fe?(de+Oe)/2:Xe,0];return 0===Re&&Ye<0||0!==Re&&Ye>0?P.getForTilePoints(ye,[ut],!0,_e):We.push(ut),P.getForTilePoints(_,We,!0,fe),Math.max(We[0][2],We[1][2],ut[2])/P.exaggeration()};for(let de=0;de<4;de++){const Oe=(de<2?1:5)-de,Re=T.borders[de];if(0===Re.length)continue;const Fe=ye=I[de](_),Ye=M(Fe);if(!(Ye&&Ye instanceof y.FillExtrusionBucket&&Ye.enableTerrain)||T.borderDoneWithNeighborZ[de]===Ye.canonical.z&&Ye.borderDoneWithNeighborZ[Oe]===T.canonical.z||(_e=P.findDEMTileFor(Fe),!_e||!_e.dem))continue;if(!fe){const Et=P.findDEMTileFor(_);if(!Et||!Et.dem)return;fe=Et}const We=Ye.borders[Oe];let Xe=0;const ut=Ye.borderDoneWithNeighborZ[Oe]!==T.canonical.z;if(T.canonical.z===Ye.canonical.z){for(let Et=0;Et<Re.length;Et++){const At=T.featuresOnBorder[Re[Et]],on=At.borders[de];let wt;for(;Xe<We.length&&(wt=Ye.featuresOnBorder[We[Xe]],!(wt.borders[Oe][1]>on[0]+3));)ut&&Ye.encodeCentroid(void 0,wt,!1),Xe++;if(wt&&Xe<We.length){const qt=Xe;let Nt=0;for(;!(wt.borders[Oe][0]>on[1]-3)&&(Nt++,++Xe!==We.length);)wt=Ye.featuresOnBorder[We[Xe]];if(wt=Ye.featuresOnBorder[We[qt]],At.intersectsCount()>1||wt.intersectsCount()>1||1!==Nt){1!==Nt&&(Xe=qt),T.encodeCentroid(void 0,At,!1),ut&&Ye.encodeCentroid(void 0,wt,!1);continue}const sn=te[de](At,wt),Tt=de%2?y.EXTENT-1:0;ue.x=Te(sn[0],Math.min(y.EXTENT-1,sn[1]),Tt,de<2,sn[2]),ue.y=0,T.encodeCentroid(ue,At,!1),ut&&Ye.encodeCentroid(ue,wt,!1)}else T.encodeCentroid(void 0,At,!1)}T.borderDoneWithNeighborZ[de]=Ye.canonical.z,T.needsCentroidUpdate=!0,ut&&(Ye.borderDoneWithNeighborZ[Oe]=T.canonical.z,Ye.needsCentroidUpdate=!0)}else{for(const Et of Re)T.encodeCentroid(void 0,T.featuresOnBorder[Et],!1);if(ut){for(const Et of We)Ye.encodeCentroid(void 0,Ye.featuresOnBorder[Et],!1);Ye.borderDoneWithNeighborZ[Oe]=T.canonical.z,Ye.needsCentroidUpdate=!0}T.borderDoneWithNeighborZ[de]=Ye.canonical.z,T.needsCentroidUpdate=!0}}(T.needsCentroidUpdate||!T.centroidVertexBuffer&&0!==T.centroidVertexArray.length)&&T.uploadCentroid(w)}const bh=new y.Color(1,0,0,1),ra=new y.Color(0,1,0,1),wl=new y.Color(0,0,1,1),Or=new y.Color(1,0,1,1),ad=new y.Color(0,1,1,1);function qd(w,h,_){const T=w.context,k=w.transform,P=T.gl,I="globe"===k.projection.name,M=I?["PROJECTION_GLOBE_VIEW"]:null;let z=_.projMatrix;if(I&&y.globeToMercatorTransition(k.zoom)>0){const At=y.transitionTileAABBinECEF(_.canonical,k),on=y.globeDenormalizeECEF(At);z=y.multiply(new Float32Array(16),k.globeMatrix,on),y.multiply(z,k.projMatrix,z)}const G=w.useProgram("debug",null,M),$=h.getTileByID(_.key);w.terrain&&w.terrain.setupElevationDraw($,G);const te=y.DepthMode.disabled,ue=y.StencilMode.disabled,fe=w.colorModeForRenderPass();T.activeTexture.set(P.TEXTURE0),w.emptyTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),I?$._makeGlobeTileDebugBuffers(w.context,k):$._makeDebugTileBoundsBuffers(w.context,k.projection);const ye=$._tileDebugBuffer||w.debugBuffer,Te=$._tileDebugIndexBuffer||w.debugIndexBuffer,de=$._tileDebugSegments||w.debugSegments;G.draw(T,P.LINE_STRIP,te,ue,fe,y.CullFaceMode.disabled,ga(z,y.Color.red),"$debug",ye,Te,de,null,null,null,[$._globeTileDebugBorderBuffer]);const Oe=$.latestRawTileData,Re=Math.floor((Oe&&Oe.byteLength||0)/1024),Fe=h.getTile(_).tileSize,Ye=512/Math.min(Fe,512)*(_.overscaledZ/k.zoom)*.5;let We=_.canonical.toString();_.overscaledZ!==_.canonical.z&&(We+=` => ${_.overscaledZ}`),We+=` ${Re}kb`,function(At,on){At.initDebugOverlayCanvas();const wt=At.debugOverlayCanvas,qt=At.context.gl,Nt=At.debugOverlayCanvas.getContext("2d");Nt.clearRect(0,0,wt.width,wt.height),Nt.shadowColor="white",Nt.shadowBlur=2,Nt.lineWidth=1.5,Nt.strokeStyle="white",Nt.textBaseline="top",Nt.font="bold 36px Open Sans, sans-serif",Nt.fillText(on,5,5),Nt.strokeText(on,5,5),At.debugOverlayTexture.update(wt),At.debugOverlayTexture.bind(qt.LINEAR,qt.CLAMP_TO_EDGE)}(w,We);const Xe=$._tileDebugTextBuffer||w.debugBuffer,ut=$._tileDebugTextIndexBuffer||w.quadTriangleIndexBuffer,Et=$._tileDebugTextSegments||w.debugSegments;G.draw(T,P.TRIANGLES,te,ue,y.ColorMode.alphaBlended,y.CullFaceMode.disabled,ga(z,y.Color.transparent,Ye),"$debug",Xe,ut,Et,null,null,null,[$._globeTileDebugTextBuffer])}function Po(w,h,_,T){ld(w,0,h+_/2,w.transform.width,_,T)}function Wu(w,h,_,T){ld(w,h-_/2,0,_,w.transform.height,T)}function ld(w,h,_,T,k,P){const I=w.context,M=I.gl;M.enable(M.SCISSOR_TEST),M.scissor(h*y.exported.devicePixelRatio,_*y.exported.devicePixelRatio,T*y.exported.devicePixelRatio,k*y.exported.devicePixelRatio),I.clear({color:P}),M.disable(M.SCISSOR_TEST)}const cu=y.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:xl}=cu;function Ea(w,h,_,T){w.emplaceBack(h,_,T)}class Cl{constructor(h){this.vertexArray=new y.StructArrayLayout3f12,this.indices=new y.StructArrayLayout3ui6,Ea(this.vertexArray,-1,-1,1),Ea(this.vertexArray,1,-1,1),Ea(this.vertexArray,-1,1,1),Ea(this.vertexArray,1,1,1),Ea(this.vertexArray,-1,-1,-1),Ea(this.vertexArray,1,-1,-1),Ea(this.vertexArray,-1,1,-1),Ea(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=h.createVertexBuffer(this.vertexArray,xl),this.indexBuffer=h.createIndexBuffer(this.indices),this.segment=y.SegmentVector.simpleSegment(0,0,36,12)}}function ji(w,h,_,T,k,P){const I=w.gl,M=h.paint.get("sky-atmosphere-color"),z=h.paint.get("sky-atmosphere-halo-color"),G=h.paint.get("sky-atmosphere-sun-intensity"),$={u_matrix_3f:y.fromMat4(y.create$1(),T),u_sun_direction:k,u_sun_intensity:G,u_color_tint_r:[(_e=M).r,_e.g,_e.b,_e.a],u_color_tint_m:[(ye=z).r,ye.g,ye.b,ye.a],u_luminance:5e-5};var _e,ye;I.framebufferTexture2D(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_CUBE_MAP_POSITIVE_X+P,h.skyboxTexture,0),_.draw(w,I.TRIANGLES,y.DepthMode.disabled,y.StencilMode.disabled,y.ColorMode.unblended,y.CullFaceMode.frontCW,$,"skyboxCapture",h.skyboxGeometry.vertexBuffer,h.skyboxGeometry.indexBuffer,h.skyboxGeometry.segment)}const Xl=y.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Tf{constructor(h){const _=new y.StructArrayLayout5f20;_.emplaceBack(-1,1,1,0,0),_.emplaceBack(1,1,1,1,0),_.emplaceBack(1,-1,1,1,1),_.emplaceBack(-1,-1,1,0,1);const T=new y.StructArrayLayout3ui6;T.emplaceBack(0,1,2),T.emplaceBack(2,3,0),this.vertexBuffer=h.createVertexBuffer(_,Xl.members),this.indexBuffer=h.createIndexBuffer(T),this.segments=y.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const tl={symbol:function(w,h,_,T,k){if("translucent"!==w.renderPass)return;const P=y.StencilMode.disabled,I=w.colorModeForRenderPass();_.layout.get("text-variable-anchor")&&function(M,z,G,$,te,ue,fe){const _e=z.transform,ye="map"===te,Te="map"===ue;for(const de of M){const Oe=$.getTile(de),Re=Oe.getBucket(G);if(!Re||!Re.text||!Re.text.segments.get().length)continue;const Fe=y.evaluateSizeForZoom(Re.textSizeData,_e.zoom),Ye=Ya(de,Re.getProjection(),_e),We=_e.calculatePixelsToTileUnitsMatrix(Oe),Xe=ns(Ye,Oe.tileID.canonical,Te,ye,_e,Re.getProjection(),We),ut="none"!==G.layout.get("icon-text-fit")&&Re.hasIconData();if(Fe){const Et=Math.pow(2,_e.zoom-Oe.tileID.overscaledZ);Ql(Re,ye,Te,fe,y.symbolSize,_e,Xe,de,Et,Fe,ut)}}}(T,w,_,h,_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),k),0!==_.paint.get("icon-opacity").constantOr(1)&&Cf(w,h,_,T,!1,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),_.layout.get("icon-rotation-alignment"),_.layout.get("icon-pitch-alignment"),_.layout.get("icon-keep-upright"),P,I),0!==_.paint.get("text-opacity").constantOr(1)&&Cf(w,h,_,T,!0,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),_.layout.get("text-keep-upright"),P,I),h.map.showCollisionBoxes&&(od(w,h,_,T,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),!0),od(w,h,_,T,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),!1))},circle:function(w,h,_,T){if("translucent"!==w.renderPass)return;const k=_.paint.get("circle-opacity"),P=_.paint.get("circle-stroke-width"),I=_.paint.get("circle-stroke-opacity"),M=void 0!==_.layout.get("circle-sort-key").constantOr(1);if(0===k.constantOr(1)&&(0===P.constantOr(1)||0===I.constantOr(1)))return;const z=w.context,G=z.gl,$=w.transform,te=w.depthModeForSublayer(0,y.DepthMode.ReadOnly),ue=y.StencilMode.disabled,fe=w.colorModeForRenderPass(),_e="globe"===$.projection.name,ye=[y.mercatorXfromLng($.center.lng),y.mercatorYfromLat($.center.lat)],Te=[];for(let Oe=0;Oe<T.length;Oe++){const Re=T[Oe],Fe=h.getTile(Re),Ye=Fe.getBucket(_);if(!Ye||Ye.projection.name!==$.projection.name)continue;const We=Ye.programConfigurations.get(_.id),Xe=ou(_);_e&&Xe.push("PROJECTION_GLOBE_VIEW");const ut=w.useProgram("circle",We,Xe),Et=Ye.layoutVertexBuffer,At=Ye.globeExtVertexBuffer,on=Ye.indexBuffer,wt=$.projection.createInversionMatrix($,Re.canonical),qt={programConfiguration:We,program:ut,layoutVertexBuffer:Et,globeExtVertexBuffer:At,indexBuffer:on,uniformValues:Go(w,Re,Fe,wt,ye,_),tile:Fe};if(M){const Nt=Ye.segments.get();for(const sn of Nt)Te.push({segments:new y.SegmentVector([sn]),sortKey:sn.sortKey,state:qt})}else Te.push({segments:Ye.segments,sortKey:0,state:qt})}M&&Te.sort((Oe,Re)=>Oe.sortKey-Re.sortKey);const de={useDepthForOcclusion:!_e};for(const Oe of Te){const{programConfiguration:Re,program:Fe,layoutVertexBuffer:Ye,globeExtVertexBuffer:We,indexBuffer:Xe,uniformValues:ut,tile:Et}=Oe.state,At=Oe.segments;w.terrain&&w.terrain.setupElevationDraw(Et,Fe,de),w.prepareDrawProgram(z,Fe,Et.tileID.toUnwrapped()),Fe.draw(z,G.TRIANGLES,te,ue,fe,y.CullFaceMode.disabled,ut,_.id,Ye,Xe,At,_.paint,$.zoom,Re,[We])}},heatmap:function(w,h,_,T){if(0!==_.paint.get("heatmap-opacity"))if("offscreen"===w.renderPass){const k=w.context,P=k.gl,I=y.StencilMode.disabled,M=new y.ColorMode([P.ONE,P.ONE],y.Color.transparent,[!0,!0,!0,!0]);(function(fe,_e,ye,Te){const de=fe.gl,Oe=_e.width*Te,Re=_e.height*Te;fe.activeTexture.set(de.TEXTURE1),fe.viewport.set([0,0,Oe,Re]);let Fe=ye.heatmapFbo;if(!Fe||Fe&&(Fe.width!==Oe||Fe.height!==Re)){Fe&&Fe.destroy();const Ye=de.createTexture();de.bindTexture(de.TEXTURE_2D,Ye),de.texParameteri(de.TEXTURE_2D,de.TEXTURE_WRAP_S,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_2D,de.TEXTURE_WRAP_T,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_2D,de.TEXTURE_MIN_FILTER,de.LINEAR),de.texParameteri(de.TEXTURE_2D,de.TEXTURE_MAG_FILTER,de.LINEAR),Fe=ye.heatmapFbo=fe.createFramebuffer(Oe,Re,!1),function(We,Xe,ut,Et,At,on){const wt=We.gl;wt.texImage2D(wt.TEXTURE_2D,0,We.isWebGL2&&We.extRenderToTextureHalfFloat?wt.RGBA16F:wt.RGBA,At,on,0,wt.RGBA,We.extRenderToTextureHalfFloat?We.isWebGL2?wt.HALF_FLOAT:We.extTextureHalfFloat.HALF_FLOAT_OES:wt.UNSIGNED_BYTE,null),Et.colorAttachment.set(ut)}(fe,0,Ye,Fe,Oe,Re)}else de.bindTexture(de.TEXTURE_2D,Fe.colorAttachment.get()),fe.bindFramebuffer.set(Fe.framebuffer)})(k,w,_,"globe"===w.transform.projection.name?.5:.25),k.clear({color:y.Color.transparent});const z=w.transform,G="globe"===z.projection.name,$=G?["PROJECTION_GLOBE_VIEW"]:null,te=G?y.CullFaceMode.frontCCW:y.CullFaceMode.disabled,ue=[y.mercatorXfromLng(z.center.lng),y.mercatorYfromLat(z.center.lat)];for(let fe=0;fe<T.length;fe++){const _e=T[fe];if(h.hasRenderableParent(_e))continue;const ye=h.getTile(_e),Te=ye.getBucket(_);if(!Te||Te.projection.name!==z.projection.name)continue;const de=Te.programConfigurations.get(_.id),Oe=w.useProgram("heatmap",de,$),{zoom:Re}=w.transform;w.terrain&&w.terrain.setupElevationDraw(ye,Oe),w.prepareDrawProgram(k,Oe,_e.toUnwrapped());const Fe=z.projection.createInversionMatrix(z,_e.canonical);Oe.draw(k,P.TRIANGLES,y.DepthMode.disabled,I,M,te,el(w,_e,ye,Fe,ue,Re,_.paint.get("heatmap-intensity")),_.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,_.paint,w.transform.zoom,de,G?[Te.globeExtVertexBuffer]:null)}k.viewport.set([0,0,w.width,w.height])}else"translucent"===w.renderPass&&(w.context.setColorMode(w.colorModeForRenderPass()),function(k,P){const I=k.context,M=I.gl,z=P.heatmapFbo;if(!z)return;I.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,z.colorAttachment.get()),I.activeTexture.set(M.TEXTURE1);let G=P.colorRampTexture;G||(G=P.colorRampTexture=new y.Texture(I,P.colorRamp,M.RGBA)),G.bind(M.LINEAR,M.CLAMP_TO_EDGE),k.useProgram("heatmapTexture").draw(I,M.TRIANGLES,y.DepthMode.disabled,y.StencilMode.disabled,k.colorModeForRenderPass(),y.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:P.paint.get("heatmap-opacity")},P.id,k.viewportBuffer,k.quadTriangleIndexBuffer,k.viewportSegments,P.paint,k.transform.zoom)}(w,_))},line:function(w,h,_,T){if("translucent"!==w.renderPass)return;const k=_.paint.get("line-opacity"),P=_.paint.get("line-width");if(0===k.constantOr(1)||0===P.constantOr(1))return;const I=w.depthModeForSublayer(0,y.DepthMode.ReadOnly),M=w.colorModeForRenderPass(),z=w.terrain&&w.terrain.renderingToTexture?1:y.exported.devicePixelRatio,G=_.paint.get("line-dasharray"),$=G.constantOr(1),te=_.layout.get("line-cap"),ue=_.paint.get("line-pattern"),fe=ue.constantOr(1),_e=_.paint.get("line-gradient"),ye=fe?"linePattern":"line",Te=w.context,de=Te.gl,Oe=(Fe=>{const Ye=[];Ws(Fe)&&Ye.push("RENDER_LINE_DASH"),Fe.paint.get("line-gradient")&&Ye.push("RENDER_LINE_GRADIENT");const We=Fe.paint.get("line-trim-offset");0===We[0]&&0===We[1]||Ye.push("RENDER_LINE_TRIM_OFFSET");const Xe=Fe.paint.get("line-pattern").constantOr(1),ut=1!==Fe.paint.get("line-opacity").constantOr(1);return!Xe&&ut&&Ye.push("RENDER_LINE_ALPHA_DISCARD"),Ye})(_);let Re=Oe.includes("RENDER_LINE_ALPHA_DISCARD");w.terrain&&w.terrain.clipOrMaskOverlapStencilType()&&(Re=!1);for(const Fe of T){const Ye=h.getTile(Fe);if(fe&&!Ye.patternsLoaded())continue;const We=Ye.getBucket(_);if(!We)continue;w.prepareDrawTile();const Xe=We.programConfigurations.get(_.id),ut=w.useProgram(ye,Xe,Oe),Et=ue.constantOr(null);if(Et&&Ye.imageAtlas){const yt=Ye.imageAtlas.patternPositions[Et.toString()];yt&&Xe.setConstantPatternPositions(yt)}const At=G.constantOr(null),on=te.constantOr(null);if(!fe&&At&&on&&Ye.lineAtlas){const yt=Ye.lineAtlas.getDash(At,on);yt&&Xe.setConstantPatternPositions(yt)}let[wt,qt]=_.paint.get("line-trim-offset");("round"===on||"square"===on)&&wt!==qt&&(0===wt&&(wt-=1),1===qt&&(qt+=1));const Nt=w.terrain?Fe.projMatrix:null,sn=fe?vm(w,Ye,_,Nt,z):$u(w,Ye,_,Nt,We.lineClipsArray.length,z,[wt,qt]);if(_e){const yt=We.gradients[_.id];let Pt=yt.texture;if(_.gradientVersion!==yt.version){let tn=256;if(_.stepInterpolant){const hn=h.getSource().maxzoom,$n=Fe.canonical.z===hn?Math.ceil(1<<w.transform.maxZoom-Fe.canonical.z):1;tn=y.clamp(y.nextPowerOfTwo(We.maxLineLength/y.EXTENT*1024*$n),256,Te.maxTextureSize)}yt.gradient=y.renderColorRamp({expression:_.gradientExpression(),evaluationKey:"lineProgress",resolution:tn,image:yt.gradient||void 0,clips:We.lineClipsArray}),yt.texture?yt.texture.update(yt.gradient):yt.texture=new y.Texture(Te,yt.gradient,de.RGBA),yt.version=_.gradientVersion,Pt=yt.texture}Te.activeTexture.set(de.TEXTURE1),Pt.bind(_.stepInterpolant?de.NEAREST:de.LINEAR,de.CLAMP_TO_EDGE)}$&&(Te.activeTexture.set(de.TEXTURE0),Ye.lineAtlasTexture.bind(de.LINEAR,de.REPEAT),Xe.updatePaintBuffers()),fe&&(Te.activeTexture.set(de.TEXTURE0),Ye.imageAtlasTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE),Xe.updatePaintBuffers()),w.prepareDrawProgram(Te,ut,Fe.toUnwrapped());const Tt=yt=>{ut.draw(Te,de.TRIANGLES,I,yt,M,y.CullFaceMode.disabled,sn,_.id,We.layoutVertexBuffer,We.indexBuffer,We.segments,_.paint,w.transform.zoom,Xe,[We.layoutVertexBuffer2])};if(Re){const yt=w.stencilModeForClipping(Fe).ref;0===yt&&w.terrain&&Te.clear({stencil:0});const Pt={func:de.EQUAL,mask:255};sn.u_alpha_discard_threshold=.8,Tt(new y.StencilMode(Pt,yt,255,de.KEEP,de.KEEP,de.INVERT)),sn.u_alpha_discard_threshold=0,Tt(new y.StencilMode(Pt,yt,255,de.KEEP,de.KEEP,de.KEEP))}else Tt(w.stencilModeForClipping(Fe))}Re&&(w.resetStencilClippingMasks(),w.terrain&&Te.clear({stencil:0}))},fill:function(w,h,_,T){const k=_.paint.get("fill-color"),P=_.paint.get("fill-opacity");if(0===P.constantOr(1))return;const I=w.colorModeForRenderPass(),M=_.paint.get("fill-pattern"),z=w.opaquePassEnabledForLayer()&&!M.constantOr(1)&&1===k.constantOr(y.Color.transparent).a&&1===P.constantOr(0)?"opaque":"translucent";if(w.renderPass===z){const G=w.depthModeForSublayer(1,"opaque"===w.renderPass?y.DepthMode.ReadWrite:y.DepthMode.ReadOnly);Zd(w,h,_,T,G,I,!1)}if("translucent"===w.renderPass&&_.paint.get("fill-antialias")){const G=w.depthModeForSublayer(_.getPaintProperty("fill-outline-color")?2:0,y.DepthMode.ReadOnly);Zd(w,h,_,T,G,I,!0)}},"fill-extrusion":function(w,h,_,T){const k=_.paint.get("fill-extrusion-opacity");if(0!==k&&"translucent"===w.renderPass){const P=new y.DepthMode(w.context.gl.LEQUAL,y.DepthMode.ReadWrite,w.depthRangeFor3D);if(1!==k||_.paint.get("fill-extrusion-pattern").constantOr(1))Fp(w,h,_,T,P,y.StencilMode.disabled,y.ColorMode.disabled),Fp(w,h,_,T,P,w.stencilModeFor3D(),w.colorModeForRenderPass()),w.resetStencilClippingMasks();else{const I=w.colorModeForRenderPass();Fp(w,h,_,T,P,y.StencilMode.disabled,I)}}},hillshade:function(w,h,_,T){if("offscreen"!==w.renderPass&&"translucent"!==w.renderPass)return;const k=w.context,P=w.depthModeForSublayer(0,y.DepthMode.ReadOnly),I=w.colorModeForRenderPass(),M=w.terrain&&w.terrain.renderingToTexture,[z,G]="translucent"!==w.renderPass||M?[{},T]:w.stencilConfigForOverlap(T);for(const $ of G){const te=h.getTile($);if(te.needsHillshadePrepare&&"offscreen"===w.renderPass)Pa(w,te,_,P,y.StencilMode.disabled,I);else if("translucent"===w.renderPass){const ue=M&&w.terrain?w.terrain.stencilModeForRTTOverlap($):z[$.overscaledZ];_o(w,$,te,_,P,ue,I)}}k.viewport.set([0,0,w.width,w.height]),w.resetStencilClippingMasks()},raster:function(w,h,_,T,k,P){if("translucent"!==w.renderPass||0===_.paint.get("raster-opacity")||!T.length)return;const I=w.context,M=I.gl,z=h.getSource(),G=w.useProgram("raster"),$=w.colorModeForRenderPass(),te=w.terrain&&w.terrain.renderingToTexture,[ue,fe]=z instanceof Ve||te?[{},T]:w.stencilConfigForOverlap(T),_e=fe[fe.length-1].overscaledZ,ye=!w.options.moving;for(const Te of fe){const de=te?y.DepthMode.disabled:w.depthModeForSublayer(Te.overscaledZ-_e,1===_.paint.get("raster-opacity")?y.DepthMode.ReadWrite:y.DepthMode.ReadOnly,M.LESS),Oe=Te.toUnwrapped(),Re=h.getTile(Te);if(te&&(!Re||!Re.hasData()))continue;const Fe=te?Te.projMatrix:w.transform.calculateProjMatrix(Oe,ye),Ye=w.terrain&&te?w.terrain.stencilModeForRTTOverlap(Te):ue[Te.overscaledZ],We=P?0:_.paint.get("raster-fade-duration");Re.registerFadeDuration(We);const Xe=h.findLoadedParent(Te,0),ut=Hu(Re,Xe,h,w.transform,We);let Et,At;w.terrain&&w.terrain.prepareDrawTile();const on="nearest"===_.paint.get("raster-resampling")?M.NEAREST:M.LINEAR;I.activeTexture.set(M.TEXTURE0),Re.texture.bind(on,M.CLAMP_TO_EDGE),I.activeTexture.set(M.TEXTURE1),Xe?(Xe.texture.bind(on,M.CLAMP_TO_EDGE),Et=Math.pow(2,Xe.tileID.overscaledZ-Re.tileID.overscaledZ),At=[Re.tileID.canonical.x*Et%1,Re.tileID.canonical.y*Et%1]):Re.texture.bind(on,M.CLAMP_TO_EDGE),Re.texture.useMipmap&&I.extTextureFilterAnisotropic&&w.transform.pitch>20&&M.texParameterf(M.TEXTURE_2D,I.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,I.extTextureFilterAnisotropicMax);const wt=nd(Fe,At||[0,0],Et||1,ut,_,z instanceof Ve?z.perspectiveTransform:[0,0]);if(w.prepareDrawProgram(I,G,Oe),z instanceof Ve)z.boundsBuffer&&z.boundsSegments&&G.draw(I,M.TRIANGLES,de,y.StencilMode.disabled,$,y.CullFaceMode.disabled,wt,_.id,z.boundsBuffer,w.quadTriangleIndexBuffer,z.boundsSegments);else{const{tileBoundsBuffer:qt,tileBoundsIndexBuffer:Nt,tileBoundsSegments:sn}=w.getTileBoundsBuffers(Re);G.draw(I,M.TRIANGLES,de,Ye,$,y.CullFaceMode.disabled,wt,_.id,qt,Nt,sn)}}w.resetStencilClippingMasks()},background:function(w,h,_,T){const k=_.paint.get("background-color"),P=_.paint.get("background-opacity");if(0===P)return;const I=w.context,M=I.gl,z=w.transform,G=z.tileSize,$=_.paint.get("background-pattern");if(w.isPatternMissing($))return;const te=!$&&1===k.a&&1===P&&w.opaquePassEnabledForLayer()?"opaque":"translucent";if(w.renderPass!==te)return;const ue=y.StencilMode.disabled,fe=w.depthModeForSublayer(0,"opaque"===te?y.DepthMode.ReadWrite:y.DepthMode.ReadOnly),_e=w.colorModeForRenderPass(),ye=w.useProgram($?"backgroundPattern":"background");let Te,de=T;de||(Te=w.getBackgroundTiles(),de=Object.values(Te).map(Oe=>Oe.tileID)),$&&(I.activeTexture.set(M.TEXTURE0),w.imageManager.bind(w.context));for(const Oe of de){const Re=Oe.toUnwrapped(),Fe=T?Oe.projMatrix:w.transform.calculateProjMatrix(Re);w.prepareDrawTile();const Ye=h?h.getTile(Oe):Te?Te[Oe.key]:new y.Tile(Oe,G,z.zoom,w),We=$?Yl(Fe,P,w,$,{tileID:Oe,tileSize:G}):xf(Fe,P,k);w.prepareDrawProgram(I,ye,Re);const{tileBoundsBuffer:Xe,tileBoundsIndexBuffer:ut,tileBoundsSegments:Et}=w.getTileBoundsBuffers(Ye);ye.draw(I,M.TRIANGLES,fe,ue,_e,y.CullFaceMode.disabled,We,_.id,Xe,ut,Et)}},sky:function(w,h,_){const T=w.transform,k="mercator"===T.projection.name||"globe"===T.projection.name?1:y.smoothstep(7,8,T.zoom),P=_.paint.get("sky-opacity")*k;if(0===P)return;const I=w.context,M=_.paint.get("sky-type"),z=new y.DepthMode(I.gl.LEQUAL,y.DepthMode.ReadOnly,[0,1]),G=w.frameCounter/1e3%1;"atmosphere"===M?"offscreen"===w.renderPass?_.needsSkyboxCapture(w)&&(function($,te,ue,fe){const _e=$.context,ye=_e.gl;let Te=te.skyboxFbo;if(!Te){Te=te.skyboxFbo=_e.createFramebuffer(32,32,!1),te.skyboxGeometry=new Cl(_e),te.skyboxTexture=_e.gl.createTexture(),ye.bindTexture(ye.TEXTURE_CUBE_MAP,te.skyboxTexture),ye.texParameteri(ye.TEXTURE_CUBE_MAP,ye.TEXTURE_WRAP_S,ye.CLAMP_TO_EDGE),ye.texParameteri(ye.TEXTURE_CUBE_MAP,ye.TEXTURE_WRAP_T,ye.CLAMP_TO_EDGE),ye.texParameteri(ye.TEXTURE_CUBE_MAP,ye.TEXTURE_MIN_FILTER,ye.LINEAR),ye.texParameteri(ye.TEXTURE_CUBE_MAP,ye.TEXTURE_MAG_FILTER,ye.LINEAR);for(let Fe=0;Fe<6;++Fe)ye.texImage2D(ye.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,0,ye.RGBA,32,32,0,ye.RGBA,ye.UNSIGNED_BYTE,null)}_e.bindFramebuffer.set(Te.framebuffer),_e.viewport.set([0,0,32,32]);const de=te.getCenter($,!0),Oe=$.useProgram("skyboxCapture"),Re=new Float64Array(16);y.identity(Re),y.rotateY(Re,Re,.5*-Math.PI),ji(_e,te,Oe,Re,de,0),y.identity(Re),y.rotateY(Re,Re,.5*Math.PI),ji(_e,te,Oe,Re,de,1),y.identity(Re),y.rotateX(Re,Re,.5*-Math.PI),ji(_e,te,Oe,Re,de,2),y.identity(Re),y.rotateX(Re,Re,.5*Math.PI),ji(_e,te,Oe,Re,de,3),y.identity(Re),ji(_e,te,Oe,Re,de,4),y.identity(Re),y.rotateY(Re,Re,Math.PI),ji(_e,te,Oe,Re,de,5),_e.viewport.set([0,0,$.width,$.height])}(w,_),_.markSkyboxValid(w)):"sky"===w.renderPass&&function($,te,ue,fe,_e){const ye=$.context,Te=ye.gl,de=$.transform,Oe=$.useProgram("skybox");ye.activeTexture.set(Te.TEXTURE0),Te.bindTexture(Te.TEXTURE_CUBE_MAP,te.skyboxTexture);const Re={u_matrix:de.skyboxMatrix,u_sun_direction:te.getCenter($,!1),u_cubemap:0,u_opacity:fe,u_temporal_offset:_e};$.prepareDrawProgram(ye,Oe),Oe.draw(ye,Te.TRIANGLES,ue,y.StencilMode.disabled,$.colorModeForRenderPass(),y.CullFaceMode.backCW,Re,"skybox",te.skyboxGeometry.vertexBuffer,te.skyboxGeometry.indexBuffer,te.skyboxGeometry.segment)}(w,_,z,P,G):"gradient"===M&&"sky"===w.renderPass&&function($,te,ue,fe,_e){const ye=$.context,Te=ye.gl,de=$.transform,Oe=$.useProgram("skyboxGradient");te.skyboxGeometry||(te.skyboxGeometry=new Cl(ye)),ye.activeTexture.set(Te.TEXTURE0);let Re=te.colorRampTexture;Re||(Re=te.colorRampTexture=new y.Texture(ye,te.colorRamp,Te.RGBA)),Re.bind(Te.LINEAR,Te.CLAMP_TO_EDGE);const Fe=(Ye=de.skyboxMatrix,We=te.getCenter($,!1),Xe=te.paint.get("sky-gradient-radius"),ut=fe,Et=_e,{u_matrix:Ye,u_color_ramp:0,u_center_direction:We,u_radius:y.degToRad(Xe),u_opacity:ut,u_temporal_offset:Et});var Ye,We,Xe,ut,Et;$.prepareDrawProgram(ye,Oe),Oe.draw(ye,Te.TRIANGLES,ue,y.StencilMode.disabled,$.colorModeForRenderPass(),y.CullFaceMode.backCW,Fe,"skyboxGradient",te.skyboxGeometry.vertexBuffer,te.skyboxGeometry.indexBuffer,te.skyboxGeometry.segment)}(w,_,z,P,G)},debug:function(w,h,_){for(let T=0;T<_.length;T++)qd(w,h,_[T])},custom:function(w,h,_,T){const k=w.context,P=_.implementation;if(!w.transform.projection.unsupportedLayers||!w.transform.projection.unsupportedLayers.includes("custom")||w.terrain&&(w.terrain.renderingToTexture||"offscreen"===w.renderPass)&&_.isLayerDraped()){if("offscreen"===w.renderPass){const I=P.prerender;if(I){if(w.setCustomLayerDefaults(),k.setColorMode(w.colorModeForRenderPass()),"globe"===w.transform.projection.name){const M=w.transform.pointMerc;I.call(P,k.gl,w.transform.customLayerMatrix(),w.transform.getProjection(),w.transform.globeToMercatorMatrix(),y.globeToMercatorTransition(w.transform.zoom),[M.x,M.y],w.transform.pixelsPerMeterRatio)}else I.call(P,k.gl,w.transform.customLayerMatrix());k.setDirty(),w.setBaseState()}}else if("translucent"===w.renderPass){if(w.terrain&&w.terrain.renderingToTexture){const M=P.renderToTile;if(M){const z=T[0].canonical,G=new y.MercatorCoordinate(z.x+T[0].wrap*(1<<z.z),z.y,z.z);k.setDepthMode(y.DepthMode.disabled),k.setStencilMode(y.StencilMode.disabled),k.setColorMode(w.colorModeForRenderPass()),w.setCustomLayerDefaults(),M.call(P,k.gl,G),k.setDirty(),w.setBaseState()}return}w.setCustomLayerDefaults(),k.setColorMode(w.colorModeForRenderPass()),k.setStencilMode(y.StencilMode.disabled);const I="3d"===P.renderingMode?new y.DepthMode(w.context.gl.LEQUAL,y.DepthMode.ReadWrite,w.depthRangeFor3D):w.depthModeForSublayer(0,y.DepthMode.ReadOnly);if(k.setDepthMode(I),"globe"===w.transform.projection.name){const M=w.transform.pointMerc;P.render(k.gl,w.transform.customLayerMatrix(),w.transform.getProjection(),w.transform.globeToMercatorMatrix(),y.globeToMercatorTransition(w.transform.zoom),[M.x,M.y],w.transform.pixelsPerMeterRatio)}else P.render(k.gl,w.transform.customLayerMatrix());k.setDirty(),w.setBaseState(),k.bindFramebuffer.set(null)}}else y.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class kc{constructor(h,_,T=!1){this.context=new re(h,T),this.transform=_,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=y.SourceCache.maxUnderzooming+y.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Qa,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(h,_){const T=!!h&&!!h.terrain&&this.transform.projection.supportsTerrain;if(!(T||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new td(this,h));const k=this._terrain;this.transform.elevation=T?k:null,k.update(h,this.transform,_)}_updateFog(h){const _=h.fog;if(!_||"globe"===this.transform.projection.name||_.getOpacity(this.transform.pitch)<1||_.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[T,k]=_.getFovAdjustedRange(this.transform._fov);if(T>k)return void(this.transform.fogCullDistSq=null);const P=T+.78*(k-T);this.transform.fogCullDistSq=P*P}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(h,_){if(this.width=h*y.exported.devicePixelRatio,this.height=_*y.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const T of this.style.order)this.style._layers[T].resize()}setup(){const h=this.context,_=new y.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(y.EXTENT,0),_.emplaceBack(0,y.EXTENT),_.emplaceBack(y.EXTENT,y.EXTENT),this.tileExtentBuffer=h.createVertexBuffer(_,y.posAttributes.members),this.tileExtentSegments=y.SegmentVector.simpleSegment(0,0,4,2);const T=new y.StructArrayLayout2i4;T.emplaceBack(0,0),T.emplaceBack(y.EXTENT,0),T.emplaceBack(0,y.EXTENT),T.emplaceBack(y.EXTENT,y.EXTENT),this.debugBuffer=h.createVertexBuffer(T,y.posAttributes.members),this.debugSegments=y.SegmentVector.simpleSegment(0,0,4,5);const k=new y.StructArrayLayout2i4;k.emplaceBack(-1,-1),k.emplaceBack(1,-1),k.emplaceBack(-1,1),k.emplaceBack(1,1),this.viewportBuffer=h.createVertexBuffer(k,y.posAttributes.members),this.viewportSegments=y.SegmentVector.simpleSegment(0,0,4,2);const P=new y.StructArrayLayout4i8;P.emplaceBack(0,0,0,0),P.emplaceBack(y.EXTENT,0,y.EXTENT,0),P.emplaceBack(0,y.EXTENT,0,y.EXTENT),P.emplaceBack(y.EXTENT,y.EXTENT,y.EXTENT,y.EXTENT),this.mercatorBoundsBuffer=h.createVertexBuffer(P,y.boundsAttributes.members),this.mercatorBoundsSegments=y.SegmentVector.simpleSegment(0,0,4,2);const I=new y.StructArrayLayout3ui6;I.emplaceBack(0,1,2),I.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=h.createIndexBuffer(I);const M=new y.StructArrayLayout1ui2;for(const G of[0,1,3,2,0])M.emplaceBack(G);this.debugIndexBuffer=h.createIndexBuffer(M),this.emptyTexture=new y.Texture(h,new y.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),h.gl.RGBA),this.identityMat=y.create();const z=this.context.gl;this.stencilClearMode=new y.StencilMode({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO),this.loadTimeStamps.push(y.window.performance.now()),this.atmosphereBuffer=new Tf(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(h){return h._makeTileBoundsBuffers(this.context,this.transform.projection),h._tileBoundsBuffer?{tileBoundsBuffer:h._tileBoundsBuffer,tileBoundsIndexBuffer:h._tileBoundsIndexBuffer,tileBoundsSegments:h._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const h=this.context,_=h.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(h,_.TRIANGLES,y.DepthMode.disabled,this.stencilClearMode,y.ColorMode.disabled,y.CullFaceMode.disabled,Oi(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(h,_,T){if(!_||this.currentStencilSource===_.id||!h.isTileClipped()||!T||0===T.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let M=!1;for(const z of T)if(void 0===this._tileClippingMaskIDs[z.key]){M=!0;break}if(!M)return}this.currentStencilSource=_.id;const k=this.context,P=k.gl;this.nextStencilID+T.length>256&&this.clearStencil(),k.setColorMode(y.ColorMode.disabled),k.setDepthMode(y.DepthMode.disabled);const I=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const M of T){const z=_.getTile(M),G=this._tileClippingMaskIDs[M.key]=this.nextStencilID++,{tileBoundsBuffer:$,tileBoundsIndexBuffer:te,tileBoundsSegments:ue}=this.getTileBoundsBuffers(z);I.draw(k,P.TRIANGLES,y.DepthMode.disabled,new y.StencilMode({func:P.ALWAYS,mask:0},G,255,P.KEEP,P.KEEP,P.REPLACE),y.ColorMode.disabled,y.CullFaceMode.disabled,Oi(M.projMatrix),"$clipping",$,te,ue)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const h=this.nextStencilID++,_=this.context.gl;return new y.StencilMode({func:_.NOTEQUAL,mask:255},h,255,_.KEEP,_.KEEP,_.REPLACE)}stencilModeForClipping(h){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(h);const _=this.context.gl;return new y.StencilMode({func:_.EQUAL,mask:255},this._tileClippingMaskIDs[h.key],0,_.KEEP,_.KEEP,_.REPLACE)}stencilConfigForOverlap(h){const _=this.context.gl,T=h.sort((I,M)=>M.overscaledZ-I.overscaledZ),k=T[T.length-1].overscaledZ,P=T[0].overscaledZ-k+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();const I={};for(let M=0;M<P;M++)I[M+k]=new y.StencilMode({func:_.GEQUAL,mask:255},M+this.nextStencilID,255,_.KEEP,_.KEEP,_.REPLACE);return this.nextStencilID+=P,[I,T]}return[{[k]:y.StencilMode.disabled},T]}colorModeForRenderPass(){const h=this.context.gl;return this._showOverdrawInspector?new y.ColorMode([h.CONSTANT_COLOR,h.ONE],new y.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?y.ColorMode.unblended:y.ColorMode.alphaBlended}depthModeForSublayer(h,_,T){if(!this.opaquePassEnabledForLayer())return y.DepthMode.disabled;const k=1-((1+this.currentLayer)*this.numSublayers+h)*this.depthEpsilon;return new y.DepthMode(T||this.context.gl.LEQUAL,_,[k,k])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(h,_){this.style=h,this.options=_,this.imageManager=h.imageManager,this.glyphManager=h.glyphManager,this.symbolFadeChange=h.placement.symbolFadeChange(y.exported.now()),this.imageManager.beginFrame();const T=this.style.order,k=this.style._sourceCaches;for(const G in k){const $=k[G];$.used&&$.prepare(this.context)}const P={},I={},M={};for(const G in k){const $=k[G];P[G]=$.getVisibleCoordinates(),I[G]=P[G].slice().reverse(),M[G]=$.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let G=0;G<T.length;G++)if(this.style._layers[T[G]].is3D()){this.opaquePassCutoff=G;break}if(this.terrain&&(this.terrain.updateTileBinding(M),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new y.GlobeSharedBuffers(this.context)),!y.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const G of T){const $=this.style._layers[G],te=h._getLayerSourceCache($);if(!$.hasOffscreenPass()||$.isHidden(this.transform.zoom))continue;const ue=te?I[te.id]:void 0;("custom"===$.type||$.isSky()||ue&&ue.length)&&this.renderLayer(this,te,$,ue)}this.depthRangeFor3D=[0,1-(h.order.length+2)*this.numSublayers*this.depthEpsilon];const z=this.terrain;if(z&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&z.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:_.showOverdrawInspector?y.Color.black:y.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=_.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=T.length-1;this.currentLayer>=0;this.currentLayer--){const G=this.style._layers[T[this.currentLayer]],$=h._getLayerSourceCache(G);if(G.isSky())continue;const te=$?I[$.id]:void 0;this._renderTileClippingMasks(G,$,te),this.renderLayer(this,$,G,te)}if(this.style.fog&&this.transform.projection.supportsFog&&function(G,$){const te=G.context,ue=te.gl,fe=G.transform,_e=new y.DepthMode(ue.LEQUAL,y.DepthMode.ReadOnly,[0,1]),ye=G.useProgram("globeAtmosphere",null,"globe"===fe.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Te=y.globeToMercatorTransition(fe.zoom),de=$.properties.get("color").toArray01(),Oe=$.properties.get("high-color").toArray01(),Re=$.properties.get("space-color").toArray01PremultipliedAlpha(),Fe=y.identity$1([]);y.rotateY$1(Fe,Fe,-y.degToRad(fe._center.lng)),y.rotateX$1(Fe,Fe,y.degToRad(fe._center.lat)),y.rotateZ$1(Fe,Fe,fe.angle),y.rotateX$1(Fe,Fe,-fe._pitch);const Ye=y.fromQuat(new Float32Array(16),Fe),We=y.mapValue($.properties.get("star-intensity"),0,1,0,.25),ut=y.mapValue($.properties.get("horizon-blend"),0,1,5e-4,.25),Et=y.globeUseCustomAntiAliasing(G,te,fe)&&5e-4===ut?fe.worldSize/(2*Math.PI*1.025)-1:fe.globeRadius,At=G.frameCounter/1e3%1,on=y.length(fe.globeCenterInViewSpace),wt=Math.sqrt(Math.pow(on,2)-Math.pow(Et,2)),qt=Math.acos(wt/on),Nt={u_frustum_tl:fe.frustumCorners.TL,u_frustum_tr:fe.frustumCorners.TR,u_frustum_br:fe.frustumCorners.BR,u_frustum_bl:fe.frustumCorners.BL,u_horizon:fe.frustumCorners.horizon,u_transition:Te,u_fadeout_range:ut,u_color:de,u_high_color:Oe,u_space_color:Re,u_star_intensity:We,u_star_size:5*y.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:At,u_horizon_angle:qt,u_rotation_matrix:Ye};G.prepareDrawProgram(te,ye);const sn=G.atmosphereBuffer;sn&&ye.draw(te,ue.TRIANGLES,_e,y.StencilMode.disabled,y.ColorMode.alphaBlended,y.CullFaceMode.backCW,Nt,"skybox",sn.vertexBuffer,sn.indexBuffer,sn.segments)}(this,this.style.fog),this.renderPass="sky",(y.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<T.length;this.currentLayer++){const G=this.style._layers[T[this.currentLayer]],$=h._getLayerSourceCache(G);G.isSky()&&this.renderLayer(this,$,G,$?I[$.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<T.length;){const G=this.style._layers[T[this.currentLayer]],$=h._getLayerSourceCache(G);if(G.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(G)){if(G.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const te=$?("symbol"===G.type?M:I)[$.id]:void 0;this._renderTileClippingMasks(G,$,$?P[$.id]:void 0),this.renderLayer(this,$,G,te),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let G=null;y.values(this.style._layers).forEach($=>{const te=h._getLayerSourceCache($);te&&!$.isHidden(this.transform.zoom)&&(!G||G.getSource().maxzoom<te.getSource().maxzoom)&&(G=te)}),G&&this.options.showTileBoundaries&&tl.debug(this,G,G.getVisibleCoordinates())}this.options.showPadding&&function(G){const $=G.transform.padding;Po(G,G.transform.height-($.top||0),3,bh),Po(G,$.bottom||0,3,ra),Wu(G,$.left||0,3,wl),Wu(G,G.transform.width-($.right||0),3,Or);const te=G.transform.centerPoint;var ue,fe,_e,ye;ld(ue=G,(fe=te.x)-1,(_e=G.transform.height-te.y)-10,2,20,ye=ad),ld(ue,fe-10,_e-1,20,2,ye)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(y.window.performance.now()),this.saveCanvasCopy())}renderLayer(h,_,T,k){T.isHidden(this.transform.zoom)||("background"===T.type||"sky"===T.type||"custom"===T.type||k&&k.length)&&(this.id=T.id,this.gpuTimingStart(T),(!h.transform.projection.unsupportedLayers||!h.transform.projection.unsupportedLayers.includes(T.type)||h.terrain&&"custom"===T.type)&&tl[T.type](h,_,T,k,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(h){if(!this.options.gpuTiming)return;const _=this.context.extTimerQuery;let T=this.gpuTimers[h.id];T||(T=this.gpuTimers[h.id]={calls:0,cpuTime:0,query:_.createQueryEXT()}),T.calls++,_.beginQueryEXT(_.TIME_ELAPSED_EXT,T.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const h=this.context.extTimerQuery,_=h.createQueryEXT();this.deferredRenderGpuTimeQueries.push(_),h.beginQueryEXT(h.TIME_ELAPSED_EXT,_)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const h=this.context.extTimerQuery;h.endQueryEXT(h.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;h.endQueryEXT(h.TIME_ELAPSED_EXT)}collectGpuTimers(){const h=this.gpuTimers;return this.gpuTimers={},h}collectDeferredRenderGpuQueries(){const h=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],h}queryGpuTimers(h){const _={};for(const T in h){const k=h[T],P=this.context.extTimerQuery,I=P.getQueryObjectEXT(k.query,P.QUERY_RESULT_EXT)/1e6;P.deleteQueryEXT(k.query),_[T]=I}return _}queryGpuTimeDeferredRender(h){if(!this.options.gpuTimingDeferredRender)return 0;const _=this.context.extTimerQuery;let T=0;for(const k of h)T+=_.getQueryObjectEXT(k,_.QUERY_RESULT_EXT)/1e6,_.deleteQueryEXT(k);return T}translatePosMatrix(h,_,T,k,P){if(!T[0]&&!T[1])return h;const I=P?"map"===k?this.transform.angle:0:"viewport"===k?-this.transform.angle:0;if(I){const G=Math.sin(I),$=Math.cos(I);T=[T[0]*$-T[1]*G,T[0]*G+T[1]*$]}const M=[P?T[0]:or(_,T[0],this.transform.zoom),P?T[1]:or(_,T[1],this.transform.zoom),0],z=new Float32Array(16);return y.translate(z,h,M),z}saveTileTexture(h){const _=this._tileTextures[h.size[0]];_?_.push(h):this._tileTextures[h.size[0]]=[h]}getTileTexture(h){const _=this._tileTextures[h];return _&&_.length>0?_.pop():null}isPatternMissing(h){return null===h||void 0!==h&&!this.imageManager.getPattern(h.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const h=this.terrain&&this.terrain.renderingToTexture,_=this.terrain&&0===this.terrain.exaggeration(),T=this.style&&this.style.fog,k=[];return this.terrainRenderModeElevated()&&k.push("TERRAIN"),"globe"===this.transform.projection.name&&k.push("GLOBE"),_&&k.push("ZERO_EXAGGERATION"),T&&!h&&0!==T.getOpacity(this.transform.pitch)&&k.push("FOG"),h&&k.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&k.push("OVERDRAW_INSPECTOR"),k}useProgram(h,_,T){this.cache=this.cache||{};const k=T||[],P=this.currentGlobalDefines().concat(k),I=ju.cacheKey(Zl[h],h,P,_);return this.cache[I]||(this.cache[I]=new ju(this.context,h,Zl[h],_,rd[h],P)),this.cache[I]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const h=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(h.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=y.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new y.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(h,_,T){if(this.terrain&&this.terrain.renderingToTexture)return;const k=this.style.fog;if(k){const P=k.getOpacity(this.transform.pitch),I=((M,z,G,$,te,ue,fe,_e,ye,Te,de)=>{const Oe=M.transform,Re=z.properties.get("color").toArray01();Re[3]=$;const Fe=M.frameCounter/1e3%1;return{u_fog_matrix:G?Oe.calculateFogTileMatrix(G):M.identityMat,u_fog_range:z.getFovAdjustedRange(Oe._fov),u_fog_color:Re,u_fog_horizon_blend:z.properties.get("horizon-blend"),u_fog_temporal_offset:Fe,u_frustum_tl:te,u_frustum_tr:ue,u_frustum_br:fe,u_frustum_bl:_e,u_globe_pos:ye,u_globe_radius:Te,u_viewport:de,u_globe_transition:y.globeToMercatorTransition(Oe.zoom),u_is_globe:+("globe"===Oe.projection.name)}})(this,k,T,P,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*y.exported.devicePixelRatio,this.transform.height*y.exported.devicePixelRatio]);_.setFogUniformValues(h,I)}}setTileLoadedFlag(h){this.tileLoaded=h}saveCanvasCopy(){const h=this.canvasCopy();h&&(this.frameCopies.push(h),this.tileLoaded=!1)}canvasCopy(){const h=this.context.gl,_=h.createTexture();return h.bindTexture(h.TEXTURE_2D,_),h.copyTexImage2D(h.TEXTURE_2D,0,h.RGBA,0,0,h.drawingBufferWidth,h.drawingBufferHeight,0),_}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const h=this.style&&this.style.fog;return!!h&&0!==h.getOpacity(this.transform.pitch)}getBackgroundTiles(){const h=this._backgroundTiles,_=this._backgroundTiles={},T=this.transform.coveringTiles({tileSize:512});for(const k of T)_[k.key]=h[k.key]||new y.Tile(k,512,this.transform.tileZoom,this);return _}clearBackgroundTiles(){this._backgroundTiles={}}}class Os{constructor(h=0,_=0,T=0,k=0){if(isNaN(h)||h<0||isNaN(_)||_<0||isNaN(T)||T<0||isNaN(k)||k<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=h,this.bottom=_,this.left=T,this.right=k}interpolate(h,_,T){return null!=_.top&&null!=h.top&&(this.top=y.number(h.top,_.top,T)),null!=_.bottom&&null!=h.bottom&&(this.bottom=y.number(h.bottom,_.bottom,T)),null!=_.left&&null!=h.left&&(this.left=y.number(h.left,_.left,T)),null!=_.right&&null!=h.right&&(this.right=y.number(h.right,_.right,T)),this}getCenter(h,_){const T=y.clamp((this.left+h-this.right)/2,0,h),k=y.clamp((this.top+_-this.bottom)/2,0,_);return new y.pointGeometry(T,k)}equals(h){return this.top===h.top&&this.bottom===h.bottom&&this.left===h.left&&this.right===h.right}clone(){return new Os(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function wm(w,h){const _=y.getColumn(w,3);y.fromQuat(w,h),y.setColumn(w,3,_)}function Rc(w,h){const _=y.identity$1([]);return y.rotateZ$1(_,_,-h),y.rotateX$1(_,_,-w),_}function Sf(w,h){const _=[w[0],w[1],0],T=[h[0],h[1],0];if(y.length(_)>=1e-15){const I=y.normalize([],_);y.scale$2(T,I,y.dot(T,I)),h[0]=T[0],h[1]=T[1]}const k=y.cross([],h,w);if(y.len(k)<1e-15)return null;const P=Math.atan2(-k[1],k[0]);return Rc(Math.atan2(Math.sqrt(w[0]*w[0]+w[1]*w[1]),-w[2]),P)}class wh{constructor(h,_){this.position=h,this.orientation=_}get position(){return this._position}set position(h){if(h){const _=h instanceof y.MercatorCoordinate?h:new y.MercatorCoordinate(h[0],h[1],h[2]);this._renderWorldCopies&&(_.x=y.wrap(_.x,0,1)),this._position=_}else this._position=null}lookAtPoint(h,_){if(this.orientation=null,!this.position)return;const T=this.position,k=this._elevation?this._elevation.getAtPointOrZero(y.MercatorCoordinate.fromLngLat(h)):0,P=y.MercatorCoordinate.fromLngLat(h,k),I=[P.x-T.x,P.y-T.y,P.z-T.z];_||(_=[0,0,1]),_[2]=Math.abs(_[2]),this.orientation=Sf(I,_)}setPitchBearing(h,_){this.orientation=Rc(y.degToRad(h),y.degToRad(-_))}}class Ta{constructor(h,_){this._transform=y.identity([]),this.orientation=_,this.position=h}get mercatorPosition(){const h=this.position;return new y.MercatorCoordinate(h[0],h[1],h[2])}get position(){const h=y.getColumn(this._transform,3);return[h[0],h[1],h[2]]}set position(h){var _;h&&y.setColumn(this._transform,3,[(_=h)[0],_[1],_[2],1])}get orientation(){return this._orientation}set orientation(h){this._orientation=h||y.identity$1([]),h&&wm(this._transform,this._orientation)}getPitchBearing(){const h=this.forward(),_=this.right();return{bearing:Math.atan2(-_[1],_[0]),pitch:Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2])}}setPitchBearing(h,_){this._orientation=Rc(h,_),wm(this._transform,this._orientation)}forward(){const h=y.getColumn(this._transform,2);return[-h[0],-h[1],-h[2]]}up(){const h=y.getColumn(this._transform,1);return[-h[0],-h[1],-h[2]]}right(){const h=y.getColumn(this._transform,0);return[h[0],h[1],h[2]]}getCameraToWorld(h,_){const T=new Float64Array(16);return y.invert(T,this.getWorldToCamera(h,_)),T}getWorldToCameraPosition(h,_,T){const k=this.position;y.scale$2(k,k,-h);const P=new Float64Array(16);return y.fromScaling(P,[T,T,T]),y.translate(P,P,k),P[10]*=_,P}getWorldToCamera(h,_){const T=new Float64Array(16),k=new Float64Array(4),P=this.position;return y.conjugate(k,this._orientation),y.scale$2(P,P,-h),y.fromQuat(T,k),y.translate(T,T,P),T[1]*=-1,T[5]*=-1,T[9]*=-1,T[13]*=-1,T[8]*=_,T[9]*=_,T[10]*=_,T[11]*=_,T}getCameraToClipPerspective(h,_,T,k){const P=new Float64Array(16);return y.perspective(P,h,_,T,k),P}getDistanceToElevation(h,_=!1){const T=0===h?0:y.mercatorZfromAltitude(h,_?y.latFromMercatorY(this.position[1]):this.position[1]),k=this.forward();return(T-this.position[2])/k[2]}clone(){return new Ta([...this.position],[...this.orientation])}}function Pc(w,h){const _=El(w.projection,w.zoom,w.width,w.height),T=function(P,I,M,z,G){const $=new y.LngLat(M.lng-180*qs,M.lat),te=new y.LngLat(M.lng+180*qs,M.lat),ue=P.project($.lng,$.lat),fe=P.project(te.lng,te.lat),_e=-Math.atan2(fe.y-ue.y,fe.x-ue.x),ye=y.MercatorCoordinate.fromLngLat(M);ye.y=y.clamp(ye.y,-.999975,.999975);const Te=ye.toLngLat(),de=P.project(Te.lng,Te.lat),Oe=y.MercatorCoordinate.fromLngLat(Te);Oe.x+=qs;const Re=Oe.toLngLat(),Fe=P.project(Re.lng,Re.lat),Ye=oa(Fe.x-de.x,Fe.y-de.y,_e),We=y.MercatorCoordinate.fromLngLat(Te);We.y+=qs;const Xe=We.toLngLat(),ut=P.project(Xe.lng,Xe.lat),Et=oa(ut.x-de.x,ut.y-de.y,_e),At=Math.abs(Ye.x)/Math.abs(Et.y),on=y.identity([]);y.rotateZ(on,on,-_e*(1-(G?0:z)));const wt=y.identity([]);return y.scale(wt,wt,[1,1-(1-At)*z,1]),wt[4]=-Et.x/Et.y*z,y.rotateZ(wt,wt,_e),y.multiply(wt,on,wt),wt}(w.projection,0,w.center,_,h),k=Eo(w);return y.scale(T,T,[k,k,1]),T}function Eo(w){const h=w.projection,_=El(w.projection,w.zoom,w.width,w.height),T=Oc(h,w.center),k=Oc(h,y.LngLat.convert(h.center));return Math.pow(2,T*_+(1-_)*k)}function El(w,h,_,T,k=1/0){const P=w.range;if(!P)return 0;const I=Math.min(k,Math.max(_,T)),M=Math.log(I/1024)/Math.LN2;return y.smoothstep(P[0]+M,P[1]+M,h)}const qs=1/4e4;function Oc(w,h){const _=y.clamp(h.lat,-y.MAX_MERCATOR_LATITUDE,y.MAX_MERCATOR_LATITUDE),T=new y.LngLat(h.lng-180*qs,_),k=new y.LngLat(h.lng+180*qs,_),P=w.project(T.lng,_),I=w.project(k.lng,_),M=y.MercatorCoordinate.fromLngLat(T),z=y.MercatorCoordinate.fromLngLat(k),G=I.x-P.x,$=I.y-P.y,te=z.x-M.x,ue=z.y-M.y,fe=Math.sqrt((te*te+ue*ue)/(G*G+$*$));return Math.log(fe)/Math.LN2}function oa(w,h,_){const T=Math.cos(_),k=Math.sin(_);return{x:w*T-h*k,y:w*k+h*T}}class An{constructor(h,_,T,k,P,I,M){this.tileSize=512,this._renderWorldCopies=void 0===P||P,this._minZoom=h||0,this._maxZoom=_||22,this._minPitch=T??0,this._maxPitch=k??60,this.setProjection(I),this.setMaxBounds(M),this.width=0,this.height=0,this._center=new y.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Os,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Ta,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const h=new An(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return h._elevation=this._elevation,h._centerAltitude=this._centerAltitude,h._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,h.tileSize=this.tileSize,h.mercatorFromTransition=this.mercatorFromTransition,h.width=this.width,h.height=this.height,h.cameraElevationReference=this.cameraElevationReference,h._center=this._center,h._setZoom(this.zoom),h._seaLevelZoom=this._seaLevelZoom,h.angle=this.angle,h._fov=this._fov,h._pitch=this._pitch,h._nearZ=this._nearZ,h._farZ=this._farZ,h._averageElevation=this._averageElevation,h._unmodified=this._unmodified,h._edgeInsets=this._edgeInsets.clone(),h._camera=this._camera.clone(),h._calcMatrices(),h.freezeTileCoverage=this.freezeTileCoverage,h.frustumCorners=this.frustumCorners,h}get elevation(){return this._elevation}set elevation(h){this._elevation!==h&&(this._elevation=h,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(h,_=!1){const T=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||T)&&this._updateCameraOnTerrain(),(h||T)&&this._constrainCamera(_),this._calcMatrices()}getProjection(){return y.pick(this.projection,["name","center","parallels"])}setProjection(h){this.projectionOptions=h||{name:"mercator"};const _=this.projection?this.getProjection():void 0;this.projection=y.getProjection(this.projectionOptions);const T=!ze(_,this.getProjection());return T&&this._calcMatrices(),this.mercatorFromTransition=!1,T}setMercatorFromTransition(){const h=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=y.getProjection({name:"mercator"});const _=h!==this.projection.name;return _&&this._calcMatrices(),_}get minZoom(){return this._minZoom}set minZoom(h){this._minZoom!==h&&(this._minZoom=h,this.zoom=Math.max(this.zoom,h))}get maxZoom(){return this._maxZoom}set maxZoom(h){this._maxZoom!==h&&(this._maxZoom=h,this.zoom=Math.min(this.zoom,h))}get minPitch(){return this._minPitch}set minPitch(h){this._minPitch!==h&&(this._minPitch=h,this.pitch=Math.max(this.pitch,h))}get maxPitch(){return this._maxPitch}set maxPitch(h){this._maxPitch!==h&&(this._maxPitch=h,this.pitch=Math.min(this.pitch,h))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(h){void 0===h?h=!0:null===h&&(h=!1),this._renderWorldCopies=h}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get cameraWorldSize(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return y.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new y.pointGeometry(this.width,this.height)}get bearing(){return y.wrap(this.rotation,-180,180)}set bearing(h){this.rotation=h}get rotation(){return-this.angle/Math.PI*180}set rotation(h){const _=-h*Math.PI/180;var T,k,P,I,M,z,G,$,te,ue;this.angle!==_&&(this._unmodified=!1,this.angle=_,this._calcMatrices(),this.rotationMatrix=(T=new y.ARRAY_TYPE(4),y.ARRAY_TYPE!=Float32Array&&(T[1]=0,T[2]=0),T[0]=1,T[3]=1,T),k=this.rotationMatrix,I=this.angle,M=(P=this.rotationMatrix)[0],z=P[1],G=P[2],$=P[3],te=Math.sin(I),ue=Math.cos(I),k[0]=M*ue+G*te,k[1]=z*ue+$*te,k[2]=M*-te+G*ue,k[3]=z*-te+$*ue)}get pitch(){return this._pitch/Math.PI*180}set pitch(h){const _=y.clamp(h,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==_&&(this._unmodified=!1,this._pitch=_,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const h=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/h)}set fov(h){h=Math.max(.01,Math.min(60,h)),this._fov!==h&&(this._unmodified=!1,this._fov=y.degToRad(h),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(h){this._averageElevation=h,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(h){const _=Math.min(Math.max(h,this.minZoom),this.maxZoom);this._zoom!==_&&(this._unmodified=!1,this._setZoom(_),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(h){this._zoom=h,this.scale=this.zoomScale(h),this.tileZoom=Math.floor(h),this.zoomFraction=h-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const h=this._elevation;this._centerAltitude=h.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=h.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const h=this._elevation,_=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],T=this.horizonLineFromTop();let k=0,P=0;for(let I=0;I<_.length;I++){const M=new y.pointGeometry(_[I][0]*this.width,T+_[I][1]*(this.height-T)),z=h.pointCoordinate(M);if(!z)continue;const G=1/Math.hypot(z[0]-this._camera.position[0],z[1]-this._camera.position[1]);k+=z[3]*G,P+=G}return 0===P?NaN:k/P}get center(){return this._center}set center(h){h.lat===this._center.lat&&h.lng===this._center.lng||(this._unmodified=!1,this._center=h,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const h=this._seaLevelZoom,_=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),T=this.pixelsPerMeter/this.worldSize*_,k=this._mercatorZfromZoom(h),P=this._mercatorZfromZoom(this._maxZoom),I=Math.max(k-T,P);this._setZoom(this._zoomFromMercatorZ(I))}get padding(){return this._edgeInsets.toJSON()}set padding(h){this._edgeInsets.equals(h)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,h,1),this._calcMatrices())}computeZoomRelativeTo(h){const _=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,h.toAltitude()));let T;T=h.z<this._camera.position[2]?[_.x,_.y,_.z]:[h.x,h.y,h.z];const k=y.length(y.sub([],this._camera.position,T));return y.clamp(this._zoomFromMercatorZ(k),this._minZoom,this._maxZoom)}setFreeCameraOptions(h){if(!this.height||!h.position&&!h.orientation)return;this._updateCameraState();let _=!1;if(h.orientation&&!y.exactEquals(h.orientation,this._camera.orientation)&&(_=this._setCameraOrientation(h.orientation)),h.position){const T=[h.position.x,h.position.y,h.position.z];y.exactEquals$1(T,this._camera.position)||(this._setCameraPosition(T),_=!0)}_&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const h=this._camera.position,_=new wh;return _.position=new y.MercatorCoordinate(h[0],h[1],h[2]),_.orientation=this._camera.orientation,_._elevation=this.elevation,_._renderWorldCopies=this.renderWorldCopies,_}_setCameraOrientation(h){if(!y.length$1(h))return!1;y.normalize$1(h,h);const _=y.transformQuat([],[0,0,-1],h),T=y.transformQuat([],[0,-1,0],h);if(T[2]<0)return!1;const k=Sf(_,T);return!!k&&(this._camera.orientation=k,!0)}_setCameraPosition(h){const _=this.zoomScale(this.minZoom)*this.tileSize,T=this.zoomScale(this.maxZoom)*this.tileSize,k=this.cameraToCenterDistance;h[2]=y.clamp(h[2],k/T,k/_),this._camera.position=h}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(h){return this._edgeInsets.equals(h)}interpolatePadding(h,_,T){this._unmodified=!1,this._edgeInsets.interpolate(h,_,T),this._constrain(),this._calcMatrices()}coveringZoomLevel(h){const _=(h.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/h.tileSize));return Math.max(0,_)}getVisibleUnwrappedCoordinates(h){const _=[new y.UnwrappedTileID(0,h)];if(this.renderWorldCopies){const T=this.pointCoordinate(new y.pointGeometry(0,0)),k=this.pointCoordinate(new y.pointGeometry(this.width,0)),P=this.pointCoordinate(new y.pointGeometry(this.width,this.height)),I=this.pointCoordinate(new y.pointGeometry(0,this.height)),M=Math.floor(Math.min(T.x,k.x,P.x,I.x)),z=Math.floor(Math.max(T.x,k.x,P.x,I.x)),G=1;for(let $=M-G;$<=z+G;$++)0!==$&&_.push(new y.UnwrappedTileID($,h))}return _}coveringTiles(h){let _=this.coveringZoomLevel(h);const T=_,k=this.elevation&&!h.isTerrainDEM,P="mercator"===this.projection.name;if(void 0!==h.minzoom&&_<h.minzoom)return[];void 0!==h.maxzoom&&_>h.maxzoom&&(_=h.maxzoom);const I=this.locationCoordinate(this.center),M=this.center.lat,z=1<<_,G=[z*I.x,z*I.y,0],$="globe"===this.projection.name,te=!$,ue=y.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,_,te),fe=$?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),_e=z*y.mercatorZfromAltitude(1,this.center.lat),ye=this._camera.position[2]/y.mercatorZfromAltitude(1,this.center.lat),Te=[z*fe.x,z*fe.y,ye*(te?1:_e)],de=this.cameraToCenterDistance/h.tileSize*(h.roundZoom?1:.502),Oe=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?_:0,Re=h.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Fe=h.isTerrainDEM?-Re:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ye=this.projection.isReprojectedInTileSpace?Eo(this):1,We=Tt=>{const Pt=new y.MercatorCoordinate(Tt.x+25e-6,Tt.y,Tt.z),tn=new y.MercatorCoordinate(Tt.x,Tt.y+25e-6,Tt.z),hn=Tt.toLngLat(),$n=Pt.toLngLat(),ki=tn.toLngLat(),Gn=this.locationCoordinate(hn),On=this.locationCoordinate($n),Jn=this.locationCoordinate(ki),sr=Math.hypot(On.x-Gn.x,On.y-Gn.y),hi=Math.hypot(Jn.x-Gn.x,Jn.y-Gn.y);return Math.sqrt(sr*hi)*Ye/25e-6},Xe=Tt=>{const yt=Re,Pt=Fe;return{aabb:y.tileAABB(this,z,0,0,0,Tt,Pt,yt,this.projection),zoom:0,x:0,y:0,minZ:Pt,maxZ:yt,wrap:Tt,fullyVisible:!1}},ut=[];let Et=[];const At=_,on=h.reparseOverscaled?T:_,wt=Tt=>Tt*Tt,qt=wt((ye-this._centerAltitude)*_e),Nt=Tt=>{if(!this._elevation||!Tt.tileID||!P)return;const yt=this._elevation.getMinMaxForTile(Tt.tileID),Pt=Tt.aabb;yt?(Pt.min[2]=yt.min,Pt.max[2]=yt.max,Pt.center[2]=(Pt.min[2]+Pt.max[2])/2):(Tt.shouldSplit=sn(Tt),Tt.shouldSplit||(Pt.min[2]=Pt.max[2]=Pt.center[2]=this._centerAltitude))},sn=Tt=>{if(Tt.zoom<Oe)return!0;if(Tt.zoom===At)return!1;if(null!=Tt.shouldSplit)return Tt.shouldSplit;const yt=Tt.aabb.distanceX(Te),Pt=Tt.aabb.distanceY(Te);let tn=qt,hn=1;if($){tn=wt(Tt.aabb.distanceZ(Te));const Gn=Math.pow(2,Tt.zoom),On=y.latFromMercatorY((Tt.y+1)/Gn),Jn=y.latFromMercatorY(Tt.y/Gn),sr=Math.min(Math.max(M,On),Jn),hi=y.circumferenceAtLatitude(sr)/y.circumferenceAtLatitude(M);if(hn=sr===M?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,hi/this._mercatorScaleRatio),this.zoom<=y.GLOBE_ZOOM_THRESHOLD_MIN&&Tt.zoom===At-1&&hi>=.9)return!0}else if(k&&(tn=wt(Tt.aabb.distanceZ(Te)*_e)),this.projection.isReprojectedInTileSpace&&T<=5){const Gn=Math.pow(2,Tt.zoom),On=We(new y.MercatorCoordinate((Tt.x+.5)/Gn,(Tt.y+.5)/Gn));hn=On>.85?1:On}const $n=yt*yt+Pt*Pt+tn;return $n<wt((1<<At-Tt.zoom)*de*hn*((Gn,On)=>{if(On*wt(.707)<Gn)return 1;const Jn=Math.sqrt(On/Gn);return Jn/(1.4144271570014144+(Math.pow(1.1,Jn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(tn,qt),$n))};if(this.renderWorldCopies)for(let Tt=1;Tt<=3;Tt++)ut.push(Xe(-Tt)),ut.push(Xe(Tt));for(ut.push(Xe(0));ut.length>0;){const Tt=ut.pop(),yt=Tt.x,Pt=Tt.y;let tn=Tt.fullyVisible;if(!tn){const hn=Tt.aabb.intersects(ue);if(0===hn)continue;tn=2===hn}if(Tt.zoom!==At&&sn(Tt))for(let hn=0;hn<4;hn++){const $n=(yt<<1)+hn%2,ki=(Pt<<1)+(hn>>1),Gn={aabb:P?Tt.aabb.quadrant(hn):y.tileAABB(this,z,Tt.zoom+1,$n,ki,Tt.wrap,Tt.minZ,Tt.maxZ,this.projection),zoom:Tt.zoom+1,x:$n,y:ki,wrap:Tt.wrap,fullyVisible:tn,tileID:void 0,shouldSplit:void 0,minZ:Tt.minZ,maxZ:Tt.maxZ};k&&!$&&(Gn.tileID=new y.OverscaledTileID(Tt.zoom+1===At?on:Tt.zoom+1,Tt.wrap,Tt.zoom+1,$n,ki),Nt(Gn)),ut.push(Gn)}else{const hn=Tt.zoom===At?on:Tt.zoom;if(h.minzoom&&h.minzoom>hn)continue;const $n=G[0]-(.5+yt+(Tt.wrap<<Tt.zoom))*(1<<_-Tt.zoom),ki=G[1]-.5-Pt,Gn=Tt.tileID?Tt.tileID:new y.OverscaledTileID(hn,Tt.wrap,Tt.zoom,yt,Pt);Et.push({tileID:Gn,distanceSq:$n*$n+ki*ki})}}if(this.fogCullDistSq){const Tt=this.fogCullDistSq,yt=this.horizonLineFromTop();Et=Et.filter(Pt=>{const tn=[0,0,0,1],hn=[y.EXTENT,y.EXTENT,0,1],$n=this.calculateFogTileMatrix(Pt.tileID.toUnwrapped());y.transformMat4$1(tn,tn,$n),y.transformMat4$1(hn,hn,$n);const ki=y.getAABBPointSquareDist(tn,hn);if(0===ki)return!0;let Gn=!1;const On=this._elevation;if(On&&ki>Tt&&0!==yt){const Jn=this.calculateProjMatrix(Pt.tileID.toUnwrapped());let sr;h.isTerrainDEM||(sr=On.getMinMaxForTile(Pt.tileID)),sr||(sr={min:Fe,max:Re});const hi=y.furthestTileCorner(this.rotation),Lr=[hi[0]*y.EXTENT,hi[1]*y.EXTENT,sr.max];y.transformMat4(Lr,Lr,Jn),Gn=(1-Lr[1])*this.height*.5<yt}return ki<Tt||Gn})}return Et.sort((Tt,yt)=>Tt.distanceSq-yt.distanceSq).map(Tt=>Tt.tileID)}resize(h,_){this.width=h,this.height=_,this.pixelsToGLUnits=[2/h,-2/_],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(h){return Math.pow(2,h)}scaleZoom(h){return Math.log(h)/Math.LN2}project(h){const _=y.clamp(h.lat,-y.MAX_MERCATOR_LATITUDE,y.MAX_MERCATOR_LATITUDE),T=this.projection.project(h.lng,_);return new y.pointGeometry(T.x*this.worldSize,T.y*this.worldSize)}unproject(h){return this.projection.unproject(h.x/this.worldSize,h.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/y.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(h,_){let T,k;const P=this.centerPoint;if("globe"===this.projection.name){const M=this.worldSize;T=(_.x-P.x)/M,k=(_.y-P.y)/M}else{const M=this.pointCoordinate(_),z=this.pointCoordinate(P);T=M.x-z.x,k=M.y-z.y}const I=this.locationCoordinate(h);this.setLocation(new y.MercatorCoordinate(I.x-T,I.y-k))}setLocation(h){this.center=this.coordinateLocation(h),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(h){return this.projection.locationPoint(this,h)}locationPoint3D(h){return this.projection.locationPoint(this,h,!0)}pointLocation(h){return this.coordinateLocation(this.pointCoordinate(h))}pointLocation3D(h){return this.coordinateLocation(this.pointCoordinate3D(h))}locationCoordinate(h,_){const T=_?y.mercatorZfromAltitude(_,h.lat):void 0,k=this.projection.project(h.lng,h.lat);return new y.MercatorCoordinate(k.x,k.y,T)}coordinateLocation(h){return this.projection.unproject(h.x,h.y)}pointRayIntersection(h,_){const T=_??this._centerAltitude,k=[h.x,h.y,0,1],P=[h.x,h.y,1,1];y.transformMat4$1(k,k,this.pixelMatrixInverse),y.transformMat4$1(P,P,this.pixelMatrixInverse);const I=P[3];y.scale$1(k,k,1/k[3]),y.scale$1(P,P,1/I);const M=k[2],z=P[2];return{p0:k,p1:P,t:M===z?0:(T-M)/(z-M)}}screenPointToMercatorRay(h){const _=[h.x,h.y,0,1],T=[h.x,h.y,1,1];return y.transformMat4$1(_,_,this.pixelMatrixInverse),y.transformMat4$1(T,T,this.pixelMatrixInverse),y.scale$1(_,_,1/_[3]),y.scale$1(T,T,1/T[3]),_[2]=y.mercatorZfromAltitude(_[2],this._center.lat)*this.worldSize,T[2]=y.mercatorZfromAltitude(T[2],this._center.lat)*this.worldSize,y.scale$1(_,_,1/this.worldSize),y.scale$1(T,T,1/this.worldSize),new y.Ray([_[0],_[1],_[2]],y.normalize([],y.sub([],T,_)))}rayIntersectionCoordinate(h){const{p0:_,p1:T,t:k}=h,P=y.mercatorZfromAltitude(_[2],this._center.lat),I=y.mercatorZfromAltitude(T[2],this._center.lat);return new y.MercatorCoordinate(y.number(_[0],T[0],k)/this.worldSize,y.number(_[1],T[1],k)/this.worldSize,y.number(P,I,k))}pointCoordinate(h,_=this._centerAltitude){return this.projection.pointCoordinate(this,h.x,h.y,_)}pointCoordinate3D(h){if(!this.elevation)return this.pointCoordinate(h);let _=this.projection.pointCoordinate3D(this,h.x,h.y);if(_)return new y.MercatorCoordinate(_[0],_[1],_[2]);let T=0,k=this.horizonLineFromTop();if(h.y>k)return this.pointCoordinate(h);const P=.02*k,I=h.clone();for(let M=0;M<10&&k-T>P;M++){I.y=y.number(T,k,.66);const z=this.projection.pointCoordinate3D(this,I.x,I.y);z?(k=I.y,_=z):T=I.y}return _?new y.MercatorCoordinate(_[0],_[1],_[2]):this.pointCoordinate(h)}isPointAboveHorizon(h){return this.projection.isPointAboveHorizon(this,h)}_coordinatePoint(h,_){const T=_&&this.elevation?this.elevation.getAtPointOrZero(h,this._centerAltitude):this._centerAltitude,k=[h.x*this.worldSize,h.y*this.worldSize,T+h.toAltitude(),1];return y.transformMat4$1(k,k,this.pixelMatrix),k[3]>0?new y.pointGeometry(k[0]/k[3],k[1]/k[3]):new y.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:h,left:_}=this._edgeInsets,T=this.height-this._edgeInsets.bottom,k=this.width-this._edgeInsets.right,P=this.pointLocation3D(new y.pointGeometry(_,h)),I=this.pointLocation3D(new y.pointGeometry(k,h)),M=this.pointLocation3D(new y.pointGeometry(k,T)),z=this.pointLocation3D(new y.pointGeometry(_,T));let G=Math.min(P.lng,I.lng,M.lng,z.lng),$=Math.max(P.lng,I.lng,M.lng,z.lng),te=Math.min(P.lat,I.lat,M.lat,z.lat),ue=Math.max(P.lat,I.lat,M.lat,z.lat);const fe=Math.pow(2,-this.zoom)/16*270,_e="globe"===this.projection.name?1:4,ye=(Te,de,Oe,Re,Fe)=>{const Ye=(Te+Oe)/2,We=(de+Re)/2,Xe=new y.pointGeometry(Ye,We),{lng:ut,lat:Et}=this.pointLocation3D(Xe),At=Math.max(0,G-ut,te-Et,ut-$,Et-ue);G=Math.min(G,ut),$=Math.max($,ut),te=Math.min(te,Et),ue=Math.max(ue,Et),(Fe<_e||At>fe)&&(ye(Te,de,Ye,We,Fe+1),ye(Ye,We,Oe,Re,Fe+1))};if(ye(_,h,k,h,1),ye(k,h,k,T,1),ye(k,T,_,T,1),ye(_,T,_,h,1),"globe"===this.projection.name){const[Te,de]=y.polesInViewport(this);Te?(ue=90,$=180,G=-180):de&&(te=-90,$=180,G=-180)}return new y.LngLatBounds(new y.LngLat(G,te),new y.LngLat($,ue))}_getBoundsRectangular(h,_){const{top:T,left:k}=this._edgeInsets,P=this.height-this._edgeInsets.bottom,I=this.width-this._edgeInsets.right,M=new y.pointGeometry(k,T),z=new y.pointGeometry(I,T),G=new y.pointGeometry(I,P),$=new y.pointGeometry(k,P);let te=this.pointCoordinate(M,h),ue=this.pointCoordinate(z,h);const fe=this.pointCoordinate(G,_),_e=this.pointCoordinate($,_),ye=(Te,de)=>(de.y-Te.y)/(de.x-Te.x);return te.y>1&&ue.y>=0?te=new y.MercatorCoordinate((1-_e.y)/ye(_e,te)+_e.x,1):te.y<0&&ue.y<=1&&(te=new y.MercatorCoordinate(-_e.y/ye(_e,te)+_e.x,0)),ue.y>1&&te.y>=0?ue=new y.MercatorCoordinate((1-fe.y)/ye(fe,ue)+fe.x,1):ue.y<0&&te.y<=1&&(ue=new y.MercatorCoordinate(-fe.y/ye(fe,ue)+fe.x,0)),(new y.LngLatBounds).extend(this.coordinateLocation(te)).extend(this.coordinateLocation(ue)).extend(this.coordinateLocation(_e)).extend(this.coordinateLocation(fe))}_getBoundsRectangularTerrain(){const h=this.elevation;if(!h.visibleDemTiles.length||h.isUsingMockSource())return this._getBoundsRectangular(0,0);const _=h.visibleDemTiles.reduce((T,k)=>{if(k.dem){const P=k.dem.tree;T.min=Math.min(T.min,P.minimums[0]),T.max=Math.max(T.max,P.maximums[0])}return T},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(_.min*h.exaggeration(),_.max*h.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(h=!0){const _=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,T=this.height/2-_*(1-this._horizonShift);return h?Math.max(0,T):T}getMaxBounds(){return this.maxBounds}setMaxBounds(h){this.maxBounds=h,this.minLat=-y.MAX_MERCATOR_LATITUDE,this.maxLat=y.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,h&&(this.minLat=h.getSouth(),this.maxLat=h.getNorth(),this.minLng=h.getWest(),this.maxLng=h.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=y.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=y.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=y.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=y.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(h,_){return this.projection.createTileMatrix(this,_,h)}calculateDistanceTileData(h){const _=h.key,T=this._distanceTileDataCache;if(T[_])return T[_];const k=h.canonical,P=1/this.height,I=this.cameraWorldSize,M=I/this.zoomScale(k.z),z=(k.x+Math.pow(2,k.z)*h.wrap)*M,G=k.y*M,$=this.point;$.x*=I/this.worldSize,$.y*=I/this.worldSize;const te=this.angle,ue=Math.sin(-te),fe=-Math.cos(-te);return T[_]={bearing:[ue,fe],center:[($.x-z)*P,($.y-G)*P],scale:M/y.EXTENT*P},T[_]}calculateFogTileMatrix(h){const _=h.key,T=this._fogTileMatrixCache;if(T[_])return T[_];const k=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,h);return y.multiply(k,this.worldToFogMatrix,k),T[_]=new Float32Array(k),T[_]}calculateProjMatrix(h,_=!1){const T=h.key,k=_?this._alignedProjMatrixCache:this._projMatrixCache;if(k[T])return k[T];const P=this.calculatePosMatrix(h,this.worldSize);return y.multiply(P,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:_?this.alignedProjMatrix:this.projMatrix,P),k[T]=new Float32Array(P),k[T]}calculatePixelsToTileUnitsMatrix(h){const _=h.tileID.key,T=this._pixelsToTileUnitsCache;if(T[_])return T[_];const k=function(P,I){const{scale:M}=P.tileTransform,z=M*y.EXTENT/(P.tileSize*Math.pow(2,I.zoom-P.tileID.overscaledZ+P.tileID.canonical.z));return G=new Float32Array(4),ue=($=I.inverseAdjustmentMatrix)[1],fe=$[2],_e=$[3],Te=(te=[z,z])[1],G[0]=$[0]*(ye=te[0]),G[1]=ue*ye,G[2]=fe*Te,G[3]=_e*Te,G;var G,$,te,ue,fe,_e,ye,Te}(h,this);return T[_]=k,T[_]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const h=1/this.worldSize,_=y.fromScaling([],[h,h,h]);return y.multiply(_,_,this.globeMatrix),_}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const h=this._elevation;this._updateCameraState();const _=y.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,T=this._computeCameraPosition(_),k=this._camera.forward(),P=y.mercatorZfromAltitude(1,this._center.lat);T[2]/=P,k[2]/=P,y.normalize(k,k);const I=h.raycast(T,k,h.exaggeration());if(I){const M=y.scaleAndAdd([],T,k,I),z=new y.MercatorCoordinate(M[0],M[1],y.mercatorZfromAltitude(M[2],y.latFromMercatorY(M[1]))),G=(z.z+y.length([z.x-T[0],z.y-T[1],z.z-T[2]*P]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(G),this._centerAltitude=z.toAltitude(),this._center=this.coordinateLocation(z),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(h=!1){if(!this._elevation)return;const _=this._elevation,T=y.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,k=this._computeCameraPosition(T),P=_.getAtPointOrZero(new y.MercatorCoordinate(...k)),I=this.pixelsPerMeter/this.worldSize*P,M=this._minimumHeightOverTerrain(),z=k[2]-I;if(z<=M)if(z<0||h){const G=this.locationCoordinate(this._center,this._centerAltitude),$=[k[0],k[1],G.z-k[2]],te=y.length($);$[2]-=(M-z)/this._pixelsPerMercatorPixel;const ue=y.length($);if(0===ue)return;y.scale$2($,$,te/ue*this._pixelsPerMercatorPixel),this._camera.position=[k[0],k[1],G.z*this._pixelsPerMercatorPixel-$[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const h="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||h){const ue=this.center;return ue.lat=y.clamp(ue.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!h)&&(ue.lng=y.clamp(ue.lng,this.minLng,this.maxLng)),this.center=ue,void(this._constraining=!1)}const _=this._unmodified,{x:T,y:k}=this.point;let P=0,I=T,M=k;const z=this.width/2,G=this.height/2,$=this.worldMinY*this.scale,te=this.worldMaxY*this.scale;if(k-G<$&&(M=$+G),k+G>te&&(M=te-G),te-$<this.height&&(P=Math.max(P,this.height/(te-$)),M=(te+$)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ue=this.worldMinX*this.scale,fe=this.worldMaxX*this.scale,_e=this.worldSize/2-(ue+fe)/2;I=(T+_e+this.worldSize)%this.worldSize-_e,I-z<ue&&(I=ue+z),I+z>fe&&(I=fe-z),fe-ue<this.width&&(P=Math.max(P,this.width/(fe-ue)),I=(fe+ue)/2)}I===T&&M===k||(this.center=this.unproject(new y.pointGeometry(I,M))),P&&(this.zoom+=this.scaleZoom(P)),this._constrainCamera(),this._unmodified=_,this._constraining=!1}_minZoomForBounds(){let h=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(h=Math.max(h,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),h}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const h=this.centerOffset,_=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=y.mercatorZfromAltitude(1,this.center.lat)/y.mercatorZfromAltitude(1,y.GLOBE_SCALE_MATCH_LATITUDE));const T=El(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,T),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const k="meters"===this.projection.zAxisUnit?_:1,P=this._camera.getWorldToCamera(this.worldSize,k),I=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);I[8]=2*-h.x/this.width,I[9]=2*h.y/this.height;let M=y.mul([],I,P);if(this.projection.isReprojectedInTileSpace){const We=this.locationCoordinate(this.center),Xe=y.identity([]);y.translate(Xe,Xe,[We.x*this.worldSize,We.y*this.worldSize,0]),y.multiply(Xe,Xe,Pc(this)),y.translate(Xe,Xe,[-We.x*this.worldSize,-We.y*this.worldSize,0]),y.multiply(M,M,Xe),this.inverseAdjustmentMatrix=function(ut){const Et=Pc(ut,!0);return it([],[Et[0],Et[1],Et[4],Et[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=y.scale([],M,[this.worldSize,this.worldSize,this.worldSize/k,1]),this.projMatrix=M,this.invProjMatrix=y.invert(new Float64Array(16),this.projMatrix);const z=y.invert([],I);this.frustumCorners=y.FrustumCorners.fromInvProjectionMatrix(z,this.horizonLineFromTop(),this.height);const G=new Float32Array(16);y.identity(G),y.scale(G,G,[1,-1,1]),y.rotateX(G,G,this._pitch),y.rotateZ(G,G,this.angle);const $=y.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),te=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;$[8]=2*-h.x/this.width,$[9]=2*(h.y+te)/this.height,this.skyboxMatrix=y.multiply(G,$,G);const ue=this.point,fe=ue.x,_e=ue.y,ye=this.width%2/2,Te=this.height%2/2,de=Math.cos(this.angle),Oe=Math.sin(this.angle),Re=fe-Math.round(fe)+de*ye+Oe*Te,Fe=_e-Math.round(_e)+de*Te+Oe*ye,Ye=new Float64Array(M);if(y.translate(Ye,Ye,[Re>.5?Re-1:Re,Fe>.5?Fe-1:Fe,0]),this.alignedProjMatrix=Ye,M=y.create(),y.scale(M,M,[this.width/2,-this.height/2,1]),y.translate(M,M,[1,-1,0]),this.labelPlaneMatrix=M,M=y.create(),y.scale(M,M,[1,-1,1]),y.translate(M,M,[-1,-1,0]),y.scale(M,M,[2/this.width,2/this.height,1]),this.glCoordMatrix=M,this.pixelMatrix=y.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},M=y.invert(new Float64Array(16),this.pixelMatrix),!M)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=M,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=y.calculateGlobeMatrix(this);const We=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=y.transformMat4(We,We,P),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=M;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const h=this.cameraWorldSizeForFog,_=this.cameraPixelsPerMeter,T=this._camera.position,k=1/this.height/this._pixelsPerMercatorPixel,P=[h,h,_];y.scale$2(P,P,k),y.scale$2(T,T,-1),y.multiply$2(T,T,P);const I=y.create();y.translate(I,I,T),y.scale(I,I,P),this.mercatorFogMatrix=I,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(h,_,k)}_computeCameraPosition(h){const _=(h=h||this.pixelsPerMeter)/this.pixelsPerMeter,T=this._camera.forward(),k=this.point,P=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*_-h/this.worldSize*this._centerAltitude;return[k.x/this.worldSize-T[0]*P,k.y/this.worldSize-T[1]*P,h/this.worldSize*this._centerAltitude-T[2]*P]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(h){const _=this._maxCameraBoundsDistance()*Math.cos(this._pitch),T=this._camera.position[2],k=h[2];let P=1;this.projection.wrap&&(this.center=this.center.wrap()),k>0&&(P=Math.min((_-T)/k,1)),this._camera.position=y.scaleAndAdd([],this._camera.position,h,P),this._updateStateFromCamera()}_updateStateFromCamera(){const h=this._camera.position,_=this._camera.forward(),{pitch:T,bearing:k}=this._camera.getPitchBearing(),P=y.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,I=this._mercatorZfromZoom(this._maxZoom)*Math.cos(y.degToRad(this._maxPitch)),M=Math.max((h[2]-P)/Math.cos(T),I),z=this._zoomFromMercatorZ(M);y.scaleAndAdd(h,h,_,M),this._pitch=y.clamp(T,y.degToRad(this.minPitch),y.degToRad(this.maxPitch)),this.angle=y.wrap(k,-Math.PI,Math.PI),this._setZoom(y.clamp(z,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new y.MercatorCoordinate(h[0],h[1],h[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(h){return Math.pow(2,h)*this.tileSize}_mercatorZfromZoom(h){return this.cameraToCenterDistance/this._worldSizeFromZoom(h)}_minimumHeightOverTerrain(){const h=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(h)}_zoomFromMercatorZ(h){return this.scaleZoom(this.cameraToCenterDistance/(h*this.tileSize))}zoomFromMercatorZAdjusted(h){let _=0,T=y.GLOBE_ZOOM_THRESHOLD_MAX,k=0,P=1/0;for(;T-_>1e-6&&T>_;){const I=_+.5*(T-_),M=this.tileSize*Math.pow(2,I),z=this.getCameraToCenterDistance(this.projection,I,M),G=this.scaleZoom(z/(h*this.tileSize)),$=Math.abs(I-G);$<P&&(P=$,k=I),I<G?_=I:T=I}return k}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(y.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(h,_){const T=Math.min(h.x,_.x),k=Math.max(h.x,_.x),P=Math.min(h.y,_.y),I=Math.max(h.y,_.y);if(P<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const M=[new y.pointGeometry(T,P),new y.pointGeometry(k,I),new y.pointGeometry(T,I),new y.pointGeometry(k,P)],z=this.renderWorldCopies?-3:0,G=this.renderWorldCopies?4:1;for(const $ of M){const te=this.pointRayIntersection($);if(te.t<0)return!0;const ue=this.rayIntersectionCoordinate(te);if(ue.x<z||ue.y<0||ue.x>G||ue.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+y.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new y.pointGeometry(0,0),new y.pointGeometry(this.width,this.height))}zoomDeltaToMovement(h,_){const T=y.length(y.sub([],this._camera.position,h)),k=this._zoomFromMercatorZ(T)+_;return T-this._mercatorZfromZoom(k)}getCameraPoint(){if("globe"===this.projection.name){const h=function([_,T,k],P){const I=[_,T,k,1];y.transformMat4$1(I,I,P);const M=I[3]=Math.max(I[3],1e-6);return I[0]/=M,I[1]/=M,I[2]/=M,I}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new y.pointGeometry(h[0],h[1])}{const h=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new y.pointGeometry(0,h))}}getCameraToCenterDistance(h,_=this.zoom,T=this.worldSize){const k=El(h,_,this.width,this.height,1024),P=h.pixelSpaceConversion(this.center.lat,T,k);return.5/Math.tan(.5*this._fov)*this.height*P}getWorldToCameraMatrix(){const h=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&y.multiply(h,h,this.globeMatrix),h}}function _a(w,h){let _=!1,T=null;const k=()=>{T=null,_&&(w(),T=setTimeout(k,h),_=!1)};return()=>(_=!0,T||k(),T)}class uu{constructor(h){this._hashName=h&&encodeURIComponent(h),y.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=_a(this._updateHashUnthrottled.bind(this),300)}addTo(h){return this._map=h,y.window.addEventListener("hashchange",this._onHashChange,!1),h.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),y.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const h=this._map;if(!h)return"";const _=xh(h);if(this._hashName){const T=this._hashName;let k=!1;const P=y.window.location.hash.slice(1).split("&").map(I=>{const M=I.split("=")[0];return M===T?(k=!0,`${M}=${_}`):I}).filter(I=>I);return k||P.push(`${T}=${_}`),`#${P.join("&")}`}return`#${_}`}_getCurrentHash(){const h=y.window.location.hash.replace("#","");if(this._hashName){let _;return h.split("&").map(T=>T.split("=")).forEach(T=>{T[0]===this._hashName&&(_=T)}),(_&&_[1]||"").split("/")}return h.split("/")}_onHashChange(){const h=this._map;if(!h)return!1;const _=this._getCurrentHash();if(_.length>=3&&!_.some(T=>isNaN(T))){const T=h.dragRotate.isEnabled()&&h.touchZoomRotate.isEnabled()?+(_[3]||0):h.getBearing();return h.jumpTo({center:[+_[2],+_[1]],zoom:+_[0],bearing:T,pitch:+(_[4]||0)}),!0}return!1}_updateHashUnthrottled(){const h=y.window.location.href.replace(/(#.+)?$/,this.getHashString());y.window.history.replaceState(y.window.history.state,null,h)}}function xh(w,h){const _=w.getCenter(),T=Math.round(100*w.getZoom())/100,k=Math.ceil((T*Math.LN2+Math.log(512/360/.5))/Math.LN10),P=Math.pow(10,k),I=Math.round(_.lng*P)/P,M=Math.round(_.lat*P)/P,z=w.getBearing(),G=w.getPitch();let $=h?`/${I}/${M}/${T}`:`${T}/${M}/${I}`;return(z||G)&&($+="/"+Math.round(10*z)/10),G&&($+=`/${Math.round(G)}`),$}const nl={linearity:.3,easing:y.bezier(0,0,.3,1)},il=y.extend({deceleration:2500,maxSpeed:1400},nl),ec=y.extend({deceleration:20,maxSpeed:1400},nl),Tl=y.extend({deceleration:1e3,maxSpeed:360},nl),Ch=y.extend({deceleration:1e3,maxSpeed:90},nl);class La{constructor(h){this._map=h,this.clear()}clear(){this._inertiaBuffer=[]}record(h){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:y.exported.now(),settings:h})}_drainInertiaBuffer(){const h=this._inertiaBuffer,_=y.exported.now();for(;h.length>0&&_-h[0].time>160;)h.shift()}_onMoveEnd(h){if(y.exported.prefersReducedMotion||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const _={zoom:0,bearing:0,pitch:0,pan:new y.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:P}of this._inertiaBuffer)_.zoom+=P.zoomDelta||0,_.bearing+=P.bearingDelta||0,_.pitch+=P.pitchDelta||0,P.panDelta&&_.pan._add(P.panDelta),P.around&&(_.around=P.around),P.pinchAround&&(_.pinchAround=P.pinchAround);const T=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,k={};if(_.pan.mag()){const P=ws(_.pan.mag(),T,y.extend({},il,h||{}));k.offset=_.pan.mult(P.amount/_.pan.mag()),k.center=this._map.transform.center,Lc(k,P)}if(_.zoom){const P=ws(_.zoom,T,ec);k.zoom=this._map.transform.zoom+P.amount,Lc(k,P)}if(_.bearing){const P=ws(_.bearing,T,Tl);k.bearing=this._map.transform.bearing+y.clamp(P.amount,-179,179),Lc(k,P)}if(_.pitch){const P=ws(_.pitch,T,Ch);k.pitch=this._map.transform.pitch+P.amount,Lc(k,P)}if(k.zoom||k.bearing){const P=void 0===_.pinchAround?_.around:_.pinchAround;k.around=P?this._map.unproject(P):this._map.getCenter()}return this.clear(),k.noMoveStart=!0,k}}function Lc(w,h){(!w.duration||w.duration<h.duration)&&(w.duration=h.duration,w.easing=h.easing)}function ws(w,h,_){const{maxSpeed:T,linearity:k,deceleration:P}=_,I=y.clamp(w*k/(h/1e3),-T,T),M=Math.abs(I)/(P*k);return{easing:_.easing,duration:1e3*M,amount:I*(M/2)}}class us extends y.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,_,T,k={}){const P=st(_.getCanvasContainer(),T),I=_.unproject(P);super(h,y.extend({point:P,lngLat:I,originalEvent:T},k)),this._defaultPrevented=!1,this.target=_}}class Fa extends y.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,_,T){const k="touchend"===h?T.changedTouches:T.touches,P=Zt(_.getCanvasContainer(),k),I=P.map(z=>_.unproject(z)),M=P.reduce((z,G,$,te)=>z.add(G.div(te.length)),new y.pointGeometry(0,0));super(h,{points:P,point:M,lngLats:I,lngLat:_.unproject(M),originalEvent:T}),this._defaultPrevented=!1}}class Zu extends y.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,_,T){super(h,{originalEvent:T}),this._defaultPrevented=!1}}class cd{constructor(h,_){this._map=h,this._clickTolerance=_.clickTolerance}reset(){this._mousedownPos=void 0}wheel(h){return this._firePreventable(new Zu(h.type,this._map,h))}mousedown(h,_){return this._mousedownPos=_,this._firePreventable(new us(h.type,this._map,h))}mouseup(h){this._map.fire(new us(h.type,this._map,h))}preclick(h){const _=y.extend({},h);_.type="preclick",this._map.fire(new us(_.type,this._map,_))}click(h,_){this._mousedownPos&&this._mousedownPos.dist(_)>=this._clickTolerance||(this.preclick(h),this._map.fire(new us(h.type,this._map,h)))}dblclick(h){return this._firePreventable(new us(h.type,this._map,h))}mouseover(h){this._map.fire(new us(h.type,this._map,h))}mouseout(h){this._map.fire(new us(h.type,this._map,h))}touchstart(h){return this._firePreventable(new Fa(h.type,this._map,h))}touchmove(h){this._map.fire(new Fa(h.type,this._map,h))}touchend(h){this._map.fire(new Fa(h.type,this._map,h))}touchcancel(h){this._map.fire(new Fa(h.type,this._map,h))}_firePreventable(h){if(this._map.fire(h),h.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class hu{constructor(h){this._map=h}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(h){this._map.fire(new us(h.type,this._map,h))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new us("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(h){this._delayContextMenu?this._contextMenuEvent=h:this._map.fire(new us(h.type,this._map,h)),this._map.listens("contextmenu")&&h.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Eh{constructor(h,_){this._map=h,this._el=h.getCanvasContainer(),this._container=h.getContainer(),this._clickTolerance=_.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(h,_){this.isEnabled()&&h.shiftKey&&0===h.button&&(Je(),this._startPos=this._lastPos=_,this._active=!0)}mousemoveWindow(h,_){if(!this._active)return;const T=_,k=this._startPos,P=this._lastPos;if(!k||!P||P.equals(T)||!this._box&&T.dist(k)<this._clickTolerance)return;this._lastPos=T,this._box||(this._box=nt("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",h));const I=Math.min(k.x,T.x),M=Math.max(k.x,T.x),z=Math.min(k.y,T.y),G=Math.max(k.y,T.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${I}px,${z}px)`,this._box.style.width=M-I+"px",this._box.style.height=G-z+"px")})}mouseupWindow(h,_){if(!this._active)return;const T=this._startPos,k=_;if(T&&0===h.button){if(this.reset(),Jt(),T.x!==k.x||T.y!==k.y)return this._map.fire(new y.Event("boxzoomend",{originalEvent:h})),{cameraAnimation:P=>P.fitScreenCoordinates(T,k,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",h)}}keydown(h){this._active&&27===h.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",h))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),dt(),delete this._startPos,delete this._lastPos}_fireEvent(h,_){return this._map.fire(new y.Event(h,{originalEvent:_}))}}function du(w,h){const _={};for(let T=0;T<w.length;T++)_[w[T].identifier]=h[T];return _}class Kd{constructor(h){this.reset(),this.numTouches=h.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(h,_,T){(this.centroid||T.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=h.timeStamp),T.length===this.numTouches&&(this.centroid=function(k){const P=new y.pointGeometry(0,0);for(const I of k)P._add(I);return P.div(k.length)}(_),this.touches=du(T,_)))}touchmove(h,_,T){if(this.aborted||!this.centroid)return;const k=du(T,_);for(const P in this.touches){const M=k[P];(!M||M.dist(this.touches[P])>30)&&(this.aborted=!0)}}touchend(h,_,T){if((!this.centroid||h.timeStamp-this.startTime>500)&&(this.aborted=!0),0===T.length){const k=!this.aborted&&this.centroid;if(this.reset(),k)return k}}}class tc{constructor(h){this.singleTap=new Kd(h),this.numTaps=h.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(h,_,T){this.singleTap.touchstart(h,_,T)}touchmove(h,_,T){this.singleTap.touchmove(h,_,T)}touchend(h,_,T){const k=this.singleTap.touchend(h,_,T);if(k){const P=h.timeStamp-this.lastTime<500,I=!this.lastTap||this.lastTap.dist(k)<30;if(P&&I||this.reset(),this.count++,this.lastTime=h.timeStamp,this.lastTap=k,this.count===this.numTaps)return this.reset(),k}}}class qu{constructor(){this._zoomIn=new tc({numTouches:1,numTaps:2}),this._zoomOut=new tc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(h,_,T){this._zoomIn.touchstart(h,_,T),this._zoomOut.touchstart(h,_,T)}touchmove(h,_,T){this._zoomIn.touchmove(h,_,T),this._zoomOut.touchmove(h,_,T)}touchend(h,_,T){const k=this._zoomIn.touchend(h,_,T),P=this._zoomOut.touchend(h,_,T);return k?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()+1,around:I.unproject(k)},{originalEvent:h})}):P?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()-1,around:I.unproject(P)},{originalEvent:h})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Na={0:1,2:2};class ud{constructor(h){this.reset(),this._clickTolerance=h.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(h,_){return!1}_move(h,_){return{}}mousedown(h,_){if(this._lastPoint)return;const T=nn(h);this._correctButton(h,T)&&(this._lastPoint=_,this._eventButton=T)}mousemoveWindow(h,_){const T=this._lastPoint;if(T)if(h.preventDefault(),null!=this._eventButton&&function(k,P){const I=Na[P];return void 0===k.buttons||(k.buttons&I)!==I}(h,this._eventButton))this.reset();else if(this._moved||!(_.dist(T)<this._clickTolerance))return this._moved=!0,this._lastPoint=_,this._move(T,_)}mouseupWindow(h){this._lastPoint&&nn(h)===this._eventButton&&(this._moved&&Jt(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fc extends ud{mousedown(h,_){super.mousedown(h,_),this._lastPoint&&(this._active=!0)}_correctButton(h,_){return 0===_&&!h.ctrlKey}_move(h,_){return{around:_,panDelta:_.sub(h)}}}class za extends ud{_correctButton(h,_){return 0===_&&h.ctrlKey||2===_}_move(h,_){const T=.8*(_.x-h.x);if(T)return this._active=!0,{bearingDelta:T}}contextmenu(h){h.preventDefault()}}class hd extends ud{_correctButton(h,_){return 0===_&&h.ctrlKey||2===_}_move(h,_){const T=-.5*(_.y-h.y);if(T)return this._active=!0,{pitchDelta:T}}contextmenu(h){h.preventDefault()}}class Nc{constructor(h,_){this._map=h,this._el=h.getCanvasContainer(),this._minTouches=1,this._clickTolerance=_.clickTolerance||1,this.reset(),y.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new y.pointGeometry(0,0)}touchstart(h,_,T){return this._calculateTransform(h,_,T)}touchmove(h,_,T){if(this._active&&!(T.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===T.length&&!y.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return h.cancelable&&h.preventDefault(),this._calculateTransform(h,_,T)}}touchend(h,_,T){this._calculateTransform(h,_,T),this._active&&T.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(h,_,T){T.length>0&&(this._active=!0);const k=du(T,_),P=new y.pointGeometry(0,0),I=new y.pointGeometry(0,0);let M=0;for(const G in k){const $=k[G],te=this._touches[G];te&&(P._add($),I._add($.sub(te)),M++,k[G]=$)}if(this._touches=k,M<this._minTouches||!I.mag())return;const z=I.div(M);return this._sum._add(z),this._sum.mag()<this._clickTolerance?void 0:{around:P.div(M),panDelta:z}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=nt("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Ks{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(h){}_move(h,_,T){return{}}touchstart(h,_,T){this._firstTwoTouches||T.length<2||(this._firstTwoTouches=[T[0].identifier,T[1].identifier],this._start([_[0],_[1]]))}touchmove(h,_,T){const k=this._firstTwoTouches;if(!k)return;h.preventDefault();const[P,I]=k,M=Sa(T,_,P),z=Sa(T,_,I);if(!M||!z)return;const G=this._aroundCenter?null:M.add(z).div(2);return this._move([M,z],G,h)}touchend(h,_,T){if(!this._firstTwoTouches)return;const[k,P]=this._firstTwoTouches,I=Sa(T,_,k),M=Sa(T,_,P);I&&M||(this._active&&Jt(),this.reset())}touchcancel(){this.reset()}enable(h){this._enabled=!0,this._aroundCenter=!!h&&"center"===h.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Sa(w,h,_){for(let T=0;T<w.length;T++)if(w[T].identifier===_)return h[T]}function If(w,h){return Math.log(w/h)/Math.LN2}class dd extends Ks{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(h){this._startDistance=this._distance=h[0].dist(h[1])}_move(h,_){const T=this._distance;if(this._distance=h[0].dist(h[1]),this._active||!(Math.abs(If(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:If(this._distance,T),pinchAround:_}}}function zc(w,h){return 180*w.angleWith(h)/Math.PI}class Np extends Ks{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(h){this._startVector=this._vector=h[0].sub(h[1]),this._minDiameter=h[0].dist(h[1])}_move(h,_){const T=this._vector;if(this._vector=h[0].sub(h[1]),T&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:zc(this._vector,T),pinchAround:_}}_isBelowThreshold(h){this._minDiameter=Math.min(this._minDiameter,h.mag());const _=25/(Math.PI*this._minDiameter)*360,T=this._startVector;if(!T)return!1;const k=zc(h,T);return Math.abs(k)<_}}function Ku(w){return Math.abs(w.y)>Math.abs(w.x)}class Ls extends Ks{constructor(h){super(),this._map=h}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(h){this._lastPoints=h,Ku(h[0].sub(h[1]))&&(this._valid=!1)}_move(h,_,T){const k=this._lastPoints;if(!k)return;const P=h[0].sub(k[0]),I=h[1].sub(k[1]);return this._map._cooperativeGestures&&!y.isFullscreen()&&T.touches.length<3||(this._valid=this.gestureBeginsVertically(P,I,T.timeStamp),!this._valid)?void 0:(this._lastPoints=h,this._active=!0,{pitchDelta:(P.y+I.y)/2*-.5})}gestureBeginsVertically(h,_,T){if(void 0!==this._valid)return this._valid;const k=h.mag()>=2,P=_.mag()>=2;if(!k&&!P)return;if(!k||!P)return null==this._firstMove&&(this._firstMove=T),T-this._firstMove<100&&void 0;const I=h.y>0==_.y>0;return Ku(h)&&Ku(_)&&I}}const Bc={panStep:100,bearingStep:15,pitchStep:10};class Th{constructor(){const h=Bc;this._panStep=h.panStep,this._bearingStep=h.bearingStep,this._pitchStep=h.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(h){if(h.altKey||h.ctrlKey||h.metaKey)return;let _=0,T=0,k=0,P=0,I=0;switch(h.keyCode){case 61:case 107:case 171:case 187:_=1;break;case 189:case 109:case 173:_=-1;break;case 37:h.shiftKey?T=-1:(h.preventDefault(),P=-1);break;case 39:h.shiftKey?T=1:(h.preventDefault(),P=1);break;case 38:h.shiftKey?k=1:(h.preventDefault(),I=-1);break;case 40:h.shiftKey?k=-1:(h.preventDefault(),I=1);break;default:return}return this._rotationDisabled&&(T=0,k=0),{cameraAnimation:M=>{const z=M.getZoom();M.easeTo({duration:300,easeId:"keyboardHandler",easing:Yu,zoom:_?Math.round(z)+_*(h.shiftKey?2:1):z,bearing:M.getBearing()+T*this._bearingStep,pitch:M.getPitch()+k*this._pitchStep,offset:[-P*this._panStep,-I*this._panStep],center:M.getCenter()},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Yu(w){return w*(2-w)}const Yd=4.000244140625;class Sl{constructor(h,_){this._map=h,this._el=h.getCanvasContainer(),this._handler=_,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,y.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(h){this._defaultZoomRate=h}setWheelZoomRate(h){this._wheelZoomRate=h}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(h){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!h&&"center"===h.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(h){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(h.ctrlKey||h.metaKey||this.isZooming()||y.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let _=h.deltaMode===y.window.WheelEvent.DOM_DELTA_LINE?40*h.deltaY:h.deltaY;const T=y.exported.now(),k=T-(this._lastWheelEventTime||0);this._lastWheelEventTime=T,0!==_&&_%Yd==0?this._type="wheel":0!==_&&Math.abs(_)<4?this._type="trackpad":k>400?(this._type=null,this._lastValue=_,this._timeout=setTimeout(this._onTimeout,40,h)):this._type||(this._type=Math.abs(k*_)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,_+=this._lastValue)),h.shiftKey&&_&&(_/=4),this._type&&(this._lastWheelEvent=h,this._delta-=_,this._active||this._start(h)),h.preventDefault()}_onTimeout(h){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(h)}_start(h){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const _=st(this._el,h);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:_,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const h=this._map.transform;"wheel"===this._type&&h.projection.wrap&&(h._center.lng>=180||h._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const _=()=>h._terrainEnabled()&&this._aroundCoord?h.computeZoomRelativeTo(this._aroundCoord):h.zoom;if(0!==this._delta){const z="wheel"===this._type&&Math.abs(this._delta)>Yd?this._wheelZoomRate:this._defaultZoomRate;let G=2/(1+Math.exp(-Math.abs(this._delta*z)));this._delta<0&&0!==G&&(G=1/G);const $=_(),te=Math.pow(2,$),ue="number"==typeof this._targetZoom?h.zoomScale(this._targetZoom):te;this._targetZoom=Math.min(h.maxZoom,Math.max(h.minZoom,h.scaleZoom(ue*G))),"wheel"===this._type&&(this._startZoom=$,this._easing=this._smoothOutEasing(200)),this._delta=0}const T="number"==typeof this._targetZoom?this._targetZoom:_(),k=this._startZoom,P=this._easing;let I,M=!1;if("wheel"===this._type&&k&&P){const z=Math.min((y.exported.now()-this._lastWheelEventTime)/200,1),G=P(z);I=y.number(k,T,G),z<1?this._frameId||(this._frameId=!0):M=!0}else I=T,M=!0;return this._active=!0,M&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!M,zoomDelta:I-_(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(h){let _=y.ease;if(this._prevEase){const T=this._prevEase,k=(y.exported.now()-T.start)/T.duration,P=T.easing(k+.01)-T.easing(k),I=.27/Math.sqrt(P*P+1e-4)*.01,M=Math.sqrt(.0729-I*I);_=y.bezier(I,M,.25,1)}return this._prevEase={start:y.exported.now(),duration:h,easing:_},_}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=nt("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(y.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Ju{constructor(h,_){this._clickZoom=h,this._tapZoom=_}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Qu{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(h,_){return h.preventDefault(),{cameraAnimation:T=>{T.easeTo({duration:300,zoom:T.getZoom()+(h.shiftKey?-1:1),around:T.unproject(_)},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vc{constructor(){this._tap=new tc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(h,_,T){this._swipePoint||(this._tapTime&&h.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?T.length>0&&(this._swipePoint=_[0],this._swipeTouch=T[0].identifier):this._tap.touchstart(h,_,T))}touchmove(h,_,T){if(this._tapTime){if(this._swipePoint){if(T[0].identifier!==this._swipeTouch)return;const k=_[0],P=k.y-this._swipePoint.y;return this._swipePoint=k,h.preventDefault(),this._active=!0,{zoomDelta:P/128}}}else this._tap.touchmove(h,_,T)}touchend(h,_,T){this._tapTime?this._swipePoint&&0===T.length&&this.reset():this._tap.touchend(h,_,T)&&(this._tapTime=h.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Cr{constructor(h,_,T){this._el=h,this._mousePan=_,this._touchPan=T}enable(h){this._inertiaOptions=h||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Rn{constructor(h,_,T){this._pitchWithRotate=h.pitchWithRotate,this._mouseRotate=_,this._mousePitch=T}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Jd{constructor(h,_,T,k){this._el=h,this._touchZoom=_,this._touchRotate=T,this._tapDragZoom=k,this._rotationDisabled=!1,this._enabled=!0}enable(h){this._touchZoom.enable(h),this._rotationDisabled||this._touchRotate.enable(h),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const pd=w=>w.zoom||w.drag||w.pitch||w.rotate;class Uc extends y.Event{}class nc{constructor(){this.constants=[1,1,.01],this.radius=0}setup(h,_){const T=y.sub([],_,h);this.radius=y.length(T[2]<0?y.div([],T,this.constants):[T[0],T[1],0])}projectRay(h){y.div(h,h,this.constants),y.normalize(h,h),y.mul$1(h,h,this.constants);const _=y.scale$2([],h,this.radius);if(_[2]>0){const T=y.scale$2([],[0,0,1],y.dot(_,[0,0,1])),k=y.scale$2([],y.normalize([],[_[0],_[1],0]),this.radius),P=y.add([],_,y.scale$2([],y.sub([],y.add([],k,T),_),2));_[0]=P[0],_[1]=P[1]}return _}}function Sh(w){return w.panDelta&&w.panDelta.mag()||w.zoomDelta||w.bearingDelta||w.pitchDelta}class Df{constructor(h,_){this._map=h,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new La(h),this._bearingSnap=_.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new nc,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(_),y.bindAll(["handleEvent","handleWindowEvent"],this);const T=this._el;this._listeners=[[T,"touchstart",{passive:!0}],[T,"touchmove",{passive:!1}],[T,"touchend",void 0],[T,"touchcancel",void 0],[T,"mousedown",void 0],[T,"mousemove",void 0],[T,"mouseup",void 0],[y.window.document,"mousemove",{capture:!0}],[y.window.document,"mouseup",void 0],[T,"mouseover",void 0],[T,"mouseout",void 0],[T,"dblclick",void 0],[T,"click",void 0],[T,"keydown",{capture:!1}],[T,"keyup",void 0],[T,"wheel",{passive:!1}],[T,"contextmenu",void 0],[y.window,"blur",void 0]];for(const[k,P,I]of this._listeners)k.addEventListener(P,k===y.window.document?this.handleWindowEvent:this.handleEvent,I)}destroy(){for(const[h,_,T]of this._listeners)h.removeEventListener(_,h===y.window.document?this.handleWindowEvent:this.handleEvent,T)}_addDefaultHandlers(h){const _=this._map,T=_.getCanvasContainer();this._add("mapEvent",new cd(_,h));const k=_.boxZoom=new Eh(_,h);this._add("boxZoom",k);const P=new qu,I=new Qu;_.doubleClickZoom=new Ju(I,P),this._add("tapZoom",P),this._add("clickZoom",I);const M=new Vc;this._add("tapDragZoom",M);const z=_.touchPitch=new Ls(_);this._add("touchPitch",z);const G=new za(h),$=new hd(h);_.dragRotate=new Rn(h,G,$),this._add("mouseRotate",G,["mousePitch"]),this._add("mousePitch",$,["mouseRotate"]);const te=new Fc(h),ue=new Nc(_,h);_.dragPan=new Cr(T,te,ue),this._add("mousePan",te),this._add("touchPan",ue,["touchZoom","touchRotate"]);const fe=new Np,_e=new dd;_.touchZoomRotate=new Jd(T,_e,fe,M),this._add("touchRotate",fe,["touchPan","touchZoom"]),this._add("touchZoom",_e,["touchPan","touchRotate"]),this._add("blockableMapEvent",new hu(_));const ye=_.scrollZoom=new Sl(_,this);this._add("scrollZoom",ye,["mousePan"]);const Te=_.keyboard=new Th;this._add("keyboard",Te);for(const de of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])h.interactive&&h[de]&&_[de].enable(h[de])}_add(h,_,T){this._handlers.push({handlerName:h,handler:_,allowed:T}),this._handlersById[h]=_}stop(h){if(!this._updatingCamera){for(const{handler:_}of this._handlers)_.reset();this._inertia.clear(),this._fireEvents({},{},h),this._changes=[]}}isActive(){for(const{handler:h}of this._handlers)if(h.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!pd(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(h,_,T){for(const k in h)if(k!==T&&(!_||_.indexOf(k)<0))return!0;return!1}handleWindowEvent(h){this.handleEvent(h,`${h.type}Window`)}_getMapTouches(h){const _=[];for(const T of h)this._el.contains(T.target)&&_.push(T);return _}handleEvent(h,_){this._updatingCamera=!0;const T="renderFrame"===h.type,k=T?void 0:h,P={needsRenderFrame:!1},I={},M={},z=h.touches?this._getMapTouches(h.touches):void 0,G=z?Zt(this._el,z):T?void 0:st(this._el,h);for(const{handlerName:ue,handler:fe,allowed:_e}of this._handlers){if(!fe.isEnabled())continue;let ye;this._blockedByActive(M,_e,ue)?fe.reset():fe[_||h.type]&&(ye=fe[_||h.type](h,G,z),this.mergeHandlerResult(P,I,ye,ue,k),ye&&ye.needsRenderFrame&&this._triggerRenderFrame()),(ye||fe.isActive())&&(M[ue]=fe)}const $={};for(const ue in this._previousActiveHandlers)M[ue]||($[ue]=k);this._previousActiveHandlers=M,(Object.keys($).length||Sh(P))&&(this._changes.push([P,I,$]),this._triggerRenderFrame()),(Object.keys(M).length||Sh(P))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:te}=P;te&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],te(this._map))}mergeHandlerResult(h,_,T,k,P){if(!T)return;y.extend(h,T);const I={handlerName:k,originalEvent:T.originalEvent||P};void 0!==T.zoomDelta&&(_.zoom=I),void 0!==T.panDelta&&(_.drag=I),void 0!==T.pitchDelta&&(_.pitch=I),void 0!==T.bearingDelta&&(_.rotate=I)}_applyChanges(){const h={},_={},T={};for(const[k,P,I]of this._changes)k.panDelta&&(h.panDelta=(h.panDelta||new y.pointGeometry(0,0))._add(k.panDelta)),k.zoomDelta&&(h.zoomDelta=(h.zoomDelta||0)+k.zoomDelta),k.bearingDelta&&(h.bearingDelta=(h.bearingDelta||0)+k.bearingDelta),k.pitchDelta&&(h.pitchDelta=(h.pitchDelta||0)+k.pitchDelta),void 0!==k.around&&(h.around=k.around),void 0!==k.aroundCoord&&(h.aroundCoord=k.aroundCoord),void 0!==k.pinchAround&&(h.pinchAround=k.pinchAround),k.noInertia&&(h.noInertia=k.noInertia),y.extend(_,P),y.extend(T,I);this._updateMapTransform(h,_,T),this._changes=[]}_updateMapTransform(h,_,T){const k=this._map,P=k.transform,I=Oe=>[Oe.x,Oe.y,Oe.z];if((Oe=>{const Re=this._eventsInProgress.drag;return Re&&!this._handlersById[Re.handlerName].isActive()})()&&!Sh(h)){const Oe=P.zoom;P.cameraElevationReference="sea",P.recenterOnTerrain(),P.cameraElevationReference="ground",Oe!==P.zoom&&this._map._update(!0)}if(P._isCameraConstrained&&k._stop(!0),!Sh(h))return void this._fireEvents(_,T,!0);let{panDelta:M,zoomDelta:z,bearingDelta:G,pitchDelta:$,around:te,aroundCoord:ue,pinchAround:fe}=h;P._isCameraConstrained&&(z>0&&(z=0),P._isCameraConstrained=!1),void 0!==fe&&(te=fe),(z||(Oe=>_.drag&&!this._eventsInProgress.drag)())&&te&&(this._dragOrigin=I(P.pointCoordinate3D(te)),this._trackingEllipsoid.setup(P._camera.position,this._dragOrigin)),P.cameraElevationReference="sea",k._stop(!0),te=te||k.transform.centerPoint,G&&(P.bearing+=G),$&&(P.pitch+=$),P._updateCameraState();const _e=[0,0,0];if(M)if("mercator"===P.projection.name){const Oe=this._trackingEllipsoid.projectRay(P.screenPointToMercatorRay(te).dir),Re=this._trackingEllipsoid.projectRay(P.screenPointToMercatorRay(te.sub(M)).dir);_e[0]=Re[0]-Oe[0],_e[1]=Re[1]-Oe[1]}else{const Oe=P.pointCoordinate(te);if("globe"===P.projection.name){M=M.rotate(-P.angle);const Re=P._pixelsPerMercatorPixel/P.worldSize;_e[0]=-M.x*y.mercatorScale(y.latFromMercatorY(Oe.y))*Re,_e[1]=-M.y*y.mercatorScale(P.center.lat)*Re}else{const Re=P.pointCoordinate(te.sub(M));Oe&&Re&&(_e[0]=Re.x-Oe.x,_e[1]=Re.y-Oe.y)}}const ye=P.zoom,Te=[0,0,0];if(z){const Oe=I(ue||P.pointCoordinate3D(te)),Re={dir:y.normalize([],y.sub([],Oe,P._camera.position))};if(Re.dir[2]<0){const Fe=P.zoomDeltaToMovement(Oe,z);y.scale$2(Te,Re.dir,Fe)}}const de=y.add(_e,_e,Te);P._translateCameraConstrained(de),z&&Math.abs(P.zoom-ye)>1e-4&&P.recenterOnTerrain(),P.cameraElevationReference="ground",this._map._update(),h.noInertia||this._inertia.record(h),this._fireEvents(_,T,!0)}_fireEvents(h,_,T){const k=pd(this._eventsInProgress),P=pd(h),I={};for(const $ in h){const{originalEvent:te}=h[$];this._eventsInProgress[$]||(I[`${$}start`]=te),this._eventsInProgress[$]=h[$]}!k&&P&&this._fireEvent("movestart",P.originalEvent);for(const $ in I)this._fireEvent($,I[$]);P&&this._fireEvent("move",P.originalEvent);for(const $ in h){const{originalEvent:te}=h[$];this._fireEvent($,te)}const M={};let z;for(const $ in this._eventsInProgress){const{handlerName:te,originalEvent:ue}=this._eventsInProgress[$];this._handlersById[te].isActive()||(delete this._eventsInProgress[$],z=_[te]||ue,M[`${$}end`]=z)}for(const $ in M)this._fireEvent($,M[$]);const G=pd(this._eventsInProgress);if(T&&(k||P)&&!G){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),te=ue=>0!==ue&&-this._bearingSnap<ue&&ue<this._bearingSnap;$?(te($.bearing||this._map.getBearing())&&($.bearing=0),this._map.easeTo($,{originalEvent:z})):(this._map.fire(new y.Event("moveend",{originalEvent:z})),te(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(h,_){this._map.fire(new y.Event(h,_?{originalEvent:_}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(h=>{this._frameId=void 0,this.handleEvent(new Uc("renderFrame",{timeStamp:h})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const ic="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Af extends y.Evented{constructor(h,_){super(),this._moving=!1,this._zooming=!1,this.transform=h,this._bearingSnap=_.bearingSnap,y.bindAll(["_renderFrameCallback"],this)}getCenter(){return new y.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(h,_){return this.jumpTo({center:h},_)}panBy(h,_,T){return h=y.pointGeometry.convert(h).mult(-1),this.panTo(this.transform.center,y.extend({offset:h},_),T)}panTo(h,_,T){return this.easeTo(y.extend({center:h},_),T)}getZoom(){return this.transform.zoom}setZoom(h,_){return this.jumpTo({zoom:h},_),this}zoomTo(h,_,T){return this.easeTo(y.extend({zoom:h},_),T)}zoomIn(h,_){return this.zoomTo(this.getZoom()+1,h,_),this}zoomOut(h,_){return this.zoomTo(this.getZoom()-1,h,_),this}getBearing(){return this.transform.bearing}setBearing(h,_){return this.jumpTo({bearing:h},_),this}getPadding(){return this.transform.padding}setPadding(h,_){return this.jumpTo({padding:h},_),this}rotateTo(h,_,T){return this.easeTo(y.extend({bearing:h},_),T)}resetNorth(h,_){return this.rotateTo(0,y.extend({duration:1e3},h),_),this}resetNorthPitch(h,_){return this.easeTo(y.extend({bearing:0,pitch:0,duration:1e3},h),_),this}snapToNorth(h,_){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(h,_):this}getPitch(){return this.transform.pitch}setPitch(h,_){return this.jumpTo({pitch:h},_),this}cameraForBounds(h,_){h=y.LngLatBounds.convert(h);const T=_&&_.bearing||0,k=_&&_.pitch||0,P=h.getNorthWest(),I=h.getSouthEast();return this._cameraForBounds(this.transform,P,I,T,k,_)}_extendCameraOptions(h){const _={top:0,bottom:0,right:0,left:0};if("number"==typeof(h=y.extend({padding:_,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding){const T=h.padding;h.padding={top:T,bottom:T,right:T,left:T}}return h.padding=y.extend(_,h.padding),h}_minimumAABBFrustumDistance(h,_){const T=_.max[0]-_.min[0],k=_.max[1]-_.min[1];return T/k>h.aspect?T/(2*Math.tan(.5*h.fovX)*h.aspect):k/(2*Math.tan(.5*h.fovY)*h.aspect)}_cameraForBoundsOnGlobe(h,_,T,k,P,I){const M=h.clone(),z=this._extendCameraOptions(I);M.bearing=k,M.pitch=P;const G=y.LngLat.convert(_),$=y.LngLat.convert(T),te=.5*(G.lat+$.lat),ue=.5*(G.lng+$.lng),fe=y.latLngToECEF(te,ue),_e=y.normalize([],fe),ye=y.normalize([],y.cross([],_e,[0,1,0])),Te=y.cross([],ye,_e),de=[ye[0],ye[1],ye[2],0,Te[0],Te[1],Te[2],0,_e[0],_e[1],_e[2],0,0,0,0,1],Oe=[fe,y.latLngToECEF(G.lat,G.lng),y.latLngToECEF($.lat,G.lng),y.latLngToECEF($.lat,$.lng),y.latLngToECEF(G.lat,$.lng),y.latLngToECEF(te,G.lng),y.latLngToECEF(te,$.lng),y.latLngToECEF(G.lat,ue),y.latLngToECEF($.lat,ue)];let Re=y.Aabb.fromPoints(Oe.map(tn=>[y.dot(ye,tn),y.dot(Te,tn),y.dot(_e,tn)]));const Fe=y.transformMat4([],Re.center,de);0===y.squaredLength(Fe)&&y.set(Fe,0,0,1),y.normalize(Fe,Fe),y.scale$2(Fe,Fe,y.GLOBE_RADIUS),M.center=y.ecefToLatLng(Fe);const Ye=M.getWorldToCameraMatrix(),We=y.invert(new Float64Array(16),Ye);Re=y.Aabb.applyTransform(Re,y.multiply([],Ye,de)),y.transformMat4(Fe,Fe,Ye);const Xe=.5*(Re.max[2]-Re.min[2]),ut=this._minimumAABBFrustumDistance(M,Re),Et=y.scale$2([],[0,0,1],Xe),At=y.add(Et,Fe,Et),on=ut+(0===M.pitch?0:y.distance(Fe,At)),wt=M.globeCenterInViewSpace,qt=y.sub([],Fe,[wt[0],wt[1],wt[2]]);y.normalize(qt,qt),y.scale$2(qt,qt,on);const Nt=y.add([],Fe,qt);y.transformMat4(Nt,Nt,We);const sn=y.earthRadius/y.GLOBE_RADIUS,Tt=y.length(Nt),yt=y.mercatorZfromAltitude(Math.max(Tt*sn-y.earthRadius,Number.EPSILON),0),Pt=Math.min(M.zoomFromMercatorZAdjusted(yt),z.maxZoom);return Pt>.5*(y.GLOBE_ZOOM_THRESHOLD_MIN+y.GLOBE_ZOOM_THRESHOLD_MAX)?(M.setProjection({name:"mercator"}),M.zoom=Pt,this._cameraForBounds(M,_,T,k,P,I)):{center:M.center,zoom:Pt,bearing:k,pitch:P}}queryTerrainElevation(h,_){const T=this.transform.elevation;return T?(_=y.extend({},{exaggerated:!0},_),T.getAtPoint(y.MercatorCoordinate.fromLngLat(h),null,_.exaggerated)):null}_cameraForBounds(h,_,T,k,P,I){if("globe"===h.projection.name)return this._cameraForBoundsOnGlobe(h,_,T,k,P,I);const M=h.clone(),z=this._extendCameraOptions(I),G=M.padding;M.bearing=k,M.pitch=P;const $=y.LngLat.convert(_),te=y.LngLat.convert(T),ue=new y.LngLat($.lng,te.lat),fe=new y.LngLat(te.lng,$.lat),_e=M.project($),ye=M.project(te),Te=this.queryTerrainElevation($),de=this.queryTerrainElevation(te),Oe=this.queryTerrainElevation(ue),Re=this.queryTerrainElevation(fe),Fe=[[_e.x,_e.y,Math.min(Te||0,de||0,Oe||0,Re||0)],[ye.x,ye.y,Math.max(Te||0,de||0,Oe||0,Re||0)]];let Ye=y.Aabb.fromPoints(Fe);const We=M.getWorldToCameraMatrix(),Xe=y.invert(new Float64Array(16),We);Ye=y.Aabb.applyTransform(Ye,We);const ut=y.sub([],Ye.max,Ye.min),Et=G.left||0,At=G.right||0,on=G.bottom||0,wt=G.top||0,{left:qt,right:Nt,top:sn,bottom:Tt}=z.padding,yt=.5*(Et+At),Pt=.5*(wt+on),tn=Math.min(M.scaleZoom(M.scale*Math.min((M.width-(Et+At+qt+Nt))/ut[0],(M.height-(on+wt+Tt+sn))/ut[1])),z.maxZoom),hn=M.scale/M.zoomScale(tn);Ye=new y.Aabb([Ye.min[0]-(qt+yt)*hn,Ye.min[1]-(Tt+Pt)*hn,Ye.min[2]],[Ye.max[0]+(Nt+yt)*hn,Ye.max[1]+(sn+Pt)*hn,Ye.max[2]]);const $n=.5*ut[2],ki=this._minimumAABBFrustumDistance(M,Ye),Gn=[0,0,1,0];y.transformMat4$1(Gn,Gn,We),y.normalize$2(Gn,Gn);const On=y.scale$2([],Gn,ki+$n),Jn=y.add([],Ye.center,On),sr=("number"==typeof z.offset.x&&"number"==typeof z.offset.y?new y.pointGeometry(z.offset.x,z.offset.y):y.pointGeometry.convert(z.offset)).rotate(-y.degToRad(k));Ye.center[0]-=sr.x*hn,Ye.center[1]+=sr.y*hn,y.transformMat4(Ye.center,Ye.center,Xe),y.transformMat4(Jn,Jn,Xe);const hi=[Ye.center[0],Ye.center[1],Jn[2]*M.pixelsPerMeter];y.scale$2(hi,hi,1/M.worldSize);const Lr=y.lngFromMercatorX(hi[0]),Hr=y.latFromMercatorY(hi[1]),Xr=Math.min(M._zoomFromMercatorZ(hi[2]),z.maxZoom),Kr=new y.LngLat(Lr,Hr);return M.mercatorFromTransition&&Xr<.5*(y.GLOBE_ZOOM_THRESHOLD_MIN+y.GLOBE_ZOOM_THRESHOLD_MAX)?(M.setProjection({name:"globe"}),M.zoom=Xr,this._cameraForBounds(M,_,T,k,P,I)):{center:Kr,zoom:Xr,bearing:k,pitch:P}}fitBounds(h,_,T){const k=this.cameraForBounds(h,_);return this._fitInternal(k,_,T)}fitScreenCoordinates(h,_,T,k,P){const I=y.pointGeometry.convert(h),M=y.pointGeometry.convert(_),z=new y.pointGeometry(Math.min(I.x,M.x),Math.min(I.y,M.y)),G=new y.pointGeometry(Math.max(I.x,M.x),Math.max(I.y,M.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(I,M))return this;const $=this.transform.pointLocation3D(z),te=this.transform.pointLocation3D(G),ue=this.transform.pointLocation3D(new y.pointGeometry(z.x,G.y)),fe=this.transform.pointLocation3D(new y.pointGeometry(G.x,z.y)),_e=[Math.min($.lng,te.lng,ue.lng,fe.lng),Math.min($.lat,te.lat,ue.lat,fe.lat)],ye=[Math.max($.lng,te.lng,ue.lng,fe.lng),Math.max($.lat,te.lat,ue.lat,fe.lat)],Te=k&&k.pitch?k.pitch:this.getPitch(),de=this._cameraForBounds(this.transform,_e,ye,T,Te,k);return this._fitInternal(de,k,P)}_fitInternal(h,_,T){return h?(delete(_=y.extend(h,_)).padding,_.linear?this.easeTo(_,T):this.flyTo(_,T)):this}jumpTo(h,_){this.stop();const T=h.preloadOnly?this.transform.clone():this.transform;let k=!1,P=!1,I=!1;return"zoom"in h&&T.zoom!==+h.zoom&&(k=!0,T.zoom=+h.zoom),void 0!==h.center&&(T.center=y.LngLat.convert(h.center)),"bearing"in h&&T.bearing!==+h.bearing&&(P=!0,T.bearing=+h.bearing),"pitch"in h&&T.pitch!==+h.pitch&&(I=!0,T.pitch=+h.pitch),null==h.padding||T.isPaddingEqual(h.padding)||(T.padding=h.padding),h.preloadOnly?(this._preloadTiles(T),this):(this.fire(new y.Event("movestart",_)).fire(new y.Event("move",_)),k&&this.fire(new y.Event("zoomstart",_)).fire(new y.Event("zoom",_)).fire(new y.Event("zoomend",_)),P&&this.fire(new y.Event("rotatestart",_)).fire(new y.Event("rotate",_)).fire(new y.Event("rotateend",_)),I&&this.fire(new y.Event("pitchstart",_)).fire(new y.Event("pitch",_)).fire(new y.Event("pitchend",_)),this.fire(new y.Event("moveend",_)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||y.warnOnce(ic),this.transform.getFreeCameraOptions()}setFreeCameraOptions(h,_){const T=this.transform;if(!T.projection.supportsFreeCamera)return y.warnOnce(ic),this;this.stop();const k=T.zoom,P=T.pitch,I=T.bearing;T.setFreeCameraOptions(h);const M=k!==T.zoom,z=P!==T.pitch,G=I!==T.bearing;return this.fire(new y.Event("movestart",_)).fire(new y.Event("move",_)),M&&this.fire(new y.Event("zoomstart",_)).fire(new y.Event("zoom",_)).fire(new y.Event("zoomend",_)),G&&this.fire(new y.Event("rotatestart",_)).fire(new y.Event("rotate",_)).fire(new y.Event("rotateend",_)),z&&this.fire(new y.Event("pitchstart",_)).fire(new y.Event("pitch",_)).fire(new y.Event("pitchend",_)),this.fire(new y.Event("moveend",_)),this}easeTo(h,_){this._stop(!1,h.easeId),(!1===(h=y.extend({offset:[0,0],duration:500,easing:y.ease},h)).animate||!h.essential&&y.exported.prefersReducedMotion)&&(h.duration=0);const T=this.transform,k=this.getZoom(),P=this.getBearing(),I=this.getPitch(),M=this.getPadding(),z="zoom"in h?+h.zoom:k,G="bearing"in h?this._normalizeBearing(h.bearing,P):P,$="pitch"in h?+h.pitch:I,te="padding"in h?h.padding:T.padding,ue=y.pointGeometry.convert(h.offset);let fe,_e,ye;if("globe"===T.projection.name){const Et=y.MercatorCoordinate.fromLngLat(T.center),At=ue.rotate(-T.angle);Et.x+=At.x/T.worldSize,Et.y+=At.y/T.worldSize;const on=Et.toLngLat(),wt=y.LngLat.convert(h.center||on);this._normalizeCenter(wt),fe=T.centerPoint.add(At),_e=new y.pointGeometry(Et.x,Et.y).mult(T.worldSize),ye=new y.pointGeometry(y.mercatorXfromLng(wt.lng),y.mercatorYfromLat(wt.lat)).mult(T.worldSize).sub(_e)}else{fe=T.centerPoint.add(ue);const Et=T.pointLocation(fe),At=y.LngLat.convert(h.center||Et);this._normalizeCenter(At),_e=T.project(Et),ye=T.project(At).sub(_e)}const Te=T.zoomScale(z-k);let de,Oe;h.around&&(de=y.LngLat.convert(h.around),Oe=T.locationPoint(de));const Re=this._zooming||z!==k,Fe=this._rotating||P!==G,Ye=this._pitching||$!==I,We=!T.isPaddingEqual(te),Xe=Et=>At=>{if(Re&&(Et.zoom=y.number(k,z,At)),Fe&&(Et.bearing=y.number(P,G,At)),Ye&&(Et.pitch=y.number(I,$,At)),We&&(Et.interpolatePadding(M,te,At),fe=Et.centerPoint.add(ue)),de)Et.setLocationAtPoint(de,Oe);else{const on=Et.zoomScale(Et.zoom-k),wt=z>k?Math.min(2,Te):Math.max(.5,Te),qt=Math.pow(wt,1-At),Nt=Et.unproject(_e.add(ye.mult(At*qt)).mult(on));Et.setLocationAtPoint(Et.renderWorldCopies?Nt.wrap():Nt,fe)}return h.preloadOnly||this._fireMoveEvents(_),Et};if(h.preloadOnly){const Et=this._emulate(Xe,h.duration,T);return this._preloadTiles(Et),this}const ut={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Re,this._rotating=Fe,this._pitching=Ye,this._padding=We,this._easeId=h.easeId,this._prepareEase(_,h.noMoveStart,ut),this._ease(Xe(T),Et=>{T.recenterOnTerrain(),this._afterEase(_,Et)},h),this}_prepareEase(h,_,T={}){this._moving=!0,this.transform.cameraElevationReference="sea",_||T.moving||this.fire(new y.Event("movestart",h)),this._zooming&&!T.zooming&&this.fire(new y.Event("zoomstart",h)),this._rotating&&!T.rotating&&this.fire(new y.Event("rotatestart",h)),this._pitching&&!T.pitching&&this.fire(new y.Event("pitchstart",h))}_fireMoveEvents(h){this.fire(new y.Event("move",h)),this._zooming&&this.fire(new y.Event("zoom",h)),this._rotating&&this.fire(new y.Event("rotate",h)),this._pitching&&this.fire(new y.Event("pitch",h))}_afterEase(h,_){if(this._easeId&&_&&this._easeId===_)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const T=this._zooming,k=this._rotating,P=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,T&&this.fire(new y.Event("zoomend",h)),k&&this.fire(new y.Event("rotateend",h)),P&&this.fire(new y.Event("pitchend",h)),this.fire(new y.Event("moveend",h))}flyTo(h,_){if(!h.essential&&y.exported.prefersReducedMotion){const tn=y.pick(h,["center","zoom","bearing","pitch","around"]);return this.jumpTo(tn,_)}this.stop(),h=y.extend({offset:[0,0],speed:1.2,curve:1.42,easing:y.ease},h);const T=this.transform,k=this.getZoom(),P=this.getBearing(),I=this.getPitch(),M=this.getPadding(),z="zoom"in h?y.clamp(+h.zoom,T.minZoom,T.maxZoom):k,G="bearing"in h?this._normalizeBearing(h.bearing,P):P,$="pitch"in h?+h.pitch:I,te="padding"in h?h.padding:T.padding,ue=T.zoomScale(z-k),fe=y.pointGeometry.convert(h.offset);let _e=T.centerPoint.add(fe);const ye=T.pointLocation(_e),Te=y.LngLat.convert(h.center||ye);this._normalizeCenter(Te);const de=T.project(ye),Oe=T.project(Te).sub(de);let Re=h.curve;const Fe=Math.max(T.width,T.height),Ye=Fe/ue,We=Oe.mag();if("minZoom"in h){const tn=y.clamp(Math.min(h.minZoom,k,z),T.minZoom,T.maxZoom),hn=Fe/T.zoomScale(tn-k);Re=Math.sqrt(hn/We*2)}const Xe=Re*Re;function ut(tn){const hn=(Ye*Ye-Fe*Fe+(tn?-1:1)*Xe*Xe*We*We)/(2*(tn?Ye:Fe)*Xe*We);return Math.log(Math.sqrt(hn*hn+1)-hn)}function Et(tn){return(Math.exp(tn)-Math.exp(-tn))/2}function At(tn){return(Math.exp(tn)+Math.exp(-tn))/2}const on=ut(0);let wt=function(tn){return At(on)/At(on+Re*tn)},qt=function(tn){return Fe*((At(on)*(Et(hn=on+Re*tn)/At(hn))-Et(on))/Xe)/We;var hn},Nt=(ut(1)-on)/Re;if(Math.abs(We)<1e-6||!isFinite(Nt)){if(Math.abs(Fe-Ye)<1e-6)return this.easeTo(h,_);const tn=Ye<Fe?-1:1;Nt=Math.abs(Math.log(Ye/Fe))/Re,qt=function(){return 0},wt=function(hn){return Math.exp(tn*Re*hn)}}h.duration="duration"in h?+h.duration:1e3*Nt/("screenSpeed"in h?+h.screenSpeed/Re:+h.speed),h.maxDuration&&h.duration>h.maxDuration&&(h.duration=0);const sn=P!==G,Tt=$!==I,yt=!T.isPaddingEqual(te),Pt=tn=>hn=>{const $n=hn*Nt,ki=1/wt($n);tn.zoom=1===hn?z:k+tn.scaleZoom(ki),sn&&(tn.bearing=y.number(P,G,hn)),Tt&&(tn.pitch=y.number(I,$,hn)),yt&&(tn.interpolatePadding(M,te,hn),_e=tn.centerPoint.add(fe));const Gn=1===hn?Te:tn.unproject(de.add(Oe.mult(qt($n))).mult(ki));return tn.setLocationAtPoint(tn.renderWorldCopies?Gn.wrap():Gn,_e),tn._updateCameraOnTerrain(),h.preloadOnly||this._fireMoveEvents(_),tn};if(h.preloadOnly){const tn=this._emulate(Pt,h.duration,T);return this._preloadTiles(tn),this}return this._zooming=!0,this._rotating=sn,this._pitching=Tt,this._padding=yt,this._prepareEase(_,!1),this._ease(Pt(T),()=>this._afterEase(_),h),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(h,_){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const T=this._onEaseEnd;this._onEaseEnd=void 0,T.call(this,_)}if(!h){const T=this.handlers;T&&T.stop(!1)}return this}_ease(h,_,T){!1===T.animate||0===T.duration?(h(1),_()):(this._easeStart=y.exported.now(),this._easeOptions=T,this._onEaseFrame=h,this._onEaseEnd=_,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const h=Math.min((y.exported.now()-this._easeStart)/this._easeOptions.duration,1),_=this._onEaseFrame;_&&_(this._easeOptions.easing(h)),h<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(h,_){h=y.wrap(h,-180,180);const T=Math.abs(h-_);return Math.abs(h-360-_)<T&&(h-=360),Math.abs(h+360-_)<T&&(h+=360),h}_normalizeCenter(h){const _=this.transform;if(!_.renderWorldCopies||_.maxBounds)return;const T=h.lng-_.center.lng;h.lng+=T>180?-360:T<-180?360:0}_emulate(h,_,T){const k=Math.ceil(15*_/1e3),P=[],I=h(T.clone());for(let M=0;M<=k;M++){const z=I(M/k);P.push(z.clone())}return P}}class rc{constructor(h={}){this.options=h,y.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(h){const _=this.options&&this.options.compact;return this._map=h,this._container=nt("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=nt("button","mapboxgl-ctrl-attrib-button",this._container),nt("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=nt("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),_&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===_&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(h,_){const T=this._map._getUIString(`AttributionControl.${_}`);h.setAttribute("aria-label",T),h.removeAttribute("title"),h.firstElementChild&&h.firstElementChild.setAttribute("title",T)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let h=this._editLink;h||(h=this._editLink=this._container.querySelector(".mapbox-improve-map"));const _=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||y.config.ACCESS_TOKEN}];if(h){const T=_.reduce((k,P,I)=>(P.value&&(k+=`${P.key}=${P.value}${I<_.length-1?"&":""}`),k),"?");h.href=`${y.config.FEEDBACK_URL}/${T}#${xh(this._map,!0)}`,h.rel="noopener nofollow",this._setElementTitle(h,"MapFeedback")}}_updateData(h){!h||"metadata"!==h.sourceDataType&&"visibility"!==h.sourceDataType&&"style"!==h.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let h=[];if(this._map.style.stylesheet){const k=this._map.style.stylesheet;this.styleOwner=k.owner,this.styleId=k.id}const _=this._map.style._sourceCaches;for(const k in _){const P=_[k];if(P.used){const I=P.getSource();I.attribution&&h.indexOf(I.attribution)<0&&h.push(I.attribution)}}h.sort((k,P)=>k.length-P.length),h=h.filter((k,P)=>{for(let I=P+1;I<h.length;I++)if(h[I].indexOf(k)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?h=[...this.options.customAttribution,...h]:h.unshift(this.options.customAttribution));const T=h.join(" | ");T!==this._attribHTML&&(this._attribHTML=T,h.length?(this._innerContainer.innerHTML=T,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class To{constructor(){y.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(h){this._map=h,this._container=nt("div","mapboxgl-ctrl");const _=nt("a","mapboxgl-ctrl-logo");return _.target="_blank",_.rel="noopener nofollow",_.href="https://www.mapbox.com/",_.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),_.setAttribute("rel","noopener nofollow"),this._container.appendChild(_),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(h){h&&"metadata"!==h.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const h=this._map.style._sourceCaches;if(0===Object.entries(h).length)return!0;for(const _ in h){const T=h[_].getSource();if(T.hasOwnProperty("mapbox_logo")&&!T.mapbox_logo)return!1}return!0}_updateCompact(){const h=this._container.children;if(h.length){const _=h[0];this._map.getCanvasContainer().offsetWidth<250?_.classList.add("mapboxgl-compact"):_.classList.remove("mapboxgl-compact")}}}class Hc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(h){const _=++this._id;return this._queue.push({callback:h,id:_,cancelled:!1}),_}remove(h){const _=this._currentlyRunning,T=_?this._queue.concat(_):this._queue;for(const k of T)if(k.id===h)return void(k.cancelled=!0)}run(h=0){const _=this._currentlyRunning=this._queue;this._queue=[];for(const T of _)if(!T.cancelled&&(T.callback(h),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function oc(w,h,_){if(w=new y.LngLat(w.lng,w.lat),h){const T=new y.LngLat(w.lng-360,w.lat),k=new y.LngLat(w.lng+360,w.lat),P=360*Math.ceil(Math.abs(w.lng-_.center.lng)/360),I=_.locationPoint(w).distSqr(h),M=h.x<0||h.y<0||h.x>_.width||h.y>_.height;_.locationPoint(T).distSqr(h)<I&&(M||Math.abs(T.lng-_.center.lng)<P)?w=T:_.locationPoint(k).distSqr(h)<I&&(M||Math.abs(k.lng-_.center.lng)<P)&&(w=k)}for(;Math.abs(w.lng-_.center.lng)>180;){const T=_.locationPoint(w);if(T.x>=0&&T.y>=0&&T.x<=_.width&&T.y<=_.height)break;w.lng>_.center.lng?w.lng-=360:w.lng+=360}return w}const pu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class hs extends y.Evented{constructor(h,_){if(super(),(h instanceof y.window.HTMLElement||_)&&(h=y.extend({element:h},_)),y.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=h&&h.anchor||"center",this._color=h&&h.color||"#3FB1CE",this._scale=h&&h.scale||1,this._draggable=h&&h.draggable||!1,this._clickTolerance=h&&h.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=h&&h.rotation||0,this._rotationAlignment=h&&h.rotationAlignment||"auto",this._pitchAlignment=h&&h.pitchAlignment&&h.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=h&&h.occludedOpacity||.2,h&&h.element)this._element=h.element,this._offset=y.pointGeometry.convert(h&&h.offset||[0,0]);else{this._defaultMarker=!0,this._element=nt("div");const k=41,P=27,I=fn("svg",{display:"block",height:k*this._scale+"px",width:P*this._scale+"px",viewBox:`0 0 ${P} ${k}`},this._element),M=fn("radialGradient",{id:"shadowGradient"},fn("defs",{},I));fn("stop",{offset:"10%","stop-opacity":.4},M),fn("stop",{offset:"100%","stop-opacity":.05},M),fn("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},I),fn("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},I),fn("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},I),fn("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},I),this._offset=y.pointGeometry.convert(h&&h.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",k=>{k.preventDefault()}),this._element.addEventListener("mousedown",k=>{k.preventDefault()});const T=this._element.classList;for(const k in pu)T.remove(`mapboxgl-marker-anchor-${k}`);T.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(h){return h===this._map||(this.remove(),this._map=h,h.getCanvasContainer().appendChild(this._element),h.on("move",this._updateMoving),h.on("moveend",this._update),h.on("remove",this._clearFadeTimer),h._addMarker(this),this.setDraggable(this._draggable),this._update(),h.on("click",this._onMapClick)),this}remove(){const h=this._map;return h&&(h.off("click",this._onMapClick),h.off("move",this._updateMoving),h.off("moveend",this._update),h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler),h.off("mouseup",this._onUp),h.off("touchend",this._onUp),h.off("mousemove",this._onMove),h.off("touchmove",this._onMove),h.off("remove",this._clearFadeTimer),h._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(h){return this._lngLat=y.LngLat.convert(h),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(h){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),h){if(!("offset"in h.options)){const k=Math.sqrt(Math.pow(13.5,2)/2);h.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[k,-1*(24.6+k)],"bottom-right":[-k,-1*(24.6+k)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=h,h._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(h){const _=h.code,T=h.charCode||h.keyCode;"Space"!==_&&"Enter"!==_&&32!==T&&13!==T||this.togglePopup()}_onMapClick(h){const _=h.originalEvent.target,T=this._element;this._popup&&(_===T||T.contains(_))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const h=this._popup;return h?(h.isOpen()?(h.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(h.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const h=this._map,_=this._pos;if(!h||!_)return!1;const T=h.unproject(_),k=h.getFreeCameraOptions();if(!k.position)return!1;const P=k.position.toLngLat();return P.distanceTo(T)<.9*P.distanceTo(this._lngLat)}_evaluateOpacity(){const h=this._map;if(!h)return;const _=this._pos;if(!_||_.x<0||_.x>h.transform.width||_.y<0||_.y>h.transform.height)return void this._clearFadeTimer();const T=h.unproject(_);let k;h._showingGlobe()&&y.isLngLatBehindGlobe(h.transform,this._lngLat)?k=0:(k=1-h._queryFogOpacity(T),h.transform._terrainEnabled()&&h.getTerrain()&&this._behindTerrain()&&(k*=this._occludedOpacity)),this._element.style.opacity=`${k}`,this._element.style.pointerEvents=k>0?"auto":"none",this._popup&&this._popup._setOpacity(k),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const h=this._pos;if(!h||!this._map)return;const _=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${h.x}px,${h.y}px)\n            ${pu[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${_.x}px,${_.y}px)\n        `}_calculateXYTransform(){const h=this._pos,_=this._map,T=this.getPitchAlignment();if(!_||!h||"map"!==T)return"";if(!_._showingGlobe()){const z=_.getPitch();return z?`rotateX(${z}deg)`:""}const k=y.radToDeg(y.globeTiltAtLngLat(_.transform,this._lngLat)),P=h.sub(y.globeCenterToScreenPoint(_.transform)),I=Math.abs(P.x)+Math.abs(P.y);if(0===I)return"";const M=k/I;return`rotateX(${-P.y*M}deg) rotateY(${P.x*M}deg)`}_calculateZTransform(){const h=this._pos,_=this._map;if(!_||!h)return"";let T=0;const k=this.getRotationAlignment();if("map"===k)if(_._showingGlobe()){const P=_.project(new y.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),I=_.project(new y.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(P);T=y.radToDeg(Math.atan2(I.y,I.x))-90}else T=-_.getBearing();else if("horizon"===k){const P=y.smoothstep(4,6,_.getZoom()),I=y.globeCenterToScreenPoint(_.transform);I.y+=P*_.transform.height;const M=h.sub(I),z=y.radToDeg(Math.atan2(M.y,M.x));T=(z>90?z-270:z+90)*(1-P)}return T+=this._rotation,T?`rotateZ(${T}deg)`:""}_update(h){y.window.cancelAnimationFrame(this._updateFrameId);const _=this._map;_&&(_.transform.renderWorldCopies&&(this._lngLat=oc(this._lngLat,this._pos,_.transform)),this._pos=_.project(this._lngLat),!0===h?this._updateFrameId=y.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),_._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(_._showingGlobe()||_.getTerrain()||_.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(h){return this._offset=y.pointGeometry.convert(h),this._update(),this}_onMove(h){const _=this._map;if(!_)return;const T=this._pointerdownPos,k=this._positionDelta;if(T&&k){if(!this._isDragging){const P=this._clickTolerance||_._clickTolerance;if(h.point.dist(T)<P)return;this._isDragging=!0}this._pos=h.point.sub(k),this._lngLat=_.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new y.Event("dragstart"))),this.fire(new y.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const h=this._map;h&&(h.off("mousemove",this._onMove),h.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new y.Event("dragend")),this._state="inactive"}_addDragHandler(h){const _=this._map,T=this._pos;_&&T&&this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(T),this._pointerdownPos=h.point,this._state="pending",_.on("mousemove",this._onMove),_.on("touchmove",this._onMove),_.once("mouseup",this._onUp),_.once("touchend",this._onUp))}setDraggable(h){this._draggable=!!h;const _=this._map;return _&&(h?(_.on("mousedown",this._addDragHandler),_.on("touchstart",this._addDragHandler)):(_.off("mousedown",this._addDragHandler),_.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(h){return this._rotation=h||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(h){return this._rotationAlignment=h||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(h){return this._pitchAlignment=h||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(h){return this._occludedOpacity=h||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Il={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Mf=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function fd(w=new y.pointGeometry(0,0),h="bottom"){if("number"==typeof w){const _=Math.round(Math.sqrt(.5*Math.pow(w,2)));switch(h){case"top":return new y.pointGeometry(0,w);case"top-left":return new y.pointGeometry(_,_);case"top-right":return new y.pointGeometry(-_,_);case"bottom":return new y.pointGeometry(0,-w);case"bottom-left":return new y.pointGeometry(_,-_);case"bottom-right":return new y.pointGeometry(-_,-_);case"left":return new y.pointGeometry(w,0);case"right":return new y.pointGeometry(-w,0)}return new y.pointGeometry(0,0)}return w instanceof y.pointGeometry||Array.isArray(w)?y.pointGeometry.convert(w):y.pointGeometry.convert(w[h]||[0,0])}class Xu{constructor(h){this.jumpTo(h)}getValue(h){if(h<=this._startTime)return this._start;if(h>=this._endTime)return this._end;const _=y.easeCubicInOut((h-this._startTime)/(this._endTime-this._startTime));return this._start*(1-_)+this._end*_}isEasing(h){return h>=this._startTime&&h<=this._endTime}jumpTo(h){this._startTime=-1/0,this._endTime=-1/0,this._start=h,this._end=h}easeTo(h,_,T){this._start=this.getValue(_),this._end=h,this._startTime=_,this._endTime=_+T}}const kf={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},zp={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},fu={showCompass:!0,showZoom:!0,visualizePitch:!1};class Qd{constructor(h,_,T=!1){this._clickTolerance=10,this.element=_,this.mouseRotate=new za({clickTolerance:h.dragRotate._mouseRotate._clickTolerance}),this.map=h,T&&(this.mousePitch=new hd({clickTolerance:h.dragRotate._mousePitch._clickTolerance})),y.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),_.addEventListener("mousedown",this.mousedown),_.addEventListener("touchstart",this.touchstart,{passive:!1}),_.addEventListener("touchmove",this.touchmove),_.addEventListener("touchend",this.touchend),_.addEventListener("touchcancel",this.reset)}down(h,_){this.mouseRotate.mousedown(h,_),this.mousePitch&&this.mousePitch.mousedown(h,_),Je()}move(h,_){const T=this.map,k=this.mouseRotate.mousemoveWindow(h,_),P=k&&k.bearingDelta;if(P&&T.setBearing(T.getBearing()+P),this.mousePitch){const I=this.mousePitch.mousemoveWindow(h,_),M=I&&I.pitchDelta;M&&T.setPitch(T.getPitch()+M)}}off(){const h=this.element;h.removeEventListener("mousedown",this.mousedown),h.removeEventListener("touchstart",this.touchstart,{passive:!1}),h.removeEventListener("touchmove",this.touchmove),h.removeEventListener("touchend",this.touchend),h.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){dt(),y.window.removeEventListener("mousemove",this.mousemove),y.window.removeEventListener("mouseup",this.mouseup)}mousedown(h){this.down(y.extend({},h,{ctrlKey:!0,preventDefault:()=>h.preventDefault()}),st(this.element,h)),y.window.addEventListener("mousemove",this.mousemove),y.window.addEventListener("mouseup",this.mouseup)}mousemove(h){this.move(h,st(this.element,h))}mouseup(h){this.mouseRotate.mouseupWindow(h),this.mousePitch&&this.mousePitch.mouseupWindow(h),this.offTemp()}touchstart(h){1!==h.targetTouches.length?this.reset():(this._startPos=this._lastPos=Zt(this.element,h.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>h.preventDefault()},this._startPos))}touchmove(h){1!==h.targetTouches.length?this.reset():(this._lastPos=Zt(this.element,h.targetTouches)[0],this.move({preventDefault:()=>h.preventDefault()},this._lastPos))}touchend(h){0===h.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Ys={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Xd={maxWidth:100,unit:"metric"};function Oo(w,h,_){const T=Qr(h),k=T/h,P={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[_];this._map._requestDomTask(()=>{this._container.style.width=w*k+"px",this._container.innerHTML=`${T}&nbsp;${P}`})}function Qr(w){const h=Math.pow(10,`${Math.floor(w)}`.length-1);let _=w/h;return _=_>=10?10:_>=5?5:_>=3?3:_>=2?2:_>=1?1:function(T){const k=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*k)/k}(_),h*_}const qn={version:y.version,supported:ht,setRTLTextPlugin:y.setRTLTextPlugin,getRTLTextPluginStatus:y.getRTLTextPluginStatus,Map:class extends Af{constructor(w){if(y.LivePerformanceUtils.mark(y.PerformanceMarkers.create),null!=(w=y.extend({},zp,w)).minZoom&&null!=w.maxZoom&&w.minZoom>w.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=w.minPitch&&null!=w.maxPitch&&w.minPitch>w.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=w.minPitch&&w.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=w.maxPitch&&w.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(w.antialias&&y.isSafariWithAntialiasingBug(y.window)&&(w.antialias=!1,y.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new An(w.minZoom,w.maxZoom,w.minPitch,w.maxPitch,w.renderWorldCopies),w),this._interactive=w.interactive,this._minTileCacheSize=w.minTileCacheSize,this._maxTileCacheSize=w.maxTileCacheSize,this._failIfMajorPerformanceCaveat=w.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=w.preserveDrawingBuffer,this._antialias=w.antialias,this._useWebGL2=w.useWebGL2,this._trackResize=w.trackResize,this._bearingSnap=w.bearingSnap,this._refreshExpiredTiles=w.refreshExpiredTiles,this._fadeDuration=w.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=w.crossSourceCollisions,this._collectResourceTiming=w.collectResourceTiming,this._optimizeForTerrain=w.optimizeForTerrain,this._language=this._parseLanguage(w.language),this._worldview=w.worldview,this._renderTaskQueue=new Hc,this._domRenderTaskQueue=new Hc,this._controls=[],this._markers=[],this._popups=[],this._mapId=y.uniqueId(),this._locale=y.extend({},kf,w.locale),this._clickTolerance=w.clickTolerance,this._cooperativeGestures=w.cooperativeGestures,this._performanceMetricsCollection=w.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Xu(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new y.RequestManager(w.transformRequest,w.accessToken,w.testMode),this._silenceAuthErrors=!!w.testMode,"string"==typeof w.container){if(this._container=y.window.document.getElementById(w.container),!this._container)throw new Error(`Container '${w.container}' not found.`)}else{if(!(w.container instanceof y.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=w.container}if(this._container.childNodes.length>0&&y.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),w.maxBounds&&this.setMaxBounds(w.maxBounds),y.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==y.window&&(y.window.addEventListener("online",this._onWindowOnline,!1),y.window.addEventListener("resize",this._onWindowResize,!1),y.window.addEventListener("orientationchange",this._onWindowResize,!1),y.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),y.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Df(this,w),this._localFontFamily=w.localFontFamily,this._localIdeographFontFamily=w.localIdeographFontFamily,w.style&&this.setStyle(w.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),w.projection&&this.setProjection(w.projection),this._hash=w.hash&&new uu("string"==typeof w.hash&&w.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:w.center,zoom:w.zoom,bearing:w.bearing,pitch:w.pitch}),w.bounds&&(this.resize(),this.fitBounds(w.bounds,y.extend({},w.fitBoundsOptions,{duration:0})))),this.resize(),w.attributionControl&&this.addControl(new rc({customAttribution:w.customAttribution})),this._logoControl=new To,this.addControl(this._logoControl,w.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",h=>{this._update("style"===h.dataType),this.fire(new y.Event(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new y.Event(`${h.dataType}dataloading`,h))})}_getMapId(){return this._mapId}addControl(w,h){if(void 0===h&&(h=w.getDefaultPosition?w.getDefaultPosition():"top-right"),!w||!w.onAdd)return this.fire(new y.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const _=w.onAdd(this);this._controls.push(w);const T=this._controlPositions[h];return-1!==h.indexOf("bottom")?T.insertBefore(_,T.firstChild):T.appendChild(_),this}removeControl(w){if(!w||!w.onRemove)return this.fire(new y.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const h=this._controls.indexOf(w);return h>-1&&this._controls.splice(h,1),w.onRemove(this),this}hasControl(w){return this._controls.indexOf(w)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(w){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const h=!this._moving;return h&&this.fire(new y.Event("movestart",w)).fire(new y.Event("move",w)),this.fire(new y.Event("resize",w)),h&&this.fire(new y.Event("moveend",w)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(w){return this.transform.setMaxBounds(y.LngLatBounds.convert(w)),this._update()}setMinZoom(w){if((w=w??-2)>=-2&&w<=this.transform.maxZoom)return this.transform.minZoom=w,this._update(),this.getZoom()<w?this.setZoom(w):this.fire(new y.Event("zoomstart")).fire(new y.Event("zoom")).fire(new y.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(w){if((w=w??22)>=this.transform.minZoom)return this.transform.maxZoom=w,this._update(),this.getZoom()>w?this.setZoom(w):this.fire(new y.Event("zoomstart")).fire(new y.Event("zoom")).fire(new y.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(w){if((w=w??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(w>=0&&w<=this.transform.maxPitch)return this.transform.minPitch=w,this._update(),this.getPitch()<w?this.setPitch(w):this.fire(new y.Event("pitchstart")).fire(new y.Event("pitch")).fire(new y.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(w){if((w=w??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(w>=this.transform.minPitch)return this.transform.maxPitch=w,this._update(),this.getPitch()>w?this.setPitch(w):this.fire(new y.Event("pitchstart")).fire(new y.Event("pitch")).fire(new y.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(w){return this.transform.renderWorldCopies=w,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(w){return"auto"===w?y.window.navigator.language:Array.isArray(w)?0===w.length?void 0:w.map(h=>"auto"===h?y.window.navigator.language:h):w}setLanguage(w){const h=this._parseLanguage(w);if(!this.style||h===this._language)return this;this._language=h,this.style._reloadSources();for(const _ of this._controls)_._setLanguage&&_._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(w){return this.style&&w!==this._worldview?(this._worldview=w,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(w){return this._lazyInitEmptyStyle(),w?"string"==typeof w&&(w={name:w}):w=null,this._useExplicitProjection=!!w,this._prioritizeAndUpdateProjection(w,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const w=this.transform,h=w.projection.name;let _;"globe"===h&&w.zoom>=y.GLOBE_ZOOM_THRESHOLD_MAX?(w.setMercatorFromTransition(),_=!0):"mercator"===h&&w.zoom<y.GLOBE_ZOOM_THRESHOLD_MAX&&(w.setProjection({name:"globe"}),_=!0),_&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(w,h){return this._updateProjection(w||h||{name:"mercator"})}_updateProjection(w){let h;if(h="globe"===w.name&&this.transform.zoom>=y.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(w),this.style.applyProjectionUpdate(),h){this.painter.clearBackgroundTiles();for(const _ in this.style._sourceCaches)this.style._sourceCaches[_].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(w){return this.transform.locationPoint3D(y.LngLat.convert(w))}unproject(w){return this.transform.pointLocation3D(y.pointGeometry.convert(w))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(w,h,_){if("mouseenter"===w||"mouseover"===w){let T=!1;const k=I=>{const M=h.filter(G=>this.getLayer(G)),z=M.length?this.queryRenderedFeatures(I.point,{layers:M}):[];z.length?T||(T=!0,_.call(this,new us(w,this,I.originalEvent,{features:z}))):T=!1},P=()=>{T=!1};return{layers:new Set(h),listener:_,delegates:{mousemove:k,mouseout:P}}}if("mouseleave"===w||"mouseout"===w){let T=!1;const k=I=>{const M=h.filter(z=>this.getLayer(z));(M.length?this.queryRenderedFeatures(I.point,{layers:M}):[]).length?T=!0:T&&(T=!1,_.call(this,new us(w,this,I.originalEvent)))},P=I=>{T&&(T=!1,_.call(this,new us(w,this,I.originalEvent)))};return{layers:new Set(h),listener:_,delegates:{mousemove:k,mouseout:P}}}{const T=k=>{const P=h.filter(M=>this.getLayer(M)),I=P.length?this.queryRenderedFeatures(k.point,{layers:P}):[];I.length&&(k.features=I,_.call(this,k),delete k.features)};return{layers:new Set(h),listener:_,delegates:{[w]:T}}}}on(w,h,_){if(void 0===_)return super.on(w,h);Array.isArray(h)||(h=[h]);const T=this._createDelegatedListener(w,h,_);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[w]=this._delegatedListeners[w]||[],this._delegatedListeners[w].push(T);for(const k in T.delegates)this.on(k,T.delegates[k]);return this}once(w,h,_){if(void 0===_)return super.once(w,h);Array.isArray(h)||(h=[h]);const T=this._createDelegatedListener(w,h,_);for(const k in T.delegates)this.once(k,T.delegates[k]);return this}off(w,h,_){if(void 0===_)return super.off(w,h);h=new Set(Array.isArray(h)?h:[h]);const T=(P,I)=>{if(P.size!==I.size)return!1;for(const M of P)if(!I.has(M))return!1;return!0},k=this._delegatedListeners?this._delegatedListeners[w]:void 0;return k&&(P=>{for(let I=0;I<P.length;I++){const M=P[I];if(M.listener===_&&T(M.layers,h)){for(const z in M.delegates)this.off(z,M.delegates[z]);return P.splice(I,1),this}}})(k),this}queryRenderedFeatures(w,h){return this.style?(void 0!==h||void 0===w||w instanceof y.pointGeometry||Array.isArray(w)||(h=w,w=void 0),this.style.queryRenderedFeatures(w=w||[[0,0],[this.transform.width,this.transform.height]],h=h||{},this.transform)):[]}querySourceFeatures(w,h){return this.style.querySourceFeatures(w,h)}setStyle(w,h){return!1!==(h=y.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},h)).diff&&h.localIdeographFontFamily===this._localIdeographFontFamily&&h.localFontFamily===this._localFontFamily&&this.style&&w?(this._diffStyle(w,h),this):(this._localIdeographFontFamily=h.localIdeographFontFamily,this._localFontFamily=h.localFontFamily,this._updateStyle(w,h))}_getUIString(w){const h=this._locale[w];if(null==h)throw new Error(`Missing UI string '${w}'`);return h}_updateStyle(w,h){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),w&&(this.style=new ia(this,h||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof w?this.style.loadURL(w):this.style.loadJSON(w)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ia(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(w,h){if("string"==typeof w){const _=this._requestManager.normalizeStyleURL(w),T=this._requestManager.transformRequest(_,y.ResourceType.Style);y.getJSON(T,(k,P)=>{k?this.fire(new y.ErrorEvent(k)):P&&this._updateDiff(P,h)})}else"object"==typeof w&&this._updateDiff(w,h)}_updateDiff(w,h){try{this.style.setState(w)&&this._update(!0)}catch(_){y.warnOnce(`Unable to perform style diff: ${_.message||_.error||_}.  Rebuilding the style from scratch.`),this._updateStyle(w,h)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(y.warnOnce("There is no style added to the map."),!1)}addSource(w,h){return this._lazyInitEmptyStyle(),this.style.addSource(w,h),this._update(!0)}isSourceLoaded(w){return!!this.style&&this.style._isSourceCacheLoaded(w)}areTilesLoaded(){const w=this.style&&this.style._sourceCaches;for(const h in w){const _=w[h]._tiles;for(const T in _){const k=_[T];if("loaded"!==k.state&&"errored"!==k.state)return!1}}return!0}addSourceType(w,h,_){this._lazyInitEmptyStyle(),this.style.addSourceType(w,h,_)}removeSource(w){return this.style.removeSource(w),this._updateTerrain(),this._update(!0)}getSource(w){return this.style.getSource(w)}addImage(w,h,{pixelRatio:_=1,sdf:T=!1,stretchX:k,stretchY:P,content:I}={}){if(this._lazyInitEmptyStyle(),h instanceof y.window.HTMLImageElement||y.window.ImageBitmap&&h instanceof y.window.ImageBitmap){const{width:M,height:z,data:G}=y.exported.getImageData(h);this.style.addImage(w,{data:new y.RGBAImage({width:M,height:z},G),pixelRatio:_,stretchX:k,stretchY:P,content:I,sdf:T,version:0})}else if(void 0===h.width||void 0===h.height)this.fire(new y.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:M,height:z}=h,G=h;this.style.addImage(w,{data:new y.RGBAImage({width:M,height:z},new Uint8Array(G.data)),pixelRatio:_,stretchX:k,stretchY:P,content:I,sdf:T,version:0,userImage:G}),G.onAdd&&G.onAdd(this,w)}}updateImage(w,h){const _=this.style.getImage(w);if(!_)return void this.fire(new y.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const T=h instanceof y.window.HTMLImageElement||y.window.ImageBitmap&&h instanceof y.window.ImageBitmap?y.exported.getImageData(h):h,{width:k,height:P}=T;void 0!==k&&void 0!==P?k===_.data.width&&P===_.data.height?(_.data.replace(T.data,!(h instanceof y.window.HTMLImageElement||y.window.ImageBitmap&&h instanceof y.window.ImageBitmap)),this.style.updateImage(w,_)):this.fire(new y.ErrorEvent(new Error(`The width and height of the updated image (${k}, ${P})\n                must be that same as the previous version of the image\n                (${_.data.width}, ${_.data.height})`))):this.fire(new y.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(w){return w?!!this.style.getImage(w):(this.fire(new y.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(w){this.style.removeImage(w)}loadImage(w,h){y.getImage(this._requestManager.transformRequest(w,y.ResourceType.Image),(_,T)=>{h(_,T instanceof y.window.HTMLImageElement?y.exported.getImageData(T):T)})}listImages(){return this.style.listImages()}addLayer(w,h){return this._lazyInitEmptyStyle(),this.style.addLayer(w,h),this._update(!0)}moveLayer(w,h){return this.style.moveLayer(w,h),this._update(!0)}removeLayer(w){return this.style.removeLayer(w),this._update(!0)}getLayer(w){return this.style.getLayer(w)}setLayerZoomRange(w,h,_){return this.style.setLayerZoomRange(w,h,_),this._update(!0)}setFilter(w,h,_={}){return this.style.setFilter(w,h,_),this._update(!0)}getFilter(w){return this.style.getFilter(w)}setPaintProperty(w,h,_,T={}){return this.style.setPaintProperty(w,h,_,T),this._update(!0)}getPaintProperty(w,h){return this.style.getPaintProperty(w,h)}setLayoutProperty(w,h,_,T={}){return this.style.setLayoutProperty(w,h,_,T),this._update(!0)}getLayoutProperty(w,h){return this.style.getLayoutProperty(w,h)}setLight(w,h={}){return this._lazyInitEmptyStyle(),this.style.setLight(w,h),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(w){return this._lazyInitEmptyStyle(),!w&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(w),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(w){return this._lazyInitEmptyStyle(),this.style.setFog(w),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(w){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(y.LngLat.convert(w),this.transform):0}setFeatureState(w,h){return this.style.setFeatureState(w,h),this._update()}removeFeatureState(w,h){return this.style.removeFeatureState(w,h),this._update()}getFeatureState(w){return this.style.getFeatureState(w)}_updateContainerDimensions(){if(!this._container)return;const w=this._container.getBoundingClientRect().width||400,h=this._container.getBoundingClientRect().height||300;let _,T,k,P=this._container;for(;P&&(!T||!k);){const I=y.window.getComputedStyle(P).transform;I&&"none"!==I&&(_=I.match(/matrix.*\((.+)\)/)[1].split(", "),_[0]&&"0"!==_[0]&&"1"!==_[0]&&(T=_[0]),_[3]&&"0"!==_[3]&&"1"!==_[3]&&(k=_[3])),P=P.parentElement}this._containerWidth=T?Math.abs(w/T):w,this._containerHeight=k?Math.abs(h/k):h}_detectMissingCSS(){"rgb(250, 128, 114)"!==y.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&y.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const w=this._container;w.classList.add("mapboxgl-map"),(this._missingCSSCanary=nt("div","mapboxgl-canary",w)).style.visibility="hidden",this._detectMissingCSS();const h=this._canvasContainer=nt("div","mapboxgl-canvas-container",w);this._interactive&&h.classList.add("mapboxgl-interactive"),this._canvas=nt("canvas","mapboxgl-canvas",h),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const _=this._controlContainer=nt("div","mapboxgl-control-container",w),T=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(k=>{T[k]=nt("div",`mapboxgl-ctrl-${k}`,_)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(w,h){const _=y.exported.devicePixelRatio||1;this._canvas.width=_*Math.ceil(w),this._canvas.height=_*Math.ceil(h),this._canvas.style.width=`${w}px`,this._canvas.style.height=`${h}px`}_addMarker(w){this._markers.push(w)}_removeMarker(w){const h=this._markers.indexOf(w);-1!==h&&this._markers.splice(h,1)}_addPopup(w){this._popups.push(w)}_removePopup(w){const h=this._popups.indexOf(w);-1!==h&&this._popups.splice(h,1)}_setupPainter(){const w=y.extend({},ht.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),h=this._useWebGL2&&this._canvas.getContext("webgl2",w),_=h||this._canvas.getContext("webgl",w)||this._canvas.getContext("experimental-webgl",w);_?(this._useWebGL2&&!h&&y.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),y.storeAuthState(_,!0),this.painter=new kc(_,this.transform,!!h),this.on("data",T=>{"source"===T.dataType&&this.painter.setTileLoadedFlag(!0)}),y.exported$1.testSupport(_)):this.fire(new y.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(w){w.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new y.Event("webglcontextlost",{originalEvent:w}))}_contextRestored(w){this._setupPainter(),this.resize(),this._update(),this.fire(new y.Event("webglcontextrestored",{originalEvent:w}))}_onMapScroll(w){if(w.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(w){return this.style?(this._styleDirty=this._styleDirty||w,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(w){return this._update(),this._renderTaskQueue.add(w)}_cancelRenderFrame(w){this._renderTaskQueue.remove(w)}_requestDomTask(w){!this.loaded()||this.loaded()&&!this.isMoving()?w():this._domRenderTaskQueue.add(w)}_render(w){let h;const _=this.painter.context.extTimerQuery,T=y.exported.now();if(this.listens("gpu-timing-frame")&&(h=_.createQueryEXT(),_.beginQueryEXT(_.TIME_ELAPSED_EXT,h)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],y.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],y.window.performance.now())),this._renderTaskQueue.run(w),this._domRenderTaskQueue.run(w),this._removed)return;this._updateProjectionTransition();const k=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const M=this.transform.zoom,z=this.transform.pitch,G=y.exported.now(),$=new y.EvaluationParameters(M,{now:G,fadeDuration:k,pitch:z,transition:this.style.getTransition()});this.style.update($)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let P=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),P=this._updateAverageElevation(T),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):P=this._updateAverageElevation(T),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,k,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:k,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new y.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new y.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),h){const M=y.exported.now()-T;_.endQueryEXT(_.TIME_ELAPSED_EXT,h),setTimeout(()=>{const z=_.getQueryObjectEXT(h,_.QUERY_RESULT_EXT)/1e6;_.deleteQueryEXT(h),this.fire(new y.Event("gpu-timing-frame",{cpuTime:M,gpuTime:z})),y.window.performance.mark("frame-gpu",{startTime:T,detail:{gpuTime:z}})},50)}if(this.listens("gpu-timing-layer")){const M=this.painter.collectGpuTimers();setTimeout(()=>{const z=this.painter.queryGpuTimers(M);this.fire(new y.Event("gpu-timing-layer",{layerTimes:z}))},50)}if(this.listens("gpu-timing-deferred-render")){const M=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const z=this.painter.queryGpuTimeDeferredRender(M);this.fire(new y.Event("gpu-timing-deferred-render",{gpuTime:z}))},50)}const I=this._sourcesDirty||this._styleDirty||this._placementDirty||P;if(I||this._repaint)this.triggerRepaint();else{const M=!this.isMoving()&&this.loaded();if(M&&(P=this._updateAverageElevation(T,!0)),P)this.triggerRepaint();else if(this._triggerFrame(!1),M&&(this.fire(new y.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const z=this._calculateSpeedIndex();this.fire(new y.Event("speedindexcompleted",{speedIndex:z})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||I||(this._fullyLoaded=!0,y.LivePerformanceUtils.mark(y.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&y.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(w){for(const h of this._markers)w&&!this.getRenderWorldCopies()&&(h._lngLat=h._lngLat.wrap()),h._update();for(const h of this._popups)!w||this.getRenderWorldCopies()||h._trackPointer||(h._lngLat=h._lngLat.wrap()),h._update()}_updateAverageElevation(w,h=!1){const _=T=>(this.transform.averageElevation=T,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&_(0);if((h||w-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(w)){const T=this.transform.averageElevation;let k=this.transform.sampleAverageElevation(),P=!1;this.transform.elevation&&(P=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(k)?k=0:this._averageElevationLastSampledAt=w;const I=Math.abs(T-k);if(I>1){if(this._isInitialLoad||P)return this._averageElevation.jumpTo(k),_(k);this._averageElevation.easeTo(k,w,300)}else if(I>1e-4)return this._averageElevation.jumpTo(k),_(k)}return!!this._averageElevation.isEasing(w)&&_(this._averageElevation.getValue(w))}_authenticate(){y.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,w=>{if(w&&(w.message===y.AUTH_ERR_MSG||401===w.status)){const h=this.painter.context.gl;y.storeAuthState(h,!1),this._logoControl instanceof To&&this._logoControl._updateLogo(),h&&h.clear(h.DEPTH_BUFFER_BIT|h.COLOR_BUFFER_BIT|h.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new y.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),y.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const w=this._isDragging();this.painter.updateTerrain(this.style,w)}_calculateSpeedIndex(){const w=this.painter.canvasCopy(),h=this.painter.getCanvasCopiesAndTimestamps();h.timeStamps.push(performance.now());const _=this.painter.context.gl,T=_.createFramebuffer();function k(P){_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,P,0);const I=new Uint8Array(_.drawingBufferWidth*_.drawingBufferHeight*4);return _.readPixels(0,0,_.drawingBufferWidth,_.drawingBufferHeight,_.RGBA,_.UNSIGNED_BYTE,I),I}return _.bindFramebuffer(_.FRAMEBUFFER,T),this._canvasPixelComparison(k(w),h.canvasCopies.map(k),h.timeStamps)}_canvasPixelComparison(w,h,_){let T=_[1]-_[0];const k=w.length/4;for(let P=0;P<h.length;P++){const I=h[P];let M=0;for(let z=0;z<I.length;z+=4)I[z]===w[z]&&I[z+1]===w[z+1]&&I[z+2]===w[z+2]&&I[z+3]===w[z+3]&&(M+=1);T+=(_[P+2]-_[P+1])*(1-M/k)}return T}remove(){this._hash&&this._hash.remove();for(const h of this._controls)h.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==y.window&&(y.window.removeEventListener("resize",this._onWindowResize,!1),y.window.removeEventListener("orientationchange",this._onWindowResize,!1),y.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),y.window.removeEventListener("online",this._onWindowOnline,!1),y.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const w=this.painter.context.gl.getExtension("WEBGL_lose_context");w&&w.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),y.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new y.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(w){this._renderNextFrame=this._renderNextFrame||w,this.style&&!this._frame&&(this._frame=y.exported.frame(h=>{const _=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,_&&this._render(h)}))}_preloadTiles(w){const h=this.style?Object.values(this.style._sourceCaches):[];return y.asyncAll(h,(_,T)=>_._preloadTiles(w,T),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(w){this._trackResize&&this.resize({originalEvent:w})._update()}_onVisibilityChange(){"hidden"===y.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(w){this._showTileBoundaries!==w&&(this._showTileBoundaries=w,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(w){this._showTerrainWireframe!==w&&(this._showTerrainWireframe=w,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(w){this._speedIndexTiming!==w&&(this._speedIndexTiming=w,this._update())}get showPadding(){return!!this._showPadding}set showPadding(w){this._showPadding!==w&&(this._showPadding=w,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(w){this._showCollisionBoxes!==w&&(this._showCollisionBoxes=w,w?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(w){this._showOverdrawInspector!==w&&(this._showOverdrawInspector=w,this._update())}get repaint(){return!!this._repaint}set repaint(w){this._repaint!==w&&(this._repaint=w,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(w){this._vertices=w,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(w){this._showTileAABBs!==w&&(this._showTileAABBs=w,w&&this._update())}_setCacheLimits(w,h){y.setCacheLimits(w,h)}get version(){return y.version}},NavigationControl:class{constructor(w){this.options=y.extend({},fu,w),this._container=nt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",h=>h.preventDefault()),this.options.showZoom&&(y.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",h=>{this._map&&this._map.zoomIn({},{originalEvent:h})}),nt("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",h=>{this._map&&this._map.zoomOut({},{originalEvent:h})}),nt("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(y.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",h=>{const _=this._map;_&&(this.options.visualizePitch?_.resetNorthPitch({},{originalEvent:h}):_.resetNorth({},{originalEvent:h}))}),this._compassIcon=nt("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const w=this._map;if(!w)return;const h=w.getZoom(),_=h===w.getMaxZoom(),T=h===w.getMinZoom();this._zoomInButton.disabled=_,this._zoomOutButton.disabled=T,this._zoomInButton.setAttribute("aria-disabled",_.toString()),this._zoomOutButton.setAttribute("aria-disabled",T.toString())}_rotateCompassArrow(){const w=this._map;if(!w)return;const h=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(w.transform.pitch*(Math.PI/180)),.5)}) rotateX(${w.transform.pitch}deg) rotateZ(${w.transform.angle*(180/Math.PI)}deg)`:`rotate(${w.transform.angle*(180/Math.PI)}deg)`;w._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=h)})}onAdd(w){return this._map=w,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),w.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&w.on("pitch",this._rotateCompassArrow),w.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Qd(w,this._compass,this.options.visualizePitch)),this._container}onRemove(){const w=this._map;w&&(this._container.remove(),this.options.showZoom&&w.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&w.off("pitch",this._rotateCompassArrow),w.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(w,h){const _=nt("button",w,this._container);return _.type="button",_.addEventListener("click",h),_}_setButtonTitle(w,h){if(!this._map)return;const _=this._map._getUIString(`NavigationControl.${h}`);w.setAttribute("aria-label",_),w.firstElementChild&&w.firstElementChild.setAttribute("title",_)}},GeolocateControl:class extends y.Evented{constructor(w){super(),this.options=y.extend({geolocation:y.window.navigator.geolocation},Ys,w),y.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=_a(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(w){return this._map=w,this._container=nt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(w){const h=(_=!!this.options.geolocation)=>{this._supportsGeolocation=_,w(_)};void 0!==this._supportsGeolocation?w(this._supportsGeolocation):void 0!==y.window.navigator.permissions?y.window.navigator.permissions.query({name:"geolocation"}).then(_=>h("denied"!==_.state)).catch(()=>h()):h()}_isOutOfMapMaxBounds(w){const h=this._map.getMaxBounds(),_=w.coords;return!!h&&(_.longitude<h.getWest()||_.longitude>h.getEast()||_.latitude<h.getSouth()||_.latitude>h.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(w){if(this._map){if(this._isOutOfMapMaxBounds(w))return this._setErrorState(),this.fire(new y.Event("outofmaxbounds",w)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=w,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(w),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(w),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new y.Event("geolocate",w)),this._finish()}}_updateCamera(w){const h=new y.LngLat(w.coords.longitude,w.coords.latitude),_=w.coords.accuracy,T=this._map.getBearing(),k=y.extend({bearing:T},this.options.fitBoundsOptions);this._map.fitBounds(h.toBounds(_),k,{geolocateSource:!0})}_updateMarker(w){if(w){const h=new y.LngLat(w.coords.longitude,w.coords.latitude);this._accuracyCircleMarker.setLngLat(h).addTo(this._map),this._userLocationDotMarker.setLngLat(h).addTo(this._map),this._accuracy=w.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const w=this._map.transform,h=y.mercatorZfromAltitude(1,w._center.lat)*w.worldSize,_=Math.ceil(2*this._accuracy*h);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(w){if(this._map){if(this.options.trackUserLocation)if(1===w.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===w.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new y.Event("error",w)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(w){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",h=>h.preventDefault()),this._geolocateButton=nt("button","mapboxgl-ctrl-geolocate",this._container),nt("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===w){y.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}else{const h=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=nt("div","mapboxgl-user-location"),this._dotElement.appendChild(nt("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(nt("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new hs({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=nt("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new hs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",h=>{h.geolocateSource||"ACTIVE_LOCK"!==this._watchState||h.originalEvent&&"resize"===h.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new y.Event("trackuserlocationend")))})}}_onDeviceOrientation(w){this._userLocationDotMarker&&(w.webkitCompassHeading?this._heading=w.webkitCompassHeading:!0===w.absolute&&(this._heading=-1*w.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return y.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new y.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new y.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new y.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let w;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(w={maximumAge:6e5,timeout:0},this._noTimeout=!0):(w=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,w),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const w=()=>{y.window.addEventListener("ondeviceorientationabsolute"in y.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==y.window.DeviceMotionEvent&&"function"==typeof y.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(h=>{"granted"===h&&w()}).catch(console.error):w()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),y.window.removeEventListener("deviceorientation",this._onDeviceOrientation),y.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:rc,ScaleControl:class{constructor(w){this.options=y.extend({},Xd,w),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=Oo.bind(this)),y.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const w=this.options.maxWidth||100,h=this._map,_=h._containerHeight/2,T=h._containerWidth/2-w/2,k=h.unproject([T,_]),P=h.unproject([T+w,_]),I=k.distanceTo(P);if("imperial"===this.options.unit){const M=3.2808*I;M>5280?this._setScale(w,M/5280,"mile"):this._setScale(w,M,"foot")}else"nautical"===this.options.unit?this._setScale(w,I/1852,"nautical-mile"):I>=1e3?this._setScale(w,I/1e3,"kilometer"):this._setScale(w,I,"meter")}_setScale(w,h,_){const T=Qr(h),k=T/h;this._map._requestDomTask(()=>{this._container.style.width=w*k+"px",this._container.innerHTML="nautical-mile"!==_?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:_}).format(T):`${T}&nbsp;nm`})}onAdd(w){return this._map=w,this._language=w.getLanguage(),this._container=nt("div","mapboxgl-ctrl mapboxgl-ctrl-scale",w.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(w){this._language=w,this._update()}setUnit(w){this.options.unit=w,this._update()}},FullscreenControl:class{constructor(w){this._fullscreen=!1,w&&w.container&&(w.container instanceof y.window.HTMLElement?this._container=w.container:y.warnOnce("Full screen control 'container' must be a DOM element.")),y.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in y.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in y.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(w){return this._map=w,this._container||(this._container=this._map.getContainer()),this._controlContainer=nt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",y.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,y.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!y.window.document.fullscreenEnabled&&!y.window.document.webkitFullscreenEnabled)}_setupUI(){const w=this._fullscreenButton=nt("button","mapboxgl-ctrl-fullscreen",this._controlContainer);nt("span","mapboxgl-ctrl-icon",w).setAttribute("aria-hidden","true"),w.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),y.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const w=this._getTitle();this._fullscreenButton.setAttribute("aria-label",w),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",w)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(y.window.document.fullscreenElement||y.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?y.window.document.exitFullscreen?y.window.document.exitFullscreen():y.window.document.webkitCancelFullScreen&&y.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends y.Evented{constructor(w){super(),this.options=y.extend(Object.create(Il),w),y.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(w&&w.className?w.className.trim().split(/\s+/):[])}addTo(w){return this._map&&this.remove(),this._map=w,this.options.closeOnClick&&w.on("preclick",this._onClose),this.options.closeOnMove&&w.on("move",this._onClose),w.on("remove",this.remove),this._update(),w._addPopup(this),this._focusFirstElement(),this._trackPointer?(w.on("mousemove",this._onMouseEvent),w.on("mouseup",this._onMouseEvent),w._canvasContainer.classList.add("mapboxgl-track-pointer")):w.on("move",this._update),this.fire(new y.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const w=this._map;return w&&(w.off("move",this._update),w.off("move",this._onClose),w.off("preclick",this._onClose),w.off("click",this._onClose),w.off("remove",this.remove),w.off("mousemove",this._onMouseEvent),w.off("mouseup",this._onMouseEvent),w.off("drag",this._onMouseEvent),w._canvasContainer&&w._canvasContainer.classList.remove("mapboxgl-track-pointer"),w._removePopup(this),this._map=void 0),this.fire(new y.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(w){this._lngLat=y.LngLat.convert(w),this._pos=null,this._trackPointer=!1,this._update();const h=this._map;return h&&(h.on("move",this._update),h.off("mousemove",this._onMouseEvent),h._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const w=this._map;return w&&(w.off("move",this._update),w.on("mousemove",this._onMouseEvent),w.on("drag",this._onMouseEvent),w._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(w){return this.setDOMContent(y.window.document.createTextNode(w))}setHTML(w){const h=y.window.document.createDocumentFragment(),_=y.window.document.createElement("body");let T;for(_.innerHTML=w;T=_.firstChild,T;)h.appendChild(T);return this.setDOMContent(h)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(w){return this.options.maxWidth=w,this._update(),this}setDOMContent(w){let h=this._content;if(h)for(;h.hasChildNodes();)h.firstChild&&h.removeChild(h.firstChild);else h=this._content=nt("div","mapboxgl-popup-content",this._container||void 0);if(h.appendChild(w),this.options.closeButton){const _=this._closeButton=nt("button","mapboxgl-popup-close-button",h);_.type="button",_.setAttribute("aria-label","Close popup"),_.setAttribute("aria-hidden","true"),_.innerHTML="&#215;",_.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(w){return this._classList.add(w),this._updateClassList(),this}removeClassName(w){return this._classList.delete(w),this._updateClassList(),this}setOffset(w){return this.options.offset=w,this._update(),this}toggleClassName(w){let h;return this._classList.delete(w)?h=!1:(this._classList.add(w),h=!0),this._updateClassList(),h}_onMouseEvent(w){this._update(w.point)}_getAnchor(w){if(this.options.anchor)return this.options.anchor;const h=this._map,_=this._container,T=this._pos;if(!h||!_||!T)return"bottom";const k=_.offsetWidth,P=_.offsetHeight,I=T.x<k/2,M=T.x>h.transform.width-k/2;if(T.y+w<P)return I?"top-left":M?"top-right":"top";if(T.y>h.transform.height-P){if(I)return"bottom-left";if(M)return"bottom-right"}return I?"left":M?"right":"bottom"}_updateClassList(){const w=this._container;if(!w)return;const h=[...this._classList];h.push("mapboxgl-popup"),this._anchor&&h.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&h.push("mapboxgl-popup-track-pointer"),w.className=h.join(" ")}_update(w){const h=this._map,_=this._content;if(!h||!this._lngLat&&!this._trackPointer||!_)return;let T=this._container;if(T||(T=this._container=nt("div","mapboxgl-popup",h.getContainer()),this._tip=nt("div","mapboxgl-popup-tip",T),T.appendChild(_)),this.options.maxWidth&&T.style.maxWidth!==this.options.maxWidth&&(T.style.maxWidth=this.options.maxWidth),h.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=oc(this._lngLat,this._pos,h.transform)),!this._trackPointer||w){const k=this._pos=this._trackPointer&&w?w:h.project(this._lngLat),P=fd(this.options.offset),I=this._anchor=this._getAnchor(P.y),M=fd(this.options.offset,I),z=k.add(M).round();h._requestDomTask(()=>{this._container&&I&&(this._container.style.transform=`${pu[I]} translate(${z.x}px,${z.y}px)`)})}if(!this._marker&&h._showingGlobe()){const k=y.isLngLatBehindGlobe(h.transform,this._lngLat)?0:1;this._setOpacity(k)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const w=this._container.querySelector(Mf);w&&w.focus()}_onClose(){this.remove()}_setOpacity(w){this._container&&(this._container.style.opacity=`${w}`),this._content&&(this._content.style.pointerEvents=w?"auto":"none")}},Marker:hs,Style:ia,LngLat:y.LngLat,LngLatBounds:y.LngLatBounds,Point:y.pointGeometry,MercatorCoordinate:y.MercatorCoordinate,FreeCameraOptions:wh,Evented:y.Evented,config:y.config,prewarm:function(){di().acquire(ni)},clearPrewarmedResources:function(){const w=Nn;w&&(w.isPreloaded()&&1===w.numActive()?(w.release(ni),Nn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return y.config.ACCESS_TOKEN},set accessToken(w){y.config.ACCESS_TOKEN=w},get baseApiUrl(){return y.config.API_URL},set baseApiUrl(w){y.config.API_URL=w},get workerCount(){return Xn.workerCount},set workerCount(w){Xn.workerCount=w},get maxParallelImageRequests(){return y.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(w){y.config.MAX_PARALLEL_IMAGE_REQUESTS=w},clearStorage(w){y.clearTileCache(w)},workerUrl:"",workerClass:null,setNow:y.exported.setNow,restoreNow:y.exported.restoreNow};return qn}),ct}()},5473:()=>{!function(){"use strict";var bt=function(Ee){this.element_=Ee,this.init()};window.MaterialButton=bt,bt.prototype.Constant_={},bt.prototype.CssClasses_={RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_CONTAINER:"mdl-button__ripple-container",RIPPLE:"mdl-ripple"},bt.prototype.blurHandler_=function(vt){vt&&this.element_.blur()},bt.prototype.disable=bt.prototype.disable=function(){this.element_.disabled=!0},bt.prototype.enable=bt.prototype.enable=function(){this.element_.disabled=!1},bt.prototype.init=function(){if(this.element_){if(this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){var vt=document.createElement("span");vt.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleElement_=document.createElement("span"),this.rippleElement_.classList.add(this.CssClasses_.RIPPLE),vt.appendChild(this.rippleElement_),this.boundRippleBlurHandler=this.blurHandler_.bind(this),this.rippleElement_.addEventListener("mouseup",this.boundRippleBlurHandler),this.element_.appendChild(vt)}this.boundButtonBlurHandler=this.blurHandler_.bind(this),this.element_.addEventListener("mouseup",this.boundButtonBlurHandler),this.element_.addEventListener("mouseleave",this.boundButtonBlurHandler)}},componentHandler.register({constructor:bt,classAsString:"MaterialButton",cssClass:"mdl-js-button",widget:!0})}()},2125:()=>{var bt={upgradeDom:function(vt,Ee){},upgradeElement:function(vt,Ee){},upgradeElements:function(vt){},upgradeAllRegistered:function(){},registerUpgradedCallback:function(vt,Ee){},register:function(vt){},downgradeElements:function(vt){}};(bt=function(){"use strict";var vt=[],Ee=[],pe="mdlComponentConfigInternal_";function o(ft,ln){for(var Ze=0;Ze<vt.length;Ze++)if(vt[Ze].className===ft)return typeof ln<"u"&&(vt[Ze]=ln),vt[Ze];return!1}function xe(ft){var ln=ft.getAttribute("data-upgraded");return null===ln?[""]:ln.split(",")}function ct(ft,ln){return-1!==xe(ft).indexOf(ln)}function Ct(ft,ln,Ze){if("CustomEvent"in window&&"function"==typeof window.CustomEvent)return new CustomEvent(ft,{bubbles:ln,cancelable:Ze});var Je=document.createEvent("Events");return Je.initEvent(ft,ln,Ze),Je}function Ht(ft,ln){if(typeof ft>"u"&&typeof ln>"u")for(var Ze=0;Ze<vt.length;Ze++)Ht(vt[Ze].className,vt[Ze].cssClass);else{var Je=ft;if(typeof ln>"u"){var dt=o(Je);dt&&(ln=dt.cssClass)}for(var Ot=document.querySelectorAll("."+ln),Jt=0;Jt<Ot.length;Jt++)y(Ot[Jt],Je)}}function y(ft,ln){if(!("object"==typeof ft&&ft instanceof Element))throw new Error("Invalid argument provided to upgrade MDL element.");var Ze=Ct("mdl-componentupgrading",!0,!0);if(ft.dispatchEvent(Ze),!Ze.defaultPrevented){var Je=xe(ft),dt=[];if(ln)ct(ft,ln)||dt.push(o(ln));else{var Ot=ft.classList;vt.forEach(function(en){Ot.contains(en.cssClass)&&-1===dt.indexOf(en)&&!ct(ft,en.className)&&dt.push(en)})}for(var Zt,Jt=0,st=dt.length;Jt<st;Jt++){if(!(Zt=dt[Jt]))throw new Error("Unable to find a registered component for the given class.");Je.push(Zt.className),ft.setAttribute("data-upgraded",Je.join(","));var nn=new Zt.classConstructor(ft);nn[pe]=Zt,Ee.push(nn);for(var yn=0,it=Zt.callbacks.length;yn<it;yn++)Zt.callbacks[yn](ft);Zt.widget&&(ft[Zt.className]=nn);var zt=Ct("mdl-componentupgraded",!0,!1);ft.dispatchEvent(zt)}}}function nt(ft){if(ft){var ln=Ee.indexOf(ft);Ee.splice(ln,1);var Ze=ft.element_.getAttribute("data-upgraded").split(","),Je=Ze.indexOf(ft[pe].classAsString);Ze.splice(Je,1),ft.element_.setAttribute("data-upgraded",Ze.join(","));var dt=Ct("mdl-componentdowngraded",!0,!1);ft.element_.dispatchEvent(dt)}}return{upgradeDom:Ht,upgradeElement:y,upgradeElements:function ze(ft){Array.isArray(ft)||(ft=ft instanceof Element?[ft]:Array.prototype.slice.call(ft));for(var Je,ln=0,Ze=ft.length;ln<Ze;ln++)(Je=ft[ln])instanceof HTMLElement&&(y(Je),Je.children.length>0&&ze(Je.children))},upgradeAllRegistered:function Ne(){for(var ft=0;ft<vt.length;ft++)Ht(vt[ft].className)},registerUpgradedCallback:function qe(ft,ln){var Ze=o(ft);Ze&&Ze.callbacks.push(ln)},register:function ht(ft){var Ze=!0;typeof ft.widget>"u"&&typeof ft.widget>"u"||(Ze=ft.widget||ft.widget);var Je={classConstructor:ft.constructor||ft.constructor,className:ft.classAsString||ft.classAsString,cssClass:ft.cssClass||ft.cssClass,widget:Ze,callbacks:[]};if(vt.forEach(function(Ot){if(Ot.cssClass===Je.cssClass)throw new Error("The provided cssClass has already been registered: "+Ot.cssClass);if(Ot.className===Je.className)throw new Error("The provided className has already been registered")}),ft.constructor.prototype.hasOwnProperty(pe))throw new Error("MDL component classes must not have "+pe+" defined as a property.");o(ft.classAsString,Je)||vt.push(Je)},downgradeElements:function fn(ft){var ln=function(Je){Ee.filter(function(dt){return dt.element_===Je}).forEach(nt)};if(ft instanceof Array||ft instanceof NodeList)for(var Ze=0;Ze<ft.length;Ze++)ln(ft[Ze]);else{if(!(ft instanceof Node))throw new Error("Invalid argument provided to downgrade MDL nodes.");ln(ft)}}}}()).upgradeDom=bt.upgradeDom,bt.upgradeElement=bt.upgradeElement,bt.upgradeElements=bt.upgradeElements,bt.upgradeAllRegistered=bt.upgradeAllRegistered,bt.registerUpgradedCallback=bt.registerUpgradedCallback,bt.register=bt.register,bt.downgradeElements=bt.downgradeElements,window.componentHandler=bt,window.componentHandler=bt,window.addEventListener("load",function(){"use strict";"classList"in document.createElement("div")&&"querySelector"in document&&"addEventListener"in window&&Array.prototype.forEach?(document.documentElement.classList.add("mdl-js"),bt.upgradeAllRegistered()):(bt.upgradeElement=function(){},bt.register=function(){})})},9812:()=>{!function(){"use strict";var bt=function(Ee){this.element_=Ee,this.init()};window.MaterialProgress=bt,bt.prototype.Constant_={},bt.prototype.CssClasses_={INDETERMINATE_CLASS:"mdl-progress__indeterminate"},bt.prototype.setProgress=bt.prototype.setProgress=function(vt){this.element_.classList.contains(this.CssClasses_.INDETERMINATE_CLASS)||(this.progressbar_.style.width=vt+"%")},bt.prototype.setBuffer=bt.prototype.setBuffer=function(vt){this.bufferbar_.style.width=vt+"%",this.auxbar_.style.width=100-vt+"%"},bt.prototype.init=function(){if(this.element_){var vt=document.createElement("div");vt.className="progressbar bar bar1",this.element_.appendChild(vt),this.progressbar_=vt,(vt=document.createElement("div")).className="bufferbar bar bar2",this.element_.appendChild(vt),this.bufferbar_=vt,(vt=document.createElement("div")).className="auxbar bar bar3",this.element_.appendChild(vt),this.auxbar_=vt,this.progressbar_.style.width="0%",this.bufferbar_.style.width="100%",this.auxbar_.style.width="0%",this.element_.classList.add("is-upgraded")}},componentHandler.register({constructor:bt,classAsString:"MaterialProgress",cssClass:"mdl-js-progress",widget:!0})}()},7792:()=>{!function(){"use strict";var bt=function(Ee){this.element_=Ee,this.init()};window.MaterialSpinner=bt,bt.prototype.Constant_={MDL_SPINNER_LAYER_COUNT:4},bt.prototype.CssClasses_={MDL_SPINNER_LAYER:"mdl-spinner__layer",MDL_SPINNER_CIRCLE_CLIPPER:"mdl-spinner__circle-clipper",MDL_SPINNER_CIRCLE:"mdl-spinner__circle",MDL_SPINNER_GAP_PATCH:"mdl-spinner__gap-patch",MDL_SPINNER_LEFT:"mdl-spinner__left",MDL_SPINNER_RIGHT:"mdl-spinner__right"},bt.prototype.createLayer=bt.prototype.createLayer=function(vt){var Ee=document.createElement("div");Ee.classList.add(this.CssClasses_.MDL_SPINNER_LAYER),Ee.classList.add(this.CssClasses_.MDL_SPINNER_LAYER+"-"+vt);var pe=document.createElement("div");pe.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE_CLIPPER),pe.classList.add(this.CssClasses_.MDL_SPINNER_LEFT);var o=document.createElement("div");o.classList.add(this.CssClasses_.MDL_SPINNER_GAP_PATCH);var xe=document.createElement("div");xe.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE_CLIPPER),xe.classList.add(this.CssClasses_.MDL_SPINNER_RIGHT);for(var ct=[pe,o,xe],Ct=0;Ct<ct.length;Ct++){var Ht=document.createElement("div");Ht.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE),ct[Ct].appendChild(Ht)}Ee.appendChild(pe),Ee.appendChild(o),Ee.appendChild(xe),this.element_.appendChild(Ee)},bt.prototype.stop=bt.prototype.stop=function(){this.element_.classList.remove("is-active")},bt.prototype.start=bt.prototype.start=function(){this.element_.classList.add("is-active")},bt.prototype.init=function(){if(this.element_){for(var vt=1;vt<=this.Constant_.MDL_SPINNER_LAYER_COUNT;vt++)this.createLayer(vt);this.element_.classList.add("is-upgraded")}},componentHandler.register({constructor:bt,classAsString:"MaterialSpinner",cssClass:"mdl-js-spinner",widget:!0})}()},2910:()=>{!function(){"use strict";var bt=function(Ee){this.element_=Ee,this.maxRows=this.Constant_.NO_MAX_ROWS,this.init()};window.MaterialTextfield=bt,bt.prototype.Constant_={NO_MAX_ROWS:-1,MAX_ROWS_ATTRIBUTE:"maxrows"},bt.prototype.CssClasses_={LABEL:"mdl-textfield__label",INPUT:"mdl-textfield__input",IS_DIRTY:"is-dirty",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_INVALID:"is-invalid",IS_UPGRADED:"is-upgraded",HAS_PLACEHOLDER:"has-placeholder"},bt.prototype.onKeyDown_=function(vt){var Ee=vt.target.value.split("\n").length;13===vt.keyCode&&Ee>=this.maxRows&&vt.preventDefault()},bt.prototype.onFocus_=function(vt){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},bt.prototype.onBlur_=function(vt){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},bt.prototype.onReset_=function(vt){this.updateClasses_()},bt.prototype.updateClasses_=function(){this.checkDisabled(),this.checkValidity(),this.checkDirty(),this.checkFocus()},bt.prototype.checkDisabled=bt.prototype.checkDisabled=function(){this.input_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},bt.prototype.checkFocus=bt.prototype.checkFocus=function(){Boolean(this.element_.querySelector(":focus"))?this.element_.classList.add(this.CssClasses_.IS_FOCUSED):this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},bt.prototype.checkValidity=bt.prototype.checkValidity=function(){this.input_.validity&&(this.input_.validity.valid?this.element_.classList.remove(this.CssClasses_.IS_INVALID):this.element_.classList.add(this.CssClasses_.IS_INVALID))},bt.prototype.checkDirty=bt.prototype.checkDirty=function(){this.input_.value&&this.input_.value.length>0?this.element_.classList.add(this.CssClasses_.IS_DIRTY):this.element_.classList.remove(this.CssClasses_.IS_DIRTY)},bt.prototype.disable=bt.prototype.disable=function(){this.input_.disabled=!0,this.updateClasses_()},bt.prototype.enable=bt.prototype.enable=function(){this.input_.disabled=!1,this.updateClasses_()},bt.prototype.change=bt.prototype.change=function(vt){this.input_.value=vt||"",this.updateClasses_()},bt.prototype.init=function(){if(this.element_&&(this.label_=this.element_.querySelector("."+this.CssClasses_.LABEL),this.input_=this.element_.querySelector("."+this.CssClasses_.INPUT),this.input_)){this.input_.hasAttribute(this.Constant_.MAX_ROWS_ATTRIBUTE)&&(this.maxRows=parseInt(this.input_.getAttribute(this.Constant_.MAX_ROWS_ATTRIBUTE),10),isNaN(this.maxRows)&&(this.maxRows=this.Constant_.NO_MAX_ROWS)),this.input_.hasAttribute("placeholder")&&this.element_.classList.add(this.CssClasses_.HAS_PLACEHOLDER),this.boundUpdateClassesHandler=this.updateClasses_.bind(this),this.boundFocusHandler=this.onFocus_.bind(this),this.boundBlurHandler=this.onBlur_.bind(this),this.boundResetHandler=this.onReset_.bind(this),this.input_.addEventListener("input",this.boundUpdateClassesHandler),this.input_.addEventListener("focus",this.boundFocusHandler),this.input_.addEventListener("blur",this.boundBlurHandler),this.input_.addEventListener("reset",this.boundResetHandler),this.maxRows!==this.Constant_.NO_MAX_ROWS&&(this.boundKeyDownHandler=this.onKeyDown_.bind(this),this.input_.addEventListener("keydown",this.boundKeyDownHandler));var vt=this.element_.classList.contains(this.CssClasses_.IS_INVALID);this.updateClasses_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED),vt&&this.element_.classList.add(this.CssClasses_.IS_INVALID),this.input_.hasAttribute("autofocus")&&(this.element_.focus(),this.checkFocus())}},componentHandler.register({constructor:bt,classAsString:"MaterialTextfield",cssClass:"mdl-js-textfield",widget:!0})}()},9751:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{y:()=>ze});var pe=Ee(930),o=Ee(727),xe=Ee(8822),ct=Ee(9635),Ct=Ee(2416),Ht=Ee(576),y=Ee(2806);let ze=(()=>{class nt{constructor(ft){ft&&(this._subscribe=ft)}lift(ft){const ln=new nt;return ln.source=this,ln.operator=ft,ln}subscribe(ft,ln,Ze){const Je=function Ne(nt){return nt&&nt instanceof pe.Lv||function qe(nt){return nt&&(0,Ht.m)(nt.next)&&(0,Ht.m)(nt.error)&&(0,Ht.m)(nt.complete)}(nt)&&(0,o.Nn)(nt)}(ft)?ft:new pe.Hp(ft,ln,Ze);return(0,y.x)(()=>{const{operator:dt,source:Ot}=this;Je.add(dt?dt.call(Je,Ot):Ot?this._subscribe(Je):this._trySubscribe(Je))}),Je}_trySubscribe(ft){try{return this._subscribe(ft)}catch(ln){ft.error(ln)}}forEach(ft,ln){return new(ln=ht(ln))((Ze,Je)=>{const dt=new pe.Hp({next:Ot=>{try{ft(Ot)}catch(Jt){Je(Jt),dt.unsubscribe()}},error:Je,complete:Ze});this.subscribe(dt)})}_subscribe(ft){var ln;return null===(ln=this.source)||void 0===ln?void 0:ln.subscribe(ft)}[xe.L](){return this}pipe(...ft){return(0,ct.U)(ft)(this)}toPromise(ft){return new(ft=ht(ft))((ln,Ze)=>{let Je;this.subscribe(dt=>Je=dt,dt=>Ze(dt),()=>ln(Je))})}}return nt.create=fn=>new nt(fn),nt})();function ht(nt){var fn;return null!==(fn=nt??Ct.v.Promise)&&void 0!==fn?fn:Promise}},7579:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{x:()=>y});var pe=Ee(9751),o=Ee(727);const ct=(0,Ee(3888).d)(ht=>function(){ht(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ct=Ee(8737),Ht=Ee(2806);let y=(()=>{class ht extends pe.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(Ne){const nt=new ze(this,this);return nt.operator=Ne,nt}_throwIfClosed(){if(this.closed)throw new ct}next(Ne){(0,Ht.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const nt of this.currentObservers)nt.next(Ne)}})}error(Ne){(0,Ht.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=Ne;const{observers:nt}=this;for(;nt.length;)nt.shift().error(Ne)}})}complete(){(0,Ht.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:Ne}=this;for(;Ne.length;)Ne.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var Ne;return(null===(Ne=this.observers)||void 0===Ne?void 0:Ne.length)>0}_trySubscribe(Ne){return this._throwIfClosed(),super._trySubscribe(Ne)}_subscribe(Ne){return this._throwIfClosed(),this._checkFinalizedStatuses(Ne),this._innerSubscribe(Ne)}_innerSubscribe(Ne){const{hasError:nt,isStopped:fn,observers:ft}=this;return nt||fn?o.Lc:(this.currentObservers=null,ft.push(Ne),new o.w0(()=>{this.currentObservers=null,(0,Ct.P)(ft,Ne)}))}_checkFinalizedStatuses(Ne){const{hasError:nt,thrownError:fn,isStopped:ft}=this;nt?Ne.error(fn):ft&&Ne.complete()}asObservable(){const Ne=new pe.y;return Ne.source=this,Ne}}return ht.create=(qe,Ne)=>new ze(qe,Ne),ht})();class ze extends y{constructor(qe,Ne){super(),this.destination=qe,this.source=Ne}next(qe){var Ne,nt;null===(nt=null===(Ne=this.destination)||void 0===Ne?void 0:Ne.next)||void 0===nt||nt.call(Ne,qe)}error(qe){var Ne,nt;null===(nt=null===(Ne=this.destination)||void 0===Ne?void 0:Ne.error)||void 0===nt||nt.call(Ne,qe)}complete(){var qe,Ne;null===(Ne=null===(qe=this.destination)||void 0===qe?void 0:qe.complete)||void 0===Ne||Ne.call(qe)}_subscribe(qe){var Ne,nt;return null!==(nt=null===(Ne=this.source)||void 0===Ne?void 0:Ne.subscribe(qe))&&void 0!==nt?nt:o.Lc}}},930:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{Hp:()=>Ze,Lv:()=>nt});var pe=Ee(576),o=Ee(727),xe=Ee(2416),ct=Ee(7849),Ct=Ee(5032);const Ht=ht("C",void 0,void 0);function ht(st,Zt,nn){return{kind:st,value:Zt,error:nn}}var qe=Ee(3410),Ne=Ee(2806);class nt extends o.w0{constructor(Zt){super(),this.isStopped=!1,Zt?(this.destination=Zt,(0,o.Nn)(Zt)&&Zt.add(this)):this.destination=Jt}static create(Zt,nn,yn){return new Ze(Zt,nn,yn)}next(Zt){this.isStopped?Ot(function ze(st){return ht("N",st,void 0)}(Zt),this):this._next(Zt)}error(Zt){this.isStopped?Ot(function y(st){return ht("E",void 0,st)}(Zt),this):(this.isStopped=!0,this._error(Zt))}complete(){this.isStopped?Ot(Ht,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Zt){this.destination.next(Zt)}_error(Zt){try{this.destination.error(Zt)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const fn=Function.prototype.bind;function ft(st,Zt){return fn.call(st,Zt)}class ln{constructor(Zt){this.partialObserver=Zt}next(Zt){const{partialObserver:nn}=this;if(nn.next)try{nn.next(Zt)}catch(yn){Je(yn)}}error(Zt){const{partialObserver:nn}=this;if(nn.error)try{nn.error(Zt)}catch(yn){Je(yn)}else Je(Zt)}complete(){const{partialObserver:Zt}=this;if(Zt.complete)try{Zt.complete()}catch(nn){Je(nn)}}}class Ze extends nt{constructor(Zt,nn,yn){let it;if(super(),(0,pe.m)(Zt)||!Zt)it={next:Zt??void 0,error:nn??void 0,complete:yn??void 0};else{let zt;this&&xe.v.useDeprecatedNextContext?(zt=Object.create(Zt),zt.unsubscribe=()=>this.unsubscribe(),it={next:Zt.next&&ft(Zt.next,zt),error:Zt.error&&ft(Zt.error,zt),complete:Zt.complete&&ft(Zt.complete,zt)}):it=Zt}this.destination=new ln(it)}}function Je(st){xe.v.useDeprecatedSynchronousErrorHandling?(0,Ne.O)(st):(0,ct.h)(st)}function Ot(st,Zt){const{onStoppedNotification:nn}=xe.v;nn&&qe.z.setTimeout(()=>nn(st,Zt))}const Jt={closed:!0,next:Ct.Z,error:function dt(st){throw st},complete:Ct.Z}},727:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{Lc:()=>Ht,w0:()=>Ct,Nn:()=>y});var pe=Ee(576);const xe=(0,Ee(3888).d)(ht=>function(Ne){ht(this),this.message=Ne?`${Ne.length} errors occurred during unsubscription:\n${Ne.map((nt,fn)=>`${fn+1}) ${nt.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Ne});var ct=Ee(8737);class Ct{constructor(qe){this.initialTeardown=qe,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let qe;if(!this.closed){this.closed=!0;const{_parentage:Ne}=this;if(Ne)if(this._parentage=null,Array.isArray(Ne))for(const ft of Ne)ft.remove(this);else Ne.remove(this);const{initialTeardown:nt}=this;if((0,pe.m)(nt))try{nt()}catch(ft){qe=ft instanceof xe?ft.errors:[ft]}const{_finalizers:fn}=this;if(fn){this._finalizers=null;for(const ft of fn)try{ze(ft)}catch(ln){qe=qe??[],ln instanceof xe?qe=[...qe,...ln.errors]:qe.push(ln)}}if(qe)throw new xe(qe)}}add(qe){var Ne;if(qe&&qe!==this)if(this.closed)ze(qe);else{if(qe instanceof Ct){if(qe.closed||qe._hasParent(this))return;qe._addParent(this)}(this._finalizers=null!==(Ne=this._finalizers)&&void 0!==Ne?Ne:[]).push(qe)}}_hasParent(qe){const{_parentage:Ne}=this;return Ne===qe||Array.isArray(Ne)&&Ne.includes(qe)}_addParent(qe){const{_parentage:Ne}=this;this._parentage=Array.isArray(Ne)?(Ne.push(qe),Ne):Ne?[Ne,qe]:qe}_removeParent(qe){const{_parentage:Ne}=this;Ne===qe?this._parentage=null:Array.isArray(Ne)&&(0,ct.P)(Ne,qe)}remove(qe){const{_finalizers:Ne}=this;Ne&&(0,ct.P)(Ne,qe),qe instanceof Ct&&qe._removeParent(this)}}Ct.EMPTY=(()=>{const ht=new Ct;return ht.closed=!0,ht})();const Ht=Ct.EMPTY;function y(ht){return ht instanceof Ct||ht&&"closed"in ht&&(0,pe.m)(ht.remove)&&(0,pe.m)(ht.add)&&(0,pe.m)(ht.unsubscribe)}function ze(ht){(0,pe.m)(ht)?ht():ht.unsubscribe()}},2416:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{v:()=>pe});const pe={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{E:()=>o});const o=new(Ee(9751).y)(Ct=>Ct.complete())},8996:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{D:()=>Zt});var pe=Ee(8421),o=Ee(5363),xe=Ee(9468),Ht=Ee(9751),ze=Ee(2202),ht=Ee(576),qe=Ee(9672);function nt(nn,yn){if(!nn)throw new Error("Iterable cannot be null");return new Ht.y(it=>{(0,qe.f)(it,yn,()=>{const zt=nn[Symbol.asyncIterator]();(0,qe.f)(it,yn,()=>{zt.next().then(en=>{en.done?it.complete():it.next(en.value)})},0,!0)})})}var fn=Ee(3670),ft=Ee(8239),ln=Ee(1144),Ze=Ee(6495),Je=Ee(2206),dt=Ee(4532),Ot=Ee(3260);function Zt(nn,yn){return yn?function st(nn,yn){if(null!=nn){if((0,fn.c)(nn))return function ct(nn,yn){return(0,pe.Xf)(nn).pipe((0,xe.R)(yn),(0,o.Q)(yn))}(nn,yn);if((0,ln.z)(nn))return function y(nn,yn){return new Ht.y(it=>{let zt=0;return yn.schedule(function(){zt===nn.length?it.complete():(it.next(nn[zt++]),it.closed||this.schedule())})})}(nn,yn);if((0,ft.t)(nn))return function Ct(nn,yn){return(0,pe.Xf)(nn).pipe((0,xe.R)(yn),(0,o.Q)(yn))}(nn,yn);if((0,Je.D)(nn))return nt(nn,yn);if((0,Ze.T)(nn))return function Ne(nn,yn){return new Ht.y(it=>{let zt;return(0,qe.f)(it,yn,()=>{zt=nn[ze.h](),(0,qe.f)(it,yn,()=>{let en,gt;try{({value:en,done:gt}=zt.next())}catch(xt){return void it.error(xt)}gt?it.complete():it.next(en)},0,!0)}),()=>(0,ht.m)(zt?.return)&&zt.return()})}(nn,yn);if((0,Ot.L)(nn))return function Jt(nn,yn){return nt((0,Ot.Q)(nn),yn)}(nn,yn)}throw(0,dt.z)(nn)}(nn,yn):(0,pe.Xf)(nn)}},8421:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{Xf:()=>fn});var pe=Ee(655),o=Ee(1144),xe=Ee(8239),ct=Ee(9751),Ct=Ee(3670),Ht=Ee(2206),y=Ee(4532),ze=Ee(6495),ht=Ee(3260),qe=Ee(576),Ne=Ee(7849),nt=Ee(8822);function fn(st){if(st instanceof ct.y)return st;if(null!=st){if((0,Ct.c)(st))return function ft(st){return new ct.y(Zt=>{const nn=st[nt.L]();if((0,qe.m)(nn.subscribe))return nn.subscribe(Zt);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(st);if((0,o.z)(st))return function ln(st){return new ct.y(Zt=>{for(let nn=0;nn<st.length&&!Zt.closed;nn++)Zt.next(st[nn]);Zt.complete()})}(st);if((0,xe.t)(st))return function Ze(st){return new ct.y(Zt=>{st.then(nn=>{Zt.closed||(Zt.next(nn),Zt.complete())},nn=>Zt.error(nn)).then(null,Ne.h)})}(st);if((0,Ht.D)(st))return dt(st);if((0,ze.T)(st))return function Je(st){return new ct.y(Zt=>{for(const nn of st)if(Zt.next(nn),Zt.closed)return;Zt.complete()})}(st);if((0,ht.L)(st))return function Ot(st){return dt((0,ht.Q)(st))}(st)}throw(0,y.z)(st)}function dt(st){return new ct.y(Zt=>{(function Jt(st,Zt){var nn,yn,it,zt;return(0,pe.mG)(this,void 0,void 0,function*(){try{for(nn=(0,pe.KL)(st);!(yn=yield nn.next()).done;)if(Zt.next(yn.value),Zt.closed)return}catch(en){it={error:en}}finally{try{yn&&!yn.done&&(zt=nn.return)&&(yield zt.call(nn))}finally{if(it)throw it.error}}Zt.complete()})})(st,Zt).catch(nn=>Zt.error(nn))})}},6451:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{T:()=>Ht});var pe=Ee(8189),o=Ee(8421),xe=Ee(515),ct=Ee(3269),Ct=Ee(8996);function Ht(...y){const ze=(0,ct.yG)(y),ht=(0,ct._6)(y,1/0),qe=y;return qe.length?1===qe.length?(0,o.Xf)(qe[0]):(0,pe.J)(ht)((0,Ct.D)(qe,ze)):xe.E}},5403:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{x:()=>o});var pe=Ee(930);function o(ct,Ct,Ht,y,ze){return new xe(ct,Ct,Ht,y,ze)}class xe extends pe.Lv{constructor(Ct,Ht,y,ze,ht,qe){super(Ct),this.onFinalize=ht,this.shouldUnsubscribe=qe,this._next=Ht?function(Ne){try{Ht(Ne)}catch(nt){Ct.error(nt)}}:super._next,this._error=ze?function(Ne){try{ze(Ne)}catch(nt){Ct.error(nt)}finally{this.unsubscribe()}}:super._error,this._complete=y?function(){try{y()}catch(Ne){Ct.error(Ne)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var Ct;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Ht}=this;super.unsubscribe(),!Ht&&(null===(Ct=this.onFinalize)||void 0===Ct||Ct.call(this))}}}},4004:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{U:()=>xe});var pe=Ee(4482),o=Ee(5403);function xe(ct,Ct){return(0,pe.e)((Ht,y)=>{let ze=0;Ht.subscribe((0,o.x)(y,ht=>{y.next(ct.call(Ct,ht,ze++))}))})}},8189:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{J:()=>xe});var pe=Ee(5577),o=Ee(4671);function xe(ct=1/0){return(0,pe.z)(o.y,ct)}},5577:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{z:()=>ze});var pe=Ee(4004),o=Ee(8421),xe=Ee(4482),ct=Ee(9672),Ct=Ee(5403),y=Ee(576);function ze(ht,qe,Ne=1/0){return(0,y.m)(qe)?ze((nt,fn)=>(0,pe.U)((ft,ln)=>qe(nt,ft,fn,ln))((0,o.Xf)(ht(nt,fn))),Ne):("number"==typeof qe&&(Ne=qe),(0,xe.e)((nt,fn)=>function Ht(ht,qe,Ne,nt,fn,ft,ln,Ze){const Je=[];let dt=0,Ot=0,Jt=!1;const st=()=>{Jt&&!Je.length&&!dt&&qe.complete()},Zt=yn=>dt<nt?nn(yn):Je.push(yn),nn=yn=>{ft&&qe.next(yn),dt++;let it=!1;(0,o.Xf)(Ne(yn,Ot++)).subscribe((0,Ct.x)(qe,zt=>{fn?.(zt),ft?Zt(zt):qe.next(zt)},()=>{it=!0},void 0,()=>{if(it)try{for(dt--;Je.length&&dt<nt;){const zt=Je.shift();ln?(0,ct.f)(qe,ln,()=>nn(zt)):nn(zt)}st()}catch(zt){qe.error(zt)}}))};return ht.subscribe((0,Ct.x)(qe,Zt,()=>{Jt=!0,st()})),()=>{Ze?.()}}(nt,fn,ht,Ne)))}},5363:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{Q:()=>ct});var pe=Ee(9672),o=Ee(4482),xe=Ee(5403);function ct(Ct,Ht=0){return(0,o.e)((y,ze)=>{y.subscribe((0,xe.x)(ze,ht=>(0,pe.f)(ze,Ct,()=>ze.next(ht),Ht),()=>(0,pe.f)(ze,Ct,()=>ze.complete(),Ht),ht=>(0,pe.f)(ze,Ct,()=>ze.error(ht),Ht)))})}},3099:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{B:()=>Ct});var pe=Ee(8421),o=Ee(7579),xe=Ee(930),ct=Ee(4482);function Ct(y={}){const{connector:ze=(()=>new o.x),resetOnError:ht=!0,resetOnComplete:qe=!0,resetOnRefCountZero:Ne=!0}=y;return nt=>{let fn,ft,ln,Ze=0,Je=!1,dt=!1;const Ot=()=>{ft?.unsubscribe(),ft=void 0},Jt=()=>{Ot(),fn=ln=void 0,Je=dt=!1},st=()=>{const Zt=fn;Jt(),Zt?.unsubscribe()};return(0,ct.e)((Zt,nn)=>{Ze++,!dt&&!Je&&Ot();const yn=ln=ln??ze();nn.add(()=>{Ze--,0===Ze&&!dt&&!Je&&(ft=Ht(st,Ne))}),yn.subscribe(nn),!fn&&Ze>0&&(fn=new xe.Hp({next:it=>yn.next(it),error:it=>{dt=!0,Ot(),ft=Ht(Jt,ht,it),yn.error(it)},complete:()=>{Je=!0,Ot(),ft=Ht(Jt,qe),yn.complete()}}),(0,pe.Xf)(Zt).subscribe(fn))})(nt)}}function Ht(y,ze,...ht){if(!0===ze)return void y();if(!1===ze)return;const qe=new xe.Hp({next:()=>{qe.unsubscribe(),y()}});return(0,pe.Xf)(ze(...ht)).subscribe(qe)}},9468:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{R:()=>o});var pe=Ee(4482);function o(xe,ct=0){return(0,pe.e)((Ct,Ht)=>{Ht.add(xe.schedule(()=>Ct.subscribe(Ht),ct))})}},8505:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{b:()=>Ct});var pe=Ee(576),o=Ee(4482),xe=Ee(5403),ct=Ee(4671);function Ct(Ht,y,ze){const ht=(0,pe.m)(Ht)||y||ze?{next:Ht,error:y,complete:ze}:Ht;return ht?(0,o.e)((qe,Ne)=>{var nt;null===(nt=ht.subscribe)||void 0===nt||nt.call(ht);let fn=!0;qe.subscribe((0,xe.x)(Ne,ft=>{var ln;null===(ln=ht.next)||void 0===ln||ln.call(ht,ft),Ne.next(ft)},()=>{var ft;fn=!1,null===(ft=ht.complete)||void 0===ft||ft.call(ht),Ne.complete()},ft=>{var ln;fn=!1,null===(ln=ht.error)||void 0===ln||ln.call(ht,ft),Ne.error(ft)},()=>{var ft,ln;fn&&(null===(ft=ht.unsubscribe)||void 0===ft||ft.call(ht)),null===(ln=ht.finalize)||void 0===ln||ln.call(ht)}))}):ct.y}},4408:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{o:()=>Ct});var pe=Ee(727);class o extends pe.w0{constructor(y,ze){super()}schedule(y,ze=0){return this}}const xe={setInterval(Ht,y,...ze){const{delegate:ht}=xe;return ht?.setInterval?ht.setInterval(Ht,y,...ze):setInterval(Ht,y,...ze)},clearInterval(Ht){const{delegate:y}=xe;return(y?.clearInterval||clearInterval)(Ht)},delegate:void 0};var ct=Ee(8737);class Ct extends o{constructor(y,ze){super(y,ze),this.scheduler=y,this.work=ze,this.pending=!1}schedule(y,ze=0){var ht;if(this.closed)return this;this.state=y;const qe=this.id,Ne=this.scheduler;return null!=qe&&(this.id=this.recycleAsyncId(Ne,qe,ze)),this.pending=!0,this.delay=ze,this.id=null!==(ht=this.id)&&void 0!==ht?ht:this.requestAsyncId(Ne,this.id,ze),this}requestAsyncId(y,ze,ht=0){return xe.setInterval(y.flush.bind(y,this),ht)}recycleAsyncId(y,ze,ht=0){if(null!=ht&&this.delay===ht&&!1===this.pending)return ze;null!=ze&&xe.clearInterval(ze)}execute(y,ze){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const ht=this._execute(y,ze);if(ht)return ht;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(y,ze){let qe,ht=!1;try{this.work(y)}catch(Ne){ht=!0,qe=Ne||new Error("Scheduled action threw falsy error")}if(ht)return this.unsubscribe(),qe}unsubscribe(){if(!this.closed){const{id:y,scheduler:ze}=this,{actions:ht}=ze;this.work=this.state=this.scheduler=null,this.pending=!1,(0,ct.P)(ht,this),null!=y&&(this.id=this.recycleAsyncId(ze,y,null)),this.delay=null,super.unsubscribe()}}}},7565:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{v:()=>xe});var pe=Ee(6063);class o{constructor(Ct,Ht=o.now){this.schedulerActionCtor=Ct,this.now=Ht}schedule(Ct,Ht=0,y){return new this.schedulerActionCtor(this,Ct).schedule(y,Ht)}}o.now=pe.l.now;class xe extends o{constructor(Ct,Ht=o.now){super(Ct,Ht),this.actions=[],this._active=!1}flush(Ct){const{actions:Ht}=this;if(this._active)return void Ht.push(Ct);let y;this._active=!0;do{if(y=Ct.execute(Ct.state,Ct.delay))break}while(Ct=Ht.shift());if(this._active=!1,y){for(;Ct=Ht.shift();)Ct.unsubscribe();throw y}}}},4986:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{P:()=>ct,z:()=>xe});var pe=Ee(4408);const xe=new(Ee(7565).v)(pe.o),ct=xe},6063:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{l:()=>pe});const pe={now:()=>(pe.delegate||Date).now(),delegate:void 0}},233:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{N:()=>Ct});var pe=Ee(4408),xe=Ee(7565);const Ct=new class ct extends xe.v{}(class o extends pe.o{constructor(ze,ht){super(ze,ht),this.scheduler=ze,this.work=ht}schedule(ze,ht=0){return ht>0?super.schedule(ze,ht):(this.delay=ht,this.state=ze,this.scheduler.flush(this),this)}execute(ze,ht){return ht>0||this.closed?super.execute(ze,ht):this._execute(ze,ht)}requestAsyncId(ze,ht,qe=0){return null!=qe&&qe>0||null==qe&&this.delay>0?super.requestAsyncId(ze,ht,qe):(ze.flush(this),0)}})},3410:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{z:()=>pe});const pe={setTimeout(o,xe,...ct){const{delegate:Ct}=pe;return Ct?.setTimeout?Ct.setTimeout(o,xe,...ct):setTimeout(o,xe,...ct)},clearTimeout(o){const{delegate:xe}=pe;return(xe?.clearTimeout||clearTimeout)(o)},delegate:void 0}},2202:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{h:()=>o});const o=function pe(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{L:()=>pe});const pe="function"==typeof Symbol&&Symbol.observable||"@@observable"},3269:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{_6:()=>Ht,jO:()=>ct,yG:()=>Ct});var pe=Ee(576),o=Ee(3532);function xe(y){return y[y.length-1]}function ct(y){return(0,pe.m)(xe(y))?y.pop():void 0}function Ct(y){return(0,o.K)(xe(y))?y.pop():void 0}function Ht(y,ze){return"number"==typeof xe(y)?y.pop():ze}},8737:(bt,vt,Ee)=>{"use strict";function pe(o,xe){if(o){const ct=o.indexOf(xe);0<=ct&&o.splice(ct,1)}}Ee.d(vt,{P:()=>pe})},3888:(bt,vt,Ee)=>{"use strict";function pe(o){const ct=o(Ct=>{Error.call(Ct),Ct.stack=(new Error).stack});return ct.prototype=Object.create(Error.prototype),ct.prototype.constructor=ct,ct}Ee.d(vt,{d:()=>pe})},2806:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{O:()=>ct,x:()=>xe});var pe=Ee(2416);let o=null;function xe(Ct){if(pe.v.useDeprecatedSynchronousErrorHandling){const Ht=!o;if(Ht&&(o={errorThrown:!1,error:null}),Ct(),Ht){const{errorThrown:y,error:ze}=o;if(o=null,y)throw ze}}else Ct()}function ct(Ct){pe.v.useDeprecatedSynchronousErrorHandling&&o&&(o.errorThrown=!0,o.error=Ct)}},9672:(bt,vt,Ee)=>{"use strict";function pe(o,xe,ct,Ct=0,Ht=!1){const y=xe.schedule(function(){ct(),Ht?o.add(this.schedule(null,Ct)):this.unsubscribe()},Ct);if(o.add(y),!Ht)return y}Ee.d(vt,{f:()=>pe})},4671:(bt,vt,Ee)=>{"use strict";function pe(o){return o}Ee.d(vt,{y:()=>pe})},1144:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{z:()=>pe});const pe=o=>o&&"number"==typeof o.length&&"function"!=typeof o},2206:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{D:()=>o});var pe=Ee(576);function o(xe){return Symbol.asyncIterator&&(0,pe.m)(xe?.[Symbol.asyncIterator])}},576:(bt,vt,Ee)=>{"use strict";function pe(o){return"function"==typeof o}Ee.d(vt,{m:()=>pe})},3670:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{c:()=>xe});var pe=Ee(8822),o=Ee(576);function xe(ct){return(0,o.m)(ct[pe.L])}},6495:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{T:()=>xe});var pe=Ee(2202),o=Ee(576);function xe(ct){return(0,o.m)(ct?.[pe.h])}},8239:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{t:()=>o});var pe=Ee(576);function o(xe){return(0,pe.m)(xe?.then)}},3260:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{L:()=>ct,Q:()=>xe});var pe=Ee(655),o=Ee(576);function xe(Ct){return(0,pe.FC)(this,arguments,function*(){const y=Ct.getReader();try{for(;;){const{value:ze,done:ht}=yield(0,pe.qq)(y.read());if(ht)return yield(0,pe.qq)(void 0);yield yield(0,pe.qq)(ze)}}finally{y.releaseLock()}})}function ct(Ct){return(0,o.m)(Ct?.getReader)}},3532:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{K:()=>o});var pe=Ee(576);function o(xe){return xe&&(0,pe.m)(xe.schedule)}},4482:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{A:()=>o,e:()=>xe});var pe=Ee(576);function o(ct){return(0,pe.m)(ct?.lift)}function xe(ct){return Ct=>{if(o(Ct))return Ct.lift(function(Ht){try{return ct(Ht,this)}catch(y){this.error(y)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(bt,vt,Ee)=>{"use strict";function pe(){}Ee.d(vt,{Z:()=>pe})},9635:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{U:()=>xe,z:()=>o});var pe=Ee(4671);function o(...ct){return xe(ct)}function xe(ct){return 0===ct.length?pe.y:1===ct.length?ct[0]:function(Ht){return ct.reduce((y,ze)=>ze(y),Ht)}}},7849:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{h:()=>xe});var pe=Ee(2416),o=Ee(3410);function xe(ct){o.z.setTimeout(()=>{const{onUnhandledError:Ct}=pe.v;if(!Ct)throw ct;Ct(ct)})}},4532:(bt,vt,Ee)=>{"use strict";function pe(o){return new TypeError(`You provided ${null!==o&&"object"==typeof o?"an invalid object":`'${o}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}Ee.d(vt,{z:()=>pe})},655:(bt,vt,Ee)=>{"use strict";function ct(gt,xt){var Lt={};for(var It in gt)Object.prototype.hasOwnProperty.call(gt,It)&&xt.indexOf(It)<0&&(Lt[It]=gt[It]);if(null!=gt&&"function"==typeof Object.getOwnPropertySymbols){var Vt=0;for(It=Object.getOwnPropertySymbols(gt);Vt<It.length;Vt++)xt.indexOf(It[Vt])<0&&Object.prototype.propertyIsEnumerable.call(gt,It[Vt])&&(Lt[It[Vt]]=gt[It[Vt]])}return Lt}function Ct(gt,xt,Lt,It){var ai,Vt=arguments.length,wn=Vt<3?xt:null===It?It=Object.getOwnPropertyDescriptor(xt,Lt):It;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)wn=Reflect.decorate(gt,xt,Lt,It);else for(var ir=gt.length-1;ir>=0;ir--)(ai=gt[ir])&&(wn=(Vt<3?ai(wn):Vt>3?ai(xt,Lt,wn):ai(xt,Lt))||wn);return Vt>3&&wn&&Object.defineProperty(xt,Lt,wn),wn}function ze(gt,xt,Lt,It){return new(Lt||(Lt=Promise))(function(wn,ai){function ir(zi){try{vi(It.next(zi))}catch(ri){ai(ri)}}function Ni(zi){try{vi(It.throw(zi))}catch(ri){ai(ri)}}function vi(zi){zi.done?wn(zi.value):function Vt(wn){return wn instanceof Lt?wn:new Lt(function(ai){ai(wn)})}(zi.value).then(ir,Ni)}vi((It=It.apply(gt,xt||[])).next())})}function Je(gt){return this instanceof Je?(this.v=gt,this):new Je(gt)}function dt(gt,xt,Lt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Vt,It=Lt.apply(gt,xt||[]),wn=[];return Vt={},ai("next"),ai("throw"),ai("return"),Vt[Symbol.asyncIterator]=function(){return this},Vt;function ai(or){It[or]&&(Vt[or]=function(Bo){return new Promise(function($i,bi){wn.push([or,Bo,$i,bi])>1||ir(or,Bo)})})}function ir(or,Bo){try{!function Ni(or){or.value instanceof Je?Promise.resolve(or.value.v).then(vi,zi):ri(wn[0][2],or)}(It[or](Bo))}catch($i){ri(wn[0][3],$i)}}function vi(or){ir("next",or)}function zi(or){ir("throw",or)}function ri(or,Bo){or(Bo),wn.shift(),wn.length&&ir(wn[0][0],wn[0][1])}}function Jt(gt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Lt,xt=gt[Symbol.asyncIterator];return xt?xt.call(gt):(gt=function nt(gt){var xt="function"==typeof Symbol&&Symbol.iterator,Lt=xt&&gt[xt],It=0;if(Lt)return Lt.call(gt);if(gt&&"number"==typeof gt.length)return{next:function(){return gt&&It>=gt.length&&(gt=void 0),{value:gt&&gt[It++],done:!gt}}};throw new TypeError(xt?"Object is not iterable.":"Symbol.iterator is not defined.")}(gt),Lt={},It("next"),It("throw"),It("return"),Lt[Symbol.asyncIterator]=function(){return this},Lt);function It(wn){Lt[wn]=gt[wn]&&function(ai){return new Promise(function(ir,Ni){!function Vt(wn,ai,ir,Ni){Promise.resolve(Ni).then(function(vi){wn({value:vi,done:ir})},ai)}(ir,Ni,(ai=gt[wn](ai)).done,ai.value)})}}}Ee.d(vt,{FC:()=>dt,KL:()=>Jt,_T:()=>ct,gn:()=>Ct,mG:()=>ze,qq:()=>Je})},7621:(bt,vt,Ee)=>{"use strict";function pe(){return new Worker(Ee.p+"mapbox-gl-csp-worker.2179423728250a30.worker.js")}Ee.d(vt,{Z:()=>pe})},8416:(bt,vt,Ee)=>{var pe=Ee(4062);bt.exports=function o(xe,ct,Ct){return(ct=pe(ct))in xe?Object.defineProperty(xe,ct,{value:Ct,enumerable:!0,configurable:!0,writable:!0}):xe[ct]=Ct,xe},bt.exports.__esModule=!0,bt.exports.default=bt.exports},5036:(bt,vt,Ee)=>{var pe=Ee(8698).default;bt.exports=function o(xe,ct){if("object"!==pe(xe)||null===xe)return xe;var Ct=xe[Symbol.toPrimitive];if(void 0!==Ct){var Ht=Ct.call(xe,ct||"default");if("object"!==pe(Ht))return Ht;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===ct?String:Number)(xe)},bt.exports.__esModule=!0,bt.exports.default=bt.exports},4062:(bt,vt,Ee)=>{var pe=Ee(8698).default,o=Ee(5036);bt.exports=function xe(ct){var Ct=o(ct,"string");return"symbol"===pe(Ct)?Ct:String(Ct)},bt.exports.__esModule=!0,bt.exports.default=bt.exports},8698:bt=>{function vt(Ee){return bt.exports=vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(pe){return typeof pe}:function(pe){return pe&&"function"==typeof Symbol&&pe.constructor===Symbol&&pe!==Symbol.prototype?"symbol":typeof pe},bt.exports.__esModule=!0,bt.exports.default=bt.exports,vt(Ee)}bt.exports=vt,bt.exports.__esModule=!0,bt.exports.default=bt.exports},4650:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{$8M:()=>Ls,$WT:()=>Rt,$Z:()=>j0,AFp:()=>CT,ALo:()=>YD,AaK:()=>ze,Akn:()=>c,AsE:()=>Ft,BQk:()=>mc,CHM:()=>Pp,CRH:()=>bb,CZH:()=>Eg,CqO:()=>dg,D6c:()=>$_,DdM:()=>vR,EJc:()=>Db,EpF:()=>Px,F$t:()=>zh,F4k:()=>tb,FYo:()=>Yw,FiY:()=>G,G48:()=>v1,Gf:()=>nA,GfV:()=>L0,GkF:()=>af,Gpc:()=>Ne,Gre:()=>Pn,HTZ:()=>df,Hh0:()=>Si,Hsn:()=>dp,JOm:()=>hr,Jf7:()=>N0,KtG:()=>Op,LFG:()=>En,Lbi:()=>wA,Lck:()=>H3,MAs:()=>Rx,MMx:()=>$D,MR2:()=>Da,NdJ:()=>Yy,O4$:()=>ad,OlP:()=>Cr,Oqu:()=>Gt,P3R:()=>br,PXZ:()=>RT,Q6J:()=>im,QGY:()=>M_,QbO:()=>LR,Qsj:()=>s_,R0b:()=>Fd,RDi:()=>Va,Rgc:()=>V_,SBq:()=>Vf,Sil:()=>EA,Suo:()=>iA,TTD:()=>nu,TgZ:()=>rm,Tol:()=>v,Udp:()=>l,VKq:()=>bR,W1O:()=>n1,WLB:()=>wR,X6Q:()=>OA,XFs:()=>jn,Xpm:()=>cn,Xts:()=>Gc,Y36:()=>jf,YKP:()=>uR,YNc:()=>nm,Yjl:()=>vr,Yz7:()=>bi,Z0I:()=>fo,ZZ4:()=>Ev,_Bn:()=>cR,_UZ:()=>I_,_Vd:()=>qp,_c5:()=>kn,_uU:()=>St,aQg:()=>Ha,c2e:()=>Ib,cJS:()=>Vo,cg1:()=>uf,dDg:()=>vv,dqk:()=>wr,eFA:()=>bv,ekj:()=>s,eoX:()=>DA,f3M:()=>zn,g9A:()=>h1,gM2:()=>JD,h0i:()=>mb,hGG:()=>Aa,hij:()=>Qt,iGM:()=>uv,ifc:()=>ae,ip1:()=>Sb,jDz:()=>dR,kEZ:()=>xR,kL8:()=>N_,l5B:()=>CR,lG2:()=>li,lcZ:()=>_b,lqb:()=>Bf,lri:()=>DT,n5z:()=>dd,oAB:()=>di,oJD:()=>Lm,oxw:()=>ch,q4F:()=>Cd,qLn:()=>Kp,qOj:()=>ef,qZA:()=>hg,qbA:()=>ZD,rFY:()=>lr,rWj:()=>AT,s9C:()=>pg,sBO:()=>LA,s_b:()=>Xx,soG:()=>H_,tBr:()=>z,tb:()=>ET,tp0:()=>te,uIk:()=>Xf,vHH:()=>Je,vpe:()=>pf,wAp:()=>Fi,xp6:()=>c_,ynx:()=>A_,z2F:()=>_1,zSh:()=>Vm,zs3:()=>Yp});var pe=Ee(7579),o=Ee(727),xe=Ee(9751),ct=Ee(6451),Ct=Ee(3099);function Ht(d){for(let p in d)if(d[p]===Ht)return p;throw Error("Could not find renamed property on target object.")}function y(d,p){for(const m in p)p.hasOwnProperty(m)&&!d.hasOwnProperty(m)&&(d[m]=p[m])}function ze(d){if("string"==typeof d)return d;if(Array.isArray(d))return"["+d.map(ze).join(", ")+"]";if(null==d)return""+d;if(d.overriddenName)return`${d.overriddenName}`;if(d.name)return`${d.name}`;const p=d.toString();if(null==p)return""+p;const m=p.indexOf("\n");return-1===m?p:p.substring(0,m)}function ht(d,p){return null==d||""===d?null===p?"":p:null==p||""===p?d:d+" "+p}const qe=Ht({__forward_ref__:Ht});function Ne(d){return d.__forward_ref__=Ne,d.toString=function(){return ze(this())},d}function nt(d){return fn(d)?d():d}function fn(d){return"function"==typeof d&&d.hasOwnProperty(qe)&&d.__forward_ref__===Ne}function ft(d){return d&&!!d.\u0275providers}const Ze="https://g.co/ng/security#xss";class Je extends Error{constructor(p,m){super(function dt(d,p){return`NG0${Math.abs(d)}${p?": "+p.trim():""}`}(p,m)),this.code=p}}function Ot(d){return"string"==typeof d?d:null==d?"":String(d)}function yn(d,p){throw new Je(-201,!1)}function zi(d,p){null==d&&function ri(d,p,m,x){throw new Error(`ASSERTION ERROR: ${d}`+(null==x?"":` [Expected=> ${m} ${x} ${p} <=Actual]`))}(p,d,null,"!=")}function bi(d){return{token:d.token,providedIn:d.providedIn||null,factory:d.factory,value:void 0}}function Vo(d){return{providers:d.providers||[],imports:d.imports||[]}}function $r(d){return Ar(d,Xo)||Ar(d,Ao)}function fo(d){return null!==$r(d)}function Ar(d,p){return d.hasOwnProperty(p)?d[p]:null}function Rr(d){return d&&(d.hasOwnProperty(Gs)||d.hasOwnProperty(Pr))?d[Gs]:null}const Xo=Ht({\u0275prov:Ht}),Gs=Ht({\u0275inj:Ht}),Ao=Ht({ngInjectableDef:Ht}),Pr=Ht({ngInjectorDef:Ht});var jn=(()=>((jn=jn||{})[jn.Default=0]="Default",jn[jn.Host=1]="Host",jn[jn.Self=2]="Self",jn[jn.SkipSelf=4]="SkipSelf",jn[jn.Optional=8]="Optional",jn))();let Uo;function Wr(d){const p=Uo;return Uo=d,p}function es(d,p,m){const x=$r(d);return x&&"root"==x.providedIn?void 0===x.value?x.value=x.factory():x.value:m&jn.Optional?null:void 0!==p?p:void yn(ze(d))}const wr=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),ts={},Ur="__NG_DI_FLAG__",Ho="ngTempTokenPath",Jr=/\n/gm,mr="__source";let cs;function Bi(d){const p=cs;return cs=d,p}function qo(d,p=jn.Default){if(void 0===cs)throw new Je(-203,!1);return null===cs?es(d,void 0,p):cs.get(d,p&jn.Optional?null:void 0,p)}function En(d,p=jn.Default){return(function lo(){return Uo}()||qo)(nt(d),p)}function zn(d,p=jn.Default){return En(d,wi(p))}function wi(d){return typeof d>"u"||"number"==typeof d?d:0|(d.optional&&8)|(d.host&&1)|(d.self&&2)|(d.skipSelf&&4)}function Di(d){const p=[];for(let m=0;m<d.length;m++){const x=nt(d[m]);if(Array.isArray(x)){if(0===x.length)throw new Je(900,!1);let D,L=jn.Default;for(let H=0;H<x.length;H++){const q=x[H],ne=Qe(q);"number"==typeof ne?-1===ne?D=q.token:L|=ne:D=q}p.push(En(D,L))}else p.push(En(x))}return p}function er(d,p){return d[Ur]=p,d.prototype[Ur]=p,d}function Qe(d){return d[Ur]}function Ue(d){return{toString:d}.toString()}var Ce=(()=>((Ce=Ce||{})[Ce.OnPush=0]="OnPush",Ce[Ce.Default=1]="Default",Ce))(),ae=(()=>{return(d=ae||(ae={}))[d.Emulated=0]="Emulated",d[d.None=2]="None",d[d.ShadowDom=3]="ShadowDom",ae;var d})();const we={},De=[],Ve=Ht({\u0275cmp:Ht}),Ke=Ht({\u0275dir:Ht}),ot=Ht({\u0275pipe:Ht}),tt=Ht({\u0275mod:Ht}),rt=Ht({\u0275fac:Ht}),$t=Ht({__NG_ELEMENT_ID__:Ht});let Dn=0;function cn(d){return Ue(()=>{const m=!0===d.standalone,x={},D={type:d.type,providersResolver:null,decls:d.decls,vars:d.vars,factory:null,template:d.template||null,consts:d.consts||null,ngContentSelectors:d.ngContentSelectors,hostBindings:d.hostBindings||null,hostVars:d.hostVars||0,hostAttrs:d.hostAttrs||null,contentQueries:d.contentQueries||null,declaredInputs:x,inputs:null,outputs:null,exportAs:d.exportAs||null,onPush:d.changeDetection===Ce.OnPush,directiveDefs:null,pipeDefs:null,standalone:m,dependencies:m&&d.dependencies||null,getStandaloneInjector:null,selectors:d.selectors||De,viewQuery:d.viewQuery||null,features:d.features||null,data:d.data||{},encapsulation:d.encapsulation||ae.Emulated,id:"c"+Dn++,styles:d.styles||De,_:null,setInput:null,schemas:d.schemas||null,tView:null,findHostDirectiveDefs:null,hostDirectives:null},L=d.dependencies,H=d.features;return D.inputs=ur(d.inputs,x),D.outputs=ur(d.outputs),H&&H.forEach(q=>q(D)),D.directiveDefs=L?()=>("function"==typeof L?L():L).map(Xn).filter(Nn):null,D.pipeDefs=L?()=>("function"==typeof L?L():L).map(mo).filter(Nn):null,D})}function Xn(d){return ci(d)||Mr(d)}function Nn(d){return null!==d}function di(d){return Ue(()=>({type:d.type,bootstrap:d.bootstrap||De,declarations:d.declarations||De,imports:d.imports||De,exports:d.exports||De,transitiveCompileScopes:null,schemas:d.schemas||null,id:d.id||null}))}function ur(d,p){if(null==d)return we;const m={};for(const x in d)if(d.hasOwnProperty(x)){let D=d[x],L=D;Array.isArray(D)&&(L=D[1],D=D[0]),m[D]=x,p&&(p[D]=L)}return m}const li=cn;function vr(d){return{type:d.type,name:d.name,factory:null,pure:!1!==d.pure,standalone:!0===d.standalone,onDestroy:d.type.prototype.ngOnDestroy||null}}function ci(d){return d[Ve]||null}function Mr(d){return d[Ke]||null}function mo(d){return d[ot]||null}function Rt(d){const p=ci(d)||Mr(d)||mo(d);return null!==p&&p.standalone}function Ko(d,p){const m=d[tt]||null;if(!m&&!0===p)throw new Error(`Type ${ze(d)} does not have '\u0275mod' property.`);return m}function Rs(d){return Array.isArray(d)&&"object"==typeof d[1]}function uo(d){return Array.isArray(d)&&!0===d[1]}function ko(d){return 0!=(4&d.flags)}function Nu(d){return d.componentOffset>-1}function zu(d){return 1==(1&d.flags)}function fr(d){return null!==d.template}function Xh(d){return 0!=(256&d[2])}function ml(d,p){return d.hasOwnProperty(rt)?d[rt]:null}class Wl{constructor(p,m,x){this.previousValue=p,this.currentValue=m,this.firstChange=x}isFirstChange(){return this.firstChange}}function nu(){return iu}function iu(d){return d.type.prototype.ngOnChanges&&(d.setInput=Xa),Vu}function Vu(){const d=Dc(this),p=d?.current;if(p){const m=d.previous;if(m===we)d.previous=p;else for(let x in p)m[x]=p[x];d.current=null,this.ngOnChanges(p)}}function Xa(d,p,m,x){const D=this.declaredInputs[m],L=Dc(d)||function gh(d,p){return d[Ic]=p}(d,{previous:we,current:null}),H=L.current||(L.current={}),q=L.previous,ne=q[D];H[D]=new Wl(ne&&ne.currentValue,p,q===we),d[x]=p}nu.ngInherit=!0;const Ic="__ngSimpleChanges__";function Dc(d){return d[Ic]||null}function _o(d){for(;Array.isArray(d);)d=d[0];return d}function Pa(d,p){return _o(p[d])}function Ps(d,p){return _o(p[d.index])}function ru(d,p){return d.data[p]}function Oa(d,p){return d[p]}function Co(d,p){const m=p[d];return Rs(m)?m:m[0]}function vl(d){return 64==(64&d[2])}function Oi(d,p){return null==p?null:d[p]}function Hu(d){d[18]=0}function Ac(d,p){d[5]+=p;let m=d,x=d[3];for(;null!==x&&(1===p&&1===m[5]||-1===p&&0===m[5]);)x[5]+=p,m=x,x=x[3]}const Wi={lFrame:Cf(null),bindingsEnabled:!0};function vh(){return Wi.bindingsEnabled}function dn(){return Wi.lFrame.lView}function xi(){return Wi.lFrame.tView}function Pp(d){return Wi.lFrame.contextLView=d,d[8]}function Op(d){return Wi.lFrame.contextLView=null,d}function Go(){let d=ou();for(;null!==d&&64===d.type;)d=d.parent;return d}function ou(){return Wi.lFrame.currentTNode}function ga(d,p){const m=Wi.lFrame;m.currentTNode=d,m.isParent=p}function ql(){return Wi.lFrame.isParent}function el(){Wi.lFrame.isParent=!1}function bs(){const d=Wi.lFrame;let p=d.bindingRootIndex;return-1===p&&(p=d.bindingRootIndex=d.tView.bindingStartIndex),p}function Zs(){return Wi.lFrame.bindingIndex++}function Kl(d){const p=Wi.lFrame,m=p.bindingIndex;return p.bindingIndex=p.bindingIndex+d,m}function lu(d,p){const m=Wi.lFrame;m.bindingIndex=m.bindingRootIndex=d,Yl(p)}function Yl(d){Wi.lFrame.currentDirectiveIndex=d}function Jl(){return Wi.lFrame.currentQueryIndex}function od(d){Wi.lFrame.currentQueryIndex=d}function sd(d){const p=d[1];return 2===p.type?p.declTNode:1===p.type?d[6]:null}function Lp(d,p,m){if(m&jn.SkipSelf){let D=p,L=d;for(;!(D=D.parent,null!==D||m&jn.Host||(D=sd(L),null===D||(L=L[15],10&D.type))););if(null===D)return!1;p=D,d=L}const x=Wi.lFrame=bm();return x.currentTNode=p,x.lView=d,!0}function Ql(d){const p=bm(),m=d[1];Wi.lFrame=p,p.currentTNode=m.firstChild,p.lView=d,p.tView=m,p.contextLView=d,p.bindingIndex=m.bindingStartIndex,p.inI18n=!1}function bm(){const d=Wi.lFrame,p=null===d?null:d.child;return null===p?Cf(d):p}function Cf(d){const p={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:d,child:null,inI18n:!1};return null!==d&&(d.child=p),p}function Ef(){const d=Wi.lFrame;return Wi.lFrame=d.parent,d.currentTNode=null,d.lView=null,d}const Zd=Ef;function Fp(){const d=Ef();d.isParent=!0,d.tView=null,d.selectedIndex=-1,d.contextLView=null,d.elementDepthCount=0,d.currentDirectiveIndex=-1,d.currentNamespace=null,d.bindingRootIndex=-1,d.bindingIndex=-1,d.currentQueryIndex=0}function ra(){return Wi.lFrame.selectedIndex}function wl(d){Wi.lFrame.selectedIndex=d}function Or(){const d=Wi.lFrame;return ru(d.tView,d.selectedIndex)}function ad(){Wi.lFrame.currentNamespace="svg"}function xl(d,p){for(let m=p.directiveStart,x=p.directiveEnd;m<x;m++){const L=d.data[m].type.prototype,{ngAfterContentInit:H,ngAfterContentChecked:q,ngAfterViewInit:ne,ngAfterViewChecked:ce,ngOnDestroy:ge}=L;H&&(d.contentHooks||(d.contentHooks=[])).push(-m,H),q&&((d.contentHooks||(d.contentHooks=[])).push(m,q),(d.contentCheckHooks||(d.contentCheckHooks=[])).push(m,q)),ne&&(d.viewHooks||(d.viewHooks=[])).push(-m,ne),ce&&((d.viewHooks||(d.viewHooks=[])).push(m,ce),(d.viewCheckHooks||(d.viewCheckHooks=[])).push(m,ce)),null!=ge&&(d.destroyHooks||(d.destroyHooks=[])).push(m,ge)}}function Ea(d,p,m){Xl(d,p,3,m)}function Cl(d,p,m,x){(3&d[2])===m&&Xl(d,p,m,x)}function ji(d,p){let m=d[2];(3&m)===p&&(m&=2047,m+=1,d[2]=m)}function Xl(d,p,m,x){const L=x??-1,H=p.length-1;let q=0;for(let ne=void 0!==x?65535&d[18]:0;ne<H;ne++)if("number"==typeof p[ne+1]){if(q=p[ne],null!=x&&q>=x)break}else p[ne]<0&&(d[18]+=65536),(q<L||-1==L)&&(Tf(d,m,p,ne),d[18]=(4294901760&d[18])+ne+2),ne++}function Tf(d,p,m,x){const D=m[x]<0,L=m[x+1],q=d[D?-m[x]:m[x]];if(D){if(d[2]>>11<d[18]>>16&&(3&d[2])===p){d[2]+=2048;try{L.call(q)}finally{}}}else try{L.call(q)}finally{}}class kc{constructor(p,m,x){this.factory=p,this.resolving=!1,this.canSeeViewProviders=m,this.injectImpl=x}}function El(d,p,m){let x=0;for(;x<m.length;){const D=m[x];if("number"==typeof D){if(0!==D)break;x++;const L=m[x++],H=m[x++],q=m[x++];d.setAttribute(p,H,q,L)}else{const L=D,H=m[++x];Oc(L)?d.setProperty(p,L,H):d.setAttribute(p,L,H),x++}}return x}function qs(d){return 3===d||4===d||6===d}function Oc(d){return 64===d.charCodeAt(0)}function oa(d,p){if(null!==p&&0!==p.length)if(null===d||0===d.length)d=p.slice();else{let m=-1;for(let x=0;x<p.length;x++){const D=p[x];"number"==typeof D?m=D:0===m||An(d,m,D,null,-1===m||2===m?p[++x]:null)}}return d}function An(d,p,m,x,D){let L=0,H=d.length;if(-1===p)H=-1;else for(;L<d.length;){const q=d[L++];if("number"==typeof q){if(q===p){H=-1;break}if(q>p){H=L-1;break}}}for(;L<d.length;){const q=d[L];if("number"==typeof q)break;if(q===m){if(null===x)return void(null!==D&&(d[L+1]=D));if(x===d[L+1])return void(d[L+2]=D)}L++,null!==x&&L++,null!==D&&L++}-1!==H&&(d.splice(H,0,p),L=H+1),d.splice(L++,0,m),null!==x&&d.splice(L++,0,x),null!==D&&d.splice(L++,0,D)}function _a(d){return-1!==d}function uu(d){return 32767&d}function nl(d,p){let m=function xh(d){return d>>16}(d),x=p;for(;m>0;)x=x[15],m--;return x}let il=!0;function ec(d){const p=il;return il=d,p}let Lc=0;const ws={};function Fa(d,p){const m=cd(d,p);if(-1!==m)return m;const x=p[1];x.firstCreatePass&&(d.injectorIndex=p.length,Zu(x.data,d),Zu(p,null),Zu(x.blueprint,null));const D=hu(d,p),L=d.injectorIndex;if(_a(D)){const H=uu(D),q=nl(D,p),ne=q[1].data;for(let ce=0;ce<8;ce++)p[L+ce]=q[H+ce]|ne[H+ce]}return p[L+8]=D,L}function Zu(d,p){d.push(0,0,0,0,0,0,0,0,p)}function cd(d,p){return-1===d.injectorIndex||d.parent&&d.parent.injectorIndex===d.injectorIndex||null===p[d.injectorIndex+8]?-1:d.injectorIndex}function hu(d,p){if(d.parent&&-1!==d.parent.injectorIndex)return d.parent.injectorIndex;let m=0,x=null,D=p;for(;null!==D;){if(x=Ku(D),null===x)return-1;if(m++,D=D[15],-1!==x.injectorIndex)return x.injectorIndex|m<<16}return-1}function Eh(d,p,m){!function us(d,p,m){let x;"string"==typeof m?x=m.charCodeAt(0)||0:m.hasOwnProperty($t)&&(x=m[$t]),null==x&&(x=m[$t]=Lc++);const D=255&x;p.data[d+(D>>5)]|=1<<D}(d,p,m)}function Kd(d,p,m){if(m&jn.Optional||void 0!==d)return d;yn()}function tc(d,p,m,x){if(m&jn.Optional&&void 0===x&&(x=null),!(m&(jn.Self|jn.Host))){const D=d[9],L=Wr(void 0);try{return D?D.get(p,x,m&jn.Optional):es(p,x,m&jn.Optional)}finally{Wr(L)}}return Kd(x,0,m)}function qu(d,p,m,x=jn.Default,D){if(null!==d){if(1024&p[2]){const H=function Np(d,p,m,x,D){let L=d,H=p;for(;null!==L&&null!==H&&1024&H[2]&&!(256&H[2]);){const q=Na(L,H,m,x|jn.Self,ws);if(q!==ws)return q;let ne=L.parent;if(!ne){const ce=H[21];if(ce){const ge=ce.get(m,ws,x);if(ge!==ws)return ge}ne=Ku(H),H=H[15]}L=ne}return D}(d,p,m,x,ws);if(H!==ws)return H}const L=Na(d,p,m,x,ws);if(L!==ws)return L}return tc(p,m,x,D)}function Na(d,p,m,x,D){const L=function hd(d){if("string"==typeof d)return d.charCodeAt(0)||0;const p=d.hasOwnProperty($t)?d[$t]:void 0;return"number"==typeof p?p>=0?255&p:If:p}(m);if("function"==typeof L){if(!Lp(p,d,x))return x&jn.Host?Kd(D,0,x):tc(p,m,x,D);try{const H=L(x);if(null!=H||x&jn.Optional)return H;yn()}finally{Zd()}}else if("number"==typeof L){let H=null,q=cd(d,p),ne=-1,ce=x&jn.Host?p[16][6]:null;for((-1===q||x&jn.SkipSelf)&&(ne=-1===q?hu(d,p):p[q+8],-1!==ne&&Ks(x,!1)?(H=p[1],q=uu(ne),p=nl(ne,p)):q=-1);-1!==q;){const ge=p[1];if(Nc(L,q,ge.data)){const Ae=ud(q,p,m,H,x,ce);if(Ae!==ws)return Ae}ne=p[q+8],-1!==ne&&Ks(x,p[1].data[q+8]===ce)&&Nc(L,q,p)?(H=ge,q=uu(ne),p=nl(ne,p)):q=-1}}return D}function ud(d,p,m,x,D,L){const H=p[1],q=H.data[d+8],ge=Fc(q,H,m,null==x?Nu(q)&&il:x!=H&&0!=(3&q.type),D&jn.Host&&L===q);return null!==ge?za(p,H,ge,q):ws}function Fc(d,p,m,x,D){const L=d.providerIndexes,H=p.data,q=1048575&L,ne=d.directiveStart,ge=L>>20,lt=D?q+ge:d.directiveEnd;for(let mt=x?q:q+ge;mt<lt;mt++){const an=H[mt];if(mt<ne&&m===an||mt>=ne&&an.type===m)return mt}if(D){const mt=H[ne];if(mt&&fr(mt)&&mt.type===m)return ne}return null}function za(d,p,m,x){let D=d[m];const L=p.data;if(function Os(d){return d instanceof kc}(D)){const H=D;H.resolving&&function st(d,p){const m=p?`. Dependency path: ${p.join(" > ")} > ${d}`:"";throw new Je(-200,`Circular dependency in DI detected for ${d}${m}`)}(function Jt(d){return"function"==typeof d?d.name||d.toString():"object"==typeof d&&null!=d&&"function"==typeof d.type?d.type.name||d.type.toString():Ot(d)}(L[m]));const q=ec(H.canSeeViewProviders);H.resolving=!0;const ne=H.injectImpl?Wr(H.injectImpl):null;Lp(d,x,jn.Default);try{D=d[m]=H.factory(void 0,L,d,x),p.firstCreatePass&&m>=x.directiveStart&&function cu(d,p,m){const{ngOnChanges:x,ngOnInit:D,ngDoCheck:L}=p.type.prototype;if(x){const H=iu(p);(m.preOrderHooks||(m.preOrderHooks=[])).push(d,H),(m.preOrderCheckHooks||(m.preOrderCheckHooks=[])).push(d,H)}D&&(m.preOrderHooks||(m.preOrderHooks=[])).push(0-d,D),L&&((m.preOrderHooks||(m.preOrderHooks=[])).push(d,L),(m.preOrderCheckHooks||(m.preOrderCheckHooks=[])).push(d,L))}(m,L[m],p)}finally{null!==ne&&Wr(ne),ec(q),H.resolving=!1,Zd()}}return D}function Nc(d,p,m){return!!(m[p+(d>>5)]&1<<d)}function Ks(d,p){return!(d&jn.Self||d&jn.Host&&p)}class Sa{constructor(p,m){this._tNode=p,this._lView=m}get(p,m,x){return qu(this._tNode,this._lView,p,wi(x),m)}}function If(){return new Sa(Go(),dn())}function dd(d){return Ue(()=>{const p=d.prototype.constructor,m=p[rt]||zc(p),x=Object.prototype;let D=Object.getPrototypeOf(d.prototype).constructor;for(;D&&D!==x;){const L=D[rt]||zc(D);if(L&&L!==m)return L;D=Object.getPrototypeOf(D)}return L=>new L})}function zc(d){return fn(d)?()=>{const p=zc(nt(d));return p&&p()}:ml(d)}function Ku(d){const p=d[1],m=p.type;return 2===m?p.declTNode:1===m?d[6]:null}function Ls(d){return function du(d,p){if("class"===p)return d.classes;if("style"===p)return d.styles;const m=d.attrs;if(m){const x=m.length;let D=0;for(;D<x;){const L=m[D];if(qs(L))break;if(0===L)D+=2;else if("number"==typeof L)for(D++;D<x&&"string"==typeof m[D];)D++;else{if(L===p)return m[D+1];D+=2}}}return null}(Go(),d)}const Th="__parameters__";function Ju(d,p,m){return Ue(()=>{const x=function Sl(d){return function(...m){if(d){const x=d(...m);for(const D in x)this[D]=x[D]}}}(p);function D(...L){if(this instanceof D)return x.apply(this,L),this;const H=new D(...L);return q.annotation=H,q;function q(ne,ce,ge){const Ae=ne.hasOwnProperty(Th)?ne[Th]:Object.defineProperty(ne,Th,{value:[]})[Th];for(;Ae.length<=ge;)Ae.push(null);return(Ae[ge]=Ae[ge]||[]).push(H),ne}}return m&&(D.prototype=Object.create(m.prototype)),D.prototype.ngMetadataName=d,D.annotationCls=D,D})}class Cr{constructor(p,m){this._desc=p,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof m?this.__NG_ELEMENT_ID__=m:void 0!==m&&(this.\u0275prov=bi({token:this,providedIn:m.providedIn||"root",factory:m.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Il(d,p){d.forEach(m=>Array.isArray(m)?Il(m,p):p(m))}function Mf(d,p,m){p>=d.length?d.push(m):d.splice(p,0,m)}function fd(d,p){return p>=d.length-1?d.pop():d.splice(p,1)[0]}function Xu(d,p){const m=[];for(let x=0;x<d;x++)m.push(p);return m}function Ys(d,p,m){let x=Oo(d,p);return x>=0?d[1|x]=m:(x=~x,function fu(d,p,m,x){let D=d.length;if(D==p)d.push(m,x);else if(1===D)d.push(x,d[0]),d[0]=m;else{for(D--,d.push(d[D-1],d[D]);D>p;)d[D]=d[D-2],D--;d[p]=m,d[p+1]=x}}(d,x,p,m)),x}function Xd(d,p){const m=Oo(d,p);if(m>=0)return d[1|m]}function Oo(d,p){return function qn(d,p,m){let x=0,D=d.length>>m;for(;D!==x;){const L=x+(D-x>>1),H=d[L<<m];if(p===H)return L<<m;H>p?D=L:x=L+1}return~(D<<m)}(d,p,1)}const z=er(Ju("Inject",d=>({token:d})),-1),G=er(Ju("Optional"),8),te=er(Ju("SkipSelf"),4);var hr=(()=>((hr=hr||{})[hr.Important=1]="Important",hr[hr.DashCase=2]="DashCase",hr))();const Fs=new Map;let Ns=0;const Rf="__ngContext__";function ya(d,p){Rs(p)?(d[Rf]=p[20],function Ih(d){Fs.set(d[20],d)}(p)):d[Rf]=p}function mn(d,p){return undefined(d,p)}function oi(d){const p=d[3];return uo(p)?p[3]:p}function Ia(d){return ep(d[13])}function jc(d){return ep(d[4])}function ep(d){for(;null!==d&&!uo(d);)d=d[4];return d}function _u(d,p,m,x,D){if(null!=x){let L,H=!1;uo(x)?L=x:Rs(x)&&(H=!0,x=x[0]);const q=_o(x);0===d&&null!==m?null==D?dy(p,m,q):Up(p,m,q,D||null,!0):1===d&&null!==m?Up(p,m,q,D||null,!0):2===d?function Hp(d,p,m){const x=Of(d,p);x&&function eh(d,p,m,x){d.removeChild(p,m,x)}(d,x,p,m)}(p,q,H):3===d&&p.destroyNode(q),null!=L&&function f0(d,p,m,x,D){const L=m[7];L!==_o(m)&&_u(p,d,x,L,D);for(let q=10;q<m.length;q++){const ne=m[q];jp(ne[1],ne,d,p,x,L)}}(p,d,L,m,D)}}function tp(d,p,m){return d.createElement(p,m)}function yu(d,p){const m=d[9],x=m.indexOf(p),D=p[3];512&p[2]&&(p[2]&=-513,Ac(D,-1)),m.splice(x,1)}function $o(d,p){if(d.length<=10)return;const m=10+p,x=d[m];if(x){const D=x[17];null!==D&&D!==d&&yu(D,x),p>0&&(d[m-1][4]=x[4]);const L=fd(d,10+p);!function uy(d,p){jp(d,p,p[11],2,null,null),p[0]=null,p[6]=null}(x[1],x);const H=L[19];null!==H&&H.detachView(L[1]),x[3]=null,x[4]=null,x[2]&=-65}return x}function Al(d,p){if(!(128&p[2])){const m=p[11];m.destroyNode&&jp(d,p,m,3,null,null),function Vp(d){let p=d[13];if(!p)return gd(d[1],d);for(;p;){let m=null;if(Rs(p))m=p[13];else{const x=p[10];x&&(m=x)}if(!m){for(;p&&!p[4]&&p!==d;)Rs(p)&&gd(p[1],p),p=p[3];null===p&&(p=d),Rs(p)&&gd(p[1],p),m=p&&p[4]}p=m}}(p)}}function gd(d,p){if(!(128&p[2])){p[2]&=-65,p[2]|=128,function Lw(d,p){let m;if(null!=d&&null!=(m=d.destroyHooks))for(let x=0;x<m.length;x+=2){const D=p[m[x]];if(!(D instanceof kc)){const L=m[x+1];if(Array.isArray(L))for(let H=0;H<L.length;H+=2){const q=D[L[H]],ne=L[H+1];try{ne.call(q)}finally{}}else try{L.call(D)}finally{}}}}(d,p),function xm(d,p){const m=d.cleanup,x=p[7];let D=-1;if(null!==m)for(let L=0;L<m.length-1;L+=2)if("string"==typeof m[L]){const H=m[L+3];H>=0?x[D=H]():x[D=-H].unsubscribe(),L+=2}else{const H=x[D=m[L+1]];m[L].call(H)}if(null!==x){for(let L=D+1;L<x.length;L++)(0,x[L])();p[7]=null}}(d,p),1===p[1].type&&p[11].destroy();const m=p[17];if(null!==m&&uo(p[3])){m!==p[3]&&yu(m,p);const x=p[19];null!==x&&x.detachView(d)}!function rl(d){Fs.delete(d[20])}(p)}}function d0(d,p,m){return function p0(d,p,m){let x=p;for(;null!==x&&40&x.type;)x=(p=x).parent;if(null===x)return m[0];{const{componentOffset:D}=x;if(D>-1){const{encapsulation:L}=d.data[x.directiveStart+D];if(L===ae.None||L===ae.Emulated)return null}return Ps(x,m)}}(d,p.parent,m)}function Up(d,p,m,x,D){d.insertBefore(p,m,x,D)}function dy(d,p,m){d.appendChild(p,m)}function Cm(d,p,m,x,D){null!==x?Up(d,p,m,x,D):dy(d,p,m)}function Of(d,p){return d.parentNode(p)}function Ci(d,p,m){return Em(d,p,m)}let vd,Lf,Kg,Em=function _d(d,p,m){return 40&d.type?Ps(d,m):null};function Tm(d,p,m,x){const D=d0(d,x,p),L=p[11],q=Ci(x.parent||p[6],x,p);if(null!=D)if(Array.isArray(m))for(let ne=0;ne<m.length;ne++)Cm(L,D,m[ne],q,!1);else Cm(L,D,m,q,!1)}function kl(d,p){if(null!==p){const m=p.type;if(3&m)return Ps(p,d);if(4&m)return Dh(-1,d[p.index]);if(8&m){const x=p.child;if(null!==x)return kl(d,x);{const D=d[p.index];return uo(D)?Dh(-1,D):_o(D)}}if(32&m)return mn(p,d)()||_o(d[p.index]);{const x=Zg(d,p);return null!==x?Array.isArray(x)?x[0]:kl(oi(d[16]),x):kl(d,p.next)}}return null}function Zg(d,p){return null!==p?d[16][6].projection[p.projection]:null}function Dh(d,p){const m=10+d+1;if(m<p.length){const x=p[m],D=x[1].firstChild;if(null!==D)return kl(x,D)}return p[7]}function yd(d,p,m,x,D,L,H){for(;null!=m;){const q=x[m.index],ne=m.type;if(H&&0===p&&(q&&ya(_o(q),x),m.flags|=2),32!=(32&m.flags))if(8&ne)yd(d,p,m.child,x,D,L,!1),_u(p,d,D,q,L);else if(32&ne){const ce=mn(m,x);let ge;for(;ge=ce();)_u(p,d,D,ge,L);_u(p,d,D,q,L)}else 16&ne?Im(d,p,x,m,D,L):_u(p,d,D,q,L);m=H?m.projectionNext:m.next}}function jp(d,p,m,x,D,L){yd(m,x,d.firstChild,p,D,L,!1)}function Im(d,p,m,x,D,L){const H=m[16],ne=H[6].projection[x.projection];if(Array.isArray(ne))for(let ce=0;ce<ne.length;ce++)_u(p,d,D,ne[ce],L);else yd(d,p,ne,H[3],D,L,!0)}function sl(d,p,m){""===m?d.removeAttribute(p,"class"):d.setAttribute(p,"class",m)}function vu(d,p,m){const{mergedAttrs:x,classes:D,styles:L}=m;null!==x&&El(d,p,x),null!==D&&sl(d,p,D),null!==L&&function fy(d,p,m){d.setAttribute(p,"style",m)}(d,p,L)}function Gp(d){return function bd(){if(void 0===vd&&(vd=null,wr.trustedTypes))try{vd=wr.trustedTypes.createPolicy("angular",{createHTML:d=>d,createScript:d=>d,createScriptURL:d=>d})}catch{}return vd}()?.createHTML(d)||d}function Va(d){Lf=d}function ds(){if(void 0===Kg&&(Kg=null,wr.trustedTypes))try{Kg=wr.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:d=>d,createScript:d=>d,createScriptURL:d=>d})}catch{}return Kg}function Nw(d){return ds()?.createHTML(d)||d}function Ah(d){return ds()?.createScriptURL(d)||d}class aE{constructor(p){this.changingThisBreaksApplicationSecurity=p}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Ze})`}}function np(d){return d instanceof aE?d.changingThisBreaksApplicationSecurity:d}function $p(d,p){const m=function Am(d){return d instanceof aE&&d.getTypeName()||null}(d);if(null!=m&&m!==p){if("ResourceURL"===m&&"URL"===p)return!0;throw new Error(`Required a safe ${p}, got a ${m} (see ${Ze})`)}return m===p}class y0{constructor(p){this.inertDocumentHelper=p}getInertBodyElement(p){p="<body><remove></remove>"+p;try{const m=(new window.DOMParser).parseFromString(Gp(p),"text/html").body;return null===m?this.inertDocumentHelper.getInertBodyElement(p):(m.removeChild(m.firstChild),m)}catch{return null}}}class km{constructor(p){if(this.defaultDoc=p,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const m=this.inertDocument.createElement("html");this.inertDocument.appendChild(m);const x=this.inertDocument.createElement("body");m.appendChild(x)}}getInertBodyElement(p){const m=this.inertDocument.createElement("template");if("content"in m)return m.innerHTML=Gp(p),m;const x=this.inertDocument.createElement("body");return x.innerHTML=Gp(p),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(x),x}stripCustomNsAttrs(p){const m=p.attributes;for(let D=m.length-1;0<D;D--){const H=m.item(D).name;("xmlns:ns1"===H||0===H.indexOf("ns1:"))&&p.removeAttribute(H)}let x=p.firstChild;for(;x;)x.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(x),x=x.nextSibling}}const Mh=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function wd(d){return(d=String(d)).match(Mh)?d:"unsafe:"+d}function ac(d){const p={};for(const m of d.split(","))p[m]=!0;return p}function lc(...d){const p={};for(const m of d)for(const x in m)m.hasOwnProperty(x)&&(p[x]=!0);return p}const th=ac("area,br,col,hr,img,wbr"),Vw=ac("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),_y=ac("rp,rt"),Pl=lc(th,lc(Vw,ac("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),lc(_y,ac("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),lc(_y,Vw)),nh=ac("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),vy=lc(nh,ac("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ac("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Nf=ac("script,style,template");class v0{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(p){let m=p.firstChild,x=!0;for(;m;)if(m.nodeType===Node.ELEMENT_NODE?x=this.startElement(m):m.nodeType===Node.TEXT_NODE?this.chars(m.nodeValue):this.sanitizedSomething=!0,x&&m.firstChild)m=m.firstChild;else for(;m;){m.nodeType===Node.ELEMENT_NODE&&this.endElement(m);let D=this.checkClobberedElement(m,m.nextSibling);if(D){m=D;break}m=this.checkClobberedElement(m,m.parentNode)}return this.buf.join("")}startElement(p){const m=p.nodeName.toLowerCase();if(!Pl.hasOwnProperty(m))return this.sanitizedSomething=!0,!Nf.hasOwnProperty(m);this.buf.push("<"),this.buf.push(m);const x=p.attributes;for(let D=0;D<x.length;D++){const L=x.item(D),H=L.name,q=H.toLowerCase();if(!vy.hasOwnProperty(q)){this.sanitizedSomething=!0;continue}let ne=L.value;nh[q]&&(ne=wd(ne)),this.buf.push(" ",H,'="',Pm(ne),'"')}return this.buf.push(">"),!0}endElement(p){const m=p.nodeName.toLowerCase();Pl.hasOwnProperty(m)&&!th.hasOwnProperty(m)&&(this.buf.push("</"),this.buf.push(m),this.buf.push(">"))}chars(p){this.buf.push(Pm(p))}checkClobberedElement(p,m){if(m&&(p.compareDocumentPosition(m)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${p.outerHTML}`);return m}}const Rm=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,zf=/([^\#-~ |!])/g;function Pm(d){return d.replace(/&/g,"&amp;").replace(Rm,function(p){return"&#"+(1024*(p.charCodeAt(0)-55296)+(p.charCodeAt(1)-56320)+65536)+";"}).replace(zf,function(p){return"&#"+p.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Wp;function Om(d){return"content"in d&&function b0(d){return d.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===d.nodeName}(d)?d.content:null}var zs=(()=>((zs=zs||{})[zs.NONE=0]="NONE",zs[zs.HTML=1]="HTML",zs[zs.STYLE=2]="STYLE",zs[zs.SCRIPT=3]="SCRIPT",zs[zs.URL=4]="URL",zs[zs.RESOURCE_URL=5]="RESOURCE_URL",zs))();function Lm(d){const p=cc();return p?Nw(p.sanitize(zs.HTML,d)||""):$p(d,"HTML")?Nw(np(d)):function Hw(d,p){let m=null;try{Wp=Wp||function Mm(d){const p=new km(d);return function al(){try{return!!(new window.DOMParser).parseFromString(Gp(""),"text/html")}catch{return!1}}()?new y0(p):p}(d);let x=p?String(p):"";m=Wp.getInertBodyElement(x);let D=5,L=x;do{if(0===D)throw new Error("Failed to sanitize html because the input is unstable");D--,x=L,L=m.innerHTML,m=Wp.getInertBodyElement(x)}while(x!==L);return Gp((new v0).sanitizeChildren(Om(m)||m))}finally{if(m){const x=Om(m)||m;for(;x.firstChild;)x.removeChild(x.firstChild)}}}(function bu(){return void 0!==Lf?Lf:typeof document<"u"?document:void 0}(),Ot(d))}function Fm(d){const p=cc();return p?p.sanitize(zs.URL,d)||"":$p(d,"URL")?np(d):wd(Ot(d))}function w0(d){const p=cc();if(p)return Ah(p.sanitize(zs.RESOURCE_URL,d)||"");if($p(d,"ResourceURL"))return Ah(np(d));throw new Je(904,!1)}function br(d,p,m){return function uE(d,p){return"src"===p&&("embed"===d||"frame"===d||"iframe"===d||"media"===d||"script"===d)||"href"===p&&("base"===d||"link"===d)?w0:Fm}(p,m)(d)}function cc(){const d=dn();return d&&d[12]}const Gc=new Cr("ENVIRONMENT_INITIALIZER"),uc=new Cr("INJECTOR",-1),Ua=new Cr("INJECTOR_DEF_TYPES");class C0{get(p,m=ts){if(m===ts){const x=new Error(`NullInjectorError: No provider for ${ze(p)}!`);throw x.name="NullInjectorError",x}return m}}function Da(d){return{\u0275providers:d}}function hE(...d){return{\u0275providers:zm(0,d),\u0275fromNgModule:!0}}function zm(d,...p){const m=[],x=new Set;let D;return Il(p,L=>{const H=L;T0(H,m,[],x)&&(D||(D=[]),D.push(H))}),void 0!==D&&E0(D,m),m}function E0(d,p){for(let m=0;m<d.length;m++){const{providers:D}=d[m];by(D,L=>{p.push(L)})}}function T0(d,p,m,x){if(!(d=nt(d)))return!1;let D=null,L=Rr(d);const H=!L&&ci(d);if(L||H){if(H&&!H.standalone)return!1;D=d}else{const ne=d.ngModule;if(L=Rr(ne),!L)return!1;D=ne}const q=x.has(D);if(H){if(q)return!1;if(x.add(D),H.dependencies){const ne="function"==typeof H.dependencies?H.dependencies():H.dependencies;for(const ce of ne)T0(ce,p,m,x)}}else{if(!L)return!1;{if(null!=L.imports&&!q){let ce;x.add(D);try{Il(L.imports,ge=>{T0(ge,p,m,x)&&(ce||(ce=[]),ce.push(ge))})}finally{}void 0!==ce&&E0(ce,p)}if(!q){const ce=ml(D)||(()=>new D);p.push({provide:D,useFactory:ce,deps:De},{provide:Ua,useValue:D,multi:!0},{provide:Gc,useValue:()=>En(D),multi:!0})}const ne=L.providers;null==ne||q||by(ne,ge=>{p.push(ge)})}}return D!==d&&void 0!==d.providers}function by(d,p){for(let m of d)ft(m)&&(m=m.\u0275providers),Array.isArray(m)?by(m,p):p(m)}const S0=Ht({provide:String,useValue:Ht});function n_(d){return null!==d&&"object"==typeof d&&S0 in d}function wu(d){return"function"==typeof d}const Vm=new Cr("Set Injector scope."),r_={},I0={};let D0;function Um(){return void 0===D0&&(D0=new C0),D0}class Bf{}class o_ extends Bf{get destroyed(){return this._destroyed}constructor(p,m,x,D){super(),this.parent=m,this.source=x,this.scopes=D,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Zp(p,H=>this.processProvider(H)),this.records.set(uc,$c(void 0,this)),D.has("environment")&&this.records.set(Bf,$c(void 0,this));const L=this.records.get(Vm);null!=L&&"string"==typeof L.value&&this.scopes.add(L.value),this.injectorDefTypes=new Set(this.get(Ua.multi,De,jn.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const p of this._ngOnDestroyHooks)p.ngOnDestroy();for(const p of this._onDestroyHooks)p()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(p){this._onDestroyHooks.push(p)}runInContext(p){this.assertNotDestroyed();const m=Bi(this),x=Wr(void 0);try{return p()}finally{Bi(m),Wr(x)}}get(p,m=ts,x=jn.Default){this.assertNotDestroyed(),x=wi(x);const D=Bi(this),L=Wr(void 0);try{if(!(x&jn.SkipSelf)){let q=this.records.get(p);if(void 0===q){const ne=function Hm(d){return"function"==typeof d||"object"==typeof d&&d instanceof Cr}(p)&&$r(p);q=ne&&this.injectableDefInScope(ne)?$c(wy(p),r_):null,this.records.set(p,q)}if(null!=q)return this.hydrate(p,q)}return(x&jn.Self?Um():this.parent).get(p,m=x&jn.Optional&&m===ts?null:m)}catch(H){if("NullInjectorError"===H.name){if((H[Ho]=H[Ho]||[]).unshift(ze(p)),D)throw H;return function je(d,p,m,x){const D=d[Ho];throw p[mr]&&D.unshift(p[mr]),d.message=function at(d,p,m,x=null){d=d&&"\n"===d.charAt(0)&&"\u0275"==d.charAt(1)?d.slice(2):d;let D=ze(p);if(Array.isArray(p))D=p.map(ze).join(" -> ");else if("object"==typeof p){let L=[];for(let H in p)if(p.hasOwnProperty(H)){let q=p[H];L.push(H+":"+("string"==typeof q?JSON.stringify(q):ze(q)))}D=`{${L.join(", ")}}`}return`${m}${x?"("+x+")":""}[${D}]: ${d.replace(Jr,"\n  ")}`}("\n"+d.message,D,m,x),d.ngTokenPath=D,d[Ho]=null,d}(H,p,"R3InjectorError",this.source)}throw H}finally{Wr(L),Bi(D)}}resolveInjectorInitializers(){const p=Bi(this),m=Wr(void 0);try{const x=this.get(Gc.multi,De,jn.Self);for(const D of x)D()}finally{Bi(p),Wr(m)}}toString(){const p=[],m=this.records;for(const x of m.keys())p.push(ze(x));return`R3Injector[${p.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Je(205,!1)}processProvider(p){let m=wu(p=nt(p))?p:nt(p&&p.provide);const x=function M0(d){return n_(d)?$c(void 0,d.useValue):$c(k0(d),r_)}(p);if(wu(p)||!0!==p.multi)this.records.get(m);else{let D=this.records.get(m);D||(D=$c(void 0,r_,!0),D.factory=()=>Di(D.multi),this.records.set(m,D)),m=p,D.multi.push(p)}this.records.set(m,x)}hydrate(p,m){return m.value===r_&&(m.value=I0,m.value=m.factory()),"object"==typeof m.value&&m.value&&function R0(d){return null!==d&&"object"==typeof d&&"function"==typeof d.ngOnDestroy}(m.value)&&this._ngOnDestroyHooks.add(m.value),m.value}injectableDefInScope(p){if(!p.providedIn)return!1;const m=nt(p.providedIn);return"string"==typeof m?"any"===m||this.scopes.has(m):this.injectorDefTypes.has(m)}}function wy(d){const p=$r(d),m=null!==p?p.factory:ml(d);if(null!==m)return m;if(d instanceof Cr)throw new Je(204,!1);if(d instanceof Function)return function A0(d){const p=d.length;if(p>0)throw Xu(p,"?"),new Je(204,!1);const m=function ys(d){const p=d&&(d[Xo]||d[Ao]);if(p){const m=function qi(d){if(d.hasOwnProperty("name"))return d.name;const p=(""+d).match(/^function\s*([^\s(]+)/);return null===p?"":p[1]}(d);return console.warn(`DEPRECATED: DI is instantiating a token "${m}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${m}" class.`),p}return null}(d);return null!==m?()=>m.factory(d):()=>new d}(d);throw new Je(204,!1)}function k0(d,p,m){let x;if(wu(d)){const D=nt(d);return ml(D)||wy(D)}if(n_(d))x=()=>nt(d.useValue);else if(function xd(d){return!(!d||!d.useFactory)}(d))x=()=>d.useFactory(...Di(d.deps||[]));else if(function Bm(d){return!(!d||!d.useExisting)}(d))x=()=>En(nt(d.useExisting));else{const D=nt(d&&(d.useClass||d.provide));if(!function $w(d){return!!d.deps}(d))return ml(D)||wy(D);x=()=>new D(...Di(d.deps))}return x}function $c(d,p,m=!1){return{factory:d,value:p,multi:m?[]:void 0}}function Zp(d,p){for(const m of d)Array.isArray(m)?Zp(m,p):m&&ft(m)?Zp(m.\u0275providers,p):p(m)}class P0{}class O0{}class dE{resolveComponentFactory(p){throw function Ww(d){const p=Error(`No component factory found for ${ze(d)}. Did you add it to @NgModule.entryComponents?`);return p.ngComponent=d,p}(p)}}let qp=(()=>{class d{}return d.NULL=new dE,d})();function pE(){return jm(Go(),dn())}function jm(d,p){return new Vf(Ps(d,p))}let Vf=(()=>{class d{constructor(m){this.nativeElement=m}}return d.__NG_ELEMENT_ID__=pE,d})();function Kw(d){return d instanceof Vf?d.nativeElement:d}class Yw{}let s_=(()=>{class d{}return d.__NG_ELEMENT_ID__=()=>function ip(){const d=dn(),m=Co(Go().index,d);return(Rs(m)?m:d)[11]}(),d})(),hc=(()=>{class d{}return d.\u0275prov=bi({token:d,providedIn:"root",factory:()=>null}),d})();class L0{constructor(p){this.full=p,this.major=p.split(".")[0],this.minor=p.split(".")[1],this.patch=p.split(".").slice(2).join(".")}}const Cd=new L0("15.1.2"),F0={};function rp(d){return d.ngOriginalError}class Kp{constructor(){this._console=console}handleError(p){const m=this._findOriginalError(p);this._console.error("ERROR",p),m&&this._console.error("ORIGINAL ERROR",m)}_findOriginalError(p){let m=p&&rp(p);for(;m&&rp(m);)m=rp(m);return m||null}}function N0(d){return d.ownerDocument.defaultView}function Ed(d){return d instanceof Function?d():d}function a_(d,p,m){let x=d.length;for(;;){const D=d.indexOf(p,m);if(-1===D)return D;if(0===D||d.charCodeAt(D-1)<=32){const L=p.length;if(D+L===x||d.charCodeAt(D+L)<=32)return D}m=D+1}}const Xw="ng-template";function z0(d,p,m){let x=0;for(;x<d.length;){let D=d[x++];if(m&&"class"===D){if(D=d[x],-1!==a_(D.toLowerCase(),p,0))return!0}else if(1===D){for(;x<d.length&&"string"==typeof(D=d[x++]);)if(D.toLowerCase()===p)return!0;return!1}}return!1}function Ty(d){return 4===d.type&&d.value!==Xw}function Sy(d,p,m){return p===(4!==d.type||m?d.value:Xw)}function vE(d,p,m){let x=4;const D=d.attrs||[],L=function tx(d){for(let p=0;p<d.length;p++)if(qs(d[p]))return p;return d.length}(D);let H=!1;for(let q=0;q<p.length;q++){const ne=p[q];if("number"!=typeof ne){if(!H)if(4&x){if(x=2|1&x,""!==ne&&!Sy(d,ne,m)||""===ne&&1===p.length){if(Rh(x))return!1;H=!0}}else{const ce=8&x?ne:p[++q];if(8&x&&null!==d.attrs){if(!z0(d.attrs,ce,m)){if(Rh(x))return!1;H=!0}continue}const Ae=Iy(8&x?"class":ne,D,Ty(d),m);if(-1===Ae){if(Rh(x))return!1;H=!0;continue}if(""!==ce){let lt;lt=Ae>L?"":D[Ae+1].toLowerCase();const mt=8&x?lt:null;if(mt&&-1!==a_(mt,ce,0)||2&x&&ce!==lt){if(Rh(x))return!1;H=!0}}}}else{if(!H&&!Rh(x)&&!Rh(ne))return!1;if(H&&Rh(ne))continue;H=!1,x=ne|1&x}}return Rh(x)||H}function Rh(d){return 0==(1&d)}function Iy(d,p,m,x){if(null===p)return-1;let D=0;if(x||!m){let L=!1;for(;D<p.length;){const H=p[D];if(H===d)return D;if(3===H||6===H)L=!0;else{if(1===H||2===H){let q=p[++D];for(;"string"==typeof q;)q=p[++D];continue}if(4===H)break;if(0===H){D+=4;continue}}D+=L?1:2}return-1}return function nx(d,p){let m=d.indexOf(4);if(m>-1)for(m++;m<d.length;){const x=d[m];if("number"==typeof x)return-1;if(x===p)return m;m++}return-1}(p,d)}function Uf(d,p,m=!1){for(let x=0;x<p.length;x++)if(vE(d,p[x],m))return!0;return!1}function xu(d,p){e:for(let m=0;m<p.length;m++){const x=p[m];if(d.length===x.length){for(let D=0;D<d.length;D++)if(d[D]!==x[D])continue e;return!0}}return!1}function l_(d,p){return d?":not("+p.trim()+")":p}function ih(d){let p=d[0],m=1,x=2,D="",L=!1;for(;m<d.length;){let H=d[m];if("string"==typeof H)if(2&x){const q=d[++m];D+="["+H+(q.length>0?'="'+q+'"':"")+"]"}else 8&x?D+="."+H:4&x&&(D+=" "+H);else""!==D&&!Rh(H)&&(p+=l_(L,D),D=""),x=H,L=L||!Rh(x);m++}return""!==D&&(p+=l_(L,D)),p}const Ti={};function c_(d){bE(xi(),dn(),ra()+d,!1)}function bE(d,p,m,x){if(!x)if(3==(3&p[2])){const L=d.preOrderCheckHooks;null!==L&&Ea(p,L,m)}else{const L=d.preOrderHooks;null!==L&&Cl(p,L,0,m)}wl(m)}function ky(d,p=null,m=null,x){const D=wE(d,p,m,x);return D.resolveInjectorInitializers(),D}function wE(d,p=null,m=null,x,D=new Set){const L=[m||De,hE(d)];return x=x||("object"==typeof d?void 0:ze(d)),new o_(L,p||Um(),x||null,D)}let Yp=(()=>{class d{static create(m,x){if(Array.isArray(m))return ky({name:""},x,m,"");{const D=m.name??"";return ky({name:D},m.parent,m.providers,D)}}}return d.THROW_IF_NOT_FOUND=ts,d.NULL=new C0,d.\u0275prov=bi({token:d,providedIn:"any",factory:()=>En(uc)}),d.__NG_ELEMENT_ID__=-1,d})();function jf(d,p=jn.Default){const m=dn();return null===m?En(d,p):qu(Go(),m,nt(d),p)}function j0(){throw new Error("invalid")}function fx(d,p){const m=d.contentQueries;if(null!==m)for(let x=0;x<m.length;x+=2){const L=m[x+1];if(-1!==L){const H=d.data[L];od(m[x]),H.contentQueries(2,p[L],L)}}}function Ym(d,p,m,x,D,L,H,q,ne,ce,ge){const Ae=p.blueprint.slice();return Ae[0]=D,Ae[2]=76|x,(null!==ge||d&&1024&d[2])&&(Ae[2]|=1024),Hu(Ae),Ae[3]=Ae[15]=d,Ae[8]=m,Ae[10]=H||d&&d[10],Ae[11]=q||d&&d[11],Ae[12]=ne||d&&d[12]||null,Ae[9]=ce||d&&d[9]||null,Ae[6]=L,Ae[20]=function gu(){return Ns++}(),Ae[21]=ge,Ae[16]=2==p.type?d[16]:Ae,Ae}function Cu(d,p,m,x,D){let L=d.data[p];if(null===L)L=function Gf(d,p,m,x,D){const L=ou(),H=ql(),ne=d.data[p]=function Oh(d,p,m,x,D,L){return{type:m,index:x,insertBeforeIndex:null,injectorIndex:p?p.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:D,attrs:L,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:p,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,H?L:L&&L.parent,m,p,x,D);return null===d.firstChild&&(d.firstChild=ne),null!==L&&(H?null==L.child&&null!==ne.parent&&(L.child=ne):null===L.next&&(L.next=ne)),ne}(d,p,m,x,D),function id(){return Wi.lFrame.inI18n}()&&(L.flags|=32);else if(64&L.type){L.type=m,L.value=x,L.attrs=D;const H=function su(){const d=Wi.lFrame,p=d.currentTNode;return d.isParent?p:p.parent}();L.injectorIndex=null===H?-1:H.injectorIndex}return ga(L,!0),L}function $f(d,p,m,x){if(0===m)return-1;const D=p.length;for(let L=0;L<m;L++)p.push(x),d.blueprint.push(x),d.data.push(null);return D}function Jm(d,p,m){Ql(p);try{const x=d.viewQuery;null!==x&&ap(1,x,m);const D=d.template;null!==D&&pc(d,p,D,1,m),d.firstCreatePass&&(d.firstCreatePass=!1),d.staticContentQueries&&fx(d,p),d.staticViewQueries&&ap(2,d.viewQuery,m);const L=d.components;null!==L&&function SE(d,p){for(let m=0;m<p.length;m++)ME(d,p[m])}(p,L)}catch(x){throw d.firstCreatePass&&(d.incompleteFirstPass=!0,d.firstCreatePass=!1),x}finally{p[2]&=-5,Fp()}}function Wf(d,p,m,x){const D=p[2];if(128!=(128&D)){Ql(p);try{Hu(p),function nd(d){return Wi.lFrame.bindingIndex=d}(d.bindingStartIndex),null!==m&&pc(d,p,m,2,x);const H=3==(3&D);if(H){const ce=d.preOrderCheckHooks;null!==ce&&Ea(p,ce,null)}else{const ce=d.preOrderHooks;null!==ce&&Cl(p,ce,0,null),ji(p,0)}if(function fc(d){for(let p=Ia(d);null!==p;p=jc(p)){if(!p[2])continue;const m=p[9];for(let x=0;x<m.length;x++){const D=m[x];512&D[2]||Ac(D[3],1),D[2]|=512}}}(p),function y_(d){for(let p=Ia(d);null!==p;p=jc(p))for(let m=10;m<p.length;m++){const x=p[m],D=x[1];vl(x)&&Wf(D,x,D.template,x[8])}}(p),null!==d.contentQueries&&fx(d,p),H){const ce=d.contentCheckHooks;null!==ce&&Ea(p,ce)}else{const ce=d.contentHooks;null!==ce&&Cl(p,ce,1),ji(p,1)}!function ED(d,p){const m=d.hostBindingOpCodes;if(null!==m)try{for(let x=0;x<m.length;x++){const D=m[x];if(D<0)wl(~D);else{const L=D,H=m[++x],q=m[++x];lu(H,L),q(2,p[L])}}}finally{wl(-1)}}(d,p);const q=d.components;null!==q&&function TE(d,p){for(let m=0;m<p.length;m++)Qp(d,p[m])}(p,q);const ne=d.viewQuery;if(null!==ne&&ap(2,ne,x),H){const ce=d.viewCheckHooks;null!==ce&&Ea(p,ce)}else{const ce=d.viewHooks;null!==ce&&Cl(p,ce,2),ji(p,2)}!0===d.firstUpdatePass&&(d.firstUpdatePass=!1),p[2]&=-41,512&p[2]&&(p[2]&=-513,Ac(p[3],-1))}finally{Fp()}}}function pc(d,p,m,x,D){const L=ra(),H=2&x;try{wl(-1),H&&p.length>22&&bE(d,p,22,!1),m(x,D)}finally{wl(L)}}function Ny(d,p,m){if(ko(p)){const D=p.directiveEnd;for(let L=p.directiveStart;L<D;L++){const H=d.data[L];H.contentQueries&&H.contentQueries(1,m[L],L)}}}function p_(d,p,m){vh()&&(function Xm(d,p,m,x){const D=m.directiveStart,L=m.directiveEnd;Nu(m)&&function __(d,p,m){const x=Ps(p,d),D=G0(m),L=d[10],H=Kf(d,Ym(d,D,null,m.onPush?32:16,x,p,L,L.createRenderer(x,m),null,null,null));d[p.index]=H}(p,m,d.data[D+m.componentOffset]),d.firstCreatePass||Fa(m,p),ya(x,p);const H=m.initialInputs;for(let q=D;q<L;q++){const ne=d.data[q],ce=za(p,d,q,m);ya(ce,p),null!==H&&vx(0,q-D,ce,ne,0,H),fr(ne)&&(Co(m.index,p)[8]=za(p,d,q,m))}}(d,p,m,Ps(m,p)),64==(64&m.flags)&&eg(d,p,m))}function zy(d,p,m=Ps){const x=p.localNames;if(null!==x){let D=p.index+1;for(let L=0;L<x.length;L+=2){const H=x[L+1],q=-1===H?m(p,d):d[H];d[D++]=q}}}function G0(d){const p=d.tView;return null===p||p.incompleteFirstPass?d.tView=f_(1,null,d.template,d.decls,d.vars,d.directiveDefs,d.pipeDefs,d.viewQuery,d.schemas,d.consts):p}function f_(d,p,m,x,D,L,H,q,ne,ce){const ge=22+x,Ae=ge+D,lt=function IE(d,p){const m=[];for(let x=0;x<p;x++)m.push(x<d?null:Ti);return m}(ge,Ae),mt="function"==typeof ce?ce():ce;return lt[1]={type:d,blueprint:lt,template:m,queries:null,viewQuery:q,declTNode:p,data:lt.slice().fill(null,ge),bindingStartIndex:ge,expandoStartIndex:Ae,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof L?L():L,pipeRegistry:"function"==typeof H?H():H,firstChild:null,schemas:ne,consts:mt,incompleteFirstPass:!1}}function ps(d,p,m,x){const D=jy(p);null===m?D.push(x):(D.push(m),d.firstCreatePass&&b_(d).push(x,D.length-1))}function By(d,p,m,x){for(let D in d)if(d.hasOwnProperty(D)){m=null===m?{}:m;const L=d[D];null===x?Vy(m,p,D,L):x.hasOwnProperty(D)&&Vy(m,p,x[D],L)}return m}function Vy(d,p,m,x){d.hasOwnProperty(m)?d[m].push(p,x):d[m]=[p,x]}function Wc(d,p,m,x,D,L,H,q){const ne=Ps(p,m);let ge,ce=p.inputs;!q&&null!=ce&&(ge=ce[x])?(Yf(d,m,ge,x,D),Nu(p)&&m_(m,p.index)):3&p.type&&(x=function mx(d){return"class"===d?"className":"for"===d?"htmlFor":"formaction"===d?"formAction":"innerHtml"===d?"innerHTML":"readonly"===d?"readOnly":"tabindex"===d?"tabIndex":d}(x),D=null!=H?H(D,p.value||"",x):D,L.setProperty(ne,x,D))}function m_(d,p){const m=Co(p,d);16&m[2]||(m[2]|=32)}function Zf(d,p,m,x){let D=!1;if(vh()){const L=null===x?null:{"":-1},H=function Sd(d,p){const m=d.directiveRegistry;let x=null,D=null;if(m)for(let L=0;L<m.length;L++){const H=m[L];if(Uf(p,H.selectors,!1))if(x||(x=[]),fr(H))if(null!==H.findHostDirectiveDefs){const q=[];D=D||new Map,H.findHostDirectiveDefs(H,q,D),x.unshift(...q,H),Id(d,p,q.length)}else x.unshift(H),Id(d,p,0);else D=D||new Map,H.findHostDirectiveDefs?.(H,x,D),x.push(H)}return null===x?null:[x,D]}(d,m);let q,ne;null===H?q=ne=null:[q,ne]=H,null!==q&&(D=!0,Uy(d,p,m,q,L,ne)),L&&function Dd(d,p,m){if(p){const x=d.localNames=[];for(let D=0;D<p.length;D+=2){const L=m[p[D+1]];if(null==L)throw new Je(-301,!1);x.push(p[D],L)}}}(m,x,L)}return m.mergedAttrs=oa(m.mergedAttrs,m.attrs),D}function Uy(d,p,m,x,D,L){for(let ce=0;ce<x.length;ce++)Eh(Fa(m,p),d,x[ce].type);!function Hy(d,p,m){d.flags|=1,d.directiveStart=p,d.directiveEnd=p+m,d.providerIndexes=p}(m,d.data.length,x.length);for(let ce=0;ce<x.length;ce++){const ge=x[ce];ge.providersResolver&&ge.providersResolver(ge)}let H=!1,q=!1,ne=$f(d,p,x.length,null);for(let ce=0;ce<x.length;ce++){const ge=x[ce];m.mergedAttrs=oa(m.mergedAttrs,ge.hostAttrs),AE(d,m,p,ne,ge),$0(ne,ge,D),null!==ge.contentQueries&&(m.flags|=4),(null!==ge.hostBindings||null!==ge.hostAttrs||0!==ge.hostVars)&&(m.flags|=64);const Ae=ge.type.prototype;!H&&(Ae.ngOnChanges||Ae.ngOnInit||Ae.ngDoCheck)&&((d.preOrderHooks||(d.preOrderHooks=[])).push(m.index),H=!0),!q&&(Ae.ngOnChanges||Ae.ngDoCheck)&&((d.preOrderCheckHooks||(d.preOrderCheckHooks=[])).push(m.index),q=!0),ne++}!function Qm(d,p,m){const D=p.directiveEnd,L=d.data,H=p.attrs,q=[];let ne=null,ce=null;for(let ge=p.directiveStart;ge<D;ge++){const Ae=L[ge],lt=m?m.get(Ae):null,an=lt?lt.outputs:null;ne=By(Ae.inputs,ge,ne,lt?lt.inputs:null),ce=By(Ae.outputs,ge,ce,an);const gn=null===ne||null===H||Ty(p)?null:Jp(ne,ge,H);q.push(gn)}null!==ne&&(ne.hasOwnProperty("class")&&(p.flags|=8),ne.hasOwnProperty("style")&&(p.flags|=16)),p.initialInputs=q,p.inputs=ne,p.outputs=ce}(d,m,L)}function eg(d,p,m){const x=m.directiveStart,D=m.directiveEnd,L=m.index,H=function xf(){return Wi.lFrame.currentDirectiveIndex}();try{wl(L);for(let q=x;q<D;q++){const ne=d.data[q],ce=p[q];Yl(q),(null!==ne.hostBindings||0!==ne.hostVars||null!==ne.hostAttrs)&&g_(ne,ce)}}finally{wl(-1),Yl(H)}}function g_(d,p){null!==d.hostBindings&&d.hostBindings(1,p)}function Id(d,p,m){p.componentOffset=m,(d.components||(d.components=[])).push(p.index)}function $0(d,p,m){if(m){if(p.exportAs)for(let x=0;x<p.exportAs.length;x++)m[p.exportAs[x]]=d;fr(p)&&(m[""]=d)}}function AE(d,p,m,x,D){d.data[x]=D;const L=D.factory||(D.factory=ml(D.type)),H=new kc(L,fr(D),jf);d.blueprint[x]=H,m[x]=H,function yx(d,p,m,x,D){const L=D.hostBindings;if(L){let H=d.hostBindingOpCodes;null===H&&(H=d.hostBindingOpCodes=[]);const q=~p.index;(function no(d){let p=d.length;for(;p>0;){const m=d[--p];if("number"==typeof m&&m<0)return m}return 0})(H)!=q&&H.push(q),H.push(m,x,L)}}(d,p,x,$f(d,m,D.hostVars,Ti),D)}function Lh(d,p,m,x,D,L){const H=Ps(d,p);!function W0(d,p,m,x,D,L,H){if(null==L)d.removeAttribute(p,D,m);else{const q=null==H?Ot(L):H(L,x||"",D);d.setAttribute(p,D,q,m)}}(p[11],H,L,d.value,m,x,D)}function vx(d,p,m,x,D,L){const H=L[p];if(null!==H){const q=x.setInput;for(let ne=0;ne<H.length;){const ce=H[ne++],ge=H[ne++],Ae=H[ne++];null!==q?x.setInput(m,Ae,ce,ge):m[ge]=Ae}}}function Jp(d,p,m){let x=null,D=0;for(;D<m.length;){const L=m[D];if(0!==L)if(5!==L){if("number"==typeof L)break;if(d.hasOwnProperty(L)){null===x&&(x=[]);const H=d[L];for(let q=0;q<H.length;q+=2)if(H[q]===p){x.push(L,H[q+1],m[D+1]);break}}D+=2}else D+=2;else D+=4}return x}function Z0(d,p,m,x){return[d,!0,!1,p,null,0,x,m,null,null]}function Qp(d,p){const m=Co(p,d);if(vl(m)){const x=m[1];48&m[2]?Wf(x,m,x.template,m[8]):m[5]>0&&qf(m)}}function qf(d){for(let x=Ia(d);null!==x;x=jc(x))for(let D=10;D<x.length;D++){const L=x[D];if(vl(L))if(512&L[2]){const H=L[1];Wf(H,L,H.template,L[8])}else L[5]>0&&qf(L)}const m=d[1].components;if(null!==m)for(let x=0;x<m.length;x++){const D=Co(m[x],d);vl(D)&&D[5]>0&&qf(D)}}function ME(d,p){const m=Co(p,d),x=m[1];(function q0(d,p){for(let m=p.length;m<d.blueprint.length;m++)p.push(d.blueprint[m])})(x,m),Jm(x,m,m[8])}function Kf(d,p){return d[13]?d[14][4]=p:d[13]=p,d[14]=p,p}function sp(d){for(;d;){d[2]|=32;const p=oi(d);if(Xh(d)&&!p)return d;d=p}return null}function Xp(d,p,m,x=!0){const D=p[10];D.begin&&D.begin();try{Wf(d,p,d.template,m)}catch(H){throw x&&Gy(p,H),H}finally{D.end&&D.end()}}function ap(d,p,m){od(0),p(d,m)}function jy(d){return d[7]||(d[7]=[])}function b_(d){return d.cleanup||(d.cleanup=[])}function Gy(d,p){const m=d[9],x=m?m.get(Kp,null):null;x&&x.handleError(p)}function Yf(d,p,m,x,D){for(let L=0;L<m.length;){const H=m[L++],q=m[L++],ne=p[H],ce=d.data[H];null!==ce.setInput?ce.setInput(ne,D,x,q):ne[q]=D}}function oh(d,p,m){const x=Pa(p,d);!function xs(d,p,m){d.setValue(p,m)}(d[11],x,m)}function w_(d,p,m){let x=m?d.styles:null,D=m?d.classes:null,L=0;if(null!==p)for(let H=0;H<p.length;H++){const q=p[H];"number"==typeof q?L=q:1==L?D=ht(D,q):2==L&&(x=ht(x,q+": "+p[++H]+";"))}m?d.styles=x:d.stylesWithoutHost=x,m?d.classes=D:d.classesWithoutHost=D}function x_(d,p,m,x,D=!1){for(;null!==m;){const L=p[m.index];if(null!==L&&x.push(_o(L)),uo(L))for(let q=10;q<L.length;q++){const ne=L[q],ce=ne[1].firstChild;null!==ce&&x_(ne[1],ne,ce,x)}const H=m.type;if(8&H)x_(d,p,m.child,x);else if(32&H){const q=mn(m,p);let ne;for(;ne=q();)x.push(ne)}else if(16&H){const q=Zg(p,m);if(Array.isArray(q))x.push(...q);else{const ne=oi(p[16]);x_(ne[1],ne,q,x,!0)}}m=D?m.projectionNext:m.next}return x}class Jf{get rootNodes(){const p=this._lView,m=p[1];return x_(m,p,m.firstChild,[])}constructor(p,m){this._lView=p,this._cdRefInjectingView=m,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[8]}set context(p){this._lView[8]=p}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const p=this._lView[3];if(uo(p)){const m=p[8],x=m?m.indexOf(this):-1;x>-1&&($o(p,x),fd(m,x))}this._attachedToViewContainer=!1}Al(this._lView[1],this._lView)}onDestroy(p){ps(this._lView[1],this._lView,null,p)}markForCheck(){sp(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){Xp(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Je(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Wg(d,p){jp(d,p,p[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(p){if(this._attachedToViewContainer)throw new Je(902,!1);this._appRef=p}}class kE extends Jf{constructor(p){super(p),this._view=p}detectChanges(){const p=this._view;Xp(p[1],p,p[8],!1)}checkNoChanges(){}get context(){return null}}class RE extends qp{constructor(p){super(),this.ngModule=p}resolveComponentFactory(p){const m=ci(p);return new ng(m,this.ngModule)}}function tg(d){const p=[];for(let m in d)d.hasOwnProperty(m)&&p.push({propName:d[m],templateName:m});return p}class bx{constructor(p,m){this.injector=p,this.parentInjector=m}get(p,m,x){x=wi(x);const D=this.injector.get(p,F0,x);return D!==F0||m===F0?D:this.parentInjector.get(p,m,x)}}class ng extends O0{get inputs(){return tg(this.componentDef.inputs)}get outputs(){return tg(this.componentDef.outputs)}constructor(p,m){super(),this.componentDef=p,this.ngModule=m,this.componentType=p.type,this.selector=function vD(d){return d.map(ih).join(",")}(p.selectors),this.ngContentSelectors=p.ngContentSelectors?p.ngContentSelectors:[],this.isBoundToModule=!!m}create(p,m,x,D){let L=(D=D||this.ngModule)instanceof Bf?D:D?.injector;L&&null!==this.componentDef.getStandaloneInjector&&(L=this.componentDef.getStandaloneInjector(L)||L);const H=L?new bx(p,L):p,q=H.get(Yw,null);if(null===q)throw new Je(407,!1);const ne=H.get(hc,null),ce=q.createRenderer(null,this.componentDef),ge=this.componentDef.selectors[0][0]||"div",Ae=x?function DE(d,p,m){return d.selectRootElement(p,m===ae.ShadowDom)}(ce,x,this.componentDef.encapsulation):tp(ce,ge,function lp(d){const p=d.toLowerCase();return"svg"===p?"svg":"math"===p?"math":null}(ge)),lt=this.componentDef.onPush?288:272,mt=f_(0,null,null,1,0,null,null,null,null,null),an=Ym(null,mt,null,lt,null,null,q,ce,ne,H,null);let gn,Ut;Ql(an);try{const pi=this.componentDef;let Zi,bn=null;pi.findHostDirectiveDefs?(Zi=[],bn=new Map,pi.findHostDirectiveDefs(pi,Zi,bn),Zi.push(pi)):Zi=[pi];const pr=function wx(d,p){const m=d[1];return d[22]=p,Cu(m,22,2,"#host",null)}(an,Ae),fs=function xx(d,p,m,x,D,L,H,q){const ne=D[1];!function Cx(d,p,m,x){for(const D of d)p.mergedAttrs=oa(p.mergedAttrs,D.hostAttrs);null!==p.mergedAttrs&&(w_(p,p.mergedAttrs,!0),null!==m&&vu(x,m,p))}(x,d,p,H);const ce=L.createRenderer(p,m),ge=Ym(D,G0(m),null,m.onPush?32:16,D[d.index],d,L,ce,q||null,null,null);return ne.firstCreatePass&&Id(ne,d,x.length-1),Kf(D,ge),D[d.index]=ge}(pr,Ae,pi,Zi,an,q,ce);Ut=ru(mt,22),Ae&&function ig(d,p,m,x){if(x)El(d,m,["ng-version",Cd.full]);else{const{attrs:D,classes:L}=function Dy(d){const p=[],m=[];let x=1,D=2;for(;x<d.length;){let L=d[x];if("string"==typeof L)2===D?""!==L&&p.push(L,d[++x]):8===D&&m.push(L);else{if(!Rh(D))break;D=L}x++}return{attrs:p,classes:m}}(p.selectors[0]);D&&El(d,m,D),L&&L.length>0&&sl(d,m,L.join(" "))}}(ce,pi,Ae,x),void 0!==m&&function Ex(d,p,m){const x=d.projection=[];for(let D=0;D<p.length;D++){const L=m[D];x.push(null!=L?Array.from(L):null)}}(Ut,this.ngContentSelectors,m),gn=function Wy(d,p,m,x,D,L){const H=Go(),q=D[1],ne=Ps(H,D);Uy(q,D,H,m,null,x);for(let ge=0;ge<m.length;ge++)ya(za(D,q,H.directiveStart+ge,H),D);eg(q,D,H),ne&&ya(ne,D);const ce=za(D,q,H.directiveStart+H.componentOffset,H);if(d[8]=D[8]=ce,null!==L)for(const ge of L)ge(ce,p);return Ny(q,H,d),ce}(fs,pi,Zi,bn,an,[Tx]),Jm(mt,an,null)}finally{Fp()}return new C_(this.componentType,gn,jm(Ut,an),an,Ut)}}class C_ extends P0{constructor(p,m,x,D,L){super(),this.location=x,this._rootLView=D,this._tNode=L,this.instance=m,this.hostView=this.changeDetectorRef=new kE(D),this.componentType=p}setInput(p,m){const x=this._tNode.inputs;let D;if(null!==x&&(D=x[p])){const L=this._rootLView;Yf(L[1],L,D,p,m),m_(L,this._tNode.index)}}get injector(){return new Sa(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(p){this.hostView.onDestroy(p)}}function Tx(){const d=Go();xl(dn()[1],d)}function ef(d){let p=function Zy(d){return Object.getPrototypeOf(d.prototype).constructor}(d.type),m=!0;const x=[d];for(;p;){let D;if(fr(d))D=p.\u0275cmp||p.\u0275dir;else{if(p.\u0275cmp)throw new Je(903,!1);D=p.\u0275dir}if(D){if(m){x.push(D);const H=d;H.inputs=rg(d.inputs),H.declaredInputs=rg(d.declaredInputs),H.outputs=rg(d.outputs);const q=D.hostBindings;q&&sg(d,q);const ne=D.viewQuery,ce=D.contentQueries;if(ne&&tf(d,ne),ce&&og(d,ce),y(d.inputs,D.inputs),y(d.declaredInputs,D.declaredInputs),y(d.outputs,D.outputs),fr(D)&&D.data.animation){const ge=d.data;ge.animation=(ge.animation||[]).concat(D.data.animation)}}const L=D.features;if(L)for(let H=0;H<L.length;H++){const q=L[H];q&&q.ngInherit&&q(d),q===ef&&(m=!1)}}p=Object.getPrototypeOf(p)}!function Sx(d){let p=0,m=null;for(let x=d.length-1;x>=0;x--){const D=d[x];D.hostVars=p+=D.hostVars,D.hostAttrs=oa(D.hostAttrs,m=oa(m,D.hostAttrs))}}(x)}function rg(d){return d===we?{}:d===De?[]:d}function tf(d,p){const m=d.viewQuery;d.viewQuery=m?(x,D)=>{p(x,D),m(x,D)}:p}function og(d,p){const m=d.contentQueries;d.contentQueries=m?(x,D,L)=>{p(x,D,L),m(x,D,L)}:p}function sg(d,p){const m=d.hostBindings;d.hostBindings=m?(x,D)=>{p(x,D),m(x,D)}:p}let lg=null;function sh(){if(!lg){const d=wr.Symbol;if(d&&d.iterator)lg=d.iterator;else{const p=Object.getOwnPropertyNames(Map.prototype);for(let m=0;m<p.length;++m){const x=p[m];"entries"!==x&&"size"!==x&&Map.prototype[x]===Map.prototype.entries&&(lg=x)}}}return lg}function ah(d){return!!nf(d)&&(Array.isArray(d)||!(d instanceof Map)&&sh()in d)}function nf(d){return null!==d&&("function"==typeof d||"object"==typeof d)}function Ad(d,p,m){return d[p]=m}function cg(d,p){return d[p]}function Bs(d,p,m){return!Object.is(d[p],m)&&(d[p]=m,!0)}function cp(d,p,m,x){const D=Bs(d,p,m);return Bs(d,p+1,x)||D}function lh(d,p,m,x,D){const L=cp(d,p,m,x);return Bs(d,p+2,D)||L}function Fh(d,p,m,x,D,L){const H=cp(d,p,m,x);return cp(d,p+2,D,L)||H}function Xf(d,p,m,x){const D=dn();return Bs(D,Zs(),p)&&(xi(),Lh(Or(),D,d,p,m,x)),Xf}function kd(d,p,m,x){return Bs(d,Zs(),m)?p+Ot(m)+x:Ti}function Rd(d,p,m,x,D,L){const q=cp(d,function Ws(){return Wi.lFrame.bindingIndex}(),m,D);return Kl(2),q?p+Ot(m)+x+Ot(D)+L:Ti}function nm(d,p,m,x,D,L,H,q){const ne=dn(),ce=xi(),ge=d+22,Ae=ce.firstCreatePass?function rf(d,p,m,x,D,L,H,q,ne){const ce=p.consts,ge=Cu(p,d,4,H||null,Oi(ce,q));Zf(p,m,ge,Oi(ce,ne)),xl(p,ge);const Ae=ge.tViews=f_(2,ge,x,D,L,p.directiveRegistry,p.pipeRegistry,null,p.schemas,ce);return null!==p.queries&&(p.queries.template(p,ge),Ae.queries=p.queries.embeddedTView(ge)),ge}(ge,ce,ne,p,m,x,D,L,H):ce.data[ge];ga(Ae,!1);const lt=ne[11].createComment("");Tm(ce,ne,lt,Ae),ya(lt,ne),Kf(ne,ne[ge]=Z0(lt,ne,lt,Ae)),zu(Ae)&&p_(ce,ne,Ae),null!=H&&zy(ne,Ae,q)}function Rx(d){return Oa(function $u(){return Wi.lFrame.contextLView}(),22+d)}function im(d,p,m){const x=dn();return Bs(x,Zs(),p)&&Wc(xi(),Or(),x,d,p,x[11],m,!1),im}function S_(d,p,m,x,D){const H=D?"class":"style";Yf(d,m,p.inputs[H],H,x)}function rm(d,p,m,x){const D=dn(),L=xi(),H=22+d,q=D[11],ne=D[H]=tp(q,p,function ld(){return Wi.lFrame.currentNamespace}()),ce=L.firstCreatePass?function sf(d,p,m,x,D,L,H){const q=p.consts,ce=Cu(p,d,2,D,Oi(q,L));return Zf(p,m,ce,Oi(q,H)),null!==ce.attrs&&w_(ce,ce.attrs,!1),null!==ce.mergedAttrs&&w_(ce,ce.mergedAttrs,!0),null!==p.queries&&p.queries.elementStart(p,ce),ce}(H,L,D,0,p,m,x):L.data[H];return ga(ce,!0),vu(q,ne,ce),32!=(32&ce.flags)&&Tm(L,D,ne,ce),0===function ju(){return Wi.lFrame.elementDepthCount}()&&ya(ne,D),function Rp(){Wi.lFrame.elementDepthCount++}(),zu(ce)&&(p_(L,D,ce),Ny(L,ce,D)),null!==x&&zy(D,ce),rm}function hg(){let d=Go();ql()?el():(d=d.parent,ga(d,!1));const p=d;!function yh(){Wi.lFrame.elementDepthCount--}();const m=xi();return m.firstCreatePass&&(xl(m,d),ko(d)&&m.queries.elementEnd(d)),null!=p.classesWithoutHost&&function wh(d){return 0!=(8&d.flags)}(p)&&S_(m,p,dn(),p.classesWithoutHost,!0),null!=p.stylesWithoutHost&&function Ta(d){return 0!=(16&d.flags)}(p)&&S_(m,p,dn(),p.stylesWithoutHost,!1),hg}function I_(d,p,m,x){return rm(d,p,m,x),hg(),I_}function A_(d,p,m){const x=dn(),D=xi(),L=d+22,H=D.firstCreatePass?function D_(d,p,m,x,D){const L=p.consts,H=Oi(L,x),q=Cu(p,d,8,"ng-container",H);return null!==H&&w_(q,H,!0),Zf(p,m,q,Oi(L,D)),null!==p.queries&&p.queries.elementStart(p,q),q}(L,D,x,p,m):D.data[L];ga(H,!0);const q=x[L]=x[11].createComment("");return Tm(D,x,q,H),ya(q,x),zu(H)&&(p_(D,x,H),Ny(D,H,x)),null!=m&&zy(x,H),A_}function mc(){let d=Go();const p=xi();return ql()?el():(d=d.parent,ga(d,!1)),p.firstCreatePass&&(xl(p,d),ko(d)&&p.queries.elementEnd(d)),mc}function af(d,p,m){return A_(d,p,m),mc(),af}function Px(){return dn()}function M_(d){return!!d&&"function"==typeof d.then}function tb(d){return!!d&&"function"==typeof d.subscribe}const dg=tb;function Yy(d,p,m,x){const D=dn(),L=xi(),H=Go();return function Lx(d,p,m,x,D,L,H){const q=zu(x),ce=d.firstCreatePass&&b_(d),ge=p[8],Ae=jy(p);let lt=!0;if(3&x.type||H){const gn=Ps(x,p),Ut=H?H(gn):gn,pi=Ae.length,Zi=H?pr=>H(_o(pr[x.index])):x.index;let bn=null;if(!H&&q&&(bn=function Ox(d,p,m,x){const D=d.cleanup;if(null!=D)for(let L=0;L<D.length-1;L+=2){const H=D[L];if(H===m&&D[L+1]===x){const q=p[7],ne=D[L+2];return q.length>ne?q[ne]:null}"string"==typeof H&&(L+=2)}return null}(d,p,D,x.index)),null!==bn)(bn.__ngLastListenerFn__||bn).__ngNextListenerFn__=L,bn.__ngLastListenerFn__=L,lt=!1;else{L=Tu(x,p,ge,L,!1);const pr=m.listen(Ut,D,L);Ae.push(L,pr),ce&&ce.push(D,Zi,pi,pi+1)}}else L=Tu(x,p,ge,L,!1);const mt=x.outputs;let an;if(lt&&null!==mt&&(an=mt[D])){const gn=an.length;if(gn)for(let Ut=0;Ut<gn;Ut+=2){const fs=p[an[Ut]][an[Ut+1]].subscribe(L),Ma=Ae.length;Ae.push(L,fs),ce&&ce.push(D,x.index,Ma,-(Ma+1))}}}(L,D,D[11],H,d,p,x),Yy}function R_(d,p,m,x){try{return!1!==m(x)}catch(D){return Gy(d,D),!1}}function Tu(d,p,m,x,D){return function L(H){if(H===Function)return x;sp(d.componentOffset>-1?Co(d.index,p):p);let ne=R_(p,0,x,H),ce=L.__ngNextListenerFn__;for(;ce;)ne=R_(p,0,ce,H)&&ne,ce=ce.__ngNextListenerFn__;return D&&!1===ne&&(H.preventDefault(),H.returnValue=!1),ne}}function ch(d=1){return function ay(d){return(Wi.lFrame.contextLView=function bh(d,p){for(;d>0;)p=p[15],d--;return p}(d,Wi.lFrame.contextLView))[8]}(d)}function lf(d,p){let m=null;const x=function ex(d){const p=d.attrs;if(null!=p){const m=p.indexOf(5);if(!(1&m))return p[m+1]}return null}(d);for(let D=0;D<p.length;D++){const L=p[D];if("*"!==L){if(null===x?Uf(d,L,!0):xu(x,L))return D}else m=D}return m}function zh(d){const p=dn()[16][6];if(!p.projection){const x=p.projection=Xu(d?d.length:1,null),D=x.slice();let L=p.child;for(;null!==L;){const H=d?lf(L,d):0;null!==H&&(D[H]?D[H].projectionNext=L:x[H]=L,D[H]=L),L=L.next}}}function dp(d,p=0,m){const x=dn(),D=xi(),L=Cu(D,22+d,16,null,m||null);null===L.projection&&(L.projection=p),el(),32!=(32&L.flags)&&function Sm(d,p,m){Im(p[11],0,p,m,d0(d,m,p),Ci(m.parent||p[6],m,p))}(D,x,L)}function pg(d,p,m){return P_(d,"",p,"",m),pg}function P_(d,p,m,x,D){const L=dn(),H=kd(L,p,m,x);return H!==Ti&&Wc(xi(),Or(),L,d,H,L[11],D,!1),P_}function O_(d,p){return d<<17|p<<2}function pp(d){return d>>17&32767}function L_(d){return 2|d}function om(d){return(131068&d)>>2}function Fx(d,p){return-131069&d|p<<2}function Nx(d){return 1|d}function Xy(d,p,m,x,D){const L=d[m+1],H=null===p;let q=x?pp(L):om(L),ne=!1;for(;0!==q&&(!1===ne||H);){const ge=d[q+1];cb(d[q],p)&&(ne=!0,d[q+1]=x?Nx(ge):L_(ge)),q=x?pp(ge):om(ge)}ne&&(d[m+1]=x?L_(L):Nx(L))}function cb(d,p){return null===d||null==p||(Array.isArray(d)?d[1]:d)===p||!(!Array.isArray(d)||"string"!=typeof p)&&Oo(d,p)>=0}const Fo={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function fp(d){return d.substring(Fo.key,Fo.keyEnd)}function Bx(d){return d.substring(Fo.value,Fo.valueEnd)}function Su(d,p){const m=Fo.textEnd;return m===p?-1:(p=Fo.keyEnd=function am(d,p,m){for(;p<m&&d.charCodeAt(p)>32;)p++;return p}(d,Fo.key=p,m),_g(d,p,m))}function gg(d,p){const m=Fo.textEnd;let x=Fo.key=_g(d,p,m);return m===x?-1:(x=Fo.keyEnd=function Bh(d,p,m){let x;for(;p<m&&(45===(x=d.charCodeAt(p))||95===x||(-33&x)>=65&&(-33&x)<=90||x>=48&&x<=57);)p++;return p}(d,x,m),x=ub(d,x,m),x=Fo.value=_g(d,x,m),x=Fo.valueEnd=function F_(d,p,m){let x=-1,D=-1,L=-1,H=p,q=H;for(;H<m;){const ne=d.charCodeAt(H++);if(59===ne)return q;34===ne||39===ne?q=H=jr(d,ne,H,m):p===H-4&&85===L&&82===D&&76===x&&40===ne?q=H=jr(d,41,H,m):ne>32&&(q=H),L=D,D=x,x=-33&ne}return q}(d,x,m),ub(d,x,m))}function ev(d){Fo.key=0,Fo.keyEnd=0,Fo.value=0,Fo.valueEnd=0,Fo.textEnd=d.length}function _g(d,p,m){for(;p<m&&d.charCodeAt(p)<=32;)p++;return p}function ub(d,p,m,x){return(p=_g(d,p,m))<m&&p++,p}function jr(d,p,m,x){let D=-1,L=m;for(;L<x;){const H=d.charCodeAt(L++);if(H==p&&92!==D)return L;D=92==H&&92===D?0:H}throw new Error}function l(d,p,m){return S(d,p,m,!1),l}function s(d,p){return S(d,p,null,!0),s}function c(d){R(Le,f,d,!1)}function f(d,p){for(let m=function cf(d){return ev(d),gg(d,_g(d,0,Fo.textEnd))}(p);m>=0;m=gg(p,m))Le(d,fp(p),Bx(p))}function v(d){R(Ys,C,d,!0)}function C(d,p){for(let m=function mg(d){return ev(d),Su(d,_g(d,0,Fo.textEnd))}(p);m>=0;m=Su(p,m))Ys(d,fp(p),!0)}function S(d,p,m,x){const D=dn(),L=xi(),H=Kl(2);L.firstUpdatePass&&U(L,d,H,x),p!==Ti&&Bs(D,H,p)&&Pe(L,L.data[ra()],D,D[11],d,D[H+1]=function $e(d,p){return null==d||("string"==typeof p?d+=p:"object"==typeof d&&(d=ze(np(d)))),d}(p,m),x,H)}function R(d,p,m,x){const D=xi(),L=Kl(2);D.firstUpdatePass&&U(D,null,L,x);const H=dn();if(m!==Ti&&Bs(H,L,m)){const q=D.data[ra()];if(kt(q,x)&&!N(D,L)){let ne=x?q.classesWithoutHost:q.stylesWithoutHost;null!==ne&&(m=ht(ne,m||"")),S_(D,q,H,m,x)}else!function ve(d,p,m,x,D,L,H,q){D===Ti&&(D=De);let ne=0,ce=0,ge=0<D.length?D[0]:null,Ae=0<L.length?L[0]:null;for(;null!==ge||null!==Ae;){const lt=ne<D.length?D[ne+1]:void 0,mt=ce<L.length?L[ce+1]:void 0;let gn,an=null;ge===Ae?(ne+=2,ce+=2,lt!==mt&&(an=Ae,gn=mt)):null===Ae||null!==ge&&ge<Ae?(ne+=2,an=ge):(ce+=2,an=Ae,gn=mt),null!==an&&Pe(d,p,m,x,an,gn,H,q),ge=ne<D.length?D[ne]:null,Ae=ce<L.length?L[ce]:null}}(D,q,H,H[11],H[L+1],H[L+1]=function Ie(d,p,m){if(null==m||""===m)return De;const x=[],D=np(m);if(Array.isArray(D))for(let L=0;L<D.length;L++)d(x,D[L],!0);else if("object"==typeof D)for(const L in D)D.hasOwnProperty(L)&&d(x,L,D[L]);else"string"==typeof D&&p(x,D);return x}(d,p,m),x,L)}}function N(d,p){return p>=d.expandoStartIndex}function U(d,p,m,x){const D=d.data;if(null===D[m+1]){const L=D[ra()],H=N(d,m);kt(L,x)&&null===p&&!H&&(p=!1),p=function W(d,p,m,x){const D=function rd(d){const p=Wi.lFrame.currentDirectiveIndex;return-1===p?null:d[p]}(d);let L=x?p.residualClasses:p.residualStyles;if(null===D)0===(x?p.classBindings:p.styleBindings)&&(m=he(m=le(null,d,p,m,x),p.attrs,x),L=null);else{const H=p.directiveStylingLast;if(-1===H||d[H]!==D)if(m=le(D,d,p,m,x),null===L){let ne=function Q(d,p,m){const x=m?p.classBindings:p.styleBindings;if(0!==om(x))return d[pp(x)]}(d,p,x);void 0!==ne&&Array.isArray(ne)&&(ne=le(null,d,p,ne[1],x),ne=he(ne,p.attrs,x),function ee(d,p,m,x){d[pp(m?p.classBindings:p.styleBindings)]=x}(d,p,x,ne))}else L=function oe(d,p,m){let x;const D=p.directiveEnd;for(let L=1+p.directiveStylingLast;L<D;L++)x=he(x,d[L].hostAttrs,m);return he(x,p.attrs,m)}(d,p,x)}return void 0!==L&&(x?p.residualClasses=L:p.residualStyles=L),m}(D,L,p,x),function sm(d,p,m,x,D,L){let H=L?p.classBindings:p.styleBindings,q=pp(H),ne=om(H);d[x]=m;let ge,ce=!1;if(Array.isArray(m)?(ge=m[1],(null===ge||Oo(m,ge)>0)&&(ce=!0)):ge=m,D)if(0!==ne){const lt=pp(d[q+1]);d[x+1]=O_(lt,q),0!==lt&&(d[lt+1]=Fx(d[lt+1],x)),d[q+1]=function Pd(d,p){return 131071&d|p<<17}(d[q+1],x)}else d[x+1]=O_(q,0),0!==q&&(d[q+1]=Fx(d[q+1],x)),q=x;else d[x+1]=O_(ne,0),0===q?q=x:d[ne+1]=Fx(d[ne+1],x),ne=x;ce&&(d[x+1]=L_(d[x+1])),Xy(d,ge,x,!0),Xy(d,ge,x,!1),function Yo(d,p,m,x,D){const L=D?d.residualClasses:d.residualStyles;null!=L&&"string"==typeof p&&Oo(L,p)>=0&&(m[x+1]=Nx(m[x+1]))}(p,ge,d,x,L),H=O_(q,ne),L?p.classBindings=H:p.styleBindings=H}(D,L,p,m,H,x)}}function le(d,p,m,x,D){let L=null;const H=m.directiveEnd;let q=m.directiveStylingLast;for(-1===q?q=m.directiveStart:q++;q<H&&(L=p[q],x=he(x,L.hostAttrs,D),L!==d);)q++;return null!==d&&(m.directiveStylingLast=q),x}function he(d,p,m){const x=m?1:2;let D=-1;if(null!==p)for(let L=0;L<p.length;L++){const H=p[L];"number"==typeof H?D=H:D===x&&(Array.isArray(d)||(d=void 0===d?[]:["",d]),Ys(d,H,!!m||p[++L]))}return void 0===d?null:d}function Le(d,p,m){Ys(d,p,np(m))}function Pe(d,p,m,x,D,L,H,q){if(!(3&p.type))return;const ne=d.data,ce=ne[q+1],ge=function lb(d){return 1==(1&d)}(ce)?He(ne,p,m,D,om(ce),H):void 0;Be(ge)||(Be(L)||function ab(d){return 2==(2&d)}(ce)&&(L=He(ne,null,m,D,q,H)),function Fw(d,p,m,x,D){if(p)D?d.addClass(m,x):d.removeClass(m,x);else{let L=-1===x.indexOf("-")?void 0:hr.DashCase;null==D?d.removeStyle(m,x,L):("string"==typeof D&&D.endsWith("!important")&&(D=D.slice(0,-10),L|=hr.Important),d.setStyle(m,x,D,L))}}(x,H,Pa(ra(),m),D,L))}function He(d,p,m,x,D,L){const H=null===p;let q;for(;D>0;){const ne=d[D],ce=Array.isArray(ne),ge=ce?ne[1]:ne,Ae=null===ge;let lt=m[D+1];lt===Ti&&(lt=Ae?De:void 0);let mt=Ae?Xd(lt,x):ge===x?lt:void 0;if(ce&&!Be(mt)&&(mt=Xd(ne,x)),Be(mt)&&(q=mt,H))return q;const an=d[D+1];D=H?pp(an):om(an)}if(null!==p){let ne=L?p.residualClasses:p.residualStyles;null!=ne&&(q=Xd(ne,x))}return q}function Be(d){return void 0!==d}function kt(d,p){return 0!=(d.flags&(p?8:16))}function St(d,p=""){const m=dn(),x=xi(),D=d+22,L=x.firstCreatePass?Cu(x,D,1,p,null):x.data[D],H=m[D]=function la(d,p){return d.createText(p)}(m[11],p);Tm(x,m,H,L),ga(L,!1)}function Gt(d){return Qt("",d,""),Gt}function Qt(d,p,m){const x=dn(),D=kd(x,d,p,m);return D!==Ti&&oh(x,ra(),D),Qt}function Ft(d,p,m,x,D){const L=dn(),H=Rd(L,d,p,m,x,D);return H!==Ti&&oh(L,ra(),H),Ft}function Pn(d,p,m){R(Ys,C,kd(dn(),d,p,m),!0)}const Xs=void 0;var Vh=["en",[["a","p"],["AM","PM"],Xs],[["AM","PM"],Xs,Xs],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Xs,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Xs,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Xs,"{1} 'at' {0}",Xs],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function ua(d){const m=Math.floor(Math.abs(d)),x=d.toString().replace(/^[^.]*\.?/,"").length;return 1===m&&0===x?1:5}];let Uh={};function uf(d){const p=function Iu(d){return d.toLowerCase().replace(/_/g,"-")}(d);let m=hb(p);if(m)return m;const x=p.split("-")[0];if(m=hb(x),m)return m;if("en"===x)return Vh;throw new Je(701,!1)}function N_(d){return uf(d)[Fi.PluralCase]}function hb(d){return d in Uh||(Uh[d]=wr.ng&&wr.ng.common&&wr.ng.common.locales&&wr.ng.common.locales[d]),Uh[d]}var Fi=(()=>((Fi=Fi||{})[Fi.LocaleId=0]="LocaleId",Fi[Fi.DayPeriodsFormat=1]="DayPeriodsFormat",Fi[Fi.DayPeriodsStandalone=2]="DayPeriodsStandalone",Fi[Fi.DaysFormat=3]="DaysFormat",Fi[Fi.DaysStandalone=4]="DaysStandalone",Fi[Fi.MonthsFormat=5]="MonthsFormat",Fi[Fi.MonthsStandalone=6]="MonthsStandalone",Fi[Fi.Eras=7]="Eras",Fi[Fi.FirstDayOfWeek=8]="FirstDayOfWeek",Fi[Fi.WeekendRange=9]="WeekendRange",Fi[Fi.DateFormat=10]="DateFormat",Fi[Fi.TimeFormat=11]="TimeFormat",Fi[Fi.DateTimeFormat=12]="DateTimeFormat",Fi[Fi.NumberSymbols=13]="NumberSymbols",Fi[Fi.NumberFormats=14]="NumberFormats",Fi[Fi.CurrencyCode=15]="CurrencyCode",Fi[Fi.CurrencySymbol=16]="CurrencySymbol",Fi[Fi.CurrencyName=17]="CurrencyName",Fi[Fi.Currencies=18]="Currencies",Fi[Fi.Directionality=19]="Directionality",Fi[Fi.PluralCase=20]="PluralCase",Fi[Fi.ExtraData=21]="ExtraData",Fi))();const Od="en-US";let gc=Od;function VD(d,p,m,x,D){if(d=nt(d),Array.isArray(d))for(let L=0;L<d.length;L++)VD(d[L],p,m,x,D);else{const L=xi(),H=dn();let q=wu(d)?d:nt(d.provide),ne=k0(d);const ce=Go(),ge=1048575&ce.providerIndexes,Ae=ce.directiveStart,lt=ce.providerIndexes>>20;if(wu(d)||!d.multi){const mt=new kc(ne,D,jf),an=HD(q,p,D?ge:ge+lt,Ae);-1===an?(Eh(Fa(ce,H),L,q),UD(L,d,p.length),p.push(q),ce.directiveStart++,ce.directiveEnd++,D&&(ce.providerIndexes+=1048576),m.push(mt),H.push(mt)):(m[an]=mt,H[an]=mt)}else{const mt=HD(q,p,ge+lt,Ae),an=HD(q,p,ge,ge+lt),Ut=an>=0&&m[an];if(D&&!Ut||!D&&!(mt>=0&&m[mt])){Eh(Fa(ce,H),L,q);const pi=function U3(d,p,m,x,D){const L=new kc(d,m,jf);return L.multi=[],L.index=p,L.componentProviders=0,lR(L,D,x&&!m),L}(D?V3:B3,m.length,D,x,ne);!D&&Ut&&(m[an].providerFactory=pi),UD(L,d,p.length,0),p.push(q),ce.directiveStart++,ce.directiveEnd++,D&&(ce.providerIndexes+=1048576),m.push(pi),H.push(pi)}else UD(L,d,mt>-1?mt:an,lR(m[D?an:mt],ne,!D&&x));!D&&x&&Ut&&m[an].componentProviders++}}}function UD(d,p,m,x){const D=wu(p),L=function i_(d){return!!d.useClass}(p);if(D||L){const ne=(L?nt(p.useClass):p).prototype.ngOnDestroy;if(ne){const ce=d.destroyHooks||(d.destroyHooks=[]);if(!D&&p.multi){const ge=ce.indexOf(m);-1===ge?ce.push(m,[x,ne]):ce[ge+1].push(x,ne)}else ce.push(m,ne)}}}function lR(d,p,m){return m&&d.componentProviders++,d.multi.push(p)-1}function HD(d,p,m,x){for(let D=m;D<x;D++)if(p[D]===d)return D;return-1}function B3(d,p,m,x){return jD(this.multi,[])}function V3(d,p,m,x){const D=this.multi;let L;if(this.providerFactory){const H=this.providerFactory.componentProviders,q=za(m,m[1],this.providerFactory.index,x);L=q.slice(0,H),jD(D,L);for(let ne=H;ne<q.length;ne++)L.push(q[ne])}else L=[],jD(D,L);return L}function jD(d,p){for(let m=0;m<d.length;m++)p.push((0,d[m])());return p}function cR(d,p=[]){return m=>{m.providersResolver=(x,D)=>function z3(d,p,m){const x=xi();if(x.firstCreatePass){const D=fr(d);VD(m,x.data,x.blueprint,D,!0),VD(p,x.data,x.blueprint,D,!1)}}(x,D?D(d):d,p)}}class mb{}class uR{}function H3(d,p){return new hR(d,p??null)}class hR extends mb{constructor(p,m){super(),this._parent=m,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new RE(this);const x=Ko(p);this._bootstrapComponents=Ed(x.bootstrap),this._r3Injector=wE(p,m,[{provide:mb,useValue:this},{provide:qp,useValue:this.componentFactoryResolver}],ze(p),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(p)}get injector(){return this._r3Injector}destroy(){const p=this._r3Injector;!p.destroyed&&p.destroy(),this.destroyCbs.forEach(m=>m()),this.destroyCbs=null}onDestroy(p){this.destroyCbs.push(p)}}class GD extends uR{constructor(p){super(),this.moduleType=p}create(p){return new hR(this.moduleType,p)}}class j3 extends mb{constructor(p,m,x){super(),this.componentFactoryResolver=new RE(this),this.instance=null;const D=new o_([...p,{provide:mb,useValue:this},{provide:qp,useValue:this.componentFactoryResolver}],m||Um(),x,new Set(["environment"]));this.injector=D,D.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(p){this.injector.onDestroy(p)}}function $D(d,p,m=null){return new j3(d,p,m).injector}let G3=(()=>{class d{constructor(m){this._injector=m,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(m){if(!m.standalone)return null;if(!this.cachedInjectors.has(m.id)){const x=zm(0,m.type),D=x.length>0?$D([x],this._injector,`Standalone[${m.type.name}]`):null;this.cachedInjectors.set(m.id,D)}return this.cachedInjectors.get(m.id)}ngOnDestroy(){try{for(const m of this.cachedInjectors.values())null!==m&&m.destroy()}finally{this.cachedInjectors.clear()}}}return d.\u0275prov=bi({token:d,providedIn:"environment",factory:()=>new d(En(Bf))}),d})();function dR(d){d.getStandaloneInjector=p=>p.get(G3).getOrCreateStandaloneInjector(d)}function vR(d,p,m){const x=bs()+d,D=dn();return D[x]===Ti?Ad(D,x,m?p.call(m):p()):cg(D,x)}function bR(d,p,m,x){return gb(dn(),bs(),d,p,m,x)}function wR(d,p,m,x,D){return function sv(d,p,m,x,D,L,H){const q=p+m;return cp(d,q,D,L)?Ad(d,q+2,H?x.call(H,D,L):x(D,L)):bg(d,q+2)}(dn(),bs(),d,p,m,x,D)}function xR(d,p,m,x,D,L){return function qD(d,p,m,x,D,L,H,q){const ne=p+m;return lh(d,ne,D,L,H)?Ad(d,ne+3,q?x.call(q,D,L,H):x(D,L,H)):bg(d,ne+3)}(dn(),bs(),d,p,m,x,D,L)}function CR(d,p,m,x,D,L,H){return qx(dn(),bs(),d,p,m,x,D,L,H)}function ZD(d,p,m,x,D,L,H,q){const ne=bs()+d,ce=dn(),ge=Fh(ce,ne,m,x,D,L);return Bs(ce,ne+4,H)||ge?Ad(ce,ne+5,q?p.call(q,m,x,D,L,H):p(m,x,D,L,H)):cg(ce,ne+5)}function df(d,p,m,x,D,L,H,q,ne){const ce=bs()+d,ge=dn(),Ae=Fh(ge,ce,m,x,D,L);return cp(ge,ce+4,H,q)||Ae?Ad(ge,ce+6,ne?p.call(ne,m,x,D,L,H,q):p(m,x,D,L,H,q)):cg(ge,ce+6)}function Si(d,p,m,x,D,L,H,q,ne,ce){const ge=bs()+d,Ae=dn();let lt=Fh(Ae,ge,m,x,D,L);return lh(Ae,ge+4,H,q,ne)||lt?Ad(Ae,ge+7,ce?p.call(ce,m,x,D,L,H,q,ne):p(m,x,D,L,H,q,ne)):cg(Ae,ge+7)}function lr(d,p,m,x){return function KD(d,p,m,x,D,L){let H=p+m,q=!1;for(let ne=0;ne<D.length;ne++)Bs(d,H++,D[ne])&&(q=!0);return q?Ad(d,H,x.apply(L,D)):bg(d,H)}(dn(),bs(),d,p,m,x)}function bg(d,p){const m=d[p];return m===Ti?void 0:m}function gb(d,p,m,x,D,L){const H=p+m;return Bs(d,H,D)?Ad(d,H+1,L?x.call(L,D):x(D)):bg(d,H+1)}function qx(d,p,m,x,D,L,H,q,ne){const ce=p+m;return Fh(d,ce,D,L,H,q)?Ad(d,ce+4,ne?x.call(ne,D,L,H,q):x(D,L,H,q)):bg(d,ce+4)}function YD(d,p){const m=xi();let x;const D=d+22;m.firstCreatePass?(x=function ER(d,p){if(p)for(let m=p.length-1;m>=0;m--){const x=p[m];if(d===x.name)return x}}(p,m.pipeRegistry),m.data[D]=x,x.onDestroy&&(m.destroyHooks||(m.destroyHooks=[])).push(D,x.onDestroy)):x=m.data[D];const L=x.factory||(x.factory=ml(x.type)),H=Wr(jf);try{const q=ec(!1),ne=L();return ec(q),function Ky(d,p,m,x){m>=d.data.length&&(d.data[m]=null,d.blueprint[m]=null),p[m]=x}(m,dn(),D,ne),ne}finally{Wr(H)}}function _b(d,p,m){const x=d+22,D=dn(),L=Oa(D,x);return B_(D,x)?gb(D,bs(),p,L.transform,m,L):L.transform(m)}function JD(d,p,m,x,D,L){const H=d+22,q=dn(),ne=Oa(q,H);return B_(q,H)?qx(q,bs(),p,ne.transform,m,x,D,L,ne):ne.transform(m,x,D,L)}function B_(d,p){return d[1].data[p].pure}function Ol(d){return p=>{setTimeout(d,void 0,p)}}const pf=class XD extends pe.x{constructor(p=!1){super(),this.__isAsync=p}emit(p){super.next(p)}subscribe(p,m,x){let D=p,L=m||(()=>null),H=x;if(p&&"object"==typeof p){const ne=p;D=ne.next?.bind(ne),L=ne.error?.bind(ne),H=ne.complete?.bind(ne)}this.__isAsync&&(L=Ol(L),D&&(D=Ol(D)),H&&(H=Ol(H)));const q=super.subscribe({next:D,error:L,complete:H});return p instanceof o.w0&&p.add(q),q}};function Kx(){return this._results[sh()]()}class Yx{get changes(){return this._changes||(this._changes=new pf)}constructor(p=!1){this._emitDistinctChangesOnly=p,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const m=sh(),x=Yx.prototype;x[m]||(x[m]=Kx)}get(p){return this._results[p]}map(p){return this._results.map(p)}filter(p){return this._results.filter(p)}find(p){return this._results.find(p)}reduce(p,m){return this._results.reduce(p,m)}forEach(p){this._results.forEach(p)}some(p){return this._results.some(p)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(p,m){const x=this;x.dirty=!1;const D=function hs(d){return d.flat(Number.POSITIVE_INFINITY)}(p);(this._changesDetected=!function pu(d,p,m){if(d.length!==p.length)return!1;for(let x=0;x<d.length;x++){let D=d[x],L=p[x];if(m&&(D=m(D),L=m(L)),L!==D)return!1}return!0}(x._results,D,m))&&(x._results=D,x.length=D.length,x.last=D[this.length-1],x.first=D[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let V_=(()=>{class d{}return d.__NG_ELEMENT_ID__=YE,d})();const Jx=V_,ff=class extends Jx{constructor(p,m,x){super(),this._declarationLView=p,this._declarationTContainer=m,this.elementRef=x}createEmbeddedView(p,m){const x=this._declarationTContainer.tViews,D=Ym(this._declarationLView,x,p,16,null,x.declTNode,null,null,null,null,m||null);D[17]=this._declarationLView[this._declarationTContainer.index];const H=this._declarationLView[19];return null!==H&&(D[19]=H.createEmbeddedView(x)),Jm(x,D,p),new Jf(D)}};function YE(){return Qx(Go(),dn())}function Qx(d,p){return 4&d.type?new ff(p,d,jm(d,p)):null}let Xx=(()=>{class d{}return d.__NG_ELEMENT_ID__=av,d})();function av(){return XE(Go(),dn())}const eA=Xx,e1=class extends eA{constructor(p,m,x){super(),this._lContainer=p,this._hostTNode=m,this._hostLView=x}get element(){return jm(this._hostTNode,this._hostLView)}get injector(){return new Sa(this._hostTNode,this._hostLView)}get parentInjector(){const p=hu(this._hostTNode,this._hostLView);if(_a(p)){const m=nl(p,this._hostLView),x=uu(p);return new Sa(m[1].data[x+8],m)}return new Sa(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(p){const m=JE(this._lContainer);return null!==m&&m[p]||null}get length(){return this._lContainer.length-10}createEmbeddedView(p,m,x){let D,L;"number"==typeof x?D=x:null!=x&&(D=x.index,L=x.injector);const H=p.createEmbeddedView(m||{},L);return this.insert(H,D),H}createComponent(p,m,x,D,L){const H=p&&!function oc(d){return"function"==typeof d}(p);let q;if(H)q=m;else{const Ae=m||{};q=Ae.index,x=Ae.injector,D=Ae.projectableNodes,L=Ae.environmentInjector||Ae.ngModuleRef}const ne=H?p:new ng(ci(p)),ce=x||this.parentInjector;if(!L&&null==ne.ngModule){const lt=(H?ce:this.parentInjector).get(Bf,null);lt&&(L=lt)}const ge=ne.create(ce,D,void 0,L);return this.insert(ge.hostView,q),ge}insert(p,m){const x=p._lView,D=x[1];if(function $d(d){return uo(d[3])}(x)){const ge=this.indexOf(p);if(-1!==ge)this.detach(ge);else{const Ae=x[3],lt=new e1(Ae,Ae[6],Ae[3]);lt.detach(lt.indexOf(p))}}const L=this._adjustIndex(m),H=this._lContainer;!function Pf(d,p,m,x){const D=10+x,L=m.length;x>0&&(m[D-1][4]=p),x<L-10?(p[4]=m[D],Mf(m,10+x,p)):(m.push(p),p[4]=null),p[3]=m;const H=p[17];null!==H&&m!==H&&function ol(d,p){const m=d[9];p[16]!==p[3][3][16]&&(d[2]=!0),null===m?d[9]=[p]:m.push(p)}(H,p);const q=p[19];null!==q&&q.insertView(d),p[2]|=64}(D,x,H,L);const q=Dh(L,H),ne=x[11],ce=Of(ne,H[7]);return null!==ce&&function hy(d,p,m,x,D,L){x[0]=D,x[6]=p,jp(d,x,m,1,D,L)}(D,H[6],ne,x,ce,q),p.attachToViewContainerRef(),Mf(QE(H),L,p),p}move(p,m){return this.insert(p,m)}indexOf(p){const m=JE(this._lContainer);return null!==m?m.indexOf(p):-1}remove(p){const m=this._adjustIndex(p,-1),x=$o(this._lContainer,m);x&&(fd(QE(this._lContainer),m),Al(x[1],x))}detach(p){const m=this._adjustIndex(p,-1),x=$o(this._lContainer,m);return x&&null!=fd(QE(this._lContainer),m)?new Jf(x):null}_adjustIndex(p,m=0){return p??this.length+m}};function JE(d){return d[8]}function QE(d){return d[8]||(d[8]=[])}function XE(d,p){let m;const x=p[d.index];if(uo(x))m=x;else{let D;if(8&d.type)D=_o(x);else{const L=p[11];D=L.createComment("");const H=Ps(d,p);Up(L,Of(L,H),D,function Cs(d,p){return d.nextSibling(p)}(L,H),!1)}p[d.index]=m=Z0(x,p,D,d),Kf(p,m)}return new e1(m,d,p)}class lv{constructor(p){this.queryList=p,this.matches=null}clone(){return new lv(this.queryList)}setDirty(){this.queryList.setDirty()}}class yb{constructor(p=[]){this.queries=p}createEmbeddedView(p){const m=p.queries;if(null!==m){const x=null!==p.contentQueries?p.contentQueries[0]:m.length,D=[];for(let L=0;L<x;L++){const H=m.getByIndex(L);D.push(this.queries[H.indexInDeclarationView].clone())}return new yb(D)}return null}insertView(p){this.dirtyQueriesWithMatches(p)}detachView(p){this.dirtyQueriesWithMatches(p)}dirtyQueriesWithMatches(p){for(let m=0;m<this.queries.length;m++)null!==wb(p,m).matches&&this.queries[m].setDirty()}}class t1{constructor(p,m,x=null){this.predicate=p,this.flags=m,this.read=x}}class vb{constructor(p=[]){this.queries=p}elementStart(p,m){for(let x=0;x<this.queries.length;x++)this.queries[x].elementStart(p,m)}elementEnd(p){for(let m=0;m<this.queries.length;m++)this.queries[m].elementEnd(p)}embeddedTView(p){let m=null;for(let x=0;x<this.length;x++){const D=null!==m?m.length:0,L=this.getByIndex(x).embeddedTView(p,D);L&&(L.indexInDeclarationView=x,null!==m?m.push(L):m=[L])}return null!==m?new vb(m):null}template(p,m){for(let x=0;x<this.queries.length;x++)this.queries[x].template(p,m)}getByIndex(p){return this.queries[p]}get length(){return this.queries.length}track(p){this.queries.push(p)}}class eT{constructor(p,m=-1){this.metadata=p,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=m}elementStart(p,m){this.isApplyingToNode(m)&&this.matchTNode(p,m)}elementEnd(p){this._declarationNodeIndex===p.index&&(this._appliesToNextNode=!1)}template(p,m){this.elementStart(p,m)}embeddedTView(p,m){return this.isApplyingToNode(p)?(this.crossesNgTemplate=!0,this.addMatch(-p.index,m),new eT(this.metadata)):null}isApplyingToNode(p){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const m=this._declarationNodeIndex;let x=p.parent;for(;null!==x&&8&x.type&&x.index!==m;)x=x.parent;return m===(null!==x?x.index:-1)}return this._appliesToNextNode}matchTNode(p,m){const x=this.metadata.predicate;if(Array.isArray(x))for(let D=0;D<x.length;D++){const L=x[D];this.matchTNodeWithReadOption(p,m,TR(m,L)),this.matchTNodeWithReadOption(p,m,Fc(m,p,L,!1,!1))}else x===V_?4&m.type&&this.matchTNodeWithReadOption(p,m,-1):this.matchTNodeWithReadOption(p,m,Fc(m,p,x,!1,!1))}matchTNodeWithReadOption(p,m,x){if(null!==x){const D=this.metadata.read;if(null!==D)if(D===Vf||D===Xx||D===V_&&4&m.type)this.addMatch(m.index,-2);else{const L=Fc(m,p,D,!1,!1);null!==L&&this.addMatch(m.index,L)}else this.addMatch(m.index,x)}}addMatch(p,m){null===this.matches?this.matches=[p,m]:this.matches.push(p,m)}}function TR(d,p){const m=d.localNames;if(null!==m)for(let x=0;x<m.length;x+=2)if(m[x]===p)return m[x+1];return null}function tA(d,p,m,x){return-1===m?function tT(d,p){return 11&d.type?jm(d,p):4&d.type?Qx(d,p):null}(p,d):-2===m?function SR(d,p,m){return m===Vf?jm(p,d):m===V_?Qx(p,d):m===Xx?XE(p,d):void 0}(d,p,x):za(d,d[1],m,p)}function cv(d,p,m,x){const D=p[19].queries[x];if(null===D.matches){const L=d.data,H=m.matches,q=[];for(let ne=0;ne<H.length;ne+=2){const ce=H[ne];q.push(ce<0?null:tA(p,L[ce],H[ne+1],m.metadata.read))}D.matches=q}return D.matches}function nT(d,p,m,x){const D=d.queries.getByIndex(m),L=D.matches;if(null!==L){const H=cv(d,p,D,m);for(let q=0;q<L.length;q+=2){const ne=L[q];if(ne>0)x.push(H[q/2]);else{const ce=L[q+1],ge=p[-ne];for(let Ae=10;Ae<ge.length;Ae++){const lt=ge[Ae];lt[17]===lt[3]&&nT(lt[1],lt,ce,x)}if(null!==ge[9]){const Ae=ge[9];for(let lt=0;lt<Ae.length;lt++){const mt=Ae[lt];nT(mt[1],mt,ce,x)}}}}}return x}function uv(d){const p=dn(),m=xi(),x=Jl();od(x+1);const D=wb(m,x);if(d.dirty&&function yl(d){return 4==(4&d[2])}(p)===(2==(2&D.metadata.flags))){if(null===D.matches)d.reset([]);else{const L=D.crossesNgTemplate?nT(m,p,x,[]):cv(m,p,D,x);d.reset(L,Kw),d.notifyOnChanges()}return!0}return!1}function nA(d,p,m){const x=xi();x.firstCreatePass&&(oT(x,new t1(d,p,m),-1),2==(2&p)&&(x.staticViewQueries=!0)),rT(x,dn(),p)}function iA(d,p,m,x){const D=xi();if(D.firstCreatePass){const L=Go();oT(D,new t1(p,m,x),L.index),function rA(d,p){const m=d.contentQueries||(d.contentQueries=[]);p!==(m.length?m[m.length-1]:-1)&&m.push(d.queries.length-1,p)}(D,d),2==(2&m)&&(D.staticContentQueries=!0)}rT(D,dn(),m)}function bb(){return function iT(d,p){return d[19].queries[p].queryList}(dn(),Jl())}function rT(d,p,m){const x=new Yx(4==(4&m));ps(d,p,x,x.destroy),null===p[19]&&(p[19]=new yb),p[19].queries.push(new lv(x))}function oT(d,p,m){null===d.queries&&(d.queries=new vb),d.queries.track(new eT(p,m))}function wb(d,p){return d.queries.getByIndex(p)}function n1(d,p){return Qx(d,p)}function fv(...d){}const Sb=new Cr("Application Initializer");let Eg=(()=>{class d{constructor(m){this.appInits=m,this.resolve=fv,this.reject=fv,this.initialized=!1,this.done=!1,this.donePromise=new Promise((x,D)=>{this.resolve=x,this.reject=D})}runInitializers(){if(this.initialized)return;const m=[],x=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let D=0;D<this.appInits.length;D++){const L=this.appInits[D]();if(M_(L))m.push(L);else if(dg(L)){const H=new Promise((q,ne)=>{L.subscribe({complete:q,error:ne})});m.push(H)}}Promise.all(m).then(()=>{x()}).catch(D=>{this.reject(D)}),0===m.length&&x(),this.initialized=!0}}return d.\u0275fac=function(m){return new(m||d)(En(Sb,8))},d.\u0275prov=bi({token:d,factory:d.\u0275fac,providedIn:"root"}),d})();const CT=new Cr("AppId",{providedIn:"root",factory:function vA(){return`${mv()}${mv()}${mv()}`}});function mv(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const h1=new Cr("Platform Initializer"),wA=new Cr("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),ET=new Cr("appBootstrapListener"),LR=new Cr("AnimationModuleType");let Ib=(()=>{class d{log(m){console.log(m)}warn(m){console.warn(m)}}return d.\u0275fac=function(m){return new(m||d)},d.\u0275prov=bi({token:d,factory:d.\u0275fac,providedIn:"platform"}),d})();const H_=new Cr("LocaleId",{providedIn:"root",factory:()=>zn(H_,jn.Optional|jn.SkipSelf)||function xA(){return typeof $localize<"u"&&$localize.locale||Od}()}),Db=new Cr("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class FR{constructor(p,m){this.ngModuleFactory=p,this.componentFactories=m}}let EA=(()=>{class d{compileModuleSync(m){return new GD(m)}compileModuleAsync(m){return Promise.resolve(this.compileModuleSync(m))}compileModuleAndAllComponentsSync(m){const x=this.compileModuleSync(m),L=Ed(Ko(m).declarations).reduce((H,q)=>{const ne=ci(q);return ne&&H.push(new ng(ne)),H},[]);return new FR(x,L)}compileModuleAndAllComponentsAsync(m){return Promise.resolve(this.compileModuleAndAllComponentsSync(m))}clearCache(){}clearCacheFor(m){}getModuleId(m){}}return d.\u0275fac=function(m){return new(m||d)},d.\u0275prov=bi({token:d,factory:d.\u0275fac,providedIn:"root"}),d})();const ea=(()=>Promise.resolve(0))();function _v(d){typeof Zone>"u"?ea.then(()=>{d&&d.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",d)}class Fd{constructor({enableLongStackTrace:p=!1,shouldCoalesceEventChangeDetection:m=!1,shouldCoalesceRunChangeDetection:x=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new pf(!1),this.onMicrotaskEmpty=new pf(!1),this.onStable=new pf(!1),this.onError=new pf(!1),typeof Zone>"u")throw new Je(908,!1);Zone.assertZonePatched();const D=this;D._nesting=0,D._outer=D._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(D._inner=D._inner.fork(new Zone.TaskTrackingZoneSpec)),p&&Zone.longStackTraceZoneSpec&&(D._inner=D._inner.fork(Zone.longStackTraceZoneSpec)),D.shouldCoalesceEventChangeDetection=!x&&m,D.shouldCoalesceRunChangeDetection=x,D.lastRequestAnimationFrameId=-1,D.nativeRequestAnimationFrame=function Mb(){let d=wr.requestAnimationFrame,p=wr.cancelAnimationFrame;if(typeof Zone<"u"&&d&&p){const m=d[Zone.__symbol__("OriginalDelegate")];m&&(d=m);const x=p[Zone.__symbol__("OriginalDelegate")];x&&(p=x)}return{nativeRequestAnimationFrame:d,nativeCancelAnimationFrame:p}}().nativeRequestAnimationFrame,function zR(d){const p=()=>{!function NR(d){d.isCheckStableRunning||-1!==d.lastRequestAnimationFrameId||(d.lastRequestAnimationFrameId=d.nativeRequestAnimationFrame.call(wr,()=>{d.fakeTopEventTask||(d.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{d.lastRequestAnimationFrameId=-1,IT(d),d.isCheckStableRunning=!0,ST(d),d.isCheckStableRunning=!1},void 0,()=>{},()=>{})),d.fakeTopEventTask.invoke()}),IT(d))}(d)};d._inner=d._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(m,x,D,L,H,q)=>{try{return yv(d),m.invokeTask(D,L,H,q)}finally{(d.shouldCoalesceEventChangeDetection&&"eventTask"===L.type||d.shouldCoalesceRunChangeDetection)&&p(),cm(d)}},onInvoke:(m,x,D,L,H,q,ne)=>{try{return yv(d),m.invoke(D,L,H,q,ne)}finally{d.shouldCoalesceRunChangeDetection&&p(),cm(d)}},onHasTask:(m,x,D,L)=>{m.hasTask(D,L),x===D&&("microTask"==L.change?(d._hasPendingMicrotasks=L.microTask,IT(d),ST(d)):"macroTask"==L.change&&(d.hasPendingMacrotasks=L.macroTask))},onHandleError:(m,x,D,L)=>(m.handleError(D,L),d.runOutsideAngular(()=>d.onError.emit(L)),!1)})}(D)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Fd.isInAngularZone())throw new Je(909,!1)}static assertNotInAngularZone(){if(Fd.isInAngularZone())throw new Je(909,!1)}run(p,m,x){return this._inner.run(p,m,x)}runTask(p,m,x,D){const L=this._inner,H=L.scheduleEventTask("NgZoneEvent: "+D,p,SA,fv,fv);try{return L.runTask(H,m,x)}finally{L.cancelTask(H)}}runGuarded(p,m,x){return this._inner.runGuarded(p,m,x)}runOutsideAngular(p){return this._outer.run(p)}}const SA={};function ST(d){if(0==d._nesting&&!d.hasPendingMicrotasks&&!d.isStable)try{d._nesting++,d.onMicrotaskEmpty.emit(null)}finally{if(d._nesting--,!d.hasPendingMicrotasks)try{d.runOutsideAngular(()=>d.onStable.emit(null))}finally{d.isStable=!0}}}function IT(d){d.hasPendingMicrotasks=!!(d._hasPendingMicrotasks||(d.shouldCoalesceEventChangeDetection||d.shouldCoalesceRunChangeDetection)&&-1!==d.lastRequestAnimationFrameId)}function yv(d){d._nesting++,d.isStable&&(d.isStable=!1,d.onUnstable.emit(null))}function cm(d){d._nesting--,ST(d)}class IA{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new pf,this.onMicrotaskEmpty=new pf,this.onStable=new pf,this.onError=new pf}run(p,m,x){return p.apply(m,x)}runGuarded(p,m,x){return p.apply(m,x)}runOutsideAngular(p){return p()}runTask(p,m,x,D){return p.apply(m,x)}}const DT=new Cr(""),AT=new Cr("");let p1,vv=(()=>{class d{constructor(m,x,D){this._ngZone=m,this.registry=x,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,p1||(function BR(d){p1=d}(D),D.addToWindow(x)),this._watchAngularEvents(),m.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Fd.assertNotInAngularZone(),_v(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())_v(()=>{for(;0!==this._callbacks.length;){let m=this._callbacks.pop();clearTimeout(m.timeoutId),m.doneCb(this._didWork)}this._didWork=!1});else{let m=this.getPendingTasks();this._callbacks=this._callbacks.filter(x=>!x.updateCb||!x.updateCb(m)||(clearTimeout(x.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(m=>({source:m.source,creationLocation:m.creationLocation,data:m.data})):[]}addCallback(m,x,D){let L=-1;x&&x>0&&(L=setTimeout(()=>{this._callbacks=this._callbacks.filter(H=>H.timeoutId!==L),m(this._didWork,this.getPendingTasks())},x)),this._callbacks.push({doneCb:m,timeoutId:L,updateCb:D})}whenStable(m,x,D){if(D&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(m,x,D),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(m){this.registry.registerApplication(m,this)}unregisterApplication(m){this.registry.unregisterApplication(m)}findProviders(m,x,D){return[]}}return d.\u0275fac=function(m){return new(m||d)(En(Fd),En(DA),En(AT))},d.\u0275prov=bi({token:d,factory:d.\u0275fac}),d})(),DA=(()=>{class d{constructor(){this._applications=new Map}registerApplication(m,x){this._applications.set(m,x)}unregisterApplication(m){this._applications.delete(m)}unregisterAllApplications(){this._applications.clear()}getTestability(m){return this._applications.get(m)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(m,x=!0){return p1?.findTestabilityInTree(this,m,x)??null}}return d.\u0275fac=function(m){return new(m||d)},d.\u0275prov=bi({token:d,factory:d.\u0275fac,providedIn:"platform"}),d})(),Tg=null;const MT=new Cr("AllowMultipleToken"),f1=new Cr("PlatformDestroyListeners");class RT{constructor(p,m){this.name=p,this.token=m}}function bv(d,p,m=[]){const x=`Platform: ${p}`,D=new Cr(x);return(L=[])=>{let H=G_();if(!H||H.injector.get(MT,!1)){const q=[...m,...L,{provide:D,useValue:!0}];d?d(q):function UR(d){if(Tg&&!Tg.get(MT,!1))throw new Je(400,!1);Tg=d;const p=d.get(wv);(function MA(d){const p=d.get(h1,null);p&&p.forEach(m=>m())})(d)}(function g1(d=[],p){return Yp.create({name:p,providers:[{provide:Vm,useValue:"platform"},{provide:f1,useValue:new Set([()=>Tg=null])},...d]})}(q,x))}return function m1(d){const p=G_();if(!p)throw new Je(401,!1);return p}()}}function G_(){return Tg?.get(wv)??null}let wv=(()=>{class d{constructor(m){this._injector=m,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(m,x){const D=function ha(d,p){let m;return m="noop"===d?new IA:("zone.js"===d?void 0:d)||new Fd(p),m}(x?.ngZone,function kA(d){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!d||!d.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!d||!d.ngZoneRunCoalescing)||!1}}(x)),L=[{provide:Fd,useValue:D}];return D.run(()=>{const H=Yp.create({providers:L,parent:this.injector,name:m.moduleType.name}),q=m.create(H),ne=q.injector.get(Kp,null);if(!ne)throw new Je(402,!1);return D.runOutsideAngular(()=>{const ce=D.onError.subscribe({next:ge=>{ne.handleError(ge)}});q.onDestroy(()=>{y1(this._modules,q),ce.unsubscribe()})}),function OT(d,p,m){try{const x=m();return M_(x)?x.catch(D=>{throw p.runOutsideAngular(()=>d.handleError(D)),D}):x}catch(x){throw p.runOutsideAngular(()=>d.handleError(x)),x}}(ne,D,()=>{const ce=q.injector.get(Eg);return ce.runInitializers(),ce.donePromise.then(()=>(function vg(d){zi(d,"Expected localeId to be defined"),"string"==typeof d&&(gc=d.toLowerCase().replace(/_/g,"-"))}(q.injector.get(H_,Od)||Od),this._moduleDoBootstrap(q),q))})})}bootstrapModule(m,x=[]){const D=RA({},x);return function kT(d,p,m){const x=new GD(m);return Promise.resolve(x)}(0,0,m).then(L=>this.bootstrapModuleFactory(L,D))}_moduleDoBootstrap(m){const x=m.injector.get(_1);if(m._bootstrapComponents.length>0)m._bootstrapComponents.forEach(D=>x.bootstrap(D));else{if(!m.instance.ngDoBootstrap)throw new Je(-403,!1);m.instance.ngDoBootstrap(x)}this._modules.push(m)}onDestroy(m){this._destroyListeners.push(m)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Je(404,!1);this._modules.slice().forEach(x=>x.destroy()),this._destroyListeners.forEach(x=>x());const m=this._injector.get(f1,null);m&&(m.forEach(x=>x()),m.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return d.\u0275fac=function(m){return new(m||d)(En(Yp))},d.\u0275prov=bi({token:d,factory:d.\u0275fac,providedIn:"platform"}),d})();function RA(d,p){return Array.isArray(p)?p.reduce(RA,d):{...d,...p}}let _1=(()=>{class d{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(m,x,D){this._zone=m,this._injector=x,this._exceptionHandler=D,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const L=new xe.y(q=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{q.next(this._stable),q.complete()})}),H=new xe.y(q=>{let ne;this._zone.runOutsideAngular(()=>{ne=this._zone.onStable.subscribe(()=>{Fd.assertNotInAngularZone(),_v(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,q.next(!0))})})});const ce=this._zone.onUnstable.subscribe(()=>{Fd.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{q.next(!1)}))});return()=>{ne.unsubscribe(),ce.unsubscribe()}});this.isStable=(0,ct.T)(L,H.pipe((0,Ct.B)()))}bootstrap(m,x){const D=m instanceof O0;if(!this._injector.get(Eg).done)throw!D&&Rt(m),new Je(405,false);let H;H=D?m:this._injector.get(qp).resolveComponentFactory(m),this.componentTypes.push(H.componentType);const q=function AA(d){return d.isBoundToModule}(H)?void 0:this._injector.get(mb),ce=H.create(Yp.NULL,[],x||H.selector,q),ge=ce.location.nativeElement,Ae=ce.injector.get(DT,null);return Ae?.registerApplication(ge),ce.onDestroy(()=>{this.detachView(ce.hostView),y1(this.components,ce),Ae?.unregisterApplication(ge)}),this._loadComponent(ce),ce}tick(){if(this._runningTick)throw new Je(101,!1);try{this._runningTick=!0;for(let m of this._views)m.detectChanges()}catch(m){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(m))}finally{this._runningTick=!1}}attachView(m){const x=m;this._views.push(x),x.attachToAppRef(this)}detachView(m){const x=m;y1(this._views,x),x.detachFromAppRef()}_loadComponent(m){this.attachView(m.hostView),this.tick(),this.components.push(m);const x=this._injector.get(ET,[]);x.push(...this._bootstrapListeners),x.forEach(D=>D(m))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(m=>m()),this._views.slice().forEach(m=>m.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(m){return this._destroyListeners.push(m),()=>y1(this._destroyListeners,m)}destroy(){if(this._destroyed)throw new Je(406,!1);const m=this._injector;m.destroy&&!m.destroyed&&m.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return d.\u0275fac=function(m){return new(m||d)(En(Fd),En(Bf),En(Kp))},d.\u0275prov=bi({token:d,factory:d.\u0275fac,providedIn:"root"}),d})();function y1(d,p){const m=d.indexOf(p);m>-1&&d.splice(m,1)}function OA(){return!1}function v1(){}let LA=(()=>{class d{}return d.__NG_ELEMENT_ID__=NT,d})();function NT(d){return function kb(d,p,m){if(Nu(d)&&!m){const x=Co(d.index,p);return new Jf(x,x)}return 47&d.type?new Jf(p[16],p):null}(Go(),dn(),16==(16&d))}class hh{constructor(){}supports(p){return ah(p)}create(p){return new VA(p)}}const BA=(d,p)=>p;class VA{constructor(p){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=p||BA}forEachItem(p){let m;for(m=this._itHead;null!==m;m=m._next)p(m)}forEachOperation(p){let m=this._itHead,x=this._removalsHead,D=0,L=null;for(;m||x;){const H=!x||m&&m.currentIndex<C1(x,D,L)?m:x,q=C1(H,D,L),ne=H.currentIndex;if(H===x)D--,x=x._nextRemoved;else if(m=m._next,null==H.previousIndex)D++;else{L||(L=[]);const ce=q-D,ge=ne-D;if(ce!=ge){for(let lt=0;lt<ce;lt++){const mt=lt<L.length?L[lt]:L[lt]=0,an=mt+lt;ge<=an&&an<ce&&(L[lt]=mt+1)}L[H.previousIndex]=ge-ce}}q!==ne&&p(H,q,ne)}}forEachPreviousItem(p){let m;for(m=this._previousItHead;null!==m;m=m._nextPrevious)p(m)}forEachAddedItem(p){let m;for(m=this._additionsHead;null!==m;m=m._nextAdded)p(m)}forEachMovedItem(p){let m;for(m=this._movesHead;null!==m;m=m._nextMoved)p(m)}forEachRemovedItem(p){let m;for(m=this._removalsHead;null!==m;m=m._nextRemoved)p(m)}forEachIdentityChange(p){let m;for(m=this._identityChangesHead;null!==m;m=m._nextIdentityChange)p(m)}diff(p){if(null==p&&(p=[]),!ah(p))throw new Je(900,!1);return this.check(p)?this:null}onDestroy(){}check(p){this._reset();let D,L,H,m=this._itHead,x=!1;if(Array.isArray(p)){this.length=p.length;for(let q=0;q<this.length;q++)L=p[q],H=this._trackByFn(q,L),null!==m&&Object.is(m.trackById,H)?(x&&(m=this._verifyReinsertion(m,L,H,q)),Object.is(m.item,L)||this._addIdentityChange(m,L)):(m=this._mismatch(m,L,H,q),x=!0),m=m._next}else D=0,function FE(d,p){if(Array.isArray(d))for(let m=0;m<d.length;m++)p(d[m]);else{const m=d[sh()]();let x;for(;!(x=m.next()).done;)p(x.value)}}(p,q=>{H=this._trackByFn(D,q),null!==m&&Object.is(m.trackById,H)?(x&&(m=this._verifyReinsertion(m,q,H,D)),Object.is(m.item,q)||this._addIdentityChange(m,q)):(m=this._mismatch(m,q,H,D),x=!0),m=m._next,D++}),this.length=D;return this._truncate(m),this.collection=p,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let p;for(p=this._previousItHead=this._itHead;null!==p;p=p._next)p._nextPrevious=p._next;for(p=this._additionsHead;null!==p;p=p._nextAdded)p.previousIndex=p.currentIndex;for(this._additionsHead=this._additionsTail=null,p=this._movesHead;null!==p;p=p._nextMoved)p.previousIndex=p.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(p,m,x,D){let L;return null===p?L=this._itTail:(L=p._prev,this._remove(p)),null!==(p=null===this._unlinkedRecords?null:this._unlinkedRecords.get(x,null))?(Object.is(p.item,m)||this._addIdentityChange(p,m),this._reinsertAfter(p,L,D)):null!==(p=null===this._linkedRecords?null:this._linkedRecords.get(x,D))?(Object.is(p.item,m)||this._addIdentityChange(p,m),this._moveAfter(p,L,D)):p=this._addAfter(new Cv(m,x),L,D),p}_verifyReinsertion(p,m,x,D){let L=null===this._unlinkedRecords?null:this._unlinkedRecords.get(x,null);return null!==L?p=this._reinsertAfter(L,p._prev,D):p.currentIndex!=D&&(p.currentIndex=D,this._addToMoves(p,D)),p}_truncate(p){for(;null!==p;){const m=p._next;this._addToRemovals(this._unlink(p)),p=m}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(p,m,x){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(p);const D=p._prevRemoved,L=p._nextRemoved;return null===D?this._removalsHead=L:D._nextRemoved=L,null===L?this._removalsTail=D:L._prevRemoved=D,this._insertAfter(p,m,x),this._addToMoves(p,x),p}_moveAfter(p,m,x){return this._unlink(p),this._insertAfter(p,m,x),this._addToMoves(p,x),p}_addAfter(p,m,x){return this._insertAfter(p,m,x),this._additionsTail=null===this._additionsTail?this._additionsHead=p:this._additionsTail._nextAdded=p,p}_insertAfter(p,m,x){const D=null===m?this._itHead:m._next;return p._next=D,p._prev=m,null===D?this._itTail=p:D._prev=p,null===m?this._itHead=p:m._next=p,null===this._linkedRecords&&(this._linkedRecords=new UA),this._linkedRecords.put(p),p.currentIndex=x,p}_remove(p){return this._addToRemovals(this._unlink(p))}_unlink(p){null!==this._linkedRecords&&this._linkedRecords.remove(p);const m=p._prev,x=p._next;return null===m?this._itHead=x:m._next=x,null===x?this._itTail=m:x._prev=m,p}_addToMoves(p,m){return p.previousIndex===m||(this._movesTail=null===this._movesTail?this._movesHead=p:this._movesTail._nextMoved=p),p}_addToRemovals(p){return null===this._unlinkedRecords&&(this._unlinkedRecords=new UA),this._unlinkedRecords.put(p),p.currentIndex=null,p._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=p,p._prevRemoved=null):(p._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=p),p}_addIdentityChange(p,m){return p.item=m,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=p:this._identityChangesTail._nextIdentityChange=p,p}}class Cv{constructor(p,m){this.item=p,this.trackById=m,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class JR{constructor(){this._head=null,this._tail=null}add(p){null===this._head?(this._head=this._tail=p,p._nextDup=null,p._prevDup=null):(this._tail._nextDup=p,p._prevDup=this._tail,p._nextDup=null,this._tail=p)}get(p,m){let x;for(x=this._head;null!==x;x=x._nextDup)if((null===m||m<=x.currentIndex)&&Object.is(x.trackById,p))return x;return null}remove(p){const m=p._prevDup,x=p._nextDup;return null===m?this._head=x:m._nextDup=x,null===x?this._tail=m:x._prevDup=m,null===this._head}}class UA{constructor(){this.map=new Map}put(p){const m=p.trackById;let x=this.map.get(m);x||(x=new JR,this.map.set(m,x)),x.add(p)}get(p,m){const D=this.map.get(p);return D?D.get(p,m):null}remove(p){const m=p.trackById;return this.map.get(m).remove(p)&&this.map.delete(m),p}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function C1(d,p,m){const x=d.previousIndex;if(null===x)return x;let D=0;return m&&x<m.length&&(D=m[x]),x+p+D}class HA{constructor(){}supports(p){return p instanceof Map||nf(p)}create(){return new QR}}class QR{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(p){let m;for(m=this._mapHead;null!==m;m=m._next)p(m)}forEachPreviousItem(p){let m;for(m=this._previousMapHead;null!==m;m=m._nextPrevious)p(m)}forEachChangedItem(p){let m;for(m=this._changesHead;null!==m;m=m._nextChanged)p(m)}forEachAddedItem(p){let m;for(m=this._additionsHead;null!==m;m=m._nextAdded)p(m)}forEachRemovedItem(p){let m;for(m=this._removalsHead;null!==m;m=m._nextRemoved)p(m)}diff(p){if(p){if(!(p instanceof Map||nf(p)))throw new Je(900,!1)}else p=new Map;return this.check(p)?this:null}onDestroy(){}check(p){this._reset();let m=this._mapHead;if(this._appendAfter=null,this._forEach(p,(x,D)=>{if(m&&m.key===D)this._maybeAddToChanges(m,x),this._appendAfter=m,m=m._next;else{const L=this._getOrCreateRecordForKey(D,x);m=this._insertBeforeOrAppend(m,L)}}),m){m._prev&&(m._prev._next=null),this._removalsHead=m;for(let x=m;null!==x;x=x._nextRemoved)x===this._mapHead&&(this._mapHead=null),this._records.delete(x.key),x._nextRemoved=x._next,x.previousValue=x.currentValue,x.currentValue=null,x._prev=null,x._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(p,m){if(p){const x=p._prev;return m._next=p,m._prev=x,p._prev=m,x&&(x._next=m),p===this._mapHead&&(this._mapHead=m),this._appendAfter=p,p}return this._appendAfter?(this._appendAfter._next=m,m._prev=this._appendAfter):this._mapHead=m,this._appendAfter=m,null}_getOrCreateRecordForKey(p,m){if(this._records.has(p)){const D=this._records.get(p);this._maybeAddToChanges(D,m);const L=D._prev,H=D._next;return L&&(L._next=H),H&&(H._prev=L),D._next=null,D._prev=null,D}const x=new jA(p);return this._records.set(p,x),x.currentValue=m,this._addToAdditions(x),x}_reset(){if(this.isDirty){let p;for(this._previousMapHead=this._mapHead,p=this._previousMapHead;null!==p;p=p._next)p._nextPrevious=p._next;for(p=this._changesHead;null!==p;p=p._nextChanged)p.previousValue=p.currentValue;for(p=this._additionsHead;null!=p;p=p._nextAdded)p.previousValue=p.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(p,m){Object.is(m,p.currentValue)||(p.previousValue=p.currentValue,p.currentValue=m,this._addToChanges(p))}_addToAdditions(p){null===this._additionsHead?this._additionsHead=this._additionsTail=p:(this._additionsTail._nextAdded=p,this._additionsTail=p)}_addToChanges(p){null===this._changesHead?this._changesHead=this._changesTail=p:(this._changesTail._nextChanged=p,this._changesTail=p)}_forEach(p,m){p instanceof Map?p.forEach(m):Object.keys(p).forEach(x=>m(p[x],x))}}class jA{constructor(p){this.key=p,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function GA(){return new Ev([new hh])}let Ev=(()=>{class d{constructor(m){this.factories=m}static create(m,x){if(null!=x){const D=x.factories.slice();m=m.concat(D)}return new d(m)}static extend(m){return{provide:d,useFactory:x=>d.create(m,x||GA()),deps:[[d,new te,new G]]}}find(m){const x=this.factories.find(D=>D.supports(m));if(null!=x)return x;throw new Je(901,!1)}}return d.\u0275prov=bi({token:d,providedIn:"root",factory:GA}),d})();function HT(){return new Ha([new HA])}let Ha=(()=>{class d{constructor(m){this.factories=m}static create(m,x){if(x){const D=x.factories.slice();m=m.concat(D)}return new d(m)}static extend(m){return{provide:d,useFactory:x=>d.create(m,x||HT()),deps:[[d,new te,new G]]}}find(m){const x=this.factories.find(D=>D.supports(m));if(x)return x;throw new Je(901,!1)}}return d.\u0275prov=bi({token:d,providedIn:"root",factory:HT}),d})();const kn=bv(null,"core",[]);let Aa=(()=>{class d{constructor(m){}}return d.\u0275fac=function(m){return new(m||d)(En(_1))},d.\u0275mod=di({type:d}),d.\u0275inj=Vo({}),d})();function $_(d){return"boolean"==typeof d?d:null!=d&&"false"!==d}},3942:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{Z:()=>ln});var pe=Ee(2090),o=Ee(4859),xe=Ee(9681),ct=Ee(1877);class Ct{constructor(Je,dt){this._delegate=Je,this.firebase=dt,(0,xe._addComponent)(Je,new o.wA("app-compat",()=>this,"PUBLIC")),this.container=Je.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Je){this._delegate.automaticDataCollectionEnabled=Je}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(Je=>{this._delegate.checkDestroyed(),Je()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,xe.deleteApp)(this._delegate)))}_getService(Je,dt=xe._DEFAULT_ENTRY_NAME){var Ot;this._delegate.checkDestroyed();const Jt=this._delegate.container.getProvider(Je);return!Jt.isInitialized()&&"EXPLICIT"===(null===(Ot=Jt.getComponent())||void 0===Ot?void 0:Ot.instantiationMode)&&Jt.initialize(),Jt.getImmediate({identifier:dt})}_removeServiceInstance(Je,dt=xe._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(Je).clearInstance(dt)}_addComponent(Je){(0,xe._addComponent)(this._delegate,Je)}_addOrOverwriteComponent(Je){(0,xe._addOrOverwriteComponent)(this._delegate,Je)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const y=new pe.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),qe=function ht(){const Ze=function ze(Ze){const Je={},dt={__esModule:!0,initializeApp:function st(it,zt={}){const en=xe.initializeApp(it,zt);if((0,pe.r3)(Je,en.name))return Je[en.name];const gt=new Ze(en,dt);return Je[en.name]=gt,gt},app:Jt,registerVersion:xe.registerVersion,setLogLevel:xe.setLogLevel,onLog:xe.onLog,apps:null,SDK_VERSION:xe.SDK_VERSION,INTERNAL:{registerComponent:function nn(it){const zt=it.name,en=zt.replace("-compat","");if(xe._registerComponent(it)&&"PUBLIC"===it.type){const gt=(xt=Jt())=>{if("function"!=typeof xt[en])throw y.create("invalid-app-argument",{appName:zt});return xt[en]()};void 0!==it.serviceProps&&(0,pe.ZB)(gt,it.serviceProps),dt[en]=gt,Ze.prototype[en]=function(...xt){return this._getService.bind(this,zt).apply(this,it.multipleInstances?xt:[])}}return"PUBLIC"===it.type?dt[en]:null},removeApp:function Ot(it){delete Je[it]},useAsService:function yn(it,zt){return"serverAuth"===zt?null:zt},modularAPIs:xe}};function Jt(it){if(!(0,pe.r3)(Je,it=it||xe._DEFAULT_ENTRY_NAME))throw y.create("no-app",{appName:it});return Je[it]}return dt.default=dt,Object.defineProperty(dt,"apps",{get:function Zt(){return Object.keys(Je).map(it=>Je[it])}}),Jt.App=Ze,dt}(Ct);return Ze.INTERNAL=Object.assign(Object.assign({},Ze.INTERNAL),{createFirebaseNamespace:ht,extendNamespace:function Je(dt){(0,pe.ZB)(Ze,dt)},createSubscribe:pe.ne,ErrorFactory:pe.LL,deepExtend:pe.ZB}),Ze}(),Ne=new ct.Yd("@firebase/app-compat");if((0,pe.jU)()&&void 0!==self.firebase){Ne.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Ze=self.firebase.SDK_VERSION;Ze&&Ze.indexOf("LITE")>=0&&Ne.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const ln=qe;!function ft(Ze){(0,xe.registerVersion)("@firebase/app-compat","0.2.3",Ze)}()},9681:(bt,vt,Ee)=>{"use strict";Ee.r(vt),Ee.d(vt,{FirebaseError:()=>ct.ZR,SDK_VERSION:()=>ys,_DEFAULT_ENTRY_NAME:()=>Ni,_addComponent:()=>or,_addOrOverwriteComponent:()=>Bo,_apps:()=>zi,_clearComponents:()=>Vo,_components:()=>ri,_getProvider:()=>bi,_registerComponent:()=>$i,_removeServiceInstance:()=>Gr,deleteApp:()=>Gs,getApp:()=>Rr,getApps:()=>Xo,initializeApp:()=>qi,onLog:()=>jn,registerVersion:()=>Pr,setLogLevel:()=>Uo});var pe=Ee(5861),o=Ee(4859),xe=Ee(1877),ct=Ee(2090),Ct=Ee(8766);class Ht{constructor(rn){this.container=rn}getPlatformInfoString(){return this.container.getProviders().map(zn=>{if(function y(En){return"VERSION"===En.getComponent()?.type}(zn)){const wi=zn.getImmediate();return`${wi.library}/${wi.version}`}return null}).filter(zn=>zn).join(" ")}}const ze="@firebase/app",qe=new xe.Yd("@firebase/app"),Ni="[DEFAULT]",vi={[ze]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},zi=new Map,ri=new Map;function or(En,rn){try{En.container.addComponent(rn)}catch(zn){qe.debug(`Component ${rn.name} failed to register with FirebaseApp ${En.name}`,zn)}}function Bo(En,rn){En.container.addOrOverwriteComponent(rn)}function $i(En){const rn=En.name;if(ri.has(rn))return qe.debug(`There were multiple attempts to register component ${rn}.`),!1;ri.set(rn,En);for(const zn of zi.values())or(zn,En);return!0}function bi(En,rn){const zn=En.container.getProvider("heartbeat").getImmediate({optional:!0});return zn&&zn.triggerHeartbeat(),En.container.getProvider(rn)}function Gr(En,rn,zn=Ni){bi(En,rn).clearInstance(zn)}function Vo(){ri.clear()}const fo=new ct.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Ar{constructor(rn,zn,wi){this._isDeleted=!1,this._options=Object.assign({},rn),this._config=Object.assign({},zn),this._name=zn.name,this._automaticDataCollectionEnabled=zn.automaticDataCollectionEnabled,this._container=wi,this.container.addComponent(new o.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(rn){this.checkDestroyed(),this._automaticDataCollectionEnabled=rn}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(rn){this._isDeleted=rn}checkDestroyed(){if(this.isDeleted)throw fo.create("app-deleted",{appName:this._name})}}const ys="9.17.1";function qi(En,rn={}){let zn=En;"object"!=typeof rn&&(rn={name:rn});const wi=Object.assign({name:Ni,automaticDataCollectionEnabled:!1},rn),Di=wi.name;if("string"!=typeof Di||!Di)throw fo.create("bad-app-name",{appName:String(Di)});if(zn||(zn=(0,ct.aH)()),!zn)throw fo.create("no-options");const er=zi.get(Di);if(er){if((0,ct.vZ)(zn,er.options)&&(0,ct.vZ)(wi,er.config))return er;throw fo.create("duplicate-app",{appName:Di})}const Qe=new o.H0(Di);for(const at of ri.values())Qe.addComponent(at);const je=new Ar(zn,wi,Qe);return zi.set(Di,je),je}function Rr(En=Ni){const rn=zi.get(En);if(!rn&&En===Ni)return qi();if(!rn)throw fo.create("no-app",{appName:En});return rn}function Xo(){return Array.from(zi.values())}function Gs(En){return Ao.apply(this,arguments)}function Ao(){return(Ao=(0,pe.Z)(function*(En){const rn=En.name;zi.has(rn)&&(zi.delete(rn),yield Promise.all(En.container.getProviders().map(zn=>zn.delete())),En.isDeleted=!0)})).apply(this,arguments)}function Pr(En,rn,zn){var wi;let Di=null!==(wi=vi[En])&&void 0!==wi?wi:En;zn&&(Di+=`-${zn}`);const er=Di.match(/\s|\//),Qe=rn.match(/\s|\//);if(er||Qe){const je=[`Unable to register library "${Di}" with version "${rn}":`];return er&&je.push(`library name "${Di}" contains illegal characters (whitespace or "/")`),er&&Qe&&je.push("and"),Qe&&je.push(`version name "${rn}" contains illegal characters (whitespace or "/")`),void qe.warn(je.join(" "))}$i(new o.wA(`${Di}-version`,()=>({library:Di,version:rn}),"VERSION"))}function jn(En,rn){if(null!==En&&"function"!=typeof En)throw fo.create("invalid-log-argument");(0,xe.Am)(En,rn)}function Uo(En){(0,xe.Ub)(En)}const es="firebase-heartbeat-store";let Mo=null;function wr(){return Mo||(Mo=(0,Ct.X3)("firebase-heartbeat-database",1,{upgrade:(En,rn)=>{0===rn&&En.createObjectStore(es)}}).catch(En=>{throw fo.create("idb-open",{originalErrorMessage:En.message})})),Mo}function ui(){return(ui=(0,pe.Z)(function*(En){try{return(yield wr()).transaction(es).objectStore(es).get(Ur(En))}catch(rn){if(rn instanceof ct.ZR)qe.warn(rn.message);else{const zn=fo.create("idb-get",{originalErrorMessage:rn?.message});qe.warn(zn.message)}}})).apply(this,arguments)}function Wn(En,rn){return ts.apply(this,arguments)}function ts(){return(ts=(0,pe.Z)(function*(En,rn){try{const wi=(yield wr()).transaction(es,"readwrite");return yield wi.objectStore(es).put(rn,Ur(En)),wi.done}catch(zn){if(zn instanceof ct.ZR)qe.warn(zn.message);else{const wi=fo.create("idb-set",{originalErrorMessage:zn?.message});qe.warn(wi.message)}}})).apply(this,arguments)}function Ur(En){return`${En.name}!${En.options.appId}`}class Jr{constructor(rn){this.container=rn,this._heartbeatsCache=null;const zn=this.container.getProvider("app").getImmediate();this._storage=new cs(zn),this._heartbeatsCachePromise=this._storage.read().then(wi=>(this._heartbeatsCache=wi,wi))}triggerHeartbeat(){var rn=this;return(0,pe.Z)(function*(){const wi=rn.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),Di=co();if(null===rn._heartbeatsCache&&(rn._heartbeatsCache=yield rn._heartbeatsCachePromise),rn._heartbeatsCache.lastSentHeartbeatDate!==Di&&!rn._heartbeatsCache.heartbeats.some(er=>er.date===Di))return rn._heartbeatsCache.heartbeats.push({date:Di,agent:wi}),rn._heartbeatsCache.heartbeats=rn._heartbeatsCache.heartbeats.filter(er=>{const Qe=new Date(er.date).valueOf();return Date.now()-Qe<=2592e6}),rn._storage.overwrite(rn._heartbeatsCache)})()}getHeartbeatsHeader(){var rn=this;return(0,pe.Z)(function*(){if(null===rn._heartbeatsCache&&(yield rn._heartbeatsCachePromise),null===rn._heartbeatsCache||0===rn._heartbeatsCache.heartbeats.length)return"";const zn=co(),{heartbeatsToSend:wi,unsentEntries:Di}=function mr(En,rn=1024){const zn=[];let wi=En.slice();for(const Di of En){const er=zn.find(Qe=>Qe.agent===Di.agent);if(er){if(er.dates.push(Di.date),Bi(zn)>rn){er.dates.pop();break}}else if(zn.push({agent:Di.agent,dates:[Di.date]}),Bi(zn)>rn){zn.pop();break}wi=wi.slice(1)}return{heartbeatsToSend:zn,unsentEntries:wi}}(rn._heartbeatsCache.heartbeats),er=(0,ct.L)(JSON.stringify({version:2,heartbeats:wi}));return rn._heartbeatsCache.lastSentHeartbeatDate=zn,Di.length>0?(rn._heartbeatsCache.heartbeats=Di,yield rn._storage.overwrite(rn._heartbeatsCache)):(rn._heartbeatsCache.heartbeats=[],rn._storage.overwrite(rn._heartbeatsCache)),er})()}}function co(){return(new Date).toISOString().substring(0,10)}class cs{constructor(rn){this.app=rn,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,pe.Z)(function*(){return!!(0,ct.hl)()&&(0,ct.eu)().then(()=>!0).catch(()=>!1)})()}read(){var rn=this;return(0,pe.Z)(function*(){return(yield rn._canUseIndexedDBPromise)&&(yield function yr(En){return ui.apply(this,arguments)}(rn.app))||{heartbeats:[]}})()}overwrite(rn){var zn=this;return(0,pe.Z)(function*(){var wi;if(yield zn._canUseIndexedDBPromise){const er=yield zn.read();return Wn(zn.app,{lastSentHeartbeatDate:null!==(wi=rn.lastSentHeartbeatDate)&&void 0!==wi?wi:er.lastSentHeartbeatDate,heartbeats:rn.heartbeats})}})()}add(rn){var zn=this;return(0,pe.Z)(function*(){var wi;if(yield zn._canUseIndexedDBPromise){const er=yield zn.read();return Wn(zn.app,{lastSentHeartbeatDate:null!==(wi=rn.lastSentHeartbeatDate)&&void 0!==wi?wi:er.lastSentHeartbeatDate,heartbeats:[...er.heartbeats,...rn.heartbeats]})}})()}}function Bi(En){return(0,ct.L)(JSON.stringify({version:2,heartbeats:En})).length}!function qo(En){$i(new o.wA("platform-logger",rn=>new Ht(rn),"PRIVATE")),$i(new o.wA("heartbeat",rn=>new Jr(rn),"PRIVATE")),Pr(ze,"0.9.3",En),Pr(ze,"0.9.3","esm2017"),Pr("fire-js","")}("")},4859:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{H0:()=>ze,wA:()=>xe});var pe=Ee(5861),o=Ee(2090);class xe{constructor(qe,Ne,nt){this.name=qe,this.instanceFactory=Ne,this.type=nt,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(qe){return this.instantiationMode=qe,this}setMultipleInstances(qe){return this.multipleInstances=qe,this}setServiceProps(qe){return this.serviceProps=qe,this}setInstanceCreatedCallback(qe){return this.onInstanceCreated=qe,this}}const ct="[DEFAULT]";class Ct{constructor(qe,Ne){this.name=qe,this.container=Ne,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(qe){const Ne=this.normalizeInstanceIdentifier(qe);if(!this.instancesDeferred.has(Ne)){const nt=new o.BH;if(this.instancesDeferred.set(Ne,nt),this.isInitialized(Ne)||this.shouldAutoInitialize())try{const fn=this.getOrInitializeService({instanceIdentifier:Ne});fn&&nt.resolve(fn)}catch{}}return this.instancesDeferred.get(Ne).promise}getImmediate(qe){var Ne;const nt=this.normalizeInstanceIdentifier(qe?.identifier),fn=null!==(Ne=qe?.optional)&&void 0!==Ne&&Ne;if(!this.isInitialized(nt)&&!this.shouldAutoInitialize()){if(fn)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:nt})}catch(ft){if(fn)return null;throw ft}}getComponent(){return this.component}setComponent(qe){if(qe.name!==this.name)throw Error(`Mismatching Component ${qe.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=qe,this.shouldAutoInitialize()){if(function y(ht){return"EAGER"===ht.instantiationMode}(qe))try{this.getOrInitializeService({instanceIdentifier:ct})}catch{}for(const[Ne,nt]of this.instancesDeferred.entries()){const fn=this.normalizeInstanceIdentifier(Ne);try{const ft=this.getOrInitializeService({instanceIdentifier:fn});nt.resolve(ft)}catch{}}}}clearInstance(qe=ct){this.instancesDeferred.delete(qe),this.instancesOptions.delete(qe),this.instances.delete(qe)}delete(){var qe=this;return(0,pe.Z)(function*(){const Ne=Array.from(qe.instances.values());yield Promise.all([...Ne.filter(nt=>"INTERNAL"in nt).map(nt=>nt.INTERNAL.delete()),...Ne.filter(nt=>"_delete"in nt).map(nt=>nt._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(qe=ct){return this.instances.has(qe)}getOptions(qe=ct){return this.instancesOptions.get(qe)||{}}initialize(qe={}){const{options:Ne={}}=qe,nt=this.normalizeInstanceIdentifier(qe.instanceIdentifier);if(this.isInitialized(nt))throw Error(`${this.name}(${nt}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const fn=this.getOrInitializeService({instanceIdentifier:nt,options:Ne});for(const[ft,ln]of this.instancesDeferred.entries())nt===this.normalizeInstanceIdentifier(ft)&&ln.resolve(fn);return fn}onInit(qe,Ne){var nt;const fn=this.normalizeInstanceIdentifier(Ne),ft=null!==(nt=this.onInitCallbacks.get(fn))&&void 0!==nt?nt:new Set;ft.add(qe),this.onInitCallbacks.set(fn,ft);const ln=this.instances.get(fn);return ln&&qe(ln,fn),()=>{ft.delete(qe)}}invokeOnInitCallbacks(qe,Ne){const nt=this.onInitCallbacks.get(Ne);if(nt)for(const fn of nt)try{fn(qe,Ne)}catch{}}getOrInitializeService({instanceIdentifier:qe,options:Ne={}}){let nt=this.instances.get(qe);if(!nt&&this.component&&(nt=this.component.instanceFactory(this.container,{instanceIdentifier:(ht=qe,ht===ct?void 0:ht),options:Ne}),this.instances.set(qe,nt),this.instancesOptions.set(qe,Ne),this.invokeOnInitCallbacks(nt,qe),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,qe,nt)}catch{}var ht;return nt||null}normalizeInstanceIdentifier(qe=ct){return this.component?this.component.multipleInstances?qe:ct:qe}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class ze{constructor(qe){this.name=qe,this.providers=new Map}addComponent(qe){const Ne=this.getProvider(qe.name);if(Ne.isComponentSet())throw new Error(`Component ${qe.name} has already been registered with ${this.name}`);Ne.setComponent(qe)}addOrOverwriteComponent(qe){this.getProvider(qe.name).isComponentSet()&&this.providers.delete(qe.name),this.addComponent(qe)}getProvider(qe){if(this.providers.has(qe))return this.providers.get(qe);const Ne=new Ct(qe,this);return this.providers.set(qe,Ne),Ne}getProviders(){return Array.from(this.providers.values())}}},1877:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{Am:()=>ht,Ub:()=>ze,Yd:()=>y,in:()=>o});const pe=[];var o=(()=>{return(qe=o||(o={}))[qe.DEBUG=0]="DEBUG",qe[qe.VERBOSE=1]="VERBOSE",qe[qe.INFO=2]="INFO",qe[qe.WARN=3]="WARN",qe[qe.ERROR=4]="ERROR",qe[qe.SILENT=5]="SILENT",o;var qe})();const xe={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},ct=o.INFO,Ct={[o.DEBUG]:"log",[o.VERBOSE]:"log",[o.INFO]:"info",[o.WARN]:"warn",[o.ERROR]:"error"},Ht=(qe,Ne,...nt)=>{if(Ne<qe.logLevel)return;const fn=(new Date).toISOString(),ft=Ct[Ne];if(!ft)throw new Error(`Attempted to log a message with an invalid logType (value: ${Ne})`);console[ft](`[${fn}]  ${qe.name}:`,...nt)};class y{constructor(Ne){this.name=Ne,this._logLevel=ct,this._logHandler=Ht,this._userLogHandler=null,pe.push(this)}get logLevel(){return this._logLevel}set logLevel(Ne){if(!(Ne in o))throw new TypeError(`Invalid value "${Ne}" assigned to \`logLevel\``);this._logLevel=Ne}setLogLevel(Ne){this._logLevel="string"==typeof Ne?xe[Ne]:Ne}get logHandler(){return this._logHandler}set logHandler(Ne){if("function"!=typeof Ne)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=Ne}get userLogHandler(){return this._userLogHandler}set userLogHandler(Ne){this._userLogHandler=Ne}debug(...Ne){this._userLogHandler&&this._userLogHandler(this,o.DEBUG,...Ne),this._logHandler(this,o.DEBUG,...Ne)}log(...Ne){this._userLogHandler&&this._userLogHandler(this,o.VERBOSE,...Ne),this._logHandler(this,o.VERBOSE,...Ne)}info(...Ne){this._userLogHandler&&this._userLogHandler(this,o.INFO,...Ne),this._logHandler(this,o.INFO,...Ne)}warn(...Ne){this._userLogHandler&&this._userLogHandler(this,o.WARN,...Ne),this._logHandler(this,o.WARN,...Ne)}error(...Ne){this._userLogHandler&&this._userLogHandler(this,o.ERROR,...Ne),this._logHandler(this,o.ERROR,...Ne)}}function ze(qe){pe.forEach(Ne=>{Ne.setLogLevel(qe)})}function ht(qe,Ne){for(const nt of pe){let fn=null;Ne&&Ne.level&&(fn=xe[Ne.level]),nt.userLogHandler=null===qe?null:(ft,ln,...Ze)=>{const Je=Ze.map(dt=>{if(null==dt)return null;if("string"==typeof dt)return dt;if("number"==typeof dt||"boolean"==typeof dt)return dt.toString();if(dt instanceof Error)return dt.message;try{return JSON.stringify(dt)}catch{return null}}).filter(dt=>dt).join(" ");ln>=(fn??ft.logLevel)&&qe({level:o[ln].toLowerCase(),message:Je,args:Ze,type:ft.name})}}}},259:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{C6:()=>pe.getApps,KN:()=>pe.registerVersion,Mq:()=>pe.getApp,ZF:()=>pe.initializeApp});var pe=Ee(9681);(0,pe.registerVersion)("firebase","9.17.1","app")},9260:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{Z:()=>pe.Z});var pe=Ee(3942);pe.Z.registerVersion("firebase","9.17.1","app-compat")},9568:(bt,vt,Ee)=>{"use strict";Ee.r(vt);var pe=Ee(5861),o=Ee(3942),xe=Ee(2722),ct=Ee(2090),y=(Ee(9681),Ee(1877),Ee(4859));function ze(){return window}function Ne(){return(Ne=(0,pe.Z)(function*(Ue,Ce,re){var ie;const{BuildInfo:ae}=ze();(0,xe.ap)(Ce.sessionId,"AuthEvent did not contain a session ID");const we=yield dt(Ce.sessionId),De={};return(0,xe.aq)()?De.ibi=ae.packageName:(0,xe.ar)()?De.apn=ae.packageName:(0,xe.as)(Ue,"operation-not-supported-in-this-environment"),ae.displayName&&(De.appDisplayName=ae.displayName),De.sessionId=we,(0,xe.at)(Ue,re,Ce.type,void 0,null!==(ie=Ce.eventId)&&void 0!==ie?ie:void 0,De)})).apply(this,arguments)}function fn(){return(fn=(0,pe.Z)(function*(Ue){const{BuildInfo:Ce}=ze(),re={};(0,xe.aq)()?re.iosBundleId=Ce.packageName:(0,xe.ar)()?re.androidPackageName=Ce.packageName:(0,xe.as)(Ue,"operation-not-supported-in-this-environment"),yield(0,xe.au)(Ue,re)})).apply(this,arguments)}function Ze(){return(Ze=(0,pe.Z)(function*(Ue,Ce,re){const{cordova:ie}=ze();let ae=()=>{};try{yield new Promise((we,De)=>{let Ve=null;function Ke(){var rt;we();const $t=null===(rt=ie.plugins.browsertab)||void 0===rt?void 0:rt.close;"function"==typeof $t&&$t(),"function"==typeof re?.close&&re.close()}function ot(){Ve||(Ve=window.setTimeout(()=>{De((0,xe.aw)(Ue,"redirect-cancelled-by-user"))},2e3))}function tt(){"visible"===document?.visibilityState&&ot()}Ce.addPassiveListener(Ke),document.addEventListener("resume",ot,!1),(0,xe.ar)()&&document.addEventListener("visibilitychange",tt,!1),ae=()=>{Ce.removePassiveListener(Ke),document.removeEventListener("resume",ot,!1),document.removeEventListener("visibilitychange",tt,!1),Ve&&window.clearTimeout(Ve)}})}finally{ae()}})).apply(this,arguments)}function dt(Ue){return Ot.apply(this,arguments)}function Ot(){return(Ot=(0,pe.Z)(function*(Ue){const Ce=Jt(Ue),re=yield crypto.subtle.digest("SHA-256",Ce);return Array.from(new Uint8Array(re)).map(ae=>ae.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function Jt(Ue){if((0,xe.ap)(/[0-9a-zA-Z]+/.test(Ue),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(Ue);const Ce=new ArrayBuffer(Ue.length),re=new Uint8Array(Ce);for(let ie=0;ie<Ue.length;ie++)re[ie]=Ue.charCodeAt(ie);return re}class Zt extends xe.ay{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(Ce=>{this.resolveInialized=Ce})}addPassiveListener(Ce){this.passiveListeners.add(Ce)}removePassiveListener(Ce){this.passiveListeners.delete(Ce)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(Ce){return this.resolveInialized(),this.passiveListeners.forEach(re=>re(Ce)),super.onEvent(Ce)}initialized(){var Ce=this;return(0,pe.Z)(function*(){yield Ce.initPromise})()}}function it(Ue){return zt.apply(this,arguments)}function zt(){return(zt=(0,pe.Z)(function*(Ue){const Ce=yield xt()._get(Lt(Ue));return Ce&&(yield xt()._remove(Lt(Ue))),Ce})).apply(this,arguments)}function gt(){const Ue=[],Ce="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let re=0;re<20;re++){const ie=Math.floor(Math.random()*Ce.length);Ue.push(Ce.charAt(ie))}return Ue.join("")}function xt(){return(0,xe.az)(xe.b)}function Lt(Ue){return(0,xe.aA)("authEvent",Ue.config.apiKey,Ue.name)}function wn(Ue){if(!Ue?.includes("?"))return{};const[Ce,...re]=Ue.split("?");return(0,ct.zd)(re.join("?"))}const Ni=class ir{constructor(){this._redirectPersistence=xe.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=xe.aB,this._overrideRedirectResult=xe.aC}_initialize(Ce){var re=this;return(0,pe.Z)(function*(){const ie=Ce._key();let ae=re.eventManagers.get(ie);return ae||(ae=new Zt(Ce),re.eventManagers.set(ie,ae),re.attachCallbackListeners(Ce,ae)),ae})()}_openPopup(Ce){(0,xe.as)(Ce,"operation-not-supported-in-this-environment")}_openRedirect(Ce,re,ie,ae){var we=this;return(0,pe.Z)(function*(){!function Je(Ue){var Ce,re,ie,ae,we,De,Ve,Ke,ot,tt;const rt=ze();(0,xe.ax)("function"==typeof(null===(Ce=rt?.universalLinks)||void 0===Ce?void 0:Ce.subscribe),Ue,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,xe.ax)(typeof(null===(re=rt?.BuildInfo)||void 0===re?void 0:re.packageName)<"u",Ue,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,xe.ax)("function"==typeof(null===(we=null===(ae=null===(ie=rt?.cordova)||void 0===ie?void 0:ie.plugins)||void 0===ae?void 0:ae.browsertab)||void 0===we?void 0:we.openUrl),Ue,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,xe.ax)("function"==typeof(null===(Ke=null===(Ve=null===(De=rt?.cordova)||void 0===De?void 0:De.plugins)||void 0===Ve?void 0:Ve.browsertab)||void 0===Ke?void 0:Ke.isAvailable),Ue,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,xe.ax)("function"==typeof(null===(tt=null===(ot=rt?.cordova)||void 0===ot?void 0:ot.InAppBrowser)||void 0===tt?void 0:tt.open),Ue,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(Ce);const De=yield we._initialize(Ce);yield De.initialized(),De.resetRedirect(),(0,xe.aD)(),yield we._originValidation(Ce);const Ve=function nn(Ue,Ce,re=null){return{type:Ce,eventId:re,urlResponse:null,sessionId:gt(),postBody:null,tenantId:Ue.tenantId,error:(0,xe.aw)(Ue,"no-auth-event")}}(Ce,ie,ae);yield function yn(Ue,Ce){return xt()._set(Lt(Ue),Ce)}(Ce,Ve);const Ke=yield function qe(Ue,Ce,re){return Ne.apply(this,arguments)}(Ce,Ve,re),ot=yield function ft(Ue){const{cordova:Ce}=ze();return new Promise(re=>{Ce.plugins.browsertab.isAvailable(ie=>{let ae=null;ie?Ce.plugins.browsertab.openUrl(Ue):ae=Ce.InAppBrowser.open(Ue,(0,xe.av)()?"_blank":"_system","location=yes"),re(ae)})})}(Ke);return function ln(Ue,Ce,re){return Ze.apply(this,arguments)}(Ce,De,ot)})()}_isIframeWebStorageSupported(Ce,re){throw new Error("Method not implemented.")}_originValidation(Ce){const re=Ce._key();return this.originValidationPromises[re]||(this.originValidationPromises[re]=function nt(Ue){return fn.apply(this,arguments)}(Ce)),this.originValidationPromises[re]}attachCallbackListeners(Ce,re){const{universalLinks:ie,handleOpenURL:ae,BuildInfo:we}=ze(),De=setTimeout((0,pe.Z)(function*(){yield it(Ce),re.onEvent(vi())}),500),Ve=function(){var tt=(0,pe.Z)(function*(rt){clearTimeout(De);const $t=yield it(Ce);let Dn=null;$t&&rt?.url&&(Dn=function en(Ue,Ce){var re,ie;const ae=function Vt(Ue){const Ce=wn(Ue),re=Ce.link?decodeURIComponent(Ce.link):void 0,ie=wn(re).link,ae=Ce.deep_link_id?decodeURIComponent(Ce.deep_link_id):void 0;return wn(ae).link||ae||ie||re||Ue}(Ce);if(ae.includes("/__/auth/callback")){const we=wn(ae),De=we.firebaseError?function It(Ue){try{return JSON.parse(Ue)}catch{return null}}(decodeURIComponent(we.firebaseError)):null,Ve=null===(ie=null===(re=De?.code)||void 0===re?void 0:re.split("auth/"))||void 0===ie?void 0:ie[1],Ke=Ve?(0,xe.aw)(Ve):null;return Ke?{type:Ue.type,eventId:Ue.eventId,tenantId:Ue.tenantId,error:Ke,urlResponse:null,sessionId:null,postBody:null}:{type:Ue.type,eventId:Ue.eventId,tenantId:Ue.tenantId,sessionId:Ue.sessionId,urlResponse:ae,postBody:null}}return null}($t,rt.url)),re.onEvent(Dn||vi())});return function($t){return tt.apply(this,arguments)}}();typeof ie<"u"&&"function"==typeof ie.subscribe&&ie.subscribe(null,Ve);const Ke=ae,ot=`${we.packageName.toLowerCase()}://`;ze().handleOpenURL=function(){var tt=(0,pe.Z)(function*(rt){if(rt.toLowerCase().startsWith(ot)&&Ve({url:rt}),"function"==typeof Ke)try{Ke(rt)}catch($t){console.error($t)}});return function(rt){return tt.apply(this,arguments)}}()}};function vi(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,xe.aw)("no-auth-event")}}function $i(){var Ue;return(null===(Ue=self?.location)||void 0===Ue?void 0:Ue.protocol)||null}function Gr(Ue=(0,ct.z$)()){return!("file:"!==$i()&&"ionic:"!==$i()&&"capacitor:"!==$i()||!Ue.toLowerCase().match(/iphone|ipad|ipod|android/))}function ys(){try{const Ue=self.localStorage,Ce=xe.aI();if(Ue)return Ue.setItem(Ce,"1"),Ue.removeItem(Ce),!function Ar(Ue=(0,ct.z$)()){return function $r(){return(0,ct.w1)()&&11===document?.documentMode}()||function fo(Ue=(0,ct.z$)()){return/Edge\/\d+/.test(Ue)}(Ue)}()||(0,ct.hl)()}catch{return qi()&&(0,ct.hl)()}return!1}function qi(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Rr(){return(function bi(){return"http:"===$i()||"https:"===$i()}()||(0,ct.ru)()||Gr())&&!function Vo(){return(0,ct.b$)()||(0,ct.UG)()}()&&ys()&&!qi()}function Xo(){return Gr()&&typeof document<"u"}function Ao(){return(Ao=(0,pe.Z)(function*(){return!!Xo()&&new Promise(Ue=>{const Ce=setTimeout(()=>{Ue(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(Ce),Ue(!0)})})})).apply(this,arguments)}const jn={LOCAL:"local",NONE:"none",SESSION:"session"},Uo=xe.ax,lo="persistence";function es(Ue){return Mo.apply(this,arguments)}function Mo(){return(Mo=(0,pe.Z)(function*(Ue){yield Ue._initializationPromise;const Ce=yr(),re=xe.aA(lo,Ue.config.apiKey,Ue.name);Ce&&Ce.setItem(re,Ue._getPersistence())})).apply(this,arguments)}function yr(){var Ue;try{return(null===(Ue=function Pr(){return typeof window<"u"?window:null}())||void 0===Ue?void 0:Ue.sessionStorage)||null}catch{return null}}const ui=xe.ax;class Wn{constructor(){this.browserResolver=xe.az(xe.k),this.cordovaResolver=xe.az(Ni),this.underlyingResolver=null,this._redirectPersistence=xe.a,this._completeRedirectFn=xe.aB,this._overrideRedirectResult=xe.aC}_initialize(Ce){var re=this;return(0,pe.Z)(function*(){return yield re.selectUnderlyingResolver(),re.assertedUnderlyingResolver._initialize(Ce)})()}_openPopup(Ce,re,ie,ae){var we=this;return(0,pe.Z)(function*(){return yield we.selectUnderlyingResolver(),we.assertedUnderlyingResolver._openPopup(Ce,re,ie,ae)})()}_openRedirect(Ce,re,ie,ae){var we=this;return(0,pe.Z)(function*(){return yield we.selectUnderlyingResolver(),we.assertedUnderlyingResolver._openRedirect(Ce,re,ie,ae)})()}_isIframeWebStorageSupported(Ce,re){this.assertedUnderlyingResolver._isIframeWebStorageSupported(Ce,re)}_originValidation(Ce){return this.assertedUnderlyingResolver._originValidation(Ce)}get _shouldInitProactively(){return Xo()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return ui(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var Ce=this;return(0,pe.Z)(function*(){if(Ce.underlyingResolver)return;const re=yield function Gs(){return Ao.apply(this,arguments)}();Ce.underlyingResolver=re?Ce.cordovaResolver:Ce.browserResolver})()}}function ts(Ue){return Ue.unwrap()}function Ho(Ue){return Jr(Ue)}function Jr(Ue){const{_tokenResponse:Ce}=Ue instanceof ct.ZR?Ue.customData:Ue;if(!Ce)return null;if(!(Ue instanceof ct.ZR)&&"temporaryProof"in Ce&&"phoneNumber"in Ce)return xe.P.credentialFromResult(Ue);const re=Ce.providerId;if(!re||re===xe.o.PASSWORD)return null;let ie;switch(re){case xe.o.GOOGLE:ie=xe.Q;break;case xe.o.FACEBOOK:ie=xe.N;break;case xe.o.GITHUB:ie=xe.T;break;case xe.o.TWITTER:ie=xe.W;break;default:const{oauthIdToken:ae,oauthAccessToken:we,oauthTokenSecret:De,pendingToken:Ve,nonce:Ke}=Ce;return we||De||ae||Ve?Ve?re.startsWith("saml.")?xe.aL._create(re,Ve):xe.J._fromParams({providerId:re,signInMethod:re,pendingToken:Ve,idToken:ae,accessToken:we}):new xe.U(re).credential({idToken:ae,accessToken:we,rawNonce:Ke}):null}return Ue instanceof ct.ZR?ie.credentialFromError(Ue):ie.credentialFromResult(Ue)}function co(Ue,Ce){return Ce.catch(re=>{throw re instanceof ct.ZR&&function vs(Ue,Ce){var re;const ie=null===(re=Ce.customData)||void 0===re?void 0:re._tokenResponse;if("auth/multi-factor-auth-required"===Ce?.code)Ce.resolver=new Bi(Ue,xe.an(Ue,Ce));else if(ie){const ae=Jr(Ce),we=Ce;ae&&(we.credential=ae,we.tenantId=ie.tenantId||void 0,we.email=ie.email||void 0,we.phoneNumber=ie.phoneNumber||void 0)}}(Ue,re),re}).then(re=>{const ae=re.user;return{operationType:re.operationType,credential:Ho(re),additionalUserInfo:xe.al(re),user:qo.getOrCreate(ae)}})}function mr(Ue,Ce){return cs.apply(this,arguments)}function cs(){return(cs=(0,pe.Z)(function*(Ue,Ce){const re=yield Ce;return{verificationId:re.verificationId,confirm:ie=>co(Ue,re.confirm(ie))}})).apply(this,arguments)}class Bi{constructor(Ce,re){this.resolver=re,this.auth=function Ur(Ue){return Ue.wrapped()}(Ce)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(Ce){return co(ts(this.auth),this.resolver.resolveSignIn(Ce))}}class qo{constructor(Ce){this._delegate=Ce,this.multiFactor=xe.ao(Ce)}static getOrCreate(Ce){return qo.USER_MAP.has(Ce)||qo.USER_MAP.set(Ce,new qo(Ce)),qo.USER_MAP.get(Ce)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(Ce){return this._delegate.getIdTokenResult(Ce)}getIdToken(Ce){return this._delegate.getIdToken(Ce)}linkAndRetrieveDataWithCredential(Ce){return this.linkWithCredential(Ce)}linkWithCredential(Ce){var re=this;return(0,pe.Z)(function*(){return co(re.auth,xe.Z(re._delegate,Ce))})()}linkWithPhoneNumber(Ce,re){var ie=this;return(0,pe.Z)(function*(){return mr(ie.auth,xe.l(ie._delegate,Ce,re))})()}linkWithPopup(Ce){var re=this;return(0,pe.Z)(function*(){return co(re.auth,xe.d(re._delegate,Ce,Wn))})()}linkWithRedirect(Ce){var re=this;return(0,pe.Z)(function*(){return yield es(xe.aE(re.auth)),xe.g(re._delegate,Ce,Wn)})()}reauthenticateAndRetrieveDataWithCredential(Ce){return this.reauthenticateWithCredential(Ce)}reauthenticateWithCredential(Ce){var re=this;return(0,pe.Z)(function*(){return co(re.auth,xe._(re._delegate,Ce))})()}reauthenticateWithPhoneNumber(Ce,re){return mr(this.auth,xe.r(this._delegate,Ce,re))}reauthenticateWithPopup(Ce){return co(this.auth,xe.e(this._delegate,Ce,Wn))}reauthenticateWithRedirect(Ce){var re=this;return(0,pe.Z)(function*(){return yield es(xe.aE(re.auth)),xe.h(re._delegate,Ce,Wn)})()}sendEmailVerification(Ce){return xe.ab(this._delegate,Ce)}unlink(Ce){var re=this;return(0,pe.Z)(function*(){return yield xe.ak(re._delegate,Ce),re})()}updateEmail(Ce){return xe.ag(this._delegate,Ce)}updatePassword(Ce){return xe.ah(this._delegate,Ce)}updatePhoneNumber(Ce){return xe.u(this._delegate,Ce)}updateProfile(Ce){return xe.af(this._delegate,Ce)}verifyBeforeUpdateEmail(Ce,re){return xe.ac(this._delegate,Ce,re)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}qo.USER_MAP=new WeakMap;const En=xe.ax;let rn=(()=>{class Ue{constructor(re,ie){if(this.app=re,ie.isInitialized())return this._delegate=ie.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:ae}=re.options;En(ae,"invalid-api-key",{appName:re.name}),En(ae,"invalid-api-key",{appName:re.name});const we=typeof window<"u"?Wn:void 0;this._delegate=ie.initialize({options:{persistence:wi(ae,re.name),popupRedirectResolver:we}}),this._delegate._updateErrorMap(xe.B),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?qo.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(re){this._delegate.languageCode=re}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(re){this._delegate.tenantId=re}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(re,ie){xe.G(this._delegate,re,ie)}applyActionCode(re){return xe.a2(this._delegate,re)}checkActionCode(re){return xe.a3(this._delegate,re)}confirmPasswordReset(re,ie){return xe.a1(this._delegate,re,ie)}createUserWithEmailAndPassword(re,ie){var ae=this;return(0,pe.Z)(function*(){return co(ae._delegate,xe.a5(ae._delegate,re,ie))})()}fetchProvidersForEmail(re){return this.fetchSignInMethodsForEmail(re)}fetchSignInMethodsForEmail(re){return xe.aa(this._delegate,re)}isSignInWithEmailLink(re){return xe.a8(this._delegate,re)}getRedirectResult(){var re=this;return(0,pe.Z)(function*(){En(Rr(),re._delegate,"operation-not-supported-in-this-environment");const ie=yield xe.j(re._delegate,Wn);return ie?co(re._delegate,Promise.resolve(ie)):{credential:null,user:null}})()}addFrameworkForLogging(re){!function zi(Ue,Ce){(0,xe.aE)(Ue)._logFramework(Ce)}(this._delegate,re)}onAuthStateChanged(re,ie,ae){const{next:we,error:De,complete:Ve}=zn(re,ie,ae);return this._delegate.onAuthStateChanged(we,De,Ve)}onIdTokenChanged(re,ie,ae){const{next:we,error:De,complete:Ve}=zn(re,ie,ae);return this._delegate.onIdTokenChanged(we,De,Ve)}sendSignInLinkToEmail(re,ie){return xe.a7(this._delegate,re,ie)}sendPasswordResetEmail(re,ie){return xe.a0(this._delegate,re,ie||void 0)}setPersistence(re){var ie=this;return(0,pe.Z)(function*(){let ae;switch(function Wr(Ue,Ce){Uo(Object.values(jn).includes(Ce),Ue,"invalid-persistence-type"),(0,ct.b$)()?Uo(Ce!==jn.SESSION,Ue,"unsupported-persistence-type"):(0,ct.UG)()?Uo(Ce===jn.NONE,Ue,"unsupported-persistence-type"):qi()?Uo(Ce===jn.NONE||Ce===jn.LOCAL&&(0,ct.hl)(),Ue,"unsupported-persistence-type"):Uo(Ce===jn.NONE||ys(),Ue,"unsupported-persistence-type")}(ie._delegate,re),re){case jn.SESSION:ae=xe.a;break;case jn.LOCAL:ae=(yield xe.az(xe.i)._isAvailable())?xe.i:xe.b;break;case jn.NONE:ae=xe.L;break;default:return xe.as("argument-error",{appName:ie._delegate.name})}return ie._delegate.setPersistence(ae)})()}signInAndRetrieveDataWithCredential(re){return this.signInWithCredential(re)}signInAnonymously(){return co(this._delegate,xe.X(this._delegate))}signInWithCredential(re){return co(this._delegate,xe.Y(this._delegate,re))}signInWithCustomToken(re){return co(this._delegate,xe.$(this._delegate,re))}signInWithEmailAndPassword(re,ie){return co(this._delegate,xe.a6(this._delegate,re,ie))}signInWithEmailLink(re,ie){return co(this._delegate,xe.a9(this._delegate,re,ie))}signInWithPhoneNumber(re,ie){return mr(this._delegate,xe.s(this._delegate,re,ie))}signInWithPopup(re){var ie=this;return(0,pe.Z)(function*(){return En(Rr(),ie._delegate,"operation-not-supported-in-this-environment"),co(ie._delegate,xe.c(ie._delegate,re,Wn))})()}signInWithRedirect(re){var ie=this;return(0,pe.Z)(function*(){return En(Rr(),ie._delegate,"operation-not-supported-in-this-environment"),yield es(ie._delegate),xe.f(ie._delegate,re,Wn)})()}updateCurrentUser(re){return this._delegate.updateCurrentUser(re)}verifyPasswordResetCode(re){return xe.a4(this._delegate,re)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return Ue.Persistence=jn,Ue})();function zn(Ue,Ce,re){let ie=Ue;"function"!=typeof Ue&&({next:ie,error:Ce,complete:re}=Ue);const ae=ie;return{next:De=>ae(De&&qo.getOrCreate(De)),error:Ce,complete:re}}function wi(Ue,Ce){const re=function wr(Ue,Ce){const re=yr();if(!re)return[];const ie=xe.aA(lo,Ue,Ce);switch(re.getItem(ie)){case jn.NONE:return[xe.L];case jn.LOCAL:return[xe.i,xe.a];case jn.SESSION:return[xe.a];default:return[]}}(Ue,Ce);if(typeof self<"u"&&!re.includes(xe.i)&&re.push(xe.i),typeof window<"u")for(const ie of[xe.b,xe.a])re.includes(ie)||re.push(ie);return re.includes(xe.L)||re.push(xe.L),re}class Di{constructor(){this.providerId="phone",this._delegate=new xe.P(ts(o.Z.auth()))}static credential(Ce,re){return xe.P.credential(Ce,re)}verifyPhoneNumber(Ce,re){return this._delegate.verifyPhoneNumber(Ce,re)}unwrap(){return this._delegate}}Di.PHONE_SIGN_IN_METHOD=xe.P.PHONE_SIGN_IN_METHOD,Di.PROVIDER_ID=xe.P.PROVIDER_ID;const er=xe.ax;class Qe{constructor(Ce,re,ie=o.Z.app()){var ae;er(null===(ae=ie.options)||void 0===ae?void 0:ae.apiKey,"invalid-api-key",{appName:ie.name}),this._delegate=new xe.R(Ce,re,ie.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function at(Ue){Ue.INTERNAL.registerComponent(new y.wA("auth-compat",Ce=>{const re=Ce.getProvider("app-compat").getImmediate(),ie=Ce.getProvider("auth");return new rn(re,ie)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:xe.A.EMAIL_SIGNIN,PASSWORD_RESET:xe.A.PASSWORD_RESET,RECOVER_EMAIL:xe.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:xe.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:xe.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:xe.A.VERIFY_EMAIL}},EmailAuthProvider:xe.M,FacebookAuthProvider:xe.N,GithubAuthProvider:xe.T,GoogleAuthProvider:xe.Q,OAuthProvider:xe.U,SAMLAuthProvider:xe.V,PhoneAuthProvider:Di,PhoneMultiFactorGenerator:xe.m,RecaptchaVerifier:Qe,TwitterAuthProvider:xe.W,Auth:rn,AuthCredential:xe.H,Error:ct.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),Ue.registerVersion("@firebase/auth-compat","0.3.3")}(o.Z)},8766:(bt,vt,Ee)=>{"use strict";Ee.d(vt,{Lj:()=>st,X3:()=>Jt});var pe=Ee(5861);let xe,ct;const y=new WeakMap,ze=new WeakMap,ht=new WeakMap,qe=new WeakMap,Ne=new WeakMap;let ft={get(zt,en,gt){if(zt instanceof IDBTransaction){if("done"===en)return ze.get(zt);if("objectStoreNames"===en)return zt.objectStoreNames||ht.get(zt);if("store"===en)return gt.objectStoreNames[1]?void 0:gt.objectStore(gt.objectStoreNames[0])}return dt(zt[en])},set:(zt,en,gt)=>(zt[en]=gt,!0),has:(zt,en)=>zt instanceof IDBTransaction&&("done"===en||"store"===en)||en in zt};function Je(zt){return"function"==typeof zt?function Ze(zt){return zt!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Ht(){return ct||(ct=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(zt)?function(...en){return zt.apply(Ot(this),en),dt(y.get(this))}:function(...en){return dt(zt.apply(Ot(this),en))}:function(en,...gt){const xt=zt.call(Ot(this),en,...gt);return ht.set(xt,en.sort?en.sort():[en]),dt(xt)}}(zt):(zt instanceof IDBTransaction&&function fn(zt){if(ze.has(zt))return;const en=new Promise((gt,xt)=>{const Lt=()=>{zt.removeEventListener("complete",It),zt.removeEventListener("error",Vt),zt.removeEventListener("abort",Vt)},It=()=>{gt(),Lt()},Vt=()=>{xt(zt.error||new DOMException("AbortError","AbortError")),Lt()};zt.addEventListener("complete",It),zt.addEventListener("error",Vt),zt.addEventListener("abort",Vt)});ze.set(zt,en)}(zt),((zt,en)=>en.some(gt=>zt instanceof gt))(zt,function Ct(){return xe||(xe=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(zt,ft):zt)}function dt(zt){if(zt instanceof IDBRequest)return function nt(zt){const en=new Promise((gt,xt)=>{const Lt=()=>{zt.removeEventListener("success",It),zt.removeEventListener("error",Vt)},It=()=>{gt(dt(zt.result)),Lt()},Vt=()=>{xt(zt.error),Lt()};zt.addEventListener("success",It),zt.addEventListener("error",Vt)});return en.then(gt=>{gt instanceof IDBCursor&&y.set(gt,zt)}).catch(()=>{}),Ne.set(en,zt),en}(zt);if(qe.has(zt))return qe.get(zt);const en=Je(zt);return en!==zt&&(qe.set(zt,en),Ne.set(en,zt)),en}const Ot=zt=>Ne.get(zt);function Jt(zt,en,{blocked:gt,upgrade:xt,blocking:Lt,terminated:It}={}){const Vt=indexedDB.open(zt,en),wn=dt(Vt);return xt&&Vt.addEventListener("upgradeneeded",ai=>{xt(dt(Vt.result),ai.oldVersion,ai.newVersion,dt(Vt.transaction))}),gt&&Vt.addEventListener("blocked",()=>gt()),wn.then(ai=>{It&&ai.addEventListener("close",()=>It()),Lt&&ai.addEventListener("versionchange",()=>Lt())}).catch(()=>{}),wn}function st(zt,{blocked:en}={}){const gt=indexedDB.deleteDatabase(zt);return en&&gt.addEventListener("blocked",()=>en()),dt(gt).then(()=>{})}const Zt=["get","getKey","getAll","getAllKeys","count"],nn=["put","add","delete","clear"],yn=new Map;function it(zt,en){if(!(zt instanceof IDBDatabase)||en in zt||"string"!=typeof en)return;if(yn.get(en))return yn.get(en);const gt=en.replace(/FromIndex$/,""),xt=en!==gt,Lt=nn.includes(gt);if(!(gt in(xt?IDBIndex:IDBObjectStore).prototype)||!Lt&&!Zt.includes(gt))return;const It=function(){var Vt=(0,pe.Z)(function*(wn,...ai){const ir=this.transaction(wn,Lt?"readwrite":"readonly");let Ni=ir.store;return xt&&(Ni=Ni.index(ai.shift())),(yield Promise.all([Ni[gt](...ai),Lt&&ir.done]))[0]});return function(ai){return Vt.apply(this,arguments)}}();return yn.set(en,It),It}!function ln(zt){ft=zt(ft)}(zt=>({...zt,get:(en,gt,xt)=>it(en,gt)||zt.get(en,gt,xt),has:(en,gt)=>!!it(en,gt)||zt.has(en,gt)}))},5861:(bt,vt,Ee)=>{"use strict";function pe(xe,ct,Ct,Ht,y,ze,ht){try{var qe=xe[ze](ht),Ne=qe.value}catch(nt){return void Ct(nt)}qe.done?ct(Ne):Promise.resolve(Ne).then(Ht,y)}function o(xe){return function(){var ct=this,Ct=arguments;return new Promise(function(Ht,y){var ze=xe.apply(ct,Ct);function ht(Ne){pe(ze,Ht,y,ht,qe,"next",Ne)}function qe(Ne){pe(ze,Ht,y,ht,qe,"throw",Ne)}ht(void 0)})}}Ee.d(vt,{Z:()=>o})}},bt=>{bt(bt.s=3081)}]);